<div class="container">

<table style="width: 100%;"><tr>
<td>mvregmed.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate regularized mediation model 
</h2>

<h3>Description</h3>

<p>Fit regularized mediation model for a specified lambda penalty value.
Structural equation models for analysis of multiple exposures (x),
multiple mediators, and multiple outcome variables (y) are fit with a
lasso (L1) penalaty on the model parameters.
The model is x-[alpha] -&gt; mediator-[beta] -&gt; outcome, where
alpha and beta are the parameters for the indirect effect of x on y,
through the mediator. The model also allows a direct effect of x on y: x-[delta]-&gt;y.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvregmed.fit(x, mediator, y, lambda, x.std = TRUE, med.std = TRUE,
y.std = TRUE, max.outer = 5000, max.inner = 2, step.multiplier = 0.5,
print.iter = FALSE, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>matrix with columns representing "exposure" variable (sometimes called instrumental variable)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mediator</code></td>
<td>

<p>matrix with columns representing mediator variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>matrix with columns representing outcome variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>lambda penalty parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize x by dividing by
standard devation of x. Note that each column of x will be centered on its mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>med.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize mediator by dividing by
standard devation of mediator. Note that each column of mediator will be centered on its mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize y by dividing by
standard devation of y. Note that each column of y will be centered on its mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.outer</code></td>
<td>

<p>maximum number of outer loop iterations. The outer loop cycles over several inner loops.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.inner</code></td>
<td>

<p>maximum number of iterations for each inner loop. There is an inner loop
for each paramemeter in the matrices alpha, beta, delta, and vary.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.multiplier</code></td>
<td>

<p>In inner loop, the step size is shrunk by the step.multiplier to
assure that step size is not too large. Generally, the default of
0.5 works well.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.iter</code></td>
<td>

<p>print iteration number during fitting routine
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.cor</code></td>
<td>

<p>maximum correlation within y, x, or mediators, so fitting is more robust
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class mvregmed
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DJ, Dikilitas O, Sinnwell JP,  Kullo I (2022). Penalized Mediation
Models for Multivariate Data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code>mvregmed.grid</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(medsim)
  mvfit &lt;- mvregmed.fit(x, med[,1:10], y, lambda=.1)
  summary(mvfit)
</code></pre>


</div>