<div class="container">

<table style="width: 100%;"><tr>
<td>hitro.new</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>UNU.RAN generator based on Hit-and-Run sampler (HITRO)</h2>

<h3>Description</h3>

<p>UNU.RAN random variate generator for continuous multivariate
distributions with given probability density function (PDF).
It is based on the Hit-and-Run algorithm in combinaton with the
Ratio-of-Uniforms method (‘HITRO’).
</p>
<p>[Universal] – MCMC (Markov chain sampler).
</p>


<h3>Usage</h3>

<pre><code class="language-R">hitro.new(dim=1, pdf, ll=NULL, ur=NULL, mode=NULL, center=NULL,
          thinning=1, burnin=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>number of dimensions of the distribution. (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf</code></td>
<td>
<p>probability density function. (<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll,ur</code></td>
<td>
<p>lower left and upper right vertex of a rectangular
domain of the <code>pdf</code>. The domain is only set if both vertices
are not <code>NULL</code>. Otherwise, the domain is unbounded by
default. (numeric vectors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>location of the mode. (numeric vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>point in “typical” region of distribution,
e.g. the approximate location of the mode. If omitted the
<code>mode</code> is used. If the <code>mode</code> is not given
either, the origin is used. (numeric vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>thinning factor. (positive integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>length of burnin-in phase. (positive integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(optional) arguments for <code>pdf</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Beware: MCMC sampling can be dangerous!</strong>
</p>
<p>This function creates a <code>unuran</code> object based on the
Hit-and-Run algorithm in combinaton with the Ratio-of-Uniforms method
(‘HITRO’).
It can be used to draw samples of a continuous random vector with
given probability density function using <code>ur</code>.
</p>
<p>The algorithm works best with log-concave distributions. Other
distributions work as well but convergence can be slower.
</p>
<p>The density must be provided by a function <code>pdf</code> which must
return non-negative numbers and but need not be normalized (i.e., it
can be any multiple of a density function).
</p>
<p>The <code>center</code> is used as starting point of the Hit-and-Run
algorithm. It is thus important, that the <code>center</code> is contained
in the (interior of the) domain. 
Alternatively, one could provide the location of the
<code>mode</code>. However, this requires its exact position whereas
<code>center</code> allows any point in the “typical” region of the
distribution.
</p>
<p>If the <code>mode</code> is given, then it is used to obtain an upper bound
on the <code>pdf</code> and thus its location should be given sufficiently
accurate.
</p>
<p>The ‘HITRO’ algorithm is a MCMC samplers and thus it does not produce a
sequence of independent variates. The drawn sample follows the target
distribution only approximately.
The dependence between consecutive vectors can be decreased when
only a subsequence is returned (and the other elements are erased).
This is called “thinning” of the Markov chain and can be
controlled by the <code>thinning</code> factor. A thinning factor <code class="reqn">k</code>
means that only every <code class="reqn">k</code>-th element is returned.
</p>
<p>Markov chains also depend on the chosen starting point (i.e., the
<code>center</code> in this implementation of the algorithm).
This dependence can be decreased by erasing the first
part of the chain. This is called the “burn-in” of the Markov
chain and its length is controlled by the argument <code>burnin</code>.
</p>


<h3>Author(s)</h3>

<p>Josef Leydold and Wolfgang H\"ormann
<a href="mailto:unuran@statmath.wu.ac.at">unuran@statmath.wu.ac.at</a>.
</p>


<h3>References</h3>

<p>R. Karawatzki, J. Leydold, and K. P\"otzelberger (2005):
Automatic Markov Chain Monte Carlo Procedures for Sampling from
Multivariate Distributions.
Research Report Series / Department of Statistics and Mathematics,
Nr. 27, December 2005 Department of Statistics and Mathematics,
Wien, Wirtschaftsuniv., 2005.
<a href="https://doi.org/10.57938/168a5370-8110-4aaa-878a-8add2de7e245">doi:10.57938/168a5370-8110-4aaa-878a-8add2de7e245</a>,
<a href="https://research.wu.ac.at/en/publications/automatic-markov-chain-monte-carlo-procedures-for-sampling-from-m-7">https://research.wu.ac.at/en/publications/automatic-markov-chain-monte-carlo-procedures-for-sampling-from-m-7</a>
</p>


<h3>See Also</h3>

<p><code>ur</code>, <code>unuran.new</code>, <code>unuran</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create a sample of size 100 for a 
## Gaussian distribution
mvpdf &lt;- function (x) { exp(-sum(x^2)) }
gen &lt;- hitro.new(dim=2, pdf=mvpdf)
x &lt;- ur(gen,100)

## Use mode of Gaussian distribution.
## Reduce auto-correlation by thinning and burn-in.
##  mode at (0,0)
##  thinning factor 3
##    (only every 3rd vector in the sequence is returned)
##  burn-in of length 1000
##    (the first 100 vectors in the sequence are discarded)
mvpdf &lt;- function (x) { exp(-sum(x^2)) }
gen &lt;- hitro.new(dim=2, pdf=mvpdf, mode=c(0,0), thinning=3, burnin=1000)
x &lt;- ur(gen,100)

## Gaussian distribution restricted to the rectangle [1,2]x[1,2]
##  (don't forget to provide a starting point using 'center')
mvpdf &lt;- function (x) { exp(-sum(x^2)) }
gen &lt;- hitro.new(dim=2, pdf=mvpdf, center=c(1.1,1.1), ll=c(1,1), ur=c(2,2))
x &lt;- ur(gen,100)

</code></pre>


</div>