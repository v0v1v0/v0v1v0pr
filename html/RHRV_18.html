<div class="container">

<table style="width: 100%;"><tr>
<td>CalculatePSD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectral Density Estimation</h2>

<h3>Description</h3>

<p>Estimate the Power Spectral Density (PSD) of the RR time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalculatePSD(
  HRVData,
  indexFreqAnalysis = length(HRVData$FreqAnalysis),
  method = c("pgram", "ar", "lomb"),
  doPlot = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HRVData</code></td>
<td>
<p>Data structure that stores the beats register and information 
related to it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexFreqAnalysis</code></td>
<td>
<p>An integer referencing the data structure that will contain 
the frequency analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String specifying the method used to estimate the spectral 
density. Allowed methods are "pgram" (the default), "ar" and "lomb".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>Plot the periodogram?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to specific PSD estimation methods or 
<code>PlotPSD</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The "pgram" and "ar" methods use the <code>spec.pgram</code>
and <code>spec.ar</code> functions. Thus, the same arguments used
in  <code>spec.pgram</code> or <code>spec.ar</code> 
can be used when method is "pgram" or "ar", respectively.
The "lomb"  is based in the <code>lsp</code> and thus it accepts the
same parameters as this function.
</p>


<h3>Value</h3>

<p>The <em>CalculatePSD</em> returns the <em>HRVData</em> structure 
containing a <em>periodogram</em> field storing and PSD estimation 
of the RR time series. When the "pgram" and "ar" methods are used the
<em>periodogram</em> field is an object of class "spec". If "lomb" is used,
the <em>periodogram</em> field is just a list. In any case the 
<em>periodogram</em> field will contain:
</p>

<ul>
<li>
<p>freq: vector of frequencies at which the spectral density is estimated.
</p>
</li>
<li>
<p>spec: spectral density estimation 
</p>
</li>
<li>
<p>series: name of the series
</p>
</li>
<li>
<p>method: method used to calculate the spectrum
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>spectrum</code>, <code>PlotPSD</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(HRVData)
HRVData=BuildNIHR(HRVData)
HRVData=FilterNIHR(HRVData)
# Frequency analysis requires interpolated data (except Lomb)
HRVData=InterpolateNIHR(HRVData)
# Create a different freqAnalysis for each method
HRVData=CreateFreqAnalysis(HRVData)
HRVData=CalculatePSD(HRVData,1,"pgram",doPlot = F)

HRVData=CreateFreqAnalysis(HRVData)
HRVData=CalculatePSD(HRVData,2,"pgram",spans=9, doPlot = F)

HRVData=CreateFreqAnalysis(HRVData)
HRVData=CalculatePSD(HRVData,3,"ar",doPlot = F)

HRVData=CreateFreqAnalysis(HRVData)
HRVData=CalculatePSD(HRVData,4,"lomb",doPlot = F)
# Plot the results
layout(matrix(c(1,2,3,4), 2, 2, byrow = TRUE))
PlotPSD(HRVData,1)
PlotPSD(HRVData,2)
PlotPSD(HRVData,3)
PlotPSD(HRVData,4)

## End(Not run)
</code></pre>


</div>