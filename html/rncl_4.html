<div class="container">

<table style="width: 100%;"><tr>
<td>rncl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>rncl: An R interface to the NEXUS Class Library</h2>

<h3>Description</h3>

<p>rncl provides an interface to the NEXUS Class Library (NCL), a C++
library intended to parse valid NEXUS files as well as other
common formats used in phylogenetic analysis. Currently, rncl
focuses on parsing trees and supports both NEXUS and Newick
formatted files. Because NCL is used by several phylogenetic
software (e.g., MrBayes, Garli), rncl can parse files generated by
these programs. However, other popular programs (including BEAST)
use an extension of the NEXUS file format, and if trees can be
imported, associated annotations (e.g., confidence intervals on
the time since divergence) cannot.
</p>
<p>Returns a list of the elements contained in a NEXUS file used to
build phylogenetic objects in R
</p>


<h3>Usage</h3>

<pre><code class="language-R">rncl(
  file,
  file.format = c("nexus", "newick"),
  spacesAsUnderscores = TRUE,
  char.all = TRUE,
  polymorphic.convert = TRUE,
  levels.uniform = TRUE,
  show_progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>path to a NEXUS or Newick file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.format</code></td>
<td>
<p>a character string indicating the type of file to be
parsed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacesAsUnderscores</code></td>
<td>
<p>In the NEXUS file format white spaces are not
allowed and are represented by underscores. Therefore, NCL converts
underscores found in taxon labels in the NEXUS file into white spaces
(e.g. <code>species_1</code> will become <code>"species 1"</code>). If you want to
preserve the underscores, set as <code>TRUE</code> (default). This option
affects taxon labels, character labels and state labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>char.all</code></td>
<td>
<p>If <code>TRUE</code> (default), returns all characters, even those
excluded in the NEXUS file (only when NEXUS file contains DATA block).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polymorphic.convert</code></td>
<td>
<p>If TRUE (default), converts polymorphic
characters to missing data (only when NEXUS file contains DATA block).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels.uniform</code></td>
<td>
<p>If TRUE (default), uses the same levels for all
characters (only when NEXUS file contains DATA block).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_progress</code></td>
<td>
<p>If <code>TRUE</code> (default)), a progress bar is displayed
during the possibly time consuming step of removing the singletons from
the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters (currently not in use).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>NCL can also parse data associated with species included in NEXUS
files. If you are interested in importing such data, see the
phylobase package.
</p>
<p>NEXUS is a common file format used in phylogenetics to represent
phylogenetic trees, and other types of phylogenetic data. This
function uses NCL (the NEXUS Class Library) to parse NEXUS, Newick
or other common phylogenetic file formats, and returns the
relevant elements as a list. <code>phylo</code> (from the ape package)
or <code>phylo4</code> (from the phylobase package) can be constructed
from the elements contained in this list.
</p>


<h3>Value</h3>

<p>A list that contains the elements extracted from a NEXUS
or a Newick file.
</p>

<ul>
<li> <p><code>taxaNames</code> A vector of the taxa names listed in
the TAXA block of the NEXUS file or inferred from the tree strings
(if block missing or Newick file).
</p>
</li>
<li> <p><code>treeNames</code> A vector listing the names of the trees
</p>
</li>
<li> <p><code>taxonLabelVector</code> A list containing as many
elements as there are trees in the file. Each element is a
character vector that lists the taxon names encountered in the
tree string *in the order they appear*, and therefore may not
match the order they are listed in the translation table.
</p>
</li>
<li> <p><code>parentVector</code>  A list containing as many elements
as there are trees in the file. Each element is a numeric vector
listing the parent node for the node given by its position in the
vector. If the beginning of the vector is 5 5 6, the parent node
of node 1 is 5, the parent of node 2 is 5 and the parent of node 3
is 6. The implicit root of the tree is identified with 0 (node
without a parent).
</p>
</li>
<li>
<p><code>branchLengthVector</code>  A list containing as many
elements as there are trees in the file. Each element is a numeric
vector listing the edge/branch lengths for the edges in the same
order as nodes are listed in the corresponding <code>parentVector</code>
element. Values of -999 indicate that the value is missing for this
particular edge. The implicit root as a length of 0.
</p>
</li>
<li>
<p><code>nodeLabelsVector</code>  A list containing as many
elements as there are trees in the file. Each element is a
character vector listing the node labels in the same order as the
nodes are specified in the same order as nodes are listed in the
corresponding <code>parentVector</code> element.
</p>
</li>
<li>
<p><code>trees</code>  A character vector listing the tree
strings where tip labels have been replaced by their indices in
the <code>taxaNames</code> vector. They do not correspond to the numbers
listed in the translation table that might be associated with the
tree.
</p>
</li>
<li>
<p><code>dataTypes</code>  A character vector indicating the type
of data associated with the tree (e.g., “standard”). 
</p>
</li>
<li>
<p><code>nbCharacters</code>  A numeric vector indicating how
many characters/traits are available. 
</p>
</li>
<li>
<p><code>charLabels</code>  A character vector listing the names
of the characters/traits that are available. 
</p>
</li>
<li> <p><code>nbStates</code>  A numeric vector listing the number of
possible states for each character/trait.
</p>
</li>
<li> <p><code>stateLabels</code>  A character vector listing in
order, all possible states for each character/trait.
</p>
</li>
<li> <p><code>dataChr</code>  A character vector with as many
elements as there are characters/traits in the dataset. Each
element is string that can be parsed by R to create a factor
vector representing the data found in the file.
</p>
</li>
<li> <p><code>isRooted</code>  A list with as many elements as there
are trees in the file. Each element is a logical indicating
whether the tree is rooted. NCL definition of a rooted tree
differs from the one APE uses in some cases. 
</p>
</li>
<li> <p><code>hasPolytomies</code>  A list with as many elements as
there are trees in the file. Each element is a logical indicating
whether the tree contains polytomies.
</p>
</li>
<li> <p><code>hasSingletons</code>  A list with as many elements as
there are trees in the file. Each element is a logical indicating
whether the tree contains singleton nodes, in other words nodes
with a single descendant (also known as knuckles).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Francois Michonneau
</p>


<h3>References</h3>

<p>Maddison DR, Swofford DL, Maddison WP (1997).
"NEXUS: An extensible file format for systematic information".
Systematic Biology 46(4) : 590-621.
doi: <a href="https://doi.org/10.1093/sysbio/46.4.590">doi:10.1093/sysbio/46.4.590</a>
</p>
<p>Lewis, P. O. 2003. NCL: a C++ class library for interpreting data
files in NEXUS format. Bioinformatics 19 (17) : 2330-2331.
</p>


<h3>See Also</h3>

<p>For examples on how to use the elements of the list
returned by this function to build tree objects, inspect the
source code of this package, in particular how
<code>read_newick_phylo</code> and <code>read_nexus_phylo</code> work. For a
more complex example that also use the data contained in NEXUS
files, inspect the source code of the <code>readNCL</code> function in
the phylobase package.
</p>


</div>