<div class="container">

<table style="width: 100%;"><tr>
<td>sim.convergence.geo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of trait data under the model of convergent character displacement described in Drury et al. 2017
</h2>

<h3>Description</h3>

<p>Simulates the evolution of a continuous character that evolves depending on pairwise similarity in another, OU-evolving trait (e.g., a trait that covaries with resource use). sig2 and z0 are shared between two traits, max and alpha are for focal trait, OU parameters for non-focal trait
</p>


<h3>Usage</h3>

<pre><code class="language-R">
sim.convergence.geo(phylo,pars, Nsegments=2500, plot=FALSE, geo.object)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
 
<p>A matrix with a number of rows corresponding to the desired number of simulations, columns containing values for <code class="reqn">sig2</code> in <code>[,1]</code>, <code class="reqn">m</code> in <code>[,2]</code>, <code class="reqn">alpha</code> in <code>[,3]</code>, <code>root.value</code> in <code>[,4]</code>, <code class="reqn">psi</code> of the OU model for the non-focal, resource use trait in <code>[,5]</code>, and <code class="reqn">theta</code> in the OU model for the non-focal resource use trait in <code>[,6]</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsegments</code></td>
<td>

<p>the minimum number of time steps to simulate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>if <code>TRUE</code>, returns two plots: the top plot is focal trait undergoing convergence, the bottom plot is non-focal trait evolving under BM or OU
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geo.object</code></td>
<td>

<p>geography object created using CreateGeoObject
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Adjusting <code>Nsegments</code> will impact the length of time the simulations take. 
The length of each segment (<code>max(nodeHeights(phylo))/Nsegments</code>) 
should be much smaller than the smallest branch (<code>min(phylo$edge.length)</code>).
</p>


<h3>Value</h3>

<p>A list of two matrices with the simulated values for each lineage (one simulation per row; columns correspond to species) for trait1 (focul trait undergoing convergence) and non.focal (resource-use trait that determines strength of convergence in trait1)
</p>


<h3>Author(s)</h3>

<p>J.P. Drury <a href="mailto:jonathan.p.drury@gmail.com">jonathan.p.drury@gmail.com</a>
</p>


<h3>References</h3>

<p>Drury, J., Grether, G., Garland Jr., T., and Morlon, H. 2017. A review of phylogenetic methods for assessing the influence of interspecific interactions on phenotypic evolution. <em>Systematic Biology</em> 
</p>


<h3>See Also</h3>

<p><code>CreateGeoObject</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(Anolis.data)
phylo&lt;-Anolis.data$phylo
geo.object&lt;-Anolis.data$geography.object

#simulate with the OU process present and absent
pars&lt;-expand.grid(0.05,-0.1,1,0,c(2,0),0)
sim.convergence.geo(phylo,pars,Nsegments=2500, plot=FALSE, geo.object)


</code></pre>


</div>