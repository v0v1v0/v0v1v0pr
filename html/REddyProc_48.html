<div class="container">

<table style="width: 100%;"><tr>
<td>LightResponseCurveFitter_fitLRC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>LightResponseCurveFitter fitLRC</h2>

<h3>Description</h3>

<p>Optimize rectangular hyperbolic light response curve in one window</p>


<h3>Usage</h3>

<pre><code class="language-R">LightResponseCurveFitter_fitLRC(dsDay, E0, 
    sdE0, RRefNight, controlGLPart = partGLControl(), 
    lastGoodParameters = rep(NA_real_, 7L))</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dsDay</code></td>
<td>
<p>data.frame with columns NEE, Rg, Temp_C, VPD, and no NAs in NEE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E0</code></td>
<td>
<p>temperature sensitivity of respiration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdE0</code></td>
<td>
<p>standard deviation of E_0.n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RRefNight</code></td>
<td>
<p>basal respiration estimated from night time data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controlGLPart</code></td>
<td>
<p>further default parameters
(see <code>partGLControl</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lastGoodParameters</code></td>
<td>
<p>numeric vector returned
by last reasonable fit</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Optimization is performed for three initial parameter sets that differ
by <code>beta0 (* 1.3, * 0.8)</code>.
From those three, the optimization result is selected that yielded
the lowest misfit.
Starting values are: <code>k = 0</code>,
<code>beta = interpercentileRange(0.03, 0.97)</code> of
respiration, <code>alpha = 0.1</code>, <code>R_ref</code>
from nightTime estimate.
<code>E0</code> is fixed to the night-time estimate, but varies for estimating
parameter uncertainty.
</p>
<p>If <code>controlGLPart$nBootUncertainty == 0L</code> then the
covariance matrix of the
parameters is estimated by the Hessian of the LRC curve at optimum.
Then, the additional uncertainty and covariance with uncertainty E0
is neglected.
</p>
<p>If <code>controlGLPart.l$nBootUncertainty &gt; 0L</code> then the
covariance matrix of the
parameters is estimated by a bootstrap of the data.
In each draw, E0 is drawn from N ~ (E_0, sdE_0).
</p>
<p>If there are no estimates for more than 20% of the
bootstrapped samples
The an NA-result with convergence code 1001L is returned.</p>


<h3>Value</h3>

<p>a list, If none of the optimizations from different starting
conditions converged, the parameters are NA.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>thetaOpt</code></td>
<td>
<p>numeric vector of optimized parameters
including the fixed ones and E0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iOpt</code></td>
<td>
<p>index of parameters that have been
optimized, here including E0, which has been optimized prior to
this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaInitialGuess</code></td>
<td>
<p>the initial guess from data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covParms</code></td>
<td>
<p>numeric matrix of the covariance matrix
of parameters, including E0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>integer code specifying
convergence problems: \
0: good convergence \
, 1-1000: see <code>optim</code> \
, 1001: too few bootstraps converged \
, 1002: fitted parameters were outside reasonable bounds \
, 1003: too few valid records in window \
, 1004: near zero covariance in bootstrap indicating bad fit \
, 1005: covariance from curvature of fit yielded negative variances
indicating bad fit \
, 1006: prediction of highest PAR in window was far from saturation
indicating insufficient data to constrain LRC \
, 1010: no temperature-respiration relationship found \
, 1011: too few valid records in window
(from different location: partGLFitLRCOneWindow) \
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>TW, MM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code>partGLFitLRCWindows</code>
</p>
<p><code>LightResponseCurveFitter_optimLRCBounds</code></p>


</div>