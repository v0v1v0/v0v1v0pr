<div class="container">

<table style="width: 100%;"><tr>
<td>gibbs_sampling</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Markov chain Monte Carlo simulation for the probit model</h2>

<h3>Description</h3>

<p>This function draws from the posterior distribution of the probit model via
Markov chain Monte Carlo simulation-
</p>


<h3>Usage</h3>

<pre><code class="language-R">gibbs_sampling(
  sufficient_statistics,
  prior,
  latent_classes,
  fixed_parameter,
  init,
  R,
  B,
  print_progress,
  ordered,
  ranked
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sufficient_statistics</code></td>
<td>
<p>The output of <code>sufficient_statistics</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A named list of parameters for the prior distributions. See the documentation
of <code>check_prior</code> for details about which parameters can be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latent_classes</code></td>
<td>
<p>Either <code>NULL</code> (for no latent classes) or a list of parameters specifying
the number of latent classes and their updating scheme:
</p>

<ul>
<li> <p><code>C</code>: The fixed number (greater or equal 1) of latent classes,
which is set to 1 per default. If either <code>weight_update = TRUE</code>
or <code>dp_update = TRUE</code> (i.e. if classes are updated), <code>C</code>
equals the initial number of latent classes.
</p>
</li>
<li> <p><code>weight_update</code>: A boolean, set to <code>TRUE</code> to weight-based
update the latent classes. See ... for details.
</p>
</li>
<li> <p><code>dp_update</code>: A boolean, set to <code>TRUE</code> to update the latent
classes based on a Dirichlet process. See ... for details.
</p>
</li>
<li> <p><code>Cmax</code>: The maximum number of latent classes.
</p>
</li>
<li> <p><code>buffer</code>: The number of iterations to wait before a next
weight-based update of the latent classes.
</p>
</li>
<li> <p><code>epsmin</code>: The threshold weight (between 0 and 1) for removing
a latent class in the weight-based updating scheme.
</p>
</li>
<li> <p><code>epsmax</code>: The threshold weight (between 0 and 1) for splitting
a latent class in the weight-based updating scheme.
</p>
</li>
<li> <p><code>distmin</code>: The (non-negative) threshold in class mean difference
for joining two latent classes in the weight-based updating scheme.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_parameter</code></td>
<td>
<p>Optionally specify a named list with fixed parameter values for <code>alpha</code>,
<code>C</code>, <code>s</code>, <code>b</code>, <code>Omega</code>, <code>Sigma</code>, <code>Sigma_full</code>,
<code>beta</code>, <code>z</code>, or <code>d</code> for the simulation.
See <a href="https://loelschlaeger.de/RprobitB/articles/v01_model_definition.html">the vignette on model definition</a>
for definitions of these variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>The output of <code>set_initial_gibbs_values</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of iterations of the Gibbs sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The length of the burn-in period, i.e. a non-negative number of samples to
be discarded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_progress</code></td>
<td>
<p>A boolean, determining whether to print the Gibbs sampler progress and the
estimated remaining computation time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordered</code></td>
<td>
<p>A boolean, <code>FALSE</code> per default. If <code>TRUE</code>, the choice set
<code>alternatives</code> is assumed to be ordered from worst to best.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranked</code></td>
<td>
<p>TBA</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is not supposed to be called directly, but rather via
<code>fit_model</code>.
</p>


<h3>Value</h3>

<p>A list of Gibbs samples for
</p>

<ul>
<li> <p><code>Sigma</code>,
</p>
</li>
<li> <p><code>alpha</code> (if <code>P_f&gt;0</code>),
</p>
</li>
<li> <p><code>s</code>, <code>z</code>, <code>b</code>, <code>Omega</code> (if <code>P_r&gt;0</code>),
</p>
</li>
<li> <p><code>d</code> (if <code>ordered = TRUE</code>),
</p>
</li>
</ul>
<p>and a vector <code>class_sequence</code> of length <code>R</code>, where the <code>r</code>th
entry is the number of latent classes after iteration <code>r</code>.
</p>


</div>