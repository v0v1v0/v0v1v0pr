<div class="container">

<table style="width: 100%;"><tr>
<td>Parallel-Analysis-of-Polychoric-Correlations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A Parallel Analysis with Random Polychoric Correlation Matrices
</h2>

<h3>Description</h3>

<p>The function performs a parallel analysis using simulated polychoric correlation matrices. The function will extract the eigenvalues from each random generated polychoric correlation matrix and from the polychoric correlation matrix of real data. A plot comparing eigenvalues extracted from the specified real data with simulated data will help determine which of real eigenvalue outperform random data. A series of matrices comparing MAP vs PA-Polychoric vs PA-Pearson correlations methods, FA vs PCA solutions are finally presented.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
    Package: </td>
<td style="text-align: left;"> random.polychor.pa</td>
</tr>
<tr>
<td style="text-align: left;">
    Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
    Version: </td>
<td style="text-align: left;"> 1.1.4-4</td>
</tr>
<tr>
<td style="text-align: left;">
    Date: </td>
<td style="text-align: left;"> 2023-06-29</td>
</tr>
<tr>
<td style="text-align: left;">
    License: </td>
<td style="text-align: left;"> GPL Version 2 or later</td>
</tr>
<tr>
<td style="text-align: left;">
    LazyLoad: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The function perform a parallel analysis (Horn, 1965) using randomly simulated polychoric correlations and generates <code>nrep</code> random samples of the same dimension of the empirical provided data.matrix(i.e, with the same number of participants and of variables). Items are allowed to have varying number of categories. The function will extract the eigenvalues from each randomly generated polychoric matrices and the declared quantile will be extracted. Eigenvalues from polychoric correlation matrix obtained from real data are also computed and compared, in a (scree) plot, with the eigenvalues extracted from the simulation (Polychoric matrices). Recently Cho, Li &amp; Bandalos (2009), showed that in using PA method, it is important to match the type of the correlation matrix used to recover the eigenvalues from real data with the type of correlation matrix used to estimate random eigenvalues. Crossing the type of correlations (using Polychoric correlation matrix to estimate real eigenvalues and random simulated Pearson correlation matrices) may result in a wrong decision (i.e., retaining less non-random factors than the needed). A comparison with eigenvalues extracted from both randomly simulated Pearson correlation matrices and real data is also also included. Finally, for both type of correlation matrix (Polychoric vs Pearson), the two versions (the classic squared coefficient and the 4th power coefficient) of Velicer's MAP criterion are calculated. In version 1.1.1, a minor bug in the regarding the estimated time needed to complete the simulation is fixed. Also in this version, the function is now able to manage supplied data.matrix in which variables representing factors (i.e., variables with ordered categories) are present and may cause an error when the Pearson correlation matrix is calculated. As the <code>poly.mat()</code> function used to calculate the polychoric correlation matrix is going to be deprecated in favor of poly.mat(polychoric()) function, the random.polychor.pa was consequently updated (version 1.1.2) to account for changes in <code>psych()</code> package.  Version 1.1.3 tackles two problems signaled by users: 1) the possibility to make available the results of simulation for plotting them in other software. Now the random.polychor.pa will show, upon request, all the data used in the scree-plot. 2) The function <code>polichoric()</code> of the <code>psych()</code> package does not handle data matrices that include 0 as possible category and will cause the function to stop with error. So a check for the detection of the 0 code within the provided data.matrix is now added and will cause the random.polychor.pa function to stop with a warning message. In version 1.1.3.5 a parameter was added, <code>diff.fact</code> in order to simulate random data set with the same probability of observing each category for each variable as that observed in the provided (empirical) data set. This parameter allows to simulate data sets that have the same item difficulties distribution as well as the same difficulty factors of the real data (Ledesma and Valero-Mora, 2007). Finally the search for zeroes within the provided data file was removed, so data with zeroes are now accepted. In version 1.1.3.6 a check for the range of quantile (between 0 and 1) was added. 
In version 1.1.4 was added the possibility to choose between uniform and multinomial distribution, between random and boostrap distribution and between single or multiple sample parallel analysis. Also two switches were added: one allows to print or a default output (including only the number of factors to retain following Parallel Analysis and the scree-plot) or a full output (including the eigenvalues distributions of simulated and empirical data sets); the other switch allows to print a further Fit Statistics for the factor solutions indicated by the Parallel Analysis. 
</p>
<p>The default value of the <code>comparison</code> is set to <code>random</code> and this means that random uniform samples (<code>runif()</code>) will be computed. Two types of distribution are available: the uniform distribution and the multinomial distribution (Liu and Rijmen, 2008). To switch between them just set accordingly the parameter <code>distr</code>. As method of resampling is now also available the bootstrap method that is based on random permutations of cases obtained via the <code>boot()</code> function. 
</p>
<p>Multigroup version of random samples may be obtained by setting the parameter <code>comparison</code> to <code>random-mg</code>. To perform multigroup Parallel Analysis simulating random samples with multinomial distributions the parameter  <code>distr</code> should be set to <code>multinomial</code>. Multigroup Parallel Analysis is also available for the bootstrap method by setting the <code>comparison</code> parameter to <code>bootstrap-mg</code>. When Multigroup Parallel Analysis is used, the first variable (column) of the dataset should be reserved to the factor used to identify the different samples (i.e., gender, agre groups, nationalities, etc.).  
</p>
<p>Fit statistics (Chi-squared, TLI, RMSEA, RMR, BIC) for all factor solutions indicated by Parallel Analysis are available when the parameter <code>fit.pa</code> is set to <code>TRUE</code>. Consider that in estimating the these Fit Statistic indexes not allways converge and this may break the computations for the parallel analysis. In this case switch the parameter off. Moreover the values of these indexes are not allways within the expected range. 
</p>
<p>The <code>print.all</code> parameter when set to  <code>TRUE</code> will show the table of eigenvalue distributions for simulated (random or boostrap) and empirical data. For boostrap simulation, also the bias and standard error will be printed. If the <code>diff.fact</code> is set to <code>TRUE</code> when random simulations are requested, then also the weighting matrix used to reproduce the item frequencies in random data set will be printed.
</p>
<p>The <code>continuity</code> parameter is passed to polychoric() function to handle the correction for continuity. In polychoric() function this correction for continuity is set by default to .5 (i.e. correct=TRUE). However in some cases this correction for continuity causes the polychorich() function to stop unexpectedly and consequently also random.polychor.pa() stops. So we added this parameter to allow users to bypass this problem. This parameter is set by default to 0.0 (i.e., no correction for continuity applied) and user may add the correction for continuity by setting the value to 0.5.
</p>
<p>The <code>wght</code> parameter allows the user to provide a vector of non-negative weights to compute a weighted random polychor (or pearson) correlation matrix and as well the simulation of weighted random samples. If <code>bootstrap</code> is also selected, then a weighted bootstrap samples will be extracted. Finally if <code>multisample</code> is also selected then it will be computed a random weighted samples for each sub-group. 
</p>


<h3>Author(s)</h3>

<p>Fabio Presaghi <a href="mailto:fabio.presaghi@uniroma1.it">fabio.presaghi@uniroma1.it</a> and Marta Desimoni <a href="mailto:marta.desimoni@uniroma1.it">marta.desimoni@uniroma1.it</a>
</p>


<h3>References</h3>

<p>Cho, S.J., Li, F., &amp; Bandalos, D., (2009). Accuracy of the Parallel Analysis Procedure With Polychoric Correlations. Educational and Psychological Measurement, 69, 748-759.
</p>
<p>Horn, J. L. (1965). A rationale and test for the number of factors in factor analysis. Psychometrika, 32, 179-185.
</p>
<p>Ledesma RD, Valero-Mora P (2007) Determining the number of factors to retain in EFA: an  easy to use computer program for carrying out parallel analysis. Practical Assessment, Research &amp; Evaluation 12:1â€“11
</p>
<p>O<kbd>'</kbd>Connor, B. P. (2000). SPSS and SAS programs for determining the number of components using parallel analysis and Velicer<kbd>'</kbd>s MAP test. Behavior Research Methods, Instrumentation, and Computers, 32, 396-402.
</p>
<p>Reckase, M.D. (2009). Multidimensional Item Response Theory. Springer. 
</p>
<p>Velicer, W. F. (1976). Determining the number of factors from the matrix of partial correlations. Psychometrika, 41, 321-327.
</p>
<p>Velicer, W. F., Eaton, C. A., &amp; Fava, J. L. (2000). Construct explication through factor or component analysis: A review and evaluation of alternative procedures for determining the number of factors or components. In R. D. Goffin &amp; E. Helmes (Eds.), Problems and solutions in human assessment: Honoring Douglas N. Jackson at seventy (pp. 41-72). Norwell, MA: Kluwer Academic.
</p>


</div>