<div class="container">

<table style="width: 100%;"><tr>
<td>match_restrictions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Alter numeric data records to match linear (in)equality constraints.</h2>

<h3>Description</h3>

<p>Apply the successive projection algorithm to adjust each record in 
<code>dat</code> to satisfy a set of linear (in)equality constraints.
</p>


<h3>Usage</h3>

<pre><code class="language-R">match_restrictions(
  dat,
  restrictions,
  adjust = NULL,
  weight = rep(1, ncol(dat)),
  remove_tag = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restrictions</code></td>
<td>
<p>An object of class <code>validator</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>(optional) A <code>logical</code> matrix of dimensions
<code>dim(dat)</code> where <code>TRUE</code> indicates that a value may be adjusted.
When missing, the <code>tagged_values</code> are used. If no tagging was
applied, adjust will default to an all <code>TRUE</code> matrix with
dimensions equal to <code>dim(dat)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>A weight vector of length <code>ncol(dat)</code> or a matrix of dimensions <code>dim(dat)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_tag</code></td>
<td>
<p>if a value position indicator is present, remove it?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>project</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>dat</code>, with values adapted.
</p>


<h3>Note on inequality restrictions</h3>

<p>All inequality restrictions of the form <code class="reqn">a.x &lt; b</code> are treated as <code class="reqn">a.x \leq b</code>.
The idea is to project the original record <code class="reqn">x</code> onto the boundary defined by
the (in)equations. Projection on a boundary defined by a strict inequation is 
illdefined sice the value <code class="reqn">b</code> in the restriction <code class="reqn">a.x &lt; b</code> is strictly
outside the valid region.
</p>


<h3>See Also</h3>

<p><code>tag_missing</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# a very simple adjustment example

v &lt;- validate::validator(
	x + y == 10,
	x &gt; 0,
	y &gt; 0
)

# x and y will be adjusted by the same amount
match_restrictions(data.frame(x=4,y=5), v)

# One of the inequalies violated
match_restrictions(data.frame(x=-1,y=5), v)

# Weighted distances: 'heavy' variables change less
match_restrictions(data.frame(x=4,y=5), v, weight=c(100,1))

# if w=1/x0, the ratio between coefficients of x0 stay the same (to first order)
x0 &lt;- data.frame(x=4,y=5)
x1 &lt;- match_restrictions(x0, v, weight=1/as.matrix(x0))

x0[,1]/x0[,2]
x1[,1] / x1[2]

# example of tag usage
v &lt;- validate::validator(x + y == 1, x&gt;0,y&gt;0)
d &lt;- data.frame(x=NA,y=0.5)
d &lt;- tag_missing(d)
# impute
d[1,1] &lt;- 1

# only the tagged values will be altered. The tag is
# removed afterwards.
match_restrictions(d,v)


</code></pre>


</div>