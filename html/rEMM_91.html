<div class="container">

<table style="width: 100%;"><tr>
<td>recluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reclustering EMM states</h2>

<h3>Description</h3>

<p>Use various clustering methods to recluster states/clusters
in an EMM. The centers of the clusters in the EMM object are used as 
data points by the reclustering algorithm. States/centers put by reclustering
into the same cluster are merged to produce a new reclustered EMM.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'EMM'
recluster_hclust(x, k=NULL, h=NULL, method="average", 
    ...,prune=NULL, copy=TRUE)
## S4 method for signature 'EMM'
recluster_kmeans(x, k, ..., prune=NULL, copy=TRUE)
## S4 method for signature 'EMM'
recluster_pam(x, k, ..., prune=NULL, copy=TRUE)
## S4 method for signature 'EMM'
recluster_reachability(x, h, ..., prune=NULL, copy=TRUE)
## S4 method for signature 'EMM'
recluster_tNN(x, threshold=NULL, ..., prune=NULL, copy=TRUE)
## S4 method for signature 'EMM'
recluster_transitions(x, threshold=NULL, ..., prune=NULL, copy=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> an <code>"EMM"</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> number of clusters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p> heights where the dendrogram tree should be cut.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p> threshold used on the dissimilarity to join 
clusters for tNN. If no threshold is specified then the threshold
stored in the EMM is used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> clustering method used by <code>hclust</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments passed on to the clustering algorithm. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prune</code></td>
<td>
<p> logical; prune states with less 
than <code>prune</code> counts before reclustering. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copy</code></td>
<td>
<p> logical; make a copy of x before reclustering? Otherwise the function will change <code>x</code>! </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>recluster_kmeans</code> <code>k</code> can also be a set of initial cluster 
centers (see argument <code>centers</code> for <code>kmeans</code> in package <span class="pkg">stats</span>).
</p>
<p>For <code>recluster_hclust</code> <code>k</code> or <code>h</code> can also be a vector. 
The result is then a list with several (nested) EMMs, one for each value.
</p>
<p>For <code>recluster_reachability</code> reclusters all clusters which are reachable
from each other. A cluster <code class="reqn">j</code> is reachable from <code class="reqn">i</code> if
<code class="reqn">j</code>'s center is closer to <code class="reqn">i</code>'s center than <code>h</code> or if <code class="reqn">j</code> is
reachable by any cluster reachable by <code class="reqn">i</code>.
</p>
<p>For <code>recluster_tNN</code> reclusters such that two clusters with
centers less than the threshold apart will be reclustered into a
single cluster. This is useful, for example, after combining two models.
</p>
<p>For <code>recluster_transitions</code> does not recluster clusters!
It find groups of clusters which are overlapping (centers are
less than 2 thresholds apart) and then redistributes the transition weights
such that all members of one group are connected to all the members of the
other group using the same weight.
</p>


<h3>Value</h3>

<p>An object of class <code>"EMM"</code> or, if <code>copy=FALSE</code> a refernece 
to the changed object passed as <code>x</code>. 
</p>
<p>Clustering information is available
as the attribute <code>"cluster_info"</code>.
The information provided depends
in the clustering algorithm (see <code>hclust</code>, <code>kmeans</code> and <code>pam</code>).
</p>


<h3>See Also</h3>

<p><code>merge_clusters</code>, <code>prune</code>, 
<code>kmeans</code>, <code>hclust</code>,
<code>pam</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(EMMsim)
emm &lt;- EMM(threshold = .2)
build(emm, EMMsim_train)

## do reclustering on a copy of the emm and plot dendrogram
emm_hc &lt;- recluster_hclust(emm, h = 0.6)

attr(emm_hc, "cluster_info")

## compare original and clustered EMM
op &lt;- par(mfrow = c(2, 2), pty = "m")   
plot(emm, method= "MDS", main ="original EMM", data = EMMsim_train) 
plot(attr(emm_hc, "cluster_info")$dendrogram)
abline(h=0.6, col="red")
plot(emm_hc, method="MDS", main ="clustered EMM", data = EMMsim_train) 
plot(emm_hc, method="MDS", main ="clustered EMM") 
par(op)
</code></pre>


</div>