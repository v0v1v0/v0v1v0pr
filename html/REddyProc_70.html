<div class="container">

<table style="width: 100%;"><tr>
<td>partitionNEEGL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>partitionNEEGL</h2>

<h3>Description</h3>

<p>Partition NEE fluxes into GP and Reco using the daytime method.</p>


<h3>Usage</h3>

<pre><code class="language-R">partitionNEEGL(ds, NEEVar = if (!missing(NEEVar.s)) NEEVar.s else paste0("NEE", 
    suffixDash, "_f"), TempVar = if (!missing(TempVar.s)) TempVar.s else "Tair_f", 
    VPDVar = if (!missing(VPDVar.s)) VPDVar.s else "VPD_f", 
    RadVar = if (!missing(RadVar.s)) RadVar.s else "Rg_f", 
    suffix = if (!missing(Suffix.s)) Suffix.s else "", 
    NEEVar.s, TempVar.s, VPDVar.s, RadVar.s, 
    Suffix.s, ..., controlGLPart = partGLControl(), 
    isVerbose = TRUE, nRecInDay = 48L, lrcFitter = RectangularLRCFitter())</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ds</code></td>
<td>
<p>dataset with all the specified input columns
and full days in equidistant times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NEEVar</code></td>
<td>
<p>Variable of NEE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TempVar</code></td>
<td>
<p>Filled air or soil temperature variable (degC)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VPDVar</code></td>
<td>
<p>Filled Vapor Pressure Deficit - VPD - (hPa)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RadVar</code></td>
<td>
<p>Filled radiation variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>string inserted into column names before
identifier for NEE column defaults
(see <code>sEddyProc_sMDSGapFillAfterUstar</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NEEVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TempVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VPDVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RadVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Suffix.s</code></td>
<td>
<p>deprecated
identifier for NEE column defaults
(see <code>sEddyProc_sMDSGapFillAfterUstar</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to
<code>partGLExtractStandardData</code>, such as <code>PotRadVar</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controlGLPart</code></td>
<td>
<p>further default parameters,
see <code>partGLControl</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isVerbose</code></td>
<td>
<p>set to FALSE to suppress output messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nRecInDay</code></td>
<td>
<p>number of records within one day
(for half-hourly data its 48)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrcFitter</code></td>
<td>
<p>R5 class instance
responsible for fitting the light response curve.
Current possibilities are <code>RectangularLRCFitter()</code>,
<code>NonrectangularLRCFitter()</code>,
and <code>LogisticSigmoidLRCFitter()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Daytime-based partitioning of measured net ecosystem fluxes into
gross primary production (GPP) and ecosystem respiration (Reco)
</p>
<p>The fit to the light-response-curve is done by default using the Rectangular
hyperbolic function, as in Lasslop et al. (2010)
Alternative fittings can be used by providing the corresponding subclass of
<code>LightResponseCurveFitter-class</code> to <code>lrcFitter</code> argument.
(see <code>LightResponseCurveFitter_predictGPP</code>)
</p>
<p>While the extrapolation uses filled data, the parameter optimization
may use only measured data, i.e. with specified quality flag.
Even with using filled VPD, there may be large gaps that have not been
filled.
With the common case where VPD is missing for fitting the LRC, by default
(with <code>controlGLPart$isRefitMissingVPDWithNeglectVPDEffect = TRUE</code>)
is to redo the estimation of LRC parameters with neglecting the VPD-effect.
Next, in the predictions (rows) with missing VPD are then replaced
with predictions
based on LRC-fits that neglected the VPD effect.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Reco_DT_&lt;suffix&gt;</code></td>
<td>
<p>predicted ecosystem respiration: mumol CO2/m2/s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GPP_DT_&lt;suffix&gt;</code></td>
<td>
<p>predicted gross primary production mumol CO2/m2/s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>&lt;LRC&gt;</code></td>
<td>
<p>Further light response curve (LRC) parameters and
their standard deviation depend on the used LRC
(e.g. for the non-rectangular LRC
see <code>NonrectangularLRCFitter_getParameterNames</code>).
They are estimated for windows and are reported with the first record
of the window</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_VARnight</code></td>
<td>
<p>NEE filtered
for nighttime records (others NA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_VARday</code></td>
<td>
<p>NEE filtered for daytime
records (others NA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NEW_FP_Temp</code></td>
<td>
<p>temperature after filtering for quality
flag degree Celsius</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NEW_FP_VPD</code></td>
<td>
<p>vapour pressure deficit after filtering
for quality flag, hPa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_RRef_Night</code></td>
<td>
<p>basal respiration estimated
from nighttime (W / m2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_qc</code></td>
<td>
<p>quality flag: 0: good parameter fit,
1: some parameters out of range, required refit,
2: next parameter estimate is more than two weeks away</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_dRecPar</code></td>
<td>
<p>records until or after closest record
that has a parameter estimate associated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_errorcode</code></td>
<td>
<p>information why LRC-fit was not
successful or was rejected, see result of
<code>LightResponseCurveFitter_fitLRC</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_GPP2000</code></td>
<td>
<p>predicted GPP at VPD = 0 and PAR = 2000:
a surrogate for maximum photosynthetic capacity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_OPT_VPD</code></td>
<td>
<p>list object
of fitting results including iOpt and covParms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP_OPT_NoVPD</code></td>
<td>
<p>same as
FP_OPT_VPD holding optimization results with fit
neglecting the VPD effect
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>References</h3>

<p>Lasslop G, Reichstein M, Papale D, et al. (2010) Separation of
net ecosystem exchange into assimilation and respiration using
a light response curve approach: critical issues and global evaluation.
Global Change Biology, Volume 16, Issue 1, Pages 187-208</p>


<h3>See Also</h3>

<p><code>partGLFitNightTimeTRespSens</code>
</p>
<p><code>partGLFitLRCWindows</code>
</p>
<p><code>partGLInterpolateFluxes</code></p>


</div>