<div class="container">

<table style="width: 100%;"><tr>
<td>rc_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the Return Curve</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Estimation of the \(p\)-probability return curve following Murphy-Barltrop et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rc_est(
  margdata,
  w = NULL,
  p,
  method = c("hill", "cl"),
  q = 0.95,
  qalphas = rep(0.95, 2),
  k = 7,
  constrained = FALSE,
  tol = 0.001,
  par_init = rep(0, k - 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>margdata</code></td>
<td>
<p>An S4 object of class <code>margtransf.class</code>. See <code>margtransf</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Sequence of rays between <code>0</code> and <code>1</code>. Default is <code>NULL</code>, where a pre-defined grid is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Curve survival probability. Must be \(p &lt; 1-q\) and \(p &lt; 1-q_\alpha\).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String that indicates which method is used for the estimation of the angular dependence function. Must either be <code>"hill"</code>, to use the Hill estimator (Hill 1975), or <code>"cl"</code> to use the smooth estimator based on Bernstein-Bezier polynomials estimated by composite maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Marginal quantile used to define the threshold \(u_\omega\) of the min-projection variable \(T^1\) at ray \(\omega\) \(\left(t^1_\omega = t_\omega - u_\omega | t_\omega &gt; u_\omega\right)\), and/or Hill estimator (Hill 1975). Default is <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qalphas</code></td>
<td>
<p>A vector containing the marginal quantile used for the Heffernan and Tawn conditional extremes model (Heffernan and Tawn 2004) for each variable, if <code>constrained = TRUE</code>. Default is <code>rep(0.95, 2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Polynomial degree for the Bernstein-Bezier polynomials used for the estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrained</code></td>
<td>
<p>Logical. If <code>FALSE</code> (default) no knowledge of the conditional extremes parameters is incorporated in the angular dependence function estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Convergence tolerance for the composite maximum likelihood procedure. Success is declared when the difference of log-likelihood values between iterations does not exceed this value. Default is <code>0.0001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_init</code></td>
<td>
<p>Initial values for the parameters \(\beta\) of the Bernstein-Bezier polynomials used for estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>rep(0, k-1)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a probability \(p\) and a joint survival function \(Pr(X&gt;x, Y&gt;y)\), 
the \(p\)-probability return curve is defined as 
\[RC(p):=\left\lbrace(x, y) \in R^2: Pr(X&gt;x, Y&gt;y)=p\right\rbrace.\] 
</p>
<p>This method focuses on estimation of \(RC(p)\) for small \(p\) near \(0\), so that \((X,Y)\) are in the tail of the distribution.
</p>
<p>\(Pr(X&gt;x, Y&gt;y)\) is estimated using the angular dependence function \(\lambda(\omega)\) introduced by Wadsworth and Tawn (2013). More details on how to estimate \(\lambda(\omega)\) can be found in <code>adf_est</code>.
</p>
<p>The return curve estimation \(\hat{RC}(p)\) is done on standard exponential margins and then back transformed onto the original margins.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>rc_est.class</code>. This object returns the arguments of the function and extra slot <code>rc</code> 
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>interval</code>:</td>
<td>
<p>A vector containing the maximum likelihood estimates from the conditional extremes model, \(\hat{\alpha}^1_{x\mid y}\) and \(\hat{\alpha}^1_{y\mid x}\), if <code>constrained = TRUE</code>. If <code>constrained = FALSE</code>, then <code>c(0, 1)</code> is returned; we note that this has no meaningful interpretation as the estimation is performed in an unconstrained interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>rc</code>:</td>
<td>
<p>A matrix with the estimates of the Return Curve.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Heffernan JE, Tawn JA (2004).
“A conditional approach for multivariate extreme values (with discussion).”
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>66</b>(3), 497-546.
doi: <a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x">10.1111/j.1467-9868.2004.02050.x</a>, https://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/j.1467-9868.2004.02050.x.<br><br> Hill BM (1975).
“A Simple General Approach to Inference About the Tail of a Distribution.”
<em>The Annals of Statistics</em>, <b>3</b>(5), 1163 – 1174.
doi: <a href="https://doi.org/10.1214/aos/1176343247">10.1214/aos/1176343247</a>.<br><br> Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2023).
“New estimation methods for extremal bivariate return curves.”
<em>Environmetrics</em>, <b>34</b>(5).
ISSN 1099095X, doi: <a href="https://doi.org/10.1002/env.2797">10.1002/env.2797</a>.<br><br> Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2024).
“Improving estimation for asymptotically independent bivariate extremes via global estimators for the angular dependence function.”
2303.13237.<br><br> Wadsworth JL, Tawn JA (2013).
“A new representation for multivariate tail probabilities.”
<em>Bernoulli</em>, <b>19</b>(5B), 2689-2714.
ISSN 13507265, doi: <a href="https://doi.org/10.3150/12-BEJ471">10.3150/12-BEJ471</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

prob &lt;- 10/n

margdata &lt;- margtransf(airdata)

retcurve &lt;- rc_est(margdata = margdata, p = prob, method = "hill")

plot(retcurve)

# To see the the S4 object's slots
str(retcurve)

# To access the return curve estimation
retcurve@rc

# If constrained = T, the MLE estimates for the conditional extremes model
# can be accessed as
retcurve@interval

</code></pre>


</div>