<div class="container">

<table style="width: 100%;"><tr>
<td>svymean_reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Generalized Regression Predictor (GREG) of the Mean and Total</h2>

<h3>Description</h3>

<p>Generalized regression estimator (GREG) predictor of the mean and total,
and robust GREG <code class="reqn">M</code>-estimator predictor
</p>


<h3>Usage</h3>

<pre><code class="language-R">svytotal_reg(object, totals, N = NULL, type, k = NULL, check.names = TRUE,
             keep_object = TRUE, ...)
svymean_reg(object, totals, N = NULL, type, k = NULL, check.names = TRUE,
            keep_object = TRUE, N_unknown = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>[svyreg_rob]</code>, e.g., result of
the Huber regression <code class="reqn">M</code>-estimator <code>svyreg_huberM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totals</code></td>
<td>
<p><code>[numeric]</code> vector of population totals of the
auxiliary variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p><code>[numeric]</code> population size (see also <code>N_unknown</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>[character]</code> type of predictor; see Details Section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p><code>[numeric]</code> robustness tuning constant of the
<code>psi</code>-function used in the bias-correction term of the GREG.
The definition of <code>k</code> depends on the <code>type</code> of predictor
and is discussed in the Details Section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.names</code></td>
<td>
<p><code>[logical]</code> if <code>TRUE</code>, the names of
<code>auxiliary</code> are checked against the names of the independent
variables of the fitted model <code>object</code> (default: <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_object</code></td>
<td>
<p><code>[logical]</code> if <code>TRUE</code>, <code>object</code> is
returned as an additional slot of the return value (default:
<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_unknown</code></td>
<td>
<p><code>[logical]</code> if <code>TRUE</code>, it is assumed that
the population size is unknown; thus, it is estimated
(default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments (currently not used).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Package <span class="pkg">survey</span> must be attached to the search path in order to use
the functions (see <code>library</code> or <code>require</code>).
</p>
<p>The (robust) GREG predictor of the population total or mean is
computed in two steps.
</p>

<ul>
<li>
<p> Step 1: Fit the regression model associated with the GREG
predictor by one of the functions <code>svyreg</code>,
<code>svyreg_huberM</code>, <code>svyreg_huberGM</code>,
<code>svyreg_tukeyM</code> or <code>svyreg_tukeyGM</code>.
The fitted model is called <code>object</code>.
</p>
</li>
<li>
<p> Step 2: Based on the fitted model obtained in the first step,
we predict the population total and mean, respectively, by
the predictors <code>svytotal_reg</code> and <code>svymean_reg</code>,
where <code>object</code> is the fitted regression model.
</p>
</li>
</ul>
<p>The following GREG predictors are available:
</p>

<dl>
<dt>GREG (not robust, <code>k = NULL</code>)</dt>
<dd>
<p>The following <em>non-robust</em> GREG predictors are available:
</p>

<ul>
<li> <p><code>type = "projective"</code> ignores the bias correction
term of the GREG predictor; see Särndal and Wright (1984).
</p>
</li>
<li> <p><code>type = "ADU"</code> is the "standard" GREG,
which is an asymptotically design unbiased (ADU)
predictor; see Särndal et al.(1992, Chapter 6).
</p>
</li>
</ul>
<p>If the fitted regression model (<code>object</code>) does include
a regression intercept, the predictor types <code>"projective"</code>
and <code>"ADU"</code> are identical because the bias correction
of the GREG is zero by design.
</p>
</dd>
<dt>Robust GREG</dt>
<dd>
<p>The following <em>robust</em> GREG predictors are available:
</p>

<ul>
<li> <p><code>type = "huber"</code> and <code>type = "tukey"</code> are,
respectively, the robust GREG predictors with Huber
and Tukey bisquare (biweight) psi-function. The tuning
constant must satisfy <code>0 &lt; k &lt;= Inf</code>.
We can use the Huber-type GREG predictor although the
model has been fitted by the regression estimator
with Tukey psi-function (and vice versa).
</p>
</li>
<li> <p><code>type = "BR"</code> is the bias-corrected robust GREG
predictor of Beaumont and Rivest (2009), which is
inspired by the bias-corrected robust predictor of
Chambers (1986). The tuning constant must satisfy
<code>0 &lt; k &lt;= Inf</code>.
</p>
</li>
<li> <p><code>type = "lee"</code> is the bias-corrected predictor
of Lee (1991; 1992). Tthe tuning constant <code>k</code> must
satisfy <code>0 &lt;= k &lt;= 1</code>.
</p>
</li>
<li> <p><code>type = "duchesne"</code> is the bias-corrected,
calibration-type estimator/ predictor of Duchesne (1999).
The tuning constant <code>k</code> must be specified as a
vector <code>k = c(a, b)</code>, where <code>a</code> and <code>b</code>
are the tuning constants of Duchesne's modified Huber
psi-function (default values: <code>a = 9</code> and
<code>b = 0.25</code>).
</p>
</li>
</ul>
</dd>
<dt>Auxiliary data</dt>
<dd>
<p>Two types of auxiliary variables are distinguished: (1)
population size <code class="reqn">N</code> and (2) population totals of the
auxiliary variables used in the regression model (i.e.,
non-constant explanatory variables).
</p>
<p>The option <code>N_unknown = TRUE</code> can be used in the predictor
of the population mean if <code class="reqn">N</code> is unknown.
</p>
<p>The names of the entries of <code>totals</code> are checked against
the names of the regression fit (<code>object</code>), unless we specify
<code>check.names = FALSE</code>.
</p>
</dd>
<dt>Utility functions</dt>
<dd>
<p>The return value is an object of class <code>svystat_rob</code>.
Thus, the utility functions <code>summary</code>,
<code>coef</code>,
<code>SE</code>,
<code>vcov</code>,
<code>residuals</code>,
<code>fitted</code>, and
<code>robweights</code> are available.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>Object of class <code>svystat_rob</code>
</p>


<h3>References</h3>

<p>Beaumont, J.-F. and Rivest, L.-P. (2009). Dealing with outliers in survey
data. In: <em>Sample Surveys: Theory, Methods and Inference</em>
ed. by Pfeffermann, D. and Rao, C. R. Volume 29A of
<em>Handbook of Statistics</em>, Amsterdam: Elsevier, Chap. 11, 247–280.
<a href="https://doi.org/10.1016/S0169-7161%2808%2900011-4">doi:10.1016/S0169-7161(08)00011-4</a>
</p>
<p>Chambers, R. (1986). Outlier Robust Finite Population Estimation.
<em>Journal of the American Statistical Association</em> <b>81</b>,
1063–1069. <a href="https://doi.org/10.1080/01621459.1986.10478374">doi:10.1080/01621459.1986.10478374</a>
</p>
<p>Duchesne, P. (1999). Robust calibration estimators, <em>Survey Methodology</em>
<b>25</b>, 43–56.
</p>
<p>Gwet, J.-P. and Rivest, L.-P. (1992). Outlier Resistant Alternatives to
the Ratio Estimator. <em>Journal of the American Statistical Association</em>
<b>87</b>, 1174–1182. <a href="https://doi.org/10.1080/01621459.1992.10476275">doi:10.1080/01621459.1992.10476275</a>
</p>
<p>Lee, H. (1991). Model-Based Estimators That Are Robust to Outliers,
in <em>Proceedings of the 1991 Annual Research Conference</em>,
Bureau of the Census, 178–202. Washington, DC, Department of Commerce.
</p>
<p>Lee, H. (1995). Outliers in business surveys. In:
<em>Business survey methods</em> ed. by Cox, B. G., Binder, D. A.,
Chinnappa, B. N., Christianson, A., Colledge, M. J. and Kott, P. S.
New York: John Wiley and Sons, Chap. 26, 503–526.
<a href="https://doi.org/10.1002/9781118150504.ch26">doi:10.1002/9781118150504.ch26</a>
</p>
<p>Särndal, C.-E., Swensson, B. and Wretman, J. (1992).
<em>Model Assisted Survey Sampling</em>, New York: Springer.
</p>
<p>Särndal, C.-E. and Wright, R. L. (1984). Cosmetic Form of Estimators
in Survey Sampling. <em>Scandinavian Journal of Statistics</em> <b>11</b>,
146–156.
</p>


<h3>See Also</h3>

<p>Overview (of all implemented functions)
</p>
<p><code>svymean_ratio</code> and <code>svytotal_ratio</code> for (robust)
ratio predictors
</p>
<p><code>svymean_huber</code>, <code>svytotal_huber</code>,
<code>svymean_tukey</code> and <code>svytotal_tukey</code> for
<code class="reqn">M</code>-estimators
</p>
<p><code>svyreg</code>, <code>svyreg_huberM</code>, <code>svyreg_huberGM</code>,
<code>svyreg_tukeyM</code> and <code>svyreg_tukeyGM</code> for robust
regression <code class="reqn">M</code>- and <code class="reqn">GM</code>-estimators
</p>


<h3>Examples</h3>

<pre><code class="language-R">head(workplace)

library(survey)
# Survey design for stratified simple random sampling without replacement
dn &lt;- if (packageVersion("survey") &gt;= "4.2") {
        # survey design with pre-calibrated weights
        svydesign(ids = ~ID, strata = ~strat, fpc = ~fpc, weights = ~weight,
                  data = workplace, calibrate.formula = ~-1 + strat)
    } else {
        # legacy mode
        svydesign(ids = ~ID, strata = ~strat, fpc = ~fpc, weights = ~weight,
                  data = workplace)
    }

# Robust regression M-estimator with Huber psi-function
reg &lt;- svyreg_huberM(payroll ~ employment, dn, k = 3)

# Summary of the regression M-estimate
summary(reg)

# Diagnostic plots of the regression M-estimate (e.g., standardized
# residuals against fitted values)
plot(reg, which = 1L)

# Plot of the robustness weights of the regression M-estimate against
# its residuals
plot(residuals(reg), robweights(reg))

# ADU (asymptotically design unbiased) estimator
m &lt;- svytotal_reg(reg, totals = 1001233, 90840, type = "ADU")
m

# Robust GREG estimator of the mean; the population means of the auxiliary
# variables are from a register
m &lt;- svymean_reg(reg, totals = 1001233, 90840, type = "huber", k = 20)
m

# Summary of the robust GREG estimate
summary(m)

# Extract estimate
coef(m)

# Extract estimated standard error
SE(m)

# Approximation of the estimated mean square error
mse(m)
</code></pre>


</div>