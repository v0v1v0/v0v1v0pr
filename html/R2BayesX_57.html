<div class="container">

<table style="width: 100%;"><tr>
<td>plot.bayesx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Default BayesX Plotting
</h2>

<h3>Description</h3>

<p>Generic functions for plotting objects of class <code>"bayesx"</code> and model term classes 
<code>"geo.bayesx"</code>, <code>"linear.bayesx"</code>, <code>"mrf.bayesx"</code>, <code>"random.bayesx"</code> and
<code>"sm.bayesx"</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'bayesx'
plot(x, model = NULL, term = NULL, which = 1L, ask = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a fitted <code>bayesx</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>for which model the plot should be provided, either an integer or a character, e.g. 
<code>model = "mcmc.model"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term</code></td>
<td>
<p>the term that should be plotted, either an integer or a character, e.g. 
<code>term = "sx(x)"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>choose the type of plot that should be drawn, possible options are: <code>"effect"</code>,
<code>"coef-samples"</code>, <code>"var-samples"</code>, <code>"intcpt-samples"</code>, <code>"hist-resid"</code>, 
<code>"qq-resid"</code>, <code>"scatter-resid"</code>, <code>"scale-resid"</code>, <code>"max-acf"</code>. Argument 
<code>which</code> may also be specified as integer, e.g. <code>which = 1</code>. The first three arguments 
are all model term specific. For the residual model diagnostic plot options <code>which</code> 
may be set with <code>which = 5:8</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other graphical parameters passed to <code>plotblock</code>, <code>plotmap</code>, 
<code>plot2d</code>, <code>plot3d</code>, <code>acf</code> and 
<code>density</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depending on the class of the term that should be plotted, function <code>plot.bayesx</code> calls one 
of the following plotting functions in the end:
</p>

<ul>
<li> <p><code>plotblock</code>,
</p>
</li>
<li> <p><code>plotsamples</code>,
</p>
</li>
<li> <p><code>plotmap</code>,
</p>
</li>
<li> <p><code>plot2d</code>,
</p>
</li>
<li> <p><code>plot3d</code>,
</p>
</li>
<li> <p><code>acf</code>,
</p>
</li>
<li> <p><code>density</code>,
</p>
</li>
</ul>
<p>For details on argument specifications, please see the help sites for the corresponding function.
</p>
<p>If argument <code>x</code> contains of more than one model and e.g. <code>term = 2</code>, the second terms
of all models will be plotted
</p>


<h3>Note</h3>

<p>If a model is specified with a structured and an unstructured spatial effect, e.g. the model 
formula is something like <code>y ~ sx(id, bs = "mrf", map = MapBnd) + sx(id, bs = "re")</code>, the
model output contains of one additional total spatial effect, named with <code>"sx(id):total"</code>.
Also see the last example. 
</p>


<h3>Author(s)</h3>

<p>Nikolaus Umlauf, Thomas Kneib, Stefan Lang, Achim Zeileis.
</p>


<h3>See Also</h3>

<p><code>plotblock</code>, <code>plotsamples</code>, <code>plotmap</code>, <code>plot2d</code>, 
<code>plot3d</code>, <code>bayesx</code>, <code>read.bayesx.output</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## generate some data
set.seed(111)
n &lt;- 500

## regressors
dat &lt;- data.frame(x = runif(n, -3, 3), z = runif(n, -3, 3),
   w = runif(n, 0, 6), fac = factor(rep(1:10, n/10)))

## response
dat$y &lt;- with(dat, 1.5 + sin(x) + cos(z) * sin(w) +
   c(2.67, 5, 6, 3, 4, 2, 6, 7, 9, 7.5)[fac] + rnorm(n, sd = 0.6))

## estimate model
b1 &lt;- bayesx(y ~ sx(x) + sx(z, w, bs = "te") + fac,
   data = dat, method = "MCMC")

## plot p-spline term
plot(b1, term = 1)
## same with
plot(b1, term = "sx(x)")

## with residuals
plot(b1, term = "sx(x)", residuals = TRUE)

## plot tensor term
plot(b1, term = "sx(z,w)")

## use other palette
plot(b1, term = "sx(z,w)", col.surface = heat.colors)

## swap colors
plot(b1, term = "sx(z,w)", col.surface = heat.colors, swap = TRUE)

## plot tensor term with residuals
plot(b1, term = "sx(z,w)", residuals = TRUE)

## plot image and contour
plot(b1, term = "sx(z,w)", image = TRUE)
plot(b1, term = "sx(z,w)", image = TRUE, contour = TRUE)

## increase the grid
plot(b1, term = "sx(z,w)", image = TRUE, contour = TRUE, grid = 100)

## plot factor term
plot(b1, term = "fac")

## plot factor term with residuals
plot(b1, term = "fac", resid = TRUE, cex = 0.5)

## plot residual dignostics
plot(b1, which = 5:8)

## plot variance sampling path of term sx(x)
plot(b1, term = 1, which = "var-samples")

## plot coefficients sampling paths of term sx(x)
plot(b1, term = 1, which = "coef-samples")

## plot the sampling path of the intercept
par(mfrow = c(1, 1))
plot(b1, which = "intcpt-samples")

## plot the autcorrelation function  
## of the sampled intercept
plot(b1, which = "intcpt-samples", 
  acf = TRUE, lag.max = 50)

## increase lags
plot(b1, which = "intcpt-samples", 
  acf = TRUE, lag.max = 200)

## plot maximum autocorrelation 
## of all sampled parameters in b1
plot(b1, which = "max-acf")

## plot maximum autocorrelation of 
## all sampled coefficients of term sx(x)
plot(b1, term = "sx(x)", which = "coef-samples", 
  max.acf = TRUE, lag.max = 100)


## now a spatial example
set.seed(333)

## simulate some geographical data
data("MunichBnd")
N &lt;- length(MunichBnd); names(MunichBnd) &lt;- 1:N
n &lt;- N*5

## regressors
dat &lt;- data.frame(id = rep(1:N, n/N), x1 = runif(n, -3, 3))
dat$sp &lt;- with(dat, sort(runif(N, -2, 2), decreasing = TRUE)[id])
dat$re &lt;- with(dat, rnorm(N, sd = 0.6)[id])

## response
dat$y &lt;- with(dat, 1.5 + sin(x1) + sp + re + rnorm(n, sd = 0.6))

## estimate model
b2 &lt;- bayesx(y ~ sx(x1) + sx(id, bs = "mrf", map = MunichBnd) +
  sx(id, bs = "re"), method = "MCMC", data = dat)

## summary statistics
summary(b2)

## plot structured spatial effect
plot(b2, term = "sx(id)", map = MunichBnd)

## plot unstructured spatial effect
plot(b2, term = "sx(id):re", map = MunichBnd)

## now without map
## generates a kernel density plot
## of the effects
plot(b2, term = "sx(id):mrf", map = FALSE)
plot(b2, term = "sx(id):re", map = FALSE)

## with approximate quantiles of the  
## kernel density estimate 
plot(b2, term = "sx(id):re", map = FALSE, 
  kde.quantiles = TRUE, probs = c(0.025, 0.5, 0.975))

## plot the total spatial effect
plot(b2, term = "sx(id):total")
plot(b2, term = "sx(id):total", map = MunichBnd)

## combine model objects
b &lt;- c(b1, b2)

## plot first term of second model
plot(b, model = 2, term = 1)
plot(b, model = "b2", term = "sx(x1)")

## plot second term of both models
plot(b, term = 2, map = MunichBnd)

## plot everything
plot(b)

## End(Not run)
</code></pre>


</div>