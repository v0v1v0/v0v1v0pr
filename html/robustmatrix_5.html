<div class="container">

<table style="width: 100%;"><tr>
<td>mmcd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Matrix Minimum Covariance Determinant (MMCD) Estimator</h2>

<h3>Description</h3>

<p><code>mmcd</code> computes the robust MMCD estimators of location and covariance for matrix-variate data
using the FastMMCD algorithm (double-blind 2024).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mmcd(
  X,
  nsamp = 500L,
  alpha = 0.5,
  lambda = 0,
  max_iter_cstep = 100L,
  max_iter_MLE = 100L,
  max_iter_cstep_init = 2L,
  max_iter_MLE_init = 2L,
  adapt_alpha = TRUE,
  reweight = TRUE,
  scale_consistency = "quant",
  outlier_quant = 0.975,
  nthreads = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a 3d array of dimension <code class="reqn">(p,q,n)</code>, containing <code class="reqn">n</code> matrix-variate samples of <code class="reqn">p</code> rows and <code class="reqn">q</code> columns in each slice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>number of initial h-subsets (default is 500).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric parameter between 0.5 (default) and 1. Controls the size <code class="reqn">h \approx alpha * n</code> of the h-subset over which the determinant is minimized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a smooting parameter for the rowwise and columnwise covariance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter_cstep</code></td>
<td>
<p>upper limit of C-step iterations (default is 100)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter_MLE</code></td>
<td>
<p>upper limit of MLE iterations (default is 100)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter_cstep_init</code></td>
<td>
<p>upper limit of C-step iterations for initial h-subsets (default is 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter_MLE_init</code></td>
<td>
<p>upper limit of MLE iterations for initial h-subsets (default is 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt_alpha</code></td>
<td>
<p>Logical. If TRUE (default) alpha is adapted to take the dimension of the data into account.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reweight</code></td>
<td>
<p>Logical. If TRUE (default) the reweighted MMCD estimators are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_consistency</code></td>
<td>
<p>Character. Either "quant" (default) or "mmd_med". If "quant", the consistency factor is chosen to achieve consistency under the matrix normal distribution.
If "mmd_med", the consistency factor is chosen based on the Mahalanobis distances of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier_quant</code></td>
<td>
<p>numeric parameter between 0 and 1. Chi-square quantile used in the reweighting step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthreads</code></td>
<td>
<p>Integer. If 1 (default), all computations are carried out sequentially.
If larger then 1, C-steps are carried out in parallel using <code>nthreads</code> threads.
If &lt; 0, all possible threads are used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The MMCD estimators generalize the well-known Minimum Covariance Determinant (MCD)
(Rousseeuw 1985; Rousseeuw and Driessen 1999) to the matrix-variate setting.
It looks for the <code class="reqn">h</code> observations, <code class="reqn">h = \alpha * n</code>, whose covariance matrix has the smallest determinant.
The FastMMCD algorithm is used for computation and is described in detail in (double-blind 2024).
NOTE: The procedure depends on <em>random</em> initial subsets. Currently setting a seed is only possible if <code>nthreads = 1</code>.
</p>


<h3>Value</h3>

<p>A list containing the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Estimated <code class="reqn">p \times q</code> mean matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_row</code></td>
<td>
<p>Estimated <code class="reqn">p</code> times <code class="reqn">p</code> rowwise covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_col</code></td>
<td>
<p>Estimated <code class="reqn">q</code> times <code class="reqn">q</code> columnwise covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_row_inv</code></td>
<td>
<p>Inverse of <code>cov_row</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_col_inv</code></td>
<td>
<p>Inverse of <code>cov_col</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>md</code></td>
<td>
<p>Squared Mahalanobis distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>md_raw</code></td>
<td>
<p>Squared Mahalanobis distances based on <em>raw</em> MMCD estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det</code></td>
<td>
<p>Value of objective function (determinant of Kronecker product of rowwise and columnwise covariane).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The (adjusted) value of alpha used to determine the size of the h-subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consistency_factors</code></td>
<td>
<p>Consistency factors for raw and reweighted MMCD estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dets</code></td>
<td>
<p>Objective values for the final h-subsets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best_i</code></td>
<td>
<p>ID of subset with best objective.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_subset</code></td>
<td>
<p>Final h-subset of <em>raw</em> MMCD estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_subset_reweighted</code></td>
<td>
<p>Final h-subset of <em>reweighted</em> MMCD estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of C-steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dets_init_first</code></td>
<td>
<p>Objective values for the <code>nsamp</code> initial h-subsets after <code>max_iter_cstep_init</code> C-steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsets_first</code></td>
<td>
<p>Subsets created in subsampling procedure for large <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dets_init_second</code></td>
<td>
<p>Objective values of the 10 best initial subsets after executing C-steps until convergence.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Rousseeuw P (1985).
“Multivariate Estimation With High Breakdown Point.”
<em>Mathematical Statistics and Applications Vol. B</em>, 283-297.
<a href="https://doi.org/10.1007/978-94-009-5438-0_20">doi:10.1007/978-94-009-5438-0_20</a>.<br><br> Rousseeuw PJ, Driessen KV (1999).
“A Fast Algorithm for the Minimum Covariance Determinant Estimator.”
<em>Technometrics</em>, <b>41</b>(3), 212-223.
<a href="https://doi.org/10.1080/00401706.1999.10485670">doi:10.1080/00401706.1999.10485670</a>.<br><br> double-blind (2024).
“Robust covariance estimation and explainable outlier detection for matrix-valued data.”
<em>[Manuscript submitted for publication]</em>.
</p>


<h3>See Also</h3>

<p>The <code>mmcd</code> algorithm uses the <code>cstep</code> and <code>mmle</code> functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 1000; p = 2; q = 3
mu = matrix(rep(0, p*q), nrow = p, ncol = q)
cov_row = matrix(c(1,0.5,0.5,1), nrow = p, ncol = p)
cov_col = matrix(c(3,2,1,2,3,2,1,2,3), nrow = q, ncol = q)
X &lt;- rmatnorm(n = n, mu, cov_row, cov_col)
ind &lt;- sample(1:n, 0.3*n)
X[,,ind] &lt;- rmatnorm(n = length(ind), matrix(rep(10, p*q), nrow = p, ncol = q), cov_row, cov_col)
par_mmle &lt;- mmle(X)
par_mmcd &lt;- mmcd(X)
distances_mmle &lt;- mmd(X, par_mmle$mu, par_mmle$cov_row, par_mmle$cov_col)
distances_mmcd &lt;- mmd(X, par_mmcd$mu, par_mmcd$cov_row, par_mmcd$cov_col)
plot(distances_mmle, distances_mmcd)
abline(h = qchisq(0.99, p*q), lty = 2, col = "red")
abline(v = qchisq(0.99, p*q), lty = 2, col = "red")
</code></pre>


</div>