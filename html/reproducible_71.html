<div class="container">

<table style="width: 100%;"><tr>
<td>createCache</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Low-level functions to create and work with a cache</h2>

<h3>Description</h3>

<p><strong>These are intended for advanced use only.</strong>
</p>


<h3>Usage</h3>

<pre><code class="language-R">createCache(
  cachePath = getOption("reproducible.cachePath"),
  drv = getDrv(getOption("reproducible.drv", NULL)),
  conn = getOption("reproducible.conn", NULL),
  force = FALSE,
  verbose = getOption("reproducible.verbose")
)

loadFromCache(
  cachePath = getOption("reproducible.cachePath"),
  cacheId,
  preDigest,
  fullCacheTableForObj = NULL,
  format = getOption("reproducible.cacheSaveFormat", "rds"),
  .functionName = NULL,
  .dotsFromCache = NULL,
  drv = getDrv(getOption("reproducible.drv", NULL)),
  conn = getOption("reproducible.conn", NULL),
  verbose = getOption("reproducible.verbose")
)

extractFromCache(sc, elem, ifNot = NULL)

rmFromCache(
  cachePath = getOption("reproducible.cachePath"),
  cacheId,
  drv = getDrv(getOption("reproducible.drv", NULL)),
  conn = getOption("reproducible.conn", NULL),
  format = getOption("reproducible.cacheSaveFormat", "rds")
)

CacheDBFile(
  cachePath = getOption("reproducible.cachePath"),
  drv = getDrv(getOption("reproducible.drv", NULL)),
  conn = getOption("reproducible.conn", NULL)
)

CacheStorageDir(cachePath = getOption("reproducible.cachePath"))

CacheStoredFile(
  cachePath = getOption("reproducible.cachePath"),
  cacheId,
  format = NULL,
  obj = NULL
)

CacheDBTableName(
  cachePath = getOption("reproducible.cachePath"),
  drv = getDrv(getOption("reproducible.drv", NULL))
)

CacheIsACache(
  cachePath = getOption("reproducible.cachePath"),
  create = FALSE,
  drv = getDrv(getOption("reproducible.drv", NULL)),
  conn = getOption("reproducible.conn", NULL)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cachePath</code></td>
<td>
<p>A path describing the directory in which to create
the database file(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drv</code></td>
<td>
<p>A driver, passed to <code>dbConnect</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conn</code></td>
<td>
<p>an optional DBIConnection object, as returned by dbConnect().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>Logical. Should it create a cache in the <code>cachePath</code>,
even if it already exists, overwriting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Numeric, -1 silent (where possible), 0 being very quiet,
1 showing more messaging, 2 being more messaging, etc.
Default is 1. Above 3 will output much more information about the internals of
Caching, which may help diagnose Caching challenges. Can set globally with an
option, e.g., <code style="white-space: pre;">⁠options('reproducible.verbose' = 0) to reduce to minimal⁠</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cacheId</code></td>
<td>
<p>The cacheId or otherwise digested hash value, as character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preDigest</code></td>
<td>
<p>The list of <code>preDigest</code> that comes from <code>CacheDigest</code> of an object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullCacheTableForObj</code></td>
<td>
<p>The result of <code>showCache</code>, but subsetted for only
the <code>cacheId</code> being loaded or selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>The text string representing the file extension used normally by
different save formats; currently only <code>"rds"</code> or <code>"qs"</code>. Defaults
to <code>getOption("reproducible.cacheSaveFormat", "rds")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.functionName</code></td>
<td>
<p>Optional. Used for messaging when this function is called from <code>Cache</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.dotsFromCache</code></td>
<td>
<p>Optional. Used internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>a cache tags <code>data.table</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elem</code></td>
<td>
<p>character string specifying a <code>tagKey</code> value to match</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ifNot</code></td>
<td>
<p>character (or NULL) specifying the return value to use if <code>elem</code> not matched</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>The optional object that is of interest; it may have an attribute "saveRawFile"
that would be important.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>create</code></td>
<td>
<p>Logical. Currently only affects non <span class="pkg">RSQLite</span> default drivers.
If <code>TRUE</code> and there is no Cache database, the function will create one.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul><li> <p><code>createCache()</code> will create a Cache folder structure and necessary files, based on
the particular <code>drv</code> or <code>conn</code> provided;
</p>
</li></ul>
<ul><li> <p><code>loadFromCache()</code> retrieves a single object from the cache, given its <code>cacheId</code>;
</p>
</li></ul>
<ul><li> <p><code>extractFromCache()</code> retrieves a single <code>tagValue</code> from the cache based on
the <code>tagKey</code> of <code>elem</code>;
</p>
</li></ul>
<ul><li> <p><code>rmFromCache()</code> removes one or more items from the cache, and updates the cache
database files.
</p>
</li></ul>
<h3>Value</h3>


<ul><li> <p><code>createCache()</code> returns <code>NULL</code> (invisibly) and intended to be called for side effects;
</p>
</li></ul>
<ul><li> <p><code>loadFromCache()</code> returns the object from the cache that has the particular <code>cacheId</code>;
</p>
</li></ul>
<ul><li> <p><code>extractFromCache()</code> returns the <code>tagValue</code> from the cache corresponding to <code>elem</code> if found,
otherwise the value of <code>ifNot</code>;
</p>
</li></ul>
<ul><li> <p><code>rmFromCache()</code> returns <code>NULL</code> (invisibly) and is intended to be called for side effects;
</p>
</li></ul>
<ul>
<li> <p><code>CacheDBFile()</code> returns the name of the database file for a given Cache,
when <code>useDBI() == FALSE</code>, or <code>NULL</code> if <code>TRUE</code>;
</p>
</li>
<li> <p><code>CacheDBFiles()</code> (i.e,. plural) returns the name of all the database files for
a given Cache when <code>useDBI() == TRUE</code>, or <code>NULL</code> if <code>FALSE</code>;
</p>
</li>
<li> <p><code>CacheStoredFile()</code> returns the file path to the file with the specified hash value,
This can be loaded to memory with e.g., <code>loadFile()</code>.;
</p>
</li>
</ul>
<ul><li> <p><code>CacheStorageDir()</code> returns the name of the directory where cached objects are stored;
</p>
</li></ul>
<ul><li> <p><code>CacheStoredFile</code> returns the file path to the file with the specified hash value;
</p>
</li></ul>
<ul><li> <p><code>CacheDBTableName()</code> returns the name of the table inside the SQL database, if that
is being used;
</p>
</li></ul>
<ul><li> <p><code>CacheIsACache()</code> returns a logical indicating whether the <code>cachePath</code> is currently
a <code>reproducible</code> cache database;
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R">data.table::setDTthreads(2)
newCache &lt;- tempdir2()
createCache(newCache)

out &lt;- Cache(rnorm(1), cachePath = newCache)
cacheId &lt;- gsub("cacheId:", "", attr(out, "tags"))
loadFromCache(newCache, cacheId = cacheId)

rmFromCache(newCache, cacheId = cacheId)

# clean up
unlink(newCache, recursive = TRUE)

data.table::setDTthreads(2)
newCache &lt;- tempdir2()

# Given the drv and conn, creates the minimum infrastructure for a cache
createCache(newCache)

CacheDBFile(newCache) # identifies the database file
CacheStorageDir(newCache) # identifies the directory where cached objects are stored

out &lt;- Cache(rnorm(1), cachePath = newCache)
cacheId &lt;- gsub("cacheId:", "", attr(out, "tags"))
CacheStoredFile(newCache, cacheId = cacheId)

# The name of the table inside the SQL database
CacheDBTableName(newCache)

CacheIsACache(newCache) # returns TRUE

# clean up
unlink(newCache, recursive = TRUE)
</code></pre>


</div>