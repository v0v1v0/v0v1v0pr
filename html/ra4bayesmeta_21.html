<div class="container">

<table style="width: 100%;"><tr>
<td>post_RA_3bm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Posterior reference analysis based on a data frame using 3 benchmarks

</h2>

<h3>Description</h3>

<p>Computes a table of Hellinger distances between marginal posterior distributions
for different parameters in the NNHM
induced by the actual heterogeneity priors specified in <code>tau.prior</code> and
posterior benchmarks proposed in the Supplementary Material of Ott et al. (2021).

</p>


<h3>Usage</h3>

<pre><code class="language-R">post_RA_3bm(df, tau.prior=list(function(x) dhalfnormal(x, scale=1)),
            H.dist.method = "integral",
            m_inf=NA, M_inf=NA, rlmc0=0.0001, rlmc1=0.9999,
            mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>data frame with one column "y" containing the (transformed) effect estimates for the individual studies and
one column "sigma" containing the standard errors of these estimates.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>H.dist.method</code></td>
<td>

<p>method for computation of Hellinger distances between marginal posterior densities. Either <code>"integral"</code> for integral-based computation or <code>"moment"</code> for approximate moment-based calculation using a normal approximation. Defaults to <code>"integral"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_inf</code></td>
<td>

<p>parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 0.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_inf_sgc</code>, such that the median RLMC is
approximately equal to <code>rlmc0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_inf</code></td>
<td>

<p>parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 1.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_inf_sigc</code>, such that the median RLMC is
approximately equal to <code>rlmc1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlmc0</code></td>
<td>

<p>RLMC target value for the SGC(<code class="reqn">m_{inf}</code>) benchmark prior (typically close to 0).
Is required only if <code>m_inf=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlmc1</code></td>
<td>

<p>RLMC target value for the SIGC(<code class="reqn">M_{inf}</code>) benchmark prior (typically close to 1).
Is required only if <code>M_inf=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The three posterior benchmarks used are
introduced in the Supplementary Material of Ott et al. (2021, Sections 2.2.1 and 2.5, see also Section 3.4 in Ott at al. (2021) for Jeffreys reference prior),
where they are denoted by
<code class="reqn">po_{m_{inf}}(\Psi)</code>, <code class="reqn">po_{J}(\Psi)</code> and <code class="reqn">po_{M_{inf}}(\Psi)</code>.
Here, <code class="reqn">\Psi \in \{ \mu, \tau, \theta_1, ..., \theta_k, \theta_{new}  \}</code>
denotes the parameter of interest in the NNHM,
where <code class="reqn">\theta_{i}</code> is the random effect in the <code class="reqn">i</code>th study and
<code class="reqn">\theta_{new}</code> the predicted effect for a new study.
</p>
<p>Note that Jeffreys reference posterior <code class="reqn">po_{J}</code> is proper if
there are at least two studies in the meta-analysis data set.
It is based on the improper Jeffreys reference prior,
which is minimally informative given the data.
</p>
<p>If integral-based computation (<code>H.dist.method = "integral"</code>) of Hellinger distances is selected (the default), numerical integration is applied to obtain the Hellinger distance between the two marginal posterior densities (by using the function <code>H</code>).
If moment-based computation (<code>H.dist.method = "moment"</code>) is selected, the marginal densities are first approximated by normal densities with the same means and standard deviations and then the Hellinger distance between these normal densities can be obtained by an analytical formula (implemented in the function <code>H_normal</code>).
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.

</p>


<h3>Value</h3>

<p>A list with two elements:
The first element named "table" is a matrix containing the Hellinger distance estimates and the
second element called "par" is a named vector giving the parameter values
of the benchmark priors.
The vector "par" has the following three components:
<code>m_inf</code>, <code>M_inf</code> and <code>C</code>.
</p>
<p>The matrix "table" contains the Hellinger distance estimates between marginal posteriors
and has <code class="reqn">3</code> columns and <code class="reqn">n*(k+3)</code> rows,
where <code class="reqn">n</code>=length(<code>tau.prior</code>) is the number of actual heterogeneity priors specified
and <code class="reqn">k</code> is the number of studies in the meta-analysis data set
(so that there are <code class="reqn">k+3</code> parameters of interest).
</p>
<p>The columns of the matrix give the following Hellinger distance estimates
between two marginal posteriors (for the parameter of interest <code class="reqn">\Psi</code> varying with rows)
induced by the following two heterogeneity priors
(from left to right):
</p>

<dl>
<dt>
<code>H(po_{m_inf}, po_act)</code>:</dt>
<dd>
<p> benchmark prior SGC(m_inf) and actual prior</p>
</dd>
<dt>
<code>H(po_J, po_act)</code>:</dt>
<dd>
<p> Jeffreys reference prior <code class="reqn">\pi_J</code> and actual prior</p>
</dd>
<dt>
<code>H(po_{M_inf}, po_act)</code>:</dt>
<dd>
<p> benchmark prior SIGC(M_inf) and actual prior</p>
</dd>
</dl>
<p>The actual heterogenity prior and the parameter of interest <code class="reqn">\Psi</code> vary
with the rows in the following order:
</p>

<dl>
<dt>
<code>mu, pri_act_1</code>:</dt>
<dd> <p><code class="reqn">\Psi=\mu</code> and first actual prior in <code>tau.prior</code></p>
</dd>
<dt>
<code>mu, pri_act_2</code>:</dt>
<dd> <p><code class="reqn">\Psi=\mu</code> and second actual prior in <code>tau.prior</code></p>
</dd>
<dt>... </dt>
<dd> </dd>
<dt>
<code>mu, pri_act_n</code>:</dt>
<dd> <p><code class="reqn">\Psi=\mu</code> and nth actual prior in <code>tau.prior</code></p>
</dd>
<dt>
<code>tau, pri_act_1</code>:</dt>
<dd> <p><code class="reqn">\Psi=\tau</code> and first actual prior in <code>tau.prior</code></p>
</dd>
<dt>... </dt>
<dd> </dd>
<dt>
<code>tau, pri_act_n</code>:</dt>
<dd> <p><code class="reqn">\Psi=\tau</code> and nth actual prior</p>
</dd>
<dt>
<code>theta_1, pri_act_1</code>:</dt>
<dd> <p><code class="reqn">\Psi=\theta_1</code> and first actual prior</p>
</dd>
<dt>... </dt>
<dd> </dd>
<dt>
<code>theta_k, pri_act_n</code>:</dt>
<dd> <p><code class="reqn">\Psi=\theta_k</code> and nth actual prior</p>
</dd>
<dt>
<code>theta_new, pri_act_1</code>:</dt>
<dd> <p><code class="reqn">\Psi=\theta_{new}</code> and first actual prior</p>
</dd>
<dt>... </dt>
<dd> </dd>
<dt>
<code>theta_new, pri_act_n</code>:</dt>
<dd> <p><code class="reqn">\Psi=\theta_{new}</code> and nth actual prior</p>
</dd>
</dl>
<h3>Warnings </h3>

<p>A warning message will be displayed if one of the parameters <code>m_inf</code> or <code>M_inf</code>
has a value larger than 5*10^6, since this may lead to numerical problems
in the <code>bayesmeta</code> function
used for computation of the marginal posteriors.
</p>
<p>If the integral-based method is used to compute Hellinger distances (<code>H.dist.method = "integral"</code>),
numerical problems may occur in some cases, which may lead to implausible outputs.
Therefore, we generally recommend to double-check the results of the integral-based method using the moment-based method (<code>H.dist.method = "moment"</code>) - especially if the former results are implausibe. If large differences between the two methods are observed, we recommend to rely on the moment-based method unless a normal approximation of the involved densities is inappropriate.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505â€“4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code>post_RA_fits</code>,
<code>pri_RA_5bm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># for aurigular acupuncture (AA) data set with two
# actual half-normal heterogeneity priors
data(aa)
# it takes several seconds to run this function
post_RA_3bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=0.5),
                                  function(t)dhalfnormal(t, scale=1)))

</code></pre>


</div>