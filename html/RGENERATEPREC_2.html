<div class="container">

<table style="width: 100%;"><tr>
<td>CCGammaToBlockmatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This function returns a <code>blockmatrix</code> object containing the gaussian cross-correlation matrices.</h2>

<h3>Description</h3>

<p>This function returns a <code>blockmatrix</code> object containing the gaussian cross-correlation matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CCGammaToBlockmatrix(data, lag = 0, p = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame or 'zoo' R object containing daily precipitation time series for several gauges (one gauge time series per column). See <code>CCGamma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>numeric (expressed as number of days) used for the element [1,1] of the returned blockmatrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric order $p$ of the auto-regeression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further argments of <code>CCGamma</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This a wrapper for <code>CCGamma</code> with the option <code>only.matrix=TRUE</code> and the function value is transformed into a <code>blockmatrix</code> object.
</p>


<h3>Value</h3>

<p>A <code>blockmatrix</code> object containing the gaussian cross-correlation matrices.
</p>


<h3>See Also</h3>

<p><code>CCGamma</code>,<code>continuity_ratio</code>,<code>omega_inv</code>,<code>omega</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
station &lt;- names(PRECIPITATION)[!(names(PRECIPITATION) %in% c("day","month","year"))]
prec_mes &lt;- PRECIPITATION[period,station]  

## removing nonworking stations (e.g. time series with NA)
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
		 accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it]))
}

prec_mes &lt;- prec_mes[,accepted]
## the dateset is reduced!!! 
prec_mes &lt;- prec_mes[,1:2]

p &lt;- 1 ## try p &lt;- 2 !!!  
CCGamma &lt;- CCGammaToBlockmatrix(data=prec_mes,lag=0,p=p,tolerance=0.001)

## Not Run in the examples, uncomment to run the following line
 CCGamma_1 &lt;- CCGammaToBlockmatrix(data=prec_mes,lag=1,p=p,tolerance=0.001)


### Alternatively, recommended ..... 
## Not Run in the examples, uncomment to run the following line
 CCGamma &lt;- CCGammaToBlockmatrix(data=prec_mes,lag=0,p=p+1,tolerance=0.001)

 CCGamma0 &lt;- CCGamma[1:p,1:p]
 CCGamma1 &lt;- CCGamma[(1:p),(1:p)+1]

 CCGamma0_inv &lt;- solve(CCGamma0)


## Not Run in the examples, uncomment to run the following line
a1 &lt;- blockmatmult(CCGamma0,CCGamma0_inv)
a2 &lt;- blockmatmult(CCGamma1,CCGamma0_inv)



CCGamma_1t &lt;- t(CCGamma1)
CCGamma_0t &lt;- t(CCGamma0)

 A &lt;- t(solve(CCGamma_0t,CCGamma_1t))



</code></pre>


</div>