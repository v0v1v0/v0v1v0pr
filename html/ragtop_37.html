<div class="container">

<table style="width: 100%;"><tr>
<td>implied_volatilities_with_rates_struct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the implied volatility of european-exercise options with a term structure of interest rates</h2>

<h3>Description</h3>

<p>Use the provided discount factor function to infer constant short rates applicable to each
expiration time, then use the Black-Scholes formula to generate European option values and run them
through Newton's method until a constant volatility matching each provided
option price has been found.
</p>


<h3>Usage</h3>

<pre><code class="language-R">implied_volatilities_with_rates_struct(
  option_price,
  callput,
  S0,
  K,
  discount_factor_fcn,
  time,
  const_default_intensity = 0,
  divrate = 0,
  borrow_cost = 0,
  dividends = NULL,
  relative_tolerance = 1e-06,
  max.iter = 100,
  max_vola = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>option_price</code></td>
<td>
<p>Present option values (may be a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callput</code></td>
<td>
<p>1 for calls, -1 for puts (may be a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>initial underlying prices (may be a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>strikes (may be a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discount_factor_fcn</code></td>
<td>
<p>A function for computing present values to
time <code>t</code>, with arguments <code>T</code>, <code>t</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Time from <code>0</code> until expirations (may be a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const_default_intensity</code></td>
<td>
<p>hazard rates of underlying default  (may be a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>divrate</code></td>
<td>
<p>A continuous rate for dividends and other cashflows such as foreign interest rates  (may be a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>borrow_cost</code></td>
<td>
<p>A continuous rate for stock borrow costs  (may be a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dividends</code></td>
<td>
<p>A <code>data.frame</code> with columns <code>time</code>, <code>fixed</code>,
and <code>proportional</code>.  Dividend size at the given <code>time</code> is
then expected to be equal to <code>fixed + proportional * S / S0</code>.  Fixed
dividends will be converted to proprtional for purposes of this algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative_tolerance</code></td>
<td>
<p>Relative tolerance in option price to achieve before halting the search</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Number of iterations to try before abandoning the search</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_vola</code></td>
<td>
<p>Maximum volatility to try in the search</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Differs from <code>implied_volatility_with_term_struct</code> by first computing constant interest rates
for each option, and then calling <code>implied_volatilities</code>
</p>


<h3>Value</h3>

<p>Scalar volatilities
</p>


<h3>See Also</h3>

<p><code>implied_volatility</code> for simpler cases with constant
parameters, <code>implied_volatilities</code> for the underlying
algorithm with constant rates, <code>implied_volatility_with_term_struct</code> when
volatilities or survival probabilities also have a nontrivial term structure
</p>
<p>Other Implied Volatilities: 
<code>american_implied_volatility()</code>,
<code>equivalent_bs_vola_to_jump()</code>,
<code>equivalent_jump_vola_to_bs()</code>,
<code>fit_variance_cumulation()</code>,
<code>implied_jump_process_volatility()</code>,
<code>implied_volatilities()</code>,
<code>implied_volatility_with_term_struct()</code>,
<code>implied_volatility()</code>
</p>
<p>Other European Options: 
<code>black_scholes_on_term_structures()</code>,
<code>blackscholes()</code>,
<code>implied_volatilities()</code>,
<code>implied_volatility_with_term_struct()</code>,
<code>implied_volatility()</code>
</p>
<p>Other Equity Independent Default Intensity: 
<code>american_implied_volatility()</code>,
<code>american()</code>,
<code>black_scholes_on_term_structures()</code>,
<code>blackscholes()</code>,
<code>equivalent_bs_vola_to_jump()</code>,
<code>equivalent_jump_vola_to_bs()</code>,
<code>implied_volatilities()</code>,
<code>implied_volatility_with_term_struct()</code>,
<code>implied_volatility()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  d_fcn = function(T,t) {exp(-0.03*(T-t))}
  implied_volatilities_with_rates_struct(c(23,24,25),
         c(-1,1,1), 100, 100,
         discount_factor_fcn=d_fcn, time=c(4,4,5))

</code></pre>


</div>