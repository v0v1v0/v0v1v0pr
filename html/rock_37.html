<div class="container">

<table style="width: 100%;"><tr>
<td>doc_to_txt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a document (.docx, .pdf, .odt, .rtf, or .html) to a plain text file</h2>

<h3>Description</h3>

<p>This used to be a thin wrapper around <code>textreadr::read_document()</code> that also
writes the result to <code>output</code>, doing its best to correctly write UTF-8
(based on the approach recommended in <a href="https://tomizonor.wordpress.com/2013/04/17/file-utf8-windows/">this blog post</a>). However,
<code>textreadr</code> was archived from CRAN. It now directly wraps the functions
that <code>textreadr</code> wraps: <code>pdftools::pdf_text()</code>, <code>striprtf::read_rtf</code>, and
it uses <code>xml2</code> to import <code>.docx</code> and <code>.odt</code> files, and <code>rvest</code> to import
<code>.html</code> files, using the code from the <code>textreadr</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">doc_to_txt(
  input,
  output = NULL,
  encoding = rock::opts$get("encoding"),
  newExt = NULL,
  preventOverwriting = rock::opts$get("preventOverwriting"),
  silent = rock::opts$get("silent")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>The path to the input file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>The path and filename to write to. If this is a path to
an existing directory (without a filename specified), the <code>input</code> filename
will be used, and the extension will be replaced with <code>extension</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>encoding</code></td>
<td>
<p>The encoding to use when writing the text file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newExt</code></td>
<td>
<p>The extension to append: only used if <code>output = NULL</code> and
<code>newExt</code> is not <code>NULL</code>, in which case the output will be written to a file
with the same name as <code>input</code> but with <code>newExt</code> as extension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preventOverwriting</code></td>
<td>
<p>Whether to prevent overwriting existing files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Whether to the silent or chatty.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The converted source, as a character vector.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### This example requires the {xml2} package
if (requireNamespace("xml2", quietly = TRUE)) {
  print(
    rock::doc_to_txt(
      input = system.file(
        "extdata/doc-to-test.docx", package="rock"
      )
    )
  );
}
</code></pre>


</div>