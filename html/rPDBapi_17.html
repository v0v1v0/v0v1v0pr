<div class="container">

<table style="width: 100%;"><tr>
<td>get_fasta_from_rcsb_entry</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieve FASTA Sequence from PDB Entry or Specific Chain</h2>

<h3>Description</h3>

<p>This function retrieves FASTA sequences from the RCSB Protein Data Bank (PDB) for a specified entry ID (<code>rcsb_id</code>). It can return either the full set of sequences associated with the entry or, if specified, the sequence corresponding to a particular chain within that entry. This flexibility makes it a useful tool for bioinformaticians and structural biologists needing access to protein or nucleic acid sequences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_fasta_from_rcsb_entry(
  rcsb_id,
  chain_id = NULL,
  verbosity = TRUE,
  fasta_base_url = FASTA_BASE_URL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rcsb_id</code></td>
<td>
<p>A string representing the PDB ID for which the FASTA sequence is to be retrieved. This is the primary identifier of the entry in the PDB database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain_id</code></td>
<td>
<p>A string representing the specific chain ID within the PDB entry for which the FASTA sequence is to be retrieved. If <code>chain_id</code> is NULL (the default), the function will return all sequences associated with the entry. The chain ID should match one of the chain identifiers in the PDB entry (e.g., "A", "B").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>A boolean flag indicating whether to print status messages during the function execution. When set to <code>TRUE</code> (the default), the function will output messages detailing the progress and any issues encountered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fasta_base_url</code></td>
<td>
<p>A string representing the base URL for the FASTA retrieval. By default, this is set to the global constant <code>FASTA_BASE_URL</code>, but users can specify a different URL if needed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function queries the RCSB PDB database using the provided entry ID (<code>rcsb_id</code>) and optionally a chain ID (<code>chain_id</code>). It sends an HTTP GET request to retrieve the corresponding FASTA file. The response is then parsed into a list of sequences. If a chain ID is provided, the function will return only the sequence corresponding to that chain. If no chain ID is provided, all sequences are returned.
</p>
<p>If a request fails, the function provides informative error messages. In the case of a network failure, the function will stop execution with a clear error message. Additionally, if the chain ID does not exist within the entry, the function will return an appropriate error message indicating that the chain was not found.
</p>
<p>The function also supports passing a custom base URL for the FASTA file retrieval, providing flexibility for users working with different PDB mirrors or services.
</p>


<h3>Value</h3>

<p>* If <code>chain_id</code> is NULL, the function returns a list of FASTA sequences associated with the provided <code>rcsb_id</code>, where organism names or chain descriptions are used as keys.
* If <code>chain_id</code> is specified, the function returns a character string representing the FASTA sequence for that specific chain.
* If the specified <code>chain_id</code> is not found in the PDB entry, the function will stop execution with an informative error message.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1: Retrieve all FASTA sequences for the entry 4HHB
all_sequences &lt;- get_fasta_from_rcsb_entry("4HHB", verbosity = TRUE)
print(all_sequences)

# Example 2: Retrieve the FASTA sequence for chain A of entry 4HHB
chain_a_sequence &lt;- get_fasta_from_rcsb_entry("4HHB", chain_id = "A", verbosity = TRUE)
print(chain_a_sequence)

</code></pre>


</div>