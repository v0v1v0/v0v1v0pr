<div class="container">

<table style="width: 100%;"><tr>
<td>robustd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Loglinear Models for Capture-Recapture Experiments Carried Out According to a Robust Design</h2>

<h3>Description</h3>

<p>These functions compute various demographic parameters and capture probabilities per period using loglinear robust design 
models in capture-recapture experiments.
</p>
<p><code>robustd.t</code> and <code>robustd.0</code> fit the model using different response variable. 
<code>robustd.t</code> uses the frequencies of the observable capture histories in terms of capture success or failure for each 
capture occasions of each primary period. <code>robustd.0</code> uses the frequencies of the observable capture histories in terms 
of number of captures per primary period.
</p>


<h3>Usage</h3>

<pre><code class="language-R">robustd.t(X, dfreq = FALSE, vt, vm = "M0", vh = list("Chao"),
          vtheta = 2, neg = TRUE)

robustd.0(X, dfreq = FALSE, vt, vm = "M0", vh = list("Chao"), 
          vtheta = 2, neg = TRUE)

## S3 method for class 'robustd'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> The matrix of the observed capture histories (see <code>Rcapture-package</code> for a description of the accepted formats).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfreq</code></td>
<td>
<p> A logical. By default FALSE, which means that <code>X</code> has one row per unit. If TRUE, it indicates that the matrix 
<code>X</code> contains frequencies in its last column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vt</code></td>
<td>
<p> A vector containing the numbers of capture occasions for each primary sampling period. The length of this vector 
equals the number of primary sampling periods (noted <code class="reqn">I</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vm</code></td>
<td>
<p> A vector indicating the closed population model for each primary period. The elements of <code>vm</code> can be "none"=no model, 
"M0"=M0 model, "Mt"=Mt model, "Mh"=Mh model or "Mth"=Mth model for <code>robustd.t</code>. For <code>robustd.0</code>, models with 
time effect are not allowed. So <code>vm</code> can than be "none"=no model, "M0"=M0 model, or "Mh"=Mh model. 
The 'no model' cannot be selected for the first or the last period. If a single character string is given for 
<code>vm</code>, the corresponding model is used for all periods. The default value for <code>vm</code> is "M0" for all period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vh</code></td>
<td>
<p> A list indicating, for each primary period with a heterogeneity model, the form of the columns for heterogeneity in the 
design matrix. The elements of <code>vh</code> can be "Chao", "Poisson", "Darroch" or any numerical <code>R</code> function created 
beforehand by the user. "Chao" represents Chao's model, "Poisson" represents the function <code class="reqn">f(k)=theta^k-1</code>, 
where <code class="reqn">k</code> is the number of captures, "Darroch" represents the function <code class="reqn">f(k)=k^2/2</code>, and "Gamma" represents 
the function <code class="reqn">f(k)=-\log(theta + k) + \log(theta)</code>. If an <code>R</code> function is 
given, it is the implementation of any convex mathematical function <code class="reqn">f(k)</code>. It has only one argument. For the Poisson 
or Gamma model, the parameter <code>theta</code> is specified in the argument <code>vtheta</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vtheta</code></td>
<td>
<p> A vector indicating, for each primary period with a Poisson or Gamma heterogeneity model, the value of the parameter. 
If  <code>vtheta</code> consists of a single number, this number is used for all the periods with a Poisson or Gamma model. 
The default value for <code>vtheta</code> is 2 for all the periods with a Poisson or Gamma model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg</code></td>
<td>
<p> If this option is set to TRUE, negative gamma parameters and negative eta parameters in Chao's models are set to zero. 
This insures that the estimated survival probabilities belong to [0, 1] and that the births are positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> An object, produced by the <code>robustd.t</code> or the <code>robustd.0</code> function, to print.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Further arguments to be passed to <code>print.default</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions also generate statistics to test the presence of temporary emigration.
</p>
<p>The Poisson regression used to fit a robust design model has one entry for each possible capture history, including those that are 
unobserved.  The size of the dependent vector is therefore <code class="reqn">2^{\mbox{sum(vt)}}-1</code> for <code>robustd.t</code>. 
Models with a large sum(vt) are hard to fit with <code>robustd.t</code>. <code>robustd.0</code> uses a more parsimonious coding for the capture 
histories and can fit larger models.
</p>
<p>Standard errors are calculated by linearization.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The number of captured units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models </code></td>
<td>
<p> A vector of length <code class="reqn">I</code> identifying the closed population models chosen for each period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.fit </code></td>
<td>
<p> A table containing the deviance, degrees of freedom and AIC of the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emig.fit </code></td>
<td>
<p> A table containing, for the model with an added temporary emigration effect, the deviance, the degrees of freedom 
and the Akaike's information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emig.param </code></td>
<td>
<p> The estimated temporary emigration parameters and their standards errors. The <code class="reqn">I-1</code> first rows are 
estimations of the differences <code class="reqn">logit(p^b)-logit(p^w)</code> for periods 2 to <code class="reqn">I-1</code> (<code class="reqn">p^b</code> represents 
a between primary period and <code class="reqn">p^w</code> a within primary period estimate of the capture probability). The last 
row gives a pooled estimate of these differences calculated under the assumption that they are homogeneous. 
Negative estimates are associated with a temporary emigration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>capture.prob </code></td>
<td>
<p> The estimated capture probabilities per period and their standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survivals </code></td>
<td>
<p> The estimated survival probabilities between periods and their standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p> The estimated population sizes per period and their standard errors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>birth</code></td>
<td>
<p> The estimated number of new arrivals in the population between periods and their standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntot</code></td>
<td>
<p> The estimated total number of units who ever inhabited the survey area and its standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglin.param </code></td>
<td>
<p>The loglinear model parameters estimations and their standard errors, calculated by the <code>glm</code> function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.vector </code></td>
<td>
<p>The Ui statistics, useful for the survival probabilities calculation, and their standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.vector </code></td>
<td>
<p>The Vi statistics, useful for the population sizes estimation, and their standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p> The covariance matrix of all the demographic parameters estimates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg</code></td>
<td>
<p> The position of the gamma and eta parameters set to zero in the loglinear parameter vector.</p>
</td>
</tr>
</table>
<h3>Note</h3>

 
<p>This function uses the <code>glm</code> function of the <span class="pkg">stats</span> package. 
</p>


<h3>Author(s)</h3>

<p> Louis-Paul Rivest <a href="mailto:Louis-Paul.Rivest@mat.ulaval.ca">Louis-Paul.Rivest@mat.ulaval.ca</a> and Sophie Baillargeon </p>


<h3>References</h3>

 
<p>Baillargeon, S. and Rivest, L.P. (2007) Rcapture: Loglinear models for capture-recapture in R.  <em>Journal of Statistical Software</em>, <b>19</b>(5), <a href="https://doi.org/10.18637/jss.v019.i05">doi:10.18637/jss.v019.i05</a>.
</p>
<p>Rivest, L.P. and Daigle, G. (2004) Loglinear models for the robust design in mark-recapture experiments. <em>Biometrics</em>, <b>60</b>, 100â€“107.
</p>


<h3>See Also</h3>

<p><code>closedp</code>, <code>openp</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # The mvole data set contains a total of 30 capture occasions (the 
  # tenth capture occasion doesn't have any new capture and is taken
  # out of the analysis). This number being large, we can only use 
  # the robustd.0 function to fit a robust design model.

  # Not run :
# robustd.0(mvole[, -10], vt = c(5, 4, rep(5, 4)), vm = "Mh", vh = "Poisson", vtheta = 1.5)
  # Should take a few seconds to run.

  # Not run: 
# robustd.t(mvole[, -10], vt = c(5, 4, rep(5, 4)), vm = 'Mh', vh = 'Poisson', vtheta = 1.5)
  # Should fail.

  # Considering only the first 3 periods of the data set, we can use the 
  # robustd.t function to fit a model with a temporal effect.
robustd.t(mvole[, c(1:9, 11:15)], vt = c(5, 4, 5), vm = "Mth", vh = "Poisson", vtheta = 1.5)
</code></pre>


</div>