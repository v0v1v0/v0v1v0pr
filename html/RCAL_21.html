<div class="container">

<table style="width: 100%;"><tr>
<td>simu.data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulated data</h2>

<h3>Description</h3>

<p>A dataset simulated as in Tan (2020), Section 4.</p>


<h3>Usage</h3>

<pre><code class="language-R">data(simu.data)</code></pre>


<h3>Format</h3>

<p>A data matrix with 800 rows and 202 columns.</p>


<h3>Details</h3>

 
<p>The dataset is generated as follows, where <code>y</code>, <code>tr</code>, and <code>x</code> represent an outcome, a treatment, and covariates respectively. 
</p>
<pre>
library(MASS)

###
mt0 &lt;- 1-pnorm(-1)
mt1 &lt;- dnorm(-1)
mt2 &lt;- -(2*pnorm(-1)-1)/2 - dnorm(-1) +1/2
mt3 &lt;- 3*dnorm(-1)
mt4 &lt;- -3/2*(2*pnorm(-1)-1) - 4*dnorm(-1) +3/2

m.z1 &lt;- mt0 + 2*mt1 + mt2
v.z1 &lt;- mt0 + 4*mt1 + 6*mt2 + 4*mt3 + mt4
v.z1 &lt;- v.z1 + 1 + 2*(mt1 + 2*mt2 + mt3)

sd.z1 &lt;- sqrt(v.z1 -m.z1^2)
###

set.seed(123)

n &lt;- 800
p &lt;- 200

noise &lt;- rnorm(n)

covm &lt;- matrix(1,p,p)
for (i1 in 1:p)
  for (i2 in 1:p) {
    covm[i1,i2] &lt;- 2^(-abs(i1-i2))
  }
x &lt;- mvrnorm(n, mu=rep(0,p), Sigma=covm)

# transformation
z &lt;- x 
for (i in 1:4) {
  z[,i] &lt;- ifelse(x[,i]&gt;-1,x[,i]+(x[,i]+1)^2,x[,i])
  z[,i] &lt;- (z[,i]-m.z1) /sd.z1   # standardized
}

# treatment 
eta &lt;- 1+ c( z[,1:4] %*% c(1, .5, .25, .125) )
tr &lt;- rbinom(n, size=1, prob=expit(eta))

# outcome
eta.y &lt;- c( z[,1:4] %*% c(1, .5, .25, .125) )
y &lt;- eta.y + noise

# save; if using main effects of x, then both the propensity score
# and outcome regression models are misspecified
 
simu.data &lt;- cbind(y, tr, x)
save(simu.data, file="simu.data.rda")
</pre> 

<h3>References</h3>

<p>Tan, Z. (2020) Model-assisted inference for treatment effects using regularized calibrated estimation with high-dimensional data, <em>Annals of Statistics</em>, 48, 811â€“837.
</p>


</div>