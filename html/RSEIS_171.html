<div class="container">

<table style="width: 100%;"><tr>
<td>MTMgabor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evolutive MTM Spectrum
</h2>

<h3>Description</h3>

<p>Time varying Auto-Regressive Spectrum (Gabor Transform) using MTM
</p>


<h3>Usage</h3>

<pre><code class="language-R">MTMgabor(a, dt = 0, ppoint=95 , numf = 1024, Ns = 0, Nov = 0, fl = 0, fh = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>signal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>sample rate interval (s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppoint</code></td>
<td>
<p>percent confidence for F-test (default=95) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numf</code></td>
<td>
<p>Number of frequencies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ns</code></td>
<td>
<p>Number of sample in sub-window </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nov</code></td>
<td>
<p>Number of sample to overlap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fl</code></td>
<td>
<p>low frequency to display</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fh</code></td>
<td>
<p>high frequency to display</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a spectrogram function similar to the Gabor Transform
but uses the MTM (multi-taper method) for spectrum estimation.
This is a non-interactive version of MTM.drive.
</p>


<h3>Value</h3>

<p>List
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>input signal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>deltat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numfreqs</code></td>
<td>
<p>Number of frequencies output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wpars</code></td>
<td>
<p>input parameters list(Nfft=numfreqs,  Ns=Ns, Nov=Nov, fl=fl, fh=fh)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DSPEC</code></td>
<td>
<p>spectrum image</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HIMAT</code></td>
<td>
<p>matrix with high values of F-test at 90 percent confidence
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DOFMAT</code></td>
<td>
<p>Matrix image of degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FVMAT</code></td>
<td>
<p>Matrix image of F-test values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kdof</code></td>
<td>
<p>test degrees of freedom=2*nwin-2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppoint</code></td>
<td>
<p>percentage point for confidence bounds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>output frequencies (y axis)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tims</code></td>
<td>
<p>output times (x-axis) </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;
</p>


<h3>References</h3>

<p>Percival and Walden;
</p>
<p>Lees, J. M. and Park, J., 1995: Multiple-taper spectral analysis: A
stand-alone C-subroutine, <em>Computers and Geology</em>, 21(2), 199-236.
</p>
<p>Percival, Donald B.,Walden, Andrew T. (1993):Spectral Analysis for
Physical Applications,Cambridge University Press, Cambridge,  583p.
</p>


<h3>See Also</h3>

<p>evolfft, evolMTM, MTM.drive, GETARAIC, doGABOR.AR, DOsgram, doGABOR.MTM
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(KH)
###   swig(KH)

Xamp &lt;- KH$JSTR[[1]]
Nfft &lt;- 1024   ###  fft length
Ns &lt;- 512      ###  number of samples in a window
Nov &lt;- 480    ###  number of samples of overlap per window
fl &lt;- 0        ###  low frequency to return
fh &lt;- 12     ###  high frequency to return
 dt  &lt;-  KH$dt[1]

####  shorten the signal here, just for speed on the example:
sig = Xamp[37501:75001]

EV &lt;-   MTMgabor(sig, dt = dt, numf =Nfft , Ns = Ns, Nov = Nov, fl = fl, fh= fh)

PE   &lt;- plotevol(EV, log=1, fl=0.01, fh=fh, col=rainbow(100),
              ygrid=FALSE, STAMP="", STYLE="ar")



</code></pre>


</div>