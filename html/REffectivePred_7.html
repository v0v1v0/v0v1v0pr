<div class="container">

<table style="width: 100%;"><tr>
<td>log_lklh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The likelihood function</h2>

<h3>Description</h3>

<p>The negative log likelihood function of the model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">log_lklh(
  param,
  params_limits,
  restrictions = NULL,
  restriction.starts = NULL,
  ranges = NULL,
  rt_func = 1,
  silence.errors = FALSE,
  fit.t.pred,
  lt,
  cases,
  scenario = NULL,
  H.E,
  H.W,
  adj.period,
  population,
  rho,
  serial_mean,
  serial_var,
  window_size
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Includes the following sets of parameters in a vector, in this order:
</p>

<ul>
<li>
<p> a1,a2,a3,a4 - Parameters for curve c() specified by <code>rt_func</code>.
</p>
</li>
<li>
<p> nu - Loss of Immunity rate.
</p>
</li>
<li>
<p> v2,v3,v4,v5 - Transmissibility of variants in waves 2+, as relative multiplication factors compared to transmissibility in wave 1.
</p>
</li>
<li>
<p> psi1,psi2,psi3,psi4 - Psi parameters for severity levels 1,2,3 and 4.
</p>
</li>
<li>
<p> u,v - Variance parameters. Only u is currently in use.
</p>
</li>
<li>
<p> beta0,beta.R,beta.E,beta.W - When restrictions = NULL. Currently unsupported.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_limits</code></td>
<td>
<p>Boundaries/limits of the ini_params.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restrictions</code></td>
<td>
<p>A numeric integer vector giving the severity of restrictions.
Zero means no restriction, and higher numbers means greater severity/disruption.
The ordered unique values should be consecutive integers starting from zero.
Each number (other than 0) adds a new parameter to the fit. restrictions = NULL
causes the function to use mobility data instead of the psi values (currently unsupported).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restriction.starts</code></td>
<td>
<p>A vector of same length as restrictions, of times when restrictions
came into effect. Note: the first index time should be 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranges</code></td>
<td>
<p>An vector of time ranges for the different waves.
The wave ranges should be contiguous, with at least one unit of time
between consecutive waves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rt_func</code></td>
<td>
<p>The parametric form of function c(). Options are listed under function c_helper.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silence.errors</code></td>
<td>
<p>Ignores (skips) NA or NaN values when summing up likelihood contributions over time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.t.pred</code></td>
<td>
<p>Time of prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lt</code></td>
<td>
<p>Length of cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>A vector containing cases for each time-point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scenario</code></td>
<td>
<p>A character string describing options to deal with restrictions. Currently unsupported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.E</code></td>
<td>
<p>Mobility metrics for category Retail &amp; Entertainment. Currently unsupported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.W</code></td>
<td>
<p>Mobility metrics for category Workplaces. Currently unsupported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.period</code></td>
<td>
<p>Delays in society adjusting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>total population size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Under-reporting fraction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>serial_mean</code></td>
<td>
<p>Mean of the serial interval on the log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>serial_var</code></td>
<td>
<p>Variance of the serial interval on the log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_size</code></td>
<td>
<p>The maximum value for the serial interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The predicted curve is computed based on parameters supplied, by first calling the prediction
function <code>pred.curve</code>. The probability model used to compute the likelihood assumes that observed
infection at time <code class="reqn">t</code> are <code class="reqn">\sim N(mean = I_t, sd = \sqrt{u*I_t})</code>, where <code class="reqn">I_t</code> are predicted infections, and sums the
log-likelihood contributions for each time <code class="reqn">t</code> during waves, and up to <code>fit.t.pred</code>.
</p>


<h3>Value</h3>

<p>The negative log likelihood value of the data.
</p>


</div>