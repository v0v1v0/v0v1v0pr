<div class="container">

<table style="width: 100%;"><tr>
<td>multitaper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute 'multitaper' spectral densities of time-series data</h2>

<h3>Description</h3>

<p>Compute 'multitaper' spectral densities of time-series data
</p>


<h3>Usage</h3>

<pre><code class="language-R">multitaper_config(
  data_length,
  fs,
  frequency_range = NULL,
  time_bandwidth = 5,
  num_tapers = NULL,
  window_params = c(5, 1),
  nfft = NA,
  detrend_opt = "linear"
)

multitaper(
  data,
  fs,
  frequency_range = NULL,
  time_bandwidth = 5,
  num_tapers = NULL,
  window_params = c(5, 1),
  nfft = NA,
  detrend_opt = "linear"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_length</code></td>
<td>
<p>length of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fs</code></td>
<td>
<p>sampling frequency in 'Hz'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequency_range</code></td>
<td>
<p>frequency range to look at; length of two</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_bandwidth</code></td>
<td>
<p>a number indicating time-half bandwidth product; i.e.
the window duration times the half bandwidth of main lobe; default is
<code>5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_tapers</code></td>
<td>
<p>number of 'DPSS' tapers to use; default is <code>NULL</code> and
will be automatically computed from <code>floor(2*time_bandwidth - 1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_params</code></td>
<td>
<p>vector of two numbers; the first number is the
window size in seconds; the second number if the step size; default is
<code>c(5, 1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfft</code></td>
<td>
<p>'NFFT' size, positive; see 'Details'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrend_opt</code></td>
<td>
<p>how you want to remove the trend from data window; options
are <code>'linear'</code> (default), <code>'constant'</code>, and <code>'off'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>numerical vector, signal traces</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The original source code comes from 'Prerau' Lab (see 'Github'
repository <code>'multitaper_toolbox'</code> under user <code>'preraulab'</code>).
The results tend to agree with their 'Python' implementation with precision
on the order of at <code>1E-7</code> with standard deviation at most <code>1E-5</code>.
The original copy was licensed under a Creative Commons Attribution
'NC'-'SA' 4.0 International License
(<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">https://creativecommons.org/licenses/by-nc-sa/4.0/</a>).
</p>
<p>This package (<code>'ravetools'</code>) redistributes the <code>multitaper</code>
function under minor modifications on <code>nfft</code>. In the original copy
there is no parameter to control the exact numbers of <code>nfft</code>, and
the <code>nfft</code> is always the power of 2. While choosing
<code>nfft</code> to be the power of 2 is always recommended, the modified code
allows other choices.
</p>


<h3>Value</h3>

<p><code>multitaper_config</code> returns a list of configuration parameters
for the filters; <code>multitaper</code> also returns the time, frequency and
corresponding spectral power.
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# Takes long to run

time &lt;- seq(0, 3, by = 0.001)
x &lt;- sin(time * 20*pi) + exp(-time^2) * cos(time * 10*pi)

res &lt;- multitaper(
  x, 1000, frequency_range = c(0,15),
  time_bandwidth=1.5,
  window_params=c(2,0.01)
)


image(
  x = res$time,
  y = res$frequency,
  z = 10 * log10(res$spec),
  xlab = "Time (s)",
  ylab = 'Frequency (Hz)',
  col = matlab_palette()
)



</code></pre>


</div>