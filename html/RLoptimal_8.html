<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_one_trial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate One Trial Using an Obtained Optimal Adaptive Allocation Rule</h2>

<h3>Description</h3>

<p>Simulate One Trial Using an Obtained Optimal Adaptive Allocation Rule
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_one_trial(
  allocation_rule,
  models,
  true_response,
  N_total,
  N_ini,
  N_block,
  Delta,
  outcome_type = c("continuous", "binary"),
  sd_normal = NULL,
  alpha = 0.025,
  selModel = c("AIC", "maxT", "aveAIC"),
  seed = NULL,
  eval_type = c("all", "pVal")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>allocation_rule</code></td>
<td>
<p>An object of class AllocationRule
specifying an obtained optimal adaptive allocation rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>An object of class Mods specifying assumed
dose-response models. When <code>outcome_type</code> is "binary", <code>models</code> should
be specified on the logit scale. This is used in the MCPMod method
at the end of this trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_response</code></td>
<td>
<p>A numeric vector specifying the true response values of
the true model. When <code>outcome_type</code> is "binary", <code>true_response</code> should
be specified on the logit scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_total</code></td>
<td>
<p>A positive integer value. The total number of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_ini</code></td>
<td>
<p>A positive integer vector in which each element is greater than
or equal to 2. The number of subjects initially assigned to each dose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_block</code></td>
<td>
<p>A positive integer value. The number of subjects allocated
adaptively in each round.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>A positive numeric value. The clinically relevant target effect.
When <code>outcome_type</code> is "binary", <code>Delta</code> should be specified
on the logit scale. See TD for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome_type</code></td>
<td>
<p>A character value specifying the outcome type.
Possible values are "continuous" (default), and "binary".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_normal</code></td>
<td>
<p>A positive numeric value. The standard deviation of the
observation noise. When <code>outcome_type</code> is "continuous",
<code>sd_normal</code> must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A positive numeric value. The significance level. Default is 0.025.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selModel</code></td>
<td>
<p>A character value specifying the model selection criterion
for dose estimation. Possible values are "AIC" (default), "maxT", or
"aveAIC". See MCPMod for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer value. Random seed for data generation in this trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval_type</code></td>
<td>
<p>A character value specifying the evaluation type. Possible
values are "all" (default) and "pVal". "all" returns all metrics,
which contain the minimum p value, the selected model name,
the estimated target dose, and the MAE. "pVal" returns only the
minimum p value without fitting models.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list which contains the minimum p value, the selected model name,
the estimated target dose, and the MAE.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(RLoptimal)

doses &lt;- c(0, 2, 4, 6, 8)

models &lt;- DoseFinding::Mods(
  doses = doses, maxEff = 1.65,
  linear = NULL, emax = 0.79, sigEmax = c(4, 5)
)

## Not run: 
allocation_rule &lt;- learn_allocation_rule(
  models,
  N_total = 150, N_ini = rep(10, 5), N_block = 10, Delta = 1.3,
  outcome_type = "continuous", sd_normal = sqrt(4.5), 
  seed = 123, rl_config = rl_config_set(iter = 1000),
  alpha = 0.025
)

# Simulation-based adjustment of the significance level using `allocation_rule`
adjusted_alpha &lt;- adjust_significance_level(
  allocation_rule, models,
  N_total = 150, N_ini = rep(10, 5), N_block = 10,
  outcome_type = "continuous", sd_normal = sqrt(4.5),
  alpha = 0.025, n_sim = 10000, seed = 123
)
## End(Not run)

eval_models &lt;- DoseFinding::Mods(
  doses = doses, maxEff = 1.65,
  linear = NULL, emax = 0.79, sigEmax = c(4, 5), exponential = 1, quadratic = - 1/12
)
true_response_matrix &lt;- DoseFinding::getResp(eval_models, doses = doses)
true_response_list &lt;- as.list(data.frame(true_response_matrix, check.names = FALSE))

true_model_name &lt;- "emax"

# Simulate one trial using the obtained `allocation_rule` When the true model is "emax"
## Not run: 
res_one &lt;- simulate_one_trial(
  allocation_rule, models, 
  true_response = true_response_list[[true_model_name]],
  N_total = 150, N_ini = rep(10, 5), N_block = 10, 
  Delta = 1.3, outcome_type = "continuous", sd_normal = sqrt(4.5),
  alpha = adjusted_alpha, seed = simID, eval_type = "all"
)
## End(Not run)

</code></pre>


</div>