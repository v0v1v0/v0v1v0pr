<div class="container">

<table style="width: 100%;"><tr>
<td>openp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Loglinear Models for Open Population Capture-Recapture Experiments  </h2>

<h3>Description</h3>

<p>This function computes various demographic parameters using a loglinear model for open populations in capture-recapture experiments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">openp(X, dfreq=FALSE, m=c("up","ep"), neg=TRUE, keep=rep(TRUE,2^I-1))

## S3 method for class 'openp'
print(x, ...)

## S3 method for class 'openp'
plot(x, main="Scatterplot of Pearson Residuals", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> The matrix of the observed capture histories (see <code>Rcapture-package</code> for a description of the accepted formats).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfreq</code></td>
<td>
<p> A logical. By default FALSE, which means that <code>X</code> has one row per unit. If TRUE, it indicates that the 
matrix <code>X</code> contains frequencies in its last column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> This argument is a character string taking the value "up" (up = unconstrained probabilities) or "ep" (ep = equal 
probabilities). If <code>m</code> is set to "up" (the default), no constraint is set on the loglinear parameters. Therefore 
some loglinear and demographic parameters are not estimable. On the other hand, when <code>m</code> takes the value "ep", 
the capture probabilities are set to a common value; this enables the estimation of all the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p> This option is useful to fit the model on a subset of the possible capture histories. <code>keep</code> is a logical 
vector of length <code class="reqn">2^I-1</code> taking the value TRUE for a history kept and FALSE for a history put aside. In this 
vector, the order of the capture histories is as defined in the <code>histpos.t</code> function. By default, every capture 
history is kept. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg</code></td>
<td>
<p> If this option is set to TRUE, relevant negative gamma parameters are set to zero. This insures that the estimated 
survival probabilities belong to [0, 1] and that the births are positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> An object, produced by the <code>openp</code> function, to print or to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p> A main title for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Further arguments to be passed to methods (see <code>print.default</code> and <code>plot.default</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>openp</code> generates statistics to test the presence of a trap effect.
</p>
<p>The <code>plot.openp</code> function produces a scatterplot of the Pearson residuals of the model versus the frequencies of capture.
</p>
<p>If the data matrix <code>X</code> was obtained through the <code>periodhist</code> function, the <code>dfreq</code> argument must be set to TRUE.
</p>
<p>Standard errors are calculated by linearization.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The number of captured units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.fit </code></td>
<td>
<p> A table containing the deviance, degrees of freedom and AIC of the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trap.fit </code></td>
<td>
<p> A table containing, for the models with an added trap effect, the deviance, degrees of freedom and AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trap.param </code></td>
<td>
<p> The estimated trap effect parameters and their standard errors. For m="up", the <code class="reqn">I-3</code> first rows of 
<code>trap.param</code> are estimations of the differences <code class="reqn">logit</code>(capture probability after a capture)-
<code class="reqn">logit</code>(capture probability after a miss) for periods 3 to <code class="reqn">I-1</code>. The last row gives a pooled 
estimate of these differences calculated under the assumption that they are homogeneous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>capture.prob </code></td>
<td>
<p> The estimated capture probabilities per period and their standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survivals </code></td>
<td>
<p> The estimated survival probabilities between periods and their standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p> The estimated population sizes per period and their standard errors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>birth</code></td>
<td>
<p> The estimated number of new arrivals in the population between periods and their standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntot</code></td>
<td>
<p> The estimated total number of units who ever inhabited the survey area and its standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm</code></td>
<td>
<p> The 'glm' object obtained from fitting the loglinear model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglin.param </code></td>
<td>
<p>The loglinear model parameters estimations and their standard errors, calculated by the <code>glm</code> function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.vector </code></td>
<td>
<p>The Ui statistics, useful for the survival probabilities calculation, and their standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.vector </code></td>
<td>
<p>The Vi statistics, useful for the population sizes estimation, and their standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p> The covariance matrix of all the demographic parameters estimates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg</code></td>
<td>
<p> The position of the gamma parameters set to zero in the loglinear parameter vector.</p>
</td>
</tr>
</table>
<h3>Note</h3>

 
<p>If your data contains more than one capture occasion within primary periods, use the <code>periodhist</code> function to create the input data matrix <code>X</code> needed by the <code>openp</code> function.
</p>
<p>This function uses the <code>glm</code> function of the <span class="pkg">stats</span> package. 
</p>


<h3>Author(s)</h3>

<p> Louis-Paul Rivest <a href="mailto:Louis-Paul.Rivest@mat.ulaval.ca">Louis-Paul.Rivest@mat.ulaval.ca</a> and Sophie Baillargeon </p>


<h3>References</h3>

 
<p>Baillargeon, S. and Rivest, L.P. (2007) Rcapture: Loglinear models for capture-recapture in R.  <em>Journal of Statistical Software</em>, <b>19</b>(5), <a href="https://doi.org/10.18637/jss.v019.i05">doi:10.18637/jss.v019.i05</a>.
</p>
<p>Rivest, L.P. and Daigle, G. (2004) Loglinear models for the robust design in mark-recapture experiments. <em>Biometrics</em>, <b>60</b>, 100â€“107.
</p>


<h3>See Also</h3>

<p><code>closedp</code>, <code>periodhist</code>, <code>robustd</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># duck data set
op.m1 &lt;- openp(duck, dfreq = TRUE)
plot(op.m1)

# To remove the capture history 111111.
keep2 &lt;- apply(histpos.t(6), 1, sum) != 6
op.m2 &lt;- openp(duck, dfreq = TRUE, keep = keep2)
op.m2

# To remove the capture histories with 5 captures or more
keep3 &lt;- apply(histpos.t(6), 1, sum) &lt; 5
op.m3 &lt;- openp(duck, dfreq = TRUE, keep = keep3)
op.m3


# mvole data set aggregated per primary period
mvole.op &lt;- periodhist(mvole, vt = rep(5, 6))
openp(mvole.op, dfreq = TRUE)
</code></pre>


</div>