<div class="container">

<table style="width: 100%;"><tr>
<td>est.R0.TD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Time-Dependent reproduction number</h2>

<h3>Description</h3>

<p>Estimate the Time-Dependent reproduction number, <code class="reqn">R(t)</code>, as defined by
Wallinga &amp; Teunis, by exploring all possible pairs of infectors/infectees
across likely transmission trees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">est.R0.TD(
  epid,
  GT,
  import = NULL,
  n.t0 = NULL,
  t = NULL,
  begin = NULL,
  end = NULL,
  date.first.obs = NULL,
  time.step = 1,
  q = c(0.025, 0.975),
  correct = TRUE,
  nsim = 10000,
  checked = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>epid</code></td>
<td>
<p>Object containing epidemic curve data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT</code></td>
<td>
<p>Generation time distribution from <code>generation.time()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>import</code></td>
<td>
<p>Vector of imported cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.t0</code></td>
<td>
<p>Initial number of cases at the beginning of the outbreak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>At what time estimation begins (unused by this method, just there for plotting purposes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>At what time estimation ends (unused by this method, just there for plotting purposes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Quantiles for R(t) confidence level. By default, 2.5% and 97.5%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>Boolean. Correction for cases not yet observed (real time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations to be run to compute quantiles for R(t)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For internal use. Called by <code>estimate.R()</code>.
</p>
<p>The confidence interval is computed by multinomial simulations at each time step,
using the expected value of R.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>vector of R values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>95% confidence interval for estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Matrix of who infected whom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Probability of who infected whom (values achieved by normalizing P matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT</code></td>
<td>
<p>Generation time distribution used in the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epid</code></td>
<td>
<p>Original epidemic data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>import</code></td>
<td>
<p>Vector of imported cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>Theoretical epidemic data, computed with estimated values of R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>Starting date for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin.nb</code></td>
<td>
<p>The number of the first day used in the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>The end date for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end.nb</code></td>
<td>
<p>The number of the last day used for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>Name of the data used in the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Call used for the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This is the implementation of the method provided by Wallinga &amp; Teunis (2004).
Correction for estimation in real time is implemented as in Cauchemez et al, AJE (2006).
</p>
<p>If imported cases are provided, they are counted in addition to autonomous cases.
The final plot will show overall incidence.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>Wallinga, J., and Teunis P. "Different Epidemic Curves for Severe Acute Respiratory Syndrome Reveal Similar Impacts of Control Measures." American Journal of Epidemiology 160, no. 6 (2004): 509. <br>
Cauchemez S., and Valleron AJ. "Estimating in Real Time the Efficacy of Measures to Control Emerging Communicable Diseases" American Journal of Epidemiology 164, no. 6 (2006): 591.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Loading package
library(R0)

## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
## outbreak during 1918 influenza pandemic in Germany)

data(Germany.1918)
mGT &lt;- generation.time("gamma", c(3, 1.5))
TD &lt;- est.R0.TD(Germany.1918, mGT, begin=1, end=126, nsim=100)
# Warning messages:
# 1: In est.R0.TD(Germany.1918, mGT) : Simulations may take several minutes.
# 2: In est.R0.TD(Germany.1918, mGT) : Using initial incidence as initial number of cases.
TD
# Reproduction number estimate using  Time-Dependent  method.
# 2.322239 2.272013 1.998474 1.843703 2.019297 1.867488 1.644993 1.553265 1.553317 1.601317 ...

## An interesting way to look at these results is to agregate initial data by longest time unit,
## such as weekly incidence. This gives a global overview of the epidemic.
TD.weekly &lt;- smooth.Rt(TD, 7)
TD.weekly
# Reproduction number estimate using  Time-Dependant  method.
# 1.878424 1.580976 1.356918 1.131633 0.9615463 0.8118902 0.8045254 0.8395747 0.8542518 0.8258094..
plot(TD.weekly)
</code></pre>


</div>