<div class="container">

<table style="width: 100%;"><tr>
<td>likelihoodFunction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood function for the multivariate Brownian motion model</h2>

<h3>Description</h3>

<p>Returns the log-likelihood for the multivariate Brownian motion model with 1 or more rate regimes mapped to the tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">likelihoodFunction(data, phy, root, R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix with the data. Species names need to be provided as rownames (rownames(data) == phy$tip.label).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogeny of the class "simmap" with the mapped regimes or "phylo" for a single rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>a numeric vector with the root value (phylogenetic mean).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>a matrix or a list of matrices. If 'R' is a matrix then the likelihood for a single regime is calculated. If 'R' is a list of matrices, then each matrix will be fitted to a regime in 'phy' and the length of the list need to match the number of regimes fitted to the tree.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If two or more rate regimes are mapped to the phylogenetic tree, then the function calculates the likelihood using the new prunning algorithm adapted to fit multiple rate regimes. The prunning algorithm is implemented in C++ using 'Rcpp' and 'RcppArmadillo'. Otherwise the function uses the three point algorithm (Ho and Ané, 2014) to make calculations for the single regime case.
</p>


<h3>Value</h3>

<p>The log likelihood for the multivariate Brownian motion model.
</p>


<h3>Author(s)</h3>

<p>Daniel S. Caetano and Luke J. Harmon
</p>


<h3>References</h3>

<p>Ho, L. S. T. and Ané, C. (2014). "A linear-time algorithm for Gaussian and non-Gaussian trait evolution models". Systematic Biology *63*(3):397-408.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data( centrarchidae )
root &lt;- colMeans( centrarchidae$data )
Rlist &lt;- list( rbind(c(0.5, 0.1),c(0.1,0.5)), rbind(c(0.5, 0),c(0,0.5)) )
likelihoodFunction(data = centrarchidae$data, phy = centrarchidae$phy.map, root = root
                   , R = Rlist)
## Get the likelihood for a single regime model:
phy.single &lt;- mergeSimmap(phy = centrarchidae$phy.map, drop.regimes = TRUE)
Rsingle &lt;- rbind(c(0.5, 0.1),c(0.1,0.5))
likelihoodFunction(data = centrarchidae$data, phy = phy.single, root = root, R = Rsingle)

</code></pre>


</div>