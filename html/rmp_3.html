<div class="container">

<table style="width: 100%;"><tr>
<td>rmg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nonparametric mixture of rounded Gaussians
</h2>

<h3>Description</h3>

<p>Performs Bayesian probability mass function estimation under nonparametric mixture of rounded of Gaussian kernels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmg(ydis, k=length(ydis), nrep, nb, alpha=1, theta=alpha, sigma=0, 
mixing_hyperprior= FALSE, basemeasure_hyperprior = FALSE, mixing_type="DP", algo="slice",
mu0=mean(ydis), kap=var(ydis), 
atau=1, btau=2, a_a=1, b_a=1, lb=NULL, ub=NULL, print = 1, ndisplay = nrep/4,
plot.it = FALSE, pdfwrite = FALSE, ...)

dpmrg(ydis, k, nrep, nb, alpha, alpha_r = FALSE, mu0 = mean(ydis), kap = var(ydis), 
atau, btau, a_a = 1, b_a = 1, lb = NULL, ub = NULL, 
print = 1, ndisplay = nrep/4, 
plot.it = FALSE, pdfwrite = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ydis</code></td>
<td>

<p>Vector of count data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>Truncation level for the number of cluster in the mixture. Default is <code>length(ydis)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>

<p>Number of MCMC iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>

<p>Number of burn-in iteration in the MCMC to discard
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Value of the precision parameter of the Dirichlet process prior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Value of the strength parameter of the Two-parameters-Poisson-Dirichlet process prior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Value of the discount parameter of the Two-parameters-Poisson-Dirichlet process prior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixing_hyperprior</code></td>
<td>

<p>Logical. If TRUE <code>alpha</code> is random with gamma hyperprior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_r</code></td>
<td>

<p>Logical. If TRUE <code>alpha</code> is random with gamma hyperprior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basemeasure_hyperprior</code></td>
<td>

<p>Logical. If TRUE also the parameters of the base measure are random, see details below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixing_type</code></td>
<td>

<p>Type of mixing distribution. Default is "DP" for Dirichlet process but also "2PD" for Two-parameters-Poisson-Dirichlet process is allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algo</code></td>
<td>

<p>Type of algorithm. Current choices are: slice sampler (<code>algo="slice"</code>) or polya-urn-type sampler (<code>algo="polya-urn"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>

<p>Location hyperparameter for the latent rounded Gaussian base measure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kap</code></td>
<td>

<p>Precision hyperparameter for the latent rounded Gaussian base measure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atau</code></td>
<td>

<p>Shape hyperparameter for the Gamma distribution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btau</code></td>
<td>

<p>Scale hyperparameter for the Gamma distribution 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_a</code></td>
<td>

<p>Shape hyperparameter for the Gamma distribution for <code>alpha</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_a</code></td>
<td>

<p>Scale hyperparameter for the Gamma distribution for <code>alpha</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>

<p>Scalar integer. Lower bound for the argument of the pmf. Default is <code>max(0,min(ydis)-10)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>

<p>Scalar integer. Upper bound for the argument of the pmf. Default is <code>max(ydis)+10</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>Vector of integers (from 1 to 6) indicating whether to print each step of the Gibbs sampler.  Specifically, 1 for current iteration, 2 for the data augmentation step simulating the latent continuous variables, 3 for the DP cluster allocation, 4 for the posterior parameters of the mixture components, 5 for the precision of the DP, 6 for the posterior pmf.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndisplay</code></td>
<td>

<p>Scalar integer. It gives the number of iterations to be displayed on screen (the function reports on the screen when every <code>ndisplay</code> iterations have been carried out)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>

<p>Logical, default FALSE. If TRUE a plot with empirical and estimated posterior probability mass functions is plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdfwrite</code></td>
<td>

<p>Logical, default FALSE. If TRUE a pdf file is written in the current working directory. Traceplots and other posterior quantities are drown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments (for future implemetantions).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>rmg</code> function performs Bayesian probability mass function estimation under the mixture model of Canale and Dunson (2011) with Dirichlet process or Two-parameters-Poisson-Dirichlet process as prior for the mixing measure. The model is
</p>
<p style="text-align: center;"><code class="reqn">y_i \mid \mu_i, \tau_i \sim  \mbox{RG}(\mu_i, \tau_i), i=1, \dots, n</code>
</p>

<p style="text-align: center;"><code class="reqn">(\mu_i, \tau_i) \mid G \sim G</code>
</p>

<p style="text-align: center;"><code class="reqn">G \sim \Pi(P_0),</code>
</p>

<p>where <code class="reqn">\Pi</code> is the Dirichlet process or the Two-parameters-Poisson-Dirichlet process with base measure <code class="reqn">P_0</code> and <code class="reqn">RG(\mu, \tau)</code> is a rounded Gaussian kernel with location <code class="reqn">\mu</code> and precision <code class="reqn">\tau</code> and tresholds <code class="reqn">-\infty, 1, 2, \dots</code>.
The function <code>dpmrg</code> is a wrapper to <code>rmg</code> with <code>mixing_type="DP"</code> for back portability with version 1.0 of the package.
The main part of the code is written in C language to gain computational speed. Plots and posterior summaries are in plain R code. From version 2.0 on, the blocked gibbs sampler has been removed in place of slice samper (Kalli et al., 2011) and polya-urn sampler.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Name of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixing_type</code></td>
<td>
<p>Name of the mixing prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>Quantities about MCMC sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc.chains</code></td>
<td>
<p>MCMC chains of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmf</code></td>
<td>
<p>A list containing several quantities related to the probability mass function (emprical pmf, posterior mean pmf and pointwise 95% credible intervals) computed for the values from <code>lb</code> to <code>ub</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A list containing the posterior mean of the cluster specific parameters (be careful of label-switching problems)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>A list containing posterior quantities related to the clustering structure of the data</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>R code and porting by A. Canale, C code by A. Canale with minor contributions by N. Lunardon. 
</p>


<h3>References</h3>

<p>Canale, A. and Dunson, D. B. (2011), "Bayesian Kernel Mixtures for Counts", <em>Journal of American Statistical Association</em>, <b>106</b>, 1528-1539.
</p>
<p>Kalli, M., Griffin, J., and Walker, S. (2011), "Slice sampling mixture models," Statistics and Computing, <b>21</b>, 93-105.
</p>


<h3>See Also</h3>

<p>dpmpoiss
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ethylene)
y &lt;- tapply(ethylene$impl,FUN=mean,INDEX=ethylene$id)
z &lt;- tapply(ethylene$dose,FUN=mean,INDEX=ethylene$id)

# Estimate the pmf of the number of implants in the control group
y0  &lt;- y[z==0]
pmf.control = rmg(y0, k=20, nrep=11000, nb=1000, alpha=1, atau=1, btau=1,
lb=5, ub=24, plot.it= TRUE)

</code></pre>


</div>