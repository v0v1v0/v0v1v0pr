<div class="container">

<table style="width: 100%;"><tr>
<td>conv.map</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mapping morphological convergence on 3D surfaces</h2>

<h3>Description</h3>

<p>Given vectors of RW (or PC) scores, the function selects the
RW(PC) axes which best account for convergence and maps convergent areas on
the corresponding 3D surfaces.
</p>


<h3>Usage</h3>

<pre><code class="language-R">conv.map(dataset,pcs,mshape,conv=NULL, exclude=NULL,out.rem=TRUE,
  show.consensus=FALSE, plot=TRUE,col="blue",names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>data frame (or matrix) with the RW (or PC) scores of the group
or species to be compared.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcs</code></td>
<td>
<p>RW (or PC) vectors (eigenvectors of the covariance matrix) of all
the samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mshape</code></td>
<td>
<p>the Consensus configuration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>a named character vector indicating convergent species as
(indicated as "conv" in <code>dataset</code>) and not convergent species
(indicated as "noconv").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>integer: the index number of the RW (or PC) to be excluded
from the comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.rem</code></td>
<td>
<p>logical: if <code>TRUE</code> triangles with outlying area
difference are removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.consensus</code></td>
<td>
<p>logical: if <code>TRUE</code>, the Consensus configuration is
included in the comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: if <code>TRUE</code>, the pairwise comparisons are be plotted.
For more than 5 pairwise comparisons, the plot is not shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>character: the colour for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>logical: if <code>TRUE</code>, the names of the groups or species are
displayed in the 3d plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>conv.map</code> automatically builds a 3D mesh on the mean shape
calculated from the Relative Warp Analysis (RWA) or Principal Component
Analysis (PCA) (<cite>Schlager 2017</cite>) by applying the function
<code>vcgBallPivoting</code> (<span class="pkg">Rvcg</span>). <code>conv.map</code> further
gives the opportunity to exclude some RW (or PC) axes from the analysis
because, for example, in most cases the first axes are mainly related to
high-order morphological differences driven by phylogeny and size
variations. <code>conv.map</code> finds and plots the strength of convergence on
3D surfaces. An output of <code>conv.map</code> (if the dataset contains a number
equal or lower then 5 items) is an interactive plot mapping the convergence
on the 3D models. In the upper triangle of the 3D multiple layouts the rows
representing the reference models and the columns the target models. On the
contrary, on the lower triangle the rows correspond to the target models
and the columns the reference models. In the calculation of the differences
of areas we supply the possibility to find and remove outliers from the
vectors of areas calculated on the reference and target surfaces. We
suggest considering this possibility if the mesh may contain degenerate
facets.
</p>


<h3>Value</h3>

<p>The function returns a list including:
</p>
<ul>
<li>
<p><strong>$angle.compare</strong> data frame including the real angles
between the given shape vectors, the angles conv computed between vectors
of the selected RWs (or PCs), the angles between vectors of the
non-selected RWs (or PCs), the difference conv, and its p values.
</p>
</li>
<li>
<p><strong>$selected.pcs</strong> RWs (or PCs) axes selected for convergence.
</p>
</li>
<li>
<p><strong>$average.dist</strong> symmetric matrix of pairwise distances between
3D surfaces. </p>
</li>
<li>
<p><strong>$suface1</strong> list of coloured surfaces, if two
meshes are given, it represents convergence between mesh A and B charted on
mesh A. </p>
</li>
<li>
<p><strong>$suface2</strong> list of coloured surfaces, if two meshes are
given, it represents convergence between mesh A and B charted on mesh B.
</p>
</li>
<li> <p><strong>$scale</strong> the value used to set the colour gradient, computed
as the maximum of all differences between each surface and the mean shape.</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Marina Melchionna, Antonio Profico, Silvia Castiglione, Carmela
Serio, Gabriele Sansalone, Pasquale Raia
</p>


<h3>References</h3>

<p>Schlager, S. (2017). <em>Morpho and Rvcg–Shape Analysis in R:
R-Packages for geometric morphometrics, shape analysis and surface
manipulations.</em> In: Statistical shape and deformation analysis. Academic
Press.
Melchionna, M., Profico, A., Castiglione, S., Serio, C., Mondanaro,
A., Modafferi, M., Tamagnini, D., Maiorano, L. , Raia, P., Witmer, L.M.,
Wroe, S., &amp; Sansalone, G. (2021). A method for mapping morphological
convergence on three-dimensional digital models: the case of the mammalian
sabre-tooth. Palaeontology, 64, 573–584. doi:10.1111/pala.12542
</p>


<h3>See Also</h3>

<p><a href="../doc/search.conv.html"><code>search.conv</code> vignette</a> ;
<code>relWarps</code> ; <code>procSym</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Not run: 
  data(DataSimians)
  DataSimians$pca-&gt;pca

  ## Case 1. Convergent species only
     dato&lt;-pca$PCscores[c(1,4),]

     CM&lt;-conv.map(dataset = dato,
                 pcs = pca$PCs,
                 mshape = pca$mshape,
                 show.consensus = TRUE)

  ## Case 2. Convergent and non-convergent species
     dato&lt;-pca$PCscores[c(1,4,7),]
     conv&lt;-c("conv","conv","noconv")
     names(conv)&lt;-rownames(dato)

     CM&lt;-conv.map(dataset = dato,
                  pcs = pca$PCs,
                  mshape = pca$mshape,
                  conv = conv,
                  show.consensus = TRUE,
                  col = "orange")
  
## End(Not run)
</code></pre>


</div>