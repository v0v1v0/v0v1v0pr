<div class="container">

<table style="width: 100%;"><tr>
<td>FitCbmRoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the contaminated binormal model (CBM) to selected treatment and 
reader in an ROC dataset</h2>

<h3>Description</h3>

<p>Fit the CBM-predicted ROC curve for specified treatment and reader
</p>


<h3>Usage</h3>

<pre><code class="language-R">FitCbmRoc(dataset, trt = 1, rdr = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>The dataset containing the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trt</code></td>
<td>
<p>The desired treatment, default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdr</code></td>
<td>
<p>The desired reader, default is 1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In  CBM ratings from diseased cases are sampled from a mixture distribution 
with two components: (1) distributed normal with mean <code class="reqn">mu</code> and unit 
variance with integrated area <code class="reqn">alpha</code>, and (2) from a unit-normal 
distribution with integrated area <code class="reqn">1-alpha</code>. Ratings for non-diseased 
cases are sampled from a unit-normal distribution. The 
<code>ChisqrFitStats</code> consists of a list containing the chi-square value, 
the p-value and the degrees of freedom.
</p>


<h3>Value</h3>

<p>The return value is a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The mean of the visible diseased distribution (the non-diseased)
has zero mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The proportion of diseased cases where the disease is visible</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zetas</code></td>
<td>
<p>The cutoffs, zetas or thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUC</code></td>
<td>
<p>The AUC of the fitted ROC curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdAUC</code></td>
<td>
<p>The standard deviation of AUC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NLLIni</code></td>
<td>
<p>The initial value of negative LL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NLLFin</code></td>
<td>
<p>The final value of negative LL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ChisqrFitStats</code></td>
<td>
<p>The chisquare goodness of fit results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMat</code></td>
<td>
<p>The covariance matrix of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fittedPlot</code></td>
<td>
<p>A <span class="pkg">ggplot2</span> object containing the fitted 
operating characteristic along with the empirical operating points. 
Use <code>print()</code> to display the object</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This algorithm is very robust, much more so than the binormal model.
</p>


<h3>References</h3>

<p>Dorfman DD, Berbaum KS (2000) A contaminated binormal model for ROC data: Part II. A formal model,
Acad Radiol, 7:6, 427â€“437.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## CPU time 8.7 sec on Ubuntu (#13)
## Test with included ROC data
retFit &lt;- FitCbmRoc(dataset02);## print(retFit$fittedPlot)

## Test with included degenerate ROC data (yes! CBM can fit such data)
retFit &lt;- FitCbmRoc(datasetDegenerate);## print(retFit$fittedPlot)

## Test with single interior point data
fp &lt;- c(rep(1,7), rep(2, 3))
tp &lt;- c(rep(1,5), rep(2, 5))
dataset &lt;- Df2RJafrocDataset(fp, tp)
retFit &lt;- FitCbmRoc(dataset);## print(retFit$fittedPlot)

## Test with two interior data points
fp &lt;- c(rep(1,7), rep(2, 5), rep(3, 3))
tp &lt;- c(rep(1,3), rep(2, 5), rep(3, 7))
dataset &lt;- Df2RJafrocDataset(fp, tp)
retFit &lt;- FitCbmRoc(dataset);
## print(retFit$fittedPlot)

## Test with included ROC data (some bins have zero counts)
retFit &lt;- FitCbmRoc(dataset02, 2, 1);## print(retFit$fittedPlot)

## Test with TONY data for which chisqr can be calculated
ds &lt;- DfFroc2Roc(dataset01)
retFit &lt;- FitCbmRoc(ds, 2, 3);## print(retFit$fittedPlot)
retFit$ChisqrFitStats


</code></pre>


</div>