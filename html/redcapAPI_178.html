<div class="container">

<table style="width: 100%;"><tr>
<td>userMethods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Export, Import, or Delete Users and User Permissisons</h2>

<h3>Description</h3>

<p>These methods enable the user to add and remove users from
a project. They also enable the user to modify the permissions
granted to each user within the project.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exportUsers(rcon, ...)

importUsers(rcon, data, ...)

deleteUsers(rcon, users, ...)

## S3 method for class 'redcapApiConnection'
exportUsers(
  rcon,
  dates = TRUE,
  labels = TRUE,
  form_rights = TRUE,
  ...,
  error_handling = getOption("redcap_error_handling"),
  config = list(),
  api_param = list()
)

## S3 method for class 'redcapApiConnection'
importUsers(
  rcon,
  data,
  consolidate = TRUE,
  ...,
  error_handling = getOption("redcap_error_handling"),
  config = list(),
  api_param = list()
)

## S3 method for class 'redcapApiConnection'
deleteUsers(
  rcon,
  users,
  ...,
  error_handling = getOption("redcap_error_handling"),
  config = list(),
  api_param = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rcon</code></td>
<td>
<p>A <code>redcapConnection</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p><code>logical(1)</code>. When <code>TRUE</code>, expiration dates are converted to a
<code>POSIXct</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p><code>logical(1)</code>. When <code>TRUE</code> the data export and form access rights are
converted to factor objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form_rights</code></td>
<td>
<p><code>logical(1)</code>. When <code>TRUE</code>, the form rights will be
transformed to one column per form. The API-provided character string
is always returned with the format <code style="white-space: pre;">⁠[form_name]:[access_code]⁠</code> and a comma separating
each form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>users</code></td>
<td>
<p><code>character</code>. Vector of unique user names to be deleted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>data.frame</code>. Provides the user data for import. It must have
a column titled <code>username</code>. All other columns are optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consolidate</code></td>
<td>
<p><code>logical(1)</code>. When <code>TRUE</code>, the form and data
export access values will be read from the expanded columns. Otherwise,
the consolidated values (as provided by the API export) are utilized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to pass to other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_handling</code></td>
<td>
<p><code>character(1)</code>. One of <code>c("error", "null")</code>.
An option for how to handle errors returned by the API.
see <code>redcapError()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>config</code></td>
<td>
<p>A named <code>list</code>. Additional configuration parameters to pass to
<code>httr::POST()</code>. These are appended to any parameters in
<code>rcon$config</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>api_param</code></td>
<td>
<p>A named <code>list</code>. Additional API parameters to pass into the
body of the API call. This provides users to execute calls with options
that may not otherwise be supported by <code>redcapAPI</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>User project access fields (those not related to forms or exports)
are mapped between coded and labeled values as:</p>

<table>
<tr>
<td style="text-align: left;">
   Code </td>
<td style="text-align: left;"> Label </td>
</tr>
<tr>
<td style="text-align: left;">
   0 </td>
<td style="text-align: left;"> No Access </td>
</tr>
<tr>
<td style="text-align: left;">
   1 </td>
<td style="text-align: left;"> Access </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Form access fields are mapped as:</p>

<table>
<tr>
<td style="text-align: left;">
   Code </td>
<td style="text-align: left;"> Label </td>
</tr>
<tr>
<td style="text-align: left;">
   0 </td>
<td style="text-align: left;"> No Access </td>
</tr>
<tr>
<td style="text-align: left;">
   1 </td>
<td style="text-align: left;"> View records/responses and edit records (survey responses are read-only) </td>
</tr>
<tr>
<td style="text-align: left;">
   2 </td>
<td style="text-align: left;"> Read Only </td>
</tr>
<tr>
<td style="text-align: left;">
   3 </td>
<td style="text-align: left;"> Edit survey responses </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Form export permission fields are mapped as:</p>

<table>
<tr>
<td style="text-align: left;">
   Code </td>
<td style="text-align: left;"> Label </td>
</tr>
<tr>
<td style="text-align: left;">
   0 </td>
<td style="text-align: left;"> No Access </td>
</tr>
<tr>
<td style="text-align: left;">
   1 </td>
<td style="text-align: left;"> Full Data Set </td>
</tr>
<tr>
<td style="text-align: left;">
   2 </td>
<td style="text-align: left;"> De-Identified </td>
</tr>
<tr>
<td style="text-align: left;">
   3 </td>
<td style="text-align: left;"> Remove Identifier Fields </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h4>Importing Users/User Roles</h4>

<p>It is not required that the user provide a data frame with all of the
fields available for modification. Only fields that are provided will
be modified. The only required field for imports is the <code>username</code> field.
</p>
<p>When setting permissions for a user project access fields, form access,
and form export permissions, the user may provided any of the coded
or labeled values above. The user data is passed through
<code>prepUserImportData()</code> before sending it to the API;
text values will be converted to the numeric value.
</p>
<p>It is also permissible to use a column for each form individually, as can
be exported via <code>exportUsers()</code>. With <code>consolidate = TRUE</code>, these
settings will be consolidated into the text string expected by the API.
</p>
<p>The REDCap API does not natively allow for modifying the rights of a user
that is part of a User Role. When an attempt to modify the rights of a
user in a User Role is made with this package, the user will be removed
from the User Role, the rights modified, and then the User Role restored.
This is done silently: be aware that modifications to a user's rights
may not have an impact while the User Role is assigned.
</p>


<h5>Limitations</h5>

<p>When importing via CSV, (as redcapAPI does by default) it appears that
the form access rights are imported but may not always be reflected in
the exported values. The form export rights do not appear to be imported
when using the CSV format. We may be able to resolve this in the future
using a JSON format.
</p>




<h3>Value</h3>

<p><code>exportUsers</code> returns a data frame with the columns:</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>username</code> </td>
<td style="text-align: left;"> The unique username for a user that can access the project. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>email</code> </td>
<td style="text-align: left;"> The e-mail address associated with the user in the REDCap system. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>firstname</code> </td>
<td style="text-align: left;"> The user's first name. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>lastname</code> </td>
<td style="text-align: left;"> The user's last name. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>expiration</code> </td>
<td style="text-align: left;"> The date at which the user's access to the project will expire. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>data_access_group</code> </td>
<td style="text-align: left;"> The text name of the Data Access Group to which the user is assigned. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>data_access_group_id</code> </td>
<td style="text-align: left;"> The REDCap assigned unique identifier of the Data Access Group. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>design</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to utilize the project design modules. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>alerts</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to utlize the alerts tools. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>user_right</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to modify user rights. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>data_access_groups</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has user has permission to assign user to Data Access Groups. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>reports</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to design reports. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>stats_and_charts</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to view the Statistics and Charts module. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>manage_survey_participants</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to manage survey participants. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>calendar</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to utilize the project calendar module. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>data_import_tool</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to use the data import tool. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>data_comparison_tool</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to use the data comparison tool. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>logging</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to view the project logs (audit trail). </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>file_repository</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to access the project file repository. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>data_quality_create</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission create new data quality rules. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>data_quality_execute</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to execute data quality rules. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>api_export</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has API export privileges. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>api_import</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has API import privileges. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>mobile_app</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to use the mobile app. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>mobile_app_download_data</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permissions to download data on the mobile app. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>record_create</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to create new records. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>record_rename</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to rename existing records. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>record_delete</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to delete records. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>lock_records_all_forms</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to lock records across all forms. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>lock_records</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to lock a records on individual forms. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>lock_records_customization</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to customize record locking. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>random_setup</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to set up randomization rules. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>random_dashboard</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to view the randomization dashboard. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>random_perform</code> </td>
<td style="text-align: left;"> Boolean flag indicating if the user has permission to perform record randomization. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>forms</code> </td>
<td style="text-align: left;"> Character string listing form access rights for each form. </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>forms_export</code> </td>
<td style="text-align: left;"> Character string listing the form export rights for each form. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>When <code>form_rights = TRUE</code>, additional columns are created that give the
form access and form export rights in an individual column for each form.
Form access rights columns have the naming pattern <code style="white-space: pre;">⁠[form_name]_access⁠</code>
and the form export rights columns have the naming pattern
<code style="white-space: pre;">⁠[form_name]_export_access⁠</code>.
</p>
<p><code>importUsers</code> invisibly returns the number of users that were added or modified.
</p>
<p><code>deleteUsers</code> invisibly returns the number of users that were deleted.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>exportUsers()</code>: Export users affiliated with a project.
</p>
</li>
<li> <p><code>importUsers()</code>: Add users or modify user permissions in a project.
</p>
</li>
<li> <p><code>deleteUsers()</code>: Remove users from a project.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>exportUserRoles()</code>, <br><code>importUserRoles()</code>, <br><code>deleteUserRoles()</code>, <br><code>exportUserRoleAssignments()</code>, <br><code>importUserRoleAssignments()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
unlockREDCap(connections = c(rcon = "project_alias"), 
             url = "your_redcap_url", 
             keyring = "API_KEYs", 
             envir = globalenv())
             
# Export users
exportUsers(rcon)

# Export users without additional form access variables
exportUsers(rcon, 
            form_rights = FALSE)
            
# Export users as raw data
exportUsers(rcon, 
            labels = FALSE)
            
            
# Import new permissions
NewData &lt;- data.frame(username = "target_user", 
                      design = 0, 
                      api_export = 1, 
                      api_import = "No Access")
importUsers(rcon, 
            data = NewData)
            

# Remove a user from a project
deleteUsers(rcon, 
            users = "target_user")

## End(Not run)

</code></pre>


</div>