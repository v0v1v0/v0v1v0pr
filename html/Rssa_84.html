<div class="container">

<table style="width: 100%;"><tr>
<td>owcor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate generalized (oblique) W-correlation matrix</h2>

<h3>Description</h3>

<p>Function calculates oblique W-correlation matrix for the series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  owcor(x, groups, ..., cache = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the input object of ‘ossa’ class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>list of numeric vectors, indices of elementary components
used for reconstruction. The elementary components must belong to
the current OSSA component set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>reconstruct</code> routine</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache</code></td>
<td>
<p>logical, if 'TRUE' then intermediate results will be
cached in 'ssa' object.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Matrix of oblique weighted correlations will be computed.
For two series, oblique W-covariation is defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">%
    \mathrm{owcov}(F_1, F_2) =
      \langle L^\dagger X_1 (R^\dagger)^\mathrm{T},
              L^\dagger X_2 (R^\dagger)^\mathrm{T} \rangle_\mathrm{F},
  </code>
</p>

<p>where
<code class="reqn">X_1, X_2</code> denotes the trajectory matrices of series <code class="reqn">F_1, F_2</code>
correspondingly, <code class="reqn">L = [U_{b_1} : ... : U_{b_r}], R = [V_{b_1}: ... V_{b_r}]</code>,
where <code class="reqn">\\\{b_1, \dots, b_r\\\}</code> is current OSSA component set
(see description of ‘ossa.set’ field of ‘ossa’ object),
'<code class="reqn">\langle \cdot, \cdot
  \rangle_\mathrm{F}</code>' denotes Frobenius matrix inner product
and '<code class="reqn">\dagger</code>' denotes Moore-Penrose pseudo-inverse matrix.
</p>
<p>And oblique W-correlation is defined the following way:
</p>
<p style="text-align: center;"><code class="reqn">%
    \mathrm{owcor}(F_1, F_2) = \frac{\mathrm{owcov}(F_1, F_2)}
      {\sqrt{\mathrm{owcov}(F_1, F_1) \cdot \mathrm{owcov(F_2, F_2)}}}
  </code>
</p>

<p>Oblique W-correlation is an OSSA analogue of W-correlation, that is, a
measure of series separability. If I-OSSA procedure separates series
exactly, their oblique W-correlation will be equal to zero.
</p>


<h3>Value</h3>

<p>Object of class ‘wcor.matrix’
</p>


<h3>References</h3>

<p>Golyandina N. and Shlemov A. (2015): <em>Variations of Singular Spectrum Analysis
for separability improvement: non-orthogonal decompositions of time series</em>, 
Statistics and Its Interface. Vol.8, No 3, P.277-294.
<a href="https://arxiv.org/abs/1308.4022">https://arxiv.org/abs/1308.4022</a>
</p>


<h3>See Also</h3>

<p><code>Rssa</code> for an overview of the package, as well as,
<code>wcor</code>,
<code>iossa</code>,
<code>fossa</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Separate two non-separable sines
N &lt;- 150
L &lt;- 70

omega1 &lt;- 0.06
omega2 &lt;- 0.065

F &lt;- 4*sin(2*pi*omega1 * (1:N)) + sin(2*pi*omega2 * (1:N))
s &lt;- ssa(F, L)
ios &lt;- iossa(s, nested.groups = list(1:2, 3:4), kappa = NULL, maxIter = 200, tol = 1e-8)

p.wcor &lt;- plot(wcor(ios, groups = list(1:2, 3:4)))
p.owcor &lt;- plot(owcor(ios, groups = list(1:2, 3:4)), main = "OW-correlation matrix")
print(p.wcor, split = c(1, 1, 2, 1), more = TRUE)
print(p.owcor, split = c(2, 1, 2, 1))
</code></pre>


</div>