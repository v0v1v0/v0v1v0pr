<div class="container">

<table style="width: 100%;"><tr>
<td>vartest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibrated variance test between two or more independent samples</h2>

<h3>Description</h3>

<p>Tests the equality of variance for continuous independent samples using Welch's ANOVA on the square of the centered variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vartest(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>the two continuous variables for the two samples variance test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters such as <code>alternative</code> which indicates the alternative hypothesis
as one of "two.sided", "greater" or "less", or <code>data</code> and <code>formula</code> to include a dataset with a formula
from the command <code>vartest(x~y,data=dataset)</code> with dataset the name of the data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the two sample variance test, the null hypothesis is: H0 var(X)=var(Y) where var represents the variance.
The alternative is specified by the <code>alternative</code> argument.
The test uses Welch's ANOVA procedure on the variables <code class="reqn">(x_i-mean(x))^2</code>, <code class="reqn">(y_i-mean(y))^2</code> and is asymptotically well calibrated in the sense that the rejection probability under the null hypothesis is asymptotically equal to the level of the test.
The test can be applied to more than two groups in which case it tests if all groups have the same variance.
</p>


<h3>Value</h3>

<p>Returns the result of the test with its corresponding p-value and the value of the test statistic. In the two sample case, the function
also returns the confidence interval for the difference of the two variances.
</p>


<h3>Note</h3>

<p>The function can also be called using formulas: type <code>vartest(x~y,data)</code> with x the quantitative variable
and y a factor variable with two or more levels. For more than two groups, only the formula is valid.
</p>


<h3>See Also</h3>

<p><code>cortest</code>, <code>indeptest</code>, <code>mediantest</code>, <code>wilcoxtest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Application on the Evans dataset
data(Evans)
#Description of this dataset is available in the lbreg package
with(Evans,var.test(CHL[CDH==0],CHL[CDH==1]))
with(Evans,vartest(CHL[CDH==0],CHL[CDH==1]))
vartest(CHL~CDH,data=Evans) #using formulas

#Similar pvalues between var.test and vartest


#Simulated data
n=60 #sample size
M=10000 #number of replications
testone=function(n){
X=rnorm(n,0,1)
Y=rchisq(2*n,df=2)/2
list(test1=vartest(X,Y)$p.value,test2=var.test(X,Y)$p.value) #var.test is the standard Fisher test
}
res1=res2=rep(NA,M)
# Replications to check if the corrected Fisher test and the standard test are well calibrated
for (i in 1:M)
{
result=testone(n)
res1[i]=result$test1
res2[i]=result$test2
}
mean(res1&lt;0.05)  #0.0515
mean(res2&lt;0.05)  #0.1509

</code></pre>


</div>