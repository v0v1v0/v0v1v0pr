<div class="container">

<table style="width: 100%;"><tr>
<td>perturb_vr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perturbation analysis of vital rates in a matrix population model</h2>

<h3>Description</h3>

<p>Perturbs lower-level vital rates within a matrix population model and
measures the response (sensitivity or elasticity) of the per-capita
population growth rate at equilibrium (<code class="reqn">\lambda</code>), or, with a
user-supplied function, any other demographic statistic.
</p>
<p>These decompositions assume that all transition rates are products of a
stage-specific survival term (column sums of <code>matU</code>) and a lower level
vital rate that is conditional on survival (growth, shrinkage, stasis,
dormancy, or reproduction). Reproductive vital rates that are not conditional
on survival (i.e., within a stage class from which there is no survival) are
also allowed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perturb_vr(
  matU,
  matF,
  matC = NULL,
  pert = 1e-06,
  type = "sensitivity",
  demog_stat = "lambda",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matU</code></td>
<td>
<p>The survival component of a matrix population model (i.e., a
square projection matrix reflecting survival-related transitions; e.g.,
progression, stasis, and retrogression).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matF</code></td>
<td>
<p>The sexual component of a matrix population model (i.e., a square
projection matrix reflecting transitions due to sexual reproduction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matC</code></td>
<td>
<p>The clonal component of a matrix population model (i.e., a square
projection matrix reflecting transitions due to clonal reproduction).
Defaults to <code>NULL</code>, indicating no clonal reproduction (i.e.,
<code>matC</code> is a matrix of zeros).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pert</code></td>
<td>
<p>Magnitude of the perturbation. Defaults to <code>1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Whether to return <code>sensitivity</code> or <code>elasticity</code> values.
Defaults to <code>sensitivity</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demog_stat</code></td>
<td>
<p>The demographic statistic to be used, as in "the
sensitivity/elasticity of <code>demog_stat</code> to vital rate perturbations."
Defaults to the per-capita population growth rate at equilibrium
(<code class="reqn">\lambda</code>). Also accepts a user-supplied function that performs a
calculation on a projection matrix and returns a single numeric value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the function <code>demog_stat</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with 5 elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>survival</code></td>
<td>
<p>sensitivity or elasticity of <code>demog_stat</code> to survival</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>growth</code></td>
<td>
<p>sensitivity or elasticity of <code>demog_stat</code> to growth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>sensitivity or elasticity of <code>demog_stat</code> to shrinkage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fecundity</code></td>
<td>
<p>sensitivity or elasticity of <code>demog_stat</code> to sexual
fecundity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clonality</code></td>
<td>
<p>sensitivity or elasticity of <code>demog_stat</code> to clonality</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rob Salguero-Gomez &lt;rob.salguero@zoo.ox.ac.uk&gt;
</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other perturbation analysis: 
<code>perturb_matrix()</code>,
<code>perturb_stochastic()</code>,
<code>perturb_trans()</code>,
<code>pop_vectors()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">matU &lt;- rbind(
  c(0.1, 0, 0, 0),
  c(0.5, 0.2, 0.1, 0),
  c(0, 0.3, 0.3, 0.1),
  c(0, 0, 0.5, 0.6)
)

matF &lt;- rbind(
  c(0, 0, 1.1, 1.6),
  c(0, 0, 0.8, 0.4),
  c(0, 0, 0, 0),
  c(0, 0, 0, 0)
)

perturb_vr(matU, matF)

# use elasticities rather than sensitivities
perturb_vr(matU, matF, type = "elasticity")

# use a larger perturbation than the default
perturb_vr(matU, matF, pert = 0.01)

# calculate the sensitivity/elasticity of the damping ratio to vital rate
#  perturbations
damping &lt;- function(matA) { # define function for damping ratio
  eig &lt;- eigen(matA)$values
  dm &lt;- rle(Mod(eig))$values
  return(dm[1] / dm[2])
}

perturb_vr(matU, matF, demog_stat = "damping")

</code></pre>


</div>