<div class="container">

<table style="width: 100%;"><tr>
<td>PPpSceptical</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute project power of the sceptical p-value</h2>

<h3>Description</h3>

<p>The project power of the sceptical p-value is computed for a
specified level, the relative variance,
significance level and power for a standard significance test of
the original study, and the alternative hypothesis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PPpSceptical(
  level,
  c,
  alpha,
  power,
  alternative = c("one.sided", "two.sided"),
  type = c("golden", "nominal", "controlled")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Threshold for the calibrated sceptical p-value.
Default is 0.025.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Numeric vector of variance ratios of the original and replication
effect estimates. This is usually the ratio of the sample
size of the replication study to the sample size of the
original study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level for a standard significance test in
the original study. Default is 0.025.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Power to detect the assumed effect with a standard significance test
in the original study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Specifies if <code>level</code> and
<code>alpha</code> are "two.sided" or "one.sided".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of recalibration. Can be either "golden" (default), "nominal" (no recalibration),
or "controlled".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>PPpSceptical</code> is the vectorized version of
the internal function <code>.PPpSceptical_</code>.
<code>Vectorize</code> is used to vectorize the function.
</p>


<h3>Value</h3>

<p>The project power of the sceptical p-value
</p>


<h3>Author(s)</h3>

<p>Leonhard Held, Samuel Pawel
</p>


<h3>References</h3>

<p>Held, L. (2020). The harmonic mean chi-squared test to substantiate
scientific findings. <em>Journal of the Royal Statistical Society: Series C
(Applied Statistics)</em>, <b>69</b>, 697-708. <a href="https://doi.org/10.1111/rssc.12410">doi:10.1111/rssc.12410</a>
</p>
<p>Held, L., Micheloud, C., Pawel, S. (2022). The assessment of replication
success based on relative effect size. The Annals of Applied Statistics.
16:706-720.<a href="https://doi.org/10.1214/21-AOAS1502">doi:10.1214/21-AOAS1502</a>
</p>
<p>Maca, J., Gallo, P., Branson, M., and Maurer, W. (2002).  Reconsidering some aspects
of the two-trials paradigm. <em>Journal of Biopharmaceutical Statistics</em>, <b>12</b>,
107-119. <a href="https://doi.org/10.1081/bip-120006450">doi:10.1081/bip-120006450</a>
</p>


<h3>See Also</h3>

<p><code>pSceptical</code>, <code>levelSceptical</code>, <code>T1EpSceptical</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## compare project power for different recalibration types
types &lt;- c("nominal", "golden", "controlled")
c &lt;- seq(0.4, 5, by = 0.01)
alpha &lt;- 0.025
power &lt;- 0.9
pp &lt;- sapply(X = types, FUN = function(t) {
  PPpSceptical(type = t, c = c, alpha, power, alternative = "one.sided",
               level = 0.025)
})

## compute project power of 2 trials rule
za &lt;- qnorm(p = 1 - alpha)
mu &lt;- za + qnorm(p = power)
pp2TR &lt;- power * pnorm(q = za, mean = sqrt(c) * mu, lower.tail = FALSE)

matplot(x = c, y = pp * 100, type = "l", lty = 1, lwd = 2, las = 1, log = "x",
        xlab = bquote(italic(c)), ylab = "Project power (%)", xlim = c(0.4, 5),
        ylim = c(0, 100))
lines(x = c, y = pp2TR * 100, col = length(types) + 1, lwd = 2)
abline(v = 1, lty = 2)
abline(h = 90, lty = 2, col = "lightgrey")
legend("bottomright", legend = c(types, "2TR"), lty = 1, lwd = 2,
       col = seq(1, length(types) + 1))
</code></pre>


</div>