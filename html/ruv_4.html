<div class="container">

<table style="width: 100%;"><tr>
<td>getK</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Get K
</h2>

<h3>Description</h3>

<p>Finds an often-suitable value of K for use in RUV-4.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getK(Y, X, ctl, Z = 1, eta = NULL, include.intercept = TRUE,
     fullW0 = NULL, cutoff = NULL, method="select", l=1, inputcheck = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>The data.  A m by n matrix, where m is the number of samples and n is the number of features.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>The factor(s) of interest.  A m by p matrix, where m is the number of samples and p is the number of factors of interest.  Note that X should be only a single column, i.e. p = 1; if X has more than one column, only column <code>l</code> will be used (see below).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctl</code></td>
<td>

<p>An index vector to specify the negative controls.  Either a logical vector of length n or a vector of integers.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>Any additional covariates to include in the model, typically a m by q matrix.  Factors and dataframes are also permissible, and converted to a matrix by <code>design.matrix</code>.  Alternatively, may simply be 1 (the default) for an intercept term.  May also be <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>

<p>Gene-wise (as opposed to sample-wise) covariates.  These covariates are adjusted for by RUV-1 before any further analysis proceeds.  Can be either (1) a matrix with n columns, (2) a matrix with n rows, (3) a dataframe with n rows, (4) a vector or factor of length n, or (5) simply 1, for an intercept term.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.intercept</code></td>
<td>

<p>Applies to both <code>Z</code> and <code>eta</code>.  When <code>Z</code> or <code>eta</code> (or both) is specified (not <code>NULL</code>) but does not already include an intercept term, this will automatically include one.  If only one of <code>Z</code> or <code>eta</code> should include an intercept, this variable should be set to <code>FALSE</code>, and the intercept term should be included manually where desired.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullW0</code></td>
<td>

<p>Can be included to speed up execution.  Is returned by previous calls of <code>getK</code>, <code>RUV4</code>, <code>RUVinv</code>, or <code>RUVrinv</code> (see  below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>

<p>Specify an alternative cut-off.  Default is the (approximate) 90th percentile of the distribution of the first singular value of an m by n gaussian matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Can be set to either <code>leave1out</code>, <code>fast</code>, or <code>select</code>.  <code>leave1out</code> is the preferred method but may be slow, <code>fast</code> is an approximate method that is faster but may provide poor results if n_c is not much larger than m, and <code>select</code> (the default) tries to choose for you.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>

<p>Which column of X to use in the getK algorithm. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputcheck</code></td>
<td>

<p>Perform a basic sanity check on the inputs, and issue a warning if there is a problem.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the estimated value of k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>The cutoff value used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeratios</code></td>
<td>
<p>A measure of the relative sizes of the rows of alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullW0</code></td>
<td>
<p>Can be used to speed up future calls of RUV4.</p>
</td>
</tr>
</table>
<h3>Warning </h3>

<p>This value of K will not be the best choice in all cases.  Moreover, it will often be a poor choice of K for use with RUV2.  See Gagnon-Bartsch and Speed (2012) for commentary on estimating k.</p>


<h3>Author(s)</h3>

<p>Johann Gagnon-Bartsch <a href="mailto:johanngb@umich.edu">johanngb@umich.edu</a>
</p>


<h3>References</h3>

<p>Using control genes to correct for unwanted variation in microarray data.  Gagnon-Bartsch and Speed, 2012.  Available at: <a href="http://biostatistics.oxfordjournals.org/content/13/3/539.full">http://biostatistics.oxfordjournals.org/content/13/3/539.full</a>. 
</p>
<p>Removing Unwanted Variation from High Dimensional Data with Negative Controls.  Gagnon-Bartsch, Jacob, and Speed, 2013.  Available at: <a href="http://statistics.berkeley.edu/tech-reports/820">http://statistics.berkeley.edu/tech-reports/820</a>.
</p>


<h3>See Also</h3>

<p><code>RUV4</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create some simulated data
m = 50
n = 10000
nc = 1000
p = 1
k = 20
ctl = rep(FALSE, n)
ctl[1:nc] = TRUE
X = matrix(c(rep(0,floor(m/2)), rep(1,ceiling(m/2))), m, p)
beta = matrix(rnorm(p*n), p, n)
beta[,ctl] = 0
W = matrix(rnorm(m*k),m,k)
alpha = matrix(rnorm(k*n),k,n)
epsilon = matrix(rnorm(m*n),m,n)
Y = X%*%beta + W%*%alpha + epsilon

## Run getK
temp = getK(Y, X, ctl)
K = temp$k
</code></pre>


</div>