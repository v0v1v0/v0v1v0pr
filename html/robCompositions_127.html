<div class="container">

<table style="width: 100%;"><tr>
<td>biomarker</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>biomarker</h2>

<h3>Description</h3>

<p>The function for identification of biomakers and 
outlier diagnostics as described in paper "Robust biomarker 
identification in a two-class problem based on pairwise log-ratios"
</p>


<h3>Usage</h3>

<pre><code class="language-R">biomarker(
  x,
  cut = qnorm(0.975, 0, 1),
  g1,
  g2,
  type = "tau",
  diag = TRUE,
  plot = FALSE,
  diag.plot = FALSE
)

## S3 method for class 'biomarker'
plot(x, cut = qnorm(0.975, 0, 1), type = "Vstar", ...)

## S3 method for class 'biomarker'
print(x, ...)

## S3 method for class 'biomarker'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut</code></td>
<td>
<p>cut-off value, initialy set as 0.975 quantile of standard normal distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g1</code></td>
<td>
<p>vector with locations of observations of group 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g2</code></td>
<td>
<p>vector with locations of observations of group 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of estimation of the variation matrix. Possible values are <code>"sd"</code>,  <code>"mad"</code> and <code>"tau"</code>, representing Standard deviation, Median absolute deviation and Tau estimator of scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>logical, indicating wheter outlier diagnostic should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, indicating wheter Vstar values should be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag.plot</code></td>
<td>
<p>logical, indicating wheter outlier diagnostic plot should be made</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments can be passed through</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class biomarker</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Robust biomarker identification and outlier diagnostics
</p>
<p>The method computes variation matrices separately with 
observations from both groups and also together with all observations. 
Then, <em>V</em> statistics is then computed and normalized. 
The variables, for which according <em>V*</em> values are bigger that the 
cut-off value are considered as biomarkers.
</p>


<h3>Value</h3>

<p>The function returns object of type "biomarker".
Functions <code>print</code>, <code>plot</code> and <code>summary</code> are available.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>biom.ident</code></td>
<td>
<p>List of <code>V, Vstar, biomarkers</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Values of <em>V</em> statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vstar</code></td>
<td>
<p>Normalizes values of <em>V</em> statistics (V^* values))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biomarkers</code></td>
<td>
<p>Logical value, indicating if certain variable was identified as biomarker</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>Outlier diagnostics (returned only if <code>diag=TRUE</code>)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jan Walach
</p>


<h3>See Also</h3>

<p>plot.biomarker
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Data simulation
set.seed(4523)
n &lt;- 40; p &lt;- 50
r &lt;- runif(p, min = 1, max = 10)
conc &lt;- runif(p, min = 0, max = 1)*5+matrix(1,p,1)*5
a &lt;- conc*r
S &lt;- rnorm(n,0,0.3) %*% t(rep(1,p))
B &lt;- matrix(rnorm(n*p,0,0.8),n,p)
R &lt;- rep(1,n) %*% t(r)
M &lt;- matrix(rnorm(n*p,0,0.021),n,p)
# Fifth observation is an outlier
M[5,] &lt;- M[5,]*3 + sample(c(0.5,-0.5),replace=TRUE,p)
C &lt;- rep(1,n) %*% t(conc)
C[1:20,c(2,15,28,40)] &lt;- C[1:20,c(2,15,28,40)]+matrix(1,20,4)*1.8
X &lt;- (1-S)*(C*R+B)*exp(M)
# Biomarker identification
b &lt;- biomarker(X, g1 = 1:20, g2 = 21:40, type = "tau")
</code></pre>


</div>