<div class="container">

<table style="width: 100%;"><tr>
<td>roc.summary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Summary ROC Curve For Aggregated Data.
</h2>

<h3>Description</h3>

<p>This function computes summary ROC curve (Combescure et al., 2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">roc.summary(study.num, classe, n, year, surv, nrisk, proba, marker.min,
 marker.max, init.nlme1, precision, pro.time, time.cutoff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>study.num</code></td>
<td>
<p>A numeric vector (1,2,3,...) with the study identification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classe</code></td>
<td>
<p>A numeric vector with integers (1,2,3,...) for identifying the groups  defined using the studied marker. 1 is the first group with the lowest values of the marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric vector with the number of subjects at the baseline (date of marker collection).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>A numeric vector with the survival times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv</code></td>
<td>
<p>A numeric vector with the survival probabilities corresponding to the previous times (often obtained graphically using the published survival curves).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrisk</code></td>
<td>
<p>A numeric vector with the number of subjects at-risk of the event at the corresponding <code>year</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba</code></td>
<td>
<p>This numeric vector represents the proportion of the patients in a center which belong to the corresponding group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker.min</code></td>
<td>
<p>A numeric vector with the minimum values of the marker interval corresponding to the previous class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker.max</code></td>
<td>
<p>A numeric vector with the maximum values of the marker interval corresponding to the previous class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.nlme1</code></td>
<td>
<p>A numeric vector with the initiate values (mean, sd) of the maker distribution which is assumed to be Gaussian. Default is (0,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>A numeric vector with the initiate values (mean, sd) of the maker distribution which is assumed to be Gaussian. Default is <code class="reqn">10^{-6}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pro.time</code></td>
<td>
<p>The value of prognostic time is the maximum delay for which the capacity of the variable is evaluated. The same unit than the one used in the argument <code>time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.cutoff</code></td>
<td>
<p>The value of internal threasholds for the definition of the piecewise hazard function (3 values for a 4-piece constant function and 4 values for a 5-piece constant function).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes summary ROC curve. The hazard function associated with the time-to-event was defined as a 4-piece or a 5-piece constant function with a specific association with the marker at each interval. The maker distribution is assumed to be Gaussian distributed.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nlme1</code></td>
<td>
<p>An object of class <code>nlme</code> representing the nonlinear mixed-effects model of the marker distribution. The marker is assumed Gaussian distributed. <code>mu</code> and <code>sigma</code> represent the mean and the standard deviation. The inter-study variability is modeled with a random effect on the mean. See nlmeObject for the components of the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlme2</code></td>
<td>
<p>An object of class <code>nlme</code> representing the nonlinear mixed-effects model of the time distribution. The hazard function is a stepwise function with 5 intervals. <code>exp(beta0.1)</code> and <code>exp(beta0.2)</code> represent the baseline hazard and the hazard ratio in the first interval. <code>exp(beta1.1)</code> and <code>exp(beta1.2)</code> represent the corrections of these parameters for the second interval... The inter-study variability is modeled with a random effect on the baseline parameter <code>beta0.1</code>. See nlmeObject for the components of the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table</code></td>
<td>
<p>This data frame presents the sensitivities (<code>se</code>) and specificities (<code>sp</code>) associated with the cut-off values (<code>cut.off</code>). <code>J</code> represents the Youden index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auc</code></td>
<td>
<p>The area under the SROC curve for a prognostic up to prognostic time.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yohann Foucher &lt;Yohann.Foucher@univ-poitiers.fr&gt;
</p>
<p>Christophe Combescure &lt;christophe.combescure@hcuge.ch&gt;
</p>


<h3>References</h3>

<p>Combescure et al. A literature-based approach to evaluate the predictive capacity of a marker using time-dependent Summary Receiver Operating Characteristics. Stat Methods Med Res, 25(2):674-85, 2016. &lt;doi: 10.1177/ 0962280212464542&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# The example is too long to compute for a submission on the CRAN
# Remove the characters '#'

### import and attach the data example
# data(dataKi67)

### Compute the SROC curve for a prognostic up to 9 years
# roc9y&lt;-roc.summary(dataKi67$study.num, dataKi67$classe, dataKi67$n,
# dataKi67$year, dataKi67$surv, dataKi67$nrisk, dataKi67$proba,
# dataKi67$log.marker.min, dataKi67$log.marker.max,
# init.nlme1=c(2.55, -0.29), precision=50, pro.time=9,
# time.cutoff=c(2, 4, 8))

### The ROC graph associated to these to SROC curves
# plot(roc9y, col=1, lty=1, lwd=2, type="l", xlab="1-specificity", ylab="sensibility")

### Check of the goodness-of-fit: the observed proportions of
### patients in the $g$th interval of the study $k$ versus the
### fitted proportions (equation 3).

# plot(roc9y$data.marker$proba, roc9y$data.marker$fitted,
# xlab="Observed probabilities", ylab="Fitted probabilities",
# ylim=c(0,1), xlim=c(0,1))
# abline(0,1)

### Check of the goodness-of-fit: the observed bivariate
### probabilities versus the fitted bivariate
### probabilities (equation 4).

# plot(roc9y$data.surv$p.joint, roc9y$data.surv$fitted,
# xlab="Observed probabilities", ylab="Fitted probabilities",
# ylim=c(0,1), xlim=c(0,1))
# abline(0,1)

### Check of the goodness-of-fit: the residuals of the bivariate
### probabilities (equation 4) versus the times.

# plot(roc9y$data.surv$year, roc9y$data.surv$resid,
# xlab="Survival time (years)", ylab="Residuals")
# lines(lowess(roc9y$data.surv$year,
# I(roc9y$data.surv$resid), iter=0))
</code></pre>


</div>