<div class="container">

<table style="width: 100%;"><tr>
<td>run_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run parametric fits using types of models on concentration-response datasets</h2>

<h3>Description</h3>

<p>Confidence intervals of activity metrics can be obtained through bootstrap approach.
The bootstrap samples are generated by adding the residuals (the difference between the original responses and the Hill fit) to
the fitted response (only for Hill equation, 3-parameter).
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_fit(d, modls, keep_sets = c("fit_set", "resp_set"), n_samples = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Datasets with concentration-response data.
An example is zfishbeh.
mask column is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modls</code></td>
<td>
<p>The model types for the fitting.
Currently available models are 3-parameter Hill model (hill), constant model (cnst),
and Curve Class2 4-parameter Hill model (cc2).
Multiple values are only allowed for the hill and cnst combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_sets</code></td>
<td>
<p>Output datasets. Multiple values are allowed.
Default values are fit_set and resp_set.
fit_set is a must.
</p>

<ul>
<li>
<p> fit_set: a tibble with output from model fits
</p>
</li>
<li>
<p> resp_set: a tibble with fitted response data from the winning model.
If winning model is hill + no fit or cc2 + hit=4(inactive), response is NA.
If winning model is cnst, median of all responses is reported for each concentration.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_samples</code></td>
<td>
<p>NULL (default) for no bootstrap samples are generated or number of samples to be generated from bootstrapping.
When n_samples is not NULL, modls currently needs to be hill.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>The named input configurations for replacing the default configurations.
The input configuration needs to add model type as the prefix.
For example, hill_pdir = -1 will set the Hill fit only to the decreasing direction.
Add cc2_classSD = 10 will set the classification SD to 10%.
Often 5% or 10% are used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of named components: result and result_nested.
The result component is also a list of output sets depending on the parameter, <em>keep_sets</em>.
The result_nested component is a tibble with input data nested in a column, input,
and output data nested in a column, output.
</p>


<h3>Data structure</h3>

<p>output
|- result (list)
|   |- fit_set
|   |- resp_set
|
|- result_nested (tibble)
</p>
<p>The prefix of the column names in the <em>fit_set</em> are the used models.
The <em>win_modl</em> is the winning model.
</p>


<h3>See Also</h3>

<p><code>fit_modls()</code> for model fit information and the following analyses using <code>summarize_fit_output()</code>.
for dichotomous response (see zfishdev), use <code>create_dataset()</code> first.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# It is suggested to use na.omit on the dataset to see if any data will be removed

# use hill + cnst model
fitd &lt;- run_fit(zfishbeh, modls = c("hill", "cnst"))

# use only hill model and fit only to the decreasing direction, keep only the fit_set output
fitd &lt;- run_fit(zfishbeh, modls = "hill", keep_sets = "fit_set", hill_pdir = -1)

# use cc2 model + higher classification SD
fitd &lt;- run_fit(zfishbeh, modls = "cc2", cc2_classSD = 10)

# fit to the bootstrap samples using hill
fitd &lt;- run_fit(zfishbeh, n_samples = 2, modls = "hill")



</code></pre>


</div>