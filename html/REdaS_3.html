<div class="container">

<table style="width: 100%;"><tr>
<td>Bartlett-Sphericity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bartlett's Test of Sphericity</h2>

<h3>Description</h3>

<p>Implements Barlett's Test of Sphericity which tests whether a matrix is significantly different from an identity matrix.</p>


<h3>Usage</h3>

<pre><code class="language-R">bart_spher(x, use = c("everything", "all.obs", "complete.obs",
                      "na.or.complete", "pairwise.complete.obs"))

## S3 method for class 'bart_spher'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a data matrix or the object to be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>defines the method to use if missing values are present (see Examples and <code>cor</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments for the <code>print</code> method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test statistic <code class="reqn">X^2</code> as defined in Eq. (3) in Bartlett (1951) is <code class="reqn">X^2=-[(n-1)-(2k+5)/6]\cdot\log(\left|\mathbf{R}\right|)</code>
where <code class="reqn">n</code> is the number of observations, <code class="reqn">k</code> the number of variables, and <code class="reqn">\mathbf{R}</code> the correlation matrix of the data supplied in <code>x</code>. <code class="reqn">\left|\mathbf{R}\right|</code> is the determinant of <code class="reqn">\mathbf{R}</code>.
</p>
<p>Bartlett's <code class="reqn">X^2</code> is asymptotically <code class="reqn">\chi^2</code>-distributed with <code class="reqn">\mathit{df}=k(k-1)/2</code> under the null hypothesis.
</p>
<p>Note that, because the bias-corrected correlation matrix is used, <code class="reqn">(n-1)</code> is employed instead of <code class="reqn">n</code>, as in the paper.
</p>


<h4>Treatment of Missing Values</h4>

<p>If no missing values are present in the data matrix <code>x</code>, <code>use</code> will work with any setting and no adjustments are necessary. In this case, <code class="reqn">n</code> is the number of rows in <code>x</code>.
</p>
<p>For listwise deletion (<code>use = "complete.obs"</code> or <code>"na.or.complete"</code>), <code class="reqn">n</code> is the number of remaining rows in <code>x</code>.
</p>
<p>When <code>use = "pairwise.complete.obs"</code>, <code class="reqn">n</code> is approximated as the sum of relative non-missing responses for all observations with 2 or more valid responses.
</p>
<p>If listwise/pairwise methods are used to compute the correlation matrix and the test statistic, a warning will be issued when printing the object.
</p>



<h3>Value</h3>

<p>A list object of class <code>'bart_spher'</code>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the issued function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the original data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cormat</code></td>
<td>
<p>the correlation matrix computed from the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>treatment of <code>NA</code>s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of used observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of variables/items</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>the computed <code class="reqn">X^2</code> value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the <code class="reqn">p</code>-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>logical value indicating whether a warning regarding missing values will be issued (see Details)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marco J. Maier</p>


<h3>References</h3>

<p>Bartlett, M. S. (1951). The Effect of Standardization on a <code class="reqn">\chi^2</code> Approximation in Factor Analysis. <em>Biometrika 38</em>(3/4), 337â€“344.</p>


<h3>See Also</h3>

<p><code>cor()</code> and <code>KMOS()</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># generate a data frame with 3 variables and 100 observations
set.seed(5L)
datamatrix &lt;- data.frame("A" = rnorm(100), "B" = rnorm(100), "C" = rnorm(100))
head(datamatrix)

# correlation matrix
cor(datamatrix)


# bartlett's test
bart_spher(datamatrix)


# effects of missing observations on correlations: to illustrate this, the first
# observation on variable A is set to NA
datamatrix[1, 1] &lt;- NA
head(datamatrix)

# "everything" (the default) causes all correlations involving a variable with
# missing values to be NA (in this case, all pairwise correlations with the
# variable "A")
cor(datamatrix)

# "all.obs" generates an error if missing values are present.
## Not run: 
cor(datamatrix, use = "all.obs")
## End(Not run)

# "complete.obs" and "na.or.complete" delete complete observations if there are
# NA (in this case, the first case would be deleted). If there are no complete
# cases left after the listwise deletion, "complete.obs" results in an error
# while "na.or.complete" returns a matrix with all elements being NA.
cor(datamatrix, use = "complete.obs")
cor(datamatrix, use = "na.or.complete")

# "pairwise.complete.obs" uses all non-missing pairwise values. If there are no
# non-missing value pairs in two variables, the results will be NA.
# It is possible that correlation matrices are not positive semi-definite.
cor(datamatrix, use = "pairwise.complete.obs")


# with the missing value in the first cell, the test does not work anymore:
## Not run: 
bart_spher(datamatrix)
## End(Not run)

# deleting the whole first observation (listwise) gives
bart_spher(datamatrix, use = "na.or.complete")

# using pairwise-correlation, the result is
bart_spher(datamatrix, use = "pairwise.complete.obs")
</code></pre>


</div>