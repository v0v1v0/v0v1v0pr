<div class="container">

<table style="width: 100%;"><tr>
<td>edgeHeat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize (precision) matrix as a heatmap</h2>

<h3>Description</h3>

<p>Function that visualizes a (precision) matrix as a heatmap. May be used to
assess visually the elements of a single (possibly sparsified precision)
matrix. May also be used in assessing the performance of edge selection
techniques.
</p>


<h3>Usage</h3>

<pre><code class="language-R">edgeHeat(
  M,
  lowColor = "blue",
  highColor = "red",
  textsize = 10,
  diag = TRUE,
  legend = TRUE,
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>(Possibly sparsified precision) <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowColor</code></td>
<td>
<p>A <code>character</code> that determines the color scale in the
negative range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highColor</code></td>
<td>
<p>A <code>character</code> that determines the color scale in the
positive range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>textsize</code></td>
<td>
<p>A <code>numeric</code> scaling the text size of row and column
labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>A <code>logical</code> determining if the diagonal elements of the
matrix should be included in the color scaling. This argument is only used
when <code>M</code> is a square <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>A <code>logical</code> indicating whether a color legend should be
included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A <code>character</code> giving the main figure title.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function utilizes
<a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> (Wickham, 2009) to
visualize a matrix as a heatmap: a false color plot in which the individual
matrix entries are represented by colors. <code>lowColor</code> determines the
color scale for matrix entries in the negative range. <code>highColor</code>
determines the color scale for matrix entries in the positive range. For the
colors supported by the arguments <code>lowColor</code> and <code>highColor</code>, see
<a href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf">https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf</a>. White entries in
the plot represent the midscale value of 0. One can opt to set the diagonal
entries to the midscale color of white when one is interested in
(heatmapping) the off-diagonal elements only. To achieve this, set
<code>diag = FALSE</code>. Naturally, the <code>diag</code> argument is only used when
the input matrix <code>M</code> is a square matrix.
</p>
<p>The intended use of the function is to visualize a, possibly sparsified,
precision matrix as a heatmap. The function may also be used, in a graphical
modeling setting, to assess the performance of edge selection techniques.
However, the function is quite general, in the sense that it can represent
any <code>matrix</code> as a heatmap.
</p>


<h3>Author(s)</h3>

<p>Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;, Wessel N. van Wieringen
</p>


<h3>References</h3>

<p>Wickham, H. (2009). ggplot2: elegant graphics for data analysis.
New York: Springer.
</p>


<h3>See Also</h3>

<p><code>covML</code>, <code>ridgeP</code>, <code>sparsify</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Obtain some (high-dimensional) data
p = 25
n = 10
set.seed(333)
X = matrix(rnorm(n*p), nrow = n, ncol = p)
colnames(X)[1:25] = letters[1:25]
Cx &lt;- covML(X)

## Obtain regularized precision matrix
P &lt;- ridgeP(Cx, lambda = 10, type = "Alt")

## Obtain sparsified partial correlation matrix
PC0 &lt;- sparsify(P, threshold = "localFDR", FDRcut = .8)$sparseParCor

## Visualize sparsified partial correlation matrix as heatmap
edgeHeat(PC0)

</code></pre>


</div>