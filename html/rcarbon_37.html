<div class="container">

<table style="width: 100%;"><tr>
<td>plot.stKde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot map(s) of the spatio-temporal intensity of radiocarbon dates.</h2>

<h3>Description</h3>

<p>Plotting function for single or multiple maps of the spatio-temporal intensity of radiocarbon dates at given focal years.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'stKde'
plot(
  x,
  focalyears = NULL,
  type = "focal",
  plotdir = NULL,
  imnames = "byyear",
  zlim = NULL,
  box = FALSE,
  main = "auto",
  col.mask = "grey75",
  ncolours = 256,
  ramptype = "raw",
  imdim = c(10, 10),
  mars = c(0.5, 0.5, 2.5, 2),
  ribbon = TRUE,
  ribargs = list(),
  cex.ribbon = 0.5,
  withpts = "n",
  cex.main = 0.8,
  pch.pts = 19,
  col.pts = "grey50",
  cex.pts = 0.1,
  tidydevs = TRUE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class stKde.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focalyears</code></td>
<td>
<p>A vector of numeric values for focal years, in calBP, that will be timesteps at which date intensity maps will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A single character string stipulating which type of plot to create. Current options are "nonfocal", "mask", "focal", "proportion", "change" and "all".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotdir</code></td>
<td>
<p>Optional output directory for plots. If NULL, then only a single plot is made to the current device. If a valid output direcotry is provided then one or more timeslices maps are saved as png files (e.g. as source images for an animation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imnames</code></td>
<td>
<p>The format of the output files if output is as png files to a directory. The current two options are "basic" (labelling the images in basic sequence as preferred by animation software such as ffmpeg) or "byyear" (labelling the images by calBP year).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>Numeric vector of length=2 which controlls the maximum or minimum of the colour ramp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box</code></td>
<td>
<p>Logical. Plot a border around the map or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Single character string specifying a main title. "auto" implies internal default titles are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.mask</code></td>
<td>
<p>The colour used to depict any areas that are being masked out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolours</code></td>
<td>
<p>The maximum number of colours to use in the colour ramp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ramptype</code></td>
<td>
<p>What kind of treatment for the colour ramp. Current options are "raw" (do not try to standardise the ramps across timeslices),"std" (standardise each plot, typically by capturing the first 3sd in the main colour ramp and then outliers beyond that with the extreme colours of the ramp),"unl" (do not standardise but plot generalised high/low ramp labels) and "mmx" (scale to the minimum and maximum values across all timeslices).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imdim</code></td>
<td>
<p>Height and width of the plot to png in cm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mars</code></td>
<td>
<p>Margins of the plot to png.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ribbon</code></td>
<td>
<p>Whether to plot the colour ramp legend or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ribargs</code></td>
<td>
<p>Whether to plot the colour ramp legend or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.ribbon</code></td>
<td>
<p>The size of the ribbon font.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withpts</code></td>
<td>
<p>Plot with the original sample locations shown (current options are "y" and "n").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>The size of the title font.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.pts</code></td>
<td>
<p>The symbols used for the plotted points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pts</code></td>
<td>
<p>The colours used for the plotted points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pts</code></td>
<td>
<p>The size used for the plotted points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tidydevs</code></td>
<td>
<p>Logical for whether to clean up any open grpahics devices or not (default is TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical variable indicating whether extra information on progress should be reported. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments affecting the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots to a screen device if a single focal year is stipulated and no output directory. Or if an output directory is stipulated, it plots one or more focal years to png files, with some basic formatting options and optional cross-year standardisation of the colour ramps (with a view to them being stills-for-video). For even more control of plotting, call this function one year at a time in a loop.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Example with a subset of English and Welsh dates from the Euroevol dataset
data(ewdates)
data(ewowin)
dir.create(file.path("im"), showWarnings=FALSE)
x &lt;- calibrate(x=ewdates$C14Age, errors=ewdates$C14SD, normalised=FALSE)
bins1 &lt;- binPrep(sites=ewdates$SiteID, ages=ewdates$C14Age, h=50)
stkde1 &lt;- stkde(x=x, coords=ewdates[,c("Eastings", "Northings")], 
win=ewowin, sbw=40000, cellres=2000, focalyears=seq(6500, 5000, -100),
tbw=50, bins=bins1, backsight=200, outdir="im")

## Plot just the proportion surface for just 5900 calBP
plot(stkde1, 5900, type="proportion")

## Plot an example of all four basic outputs for just 5900 calBP
dev.new(height=2.5, width=8)
par(mar=c(0.5, 0.5, 2.5, 2))
plot(stkde1, 5900, type="all")

## Plot standardised change surfaces to a sub-directory called 
## /png for all timeslices and save to file.
dir.create(file.path("png"), showWarnings=FALSE)
plot(stkde1, seq(6500,5000,-100), type="change", ramptype="std", withpts=TRUE, plotdir="png")

## Plot all four summary surfaces in one image, saving them to a sub-directory call 'pngall',
## and with the output of the change map standardised to a common ramp 
## (but leaving the focal and proportion maps unstandardised with simple ramp labelling)
dir.create(file.path("pngall"), showWarnings=FALSE)
plot(stkde1, seq(6500,5000,-100), type="all", ramptype=c("unl","unl","std"), imdim=cm(c(2.5,8)),
withpts=TRUE, plotdir="pngall")

## End(Not run)

</code></pre>


</div>