<div class="container">

<table style="width: 100%;"><tr>
<td>pGC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Gram-Charlier approximation
</h2>

<h3>Description</h3>

<p>Gram-Charlier approximation of the CDF using the first four moments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pGC(x, moments = c(0, 1, 0, 3), raw = TRUE, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Vector of points to approximate the CDF in.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moments</code></td>
<td>

<p>The first four raw moments if <code>raw=TRUE</code>. By default the first four raw moments of the standard normal distribution are used.
When <code>raw=FALSE</code>, the mean <code class="reqn">\mu=E(X)</code>, variance <code class="reqn">\sigma^2=E((X-\mu)^2)</code>, skewness (third standardised moment, <code class="reqn">\nu=E((X-\mu)^3)/\sigma^3</code>) and kurtosis (fourth standardised moment, <code class="reqn">k=E((X-\mu)^4)/\sigma^4</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>

<p>When <code>TRUE</code> (default), the first four raw moments are provided in <code>moments</code>. Otherwise, the mean, variance, skewness and kurtosis are provided in <code>moments</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

 
<p>Denote the standard normal PDF and CDF respectively by <code class="reqn">\phi</code> and <code class="reqn">\Phi</code>.
Let <code class="reqn">\mu</code> be the first moment, <code class="reqn">\sigma^2=E((X-\mu)^2)</code> the variance, <code class="reqn">\mu_3=E((X-\mu)^3)</code> the third central moment and <code class="reqn">\mu_4=E((X-\mu)^4)</code> the fourth central moment of the random variable <code class="reqn">X</code>.
The corresponding cumulants are given by <code class="reqn">\kappa_1=\mu</code>, <code class="reqn">\kappa_2=\sigma^2</code>, <code class="reqn">\kappa_3=\mu_3</code> and <code class="reqn">\kappa_4=\mu_4-3\sigma^4</code>. 
</p>
<p>Now consider the random variable <code class="reqn">Z=(X-\mu)/\sigma</code>, which has cumulants
0, 1, <code class="reqn">\nu=\kappa_3/\sigma^3</code>  and <code class="reqn">k=\kappa_4/\sigma^4=\mu_4/\sigma^4-3</code>.
</p>
<p>The Gram-Charlier approximation for the CDF of <code class="reqn">X</code> (<code class="reqn">F(x)</code>) is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}_{GC}(x) = \Phi(z) + \phi(z) (-\nu/6 h_2(z)- k/24h_3(z))</code>
</p>

<p>with <code class="reqn">h_2(z)=z^2-1</code>, <code class="reqn">h_3(z)=z^3-3z</code> and <code class="reqn">z=(x-\mu)/\sigma</code>.
</p>
<p>See Section 6.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>Vector of estimates for the probabilities <code class="reqn">F(x)=P(X\le x)</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Cheah, P.K., Fraser, D.A.S. and Reid, N. (1993). "Some Alternatives to Edgeworth." <em>The Canadian Journal of Statistics</em>, 21(2), 131â€“138.
</p>


<h3>See Also</h3>

<p><code>pEdge</code>, <code>pClas</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Chi-squared sample
X &lt;- rchisq(1000, 2)


x &lt;- seq(0, 10, 0.01)

# Empirical moments
moments = c(mean(X), mean(X^2), mean(X^3), mean(X^4))

# Gram-Charlier approximation
p1 &lt;- pGC(x, moments)

# Edgeworth approximation
p2 &lt;- pEdge(x, moments)

# Normal approximation
p3 &lt;- pClas(x, mean(X), var(X))

# True probabilities
p &lt;- pchisq(x, 2)


# Plot true and estimated probabilities
plot(x, p, type="l", ylab="F(x)", ylim=c(0,1), col="red")
lines(x, p1, lty=2)
lines(x, p2, lty=3)
lines(x, p3, lty=4, col="blue")

legend("bottomright", c("True CDF", "GC approximation", 
                        "Edgeworth approximation", "Normal approximation"), 
       col=c("red", "black", "black", "blue"), lty=1:4, lwd=2)
</code></pre>


</div>