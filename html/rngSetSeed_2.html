<div class="container">

<table style="width: 100%;"><tr>
<td>generateInitialization</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generates a random integer vector of a specified length using AES
</h2>

<h3>Description</h3>

<p>In a typical application of the package, this function is not called
directly by the user and the function is called from <code>setVectorSeed()</code>.
The function is made available in order to simplify testing correctness
of the package and the documentation of this function explains the exact
algorithm used by <code>setVectorSeed()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  generateInitialization(vseed, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vseed</code></td>
<td>
<p> Numeric vector of an arbitrary nonzero length, whose components
have integer values from <code>[0, 2^32 - 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> Numeric, the length of the required output integer vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function transforms an input vector <code>vseed</code> of an arbitrary length
to a random integer vector of length <code>m</code> using Advanced Encryption
Standard (AES) block cipher. The function <code>setVectorSeed()</code> calls
<code>generateInitialization(vseed, 624)</code> and uses its output as an initial
state of the R base Mersenne-Twister random number generator.
</p>
<p>The vector <code>vseed</code> is first replaced by <code>c(vseed, length(vseed))</code>
in order to guarantee that if <code>vseed1</code> is a prefix of <code>vseed2</code>,
but they have a different length, then the outputs are unrelated. If the length
of the resulting vector is not divisible by 8, the vector is padded by zeros
to the nearest larger length divisible by 8 in order to meet the requirements
of the AES algorithm. The resulting vector is splitted into blocks of length 8
and these blocks are used as 256-bit keys in AES. Each of these keys is used
to encrypt a counter sequence of length <code>ceiling(m/4)</code>. The encrypted
values of these sequences are combined by XOR to a single sequence of
<code>ceiling(m/4)</code> values, each of which is a sequence of 16 bytes. These
sequences are splitted into subsequences of 4 bytes, each of which encodes
a 32-bit integer in an endianness independent way. The first <code>m</code> of the
obtained integers form the output.
</p>
<p>If <code>length(vseed) &lt;= 7</code>, then the above algorithm uses AES in counter
mode suggested in Fortuna random number generator as described at
<a href="https://en.wikipedia.org/wiki/Fortuna_(PRNG)">https://en.wikipedia.org/wiki/Fortuna_(PRNG)</a> with a key specified
by the user.
If <code>length(vseed) &gt;= 8</code>, the algorithm uses XOR of the outputs
of several Fortuna generators with keys formed from disjoint parts of
the input vector and disjoint counter sequences.
</p>


<h3>Value</h3>

<p>Vector of length <code>m</code> of integer type suitable for substituting into 
the components of <code>.Random.seed</code>. This means that the components
are integers from the interval <code>[-2^31 + 1, 2^31 - 1]</code> or <code>NA</code>,
which represents <code>-2^31</code>. If <code>m == 624</code>, the output vector is
suitable as the initial state of Mersenne-Twister to be copied into
<code>.Random.seed[3:626]</code>. 
</p>
<p>If <code>m1 &lt; m2</code>, then <code>generateInitialization(vseed, m1)</code> is equal
to the first <code>m1</code> components of <code>generateInitialization(vseed, m2)</code>.
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">https://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a>,
<a href="https://en.wikipedia.org/wiki/Fortuna_(PRNG)">https://en.wikipedia.org/wiki/Fortuna_(PRNG)</a>.
</p>


<h3>See Also</h3>

<p><code>setVectorSeed</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  s1 &lt;- generateInitialization(1, 3)
  s2 &lt;- generateInitialization(c(1, 0), 3)
  s3 &lt;- generateInitialization(c(1, 0, 0), 3)
  stopifnot(s1 == c(2054882070, -83320660, -37036705))
  stopifnot(s2 == c(-1435341980, 1760892082, 970206446))
  stopifnot(s3 == c(1941187208, 915534877, -365000103))
</code></pre>


</div>