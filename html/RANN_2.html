<div class="container">

<table style="width: 100%;"><tr>
<td>nn2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nearest Neighbour Search</h2>

<h3>Description</h3>

<p>Uses a kd-tree to find the p number of near neighbours for each point in an 
input/output dataset. The advantage of the kd-tree is that it runs in O(M log 
M) time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nn2(
  data,
  query = data,
  k = min(10, nrow(data)),
  treetype = c("kd", "bd"),
  searchtype = c("standard", "priority", "radius"),
  radius = 0,
  eps = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An <b>M</b> x <b>d</b> data.frame or matrix, where each of the 
<b>M</b> rows is a point or a (column) vector (where <b>d=1</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>query</code></td>
<td>
<p>A set of <b>N</b> x <b>d</b> points that will be queried against 
<code>data</code>. <b>d</b>, the number of columns, must be the same as 
<code>data</code>. If missing, defaults to <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The maximum number of nearest neighbours to compute. The default 
value is set to the smaller of the number of columnns in data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treetype</code></td>
<td>
<p>Character vector specifying the standard <code>'kd'</code> tree or a
<code>'bd'</code> (box-decomposition, AMNSW98) tree which may perform better for 
larger point sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchtype</code></td>
<td>
<p>See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Radius of search for searchtype='radius'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Error bound: default of 0.0 implies exact nearest neighbour search</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>RANN</code> package utilizes the Approximate Near Neighbor (ANN) C++ 
library, which can give the exact near neighbours or (as the name suggests) 
approximate near neighbours to within a specified error bound.  For more 
information on the ANN library please visit 
<a href="https://www.cs.umd.edu/~mount/ANN/">https://www.cs.umd.edu/~mount/ANN/</a>.
</p>
<p>Search types: <code>priority</code> visits cells in increasing order of distance 
from the query point, and hence, should converge more rapidly on the true 
nearest neighbour, but standard is usually faster for exact searches. 
<code>radius</code> only searches for neighbours within a specified radius of the 
point.  If there are no neighbours then nn.idx will contain 0 and nn.dists 
will contain 1.340781e+154 for that point.
</p>


<h3>Value</h3>

<p>A <code>list</code> of length 2 with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nn.idx</code></td>
<td>
<p>A <b>N</b> x <b>k</b> integer <code>matrix</code> returning the near
neighbour indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn.dists</code></td>
<td>
<p>A <b>N</b> x <b>k</b> <code>matrix</code> returning the near 
neighbour Euclidean distances.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gregory Jefferis based on earlier code by Samuel E. Kemp (knnFinder 
package)
</p>


<h3>References</h3>

<p>Bentley J. L. (1975), Multidimensional binary search trees used 
for associative search. Communication ACM, 18:309-517.
</p>
<p>Arya S. and Mount D. M. (1993), Approximate nearest neighbor searching, 
Proc. 4th Ann. ACM-SIAM Symposium on Discrete Algorithms (SODA'93), 271-280.
</p>
<p>Arya S., Mount D. M., Netanyahu N. S., Silverman R. and Wu A. Y (1998), An 
optimal algorithm for approximate nearest neighbor searching, Journal of the
ACM, 45, 891-923.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x1 &lt;- runif(100, 0, 2*pi)
x2 &lt;- runif(100, 0,3)
DATA &lt;- data.frame(x1, x2)
nearest &lt;- nn2(DATA,DATA)
</code></pre>


</div>