<div class="container">

<table style="width: 100%;"><tr>
<td>sim_t_tworegime</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Recursive simulation (root-to-tip) of two-regime models 
</h2>

<h3>Description</h3>

<p>Simulates datasets for a given phylogeny under two-regime matching competition (MC), diversity dependent linear (DDlin), diversity dependent exponential (DDexp), or early burst (EB) models of trait evolution. Simulations are carried out from the root to the tip of the tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
sim_t_tworegime(regime.map, pars, root.value, Nsegments=2500, 
                model=c("MC","DDexp","DDlin","EB"),
	            	verbose=TRUE, rnd=6)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>regime.map</code></td>
<td>

<p>a stochastic map of the two regimes stored as a simmap object output from <code>make.simmap</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>

<p>a vector containing the three parameters for the chosen model; all models require <code>sig2</code>, and additionally, the MC model requires <code>S1</code> and <code>S2</code>,
specifying the level of competition in regime 1 and 2, respectively (larger negative values correspond to higher levels of competition), the DDlin model 
requires <code>b1</code> and <code>b2</code>, the DDexp model requires <code>r1</code>, the slope parameters (negative in cases of decline in evolutionary 
rates with increasing diversity). <code>sig2</code> must be listed first.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.value</code></td>
<td>

<p>a number specifying the trait value for the ancestor
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsegments</code></td>
<td>

<p>a value specifying the total number of time segments to simulate across for the phylogeny (see Details)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>model chosen to fit trait data, <code>"MC"</code> is the matching competition model, <code>"DDlin"</code> is the diversity-dependent linear model,  <code>"DDexp"</code> is the diversity-dependent exponential model, and <code>"EB"</code> is the early burst model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>if <code>TRUE</code>, prints the identity of regimes corresponding to each parameter value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd</code></td>
<td>

<p>number of digits to round timings to (see <code>round</code> (see Details)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Adjusting <code>Nsegments</code> will impact the length of time the simulations take. 
The length of each segment (<code>max(nodeHeights(phylo))/Nsegments</code>) 
should be much smaller than the smallest branch (<code>min(phylo$edge.length)</code>).
</p>
<p>Adjusting <code>rnd</code> may help if function crashes.
</p>


<h3>Value</h3>

<p>a named vector with simulated trait values for <code class="reqn">n</code> species in the phylogeny
</p>


<h3>Author(s)</h3>

<p>J Drury <a href="mailto:jonathan.p.drury@gmail.com">jonathan.p.drury@gmail.com</a></p>


<h3>References</h3>

<p>Drury, J., Clavel, J., Manceau, M., and Morlon, H. 2016. Estimating the effect of competition on trait evolution using maximum likelihood inference. <em>Systematic Biology</em> doi 10.1093/sysbio/syw020
</p>
<p>Nuismer, S. &amp; Harmon, L. 2015. Predicting rates of interspecific interaction from phylogenetic trees. <em>Ecology Letters</em> 18:17-27.
</p>
<p>Weir, J. &amp; Mursleen, S. 2012. Diversity-dependent cladogenesis and trait evolution in the adaptive radiation of the auks (Aves: Alcidae). <em>Evolution</em> 67:403-416.
</p>


<h3>See Also</h3>

<p><code>fit_t_comp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Cetacea_clades)



# Simulate data under the matching competition model
MC_tworegime.data&lt;-sim_t_tworegime(Cetacea_clades,pars=c(sig2=0.01,S1=-0.1,S2=-0.01),
	root.value=0,Nsegments=1000,model="MC")

# Simulate data under the diversity dependent linear model
DDlin_tworegime.data&lt;-sim_t_tworegime(Cetacea_clades,pars=c(sig2=0.01,b1=-0.0001,b2=-0.000001),
	root.value=0,Nsegments=1000,model="DDlin")

# Simulate data under the diversity dependent linear model
DDexp_tworegime.data&lt;-sim_t_tworegime(Cetacea_clades,pars=c(sig2=0.01,r1=-0.01,r2=-0.02),
	root.value=0,Nsegments=1000,model="DDexp")

# Simulate data under the diversity dependent linear model
EB.data_tworegime&lt;-sim_t_tworegime(Cetacea_clades,pars=c(sig2=0.01,r1=-0.01,r2=-0.02),
	root.value=0,Nsegments=1000,model="EB")




</code></pre>


</div>