<div class="container">

<table style="width: 100%;"><tr>
<td>pfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Factor analysis for compositional data</h2>

<h3>Description</h3>

<p>Computes the principal factor analysis of the input data which are
transformed and centered first.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pfa(
  x,
  factors,
  robust = TRUE,
  data = NULL,
  covmat = NULL,
  n.obs = NA,
  subset,
  na.action,
  start = NULL,
  scores = c("none", "regression", "Bartlett"),
  rotation = "varimax",
  maxiter = 5,
  control = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(robustly) scaled input data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>number of factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>default value is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>default value is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmat</code></td>
<td>
<p>(robustly) computed covariance or correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.obs</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>if a subset is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>what to do with NA values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>which method should be used to calculate the scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>
<p>if a rotation should be made</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>default value is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments for creating a list</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main difference to usual implementations is that uniquenesses are nor
longer of diagonal form. This kind of factor analysis is designed for
centered log-ratio transformed compositional data. However, if the
covariance is not specified, the covariance is estimated from isometric
log-ratio transformed data internally, but the data used for factor analysis
are backtransformed to the clr space (see Filzmoser et al., 2009).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>loadings </code></td>
<td>
<p>A matrix of loadings, one column for each factor.
The factors are ordered in decreasing order of sums of squares of loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniqueness </code></td>
<td>
<p>uniqueness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation </code></td>
<td>
<p>correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>The results of the optimization: the value of the negativ
log-likelihood and information of the iterations used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors </code></td>
<td>
<p>the
factors </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dof </code></td>
<td>
<p>degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>“principal”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.obs </code></td>
<td>
<p>number of observations if available, or NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The
matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>STATISTIC, PVAL </code></td>
<td>
<p>The significance-test statistic and
p-value, if they can be computed</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Filzmoser, Karel Hron, Matthias Templ
</p>


<h3>References</h3>

<p>C. Reimann, P. Filzmoser, R.G. Garrett, and R. Dutter (2008):
Statistical Data Analysis Explained.  <em>Applied Environmental Statistics
with R</em>.  John Wiley and Sons, Chichester, 2008.
</p>
<p>P. Filzmoser, K. Hron, C. Reimann, R. Garrett (2009): Robust Factor Analysis
for Compositional Data.  <em>Computers and Geosciences</em>, <b>35</b> (9),
1854–1861.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(expenditures)
x &lt;- expenditures
res.rob &lt;- pfa(x, factors=1)
res.cla &lt;- pfa(x, factors=1, robust=FALSE)


## the following produce always the same result:
res1 &lt;- pfa(x, factors=1, covmat="covMcd")
res2 &lt;- pfa(x, factors=1, covmat=robustbase::covMcd(pivotCoord(x))$cov)
res3 &lt;- pfa(x, factors=1, covmat=robustbase::covMcd(pivotCoord(x)))

</code></pre>


</div>