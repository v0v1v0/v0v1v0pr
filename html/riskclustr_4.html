<div class="container">

<table style="width: 100%;"><tr>
<td>eh_test_subtype</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for etiologic heterogeneity of risk factors according to disease
subtypes in a case-control study</h2>

<h3>Description</h3>

<p><code>eh_test_subtype</code> takes the name of the variable containing
the pre-specified subtype labels, the number of subtypes, a list of risk
factors, and the name of the dataframe and returns results
related to the
question of whether each risk factor differs across levels of the disease
subtypes. Input is a dataframe that contains the risk factors of interest and
a
variable containing numeric class labels that is 0 for control subjects.
Risk factors can be either binary or continuous. For categorical risk
factors, a reference level should be selected and then indicator variables
for each remaining level of the risk factor should be created.
Categorical risk factors entered as is will be treated as ordinal.
The multinomial
logistic regression model is fit using <code>mlogit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eh_test_subtype(label, M, factors, data, digits = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>the name of the subtype variable in the data. This should be a
numeric variable with values 0 through M, where 0 indicates control subjects.
Must be supplied in quotes, e.g. <code>label = "subtype"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>is the number of subtypes. For M&gt;=2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>a list of the names of the binary or continuous risk factors.
For binary or categorical risk factors the lowest level will be used as the
reference level.
e.g. <code>factors = list("age", "sex", "race")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the name of the dataframe that contains the relevant variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of digits to round the odds ratios and associated
confidence intervals, and the estimates and associated standard errors.
Defaults to 2.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list.
</p>
<p><code>beta</code> is a matrix containing the raw estimates from the
polytomous logistic regression model fit with <code>mlogit</code>
with a row for each risk factor and a column for each disease subtype.
</p>
<p><code>beta_se</code> is a matrix containing the raw standard errors from the
polytomous logistic regression model fit with <code>mlogit</code>
with a row for each risk factor and a column for each disease subtype.
</p>
<p><code>eh_pval</code> is a vector of unformatted p-values for testing whether each
risk factor differs across the levels of the disease subtype.
</p>
<p><code>or_ci_p</code> is a dataframe with the odds ratio (95\
factor/subtype combination, as well as a column of formatted etiologic
heterogeneity p-values.
</p>
<p><code>beta_se_p</code> is a dataframe with the estimates (SE) for
each risk factor/subtype combination, as well as a column of formatted
etiologic heterogeneity p-values.
</p>
<p><code>var_covar</code> contains the variance-covariance matrix associated with
the model estimates contained in <code>beta</code>.
</p>


<h3>Author(s)</h3>

<p>Emily C Zabor <a href="mailto:zabore@mskcc.org">zabore@mskcc.org</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
eh_test_subtype(
  label = "subtype",
  M = 4,
  factors = list("x1", "x2", "x3"),
  data = subtype_data,
  digits = 2
)
</code></pre>


</div>