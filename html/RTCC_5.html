<div class="container">

<table style="width: 100%;"><tr>
<td>rtcc2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Clustering signal along an environmental gradient</h2>

<h3>Description</h3>

<p>For a given trait, this function determines whether the observed trait clustering/overdispersion
on the metacommunity is linked to an environmental gradient. For this, it sequentially remove samples
in decreasing order of the environmental variable and computes at each step the remaining
metacommunity h-index. This index is based on the percentage of samples on a metacommunity
presenting significant trait clustering/overdispersion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rtcc2(
  table1,
  table2,
  table3,
  species_abundances,
  trait_col_number,
  min_env_col,
  max_env_col,
  env_var_col,
  h_iteration,
  repetitions,
  model
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>table1</code></td>
<td>
<p>A data frame containing organisms names on the first column and its trait values on the
consecutive ones. It also has to contain two columns with the maximum and the minimum values of the tested
environmental variable where the organisms have been observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table2</code></td>
<td>
<p>A presence-absence observations table with the organisms names on the first column and the
sample names as consecutive colnames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table3</code></td>
<td>
<p>A dataframe containing sample names on the first column and environmental parameters on the
consecutive ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species_abundances</code></td>
<td>
<p>A vector containing the relative abundance of the organisms on the whole data set on
the same order as appear on Table 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait_col_number</code></td>
<td>
<p>Table 1 column number of the tested trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_env_col</code></td>
<td>
<p>Table 1 column number indicating the minimum value of the environmental variable were each
organism has been observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_env_col</code></td>
<td>
<p>Table 1 column number indicating the maximum value of the environmental variable were each
organism has been observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env_var_col</code></td>
<td>
<p>Table 2 column number indicating the tested environmental variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_iteration</code></td>
<td>
<p>Number of h-index calculations for computing a confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repetitions</code></td>
<td>
<p>Number of simulated synthetic communities distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model selection. All models build synthetic communities based on the organisms richness of the
observed communities.
</p>
<p>- Model 1: organism are selected randomly from the global pool.
- Model 2: organism are selected randomly with a probability based on its relative abundance on the global pool.
- Model 3: organism are selected randomly, but only those whose environmental range includes the value of
the simulated community are elegible.
- Model 4: organism are selected randomly, but only those whose environmental range includes the value of
the simulated community are elegible and the selection probability is based on its relative abundance on the global pool.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a dataframe with the maximum of the environmental variable on the remaining
metacommunity after the sequential removal, h-index calculation for each environmental value, and its confidence standard deviation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(group_information)
data(table_presence_absence)
data(metadata)
rtcc2(group_information, table_presence_absence, metadata, group_information$sums,
9, 12, 13, 2, 100, 100, model = 1)


</code></pre>


</div>