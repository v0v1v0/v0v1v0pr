<div class="container">

<table style="width: 100%;"><tr>
<td>mmd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix Mahalanobis distance</h2>

<h3>Description</h3>

<p>Matrix Mahalanobis distance
</p>


<h3>Usage</h3>

<pre><code class="language-R">mmd(X, mu, cov_row, cov_col, inverted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a 3d array of dimension <code class="reqn">(p,q,n)</code>, containing <code class="reqn">n</code> matrix-variate samples of <code class="reqn">p</code> rows and <code class="reqn">q</code> columns in each slice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a <code class="reqn">p \times q</code> matrix containing the means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_row</code></td>
<td>
<p>a <code class="reqn">p \times p</code> positive-definite symmetric matrix specifying the rowwise covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_col</code></td>
<td>
<p>a <code class="reqn">q \times q</code> positive-definite symmetric matrix specifying the columnwise covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverted</code></td>
<td>
<p>Logical. FALSE by default.
If TRUE <code>cov_row</code> and <code>cov_col</code> are supposed to contain the inverted rowwise and columnwise covariance matrices, respectively.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Squared Mahalanobis distance(s) of observation(s) in <code>X</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 1000; p = 2; q = 3
mu = matrix(rep(0, p*q), nrow = p, ncol = q)
cov_row = matrix(c(1,0.5,0.5,1), nrow = p, ncol = p)
cov_col = matrix(c(3,2,1,2,3,2,1,2,3), nrow = q, ncol = q)
X &lt;- rmatnorm(n = 1000, mu, cov_row, cov_col)
ind &lt;- sample(1:n, 0.3*n)
X[,,ind] &lt;- rmatnorm(n = length(ind), matrix(rep(10, p*q), nrow = p, ncol = q), cov_row, cov_col)
distances &lt;- mmd(X, mu, cov_row, cov_col)
plot(distances)
abline(h = qchisq(0.99, p*q), lty = 2, col = "red")
</code></pre>


</div>