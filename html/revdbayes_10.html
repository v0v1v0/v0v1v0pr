<div class="container">

<table style="width: 100%;"><tr>
<td>dgaps_post</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random sampling from D-gaps posterior distribution</h2>

<h3>Description</h3>

<p>Uses the <code>rust</code> package to simulate from the posterior
distribution of the extremal index <code class="reqn">\theta</code> based on the D-gaps model
for threshold interexceedance times of Holesovsky and Fusek (2020). We refer
to this as the <code class="reqn">D</code>-gaps model, because it uses a tuning parameter
<code class="reqn">D</code>, whereas the related <code class="reqn">K</code>-gaps model of Suveges and Davison
(2010) has a tuning parameter <code class="reqn">K</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgaps_post(
  data,
  thresh,
  D = 1,
  n = 1000,
  inc_cens = TRUE,
  alpha = 1,
  beta = 1,
  param = c("logit", "theta"),
  use_rcpp = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then
<code>split_by_NAs</code> is used to divide the data further into
sequences of non-missing values, stored in different columns in a matrix.
Again, the log-likelihood is constructed as a sum of contributions from
different columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A numeric scalar.  The censoring parameter <code class="reqn">D</code>, as defined in
Holesovsky and Fusek (2020). Threshold inter-exceedances times that are
not larger than <code>D</code> units are left-censored, occurring with
probability <code class="reqn">\log(1 - \theta e^{-\theta d})</code>,
where <code class="reqn">d = q D</code> and <code class="reqn">q</code> is the probability with which the
threshold <code class="reqn">u</code> is exceeded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric scalar. The size of posterior sample required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations. It is known that these times are greater
than or equal to the time observed.
If <code>data</code> has multiple columns then there will be right-censored
first and last inter-exceedance times for each column. See also the
<strong>Details</strong> section of <code>dgaps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, beta</code></td>
<td>
<p>Positive numeric scalars.  Parameters of a
beta(<code class="reqn">\alpha</code>, <code class="reqn">\beta</code>) prior for <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A character scalar.  If <code>param = "logit"</code> (the default)
then we simulate from the posterior distribution of
<code class="reqn">\phi = \log(\theta / (1-\theta))</code>
and then transform back to the
<code class="reqn">\theta</code>-scale.  If <code>param = "theta"</code> then we simulate
directly from the posterior distribution of <code class="reqn">\theta</code>, unless
the sample D-gaps are all equal to zero or all positive, when we revert
to <code>param = "logit"</code>.  This is to avoid the possibility of sampling
directly from a posterior with mode equal to 0 or 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_rcpp</code></td>
<td>
<p>A logical scalar.  If <code>TRUE</code> (the default) the
rust function <code>ru_rcpp</code> is used for
posterior simulation.  If <code>FALSE</code> the (slower) function
<code>ru</code> is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A beta(<code class="reqn">\alpha</code>, <code class="reqn">\beta</code>) prior distribution is used for
<code class="reqn">\theta</code> so that the posterior from which values are simulated is
proportional to
</p>
<p style="text-align: center;"><code class="reqn">\theta ^ {2 N_1 + \alpha - 1}
    (1 - \theta e^{-\theta d}) ^ {N_0 + \beta - 1}
    \exp\{- \theta q (I_0 T_0 + \cdots + I_N T_N)\}.</code>
</p>

<p>See <code>dgaps_stat</code> for a description of the variables
involved in the contribution of the likelihood to this expression.
</p>
<p>The <code>ru</code> function in the <code>rust</code>
package simulates from this posterior distribution using the
generalised ratio-of-uniforms distribution.  To improve the probability
of acceptance, and to ensure that the simulation will work even in
extreme cases where the posterior density of <code class="reqn">\theta</code> is unbounded as
<code class="reqn">\theta</code> approaches 0 or 1, we simulate from the posterior
distribution of
<code class="reqn">\phi = \log(\theta / (1-\theta))</code>
and then transform back to the <code class="reqn">\theta</code>-scale.
</p>


<h3>Value</h3>

<p>An object (list) of class <code>"evpost"</code>, which has the same
structure as an object of class <code>"ru"</code> returned from
<code>ru</code>.
In addition this list contains
</p>

<ul>
<li> <p><code>call</code>: The call to <code>dgaps()</code>.
</p>
</li>
<li> <p><code>model</code>: The character scalar <code>"dgaps"</code>.
</p>
</li>
<li> <p><code>thresh</code>: The argument <code>thresh</code>.
</p>
</li>
<li> <p><code>ss</code>: The sufficient statistics for the D-gaps likelihood,
as calculated by <code>dgaps_stat</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>
<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>The Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221. <a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>


<h3>See Also</h3>

<p><code>ru</code> for the form of the object returned by
<code>dgaps_post</code>.
</p>
<p><code>kgaps_post</code> for Bayesian inference about the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Newlyn sea surges

thresh &lt;- quantile(newlyn, probs = 0.90)
d_postsim &lt;- dgaps_post(newlyn, thresh)
plot(d_postsim)

### Cheeseboro wind gusts

d_postsim &lt;- dgaps_post(exdex::cheeseboro, thresh = 45, D = 3)
plot(d_postsim)
</code></pre>


</div>