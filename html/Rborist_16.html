<div class="container">

<table style="width: 100%;"><tr>
<td>rfArb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rapid Decision Tree Construction and Evaluation</h2>

<h3>Description</h3>

<p>Accelerated implementation of the Random Forest (trademarked name)
algorithm.  Tuned for multicore and GPU hardware.  Bindable with most
numerical front-end languages in addtion to R.  Invocation is
similar to that provided by <em>randomForest</em> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
 rfArb(x,
                  y,
                autoCompress = 0.25,              
                ctgCensus = "votes",
                classWeight = NULL,
                impPermute = 0,
                indexing = FALSE,
                maxLeaf = 0,
                minInfo = 0.01,
                minNode = if (is.factor(y)) 2 else 3,
                nHoldout = 0,
                nLevel = 0,
                nSamp = 0,
                nThread = 0,
                nTree = 500,
                noValidate = FALSE,
                predFixed = 0,
                predProb = 0.0,
                predWeight = NULL, 
                quantVec = NULL,
                quantiles = !is.null(quantVec),
                regMono = NULL,
                rowWeight = numeric(0),
                samplingWeight = numeric(0),
                splitQuant = NULL,
                streamline = FALSE,
                thinLeaves = streamline || (is.factor(y) &amp;&amp; !indexing),
                trapUnobserved = FALSE,
                treeBlock = 1,
                verbose = FALSE,
                withRepl = TRUE,
                ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> the design matrix expressed as a <code>PreFormat</code> object, as a
<code>data.frame</code> object with numeric and/or <code>factor</code> columns or
as a numeric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> the response (outcome) vector, either numerical or
categorical.  Row count must conform with <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoCompress</code></td>
<td>
<p>plurality above which to compress predictor values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctgCensus</code></td>
<td>
<p>report categorical validation by vote or by probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classWeight</code></td>
<td>
<p>proportional weighting of classification
categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impPermute</code></td>
<td>
<p>number of importance permutations:  0 or 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexing</code></td>
<td>
<p>whether to report final index, typically terminal, of
tree traversal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLeaf</code></td>
<td>
<p>maximum number of leaves in a tree.  Zero denotes no limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minInfo</code></td>
<td>
<p>information ratio with parent below which node does not split.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNode</code></td>
<td>
<p>minimum number of distinct row references to split a
node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nHoldout</code></td>
<td>
<p>number of observations to omit from sampling.
Augmented by missing response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nLevel</code></td>
<td>
<p>maximum number of tree levels to train, including
terminals (leaves).  Zero denotes no limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSamp</code></td>
<td>
<p>number of rows to sample, per tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nThread</code></td>
<td>
<p>suggests an OpenMP-style thread count.  Zero denotes
the default processor setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTree</code></td>
<td>
<p> the number of trees to train.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noValidate</code></td>
<td>
<p>whether to train without validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predFixed</code></td>
<td>
<p>number of trial predictors for a split (<code>mtry</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predProb</code></td>
<td>
<p>probability of selecting individual predictor as trial splitter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predWeight</code></td>
<td>
<p>relative weighting of individual predictors as trial
splitters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantVec</code></td>
<td>
<p>quantile levels to validate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>
<p>whether to report quantiles at validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regMono</code></td>
<td>
<p>signed probability constraint for monotonic
regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowWeight</code></td>
<td>
<p>row weighting for initial sampling of tree.  Deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplingWeight</code></td>
<td>
<p>row weighting for initial sampling of tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitQuant</code></td>
<td>
<p>(sub)quantile at which to place cut point for
numerical splits</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>streamline</code></td>
<td>
<p>whether to streamline sampler contents to save space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinLeaves</code></td>
<td>
<p>bypasses creation of leaf state in order to reduce
memory footprint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trapUnobserved</code></td>
<td>
<p>reports score for nonterminal upon encountering
values not observed during training, such as missing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeBlock</code></td>
<td>
<p>maximum number of trees to train during a single
level (e.g., coprocessor computing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>indicates whether to output progress of training.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withRepl</code></td>
<td>
<p>whether row sampling is by replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not currently used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object sharing classes <code>arbTrain</code>, documented with the
command <code>rfTrain</code>, and <code>rfArb</code>, a supplementary collection
consisting of the following items:
</p>

<ul>
<li> <p><code>sampler</code> an object of class <code>Sampler</code>, as described in the
documentation for the <code>presample</code> command, that summarizes the
bagging structure.
</p>
</li>
<li> <p><code>training</code> a list summarizing the training task, consisting of the following fields:
</p>

<ul>
<li> <p><code>call</code> the calling invocation.
</p>
</li>
<li> <p><code>info</code> a vector of forest-wide Gini (classification) or weighted variance (regression), by predictor.
</p>
</li>
<li> <p><code>version</code> the version of the <code>Rborist</code> package used to train.
</p>
</li>
<li> <p><code>diag</code> diagnostics accumulated over the training task.
</p>
</li>
<li> <p><code>samplerHash</code> hash value of the <code>Sampler</code> object used to train.  Recorded for consistency of subsequent commands.
</p>
</li>
</ul>
</li>
<li> <p><code>prediction</code> an object of class <code>PredictReg</code> or <code>PredictCtg</code>, as described by the documention for command <code>predict</code>.
</p>
</li>
<li> <p><code>validation</code> an object of class <code>ValidReg</code> or <code>ValidCtg</code>, as described by the documention for command<code>validate</code>, if validation is requested.
</p>
</li>
<li> <p><code>importance</code> an object of class <code>ImportanceReg</code> or<code>ImportanceCtg</code>, as described by the documention for command	<code>predict</code>, if permutation performance has been requested.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Mark Seligman at Suiji.
</p>


<h3>References</h3>

<p>Breiman, L. (2001) Random Forests, Machine Learning 45(1), 5-32.
</p>


<h3>See Also</h3>

<p><code>Rborist</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  # Regression example:
  nRow &lt;- 5000
  x &lt;- data.frame(replicate(6, rnorm(nRow)))
  y &lt;- with(x, X1^2 + sin(X2) + X3 * X4) # courtesy of S. Welling.

  # Classification example:
  data(iris)

  # Generic invocation:
  rb &lt;- rfArb(x, y)


  # Causes 300 trees to be trained:
  rb &lt;- rfArb(x, y, nTree = 300)


  # Causes rows to be sampled without replacement:
  rb &lt;- rfArb(x, y, withRepl=FALSE)


  # Causes validation census to report class probabilities:
  rb &lt;- rfArb(iris[-5], iris[5], ctgCensus="prob")


  # Applies table-weighting to classification categories:
  rb &lt;- rfArb(iris[-5], iris[5], classWeight = "balance")


  # Weights first category twice as heavily as remaining two:
  rb &lt;- rfArb(iris[-5], iris[5], classWeight = c(2.0, 1.0, 1.0))


  # Does not split nodes when doing so yields less than a 2% gain in
  # information over the parent node:
  rb &lt;- rfArb(x, y, minInfo=0.02)


  # Does not split nodes representing fewer than 10 unique samples:
  rb &lt;- rfArb(x, y, minNode=10)


  # Trains a maximum of 20 levels:
  rb &lt;- rfArb(x, y, nLevel = 20)


  # Trains, but does not perform subsequent validation:
  rb &lt;- rfArb(x, y, noValidate=TRUE)


  # Chooses 500 rows (with replacement) to root each tree.
  rb &lt;- rfArb(x, y, nSamp=500)


  # Chooses 2 predictors as splitting candidates at each node (or
  # fewer, when choices exhausted):
  rb &lt;- rfArb(x, y, predFixed = 2)  


  # Causes each predictor to be selected as a splitting candidate with
  # distribution Bernoulli(0.3):
  rb &lt;- rfArb(x, y, predProb = 0.3) 


  # Causes first three predictors to be selected as splitting candidates
  # twice as often as the other two:
  rb &lt;- rfArb(x, y, predWeight=c(2.0, 2.0, 2.0, 1.0, 1.0))


  # Causes (default) quantiles to be computed at validation:
  rb &lt;- rfArb(x, y, quantiles=TRUE)
  qPred &lt;- rb$validation$qPred


  # Causes specfied quantiles (deciles) to be computed at validation:
  rb &lt;- rfArb(x, y, quantVec = seq(0.1, 1.0, by = 0.10))
  qPred &lt;- rb$validation$qPred


  # Constrains modelled response to be increasing with respect to X1
  # and decreasing with respect to X5.
  rb &lt;- rfArb(x, y, regMono=c(1.0, 0, 0, 0, -1.0, 0))


  # Causes rows to be sampled with random weighting:
  rb &lt;- rfArb(x, y, samplingWeight=runif(nRow))


  # Suppresses creation of detailed leaf information needed for
  # quantile prediction and external tools.
  rb &lt;- rfArb(x, y, thinLeaves = TRUE)

  # Directs prediction to take a random branch on encountering
  # values not observed during training, such as NA or an
  # unrecognized category.

  predict(rb, trapUnobserved = FALSE)

  # Directs prediction to silently trap unobserved values, reporting a
  # score associated with the current nonterminal tree node.

  predict(rb, trapUnobserved = TRUE)

  # Sets splitting position for predictor 0 to far left and predictor
  # 1 to far right, others to default (median) position.

  spq &lt;- rep(0.5, ncol(x))
  spq[0] &lt;- 0.0
  spq[1] &lt;- 1.0
  rb &lt;- rfArb(x, y, splitQuant = spq)
  
## End(Not run)
</code></pre>


</div>