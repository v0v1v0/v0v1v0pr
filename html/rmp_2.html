<div class="container">

<table style="width: 100%;"><tr>
<td>npmp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
DP mixtures of Poissons
</h2>

<h3>Description</h3>

<p>Performs probability mass function estimation under nonparametric mixture of Poisson kernels. </p>


<h3>Usage</h3>

<pre><code class="language-R">npmp(y, k, nrep, nb, alpha=1, theta=alpha, sigma=0, 
mixing_hyperprior= FALSE, basemeasure_hyperprior = FALSE, mixing_type="DP", 
algo="slice",  prior="gamma", a, b, a_a=1, b_a=1, lb=NULL, ub=NULL, 
print = 1, ndisplay = nrep/4, plot.it = FALSE, pdfwrite = FALSE, ... )

dpmpoiss(y, k, nrep, nb, alpha = 1, a, b, lb = NULL, ub = NULL, print = 1,
ndisplay = nrep/4, plot.it = FALSE, pdfwrite = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Vector of count data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>Truncation level for the number of cluster in the mixture. Default is <code>length(ydis)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>

<p>Number of MCMC iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>

<p>Number of burn-in iteration in the MCMC to discard
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Value of the precision parameter of the Dirichlet process prior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Value of the strength parameter of the Two-parameters-Poisson-Dirichlet process prior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Value of the discount parameter of the Two-parameters-Poisson-Dirichlet process prior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixing_hyperprior</code></td>
<td>

<p>Logical. If TRUE <code>alpha</code> is random with gamma hyperprior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basemeasure_hyperprior</code></td>
<td>

<p>Logical. If TRUE also the parameters of the base measure are random, see details below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixing_type</code></td>
<td>

<p>Type of mixing distribution. Default is "DP" for Dirichlet process but also "2PD" for Two-parameters-Poisson-Dirichlet process is allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algo</code></td>
<td>

<p>Type of algorithm. Current choices are: slice sampler (<code>algo="slice"</code>) or polya-urn-type sampler (<code>algo="polya-urn"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>String for the base measure prior. Default is "gamma" for lambda ~ Gamma(a,b). The other choice is "normal" for exp(lambda) ~ N(a,b)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>Shape (mean) hyperparameter for the gamma (normal) base measure 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Scale (sd) hyperparameter for the gamma (normal) prior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_a</code></td>
<td>

<p>Shape hyperparameter for <code>alpha</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_a</code></td>
<td>

<p>Scale  hyperparameter for <code>alpha</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>

<p>Scalar integer. Lower bound for the argument of the pmf. Default is <code>max(0,min(ydis)-10)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>

<p>Scalar integer. Upper bound for the argument of the pmf. Default is <code>max(ydis)+10</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>Vector of integers (from 1 to 5) indicating whether to print each step of the Gibbs sampler.  Specifically, 1 for current iteration, 2 for the DP cluster allocation, 3 for the posterior parameters of the mixture components, 4 for the precision of the DP, 5 for the posterior pmf.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndisplay</code></td>
<td>

<p>Scalar integer. It gives the number of iterations to be displayed on screen (the function reports on the screen when every <code>ndisplay</code> iterations have been carried out)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>

<p>Logical, default FALSE. If TRUE a plot with empirical and estimated posterior probability mass functions is plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdfwrite</code></td>
<td>

<p>Logical, default FALSE. If TRUE a pdf file is written in the current working directory. Traceplots and other posterior quantities are drown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments (for future implemetantions).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>npmp</code> performs probability mass function estimation under nonparametric mixture of Poisson kernels, i.e.
</p>
<p style="text-align: center;"><code class="reqn">y_i \mid \lambda_i \sim  \mbox{Poi}(\lambda_i), i=1, \dots, n</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_i \mid G \sim G</code>
</p>

<p style="text-align: center;"><code class="reqn">G \sim \Pi(P_0),</code>
</p>

<p>where <code class="reqn">\Pi</code> is a nonparametric prior (Dirichlet process or Two-parameters-Poisson-Dirichlet process) with base measure <code class="reqn">P_0</code>. The function <code>dppoiss</code> is a wrapper to <code>npmp</code> with <code>mixing_type="DP"</code> for back portability with version 1.0 of the package. The main part of the code is written in C language to gain computational speed. Plots and posterior summaries are in plain R code. From version 2.0 on, the blocked Gibbs sampler has been removed in place of slice samper (Kalli et al., 2011) and polya-urn sampler. Two different base measures <code class="reqn">P_0</code> are implemented: <code>prior="gamma"</code> and <code>prior="normal"</code> for 
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_h \sim \mbox{Gamma}(a,b), \log(\lambda_h) \sim N(a,b), h=1,\dots
</code>
</p>

<p>respectively.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Name of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixing_type</code></td>
<td>
<p>Name of the mixing prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>Quantities about MCMC sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc.chains</code></td>
<td>
<p>MCMC chains of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmf</code></td>
<td>
<p>A list containing several quantities related to the probability mass function (emprical pmf, posterior mean pmf and pointwise 95% credible intervals) computed for the values from <code>lb</code> to <code>ub</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A list containing the posterior mean of the cluster specific parameters (be careful of label-switching problems)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>A list containing posterior quantities related to the clustering structure of the data</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>R code and porting by A. Canale, C code by A. Canale with minor contributions by N. Lunardon. 
</p>


<h3>References</h3>

<p>Canale, A. and Dunson, D. B. (2011), "Bayesian Kernel Mixtures for Counts", <em>Journal of American Statistical Association</em>, <b>106</b>, 1528-1539.
</p>
<p>Kalli, M., Griffin, J., and Walker, S. (2011), "Slice sampling mixture models," Statistics and Computing, <b>21</b>, 93-105.
</p>


<h3>See Also</h3>

<p>rmg
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ethylene)
y &lt;- tapply(ethylene$impl,FUN=mean,INDEX=ethylene$id)
z &lt;- tapply(ethylene$dose,FUN=mean,INDEX=ethylene$id)

# Estimate the pmf of the number of implants in the control group
y0  &lt;- y[z==0]
pmf.control = dpmpoiss(y0, k=20, nrep=11000, nb=1000, alpha=1, a=1, b=1,
lb=5, ub=24, plot.it=TRUE)

</code></pre>


</div>