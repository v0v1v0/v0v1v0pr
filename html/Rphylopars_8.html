<div class="container">

<table style="width: 100%;"><tr>
<td>phylopars.lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rphylopars regression</h2>

<h3>Description</h3>

<p>Performs phylogenetic regression.</p>


<h3>Usage</h3>

<pre><code class="language-R">phylopars.lm(formula, trait_data, tree, model = "BM", pheno_error,
phylo_correlated = TRUE, pheno_correlated = TRUE, REML = TRUE,
full_alpha = TRUE, phylocov_start, phenocov_start, model_par_start,
phylocov_fixed, phenocov_fixed, model_par_fixed, skip_optim = FALSE,
skip_EM = FALSE, EM_Fels_limit = 1000, repeat_optim_limit = 1,
EM_missing_limit = 50,repeat_optim_tol = 0.01, model_par_evals = 10,
max_delta = 10000, EM_verbose = FALSE,optim_verbose = FALSE, npd = FALSE,
nested_optim = FALSE, usezscores = TRUE, phenocov_list = list(),
ret_args = FALSE, ret_level = 1, get_cov_CIs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Model formula – e.g. Y~X1+X2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait_data</code></td>
<td>
<p>A data frame with the first column labeled "species" (with species names matching tips on the phylogeny) and one column per trait. Each row corresponds to a single observation, and multiple observations for species are allowed. Missing data should be represented with NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>An object of class <code>phylo</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model of evolution. Default is "BM". Alternative evolutionary models include "mvOU" (for the multivariate Ornstein-Uhlenbeck), or univariate tree transformations: "OU" "lambda", "kappa", "delta", "EB", "star".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno_error</code></td>
<td>
<p>If TRUE (default, unless &lt;=1 observation per species is provided), parameters are estimated assuming within-species variation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo_correlated</code></td>
<td>
<p>If TRUE (default), parameters are estimated assuming traits are correlated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno_correlated</code></td>
<td>
<p>If TRUE (default), parameters are estimated assuming within-species observations traits are correlated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>If TRUE (default), the algorithm will return REML estimates. If FALSE, maximum likelihood estimates will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full_alpha</code></td>
<td>
<p>Only applicable for the multivariate OU (model="mvOU"). If TRUE (default), a fully parametrized alpha matrix is fit. If FALSE, a diagonal alpha matrix is fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylocov_start</code></td>
<td>
<p>Optional starting value for phylogenetic trait variance-covariance matrix. Must be of dimension n_traits by n_traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenocov_start</code></td>
<td>
<p>Optional starting value for phenotypic trait variance-covariance matrix. Must be of dimension n_traits by n_traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_par_start</code></td>
<td>
<p>Optional starting parameters for the evolutionary model. For model="mvOU", must be of dimension n_traits by n_traits. Otherwise, must be a single value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylocov_fixed</code></td>
<td>
<p>Optional fixed value for phylogenetic trait variance-covariance matrix. Must be of dimension n_traits by n_traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenocov_fixed</code></td>
<td>
<p>Optional starting value for phenotypic trait variance-covariance matrix. Must be of dimension n_traits by n_traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_par_fixed</code></td>
<td>
<p>Optional fixed parameter for the evolutionary model. For model="mvOU", must be of dimension n_traits by n_traits. Otherwise, must be a single value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_optim</code></td>
<td>
<p>Whether to skip BFGS optimization (not recommended unless all parameters are fixed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_EM</code></td>
<td>
<p>Whether to skip Expectation-Maximiation prior to generating starting parameters for BFGS optimization (not recommended unless providing fixed parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM_Fels_limit</code></td>
<td>
<p>Whether to skip Expectation-Maximiation prior to generating starting parameters for BFGS optimization (not recommended unless providing fixed parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeat_optim_limit</code></td>
<td>
<p>The number of times to repeat numerical optimization (default is 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM_missing_limit</code></td>
<td>
<p>Maximum number of iterations for EM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeat_optim_tol</code></td>
<td>
<p>Maximum tolerance for repeated numerical optimization (only relevant if repeat_optim_limit&gt;1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_par_evals</code></td>
<td>
<p>Number of times to evaluate univariate tree transformation models along the range of possible parameter values. Used to generate informed starting values for alternative evolutionary models if nested_optim=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_delta</code></td>
<td>
<p>Maximum allowed difference between the log-likelihood for EM-generated starting parameters and new parameters tried under numerical optimization. Extremely large deltas are likely to be numerical artifiacts. Prevents artificial convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM_verbose</code></td>
<td>
<p>Whether to print the log-likelihood during Expectation-Maximization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_verbose</code></td>
<td>
<p>Whether to print log-likelihooods during numerical optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npd</code></td>
<td>
<p>Whether to find the nearest positive-definite matrix for all covariance matrices during numerical optimization (slow – only set to TRUE if converging to singular matrices).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nested_optim</code></td>
<td>
<p>Only relevant if fitting a univariate alternative evolutionary model. Tries multiple tree transformation parameter values along the range of possible values to make informed starting parameters. Slower than the default (nested_optim=FALSE), in which all parameters are estimated simultaneously.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usezscores</code></td>
<td>
<p>Whether or not ot use centered and standardized data during numerical optimization (recommended).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenocov_list</code></td>
<td>
<p>An optional named list of species-specific within-species covariance matrices to be held fixed, as in Ives et al (2007). This option forces pheno_error and pheno_correlated to be FALSE, and uses mean species values instead of raw data. Raw variance should be divided by the number of observations per species (i.e., squared standard errors). See Ives et al (2007) for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret_args</code></td>
<td>
<p>For internal use only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret_level</code></td>
<td>
<p>For internal use only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_cov_CIs</code></td>
<td>
<p>Whether to return 95-percent confidence intervals of covariance parameters (default=FALSE).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A fitted phylopars.lm object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # simulate data
  sim_data &lt;- simtraits(ntaxa = 15,ntraits = 4)

  phylopars.lm(V4~V1+V2+V3,trait_data=sim_data$trait_data,tree=sim_data$tree)
</code></pre>


</div>