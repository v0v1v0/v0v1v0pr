<div class="container">

<table style="width: 100%;"><tr>
<td>Laplace_sampling_MCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Laplace Sampling Markov Chain Monte Carlo (MCMC) for Generalized Linear Gaussian Process Models</h2>

<h3>Description</h3>

<p>Performs MCMC sampling using Laplace approximation for Generalized Linear Gaussian Process Models (GLGPMs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Laplace_sampling_MCMC(
  y,
  units_m,
  mu,
  Sigma,
  ID_coords,
  ID_re = NULL,
  sigma2_re = NULL,
  family,
  control_mcmc,
  Sigma_pd = NULL,
  mean_pd = NULL,
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response variable vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units_m</code></td>
<td>
<p>Units of measurement for the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Mean vector of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>Covariance matrix of the spatial process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_coords</code></td>
<td>
<p>Indices mapping response to locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_re</code></td>
<td>
<p>Indices mapping response to unstructured random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2_re</code></td>
<td>
<p>Variance of the unstructured random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Distribution family for the response variable. Must be one of 'gaussian', 'binomial', or 'poisson'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_mcmc</code></td>
<td>
<p>List with control parameters for the MCMC algorithm:
</p>

<dl>
<dt>n_sim</dt>
<dd>
<p>Number of MCMC iterations.</p>
</dd>
<dt>burnin</dt>
<dd>
<p>Number of burn-in iterations.</p>
</dd>
<dt>thin</dt>
<dd>
<p>Thinning parameter for saving samples.</p>
</dd>
<dt>h</dt>
<dd>
<p>Step size for proposal distribution. Defaults to 1.65/(n_tot^(1/6)).</p>
</dd>
<dt>c1.h, c2.h</dt>
<dd>
<p>Parameters for adaptive step size tuning.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_pd</code></td>
<td>
<p>Precision matrix (optional) for Laplace approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_pd</code></td>
<td>
<p>Mean vector (optional) for Laplace approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>Logical; if TRUE, print progress messages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements a Laplace sampling MCMC approach for GLGPMs. It maximizes the integrand using 'maxim.integrand' function for Laplace approximation if 'Sigma_pd' and 'mean_pd' are not provided.
</p>
<p>The MCMC procedure involves adaptive step size adjustment based on the acceptance probability ('acc_prob') and uses a Gaussian proposal distribution centered on the current mean ('mean_curr') with variance 'h'.
</p>


<h3>Value</h3>

<p>An object of class "mcmc.RiskMap" containing:
</p>

<dl>
<dt>samples$S</dt>
<dd>
<p>Samples of the spatial process.</p>
</dd>
<dt>samples$&lt;re_names[i]&gt;</dt>
<dd>
<p>Samples of each unstructured random effect, named according to columns of ID_re if provided.</p>
</dd>
<dt>tuning_par</dt>
<dd>
<p>Vector of step size (h) values used during MCMC iterations.</p>
</dd>
<dt>acceptance_prob</dt>
<dd>
<p>Vector of acceptance probabilities across MCMC iterations.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


</div>