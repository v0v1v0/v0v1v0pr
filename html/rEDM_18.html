<div class="container">

<table style="width: 100%;"><tr>
<td>SMap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SMap forecasting</h2>

<h3>Description</h3>

<p><code>SMap</code> performs time series forecasting based on localised
(or global) nearest neighbor projection in the time series phase space as
described in <cite>Sugihara 1994</cite>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">SMap(pathIn = "./", dataFile = "", dataFrame = NULL, 
  lib = "", pred = "", E = 0, Tp = 1, knn = 0, tau = -1, 
  theta = 0, exclusionRadius = 0, columns = "", target = "", 
  embedded = FALSE, verbose = FALSE,
  validLib = vector(), ignoreNan = TRUE,
  generateSteps = 0, parameterList = FALSE,
  showPlot = FALSE, noTime = FALSE)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lib</code></td>
<td>
<p>string or vector with start and stop indices of input data
rows used to create the library from observations. Mulitple row index
pairs can be specified with each pair defining the first and last
rows of time series observation segments used to create the library.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>string with start and stop indices of input data rows used for
predictions. A single contiguous range is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>embedding dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to the
library size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>neighbor localisation exponent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>column name used for prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validLib</code></td>
<td>
<p>logical vector the same length as the number of data
rows. Any data row represented in this vector as FALSE, will not be
included in the library.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignoreNan</code></td>
<td>
<p>logical to internally redefine library to avoid nan.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generateSteps</code></td>
<td>
<p>number of predictive feedback generative steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterList</code></td>
<td>
<p>logical to add list of invoked parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>embedded</code> is <code>FALSE</code>, the data <code>column(s)</code> are embedded
to dimension <code>E</code> with time lag <code>tau</code>. This embedding forms an
n-columns * E-dimensional phase space for the <code>SMap</code> projection.
If embedded is <code>TRUE</code>, the data are assumed to contain an
E-dimensional embedding with E equal to the number of <code>columns</code>.
See the Note below for proper use of multivariate data (number of
<code>columns</code> &gt; 1).
</p>
<p>If <code>ignoreNan</code> is <code>TRUE</code>, the library (<code>lib</code>) is
internally redefined to exclude nan embedding vectors. If
<code>ignoreNan</code> is <code>FALSE</code> no library adjustment is made. The
(<code>lib</code>) can be explicitly specified to exclude nan library vectors.
</p>
<p>Predictions are made using leave-one-out cross-validation, i.e.
observation rows are excluded from the prediction regression.
</p>
<p>In contrast to <code>Simplex</code>, <code>SMap</code> uses all
available neighbors and weights them with an exponential decay
in phase space distance with exponent <code>theta</code>. <code>theta</code>=0
uses all neighbors corresponding to a global autoregressive model.
As <code>theta</code> increases, neighbors closer in vicinity to the
observation are considered. 
</p>


<h3>Value</h3>

<p>A named list with three data.frames
<code>[[predictions, coefficients, singularValues]]</code>.
<code>predictions</code> has columns <code>Observations, Predictions</code>.
The first column contains time or index values.
</p>
<p><code>coefficients</code> data.frame has time or index values in the first column.
Columns 2 through E+2 (E+1 columns) are the SMap coefficients.
</p>
<p><code>singularValues</code> data.frame has time or index values in the first column.
Columns 2 through E+2 (E+1 columns) are the SVD singularValues. The
first value corresponds to the SVD bias (intercept) term.
</p>
<p>If <code>parameterList = TRUE</code> a named list "parameters" is added.
</p>


<h3>Note</h3>

<p><code>SMap</code> should be called with columns explicitly corresponding to
dimensions E. In the univariate case (number of <code>columns</code> = 1) with
default <code>embedded = FALSE</code>, the time series will be time-delay
embedded to dimension E, SMap coefficients correspond to each dimension. 
</p>
<p>If a multivariate data set is used (number of <code>columns</code> &gt; 1) it
must use <code>embedded = TRUE</code> with E equal to the number of columns.
This prevents the function from internally time-delay embedding the
multiple columns to dimension E.  If the internal time-delay embedding
is performed, then state-space columns will not correspond to the
intended dimensions in the matrix inversion, coefficient assignment,
and prediction. In the multivariate case, the user should first prepare
the embedding (using <code>Embed</code> for time-delay embedding), then
pass this embedding to <code>SMap</code> with appropriately specified
<code>columns</code>, <code>E</code>, and <code>embedded = TRUE</code>.
</p>


<h3>References</h3>

<p>Sugihara G. 1994. Nonlinear forecasting for the classification of natural time series. Philosophical Transactions: Physical Sciences and Engineering, 348 (1688):477-495.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(circle)
L = SMap( dataFrame = circle, lib="1 100", pred="110 190", theta = 4,
E = 2, embedded = TRUE, columns = "x y", target = "x" )
</code></pre>


</div>