<div class="container">

<table style="width: 100%;"><tr>
<td>rsaga.pisr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Potential incoming solar radiation</h2>

<h3>Description</h3>

<p>This function calculates the potential incoming solar radiation in an area using different atmospheric models; module available in SAGA GIS 2.0.6+.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsaga.pisr(
  in.dem,
  in.svf.grid = NULL,
  in.vapour.grid = NULL,
  in.latitude.grid = NULL,
  in.longitude.grid = NULL,
  out.direct.grid,
  out.diffuse.grid,
  out.total.grid = NULL,
  out.ratio.grid = NULL,
  out.duration,
  out.sunrise,
  out.sunset,
  local.svf = TRUE,
  latitude,
  unit = c("kWh/m2", "kJ/m2", "J/cm2"),
  solconst = 1367,
  enable.bending = FALSE,
  bending.radius = 6366737.96,
  bending.lat.offset = "user",
  bending.lat.ref.user = 0,
  bending.lon.offset = "center",
  bending.lon.ref.user = 0,
  method = c("height", "components", "lumped"),
  hgt.atmosphere = 12000,
  hgt.water.vapour.pressure = 10,
  cmp.pressure = 1013,
  cmp.water.content = 1.68,
  cmp.dust = 100,
  lmp.transmittance = 70,
  time.range = c(0, 24),
  time.step = 0.5,
  start.date = list(day = 21, month = 3),
  end.date = NULL,
  day.step = 5,
  env = rsaga.env(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>in.dem</code></td>
<td>
<p>name of input digital elevation model (DEM) grid in SAGA grid format (default extension: <code>.sgrd</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.svf.grid</code></td>
<td>
<p>Optional input grid in SAGA format:  Sky View Factor; see also <code>local.svf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.vapour.grid</code></td>
<td>
<p>Optional input grid in SAGA format:  Water vapour pressure (mbar); see also argument <code>hgt.water.vapour.pressure</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.latitude.grid</code></td>
<td>
<p>Optional input grid in SAGA format: Latitude (degree) of each grid cell</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.longitude.grid</code></td>
<td>
<p>see <code>in.latitude.grid</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.direct.grid</code></td>
<td>
<p>Output grid: Direct insolation (unit selected by <code>unit</code> argument)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.diffuse.grid</code></td>
<td>
<p>Output grid: Diffuse insolation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.total.grid</code></td>
<td>
<p>Optional output grid: Total insolation, i.e. sum of direct and diffuse incoming solar radiation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.ratio.grid</code></td>
<td>
<p>Optional output grid: Direct to diffuse ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.duration</code></td>
<td>
<p>Optional output grid: Duration of insolation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.sunrise</code></td>
<td>
<p>Optional output grid: time of sunrise; only calculated if time span is set to single day</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.sunset</code></td>
<td>
<p>Time of sunset; see <code>out.sunrise</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local.svf</code></td>
<td>
<p>logical (default: <code>TRUE</code>; if TRUE, use sky view factor based on local slope (after Oke, 1988), if no sky view factor grid is provided in <code>in.svf.grid</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latitude</code></td>
<td>
<p>Geographical latitude in degree North (negative values indicate southern hemisphere)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>unit of insolation output grids: <code>"kWh/m2"</code> (default) <code>"kJ/m2"</code>, or <code>"J/cm2"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solconst</code></td>
<td>
<p>solar constant, defaults to 1367 W/m2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enable.bending</code></td>
<td>
<p>logical (default: <code>FALSE</code>): incorporate effects of planetary bending?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bending.radius</code></td>
<td>
<p>Planetary radius, default <code>6366737.96</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bending.lat.offset</code></td>
<td>
<p>if bending is enabled: latitudinal reference  is <code>"user"</code>-defined (default), or relative to <code>"top"</code>, <code>"center"</code> or <code>"bottom"</code> of grid?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bending.lat.ref.user</code></td>
<td>
<p>user-defined lat. reference for bending, see <code>bending.lat.offset</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bending.lon.offset</code></td>
<td>
<p>longitudinal reference, i.e. local time,  is <code>"user"</code>-defined, or relative to <code>"top"</code>, <code>"center"</code> (default) or <code>"bottom"</code> of grid?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bending.lon.ref.user</code></td>
<td>
<p>user-defined reference for local time (Details??)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>specifies how the atmospheric components should be  accounted for: either based on the height of atmosphere and vapour pressure (<code>"height"</code>, or numeric code 0), or air pressure, water and dust content (<code>"components"</code>, code 1), or lumped atmospheric transmittance (<code>"lumped"</code>, code <code>0</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hgt.atmosphere</code></td>
<td>
<p>Height of atmosphere (in m); default 12000 m</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hgt.water.vapour.pressure</code></td>
<td>
<p>Water vapour pressure in mbar (default 10 mbar); This value is used if no vapour pressure grid is given in  argument <code>in.vapour.grid</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmp.pressure</code></td>
<td>
<p>atmospheric pressure in mbar, defaults to 1013 mbar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmp.water.content</code></td>
<td>
<p>water content of a vertical slice of the atmosphere in cm: between 1.5 and 1.7cm, average 1.68cm (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmp.dust</code></td>
<td>
<p>dust factor in ppm; defaults to 100 ppm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmp.transmittance</code></td>
<td>
<p>transmittance of the atmosphere in percent; usually between 60 (humid areas) and 80 percent (deserts)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.range</code></td>
<td>
<p>numeric vector of length 2:  time span (hours of the day) for numerical integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.step</code></td>
<td>
<p>time step in hours for numerical integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.date</code></td>
<td>
<p>list of length two, giving the start date in <code>day</code> and <code>month</code> components as numbers; these numbers are one-based (SAGA_CMD uses zero-based numbers internally), i.e. Jan. 1st is <code>list(day=1,month=1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end.date</code></td>
<td>
<p>see <code>start.date</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>day.step</code></td>
<td>
<p>if <code>days</code> indicates a range of days, this specifies the time step (number of days) for calculating the incoming solar radiation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>RSAGA geoprocessing environment obtained with <code>rsaga.env()</code>; this argument is required for version control (see Note)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to be passed to <code>rsaga.geoprocessor()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to SAGA GIS 2.0.7 documentation, "Most options should do well, but TAPES-G based diffuse irradiance calculation ("Atmospheric Effects" methods 2 and 3) needs further revision!" I.e. be careful with <code>method = "components"</code> and <code>method = "lumped"</code>.
</p>


<h3>Note</h3>

<p>This module is computationally very intensive (depending on the size of the grid and the time resolution, of course). The performance seems to have much improved in SAGA GIS 2.1.0, which by default runs this module in multicore mode (at the release candidate 1 for Windows does).
</p>
<p>SAGA_CMD uses zero-based days and months, but this R function uses the standard one-based days and months (e.g. day 1 is the first day of the month, month 1 is January) and translates to the SAGA system.
</p>
<p>This function uses module Potential Incoming Solar Radiation from SAGA library <code>ta_lighting</code> in SAGA version 2.0.6+.
</p>


<h3>Author(s)</h3>

<p>Alexander Brenning (R interface), Olaf Conrad (SAGA module)
</p>


<h3>References</h3>

<p>Boehner, J., Antonic, O. (2009): Land surface parameters specific to topo-climatology. In: Hengl, T. and Reuter, H. I. (eds.): Geomorphometry - Concepts, Software, Applications. Elsevier.
</p>
<p>Oke, T.R. (1988): Boundary layer climates. London, Taylor and Francis.
</p>
<p>Wilson, J.P., Gallant, J.C. (eds.), 2000: Terrain analysis - principles and applications. New York, John Wiley and Sons.
</p>


<h3>See Also</h3>

<p><code>rsaga.hillshade()</code>; for similar modules in older SAGA versions (pre-2.0.6) see <code>rsaga.solar.radiation()</code> and <code>rsaga.insolation()</code>
</p>


</div>