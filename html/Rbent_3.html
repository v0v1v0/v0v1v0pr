<div class="container">

<table style="width: 100%;"><tr>
<td>rbentfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>rank estimation for bent line regression</h2>

<h3>Description</h3>

<p>This function use Wilcoxon score functions for
fitting the bent line regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rbentfit(y, z, x, bet.ini, tau.ini, tol = 1e-04, max.iter = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector of covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric variable with change point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bet.ini</code></td>
<td>
<p>A initial vector of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.ini</code></td>
<td>
<p>A initial value of change point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance value, 1e-4 for default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>the maximum iteration steps</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>The estimated regression coefficients with intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bp</code></td>
<td>
<p>The estimated change point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.se</code></td>
<td>
<p>The estimated standard error of the regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bp.est</code></td>
<td>
<p>The estimated standard error of the change point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The iteration steps.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Feipeng Zhang
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 150
x &lt;- runif(n, 0, 4)
z &lt;- rnorm(n, 1, 1)
y &lt;- 1 + 0.5*z + 1.5*x  - 3 *pmax(x-2, 0)  + rt(n, 2)
rbentfit(y, cbind(1,z), x, bet.ini = c(0, 1, 1, -2), tau.ini = 1)

# for the example of  MRS data
data(data_mrs)
x &lt;- log(data_mrs$mass)
y &lt;- log(data_mrs$speed)
z &lt;- data_mrs$hopper
tau.ini &lt;- 3
dat.new &lt;- data.frame(y=y, z1=z, z2 = x, z3=pmax(x-tau.ini,0))
library(Rfit)
fit.ini &lt;- rfit(y~ z1 + z2 +z3, data= dat.new)   # with intercept
bet.ini &lt;- fit.ini$coef
fit.rank &lt;- rbentfit(y, cbind(1,z), x, bet.ini, tau.ini)
</code></pre>


</div>