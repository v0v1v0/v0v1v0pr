<div class="container">

<table style="width: 100%;"><tr>
<td>sampleSizeSignificance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes the required relative sample size to achieve significance
based on power</h2>

<h3>Description</h3>

<p>The relative sample size to achieve significance of the replication study is
computed based on the z-value of the original study, the significance level
and the power.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleSizeSignificance(
  zo,
  power = NA,
  level = 0.025,
  alternative = c("one.sided", "two.sided"),
  designPrior = c("conditional", "predictive", "EB"),
  h = 0,
  shrinkage = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zo</code></td>
<td>
<p>A vector of z-values from original studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>The power to achieve replication success.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Significance level. Default is 0.025.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Either "one.sided" (default) or "two.sided".
Specifies if the significance level is one-sided or two-sided.
If the significance level is one-sided, then sample size calculations are based on a
one-sided assessment of significance in the direction of the
original effect estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>designPrior</code></td>
<td>
<p>Is only taken into account when <code>power</code> is specified.
Either "conditional" (default), "predictive", or "EB". If "EB", the power
is computed under a predictive distribution where the contribution of the
original study is shrunken towards zero based on the evidence in the
original study (with an empirical Bayes shrinkage estimator).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Is only taken into account when <code>power</code> is specified and
<code>designPrior</code> is "predictive" or "EB". The relative between-study
heterogeneity, i.e., the ratio of the heterogeneity variance to the
variance of the original effect estimate. Default is 0 (no
heterogeneity).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>Is only taken into account when <code>power</code> is specified. A
number in [0,1) with default 0. Specifies the shrinkage of the original effect
towards zero (e.g., <code>shrinkage = 0.25</code> implies shrinkage by a
factor of 25%). Is only taken into account when <code>designPrior</code> is
"conditional" or "predictive".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sampleSizeSignificance</code> is the vectorized version of
<code>.sampleSizeSignificance_</code>. <code>Vectorize</code> is used to
vectorize the function.
</p>


<h3>Value</h3>

<p>The relative sample size to achieve significance in the specified
direction. If impossible to achieve the desired power for specified
inputs <code>NaN</code> is returned.
</p>


<h3>Author(s)</h3>

<p>Leonhard Held, Samuel Pawel, Charlotte Micheloud, Florian Gerber
</p>


<h3>References</h3>

<p>Held, L. (2020). A new standard for the analysis and design of replication
studies (with discussion). <em>Journal of the Royal Statistical Society:
Series A (Statistics in Society)</em>, <b>183</b>, 431-448.
<a href="https://doi.org/10.1111/rssa.12493">doi:10.1111/rssa.12493</a>
</p>
<p>Pawel, S., Held, L. (2020). Probabilistic forecasting of replication studies.
<em>PLoS ONE</em>. <b>15</b>, e0231416. <a href="https://doi.org/10.1371/journal.pone.0231416">doi:10.1371/journal.pone.0231416</a>
</p>
<p>Held, L., Micheloud, C., Pawel, S. (2022). The assessment of replication
success based on relative effect size. The Annals of Applied Statistics.
16:706-720. <a href="https://doi.org/10.1214/21-AOAS1502">doi:10.1214/21-AOAS1502</a>
</p>
<p>Micheloud, C., Held, L. (2022). Power Calculations for Replication Studies.
Statistical Science. 37:369-379. <a href="https://doi.org/10.1214/21-STS828">doi:10.1214/21-STS828</a>
</p>


<h3>See Also</h3>

<p><code>powerSignificance</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sampleSizeSignificance(zo = p2z(0.005), power = 0.8)
sampleSizeSignificance(zo = p2z(0.005, alternative = "two.sided"), power = 0.8)
sampleSizeSignificance(zo = p2z(0.005), power = 0.8, designPrior = "predictive")

sampleSizeSignificance(zo = 3, power = 0.8, designPrior = "predictive",
                       shrinkage = 0.5, h = 0.25)
sampleSizeSignificance(zo = 3, power = 0.8, designPrior = "EB",  h = 0.5)

# sample size to achieve  0.8 power as function of original p-value
zo &lt;- p2z(seq(0.0001, 0.05, 0.0001))
oldPar &lt;- par(mfrow = c(1,2))
plot(z2p(zo), sampleSizeSignificance(zo = zo, designPrior = "conditional", power = 0.8),
     type = "l", ylim = c(0.5, 10), log = "y", lwd = 1.5, ylab = "Relative sample size",
     xlab = expression(italic(p)[o]), las = 1)
lines(z2p(zo), sampleSizeSignificance(zo = zo, designPrior = "predictive", power = 0.8),
      lwd = 2, lty = 2)
lines(z2p(zo), sampleSizeSignificance(zo = zo, designPrior = "EB", power = 0.8),
      lwd = 1.5, lty = 3)
legend("topleft", legend = c("conditional", "predictive", "EB"),
       title = "Design prior", lty = c(1, 2, 3), lwd = 1.5, bty = "n")

par(oldPar)
</code></pre>


</div>