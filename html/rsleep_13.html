<div class="container">

<table style="width: 100%;"><tr>
<td>detect_rpeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect R peaks in a raw ECG signal.</h2>

<h3>Description</h3>

<p>'detect_rpeaks' implements the first part of the Pan &amp; Tompkins algorithms to detect R peaks from a raw ECG signal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">detect_rpeaks(
  signal,
  sRate,
  lowcut = 0,
  highcut = 15,
  filter_order = 1,
  integration_window = 15,
  refractory = 200,
  return_index = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>signal</code></td>
<td>
<p>Numerical vector of ECG signal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sRate</code></td>
<td>
<p>ECG signal sample rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowcut</code></td>
<td>
<p>Butterworth bandpass filter low cut value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highcut</code></td>
<td>
<p>Butterworth bandpass filter high cut value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_order</code></td>
<td>
<p>Butterworth bandpass filter order value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integration_window</code></td>
<td>
<p>Convolution window size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refractory</code></td>
<td>
<p>Minimal space between peaks in milliseconds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_index</code></td>
<td>
<p>If TRUE, the index for each R peak is returned instead of the timing.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector of detected R peaks, expressed in seconds* from the start of the signal. This vector can be used in RHRV using 'RHRV::LoadBeatVector()'.
</p>
<p>*(or samples if return_index is TRUE)
</p>


<h3>References</h3>

<p>Pan, Jiapu, and Willis J. Tompkins. "A real-time QRS detection algorithm." IEEE Trans. Biomed. Eng 32, no. 3 (1985): 230-236.
</p>


<h3>Examples</h3>

<pre><code class="language-R">tryCatch({
  path &lt;- paste0(tempdir(),"rec_1.dat")
  download.file("https://rsleep.org/data/rec_1.sdat",path)
  ecg &lt;- readBin(path,integer(),500*30)
  peaks &lt;- detect_rpeaks(ecg, sRate = 500)
  unlink(path)
  print(peaks)
  ecg.df &lt;- data.frame(ECG = ecg,Seconds = c(1:length(ecg))/500)
  library(ggplot2)
  ggplot(ecg.df,aes(x = Seconds,y = ECG)) +
    geom_line() + 
    theme_bw() +
    geom_vline(
      data.frame(p = peaks),
      mapping = aes(xintercept = p),
      linetype="dashed",
      color = "red")
}, error = function(e) {
  print("Error executing this example, check your internet connection.")
  })
</code></pre>


</div>