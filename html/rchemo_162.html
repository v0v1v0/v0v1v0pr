<div class="container">

<table style="width: 100%;"><tr>
<td>scordis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Score distances (SD) in a PCA or PLS score space</h2>

<h3>Description</h3>

<p><code>scordis</code> calculates the score distances (SD) for a PCA or PLS model. SD is the Mahalanobis distance of the projection of a row observation on the score plan to the center of the score space.
</p>
<p>A distance cutoff is computed using a moment estimation of the parameters of a Chi-squared distrbution for SD^2 (see e.g. Pomerantzev 2008). In the function output, column <code>dstand</code>  is a standardized distance defined as <code class="reqn">SD / cutoff</code>. A value <code>dstand &gt; 1</code> can be considered as extreme.
</p>
<p>The Winisi "GH" is also provided (usually considered as extreme if GH &gt; 3).
</p>


<h3>Usage</h3>

<pre><code class="language-R">
scordis(
    object, X = NULL, 
    nlv = NULL,
    rob = TRUE, alpha = .01
    )

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A fitted model, output of a call to a fitting function (for example from <code>pcasvd</code>, <code>plskern</code>,...).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>New X-data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlv</code></td>
<td>
<p>Number of components (PCs or LVs) to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rob</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the moment estimation of the distance cutoff is robustified. This can be recommended after robust PCA or PLS on small data sets containing extreme values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Risk-<code class="reqn">I</code> level for defining the cutoff detecting extreme values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res.train</code></td>
<td>
<p>matrix with distances, standardized distances and Winisi "GH", for the training set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>matrix with distances, standardized distances and Winisi "GH", for new X-data if any.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>cutoff value</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>M. Hubert, P. J. Rousseeuw, K. Vanden Branden (2005). ROBPCA: a new approach to robust principal components analysis. Technometrics, 47, 64-79.
</p>
<p>Pomerantsev, A.L., 2008. Acceptance areas for multivariate classification derived by projection methods. Journal of Chemometrics 22, 601-609. https://doi.org/10.1002/cem.1147
</p>


<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 6 ; p &lt;- 4
Xtrain &lt;- matrix(rnorm(n * p), ncol = p)
ytrain &lt;- rnorm(n)
Xtest &lt;- Xtrain[1:3, , drop = FALSE] 

nlv &lt;- 3
fm &lt;- pcasvd(Xtrain, nlv = nlv)
scordis(fm)
scordis(fm, nlv = 2)
scordis(fm, Xtest, nlv = 2)

</code></pre>


</div>