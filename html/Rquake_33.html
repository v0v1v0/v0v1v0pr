<div class="container">

<table style="width: 100%;"><tr>
<td>Klocate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Earthquake Hypocenter Location
</h2>

<h3>Description</h3>

<p>Earthquake Hypocenter Location
</p>


<h3>Usage</h3>

<pre><code class="language-R">Klocate(Ldat, sol = c(0, 0, 0, 0), vel=defaultVEL(6),
distwt = 20, errtol = c(0.01, 0.01, 0.01), maxit = 20,
Lambda = 1, guessdepth = 6, APLOT = FALSE,
stas = list(name = "", lat = NA, lon = NA, z = NA))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ldat</code></td>
<td>
<p>swig pick list
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sol</code></td>
<td>
<p>vector, initial solution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vel</code></td>
<td>
<p>velocity list
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distwt</code></td>
<td>
<p>distance weight parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errtol</code></td>
<td>
<p>error tolerance
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>damping parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guessdepth</code></td>
<td>
<p>initial depth for guess
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>APLOT</code></td>
<td>
<p>logical, plot intermediate solutions
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stas</code></td>
<td>
<p>station list
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Inversion is done with 
SVD.  
</p>


<h3>Value</h3>

<p>Event location in Lat-Lon-Z-T.
</p>


<h3>Note</h3>

<p>Damped least squares.
</p>


<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;
</p>


<h3>See Also</h3>

<p>swig, defaultVEL
</p>


<h3>Examples</h3>

<pre><code class="language-R">
######  could read from a list of files on disk
###  LF = list.files(path=pdir, pattern="p$", full.names=TRUE )

   data(GH, package='RSEIS')

g1 = GH$pickfile




    ##  points(g1$H$lon, g1$H$lat, pch=8, col='red')

    w1 = which(!is.na(g1$STAS$lat))
    sec = g1$STAS$sec[w1]

    N = length(sec)
    Ldat =    list(
      name = g1$STAS$name[w1],
      sec = g1$STAS$sec[w1],
      phase = g1$STAS$phase[w1],
      lat=g1$STAS$lat[w1],
      lon = g1$STAS$lon[w1],
      z = g1$STAS$z[w1],
      err= g1$STAS$err[w1],
      yr = rep(g1$LOC$yr , times=N),
      jd = rep(g1$LOC$jd, times=N),
      mo = rep(g1$LOC$mo, times=N),
      dom = rep(g1$LOC$dom, times=N),
      hr =rep( g1$LOC$hr, times=N),
      mi = rep(g1$LOC$mi, times=N) )

 ######  let the code determine the initial guess
    NEW = Klocate(Ldat  )

  


</code></pre>


</div>