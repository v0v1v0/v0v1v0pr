<div class="container">

<table style="width: 100%;"><tr>
<td>CCcorrect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dimensional Reduction by PCA or ICA</h2>

<h3>Description</h3>

<p>This functions performs dimensional reduction by PCA or ICA and removes components enriched for particular gene sets, e.g. cell cycle related genes
genes associated with technical batch effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CCcorrect(
  object,
  vset = NULL,
  CGenes = NULL,
  ccor = 0.4,
  pvalue = 0.01,
  quant = 0.01,
  nComp = NULL,
  dimR = FALSE,
  mode = "pca",
  logscale = FALSE,
  FSelect = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>SCseq</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vset</code></td>
<td>
<p>List of vectors with genes sets. The loadings of each component are tested for enrichment in any of these gene sets and if the lower <code>quant</code> or upper 1 - <code>quant</code> fraction of genes ordered by loading is enriched at a p-value &lt; <code>pvalue</code> the component is discarded. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CGenes</code></td>
<td>
<p>Vector of gene names. If this argument is given, gene sets to be tested for enrichment in PCA- or ICA-components are defined by all genes with a Pearson's correlation of <code>&gt;ccor</code> to a gene in <code>CGenes</code>. The loadings of each component are tested for enrichment in any of these gene sets and if the lower <code>quant</code> or upper 1 - <code>quant</code> fraction of genes ordered by loading is enriched at a p-value &lt; <code>pvalue</code> the component is discarded. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccor</code></td>
<td>
<p>Positive number between 0 and 1. Correlation threshold used to detrmine correlating gene sets for all genes in <code>CGenes</code>. Default is 0.4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>Positive number between 0 and 1. P-value cutoff for determining enriched components. See <code>vset</code> or <code>CGenes</code>. Default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>Positive number between 0 and 1. Upper and lower fraction of gene loadings used for determining enriched components. See <code>vset</code> or <code>CGenes</code>.
Default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nComp</code></td>
<td>
<p>Number of PCA- or ICA-components to use. Default is <code>NULL</code> and the maximal number of components is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimR</code></td>
<td>
<p>logical. If <code>TRUE</code>, then the number of principal components to use for downstream analysis is derived from a saturation criterion.
See function <code>plotdimsat</code>. Default is <code>FALSE</code> and all <code>nComp</code> components are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p><code>"pca"</code> or <code>"ica"</code> to perform either principal component analysis or independent component analysis. Default is <code>pca</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>
<p>logical. If <code>TRUE</code> data are log-transformed prior to PCA or ICA. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FSelect</code></td>
<td>
<p>logical. If <code>TRUE</code>, then PCA or ICA is performed on the filtered expression matrix using only the features stored in slot<code>cluster$features</code>
as computed in the function <code>filterdata</code>. See <code>FSelect</code> for function <code>filterdata</code>. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns an updated <code>SCseq</code> object with the principal or independent component matrix written to the slot <code>dimRed$x</code> of the <code>SCseq</code>
object. Additional information on the PCA or ICA is stored in slot <code>dimRed</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sc &lt;- SCseq(intestinalDataSmall)
sc &lt;- filterdata(sc)
sc &lt;- CCcorrect(sc,dimR=TRUE,nComp=3)
</code></pre>


</div>