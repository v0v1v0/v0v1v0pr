<div class="container">

<table style="width: 100%;"><tr>
<td>assess_pb_bias_correction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test the effects of the parametric bootstrap bias correction on a reference dataset through cross-validation</h2>

<h3>Description</h3>

<p>This is a rewrite of bias_comparison().  Eric didn't want the plotting to
be wrapped up in a function, and wanted to return a more informative data
frame.
</p>


<h3>Usage</h3>

<pre><code class="language-R">assess_pb_bias_correction(
  reference,
  gen_start_col,
  seed = 5,
  nreps = 50,
  mixsize = 100,
  alle_freq_prior = list(const_scaled = 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>a two-column format genetic dataset, with a "repunit" column
specifying each individual's reporting unit of origin, a "collection" column
specifying the collection (population or time of sampling) and "indiv" providing
a unique name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen_start_col</code></td>
<td>
<p>the first column containing genetic data in <code>reference</code>.
All columns should be genetic format following this column, and gene copies from the
same locus should be adjacent</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random seed for simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>The number of reps to do.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixsize</code></td>
<td>
<p>The size of each simulated mixture sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alle_freq_prior</code></td>
<td>
<p>a one-element named list specifying the prior to be used when
generating Dirichlet parameters for genotype likelihood calculations. Valid methods include
<code>"const"</code>, <code>"scaled_const"</code>, and <code>"empirical"</code>. See
<code>?list_diploid_params</code> for method details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Takes a reference two-column genetic dataset, pulls a series of random
"mixture" datasets with varying reporting unit proportions from this reference,
and compares the results of GSI through standard MCMC
vs. parametric-bootstrap MCMC bias correction
</p>
<p>The amount of bias in reporting unit proportion calculations increases with the
rate of misassignment between reporting units (decreases with genetic differentiation),
and increases as the number of collections within reporting units becomes more uneven.
</p>
<p>Output from the standard Bayesian MCMC method demonstrates the level of bias to be
expected for the input data set, and parametric bootstrapping is an empirical method
for the removal of any existing bias.
</p>


<h3>Value</h3>

<p><code>bias_comparison</code> returns a list; the first element is
a list of the relevant rho values generated on each iteration of the random "mixture"
creation. This includes the true rho value, the standard result <code>rho_mcmc</code>,
and the parametric bootstrapped <code>rho_pb</code>.
</p>
<p>The second element is a dataframe listing summary statistics for each
reporting unit and estimation method. <code>mse</code>, the mean squared error, summarizes
the deviation of the rho estimates from their true value, including both bias and other variance.
<code>mean_prop_bias</code> is the average ratio of residual to true value, which gives greater
weight to deviations at smaller values. <code>mean_bias</code> is simply the average residual;
unlike <code>mse</code>, this demonstrates the direction of the bias.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## This takes too long to run in R CMD CHECK
ale_bias &lt;- assess_pb_bias_correction(alewife, 17)

## End(Not run)

</code></pre>


</div>