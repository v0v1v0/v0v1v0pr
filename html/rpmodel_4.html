<div class="container">

<table style="width: 100%;"><tr>
<td>calc_soilmstress</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates an empirical soil moisture stress factor</h2>

<h3>Description</h3>

<p>Calculates an empirical soil moisture stress factor as a function of relative
soil moisture (fraction of field capacity).
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_soilmstress(soilm, meanalpha = 1, apar_soilm = 0, bpar_soilm = 0.685)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>soilm</code></td>
<td>
<p>Relative soil moisture as a fraction
of field capacity (unitless). Defaults to 1.0 (no soil moisture stress).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanalpha</code></td>
<td>
<p>Local annual mean ratio of actual over potential 
evapotranspiration, measure for average aridity. Defaults to 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apar_soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>)
Parameter determining the sensitivity of the empirical soil moisture stress
function. Defaults to 0.0, the empirically fitted value as presented in Stocker
et al. (2019) Geosci. Model Dev. for model setup 'FULL' (corresponding to a setup
with <code>method_jmaxlim="wang17", do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bpar_soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) Parameter
determining the sensitivity of the empirical soil moisture stress function. Defaults
to ~0.6, the empirically fitted value as presented in Stocker et al. (2019) Geosci. Model Dev.
for model setup 'FULL' (corresponding to a setup with <code>method_jmaxlim="wang17",
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The soil moisture stress factor is calculated using a quadratic function that
is 1 above <code>soilm</code> = 0.6 and has a sensitivity, given by the y-axis cutoff,
(zero soil moisture), determined  by average aridity (argument <code>meanalpha</code>) as:
</p>
<p style="text-align: center;"><code class="reqn">
    \beta = q(\theta - \theta*)^2 + 1
</code>
</p>

<p>for <code class="reqn">\theta &lt; \theta*</code> and <code class="reqn">\beta = 1.0</code> otherwise. <code class="reqn">\theta*</code> is fixed at 0.6.
<code class="reqn">q</code> is the sensitivity parameter and is calculated as a linear function of average aridity,
quantified by the local annual mean ratio of actual over potential evapotranspiration, termed
<code class="reqn">\alpha</code>:
</p>
<p style="text-align: center;"><code class="reqn">
     q=(\beta0-1)/(\theta*-\theta0)^2
</code>
</p>

<p><code class="reqn">\theta0</code> is 0.0, and
</p>
<p style="text-align: center;"><code class="reqn">
     \beta0 = a + b \alpha
</code>
</p>

<p><code class="reqn">a</code> is given by argument <code>apar</code>, <code class="reqn">b</code> is given by argument <code>bpar</code>.
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">\beta</code>
</p>


<h3>References</h3>

<p>Stocker, B. et al. Geoscientific Model Development Discussions (in prep.)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Relative reduction (%) in GPP due to soil moisture stress at
## relative soil water content ('soilm') of 0.2:
print((calc_soilmstress(0.2)-1)*100 )

</code></pre>


</div>