<div class="container">

<table style="width: 100%;"><tr>
<td>gof.date</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness-of-fit for the distribution of dates</h2>

<h3>Description</h3>

<p>Goodness-of-fit diagnostics for the distribution of event dates
in a (assumed) Poisson process
</p>


<h3>Usage</h3>

<pre><code class="language-R">    gof.date(date,
             start = NULL,
             end = NULL,
             plot = TRUE,
             main = NULL,
             skip = NULL,
             plot.type = "skip")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>date</code></td>
<td>

<p>Object of class <code>POSIXct</code> (or that can be coerced to this
class) giving the dates to be tested. Must be in strictly increasing
order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>The beginning of the interval, a <code>POSIXct</code> object. If
<code>NULL</code>, the first event in <code>date</code> is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>

<p>Object of class <code>POSIXct</code> the end of the interval. If
<code>NULL</code>, the last event in <code>date</code> is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Should a plot be shown?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Character giving the main title of the plot. The default <code>NULL</code>
stands for a default main describing the period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>

<p>Optional data.frame with columns <code>start</code> and <code>end</code>
indicating start and end of skipped periods. The two columns need to
be coerced to POSIXct objects. They can be POSIXct or character with
POSIX datetime format.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>

<p>Character indicating the type of plot to produce when a <code>skip</code>
data.frame is given. With <code>plot.type = "skip"</code> the plot shows
missing periods as greyed rectangles and the displays the results of
a Kolmogorov-Smirnov (KS) test performed on the events. For the
<code>"omit"</code> case the missing periods are collapsed into vertical
lines on the plot and the displayed results are for an "effective"
KS test of uniformity performed omitting the missing periods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the homogeneous Poisson process, events occur on a time interval in
a uniform fashion. More precisely, for a given time interval the
distribution of the event dates conditional to their number <code class="reqn">n</code> is the
distribution of the order statistics of a sample of size <code class="reqn">n</code> of
the uniform distribution on this interval.
</p>
<p>When the interval has limits taken at events the uniformity statement
remains true, but for <em>inner</em> events. This behaviour is met when
<code>start</code> and <code>end</code> are not given and taken as the first and
last events in <code>date</code>.
</p>


<h3>Value</h3>

<p>A list
</p>
<table>
<tr style="vertical-align: top;">
<td><code>effKS.statistic, KS.statistic</code></td>
<td>

<p>Kolmogorov-Smirnov global test statistic for uniformity (bilateral
test) omitting slipped periods or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effKS.pvalue, KS.pavalue</code></td>
<td>

<p>Critical probability in the KS test omitting skipped periods or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effnevt, nevt</code></td>
<td>

<p>Number of events omitting skipped periods or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effduration, duration</code></td>
<td>

<p>Effective duration i.e. total duration of non-skipped periods. In
years, omitting skipped periods or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effrate, rate</code></td>
<td>

<p>Occurrence rate in <b>number of events by year</b>, omitting skipped
periods or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effduration, duation</code></td>
<td>

<p>Total duration in <b>years</b>, omitting missing periods or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noskip</code></td>
<td>

<p>Data.frame object giving indications on the periods that are NOT
skipped over (hence usually non-missing periods). These are :
<code>start</code>, <code>end</code> (POSIX), <code>duration</code> (in years)
<code>rate</code> (in number of events by year) and Kolmogorov test
statistic and p-value. This data.frame is only available when a
suitable <code>skip</code> has been given.
</p>
</td>
</tr>
</table>
<p>When the number of events corresponding to the indications of args is
<code>0</code>, the function returns <code>NULL</code> with a warning. When the
number of events is less than <code>6</code> a warning is shown.
</p>


<h3>Warning</h3>

<p>When skipped periods exist the number of events, duration, rate the
global KS test must be computed by omitting the skipped periods in the
duration and retaining only valid interevents. The indication given in
<code>nevt</code> <code>rate</code> and <code>duration</code> should be used only when no
skipped period exist (<code>skip = NULL</code> on input) and replaced by
<code>effnevt</code>, <code>effrate</code> and <code>effduration</code> otherwise.
</p>


<h3>Note</h3>

<p>In practical contexts missing periods are often met in the
datasets. The diagnostic should therefore be applied on <em>every
period with no missing data</em>. Even if the event dates seem reasonably
uniform, it is a good idea to check that the rates do not differ
significantly over intervals.
</p>
<p>When some events are missing and no suitable information is given via
the <code>skip</code> argument, the global <code>rate</code>, <code>KS.statistic</code>
and <code>KS.pvalue</code> are of little interest. Yet the graph might be
instructive.
</p>


<h3>Author(s)</h3>

<p>Yves Deville
</p>


<h3>See Also</h3>

<p><code>interevt</code> function for the determination of interevents
ans subsequent diagnostics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Use "Brest" dataset
## simple plot. Kolmogorov-Smirnov is not useful
gof1 &lt;- gof.date(date = Brest$OTdata$date)

## consider missing periods. Much better!
gof2 &lt;- gof.date(date = Brest$OTdata$date,
         skip = Brest$OTmissing,
         start = Brest$OTinfo$start,
         end = Brest$OTinfo$end)

print(gof2$noskip)

## Second type of graph
gof3 &lt;- gof.date(date = Brest$OTdata$date,
         skip = Brest$OTmissing,
         start = Brest$OTinfo$start,
         end = Brest$OTinfo$end,
         plot.type = "omit")

## non-skipped periods at Brest
ns &lt;- skip2noskip(skip = Brest$OTmissing,
                 start = Brest$OTinfo$start,
                 end = Brest$OTinfo$end)

## say 9 plots/diagnostics
oldpar &lt;- par(mar = c(3, 4, 3, 2), mfcol = c(3, 3))

for (i in 1:9) {
  GOF &lt;- gof.date(date = Brest$OTdata$date,
           start = ns$start[i],
           end = ns$end[i])
}

par(oldpar)

</code></pre>


</div>