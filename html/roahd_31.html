<div class="container">

<table style="width: 100%;"><tr>
<td>depthgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Depthgram for univariate and multivariate functional data sets</h2>

<h3>Description</h3>

<p>This function computes the three 'DepthGram' representations from a p-variate
functional data set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">depthgram(
  Data,
  marginal_outliers = FALSE,
  boxplot_factor = 1.5,
  outliergram_factor = 1.5,
  ids = NULL
)

## Default S3 method:
depthgram(
  Data,
  marginal_outliers = FALSE,
  boxplot_factor = 1.5,
  outliergram_factor = 1.5,
  ids = NULL
)

## S3 method for class 'fData'
depthgram(
  Data,
  marginal_outliers = FALSE,
  boxplot_factor = 1.5,
  outliergram_factor = 1.5,
  ids = NULL
)

## S3 method for class 'mfData'
depthgram(
  Data,
  marginal_outliers = FALSE,
  boxplot_factor = 1.5,
  outliergram_factor = 1.5,
  ids = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>A <code>list</code> of length <code>L</code> (number of components)
in which each element is an <code style="white-space: pre;">⁠N x P⁠</code> matrix with <code>N</code> individuals and <code>P</code>
time points. Alternatively, it can also be an object of class
<code>fData</code> or of class <code>mfData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal_outliers</code></td>
<td>
<p>A boolean specifying whether the function should
return shape and amplitude outliers over each dimension. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxplot_factor</code></td>
<td>
<p>A numeric value specifying the inflation factor for
marginal functional boxplots. This is ignored if <code>marginal_outliers == FALSE</code>. Defaults to <code>1.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliergram_factor</code></td>
<td>
<p>A numeric value specifying the inflation factor for
marginal outliergrams. This is ignored if <code>marginal_outliers == FALSE</code>.
Defaults to <code>1.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>A character vector specifying labels for individual observations.
Defaults to <code>NULL</code>, in which case observations will remain unlabelled.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>depthgram</code> which is a list with the following
items:
</p>

<ul>
<li> <p><code>mbd.mei.d</code>: vector MBD of the MEI dimension-wise.
</p>
</li>
<li> <p><code>mei.mbd.d</code>: vector MEI of the MBD dimension-wise.
</p>
</li>
<li> <p><code>mbd.mei.t</code>: vector MBD of the MEI time-wise.
</p>
</li>
<li> <p><code>mei.mbd.t</code>: vector MEI of the MEI time-wise.
</p>
</li>
<li> <p><code>mbd.mei.t2</code>: vector MBD of the MEI time/correlation-wise.
</p>
</li>
<li> <p><code>mei.mbd.t2</code>: vector MEI of the MBD time/correlation-wise.
</p>
</li>
<li> <p><code>shp.out.det</code>: detected shape outliers by dimension.
</p>
</li>
<li> <p><code>mag.out.det</code>: detected magnitude outliers by dimension.
</p>
</li>
<li> <p><code>mbd.d</code>: matrix <code style="white-space: pre;">⁠n x p⁠</code> of MBD dimension-wise.
</p>
</li>
<li> <p><code>mei.d</code>: matrix <code style="white-space: pre;">⁠n x p⁠</code> of MEI dimension-wise.
</p>
</li>
<li> <p><code>mbd.t</code>: matrix <code style="white-space: pre;">⁠n x p⁠</code> of MBD time-wise.
</p>
</li>
<li> <p><code>mei.t</code>: matrix <code style="white-space: pre;">⁠n x p⁠</code> of MEI time-wise.
</p>
</li>
<li> <p><code>mbd.t2</code>: matrix <code style="white-space: pre;">⁠n x p⁠</code> of MBD time/correlation-wise
</p>
</li>
<li> <p><code>mei.t2</code>: matrix <code style="white-space: pre;">⁠n x p⁠</code> of MBD time/correlation-wise.
</p>
</li>
</ul>
<h3>References</h3>

<p>Aleman-Gomez, Y., Arribas-Gil, A., Desco, M. Elias-Fernandez, A., and Romo,
J. (2021). "Depthgram: Visualizing Outliers in High Dimensional Functional
Data with application to Task fMRI data exploration".
</p>


<h3>Examples</h3>

<pre><code class="language-R">N &lt;- 2e2
P &lt;- 1e3
grid &lt;- seq(0, 1, length.out = P)
Cov &lt;- exp_cov_function(grid, alpha = 0.3, beta = 0.4)

Data &lt;- list()
Data[[1]] &lt;- generate_gauss_fdata(
  N,
  centerline = sin(2 * pi * grid),
  Cov = Cov
)
Data[[2]] &lt;- generate_gauss_fdata(
  N,
  centerline = sin(2 * pi * grid),
  Cov = Cov
)
names &lt;- paste0("id_", 1:nrow(Data[[1]]))

DG1 &lt;- depthgram(Data, marginal_outliers = TRUE, ids = names)

fD &lt;- fData(grid, Data[[1]])
DG2 &lt;- depthgram(fD, marginal_outliers = TRUE, ids = names)

mfD &lt;- mfData(grid, Data)
DG3 &lt;- depthgram(mfD, marginal_outliers = TRUE, ids = names)
</code></pre>


</div>