<div class="container">

<table style="width: 100%;"><tr>
<td>marggpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assessing the Marginal Tail Fits</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>Assessment of the marginal tail fits for each margin following the marginal transformation procedure <code>margtransf</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marggpd(margdata, blocksize = 1, nboot = 250, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>margdata</code></td>
<td>
<p>An S4 object of class <code>margtransf.class</code>. See <code>margtransf</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocksize</code></td>
<td>
<p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level to compute the \((1-\alpha)\)% tolerance intervals. Default is <code>0.05</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let \(X^{GPD}_{(i)}\) denote the \(i\)-th ordered increasing statistic 
\((i = 1, \ldots, n)\) of the exceedances, i.e., \(X^{GPD}= (X-u \mid X &gt;u),\) 
\(n_{exc}\) denote the sample size of these exceedances, and \(F_{GPD}^{-1}\) denote the 
inverse of the cumulative distribution function of a generalised Pareto distribution (GPD).
Function <code>plot</code> shows QQ plots between the model and empirical GPD quantiles for both variables, i.e, for 
the first variable points \(\left(F^{-1}_{GPD}\left(\frac{i}{n_{exc}+1}\right) + u, X^{GPD}_{(i)} + u\right)\), 
along with the line \(y=x\). 
</p>
<p>Uncertainty on the empirical quantiles is obtained via a (block) bootstrap procedure and shown by the grey region on the plot.
A good fit is shown by agreement of model and empirical quantiles, i.e. points should lie close to the line \(y=x\). 
In addition, line \(y = x\) should mainly lie within the \((1-\alpha)\)% tolerance intervals.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>marggpd.class</code>. This object returns the arguments of the function and an extra slot <code>marggpd</code> which is a list containing: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A list containing the model quantiles for each variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>A list containing the empirical quantiles for each variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A list containing the lower bounds of the tolerance intervals for each variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A list containing the upper bounds of the tolerance intervals for each variable.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

margdata &lt;- margtransf(airdata)

# blocksize to account for temporal dependence
marggpd &lt;- marggpd(margdata = margdata, blocksize = 10)

plot(marggpd)

# To see the the S4 object's slots
str(marggpd)

# To access the list of lists
marggpd@marggpd

</code></pre>


</div>