<div class="container">

<table style="width: 100%;"><tr>
<td>rkt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation for regression kink with a time-varying threshold</h2>

<h3>Description</h3>

<p>This is a  function estimating regression kink with a time-varying threshold.</p>


<h3>Usage</h3>

<pre><code class="language-R">rkt(y,x,z,q,r01,r02,r11,r12,stp1,stp2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of regressor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A data matrix of control variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A vector of variable affecting threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r01</code></td>
<td>
<p>Lower bounder of parameter space for r0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r02</code></td>
<td>
<p>Upper bounder of parameter space for r0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r11</code></td>
<td>
<p>Lower bounder of parameter space for r1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r12</code></td>
<td>
<p>Upper bounder of parameter space for r1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stp1</code></td>
<td>
<p>Step used in grid search of r0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stp2</code></td>
<td>
<p>Step used in grid search of r1</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bols</code></td>
<td>
<p>The OLS estimates when a kink effect is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bt</code></td>
<td>
<p>The regression coefficients when a kink effect is included in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammahat0</code></td>
<td>
<p>The estimated threshold of the constant one in threshold parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammahat1</code></td>
<td>
<p>The estimated threshold of the slop in threshold parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>The sum of squred errors of the kink model.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
sta &lt;- proc.time()
##Simulated data
set.seed(12345)
n=200
x = rnorm(n)
q = rnorm(n)
rt = 0.2 - 0.5*q
z = rnorm(n)
x1 = cbind(neg.part(x-rt),pos.part(x-rt),z)
b0 =c(1,2,1)
y = b0[1]*x1[,1]+b0[2]*x1[,2]+b0[3]*x1[,3]+ rnorm(n)



# set grid search paramaters
r01 = 0
r02 = 2
stp1 = 0.1
r11 = -10
r12 = 5
stp2 = 0.1
# estimate the model with a state-dependent threshold
est1 &lt;- rkt(y,x,z,q,r01,r02,r11,r12,stp1,stp2)

proc.time() - sta
</code></pre>


</div>