<div class="container">

<table style="width: 100%;"><tr>
<td>rbing.O2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a 2*2 Orthogonal Random Matrix</h2>

<h3>Description</h3>

<p>Simulate a 2*2 random orthogonal matrix from the Bingham distribution using
a rejection sampler.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rbing.O2(A, B, a = NULL, E = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a symmetric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a diagonal matrix with decreasing entries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>sum of the eigenvalues of A, multiplied by the difference in
B-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>eigenvectors of A.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A random 2x2 orthogonal matrix simulated from the Bingham
distribution.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>References</h3>

<p>Hoff(2009)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## The function is currently defined as
function (A, B, a = NULL, E = NULL) 
{
    if (is.null(a)) {
        trA &lt;- A[1, 1] + A[2, 2]
        lA &lt;- 2 * sqrt(trA^2/4 - A[1, 1] * A[2, 2] + A[1, 2]^2)
        a &lt;- lA * (B[1, 1] - B[2, 2])
        E &lt;- diag(2)
        if (A[1, 2] != 0) {
            E &lt;- cbind(c(0.5 * (trA + lA) - A[2, 2], A[1, 2]), 
                c(0.5 * (trA - lA) - A[2, 2], A[1, 2]))
            E[, 1] &lt;- E[, 1]/sqrt(sum(E[, 1]^2))
            E[, 2] &lt;- E[, 2]/sqrt(sum(E[, 2]^2))
        }
    }
    b &lt;- min(1/a^2, 0.5)
    beta &lt;- 0.5 - b
    lrmx &lt;- a
    if (beta &gt; 0) {
        lrmx &lt;- lrmx + beta * (log(beta/a) - 1)
    }
    lr &lt;- -Inf
    while (lr &lt; log(runif(1))) {
        w &lt;- rbeta(1, 0.5, b)
        lr &lt;- a * w + beta * log(1 - w) - lrmx
    }
    u &lt;- c(sqrt(w), sqrt(1 - w)) * (-1)^rbinom(2, 1, 0.5)
    x1 &lt;- E %*% u
    x2 &lt;- (x1[2:1] * c(-1, 1) * (-1)^rbinom(1, 1, 0.5))
    cbind(x1, x2)
  }

</code></pre>


</div>