<div class="container">

<table style="width: 100%;"><tr>
<td>grotseis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get seismic rotation matrix</h2>

<h3>Description</h3>

<p>Set up a rotation matrix for a seismic trace.
Rotation matrix is 3D, although this rotation only
creates a rotation for conversion to radial-transverse orientation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">grotseis(ang, flip = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ang</code></td>
<td>
<p>Angle to rotate horizontal components, degrees from North</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p>Logical, TRUE=flip the vertical axis, default=FALSE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Returns a 3 by 3 matrix used for rotationg a 3-component seismic
record, usually stored as an N by 3 matrix.
</p>
<p>Only the N-E components  are rotated, although the vertical component can be flipped.
</p>
<p>It is important to note the order components are introduced in the
rotation matrix.
Here we assume East is X (to the right), and North is Y (to the top).
</p>
<p>For data that has (V,N,E) as  (1,2,3) need to switch components (1,3,2)
</p>
<p>For data with  (V,E,N) use the normal  (1,2,3)
</p>
<p>If Back-Azimuth is used, radial is directed towards the source. If azimuth is used,
radial is directed away from the source.
</p>


<h3>Value</h3>

<p>3 by 3 rotation matrix.
</p>


<h3>Note</h3>

<p>Positive radial is away from the source (direction of wave
propagation).
Positive transverse is to
the right when facing the direction of wave propagation.
</p>


<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;</p>


<h3>See Also</h3>

<p>rdistaz</p>


<h3>Examples</h3>

<pre><code class="language-R">
####  simple case:


vecs  &lt;- rbind(c(0,0,1), c(0,1,0))
rbaz &lt;- grotseis(21.76, flip=FALSE) 
bvec  &lt;- vecs %*%  rbaz

plot(c(-2,2) , c(-2,2) , asp=1, xaxs="r"  , yaxs="r" , type='n' )

  arrows(0, 0, 0+bvec[,2], 0+bvec[,3],
     col=c("red", "blue"), length=.08)
     
  arrows(0, 0, vecs[,2], vecs[,3],
     col=c("red", "blue"), length=.08, lty=2)

text(0+bvec[1,2], 0+bvec[1,3], labels='radial', pos=3)
text(0+bvec[2,2], 0+bvec[2,3], labels='transverse', pos=4)

text(0+vecs[1,2], 0+vecs[1,3], labels='North', pos=3)
text(0+vecs[2,2], 0+vecs[2,3], labels='East', pos=4)

 
####  realistic case:
STAXY&lt;-list()

STAXY$'x'&lt;-c(-2.9162198461534,-2.49599248511068,
-2.85909405321704,-1.96135073099434,
-6.50413342506259,2.64026676599765,
-3.95701139503518,-2.84082134537436,
-0.0457817300378462,-2.74214190991955)
STAXY$'y'&lt;-c(-7.83435541676815,-4.46180337254565,
-6.46036190991833,-5.01212763828746,
-2.56091416028758,
5.31173503708142,2.10545324503380,-0.87490923667824,
-0.172422188354707,-1.52055218789877)

STAXY$'lat'&lt;-c(14.685621984127,14.7159182222222,
14.6979647030651,14.710975070028,
14.7329873333333,14.8037143111518
,14.7749104943935,14.7481391460905,
14.7544511215933,14.7423394025875)

STAXY$'lon'&lt;-c(268.420918730159,268.424817925926,
268.421447725096,268.429783940243,268.387586722222,
268.472531954619,268.41123843527,268.421611351166,
268.447574716981,268.422528671994)

STAXY$'z'&lt;-c(0.92522857142857,1.48225333333333,
1.14740517241379,1.4423781512605,1.51148,
2.53268681318681,2.70014678899083,2.04094444444444,
2.90827547169811,2.31817123287671)

STAXY$'cen'&lt;-c(14.756,-91.552)

STAXY$name&lt;-c('OBS','CAR','MAR','CAS','MTB','STA','STE','MOT','SUM','DOM')
sguitoXY&lt;-list()
sguitoXY$'x'&lt;-c(-1.78551922571555)
sguitoXY$'y'&lt;-c(-1.80850340813817)
sguitoXY$'lat'&lt;-c(14.7397535236)
sguitoXY$'lon'&lt;-c(268.4314147874)
sguitoXY$'z'&lt;-c(2.501)

DAZ &lt;- rdistaz( sguitoXY$lat, sguitoXY$lon ,       STAXY$lat, STAXY$lon)

STAXY$az &lt;- DAZ$baz

####  plotting
plot(STAXY$x, STAXY$y, asp=1, xaxs="r"  , yaxs="r" )
text(STAXY$x, STAXY$y,STAXY$name, pos=3)
points(0,0, pch=3)
points(sguitoXY$x,sguitoXY$y , pch=8)
segments(sguitoXY$x, sguitoXY$y, STAXY$x, STAXY$y, col="green", lty=2)

#### be aware of the convention used: (V-N-E) or (V-E-N)
### here first vector is east, second vector is north
###       if you use the V-N-E convention
vecs  &lt;- rbind( c(0,1,0), c(0,0,1))

for( i in 1:length(STAXY$x))
  {
rbaz &lt;- grotseis(STAXY$az[i], flip=FALSE)
bvec  &lt;- vecs %*%  rbaz
##############   red is north, blue east
########         red is radial positive away or toward  source, blue is transverse
##########       blue is positive rotated to the right of red
##
arrows(STAXY$x[i],STAXY$y[i], STAXY$x[i]+bvec[,2], STAXY$y[i]+bvec[,3],
col=c("red", "blue"), length=.08)

}






</code></pre>


</div>