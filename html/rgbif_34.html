<div class="container">

<table style="width: 100%;"><tr>
<td>derived_dataset</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Register a derived dataset for citation.</h2>

<h3>Description</h3>

<p>Register a derived dataset for citation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">derived_dataset(
  citation_data = NULL,
  title = NULL,
  description = NULL,
  source_url = NULL,
  gbif_download_doi = NULL,
  user = NULL,
  pwd = NULL,
  curlopts = list()
)

derived_dataset_prep(
  citation_data = NULL,
  title = NULL,
  description = NULL,
  source_url = NULL,
  gbif_download_doi = NULL,
  user = NULL,
  pwd = NULL,
  curlopts = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>citation_data</code></td>
<td>
<p>(required) A data.frame with <strong>two columns</strong>. The first
column should be GBIF <strong>datasetkey uuids</strong> and the second column should be
<strong>occurrence counts</strong> from each of your datasets, representing the
contribution of each dataset to your final derived dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>(required) The title for your derived dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>
<p>(required) A description of the dataset. Perhaps
describing how it was created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source_url</code></td>
<td>
<p>(required) A link to where the dataset is stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gbif_download_doi</code></td>
<td>
<p>(optional) A DOI from an original GBIF download.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user</code></td>
<td>
<p>(required) Your GBIF username.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pwd</code></td>
<td>
<p>(required) Your GBIF password.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curlopts</code></td>
<td>
<p>a list of arguments to pass to curl.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list.
</p>


<h3>Usage</h3>

<p>Create a <strong>citable DOI</strong> for a dataset derived from GBIF mediated
occurrences.
</p>
<p><strong>Use-case (1)</strong> your dataset was obtained with <code>occ_search()</code> and
never returned a <strong>citable DOI</strong>, but you want to cite the data in a
research paper.
</p>
<p><strong>Use-case (2)</strong> your dataset was obtained using <code>occ_download()</code> and you
got a DOI, but the data underwent extensive filtering using
<code>CoordinateCleaner</code> or some other cleaning pipeline. In this case be sure
to fill in your original <code>gbif_download_doi</code>.
</p>
<p><strong>Use-case (3)</strong> your dataset was generated using a GBIF cloud export but
you want a DOI to cite in your research paper.
</p>
<p>Use <code>derived_dataset</code> to create a custom citable meta-data description and
most importantly a DOI link between an external archive (e.g. Zenodo) and the
datasets involved in your research or analysis.
</p>
<p>All fields (except <code>gbif_download_doi</code>) are required for the registration to
work.
</p>
<p>We recommend that you run <code>derived_dataset_prep()</code> to check registration
details before making it final with <code>derived_dataset()</code>.
</p>


<h3>Authentication</h3>

<p>Some <code>rgbif</code> functions require your <strong>GBIF credentials</strong>.
</p>
<p>For the <code>user</code> and <code>pwd</code> parameters, you can set them in one of
three ways:
</p>

<ol>
<li>
<p> Set them in your <code>.Renviron</code>/<code>.bash_profile</code> (or similar) file with the
names <code>GBIF_USER</code>, <code>GBIF_PWD</code>, and <code>GBIF_EMAIL</code>
</p>
</li>
<li>
<p> Set them in your <code>.Rprofile</code> file with the names <code>gbif_user</code> and
<code>gbif_pwd</code>.
</p>
</li>
<li>
<p> Simply pass strings to each of the parameters in the function
call.
</p>
</li>
</ol>
<p>We strongly recommend the <strong>first option</strong> - storing your details as
environment variables - as it's the most widely used way to store secrets.
</p>
<p>You can edit your <code>.Renviron</code> with <code>usethis::edit_r_environ()</code>.
</p>
<p>After editing, your <code>.Renviron</code> file should look something like this...
</p>
<p>GBIF_USER="jwaller"<br>
GBIF_PWD="fakepassword123"<br>
GBIF_EMAIL="jwaller@gbif.org"<br></p>
<p>See <code>?Startup</code> for help.
</p>


<h3>References</h3>

<p><a href="https://data-blog.gbif.org/post/derived-datasets/">https://data-blog.gbif.org/post/derived-datasets/</a>
<a href="https://www.gbif.org/derived-dataset/about">https://www.gbif.org/derived-dataset/about</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data &lt;- data.frame(
 datasetKey = c(
 "3ea36590-9b79-46a8-9300-c9ef0bfed7b8",
 "630eb55d-5169-4473-99d6-a93396aeae38",
 "806bf7d4-f762-11e1-a439-00145eb45e9a"),
 count = c(3, 1, 2781)
 )

## If output looks ok, run derived_dataset to register the dataset
 derived_dataset_prep(
 citation_data = data,
 title = "Test for derived dataset",
 description = "This data was filtered using a fake protocol",
 source_url = "https://zenodo.org/record/4246090#.YPGS2OgzZPY"
 )

#  derived_dataset(
#  citation_data = data,
#  title = "Test for derived dataset",
#  description = "This data was filtered using a fake protocol",
#  source_url = "https://zenodo.org/record/4246090#.YPGS2OgzZPY"
#  )

## Example with occ_search and dplyr
# library(dplyr)

# citation_data &lt;- occ_search(taxonKey=212, limit=20)$data %&gt;%
#   group_by(datasetKey) %&gt;% 
#   count()

# # You would still need to upload your data to Zenodo or something similar 
# derived_dataset_prep(
#   citation_data = citation_data,
#   title="Bird data downloaded for test",
#   description="This data was downloaded using rgbif::occ_search and was 
#   later uploaded to Zenodo.",
#   source_url="https://zenodo.org/record/4246090#.YPGS2OgzZPY",
#   gbif_download_doi = NULL,
# )

## End(Not run)

</code></pre>


</div>