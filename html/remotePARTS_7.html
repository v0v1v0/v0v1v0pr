<div class="container">

<table style="width: 100%;"><tr>
<td>covar_taper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tapered-spherical distance-based covariance function</h2>

<h3>Description</h3>

<p>Tapered-spherical distance-based covariance function
</p>
<p>Exponential distance-based covariance function
</p>
<p>Exponential-power distance-based covariance function
</p>


<h3>Usage</h3>

<pre><code class="language-R">covar_taper(d, theta, cor = NULL)

covar_exp(d, range)

covar_exppow(d, range, shape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a numeric vector or matrix of distances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>distance beyond which covariances are forced to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>optional correlation parameter. If included, the covariance is
subtracted from <code>cor</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>range parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>shape parameter</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>covar_taper</code> calculates covariance v as follows:
</p>
<p>if <code>d &lt;= theta</code>, then <code>v = ((1 - (d/theta))^2) * (1 + (d/(2 * theta)))</code>
</p>
<p>if <code>d &gt; theta</code>, then <code>v = 0</code>
</p>
<p><code>covar_exp</code> calculates covariance v as follows:
</p>
<p><code>v = exp(-d/range)</code>
</p>
<p><code>covar_exppow</code> calculates covariance v as follows:
</p>
<p><code>v = exp(-(d/range)^2)</code>
</p>
<p>Note that <code>covar_exppow(..., shape = 1)</code> is equivalent to
<code>covar_exp()</code> but is needed as a separate function for use with <code>fitCor</code>.
</p>


<h3>Value</h3>

<p>a tapered-spherical transformation of d is returned.
</p>
<p>the exponential covariance (v)
</p>
<p>exponential-power covariance (v)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# simulate dummy data
map.width = 5 # square map width
coords = expand.grid(x = 1:map.width, y = 1:map.width) # coordinate matrix

# calculate distance
D = geosphere::distm(coords) # distance matrix

# visualize covariance matrix
image(covar_taper(D, theta = .5*max(D)))

# plot tapered covariance function
curve(covar_taper(x, theta = .5), from = 0, to = 1);abline(v = 0.5, lty = 2, col = "grey80")


# visualize covariance matrix
image(covar_exp(D, range = .2*max(D)))

# plot exponential function with different ranges
curve(covar_exp(x, range = .2), from = 0, to = 1)
curve(covar_exp(x, range = .1), from = 0, to = 1, col = "blue", add = TRUE)
legend("topright", legend = c("range = 0.2", "range = 0.1"), col = c("black", "blue"), lty = 1)


# visualize Exponential covariance matrix
image(covar_exppow(D, range = .2*max(D), shape = 1))

# visualize Exponential-power covariance matrix
image(covar_exppow(D, range = .2*max(D), shape = .5))

# plot exponential power function with different shapes
curve(covar_exppow(x, range = .2, shape = 1), from = 0, to = 1)
curve(covar_exppow(x, range = .2, shape = .5), from = 0, to = 1, col = "blue", add = TRUE)
legend("topright", legend = c("shape = 1.0", "shape = 0.5"), col = c("black", "blue"), lty = 1)

</code></pre>


</div>