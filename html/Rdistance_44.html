<div class="container">

<table style="width: 100%;"><tr>
<td>smu.like</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smoothed likelihood function for distance analyses</h2>

<h3>Description</h3>

<p>Computes the likelihood of 
sighting distances given 
a kernel smooth of the histogram.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smu.like(
  a,
  dist,
  covars = NULL,
  w.lo = 0,
  w.hi,
  scale = TRUE,
  series = NULL,
  expansions = 0,
  pointSurvey = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A data frame containing the smooth.  This data frame 
must contain at least an <code>$x</code> and <code>$y</code> components. 
These components are generally the output 
of function <code>density</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A numeric vector containing the observed distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>Not used in smoothed distance functions.
Included for compatibility with other distance likelihoods
in <code>Rdistance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.lo</code></td>
<td>
<p>Scalar value of the lowest observable distance.
This is the <em>left truncation</em> of sighting distances 
in <code>dist</code>. Same units as <code>dist</code>. Values less than 
<code>w.lo</code> are allowed in <code>dist</code>, but are ignored and 
their contribution to the likelihood is set to <code>NA</code> in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.hi</code></td>
<td>
<p>Scalar value of the largest observable distance.
This is the <em>right truncation</em> of sighting distances 
in <code>dist</code>.  Same units as <code>dist</code>. Values greater 
than <code>w.hi</code> are allowed in <code>dist</code>, but are ignored 
and their contribution to the likelihood is set to <code>NA</code> 
in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical scalar indicating whether or not to 
scale the likelihood so it integrates to 1. This parameter is 
used to stop recursion in other functions. If <code>scale</code> 
equals TRUE, a numerical integration routine 
(<code>integration.constant</code>) is called, which in turn 
calls this likelihood function again with <code>scale</code> = FALSE. 
Thus, this routine knows when its values are being used to compute 
the likelihood and when its value is being used to compute the 
constant of integration.  All user defined likelihoods must have 
and use this parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>Not used in smoothed distance functions.
Included for compatibility with other distance likelihoods
in <code>Rdistance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expansions</code></td>
<td>
<p>Not used in smoothed distance functions.
Included for compatibility with other distance likelihoods
in <code>Rdistance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointSurvey</code></td>
<td>
<p>Boolean. TRUE if distances in <code>dist</code> are 
radial from point 
transects, FALSE if distances are perpendicular off-transect distances.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>approx</code> function is used to evaluate 
the smooth function at all sighting distances.  
</p>
<p>Distances outside the range <code>w.lo</code> to <code>w.hi</code> are 
set to <code>NA</code> and hence not included.
</p>


<h3>Value</h3>

<p>A numeric vector the same length and order 
as <code>dist</code> containing the 
likelihood contribution (height of the smoothed function) for 
all distances in <code>dist</code>. 
Assuming <code>L</code> is the vector returned by this function, 
the negative log likelihood of the sighting distances 
is <code>-sum(log(L), na.rm=T)</code>. 
Note that the returned likelihood value for distances less 
than <code>w.lo</code> or greater than <code>w.hi</code> is <code>NA</code>, 
hence <code>na.rm=TRUE</code> in the sum. 
If <code>scale</code> = TRUE, the area under the smoothed curve 
between <code>w.lo</code> and <code>w.hi</code> is 1.0. If <code>scale</code> = FALSE, 
the integral of the smoothed curve is something else.
</p>


<h3>See Also</h3>

<p><code>dfuncSmu</code>,
<code>hazrate.like</code>,
<code>uniform.like</code>,
<code>negexp.like</code>,
<code>halfnorm.like</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
set.seed(238642)
d &lt;- units::set_units(abs(rnorm(100)), "in")
dfunc &lt;- dfuncSmu(d~1)

L &lt;- smu.like(a=dfunc$parameters, 
       dist=dfunc$detections$dist, 
       w.lo=dfunc$w.lo, 
       w.hi=dfunc$w.hi, 
       scale=TRUE)
-sum(log(L), na.rm=TRUE)  # the negative log likelihood

</code></pre>


</div>