<div class="container">

<table style="width: 100%;"><tr>
<td>felmdir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the functional envelope linear model</h2>

<h3>Description</h3>

<p>Fit the response and predictor envelope model in function-on-function linear regression with dimensions ux and uy, using the direct estimation. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">felmdir(X, Y, ux, uy, t1, t2, knots = c(0, 0.25, 0.5, 0.75, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Predictor function. An n by T1 matrix, T1 is number of observed time points, which is the length of t1.  Here we assume that each function is observed at the same time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response function. An n by T2 matrix, T2 is number of observed time points, which is the length of t2.  Here we assume that each function is observed at the same time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ux</code></td>
<td>
<p>Dimension of the predictor envelope. An integer between 0 and number of knots +2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uy</code></td>
<td>
<p>Dimension of the response envelope. An integer between 0 and number of knots +2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>The observed time points for the predictor functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>
<p>The observed time points for the response functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>The location of knots of the cubic splines used for estimation.  Locations should be positive. The default location of the knots are 0, 0.25, 0.5, 0.75, 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits the envelope model to the function-on-function linear regression, </p>
<p style="text-align: center;"><code class="reqn">
 Y = \alpha + B X + \epsilon</code>
</p>
<p>, 
where X and Y are random functions in Hilbert spaces <code class="reqn">H_X</code> and <code class="reqn">H_Y</code>, <code class="reqn">\alpha</code> is a fixed member in <code class="reqn">H_Y</code>, <code class="reqn">\epsilon</code> is a random member of <code class="reqn">H_Y</code>, and B: <code class="reqn">H_X -&gt; H_Y</code> is a linear operator.  We use cubic splines as the basis for both <code class="reqn">H_X</code> and <code class="reqn">H_Y</code>. The coefficients <code class="reqn">[X]</code> and <code class="reqn">[Y]</code> with respect to the basis are computed.  The predictor and response envelope model is fitted on the linear regression model of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>. In this method, we do not need to estimate the eigenfunctions of <code class="reqn">Sigma_X</code> and <code class="reqn">Sigma_\epsilon</code>.  Based on the estimation result, the fitted value of <code class="reqn">Y</code> is calculated.  The standard function-on-function regression model also works through the linear regression model of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>. But instead of fitting an envelope model, it fits a standard linear regression model, based on which the fitted value of <code class="reqn">[Y]</code> is calculated.  The details are elaborated in Section 5, direct estimation, in the reference of Su et al. (2022). 
</p>


<h3>Value</h3>

<p>The output is a list that contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The envelope estimator of the regression coefficients in the regression of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betafull</code></td>
<td>
<p>The standard estimator, i.e., the OLS estimator of the regression coefficients in the regression of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The envelope estimator of the intercept in the regression of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphafull</code></td>
<td>
<p>The standard estimator of the intercept in the regression of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.env</code></td>
<td>
<p>The fitted value of Y computed from the functional envelope linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.full</code></td>
<td>
<p>The fitted value of Y computed from the standard function-to-function linear model.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Su, Z., Li, B. and Cook, R. D. (2022+) Envelope model for function-on-function linear regression.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(NJdata)
dataX &lt;- matrix(NJdata[,6], nrow = 21)
X &lt;- as.matrix(dataX[, 32:61])
dataY &lt;- matrix(NJdata[,3], nrow = 21)
Y &lt;- as.matrix(dataY[, 32:61])
t1 &lt;- 0:29
t2 &lt;- t1

m &lt;- felmdir(X, Y, 3, 1, t1, t2)
head(m$fitted.env)
head(m$fitted.full)
</code></pre>


</div>