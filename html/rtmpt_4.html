<div class="container">

<table style="width: 100%;"><tr>
<td>fit_drtmpt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Diffusion-RT-MPT Models</h2>

<h3>Description</h3>

<p>Given model and data, this function a Hamiltonian MCMC sampler and stores the samples in an mcmc.list called <code>samples</code>.
Posterior predictive checks developed by Klauer (2010), deviance information criterion (DIC; Spiegelhalter et al., 2002),
99% and 95% highest density intervals (HDI) together with the median will be provided for the main parameters in a list
called <code>diags</code>. Optionally, the <code>indices</code> widely applicable information criterion (WAIC; Watanabe, 2010; Vehtari et al., 2017) and
leave-one-out cross-validation (LOO; Vehtari et al., 2017) can be saved. Additionally the log-likelihood (<code>LogLik</code>) can also be stored.
Some specifications of the function call are also saved in <code>specs</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_drtmpt(
  model,
  data,
  n.chains = 4,
  n.iter = 1000,
  n.phase1 = 1000,
  n.phase2 = 2000,
  n.thin = 1,
  Rhat_max = 1.1,
  Irep = 1000,
  prior_params = NULL,
  flags = NULL,
  control = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A list of the class <code>drtmpt_model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optimally, a list of class <code>drtmpt_data</code>. Also possible is a <code>data.frame</code> or a
path to the text file. Both, <code>data.frame</code> and the text file must contain the column names "subj",
"group", "tree", "cat", and "rt" preferably but not necessarily in this order. The values of the latter must
be in milliseconds. It is always advised to use <code>to_drtmpt_data</code> first, which gives back a
<code>drtmpt_data</code> list with information about the changes in the data, that were needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.chains</code></td>
<td>
<p>Number of chains to use. Default is 4. Must be larger than 1 and smaller or equal to 16.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Number of samples per chain. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.phase1</code></td>
<td>
<p>Number of samples for phase 1 (adaptation phase). Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.phase2</code></td>
<td>
<p>Number of samples for phase 2. Default is 2000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>Thinning factor. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rhat_max</code></td>
<td>
<p>Maximal Potential scale reduction factor: A lower threshold that needs to be reached before the actual sampling starts. Default is 1.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Irep</code></td>
<td>
<p>Every <code>Irep</code> samples an interim state with the current maximal potential scale reduction
factor is shown. Default is 1000. The following statements must hold true for <code>Irep</code>:
</p>

<ul>
<li> <p><code>n.phase1</code> is a multiple of <code>Irep</code>
</p>
</li>
<li> <p><code>n.phase2</code> is a multiple of <code>Irep</code>
</p>
</li>
<li> <p><code>n.phase1</code> is smaller than or equal to <code>n.phase2</code>,
</p>
</li>
<li> <p><code>Irep</code> is a multiple of <code>n.thin</code> and
</p>
</li>
<li> <p><code>n.iter</code> is a multiple of <code>Irep / n.thin</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_params</code></td>
<td>
<p>Named list with prior parameters. All parameters have default values, that lead to uninformative priors. Vectors are not allowed.
Allowed parameters are:
</p>

<ul>
<li> <p><code>prec_epsilon</code>: prior precision for population means of process-related parameters.
Default is <code>1.0</code>.
</p>
</li>
<li> <p><code>delta_df</code>: degrees of freedom of t-distribution for motor times. Default is <code>10</code>.
</p>
</li>
<li> <p><code>delta_mu</code>: mean of t-distribution for motor times. Default is <code>0.5</code>.
</p>
</li>
<li> <p><code>delta_scale</code>: scale of t-distribution for motor times. Default is <code>1.0</code>.
</p>
</li>
<li> <p><code>SIGMA_Corr_eta</code>: shape parameter for LKJ distribution for process-related parameters. Default is <code>4.0</code>.
</p>
</li>
<li> <p><code>SIGMA_SD_rho</code>: scale parameter of half-Cauchy distribution for process-related parameters. Default is <code>2.5</code>.
</p>
</li>
<li> <p><code>GAMMA_Corr_eta</code>: shape parameter for LKJ distribution for motor-related parameters. Default is <code>4.0</code>.
</p>
</li>
<li> <p><code>GAMMA_SD_rho</code>: scale parameter of half-Cauchy distribution for motor-related parameters. Default is <code>0.5</code>.
</p>
</li>
<li> <p><code>Omega2_alpha</code>: shape parameter of gamma distribution for residual variance. Default is <code>0.0025</code>.
</p>
</li>
<li> <p><code>Omega2_beta</code>: rate parameter of gamma distribution for residual variance. Default is <code>0.5</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flags</code></td>
<td>
<p>Either NULL or a list of
</p>

<ul>
<li> <p><code>old_label</code> If set to <code>TRUE</code> the old labels of "subj" and "group" of the data will be used in the elements of the output list.
Default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>indices</code> Model selection indices. If set to <code>TRUE</code> the log-likelihood for each iteration and trial will be
stored temporarily and with that the WAIC and LOO will be calculated via the <code>loo</code> package. If you want to have this
log-likelihood matrix stored in the output of this function, you can set <code>loglik</code> to <code>TRUE</code>. Default for
<code>indices</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>loglik</code> If set to <code>TRUE</code> and <code>indices = TRUE</code> the log-likelihood matrix for each iteration and trial will
be saved in the output as a matrix. Default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>random_init</code> If set to <code>TRUE</code> the initial values are randomly drawn. If <code>FLASE</code> maximum likelihood is used
for initial values.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Either NULL or a list of
</p>

<ul>
<li> <p><code>maxthreads</code> for the ML estimation of the initial values and the calculation of the DIC values one can use more than
<code>n.chains</code> threads for parallelization. Default is 4 like <code>n.chians</code>. <code>maxthreads</code> must be larger or equal to
<code>n.chains</code>.
</p>
</li>
<li> <p><code>maxtreedepth1_3</code> maxtree-depth of the no-U-turn algorithm in Phases 1 to 3
</p>
</li>
<li> <p><code>maxtreedepth4</code> maxtree-depth of the no-U-turn algorithm in Phases 4
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of the class <code>drtmpt_fit</code> containing
</p>

<ul>
<li> <p><code>samples</code>: the posterior samples as an <code>mcmc.list</code> object,
</p>
</li>
<li> <p><code>diags</code>: some diagnostics like deviance information criterion, posterior predictive checks for the frequencies and latencies,
potential scale reduction factors, and also the 99% and 95% HDIs and medians for the group-level parameters,
</p>
</li>
<li> <p><code>specs</code>: some model specifications like the model, arguments of the model call, and information about the data transformation,
</p>
</li>
<li> <p><code>indices</code> (optional): if enabled, WAIC and LOO,
</p>
</li>
<li> <p><code>LogLik</code> (optional): if enabled, the log-likelihood matrix used for WAIC and LOO.
</p>
</li>
<li> <p><code>summary</code> includes posterior mean and median of the main parameters.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Raphael Hartmann
</p>


<h3>References</h3>

<p>Klauer, K. C. (2010). Hierarchical multinomial processing tree models: A latent-trait approach. <em>Psychometrika, 75(1)</em>, 70-98.
</p>
<p>Spiegelhalter, D. J., Best, N. G., Carlin, B. P., &amp; Van Der Linde, A. (2002). Bayesian measures of model complexity and fit.
<em>Journal of the royal statistical society: Series b (statistical methodology), 64(4)</em>, 583-639.
</p>
<p>Vehtari, A., Gelman, A., &amp; Gabry, J. (2017). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC.
<em>Statistics and Computing, 27(5)</em>, 1413-1432.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory.
<em>Journal of Machine Learning Research, 11(Dec)</em>, 3571-3594.
</p>


<h3>Examples</h3>

<pre><code class="language-R">####################################################################################
# Detect-Guess variant of the Two-High Threshold model.
# The encoding and motor execution times are assumed to be equal for each response.
####################################################################################

mdl_2HTM &lt;- "
# targets
do+(1-do)*g
(1-do)*(1-g)

# lures
(1-dn)*g
dn+(1-dn)*(1-g)

# do: detect old; dn: detect new; g: guess
"

model &lt;- to_drtmpt_model(mdl_file = mdl_2HTM)

data_file &lt;- system.file("extdata/data.txt", package="rtmpt")
data &lt;- read.table(file = data_file, header = TRUE)
data_list &lt;- to_drtmpt_data(raw_data = data, model = model)

# This might take some time
drtmpt_out &lt;- fit_drtmpt(model = model, data = data_list, Rhat_max = 1.1)
drtmpt_out

</code></pre>


</div>