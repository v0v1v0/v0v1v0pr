<div class="container">

<table style="width: 100%;"><tr>
<td>ibdTriangle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>IBD triangle plot</h2>

<h3>Description</h3>

<p>A relationship triangle used to used to visualize the kappa coefficients of
between non-inbred individuals. Various annotations are available, including
points marking the most common relationships, contour lines for the kinship
coefficients, and shading of the unattainable region. The companion function
<code>showInTriangle()</code> (which plots user-specified points onto the triangle) is
probably the most useful for end users.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ibdTriangle(
  relationships = c("UN", "PO", "MZ", "S", "H,U,G", "FC"),
  plotType = c("base", "ggplot2", "plotly"),
  pch = 19,
  cexPoint = 1.2,
  cexText = 1.2,
  cexAxis = cexText,
  kinshipLines = numeric(),
  shortLines = FALSE,
  shading = "gray90",
  xlim = c(0, 1),
  ylim = c(0, 1),
  axes = FALSE,
  las = 1,
  xlab = expression(kappa[0]),
  ylab = expression(kappa[2]),
  title = NULL,
  mar = c(2.1, 2.1, 1, 1),
  xpd = TRUE,
  keep.par = TRUE,
  cexLab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>relationships</code></td>
<td>
<p>A character vector indicating the <em>fixed</em> relationships
points to be included in the plot. Valid entries are those in the <code>label</code>
column of basicRelationships.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>
<p>Either "base" (default), "ggplot2" or "plotly". Abbreviations
are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Symbol used for the relationship points (see <code>par()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexPoint</code></td>
<td>
<p>A number controlling the symbol size for the relationship
points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexText</code></td>
<td>
<p>A number controlling the font size for the relationship
labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexAxis</code></td>
<td>
<p>A number controlling the font size for the axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinshipLines</code></td>
<td>
<p>A numeric vector (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shortLines</code></td>
<td>
<p>A logical indicating if the kinship lines (if present)
should be restricted to the interior of the triangle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shading</code></td>
<td>
<p>The shading colour for the unattainable region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim, xpd, las</code></td>
<td>
<p>Graphical parameters; see <code>par()</code>. (Base plot only.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>A logical: Draw surrounding axis box? Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Main title (absent by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>Graphical parameter; see <code>par()</code>. For ggplot2, this is ignored
unless it is a ggplot2::margin() object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.par</code></td>
<td>
<p>A logical. If TRUE, the graphical parameters are not reset
after plotting, which may be useful for adding additional annotation. (Base
plot only.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexLab</code></td>
<td>
<p>Deprecated; use <code>cexAxis</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments; currently not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For any pair of non-inbred individuals A and B, their genetic relationship
can be summarized by the IBD coefficients <code class="reqn">(\kappa_0, \kappa_1,
\kappa_2)</code>, where <code class="reqn">\kappa_i</code> = P(A and B
share i alleles IBD at random autosomal locus). Since <code class="reqn">\kappa_0 +
\kappa_1 + \kappa_2 = 1</code>, any relationship
corresponds to a point in the triangle in the <code class="reqn">(\kappa_0,
\kappa_2)</code>-plane defined by <code class="reqn">\kappa_0 \ge 0, \kappa_2
\ge 0, \kappa_0 + \kappa_2 \le 1</code>. The choice of <code class="reqn">\kappa_0</code> and
<code class="reqn">\kappa_2</code> as the axis variables is done for reasons of symmetry
and is not significant (other authors have used different views of the
triangle).
</p>
<p>As shown by Thompson (1976), points in the subset of the triangle defined by
<code class="reqn">4\kappa_0\kappa_2 &gt; \kappa_1^2</code> are
unattainable for pairwise relationships. By default this region in shaded in
a light grey colour, but this can be modified with the <code>shading</code> argument.
</p>
<p>The IBD coefficients are linearly related to the kinship coefficient
<code class="reqn">\varphi</code> by the formula <code class="reqn">\varphi = 0.25\kappa_1 + 0.5\kappa_2.</code> By indicating values for <code class="reqn">\varphi</code> in the
<code>kinshipLines</code> argument, the corresponding contour lines are shown in the
triangle plot. (Currently only when <code>plotType = "base"</code>.)
</p>


<h3>Value</h3>

<p><code>NULL</code> if <code>plotType = 'base'</code>; otherwise the plot object.
</p>


<h3>References</h3>


<ul>
<li>
<p> E. A. Thompson (1975). <em>The estimation of pairwise relationships.</em> Annals
of Human Genetics 39.
</p>
</li>
<li>
<p> E. A. Thompson (1976). <em>A restriction on the space of genetic
relationships.</em> Annals of Human Genetics 40.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>showInTriangle()</code>, <code>kappaIBD()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">opar = par(no.readonly = TRUE) # store graphical parameters

ibdTriangle()
ibdTriangle(kinshipLines = c(0.25, 0.125), shading = NULL, cexText = 0.7)
ibdTriangle(kinshipLines = c(0.25, 0.125), shortLines = TRUE, pch = 15)
ibdTriangle(relationships = c("UN", "PO", "MZ", "S"),
            xlab = "k0", ylab = "k2", las = 0, axes = TRUE, cexAxis =1.6)

par(opar) # reset graphical parameters

</code></pre>


</div>