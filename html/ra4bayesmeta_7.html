<div class="container">

<table style="width: 100%;"><tr>
<td>fit_models_RA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Model fitting for reference analysis using 2 benchmarks:
Posterior inference for benchmark and actual heterogeneity priors

</h2>

<h3>Description</h3>

<p>Computes the posterior distribution of the
parameters in a random-effects meta-analysis (expressed
as a normal-normal hierarchical model) for
two benchmark heterogeneity priors and
the actual heterogeneity prior(s) specified.
Applies the function <code>bayesmeta</code> from the package bayesmeta.



</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_models_RA(df, tau.prior = list(), scale.hn0 = 1/500,
              mu.mean = 0, mu.sd = 4, interval.type = "central")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>data frame with one column "y" containing the (transformed) effect estimates for the individual studies and
one column "sigma" containing the standard errors of these estimates.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.hn0</code></td>
<td>

<p>scale parameter of the half-normal benchmark prior (usually small, so that the benchmark is anti-conservative).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval.type</code></td>
<td>

<p>the type of (credible, prediction, shrinkage) interval to be returned by default.
Either "central" for equal-tailed intervals or "shortest" for shortest intervals. Defaults to "central". See also the corresponding argument in the <code>bayesmeta</code> function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The two heterogeneity benchmark priors used are
introduced in Ott et al. (2021, Section 3.4),
where they are denoted by
HN0 and J.
Note that "J" refers to Jeffreys reference prior,
which is improper, but leads to a proper posterior if
there are at least two studies in the meta-analysis data set.
HN0 is a half-normal prior with scale parameter <code>scale.hn0</code>.
</p>
<p>Decreasing the scale parameter <code>scale.hn0</code> of the half-normal benchmarks
leads to a more anti-conservative (i.e. its mass is more concentrated near 0) HN0 benchmark prior.
However, <code>scale.hn0</code> cannot be chosen arbitrarily small
since too small values lead to numerical problems in the <code>bayesmeta</code> function
used to fit the models.
To verify how anti-conservative the HN0 benchmark is,
one can compare the marginal posterior for the overall mean parameter mu
with the corresponding posterior for the fixed effects model,
e.g. by using the function <code>plot_RA</code>.
The better the match between these two marginal posteriors,
the more anti-conservative the HN0 benchmark is.
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.

</p>


<h3>Value</h3>

<p>A list containing the model fits, namely
a list of lists of class <code>bayesmeta</code>.
This list has length <code class="reqn">2</code> + length(<code>tau.prior</code>)
and contains one element for each heterogeneity prior considered
(2 benchmark priors and the actual priors specified),
in the following order:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit.hn0 </code></td>
<td>
<p> for the half-normal HN0 benchmark prior with scale parameter <code>scale.hn0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.j </code></td>
<td>
<p> for Jeffreys (improper) reference prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.actual_1 </code></td>
<td>
<p> for the first prior in the list <code>tau.prior</code> (if specified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.actual_2 </code></td>
<td>
<p> for the second prior in the list <code>tau.prior</code> (if specified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> ...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.actual_n </code></td>
<td>
<p> for the nth prior in the list <code>tau.prior</code> (if specified)</p>
</td>
</tr>
</table>
<p>See <code>bayesmeta</code> in the package bayesmeta
for information on the structure of the lists of class <code>bayesmeta</code>.
</p>


<h3>Warning </h3>

<p>If <code>fit_models_RA</code> ends with an error or warning,
we recommend to increase the value of the parameter <code>scale.hn0</code>
for the anti-conservative benchmark prior.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505â€“4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code>bayesmeta</code> in the package bayesmeta,
<code>plot_RA</code>,
<code>fit_models_RA_5bm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># for aurigular acupuncture (AA) data set
data(aa)  
# one actual half-normal and the "DuMouchel" heterogeneity prior
# it takes a few seconds to run this function
fit_models_RA(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=0.5),
                                    "DuMouchel"))
                                    
</code></pre>


</div>