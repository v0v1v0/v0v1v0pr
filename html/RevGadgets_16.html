<div class="container">

<table style="width: 100%;"><tr>
<td>plotMassExtinctions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Mass Extinction Support</h2>

<h3>Description</h3>

<p>Plots the support (as 2ln Bayes factors) for mass extinctions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotMassExtinctions(
  mass_extinction_trace,
  mass_extinction_times,
  mass_extinction_name,
  prior_prob,
  return_2lnBF = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mass_extinction_trace</code></td>
<td>
<p>(list; no default) The processed Rev output of
the mass extinction probabilities (output of readTrace()).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass_extinction_times</code></td>
<td>
<p>(numeric; no default) Vector of the fixed grid
of times at which mass extinctions were allowed to occur.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass_extinction_name</code></td>
<td>
<p>(character; no default) The name of the mass
extinction probability parameter (e.g. "mass_extinction_probabilities")
for which support is to be calculated/plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_prob</code></td>
<td>
<p>(numeric; no default) The per-interval prior probability
of a mass extinction (one minus the p parameter in RevBayes'
dnReversibleJumpMixture()).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_2lnBF</code></td>
<td>
<p>(logical; TRUE) Should the 2ln(BF) be returned (if TRUE)
or simply the BF (if FALSE)?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Works only for analyses with a fixed grid where mass extinctions may occur.
</p>
<p>The return object can be manipulated. For example, you can change the axis
labels, the color palette, whether the axes are to be linked, or the overall
plotting style/theme, just as with any ggplot object.
</p>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>References</h3>

<p>Kass and Raftery (1995) Bayes Factors.
<em>JASA</em>, <b>90 (430)</b>, 773-795.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# download the example dataset to working directory
url &lt;-
  "https://revbayes.github.io/tutorials/intro/data/crocs_mass_extinction_probabilities.log"
dest_path &lt;- "crocs_mass_extinction_probabilities.log"
download.file(url, dest_path)

# to run on your own data, change this to the path to your data file
mass_extinction_probability_file &lt;- dest_path

mass_extinction_probabilities &lt;-
              readTrace(mass_extinction_probability_file,burnin = 0.25)

# prior probability of mass extinction at any time
prior_n_expected &lt;- 0.1
n_intervals &lt;- 100
prior_prob &lt;- prior_n_expected/(n_intervals-1)

# times when mass extinctions were allowed
tree_age &lt;- 243.5
interval_times &lt;- tree_age * seq(1/n_intervals,(n_intervals-1) /
                                                   n_intervals,1/n_intervals)

# then plot results:
p &lt;- plotMassExtinctions(mass_extinction_trace=mass_extinction_probabilities,
                         mass_extinction_times=interval_times,
                         mass_extinction_name="mass_extinction_probabilities"
                         ,prior_prob);p

# remove file
# WARNING: only run for example dataset!
# otherwise you might delete your data!
file.remove(dest_path)


</code></pre>


</div>