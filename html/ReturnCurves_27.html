<div class="container">

<table style="width: 100%;"><tr>
<td>rc_gof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness of fit of the Return Curve estimates</h2>

<h3>Description</h3>

<p>Assessment of the goodness-of-fit of the return curve estimates following the approach of Murphy-Barltrop et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rc_gof(retcurve, blocksize = 1, nboot = 250, nangles = 150, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>retcurve</code></td>
<td>
<p>An S4 object of class <code>rc_est.class</code>. See <code>rc_est</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocksize</code></td>
<td>
<p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nangles</code></td>
<td>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Number of angles \(m\) in the interval \((0, \pi/2)\) (Murphy-Barltrop et al. 2023). Default is <code>150</code> angles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level to compute the \((1-\alpha)\)% confidence intervals. Default is <code>0.05</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a return curve RC(\(p\)), the probability of lying in a survival region is \(p\). 
Let \[\boldsymbol{\Theta}:= \left\lbrace \frac{\pi(m+1-j)}{2(m+1)} \mid 1\leq j\leq m\right\rbrace\] be a set of angles decreasing from near \(\pi/2\) to \(0\).
For each angle \(\theta_j\in \boldsymbol{\Theta,}\) and corresponding point in the estimated return curve \(\lbrace (\hat{x}_{\theta_j}, \hat{y}_{\theta_j}) \rbrace\), 
the empirical probability \(\hat{p}_j\) of lying in the survival region is given by the proportion of points in the region
\((\hat{x}_{\theta_j}, \infty) \times (\hat{y}_{\theta_j}, \infty)\).
</p>
<p>Thus, for each angle \(\theta_j\in \boldsymbol{\Theta,}\) a (block) bootstrap procedure to the original data set is applied, and
the empirical probabilities \(\hat{p}_j\) estimated. Then, the median and \((1-\alpha)\)% pointwise confidence intervals are obtained for each \(\theta_j\).
Function <code>plot</code> shows the median of \(\hat{p}_j\), the confidence intervals and the true probability \(p\); ideally, this value should be contained in the confidence region.
</p>
<p>We note that due to the use of empirical probabilities, the value of \(p\) should be within the range of the data and not too extreme.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>rc_gof.class</code>. This object returns the arguments of the function and an extra slot <code>gof</code> which is a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p>A vector containing the median of the empirical probability of lying in a survival region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A vector containing the lower bound of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A vector containing the upper bound of the confidence interval.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2023).
“New estimation methods for extremal bivariate return curves.”
<em>Environmetrics</em>, <b>34</b>(5).
ISSN 1099095X, doi: <a href="https://doi.org/10.1002/env.2797">10.1002/env.2797</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

prob &lt;- 10/n

margdata &lt;- margtransf(airdata)

rc_orig &lt;- rc_est(margdata = margdata, p = prob, method = "hill")

# blocksize to account for temporal dependence
gof &lt;- rc_gof(retcurve = rc_orig, blocksize = 10)

plot(gof)

# To see the the S4 object's slots
str(gof)

# To access the list of vectors
gof@gof

</code></pre>


</div>