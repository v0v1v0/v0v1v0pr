<div class="container">

<table style="width: 100%;"><tr>
<td>trParetoQQ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Truncated Pareto quantile plot
</h2>

<h3>Description</h3>

<p>Extension of the Pareto QQ-plot as described in Beirlant et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">trParetoQQ(data, r = 1, DT, kstar = NULL, plot = TRUE, main = "TPa QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>Trimming parameter, default is <code>1</code> (no trimming).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DT</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the truncation odds <code class="reqn">D_T</code> obtained from <code>trDT</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kstar</code></td>
<td>

<p>Value for <code class="reqn">k</code> used to construct the plot. When <code>NULL</code> (default), a value will be chosen by maximising the
correlation between the empirical and theoretical quantiles (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a Pareto QQ-plot, default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Title for the plot, default is <code>"TPa QQ-plot"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code>plot</code> for more details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Pareto QQ-plot for truncated data plots 
</p>
<p style="text-align: center;"><code class="reqn"> (-\log(\hat{D}_{T,r,k^*,n}+j/(n+1)), \log(X_{n-j+1,n}) )</code>
</p>

<p>for <code class="reqn">j=1,\ldots,n</code>.
</p>
<p>The value for <code class="reqn">k^*</code> can be be given by the user or can be determined automatically.
In the latter case, we use the <code class="reqn">k^*</code> that maximises the absolute value of the correlation between <code class="reqn">-\log(\hat{D}_{T,r,k^*,n}+j/(n+1))</code> and <code class="reqn">\log(X_{n-j+1,n})</code> for <code class="reqn">j=1,\ldots,k</code> and <code class="reqn">k^*&gt;10</code>.
</p>
<p>When taking <code class="reqn">D_T=0</code>, one obtains the ordinary Pareto QQ-plot.
</p>
<p>Note that the definition here differs slightly from the one in Beirlant et al. (2016).
We plot the empirical and theoretical quantiles the other way around and therefore have to add a minus (before the log).
</p>
<p>See Beirlant et al. (2016) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pqq.the</code></td>
<td>
<p>Vector of theoretical quantiles <code class="reqn">-\log(\hat{D}_{T,r,k^*,n}+j/(n+1))</code>, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kstar</code></td>
<td>
<p>Optimal value for <code class="reqn">k</code> or input argument <code>kstar</code>, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DTstar</code></td>
<td>
<p>Estimate of <code class="reqn">D_T</code> corresponding to <code>kstar</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). "Tail fitting for Truncated and Non-truncated Pareto-type Distributions." <em>Extremes</em>, 19, 429â€“462.
</p>


<h3>See Also</h3>

<p><code>ParetoQQ</code>, <code>trDT</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Endpoint of truncated Pareto distribution
endpoint &lt;- qpareto(0.99, shape=2)

# Generate sample from truncated Pareto distribution
X &lt;- rtpareto(1000, shape=2, endpoint=endpoint)

# Ordinary Pareto QQ-plot
ParetoQQ(X)

# Truncated Hill estimates
gamma &lt;- trHill(X)$gamma

# Estimates for truncation odds
dt &lt;- trDT(X, gamma=gamma)$DT

# Truncated Pareto QQ-plot
trParetoQQ(X, DT=dt)
</code></pre>


</div>