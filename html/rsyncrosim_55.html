<div class="container">

<table style="width: 100%;"><tr>
<td>datasheetSpatRaster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieve spatial data from a SyncroSim Datasheet</h2>

<h3>Description</h3>

<p>This function retrieves spatial columns from one or more SyncroSim
<code>Scenario</code> Datasheets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">datasheetSpatRaster(
  ssimObject,
  datasheet,
  column = NULL,
  scenario = NULL,
  iteration = NULL,
  timestep = NULL,
  filterColumn = NULL,
  filterValue = NULL,
  subset = NULL,
  forceElements = FALSE,
  pathOnly = FALSE
)

## S4 method for signature 'character'
datasheetSpatRaster(
  ssimObject,
  datasheet,
  column = NULL,
  scenario = NULL,
  iteration = NULL,
  timestep = NULL,
  filterColumn = NULL,
  filterValue = NULL,
  subset = NULL,
  forceElements = FALSE,
  pathOnly = FALSE
)

## S4 method for signature 'list'
datasheetSpatRaster(
  ssimObject,
  datasheet,
  column = NULL,
  scenario = NULL,
  iteration = NULL,
  timestep = NULL,
  filterColumn = NULL,
  filterValue = NULL,
  subset = NULL,
  forceElements = FALSE,
  pathOnly = FALSE
)

## S4 method for signature 'SsimObject'
datasheetSpatRaster(
  ssimObject,
  datasheet,
  column = NULL,
  scenario = NULL,
  iteration = NULL,
  timestep = NULL,
  filterColumn = NULL,
  filterValue = NULL,
  subset = NULL,
  forceElements = FALSE,
  pathOnly = FALSE
)

## S4 method for signature 'Scenario'
datasheetSpatRaster(
  ssimObject,
  datasheet,
  column = NULL,
  scenario = NULL,
  iteration = NULL,
  timestep = NULL,
  filterColumn = NULL,
  filterValue = NULL,
  subset = NULL,
  forceElements = FALSE,
  pathOnly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ssimObject</code></td>
<td>
<p>SsimLibrary/Project/Scenario object or list of Scenario objects. If
SsimLibrary/Project, then <code>scenario</code> argument is required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datasheet</code></td>
<td>
<p>character string. The name of the Datasheet containing the
raster data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>column</code></td>
<td>
<p>character string. The name of the column in the datasheet containing
the file names for raster data. If <code>NULL</code> (default) then use the first
column that contains raster file names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scenario</code></td>
<td>
<p>character string, integer, or vector of these. The Scenarios to
include. Required if SsimObject is an SsimLibrary/Project, ignored if
SsimObject is a list of Scenarios (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>integer, character string, or vector of integer/character strings.
Iteration(s) to include. If <code>NULL</code> (default) then all iterations are
included. If no Iteration column is in the Datasheet, then ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timestep</code></td>
<td>
<p>integer, character string, or vector of integer/character string.
Timestep(s) to include. If <code>NULL</code> (default) then all timesteps are
included.  If no Timestep column is in the Datasheet, then ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filterColumn</code></td>
<td>
<p>character string. The column to filter a Datasheet by.
(e.g. "TransitionGroupID"). Note that to use the filterColumn argument,
you must also specify a filterValue. Default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filterValue</code></td>
<td>
<p>character string or integer. The value of the filterColumn
to filter the Datasheet by. To use the filterValue argument, you must
also specify a filterColumn. Default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>logical expression indicating Datasheet rows to return.
e.g. expression(grepl("Ts0001", Filename, fixed=T)). See subset() for
details (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forceElements</code></td>
<td>
<p>logical. If <code>TRUE</code> then returns a single raster as a RasterStack;
otherwise returns a single raster as a RasterLayer directly. Default is
<code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathOnly</code></td>
<td>
<p>logical. If <code>TRUE</code> then returns a list of filepaths to the raster
files on disk. Default is <code>FALSE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The names of the returned SpatRaster contain metadata.
For Datasheets without Filename this is:
</p>
<p><code>paste0(&lt;datasheet name&gt;,".Scn",&lt;scenario id&gt;,".",&lt;tif name&gt;)</code>.
</p>
<p>For Datasheets containing Filename this is:
</p>
<p><code>paste0(&lt;datasheet name&gt;,".Scn",&lt;scenario id&gt;,".It",&lt;iteration&gt;,".Ts",&lt;timestep&gt;)</code>.
</p>


<h3>Value</h3>

<p>A SpatRaster object, or List. See terra package documentation for details.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Install the helloworldSpatial package from the server
installPackage("helloworldSpatial")

# Specify file path and name of new SsimLibrary
myLibraryName &lt;- file.path(tempdir(), "testlib_datasheetSpatRaster")

# Set up a SyncroSim Session
mySession &lt;- session()

# Use the example template library from helloworldSpatial
myLibrary &lt;- ssimLibrary(name = myLibraryName,
                         session = mySession,
                         packages = "helloworldSpatial")

# Set up Project and Scenario
myProject &lt;- project(myLibrary, project = "Definitions")
myScenario &lt;- scenario(myProject, scenario = "My Scenario")

# Run Scenario to generate results
resultScenario &lt;- run(myScenario)

# Extract specific Datasheet rasters by iteration and timestep
resultRaster &lt;- datasheetSpatRaster(resultScenario,
                  datasheet = "helloworldSpatial_IntermediateDatasheet",
                  column = "OutputRasterFile",
                  iteration = 3,
                  timestep = 2
)

# Extract specific Datasheet SpatRasters using pattern matching
resultDatasheet &lt;- datasheet(resultScenario, 
                             name = "helloworldSpatial_IntermediateDatasheet")
colnames(resultDatasheet)
outputRasterPaths &lt;- resultDatasheet$OutputRasterFile
resultRaster &lt;- datasheetSpatRaster(resultScenario, 
                  datasheet = "helloworldSpatial_IntermediateDatasheet",
                  column = "OutputRasterFile",
                  subset = expression(grepl("ts20", 
                                             outputRasterPaths,
                                             fixed = TRUE))
)

# Return the raster Datasheets as a SpatRaster list
resultRaster &lt;- datasheetSpatRaster(resultScenario, 
                 datasheet = "helloworldSpatial_IntermediateDatasheet",
                 column = "OutputRasterFile",
                 forceElements = TRUE)
                 
# Filter for only rasters that fit specific criteria
# Load the ST-Sim spatial example library
installPackage("stsim")

# Set the file path and name of the new SsimLibrary
myLibraryName &lt;- file.path(tempdir(),"testlib_stsim_datasheet")

# Set the SyncroSim Session
mySession &lt;- session()

# Create a new SsimLibrary with the example template from ST-Sim
myLibrary &lt;- ssimLibrary(name = myLibraryName,
                         session = mySession, 
                         packages = "stsim")
                         
myScenario &lt;- scenario(myLibrary, scenario = 16)

# Run Scenario to generate results
resultScenario &lt;- run(myScenario)


resultRaster &lt;- datasheetSpatRaster(resultScenario,
                 datasheet = "stsim_OutputSpatialState",
                 timestep = 5,
                 iteration = 5,
                 filterColumn = "TransitionTypeID",
                 filterValue = "Fire")

## End(Not run)

</code></pre>


</div>