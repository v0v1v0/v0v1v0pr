<div class="container">

<table style="width: 100%;"><tr>
<td>weighted-m-estimator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Huber and Tukey Mean and Total (bare-bone functions)</h2>

<h3>Description</h3>

<p>Weighted Huber and Tukey <em>M</em>-estimator of the mean and total
(bare-bone function with limited functionality; see
<code>svymean_huber</code>,  <code>svymean_tukey</code>,
<code>svytotal_huber</code>, and <code>svytotal_tukey</code> for more
capable methods)
</p>


<h3>Usage</h3>

<pre><code class="language-R">weighted_mean_huber(x, w, k, type = "rwm", asym = FALSE, info = FALSE,
                    na.rm = FALSE, verbose = TRUE, ...)
weighted_total_huber(x, w, k, type = "rwm", asym = FALSE, info = FALSE,
                     na.rm = FALSE, verbose = TRUE, ...)
weighted_mean_tukey(x, w, k, type = "rwm", info = FALSE, na.rm = FALSE,
                    verbose = TRUE, ...)
weighted_total_tukey(x, w, k, type = "rwm", info = FALSE, na.rm = FALSE,
                     verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>[numeric vector]</code> data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p><code>[numeric vector]</code> weights (same length as <code>x</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p><code>[double]</code> robustness tuning constant
(<code class="reqn">0 &lt; k \leq \infty</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>[character]</code> type of method: <code>"rwm"</code> or
<code>"rht"</code>; see below (default: <code>"rwm"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asym</code></td>
<td>
<p><code>[logical]</code> toggle for asymmetric Huber psi-function
(default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p><code>[logical]</code> indicating whether additional information
should be returned (default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p><code>[logical]</code> indicating whether <code>NA</code> values should
be removed before the computation proceeds (default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>[logical]</code> indicating whether additional
information is printed to the console (default: <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to the method (e.g.,
<code>maxit</code>: maxit number of iterations, etc.).</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>Characteristic.</dt>
<dd>
<p>Population mean or total. Let <code class="reqn">\mu</code>
denote the estimated population mean; then, the estimated
total is given by <code class="reqn">\hat{N} \mu</code> with
<code class="reqn">\hat{N} =\sum w_i</code>, where
summation is over all observations in the sample.</p>
</dd>
<dt>Type.</dt>
<dd>
<p>Two methods/types are available for estimating the
location <code class="reqn">\mu</code>:
</p>

<dl>
<dt>
<code>type = "rwm" (default)</code>:</dt>
<dd>
<p>robust weighted
<em>M</em>-estimator of the population mean and total,
respectively. This estimator is recommended for sampling
designs whose inclusion probabilities are <em>not</em>
proportional to some measure of size. [Legacy note: In an
earlier version, the method <code>type = "rwm"</code> was called
<code>"rhj"</code>; the type <code>"rhj"</code> is now silently
converted to <code>"rwm"</code>]
</p>
</dd>
<dt>
<code>type = "rht"</code>:</dt>
<dd>
<p>robust Horvitz-Thompson
<em>M</em>-estimator of the population mean and total,
respectively. This estimator is recommended for
proportional-to-size sampling designs.</p>
</dd>
</dl>
</dd>
<dt>Variance estimation.</dt>
<dd>
<p>See the related but more capable
functions:
</p>

<ul>
<li> <p><code>svymean_huber</code> and
<code>svymean_tukey</code>,
</p>
</li>
<li> <p><code>svytotal_huber</code> and
<code>svytotal_tukey</code>.
</p>
</li>
</ul>
</dd>
<dt>Psi-function.</dt>
<dd>
<p>By default, the <code>Huber</code> or <code>Tukey</code>
psi-function are used in the specification of the M-estimators. For
the Huber estimator, an asymmetric version of the Huber
psi-function can be used by setting the argument
<code>asym = TRUE</code> in the function call.</p>
</dd>
</dl>
<h3>Value</h3>

<p>The return value depends on <code>info</code>:
</p>

<dl>
<dt>
<code>info = FALSE</code>:</dt>
<dd>
<p>estimate of mean or total <code>[double]</code></p>
</dd>
<dt>
<code>info = TRUE</code>:</dt>
<dd>
<p>a <code>[list]</code> with items:
</p>

<ul>
<li> <p><code>characteristic</code> <code>[character]</code>,
</p>
</li>
<li> <p><code>estimator</code> <code>[character]</code>,
</p>
</li>
<li> <p><code>estimate</code> <code>[double]</code>,
</p>
</li>
<li> <p><code>variance</code> (default: <code>NA</code>),
</p>
</li>
<li> <p><code>robust</code> <code>[list]</code>,
</p>
</li>
<li> <p><code>residuals</code> <code>[numeric vector]</code>,
</p>
</li>
<li> <p><code>model</code> <code>[list]</code>,
</p>
</li>
<li> <p><code>design</code> (default: <code>NA</code>),
</p>
</li>
<li> <p><code>[call]</code>
</p>
</li>
</ul>
</dd>
</dl>
<h3>Failure of convergence</h3>

<p>By default, the method assumes a maximum number of <code>maxit = 100</code>
iterations and a numerical tolerance criterion to stop the iterations of
<code>tol = 1e-05</code>. If the algorithm fails to converge, you may
consider changing the default values; see <code>svyreg_control</code>.
</p>


<h3>References</h3>

<p>Hulliger, B. (1995). Outlier Robust Horvitz-Thompson Estimators.
<em>Survey Methodology</em> <b>21</b>, 79â€“87.
</p>


<h3>See Also</h3>

<p>Overview (of all implemented functions)
</p>


<h3>Examples</h3>

<pre><code class="language-R">head(workplace)

# Robust Horvitz-Thompson M-estimator of the population total
weighted_total_huber(workplace$employment, workplace$weight, k = 9,
    type = "rht")

# Robust weighted M-estimator of the population mean
weighted_mean_huber(workplace$employment, workplace$weight, k = 12,
    type = "rwm")
</code></pre>


</div>