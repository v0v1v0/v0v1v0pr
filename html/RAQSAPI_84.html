<div class="container">

<table style="width: 100%;"><tr>
<td>aqs_sampledata_by_box</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>aqs_sampledata_by_box</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
Returns sample data where the data is aggregated by
latitude/longitude bounding box (_by_box).
If return_header is FALSE (default) this function returns a
single dataframe with the requested data. If return_header
is TRUE returns a list of AQSAPI_v2 objects where each index
of the list is an individual RAQSAPI_v2 object returned from
each successive call to the AQS API. RAQSAPI_v2 objects are
two item list where the $Data portion contains data that
contains sample air monitoring data at a site with the input
parameter and cbsa_code provided for bdate - edate time
frame. The $Header is a tibble of header information from the
API call /(useful for debugging/). This function returns NULL
is bdate &gt; edate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aqs_sampledata_by_box(
  parameter,
  bdate,
  edate,
  minlat,
  maxlat,
  minlon,
  maxlon,
  duration = NA_character_,
  cbdate = NA_Date_,
  cedate = NA_Date_,
  return_header = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>a character list or a single character string
which represents the parameter code of the air
pollutant related to the data being requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdate</code></td>
<td>
<p>a R date object which represents that begin date of the data
selection. Only data on or after this date will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edate</code></td>
<td>
<p>a R date object which represents that end date of the data
selection. Only data on or before this date will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minlat</code></td>
<td>
<p>a R character object which represents the minimum latitude of
a geographic box.  Decimal latitude with north begin
positive. Only data north of this latitude will be
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlat</code></td>
<td>
<p>a R character object which represents the maximum latitude of
a geographic box. Decimal latitude with north begin
positive. Only data south of this latitude will be
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minlon</code></td>
<td>
<p>a R character object which represents the minimum longitude
of a geographic box. Decimal longitude with east begin
positive. Only data east of this longitude will be
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlon</code></td>
<td>
<p>a R character object which represents the maximum longitude
of a geographic box. Decimal longitude with east begin
positive. Only data west of this longitude will be
returned. Note that -80 is less than -70.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p>an optional R character string that represents the
parameter duration code that limits returned data
to a specific sample duration. The default value of
NA_character_ results in no filtering based on
duration code.Valid durations include actual sample
durations and not calculated durations such as 8
hour CO or $O_3$ rolling averages, 3/6 day PM
averages or Pb 3 month rolling averages.
@seealso <code>aqs_sampledurations()</code> for a list of all
available duration codes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cbdate</code></td>
<td>
<p>a R date object which represents a "beginning date of last
change" that indicates when the data was last
updated. cbdate is used to filter data based on the change
date. Only data that changed on or after this date will be
returned. This is an optional variable which defaults
to NA_Date_.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cedate</code></td>
<td>
<p>a R date object which represents an "end
date of last change" that indicates when the data was last
updated. cedate is used to filter data based on the change
date. Only data that changed on or before this date will be
returned. This is an optional variable which defaults
to NA_Date_.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_header</code></td>
<td>
<p>If FALSE (default) only returns data requested.
If TRUE returns a AQSAPI_v2 object which is a two item
list that contains header information returned from
the API server mostly used for debugging purposes in
addition to the data requested.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a tibble or an AQS_Data_Mart_APIv2 S3 object containing sample data
for all monitors within the input latitude/longitude bounding box
for a single parameter. An AQS_Data Mart_APIv2 is a 2 item named
list in which the first item /(/$Header/) is a tibble of header
information from the AQS API and the second item /(/$Data/) is a
tibble of the data returned.
</p>


<h3>Note</h3>

<p>The AQS API only allows for a single year of sampledata to be retrieved
at a time. This function conveniently extracts date information from
the bdate and edate parameters then makes repeated calls to the
AQSAPI retrieving a maximum of one calendar year of data at a time.
Each calendar year of data requires a separate API call so multiple
years of data will require multiple API calls. As the number of years
of data being requested increases so does the length of time that it
will take to retrieve results. There is also a 5 second wait
time inserted between successive API calls to prevent overloading the
API server. This operation has a linear run time of
/(Big O notation: O/(n + 5 seconds/)/).
</p>


<h3>See Also</h3>

<p>Other Aggregate _by_box functions: 
<code>aqs_annualsummary_by_box()</code>,
<code>aqs_monitors_by_box()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Returns a tibble containing all ozone samples
             #  in the vicinity of central Alabama between
             #  May 1, 2015 - May 2, 2017
          ## Not run: aqs_sampledata_by_box(parameter = "44201",
                                         bdate = as.Date("20150501",
                                                         format = "%Y%m%d"),
                                         edate = as.Date("20170502",
                                                         format = "%Y%m%d"),
                                         minlat = "33.3",
                                         maxlat = "33.6",
                                         minlon = "-87.0",
                                         maxlon = "-86.7"
                                         )
                   
## End(Not run)
</code></pre>


</div>