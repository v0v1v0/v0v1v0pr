<div class="container">

<table style="width: 100%;"><tr>
<td>take_implicit_timestep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Backwardate grid values one timestep</h2>

<h3>Description</h3>

<p>Take one timestep of an implicit solver for a given instrument
</p>


<h3>Usage</h3>

<pre><code class="language-R">take_implicit_timestep(
  t,
  S,
  full_discount_factor,
  local_discount_factor,
  discount_factor_fcn,
  prev_grid_values,
  survival_probabilities,
  tridiag_matrix_entries,
  instrument = NULL,
  dividends = NULL,
  instr_name = "this instrument"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Time after this timestep has been taken</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Underlying equity values for the grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full_discount_factor</code></td>
<td>
<p>A discount factor for the transform from
grid values to actual derivative prices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local_discount_factor</code></td>
<td>
<p>A discount factor to apply to
recovery values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discount_factor_fcn</code></td>
<td>
<p>A function for computing present values to
time <code>t</code> of various cashflows occurring during this timestep, with
arguments <code>T</code>, <code>t</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev_grid_values</code></td>
<td>
<p>A vector of space grid values from the
previously calculated timestep</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survival_probabilities</code></td>
<td>
<p>Vector of probabilities of survival
for each space grid node</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tridiag_matrix_entries</code></td>
<td>
<p>Diagonal, superdiagonal and subdiagonal
of tridiagonal matrix from the numerical integrator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instrument</code></td>
<td>
<p>If not NULL/NA,  must have a <code>recovery_fcn</code> and
an <code>optionality_fcn</code> though those properties are
themselves allowed to be NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dividends</code></td>
<td>
<p>A <code>data.frame</code> with columns <code>time</code>, <code>fixed</code>,
and <code>proportional</code>.  Dividend size at the given <code>time</code> is
then expected to be equal to <code>fixed + proportional * S / S0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instr_name</code></td>
<td>
<p>Name of instrument to use in log messages</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Grid values for the instrument after taking the implicit timestep
</p>


<h3>See Also</h3>

<p>Other Implicit Grid Solver: 
<code>construct_implicit_grid_structure()</code>,
<code>find_present_value()</code>,
<code>form_present_value_grid()</code>,
<code>infer_conforming_time_grid()</code>,
<code>integrate_pde()</code>,
<code>iterate_grid_from_timestep()</code>,
<code>timestep_instruments()</code>
</p>


</div>