<div class="container">

<table style="width: 100%;"><tr>
<td>rdbwdensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bandwidth Selection for Manipulation Testing</h2>

<h3>Description</h3>

<p><code>rdbwdensity</code> implements several data-driven bandwidth selection
methods useful to construct manipulation testing procedures using the local
polynomial density estimators proposed in Cattaneo, Jansson and Ma (2020).
</p>
<p>A companion <code>Stata</code> package is described in Cattaneo, Jansson and Ma (2018).
</p>
<p>Companion command: <code>rddensity</code> for manipulation (density discontinuity)
testing.
</p>
<p>Related Stata and R packages useful for inference in regression discontinuity (RD)
designs are described in the website: <a href="https://rdpackages.github.io/">https://rdpackages.github.io/</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdbwdensity(
  X,
  c = 0,
  p = 2,
  fitselect = "",
  kernel = "",
  vce = "",
  massPoints = TRUE,
  regularize = TRUE,
  nLocalMin = NULL,
  nUniqueMin = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric vector or one dimensional matrix/data frame, the running variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Numeric, specifies the threshold or cutoff value in the support of <code>X</code>,
which determines the two samples (e.g., control and treatment units in RD settings).
Default is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Nonnegative integer, specifies the local polynomial order used to construct
the density estimators. Default is <code>2</code> (local quadratic approximation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitselect</code></td>
<td>
<p>String, specifies the density estimation method.
<code>"unrestricted"</code> for density estimation without any restrictions (two-sample,
unrestricted inference). This is the default option.
<code>"restricted"</code> for density estimation assuming equal distribution function and
higher-order derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>String, specifies the kernel function used to construct the local
polynomial estimators.
<code>"triangular"</code>: <code>K(u)=(1-|u|)*(|u|&lt;=1)</code>. This is the
default option.
<code>"epanechnikov"</code>: <code>K(u) = 0.75*(1-u^2)*(|u|&lt;=1)</code>.
<code>"uniform"</code>: <code>K(u) = 0.5 * (|u|&lt;=1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vce</code></td>
<td>
<p>String, specifies the procedure used to compute the variance-covariance matrix estimator.
<code>"plugin"</code> for asymptotic plug-in standard errors.
<code>"jackknife"</code> for jackknife standard errors. This is the default option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>massPoints</code></td>
<td>
<p><code>TRUE</code> (default) or <code>FALSE</code>, specifies whether to adjust for
mass points in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regularize</code></td>
<td>
<p><code>TRUE</code> (default) or <code>FALSE</code>, specifies whether to conduct local sample size checking.
When set to <code>TRUE</code>, the bandwidth is chosen such that the local region includes
at least <code>nLocalMin</code> observations and at least <code>nUniqueMin</code> unique observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nLocalMin</code></td>
<td>
<p>Nonnegative integer, specifies the minimum number of observations in each local neighborhood.
This option will be ignored if set to <code>0</code>, or if <code>regularize=FALSE</code> is used. Default is <code>20+p+1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nUniqueMin</code></td>
<td>
<p>Nonnegative integer, specifies the minimum number of unique observations in
each local neighborhood. This option will be ignored if set to <code>0</code>, or if <code>regularize=FALSE</code> is used.
Default is <code>20+p+1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Bandwidths for density discontinuity test, left and right to the cutoff, and asymptotic variance and bias.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p><code>full</code>: full sample size; <code>left</code>/<code>right</code>: sample size to the left/right of the cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>Options passed to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_min</code></td>
<td>
<p>Smallest observations to the left and right of the cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_max</code></td>
<td>
<p>Largest observations to the left and right of the cutoff.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matias D. Cattaneo, Princeton University  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Michael Jansson, University of California Berkeley.  <a href="mailto:mjansson@econ.berkeley.edu">mjansson@econ.berkeley.edu</a>.
</p>
<p>Xinwei Ma (maintainer), University of California San Diego. <a href="mailto:x1ma@ucsd.edu">x1ma@ucsd.edu</a>.
</p>


<h3>References</h3>

<p>Cattaneo, M. D., M. Jansson, and X. Ma. 2018. Manipulation Testing based on Density Discontinuity. <em>Stata Journal</em> 18(1): 234-261. <a href="https://doi.org/10.1177/1536867X1801800115">doi:10.1177/1536867X1801800115</a>
</p>
<p>Cattaneo, M. D., M. Jansson, and X. Ma. 2020. Simple Local Polynomial Density Estimators. <em>Journal of the American Statistical Association</em>, 115(531): 1449-1455. <a href="https://doi.org/10.1080/01621459.2019.1635480">doi:10.1080/01621459.2019.1635480</a>
</p>


<h3>See Also</h3>

<p><code>rddensity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a random sample
set.seed(42)
x &lt;- rnorm(2000, mean = -0.5)

# Bandwidth selection
summary(rdbwdensity(X = x, vce="jackknife"))

</code></pre>


</div>