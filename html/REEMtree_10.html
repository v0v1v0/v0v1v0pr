<div class="container">

<table style="width: 100%;"><tr>
<td>REEMtree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a RE-EM tree</h2>

<h3>Description</h3>

<p>Fit a RE-EM tree to data.  This estimates a regression tree combined with a linear random effects model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">REEMtree(formula, data, random, subset=NULL,
         initialRandomEffects=rep(0,TotalObs),
         ErrorTolerance=0.001, MaxIterations=1000,
         verbose=FALSE, tree.control=rpart.control(cp=0.001),
         cv=TRUE, no.SE =1,
         lme.control=lmeControl(returnObject=TRUE),
         method="REML", correlation=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula, as in the <code>lm</code> or <code>rpart</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to interpret the variables named in the formula (unlike in <code>lm</code> or <code>rpart</code>, this is not optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>a description of the random effects, as a formula of the form <code>~1|g</code>, where <code>g</code> is the grouping variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional logical vector indicating the subset of the rows of data that should be used in the fit. All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialRandomEffects</code></td>
<td>
<p>an optional vector giving initial values for the random effects to use in estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ErrorTolerance</code></td>
<td>
<p>when the difference in the likelihoods of the linear models of two consecutive iterations is less than this value, the RE-EM tree has converged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxIterations</code></td>
<td>
<p>maximum number of iterations allowed in estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>TRUE</code>, the current estimate of the RE-EM tree will be printed after each iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree.control</code></td>
<td>
<p>a list of control values for the estimation algorithm to replace the default values used to control the <code>rpart</code> algorithm. Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>if <code>TRUE</code> then cross-validation will be used for estimating the tree at each iteration.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.SE</code></td>
<td>
<p>number of standard errors used in pruning (0 if unused)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lme.control</code></td>
<td>
<p>a list of control values for the estimation algorithm to replace the default values returned by the function <code>lmeControl</code>. Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>whether the linear model should be estimated with <code>ML</code> or <code>REML</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code>corStruct</code> object describing the within-group correlation structure; the available classes are given in <code>corClasses</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>REEMtree</code>
</p>


<h3>Author(s)</h3>

<p>Rebecca Sela <a href="mailto:rsela@stern.nyu.edu">rsela@stern.nyu.edu</a></p>


<h3>References</h3>

<p>Sela, Rebecca J., and Simonoff, Jeffrey S., “RE-EM Trees: A Data Mining Approach for Longitudinal and Clustered Data”, <em>Machine Learning</em> (2011).</p>


<h3>See Also</h3>

<p><code>rpart</code>, <code>nlme</code>, <code>REEMtree.object</code>, <code>corClasses</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(simpleREEMdata)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID)

# Estimation allowing for autocorrelation
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID,
	correlation=corAR1())

# Random parameters model for the random effects
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1+X|ID)

# Estimation with a subset
sub &lt;- rep(c(rep(TRUE, 10), rep(FALSE, 2)), 50)
REEMresult&lt;-REEMtree(Y~D+t+X, data=simpleREEMdata, random=~1|ID,
	subset=sub)

# Dataset from the R library "AER"
data("Grunfeld", package = "AER")
REEMtree(invest ~ value + capital, data=Grunfeld, random=~1|firm)
REEMtree(invest ~ value + capital, data=Grunfeld, random=~1|firm, correlation=corAR1())
REEMtree(invest ~ value + capital, data=Grunfeld, random=~1+year|firm)
REEMtree(invest ~ value + capital, data=Grunfeld, random=~1|firm/year)

</code></pre>


</div>