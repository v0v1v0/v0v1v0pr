<div class="container">

<table style="width: 100%;"><tr>
<td>stg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>STG: Feature Selection using Stochastic Gates</h2>

<h3>Description</h3>

<p>STG is a method for feature selection in neural network estimation problems.
The new procedure is based on probabilistic relaxation of the l0 norm of
features, or the count of the number of selected features.
STG simultaneously learns either a nonlinear regression
or classification function while selecting a small subset of features,
as described in Yamada, et al, ICML 2020.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stg(
  task_type,
  input_dim,
  output_dim,
  hidden_dims,
  activation = "relu",
  sigma = 0.5,
  lam = 0.1,
  optimizer = "Adam",
  learning_rate = 0.001,
  batch_size = 100L,
  freeze_onward = NULL,
  feature_selection = TRUE,
  weight_decay = 0.001,
  random_state = 123L,
  device = "cpu"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>task_type</code></td>
<td>
<p>string
choose 'regression', 'classification', or 'cox'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_dim</code></td>
<td>
<p>integer
The number of features of your data (input dimension)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_dim</code></td>
<td>
<p>integer
The number of classes for 'classification'. Should be 1 for 'regression' and 'cox'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidden_dims</code></td>
<td>
<p>vector of integers,optional,default:c(60, 20, 3)
architecture vector of the neural network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>activation</code></td>
<td>
<p>string
the type of activation functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>float
the noise level for the gaussian distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>float
the regularization parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>string
choose 'Adam' or 'SGD'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learning_rate</code></td>
<td>
<p>float</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>int</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freeze_onward</code></td>
<td>
<p>integer, default:NULL
the network parameters will be frozen after 'freeze_onward' epoch.
This is to train the gate parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_selection</code></td>
<td>
<p>bool</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_decay</code></td>
<td>
<p>float</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_state</code></td>
<td>
<p>integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device</code></td>
<td>
<p>string
'cpu' or 'cuda' (if you have GPU)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a "stg" object is returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (pystg_is_available()){
n_size &lt;- 1000L;
p_size &lt;- 20L;
stg.model &lt;- stg(task_type='regression', input_dim=p_size, output_dim=1L,
hidden_dims = c(500,50, 10), activation='tanh',
optimizer='SGD', learning_rate=0.1, batch_size=n_size,
feature_selection=TRUE, sigma=0.5, lam=0.1, random_state=0.1)
}

</code></pre>


</div>