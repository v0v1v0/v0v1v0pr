<div class="container">

<table style="width: 100%;"><tr>
<td>quefts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
QUEFTS model
</h2>

<h3>Description</h3>

<p>Create a QUEFTS model, set parameters, and run it to compute nutrient requirements and nutrient limited yield.
</p>
<p>A number of default crop parameter sets are available from <code>quefts_crop</code>, and an example soil from <code>quefts_soil</code>. You need to provide attainable or target crop production (in this context that is the maximum production in the absence of nutrient limitation), expressed as dry-matter biomass for leaves, stems and the storage organ (e.g. grain, root or tuber). See <code>quefts_biom</code>. Some crops are grown for the stems/leaves, in which case there is no relevant storage organ (e.g. sugarcane, jute). production yield estimates can be obtained with a crop growth model. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">quefts(soil, crop, fert, biom)
quefts_fert()
quefts_biom()
crop(x) &lt;- value
soil(x) &lt;- value
fert(x) &lt;- value
biom(x) &lt;- value
run(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>soil</code></td>
<td>
<p>list with named soil parameters. See Details. An example is returned by <code>quefts_soil()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crop</code></td>
<td>
<p>list with named crop parameters. See Details. An example is returned by <code>quefts_crop()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fert</code></td>
<td>
<p>list with named fertilizer parameters (N, P and K). An example is returned by <code>quefts_fert()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biom</code></td>
<td>
<p>list with named biomass and growing season length parameters. An example is returned by <code>quefts_biom()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>QueftsModel object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>list with soil, crop, fertilizer, or biomass parameters as above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments. None implemented</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For input parameters see <code>quefts_crop</code>, <code>quefts_soil</code>, <code>quefts_fert</code> and <code>quefts_biom</code>
</p>

<table>
<tr>
<td style="text-align: left;">

	</td>
<td style="text-align: left;"> <b>Crop yield (biom)</b> </td>
<td style="text-align: left;"> . </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>leaf_att, stem_att, store_att</code> </td>
<td style="text-align: left;"> Attainable (in the absence of nutrient limitation), or target crop biomass (dry-matter, kg/ha) for leaves, stems and storage organs.</td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>SeasonLength</code> </td>
<td style="text-align: left;"> Length of the growing season (days)</td>
</tr>
<tr>
<td style="text-align: left;">

	
	</td>
<td style="text-align: left;"> . </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> . </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <b>Output Variables</b> </td>
<td style="text-align: left;"> <b>Explanation</b> </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>N_actual_supply, P_actual_supply, K_actual_supply</code> </td>
<td style="text-align: left;"> nutrient uptake from soil (not fertilizer) (kg/ha) </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>leaf_lim, stem_lim, store_lim</code> </td>
<td style="text-align: left;"> nutrient limited biomass of leaves, stems, and storage organ (kg/ha) </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>N_gap, P_gap, K_gap</code> </td>
<td style="text-align: left;"> fertilizer required to reach the specified biomass (kg/ha) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>vector with output variables as described in the Details
</p>


<h3>References</h3>

<p>Janssen B.H., F.C.T. Guiking, D. van der Eijk, E.M.A. Smaling, J. Wolf and H. van Reuler, 1990. A system for the quantitative evaluation of the fertility of tropical soils (QUEFTS). Geoderma 46: 299-318
</p>
<p>Sattari, S.Z., M.K. van Ittersum, A.F. Bouwman, A.L. Smit, and B.H. Janssen, 2014. Crop yield response to soil fertility and N, P, K inputs in different environments: Testing and improving the QUEFTS model. Field Crops Research 157: 35-46
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# create a QUEFTS model
# 1. get parameters
soiltype &lt;- quefts_soil()
barley &lt;- quefts_crop("Barley")
fertilizer &lt;- list(N=0, P=0, K=0)
att_yield &lt;- list(leaf_att=2200, stem_att=2700, store_att=4800, SeasonLength=110)

# 2. create a model
q &lt;- quefts(soiltype, barley, fertilizer, att_yield)

# 3. run the model
run(q)

# change some parameters
q$SeasonLength &lt;- 162
q$leaf_att &lt;- 2651
q$stem_att &lt;- 5053
q$store_att &lt;- 8208

q$N &lt;- 100
q$P &lt;- 50
q$K &lt;- 50

run(q)


## note that Rquefts uses C++ reference classes. 
## This means that if you copy a quefts model, you do not create a 
## new instance of the model, but you point to the same one!
q &lt;- quefts()
q["N"]
k &lt;- q
k["N"] &lt;- 150
k["N"]
# the value of q has also changed!
q["N"]

## different ways of subsetting / replacement
q &lt;- quefts()
q$N
q$N &lt;- 30
q["N"]
q["N"] &lt;- 90
q["model", "N"]
q["model", "N"] &lt;- 60
q$N

q$soil$N_recovery
q["soil$N_recovery"]
q["soil$N_recovery"] &lt;- .6
q["soil", "N_recovery"]
q["soil", "N_recovery"] &lt;- .4
q$soil$N_recovery

</code></pre>


</div>