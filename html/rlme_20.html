<div class="container">

<table style="width: 100%;"><tr>
<td>rpr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster and Subcluster effects</h2>

<h3>Description</h3>

<p>Partitions model residuals into cluster and subcluster effects using RPP
algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rpr(f, resd, data, rprpair = "hl-disp")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A model formula which specifices the random effects (see example)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resd</code></td>
<td>
<p>The residuals from the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data the model was fitted on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rprpair</code></td>
<td>
<p>Character string indicating the location and scale parameters
to use. Default to "hl-disp", but may also be "med-mad". See Bilgic (2012).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>siga2</code></td>
<td>
<p> Variance from cluster </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigw2</code></td>
<td>
<p> Variance from subcluster </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmae2</code></td>
<td>
<p> Remaining variance not accounted for by variance of cluster and subcluster </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>J. W. McKean and Y. K. Bilgic
</p>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>


<h3>See Also</h3>

<p>rprmeddis, dispvar
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load school data
data(schools)

# Fit fixed effects model with lmr
lmr.fit = lmr(y ~ age + sex, data=schools)

# Three level design
# Partition residuals into school and region effects with rpp algorithm
rpr(y ~ age + sex + (1 | school) + (1 | school:region), lmr.fit$ehat, schools)

# Two level design
# Estimate variance in residuals from school
rpr(y ~ age + sex + (1 | school), lmr.fit$ehat, schools)

</code></pre>


</div>