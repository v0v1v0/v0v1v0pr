<div class="container">

<table style="width: 100%;"><tr>
<td>update_Omega</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update class covariances</h2>

<h3>Description</h3>

<p>This function updates the class covariances (independent from the other classes).
</p>


<h3>Usage</h3>

<pre><code class="language-R">update_Omega(beta, b, z, m, nu, Theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The matrix of the decision-maker specific coefficient vectors of dimension
<code>P_r</code> x <code>N</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>The matrix of class means as columns of dimension <code>P_r</code> x <code>C</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>The vector of the allocation variables of length <code>N</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The vector of class sizes of length <code>C</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>The degrees of freedom (a natural number greater than <code>P_r</code>) of the Inverse
Wishart prior for each <code>Omega_c</code>.
Per default, <code>nu = P_r + 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>The scale matrix of dimension <code>P_r</code> x <code>P_r</code> of the Inverse Wishart prior for
each <code>Omega_c</code>.
Per default, <code>Theta = diag(P_r)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following holds independently for each class <code class="reqn">c</code>.
Let <code class="reqn">\Omega_c</code> be the covariance matrix of class number <code>c</code>.
A priori, we assume that <code class="reqn">\Omega_c</code> is inverse Wishart distributed
with <code class="reqn">\nu</code> degrees of freedom and scale matrix <code class="reqn">\Theta</code>.
Let <code class="reqn">(\beta_n)_{z_n=c}</code> be the collection of <code class="reqn">\beta_n</code> that are currently allocated to class <code class="reqn">c</code>,
<code class="reqn">m_c</code> the size of class <code class="reqn">c</code>, and <code class="reqn">b_c</code> the class mean vector.
Due to the conjugacy of the prior, the posterior <code class="reqn">\Pr(\Omega_c \mid (\beta_n)_{z_n=c})</code> follows an inverted Wishart distribution
with <code class="reqn">\nu + m_c</code> degrees of freedom and scale matrix <code class="reqn">\Theta^{-1} + \sum_n (\beta_n - b_c)(\beta_n - b_c)'</code>, where
the product is over the values <code class="reqn">n</code> for which <code class="reqn">z_n=c</code> holds.
</p>


<h3>Value</h3>

<p>A matrix of updated covariance matrices for each class in columns.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### N = 100 decider, P_r = 2 random coefficients, and C = 2 latent classes
N &lt;- 100
b &lt;- cbind(c(0,0),c(1,1))
(Omega_true &lt;- matrix(c(1,0.3,0.3,0.5,1,-0.3,-0.3,0.8), ncol=2))
z &lt;- c(rep(1,N/2),rep(2,N/2))
m &lt;- as.numeric(table(z))
beta &lt;- sapply(z, function(z) rmvnorm(b[,z], matrix(Omega_true[,z],2,2)))
### degrees of freedom and scale matrix for the Wishart prior
nu &lt;- 1
Theta &lt;- diag(2)
### updated class covariance matrices (in columns)
update_Omega(beta = beta, b = b, z = z, m = m, nu = nu, Theta = Theta)
</code></pre>


</div>