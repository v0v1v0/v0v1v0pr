<div class="container">

<table style="width: 100%;"><tr>
<td>mice.impute.rfemp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Univariate sampler function for mixed types of variables for
prediction-based imputation, using empirical distribution of out-of-bag
prediction errors and predicted probabilities of random forests</h2>

<h3>Description</h3>

<p>Please note that functions with names starting with "mice.impute" are
exported to be visible for the mice sampler functions. Please do not call
these functions directly unless you know exactly what you are doing.
</p>
<p><code>RfEmpImp</code> multiple imputation method, adapter for <code>mice</code> samplers.
These functions can be called by the <code>mice</code> sampler function. In the
<code>mice()</code> function, set <code>method = "rfemp"</code> to use the <code>RfEmp</code>
method.
</p>
<p><code>mice.impute.rfemp</code> is for mixed types of variables, and it calls
corresponding functions according to variable types. Categorical variables
should be of type <code>factor</code> or <code>logical</code> etc.
</p>
<p>For continuous variables, <code>mice.impute.rfpred.emp</code> is called, performing
imputation based on the empirical distribution of out-of-bag prediction
errors of random forests.
</p>
<p>For categorical variables, <code>mice.impute.rfpred.cate</code> is called,
performing imputation based on predicted probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mice.impute.rfemp(
  y,
  ry,
  x,
  wy = NULL,
  num.trees = 10,
  alpha.emp = 0,
  sym.dist = TRUE,
  pre.boot = TRUE,
  num.trees.cont = NULL,
  num.trees.cate = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector to be imputed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>
<p>Logical vector of length <code>length(y)</code> indicating the
the subset <code>y[ry]</code> of elements in <code>y</code> to which the imputation
model is fitted. The <code>ry</code> generally distinguishes the observed
(<code>TRUE</code>) and missing values (<code>FALSE</code>) in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric design matrix with <code>length(y)</code> rows with predictors for
<code>y</code>. Matrix <code>x</code> may have no missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wy</code></td>
<td>
<p>Logical vector of length <code>length(y)</code>. A <code>TRUE</code> value
indicates locations in <code>y</code> for which imputations are created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.trees</code></td>
<td>
<p>Number of trees to build, default to <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.emp</code></td>
<td>
<p>The "significance level" for empirical distribution of
prediction errors, can be used for prevention for outliers (useful for highly
skewed variables). For example, set alpha = 0.05 to use 95% confidence level
for empirical distribution of prediction errors.
Default is <code>0.0</code>, and the empirical error distribution is kept intact.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sym.dist</code></td>
<td>
<p>If <code>TRUE</code>, the empirical distribution of out-of-bag
prediction errors will be assumed to be symmetric; if <code>FALSE</code>, the
empirical distribution will be kept intact. The default is
<code>sym.dist = TRUE</code>.
This option is invalid when <code>emp.err.cont</code> is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre.boot</code></td>
<td>
<p>Perform bootstrap prior to imputation to get 'proper'
multiple imputation, i.e. accommodating sampling variation in estimating
population regression parameters (see Shah et al. 2014).
It should be noted that if <code>TRUE</code>, this option is in effect even if the
number of trees is set to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.trees.cont</code></td>
<td>
<p>Number of trees to build for continuous variables,
default to <code>NULL</code> to use the value of <code>num.trees</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.trees.cate</code></td>
<td>
<p>Number of trees to build for categorical variables,
default to <code>NULL</code> to use the value of <code>num.trees</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>RfEmpImp</code> imputation sampler, the <code>mice.impute.rfemp</code> calls
<code>mice.impute.rfpred.emp</code> if the variable <code>is.numeric</code> is
<code>TRUE</code>, otherwise it calls <code>mice.impute.rfpred.cate</code>.
</p>


<h3>Value</h3>

<p>Vector with imputed data, same type as <code>y</code>, and of length
<code>sum(wy)</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Hong, Shangzhi, et al. "Multiple imputation using chained random forests."
Preprint, submitted April 30, 2020. https://arxiv.org/abs/2004.14823.
</p>
<p>Zhang, Haozhe, et al. "Random Forest Prediction Intervals."
The American Statistician (2019): 1-20.
</p>
<p>Shah, Anoop D., et al. "Comparison of random forest and parametric
imputation models for imputing missing data using MICE: a CALIBER study."
American journal of epidemiology 179.6 (2014): 764-774.
</p>
<p>Malley, James D., et al. "Probability machines." Methods of information
in medicine 51.01 (2012): 74-81.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Prepare data: convert categorical variables to factors
nhanes.fix &lt;- conv.factor(nhanes, c("age", "hyp"))

# This function is exported to be visible to the mice sampler functions, and
# users can set method = "rfemp" in call to mice to use this function.
# Users are recommended to use the imp.rfemp function instead:
impObj &lt;- mice(nhanes.fix, method = "rfemp", m = 5,
maxit = 5, maxcor = 1.0, eps = 0,
remove.collinear = FALSE, remove.constant = FALSE,
printFlag = FALSE
)

</code></pre>


</div>