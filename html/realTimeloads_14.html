<div class="container">

<table style="width: 100%;"><tr>
<td>impute_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Returns x with gaps imputed using ARIMA and Decision Trees, optional uncertainty estimation using Monte Carlo resampling</h2>

<h3>Description</h3>

<p>Returns x with gaps imputed using ARIMA and Decision Trees with option to use  harmonic model as predictors for x in decision tree algorithm. Uncertainty on imputed data is estimated using using Monte Carlo (MC) resampling adapting methods of Rustomji and Wilkinson (2008)
</p>


<h3>Usage</h3>

<pre><code class="language-R">impute_data(
  time,
  x,
  Xreg = NULL,
  ti = NULL,
  hfit = NULL,
  harmonic = FALSE,
  only_use_Xreg = FALSE,
  MC = 1,
  ptrain = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>time for x (time, POSIXct)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>any quantity (double)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xreg</code></td>
<td>
<p>additional predictors for decision tree, required if harmonic is FALSE (rows = time, or if given, ti)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ti</code></td>
<td>
<p>time vector for interpolation (time, POSIXct)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hfit</code></td>
<td>
<p>model object from TideHarmonics::ftide</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>harmonic</code></td>
<td>
<p>logical if x exhibits tidal or diurnal variability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_use_Xreg</code></td>
<td>
<p>logical for using Xreg only in decision tree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>
<p>number of Monte Carlo simulations for uncertainty estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptrain</code></td>
<td>
<p>proportion of data used for training and testing model</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with x imputed at time or ti, if given. Uncertainty estimated from Monte Carlo simulations
</p>


<h3>Note</h3>

<p>If MC == 1, uncertainty is not evaluated. If ptrain == 1, uncertainty and validation accuracy are not computed
</p>


<h3>Author(s)</h3>

<p>Daniel Livsey (2023) ORCID: 0000-0002-2028-6128
</p>


<h3>References</h3>

<p>Rustomji, P., &amp; Wilkinson, S. N. (2008). Applying bootstrap resampling to quantify uncertainty in fluvial suspended sediment loads estimated using rating curves. Water resources research, 44(9).
</p>
<p>van Buuren S, Groothuis-Oudshoorn K (2011). “mice: Multivariate Imputation by Chained Equations in R.” Journal of Statistical Software, 45(3), 1-67. doi:10.18637/jss.v045.i03.
</p>
<p>Stephenson AG (2016). Harmonic Analysis of Tides Using TideHarmonics. https://CRAN.R-project.org/package=TideHarmonics.
</p>
<p>Moritz S, Bartz-Beielstein T (2017). “imputeTS: Time Series Missing Value Imputation in R.” The R Journal, 9(1), 207–218. doi:10.32614/RJ-2017-009.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Impute non-tidal data
time &lt;- realTimeloads::ExampleData$Sediment_Samples$time
xo &lt;- realTimeloads::ExampleData$Sediment_Samples$SSCxs_mg_per_liter
Q &lt;- realTimeloads::ExampleData$Discharge$Discharge_m_cubed_per_s
idata &lt;- sample(1:length(xo),round(length(xo)*0.5),replace=FALSE)
x &lt;- rep(NA,length(xo))
x[idata] &lt;- xo[idata] # simulated samples
flow_concentrtion_ratio &lt;- imputeTS::na_interpolation(Q/x)
Xreg &lt;- cbind(Q,flow_concentrtion_ratio)
Output &lt;- impute_data(time,x,Xreg,MC = 10,ptrain = 0.8)

# Impute tidal data
time &lt;-TideHarmonics::Portland$DateTime[1:(24*90)]
xo &lt;-TideHarmonics::Portland$SeaLevel[1:(24*90)]
idata &lt;- sample(1:length(xo),round(length(xo)*0.5),replace=FALSE)
x &lt;- rep(NA,length(xo))
x[idata] &lt;- xo[idata] # simulated samples
Output &lt;- impute_data(time,x,harmonic = TRUE,MC = 10,ptrain = 0.8)
</code></pre>


</div>