<div class="container">

<table style="width: 100%;"><tr>
<td>BackupQueueDateTime</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An R6 class for managing timestamped backups</h2>

<h3>Description</h3>

<p>A BackupQueue for timestamped backups, e.g. <code>foo.log</code>, <code style="white-space: pre;">⁠foo.2020-07-24_10-54-30.log⁠</code>
</p>


<h3>Details</h3>

<p>This class is part of the R6 API of <strong>rotor</strong> which is
intended for developers that want to extend this package. For normal usage,
the simpler functional API is recommended (see <code>rotate()</code>).
</p>


<h3>Super classes</h3>

<p><code>rotor::DirectoryQueue</code> -&gt; <code>rotor::BackupQueue</code> -&gt; <code>BackupQueueDateTime</code>
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>fmt</code></dt>
<dd>
<p>See <code>format</code> argument of <code>rotate_date()</code>
<code>logical</code> scalar. If <code>TRUE</code> (the default) the list of backups is cached,
if <code>FALSE</code> it is read from disk every time this appender triggers.
Caching brings a significant speedup for checking whether to rotate or
not based on the <code>age</code> of the last backup, but is only safe if there are
no other programs/functions interacting with the backups. This is only
advantageous for high frequency file rotation (i.e. several times per
second)
<code>POSIXct</code> scalar. Timestamp of the last rotation (the last backup)</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-BackupQueueDateTime-new"><code>BackupQueueDateTime$new()</code></a>
</p>
</li>
<li> <p><a href="#method-BackupQueueDateTime-push"><code>BackupQueueDateTime$push()</code></a>
</p>
</li>
<li> <p><a href="#method-BackupQueueDateTime-prune"><code>BackupQueueDateTime$prune()</code></a>
</p>
</li>
<li> <p><a href="#method-BackupQueueDateTime-should_rotate"><code>BackupQueueDateTime$should_rotate()</code></a>
</p>
</li>
<li> <p><a href="#method-BackupQueueDateTime-update_backups_cache"><code>BackupQueueDateTime$update_backups_cache()</code></a>
</p>
</li>
<li> <p><a href="#method-BackupQueueDateTime-set_max_backups"><code>BackupQueueDateTime$set_max_backups()</code></a>
</p>
</li>
<li> <p><a href="#method-BackupQueueDateTime-set_fmt"><code>BackupQueueDateTime$set_fmt()</code></a>
</p>
</li>
<li> <p><a href="#method-BackupQueueDateTime-set_cache_backups"><code>BackupQueueDateTime$set_cache_backups()</code></a>
</p>
</li>
</ul>
<details><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="rotor" data-topic="DirectoryQueue" data-id="set_dir"><a href="../../rotor/html/DirectoryQueue.html#method-DirectoryQueue-set_dir"><code>rotor::DirectoryQueue$set_dir()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rotor" data-topic="BackupQueue" data-id="print"><a href="../../rotor/html/BackupQueue.html#method-BackupQueue-print"><code>rotor::BackupQueue$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rotor" data-topic="BackupQueue" data-id="prune_identical"><a href="../../rotor/html/BackupQueue.html#method-BackupQueue-prune_identical"><code>rotor::BackupQueue$prune_identical()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rotor" data-topic="BackupQueue" data-id="push_backup"><a href="../../rotor/html/BackupQueue.html#method-BackupQueue-push_backup"><code>rotor::BackupQueue$push_backup()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rotor" data-topic="BackupQueue" data-id="set_backup_dir"><a href="../../rotor/html/BackupQueue.html#method-BackupQueue-set_backup_dir"><code>rotor::BackupQueue$set_backup_dir()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rotor" data-topic="BackupQueue" data-id="set_compression"><a href="../../rotor/html/BackupQueue.html#method-BackupQueue-set_compression"><code>rotor::BackupQueue$set_compression()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rotor" data-topic="BackupQueue" data-id="set_file"><a href="../../rotor/html/BackupQueue.html#method-BackupQueue-set_file"><code>rotor::BackupQueue$set_file()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rotor" data-topic="BackupQueue" data-id="set_origin"><a href="../../rotor/html/BackupQueue.html#method-BackupQueue-set_origin"><code>rotor::BackupQueue$set_origin()</code></a></span></li>
</ul></details><hr>
<a id="method-BackupQueueDateTime-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>BackupQueueDateTime$new(
  origin,
  dir = dirname(origin),
  max_backups = Inf,
  compression = FALSE,
  fmt = "%Y-%m-%d--%H-%M-%S",
  cache_backups = FALSE,
  backup_dir = NULL
)</pre></div>


<hr>
<a id="method-BackupQueueDateTime-push"></a>



<h4>Method <code>push()</code>
</h4>

<p>Create a new time-stamped backup (e.g. ‘<span class="file">logfile.2020-07-22_12-26-29.log</span>’)
</p>


<h5>Usage</h5>

<div class="r"><pre>BackupQueueDateTime$push(overwrite = FALSE, now = Sys.time())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>overwrite</code></dt>
<dd>
<p><code>logical</code> scalar. Overwrite backups with the same
filename (i.e timestamp)?</p>
</dd>
<dt><code>now</code></dt>
<dd>
<p><code>POSIXct</code> scalar. Can be used as an override mechanism for
the current system time if necessary.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-BackupQueueDateTime-prune"></a>



<h4>Method <code>prune()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>BackupQueueDateTime$prune(max_backups = self$max_backups)</pre></div>


<hr>
<a id="method-BackupQueueDateTime-should_rotate"></a>



<h4>Method <code>should_rotate()</code>
</h4>

<p>Should a file of <code>size</code> and <code>age</code> be rotated? See <code>size</code> and <code>age</code>
arguments of <code>rotate_date()</code>. <code>now</code> overrides the current system time,
'last_rotation“ overrides the date of the last rotation.
</p>


<h5>Usage</h5>

<div class="r"><pre>BackupQueueDateTime$should_rotate(
  size,
  age,
  now = Sys.time(),
  last_rotation = self$last_rotation %||% file.info(self$origin)$ctime,
  verbose = FALSE
)</pre></div>



<h5>Returns</h5>

<p><code>TRUE</code> or <code>FALSE</code>
</p>


<hr>
<a id="method-BackupQueueDateTime-update_backups_cache"></a>



<h4>Method <code>update_backups_cache()</code>
</h4>

<p>Force update of the backups cache (only if <code style="white-space: pre;">⁠$cache_backups == TRUE⁠</code>).
</p>


<h5>Usage</h5>

<div class="r"><pre>BackupQueueDateTime$update_backups_cache()</pre></div>


<hr>
<a id="method-BackupQueueDateTime-set_max_backups"></a>



<h4>Method <code>set_max_backups()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>BackupQueueDateTime$set_max_backups(x)</pre></div>


<hr>
<a id="method-BackupQueueDateTime-set_fmt"></a>



<h4>Method <code>set_fmt()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>BackupQueueDateTime$set_fmt(x)</pre></div>


<hr>
<a id="method-BackupQueueDateTime-set_cache_backups"></a>



<h4>Method <code>set_cache_backups()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>BackupQueueDateTime$set_cache_backups(x)</pre></div>




<h3>See Also</h3>

<p>Other R6 Classes: 
<code>BackupQueueDate</code>,
<code>BackupQueueIndex</code>,
<code>BackupQueue</code>,
<code>Cache</code>,
<code>DirectoryQueue</code>
</p>


</div>