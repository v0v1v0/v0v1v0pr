<div class="container">

<table style="width: 100%;"><tr>
<td>rofanova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Functional Analysis of Variance</h2>

<h3>Description</h3>

<p>Robust Functional Analysis of Variance (RoFANOVA) allows identifying the presence of significant differences, in terms of
functional mean, among groups of a functional data by being robust against the presence of outliers  (Centofanti et al., 2021).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rofanova(
  X,
  label_1,
  label_2 = NULL,
  B = 100,
  cores = 1,
  family = "bisquare",
  eff = 0.95,
  mu0_g = NULL,
  scale = NULL,
  maxit = 50,
  tol = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Either an object of class  <code>fdata</code> for monodimensional functional data  or an object of class <code>fdata2d</code> for bi-dimensional functional data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_1</code></td>
<td>
<p>A vector of containing group label corresponding to the first main effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_2</code></td>
<td>
<p>A vector of containing group label corresponding to the second main effect. If it is NULL, the one-way RoFANOVA is performed.
Otherwise, the two-way RoFANOVA with interaction is employed. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of permutations used to approximate the p-value in the permutation test. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>If <code>cores</code>&gt;1, then parallel computing is used, with <code>cores</code> cores. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The family of loss function for the calculation of the equivariant functional M-estimator. The values allowed are
"bisquare" for the bisquare or Tukey's biweight family of loss functions;  "huber" for the the Huber's family of loss functions;
"optimal" for the  optimal family of loss functions; "hampel" for the the Hampel's family of loss functions; "median" for the median loss function.
A non-robust functional estimator of the mean based on the standard least squares loss function is used with the value "mean". Default is "bisquare".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eff</code></td>
<td>
<p>Asymptotic efficiency of the equivariant functional M-estimator. When <code>family</code> is either "mean" or "median", <code>eff</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0_g</code></td>
<td>
<p>Initial estimate  used in re-weighted least-squares algorithm to compute the equivariant functional M-estimator.
If NULL the standard non-robust functional mean is used. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Estimate of the standard error of <code>X</code>. If NULL, the functional normalized median absolute deviation estimator is used. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>The maximum number of iterations allowed in the re-weighted least-squares algorithm to compute the equivariant functional M-estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The tolerance for the stopping condition of the re-weighted least-squares algorithm to compute the equivariant functional M-estimator.
The algorithm stops when the relative variation of the weighted norm sum between two consecutive iterations is less than <code>tol</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>pval_vec</code> Vector of p-value of corresponding to the test of significance of the whole model, the main effects and the interaction.  For one-way RoFANOVA, it is the p-value corresponding to the test of the main effect.
</p>
<p><code>Tr_obs</code> The observed value of the test statistic.
</p>
<p><code>Tr_perm</code> The values of the test statistic for each permutation.
</p>
<p><code>mod</code> A list containing the following arguments:
</p>

<ul>
<li> <p><code>Tr</code>: The observed value of the test statistic.
</p>
</li>
<li>
<p><code>global_mean</code>: The robust estimate of functional grand mean.
</p>
</li>
<li>
<p><code>group_mean_1</code>: The robust estimate of the first functional main effect.
</p>
</li>
<li>
<p><code>group_mean_2</code>: The robust estimate of the second functional main effect. For one-way RoFANOVA, it is NULL.
</p>
</li>
<li>
<p><code>group_mean_ij</code>: The robust estimate of the group functional mean. For one-way, it RoFANOVA is NULL.
</p>
</li>
<li>
<p><code>scale</code>: The robust estimate of functional standard deviation.
</p>
</li>
<li>
<p><code>scale_1</code>: The robust estimate of functional standard deviation corresponding to the first functional main effect.
</p>
</li>
<li>
<p><code>scale_2</code>: The robust estimate of functional standard deviation corresponding to the second functional main effect. For one-way RoFANOVA, it is NULL.
</p>
</li>
<li>
<p><code>scale_re</code>: The robust estimate of the  functional standard deviation of the error distribution. For one-way RoFANOVA, it is NULL.
</p>
</li>
<li>
<p><code>X</code>: The variable <code>X</code>.
</p>
</li>
<li>
<p><code>label_1</code>: The vector of containing group label corresponding to the first main effect.
</p>
</li>
<li>
<p><code>label_2</code>: The vector of containing group label corresponding to the second main effect. For one-way RoFANOVA, it is NULL.
</p>
</li>
<li>
<p><code>family</code>: The family of loss function for the calculation of the equivariant functional M-estimator.
</p>
</li>
</ul>
<h3>References</h3>

<p>Centofanti, F., Colosimo, B.M., Grasso, M.L., Menafoglio, A., Palumbo, B., Vantini, S. (2021).
Robust Functional ANOVA with Application to Additive Manufacturing.
<em>arXiv preprint arXiv:2112.10643</em>.
</p>


<h3>See Also</h3>

<p><code>fusem</code> <code>funmad</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(rofanova)
data_out&lt;-simulate_data(scenario="one-way")
label_1=data_out$label_1
X_fdata&lt;-data_out$X_fdata
B=10
cores=1
per_list_median&lt;-rofanova(X_fdata,label_1,B = B,family="median",cores=cores)
pvalue_median_vec&lt;-per_list_median$pval_vec
per_list_huber&lt;-rofanova(X_fdata,label_1,B = B,family="huber",cores=cores)
pvalue_huber_vec&lt;-per_list_huber$pval_vec
per_list_bisquare&lt;-rofanova(X_fdata,label_1,B = B,family="bisquare",cores=cores)
pvalue_bisquare_vec&lt;-per_list_bisquare$pval_vec
per_list_hampel&lt;-rofanova(X_fdata,label_1,B = B,family="hampel",cores=cores)
pvalue_hampel_vec&lt;-per_list_hampel$pval_vec
per_list_optimal&lt;-rofanova(X_fdata,label_1,B = B,family="optimal",cores=cores)
pvalue_optimal&lt;-per_list_optimal$pval
</code></pre>


</div>