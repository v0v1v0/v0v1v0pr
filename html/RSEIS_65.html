<div class="container">

<table style="width: 100%;"><tr>
<td>evolfft</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectrogram fft</h2>

<h3>Description</h3>

<p>Spectrogram using simple fft (Gabor Transform)
</p>


<h3>Usage</h3>

<pre><code class="language-R">evolfft(a, dt = 0, Nfft = 0, Ns = 0, Nov = 0, fl = 0, fh = 10, pcttap =
0.05, adjust=TRUE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>signal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>sample rate interval (s) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nfft</code></td>
<td>
<p>Number of points in fft </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ns</code></td>
<td>
<p>NUmber of sample in sub-window </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nov</code></td>
<td>
<p>number of sample to overlap </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fl</code></td>
<td>
<p> low frequency to display </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fh</code></td>
<td>
<p>high frequency to display  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcttap</code></td>
<td>
<p>Percent cosine taper for each window  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>logical, if TRUE adjust the parameters
so the plot looks good (DEFAULT).  If FALSE, keep user parameters. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a duplication of the spectrogram function in matlab  which
applies Welsh's Method.
Each mini-window is tapered with a cosine window.
</p>


<h3>Value</h3>

<p>List
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>input signal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>deltat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wpars</code></td>
<td>
<p>input parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DSPEC</code></td>
<td>
<p>spectrum image</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>output frequencies (y axis)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tims</code></td>
<td>
<p>output times (x-axis) </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Parameter adjust is by default TRUE so that the
choice of Ns, Nov, and kcol will be optimized, more or less.
Set this logical to FALSE to force the function to
use user input parameters.
</p>


<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees.edu&gt;</p>


<h3>See Also</h3>

<p>evolMTM, evolAR, MTM.drive</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(CE1)

####  plot signals
plot(CE1$x, CE1$y, type='l')

###  set parameters
Nfft&lt;-1024   ###  fft length
Ns&lt;-250      ###  number of samples in a window
Nov&lt;-240     ###  number of samples of overlap per window
fl&lt;-0        ###  low frequency to return
fh&lt;-1/(2*CE1$dt)     ###  high frequency to return

########  calculate the evolutive fft (Gabor Transform)
EV &lt;- evolfft(CE1$y, dt =CE1$dt , Nfft = Nfft, Ns =Ns , Nov =Nov , fl =fl
, fh = 25)

### plot image, but it does not look too interesting
image(EV$DSPEC)


### plot Gabor transform with special function
PE &lt;- plotevol(EV, log=0, fl=0.01, fh=100, col=rainbow(100), ygrid=FALSE,
STAMP="", STYLE="fft")


</code></pre>


</div>