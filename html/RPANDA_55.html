<div class="container">

<table style="width: 100%;"><tr>
<td>getMAPS_ClaDS0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Gets the Maximum A Posteriori for each ClaDS0 parameter
</h2>

<h3>Description</h3>

<p>Extract the MAPs (Maximum A Posteriori) for the marginal posterior distributions estimated with run_ClaDS0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getMAPS_ClaDS0(phylo, sampler, burn=1/2, thin=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>An object of class 'phylo'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampler</code></td>
<td>

<p>The output of a run_ClaDS0 run.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>

<p>Number of iterations to drop in the beginning of the chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>

<p>Thinning parameter, one iteration out of "thin" is kept to compute the MAPs.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector MAPS containing the MAPs for the marginal posterior distribution for each of the model's parameters.
</p>
<p>MAPS[1:3] are the estimated hyperparameters, with MAPS[1] the sigma parameter (new rates stochasticity), MAPS[2] the alpha parameter (new rates trend), and MAPS[3] the initial speciation rate lambda_0. 
</p>
<p>MAPS[-(1:3)] are the estimated branch-specific speciation rates, given in the same order as the <code>phylo$edges</code>.
</p>


<h3>Author(s)</h3>

<p>O. Maliet
</p>


<h3>References</h3>

<p>Maliet O., Hartig F. and Morlon H. 2019, A model with many small shifts for estimating species-specific diversificaton rates, <em>Nature Ecology and Evolution</em>, doi 10.1038/s41559-019-0908-0
</p>


<h3>See Also</h3>

<p><code>fit_ClaDS0</code>, <code>plot_ClaDS0_chains</code>, <code>getMAPS_ClaDS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)


if(test){
obj= sim_ClaDS( lambda_0=0.1,    
                mu_0=0.5,      
                sigma_lamb=0.7,         
                alpha_lamb=0.90,     
                condition="taxa",    
                taxa_stop = 20,    
                prune_extinct = TRUE)  

tree = obj$tree
speciation_rates = obj$lamb[obj$rates]
extinction_rates = obj$mu[obj$rates]
data("ClaDS0_example")

# extract the Maximum A Posteriori for each of the parameters
MAPS = getMAPS_ClaDS0(ClaDS0_example$tree, 
                      ClaDS0_example$Cl0_chains, 
                      thin = 10)

# plot the simulated (on the left) and inferred speciation rates (on the right)
# on the same color scale
plot_ClaDS_phylo(ClaDS0_example$tree, 
          ClaDS0_example$speciation_rates, 
          MAPS[-(1:3)])
}
</code></pre>


</div>