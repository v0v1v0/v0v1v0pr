<div class="container">

<table style="width: 100%;"><tr>
<td>PredictNonlinear</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for nonlinear dynamics</h2>

<h3>Description</h3>

<p><code>PredictNonlinear</code> uses <code>SMap</code> to evaluate
prediction accuracy as a function of the localisation parameter
<code>theta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PredictNonlinear(pathIn = "./", dataFile = "", dataFrame = NULL,
  pathOut = "./",  predictFile = "", lib = "", pred = "", theta = "",
  E = 1, Tp = 1, knn = 0, tau = -1, exclusionRadius = 0,
  columns = "", target = "", embedded = FALSE, verbose = FALSE,
  validLib = vector(), ignoreNan = TRUE, numThreads = 4,
  showPlot = TRUE, noTime = FALSE )  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathOut</code></td>
<td>
<p>path for <code>predictFile</code> containing output predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictFile</code></td>
<td>
<p>output file name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lib</code></td>
<td>
<p>string or vector with start and stop indices of input data
rows used to create the library from observations. Mulitple row index
pairs can be specified with each pair defining the first and last
rows of time series observation segments used to create the library.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>string with start and stop indices of input data rows used for
predictions. A single contiguous range is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>A whitespace delimeted string with values of the S-map 
localisation parameter. An empty string will use default values of
<code>[0.01 0.1 0.3 0.5 0.75 1 1.5 2 3 4 5 6 7 8 9]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>embedding dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to the
library size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>column name used for prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validLib</code></td>
<td>
<p>logical vector the same length as the number of data
rows.  Any data row represented in this vector as FALSE, will not be
included in the library.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignoreNan</code></td>
<td>
<p>logical to internally redefine library to avoid nan.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numThreads</code></td>
<td>
<p>number of parallel threads for computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The localisation parameter <code>theta</code> weights nearest
neighbors according to exp( (-theta D / D_avg) ) where D is the
distance between the observation vector and neighbor, D_avg the mean
distance.  If theta = 0, weights are uniformally unity corresponding
to a global autoregressive model.  As theta increases, neighbors in
closer proximity to the observation are considered. 
</p>


<h3>Value</h3>

<p>A data.frame with columns <code>Theta, rho</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(TentMapNoise)
theta.rho = PredictNonlinear( dataFrame = TentMapNoise, E = 2,
lib = "1 100", pred = "201 500", columns = "TentMap",
target = "TentMap", showPlot = FALSE )
</code></pre>


</div>