<div class="container">

<table style="width: 100%;"><tr>
<td>mvBACON</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BACON: Blocked Adaptive Computationally-Efficient Outlier Nominators</h2>

<h3>Description</h3>

<p>This function performs an outlier identification
algorithm to the data in the x array [n x p] and y vector [n]
following the lines described by Hadi et al. for their
BACON outlier procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvBACON(x, collect = 4, m = min(collect * p, n * 0.5), alpha = 0.05,
        init.sel = c("Mahalanobis", "dUniMedian", "random", "manual", "V2"),
        man.sel, maxsteps = 100, allowSingular = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric matrix (of dimension <code class="reqn">[n x p]</code>),
not supposed to contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collect</code></td>
<td>
<p>a multiplication factor <code class="reqn">c</code>, when <code>init.sel</code> is not
<code>"manual"</code>, to define <code class="reqn">m</code>, the size of the initial basic
subset, as <code class="reqn">m := c \cdot p</code>, in practice,
<code>m &lt;- min(p * collect, n/2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>integer in <code>1:n</code> specifying the <em>size</em> of the initial basic
subset; used only when <code>init.sel</code> is not <code>"manual"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>determines the cutoff value for the Mahalanobis
distances (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.sel</code></td>
<td>
<p>character string, specifying the initial selection
mode; implemented modes are:
</p>

<dl>
<dt>"Mahalanobis"</dt>
<dd>
<p>based on Mahalanobis distances (default); the
version <code class="reqn">V1</code> of the reference; affine invariant but not robust.</p>
</dd>
<dt>"dUniMedian"</dt>
<dd>
<p>based on the distances from the
<b>uni</b>variate medians; similar to the version <code class="reqn">V2</code> of the reference;
robust but not affine invariant.</p>
</dd>
<dt>"random"</dt>
<dd>
<p>based on a random selection, i.e., reproducible only
via <code>set.seed()</code>.</p>
</dd>
<dt>"manual"</dt>
<dd>
<p>based on manual selection; in this case, a vector
<code>man.sel</code> containing the indices of the selected
observations must be specified.</p>
</dd>
<dt>"V2"</dt>
<dd>
<p>based on the Euclidean norm from the <b>uni</b>variate
medians; this is the version <code class="reqn">V2</code> of the reference; robust but not
affine invariant.</p>
</dd>
</dl>
<p><code>"Mahalanobis"</code> and <code>"V2"</code> where proposed by Hadi
and the other authors in the reference as versions ‘V_1’
and ‘V_2’, as well as <code>"manual"</code>,
while <code>"random"</code> is provided in order to study the behaviour of
BACON.  Option <code>"dUniMedian"</code> is similar to <code>"V2"</code> and is due
to U. Oetliker.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>man.sel</code></td>
<td>
<p>only when <code>init.sel == "manual"</code>, the indices of
observations determining the initial basic subset (and <code>m &lt;-
      length(man.sel)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsteps</code></td>
<td>
<p>maximal number of iteration steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowSingular</code></td>
<td>
<p>logical indicating a solution should be sought
also when no matrix of rank <code class="reqn">p</code> is found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating if messages are printed which trace
progress of the algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Remarks on the tuning parameter <code>alpha</code>: Let <code class="reqn">\chi^2_p</code>
be a chi-square distributed random variable with <code class="reqn">p</code> degrees
of freedom (<code class="reqn">p</code> is the number of variables; <code class="reqn">n</code> is the
number of observations).  Denote the <code class="reqn">(1-\alpha)</code> quantile by
<code class="reqn">\chi^2_p(\alpha)</code>, e.g., <code class="reqn">\chi^2_p(0.05)</code> is the 0.95 quantile.
Following Billor et al. (2000), the cutoff value for the
Mahalanobis distances is defined as <code class="reqn">\chi_p(\alpha/n)</code> (the square
root of <code class="reqn">chi^2_p</code>) times a correction factor <code class="reqn">c(n,p)</code>,
<code class="reqn">n</code> and <code class="reqn">p</code>,
and they use <code class="reqn">\alpha=0.05</code>.
</p>


<h3>Value</h3>

<p>a <code>list</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>logical vector of length <code>n</code> where the <code>i</code>-th
entry is true iff the i-th observation is part of the final selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>numeric vector of length <code>n</code> with the (Mahalanobis)
distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p><code class="reqn">p \times p</code> matrix, the corresponding robust
estimate of covariance.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ueli Oetliker, Swiss Federal Statistical Office, for S-plus 5.1.
Port to <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>, testing etc, by Martin Maechler;
Init selection <code>"V2"</code> and correction of default <code>alpha</code> from 0.95 to 0.05,
by Tobias Schoch, FHNW Olten, Switzerland.
</p>


<h3>References</h3>

<p>Billor, N., Hadi, A. S., and Velleman , P. F. (2000).
BACON: Blocked Adaptive Computationally-Efficient Outlier Nominators;
<em>Computational Statistics and Data Analysis</em> <b>34</b>, 279–298.
<a href="https://doi.org/10.1016/S0167-9473%2899%2900101-2">doi:10.1016/S0167-9473(99)00101-2</a>
</p>


<h3>See Also</h3>

<p><code>covMcd</code> for a high-breakdown (but more computer
intensive) method;
<code>BACON</code> for a “generalization”, notably to
<em>regression</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> require(robustbase) # for example data and covMcd():
 ## simple 2D example :
 plot(starsCYG, main = "starsCYG  data  (n=47)")
 B.st &lt;- mvBACON(starsCYG)
 points(starsCYG[ ! B.st$subset,], pch = 4, col = 2, cex = 1.5)
 stopifnot(identical(which(!B.st$subset), c(7L,11L,20L,30L,34L)))
 ## finds the 4 clear outliers (and 1 "borderline");
 ## it does not find obs. 14 which is an outlier according to covMcd(.)

 iniS &lt;- setNames(, eval(formals(mvBACON)$init.sel)) # all initialization methods, incl "random"
 set.seed(123)
 Bs.st &lt;- lapply(iniS[iniS != "manual"], function(s)
                 mvBACON(as.matrix(starsCYG), init.sel = s, verbose=FALSE))
 ii &lt;- - match("steps", names(Bs.st[[1]]))
 Bs.s1 &lt;- lapply(Bs.st, `[`, ii)
 stopifnot(exprs = {
    length(Bs.s1) &gt;= 4
    length(unique(Bs.s1)) == 1 # all 4 methods give the same
 })

 ## Example where "dUniMedian" and "V2" differ :
 data(pulpfiber, package="robustbase")
 dU.plp &lt;- mvBACON(as.matrix(pulpfiber), init.sel = "dUniMedian")
 V2.plp &lt;- mvBACON(as.matrix(pulpfiber), init.sel = "V2")
 (oU &lt;- which(! dU.plp$subset))
 (o2 &lt;- which(! V2.plp$subset))
 stopifnot(setdiff(o2, oU) %in% c(57L,58L,59L,62L))
 ## and 57, 58, 59, and 62 *are* outliers according to covMcd(.)

 ## 'coleman' from pkg 'robustbase'
 coleman.x &lt;- data.matrix(coleman[, 1:6])
 Cc &lt;- covMcd (coleman.x) # truly robust
 summary(Cc) # -&gt; 6 outliers (1,3,10,12,17,18)
 Cb1 &lt;- mvBACON(coleman.x) ##-&gt; subset is all TRUE hmm??
 Cb2 &lt;- mvBACON(coleman.x, init.sel = "dUniMedian")
 stopifnot(all.equal(Cb1, Cb2))
 ## try 20 different random starts:
 Cb.r &lt;- lapply(1:20, function(i) { set.seed(i)
                     mvBACON(coleman.x, init.sel="random", verbose=FALSE) })
 nm &lt;- names(Cb.r[[1]]); nm &lt;- nm[nm != "steps"]
 all(eqC &lt;- sapply(Cb.r[-1], function(CC) all.equal(CC[nm], Cb.r[[1]][nm]))) # TRUE
 ## --&gt; BACON always  breaks down, i.e., does not see the outliers here
 
 ## breaks down even when manually starting with all the non-outliers:
 Cb.man &lt;- mvBACON(coleman.x, init.sel = "manual",
                   man.sel = setdiff(1:20, c(1,3,10,12,17,18)))
 which( ! Cb.man$subset) # the outliers according to mvBACON : _none_
</code></pre>


</div>