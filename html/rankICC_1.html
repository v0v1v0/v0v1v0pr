<div class="container">

<table style="width: 100%;"><tr>
<td>rankICC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank ICC with two hierarchies</h2>

<h3>Description</h3>

<p><code>rankICC</code> computes the rank intraclass correlation coefficient (ICC) of a two-level hierarchical distribution. It can be used with any orderable variable, including continuous and discrete variables. Different weighting methods are provided, including methods assigning equal weights to observations or to clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rankICC(
  x,
  cluster,
  weights = c("obs", "clusters", "ess", "combination"),
  conf.int = 0.95,
  fisher = FALSE,
  na.rm = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric or factor vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>a vector of cluster index corresponding to <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a character string indicating which weighting method is used. Or an optional vector of user-defined weights to be used. Should be one of the strings <code>"obs"</code>, <code>"clusters"</code>, <code>"ess"</code>, <code>"combination"</code>, or a numeric vector. Default is <code>"obs"</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>numeric specifying confidence interval level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisher</code></td>
<td>
<p>logical, indicating whether to apply Fisher transformation to compute confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the iteration function if <code>weights</code> is <code>"ess"</code> or <code>"combination"</code>. Specifying the tolerance via <code>"tol"</code> and the maximum iteration times via <code>"maxIter"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>"obs"</code> assigns equal weights to observations; <code class="reqn">p_{ij} = 1/N</code>, where <var>N</var> is the total number of observations. <code>"clusters"</code> assigns equal weights to clusters; <code class="reqn">p_{ij} = 1/(nk_i)</code>, where <var>n</var> is the total number of clusters and k_i is the cluster size. <code>"ess"</code> and <code>"combination"</code> implement iterations until convergence; <code class="reqn">p_{ij}(\gamma_I)=1/(1+k_i\gamma_I)/\{\sum_{j=1}^n k_j/(1+k_j\gamma_I)\}</code> for <code>"ess"</code>, <code class="reqn">p_{ij}(\gamma_I)=(1-\gamma_I)/N+\gamma_I/(nk_i)</code> for <code>"combination"</code>.
</p>


<h3>Value</h3>

<p>a vector with following components.
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>rankICC</code> </td>
<td style="text-align: left;"> the rank ICC. </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>SE</code> </td>
<td style="text-align: left;"> the standard error. </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>Lower, Upper</code> </td>
<td style="text-align: left;"> the lower and upper bound of the confidence interval.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Tu, S., Li, C., Zeng, D., and Shepherd, B. E. (2023). Rank intraclass correlation for clustered data. Statistics in Medicine 42, 4333-4348.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k &lt;- 50; m &lt;- 5
sigma.u &lt;- 1; sigma.e &lt;- 2
u &lt;- rnorm(k, 5, sigma.u)
x1 &lt;- matrix(NA, k, m)
for (i in 1:k){
x1[i,] &lt;- u[i] + rnorm(5, 0, sigma.e)
}
x &lt;- as.vector(t(x1))
cluster &lt;- rep(1:k, each=5)
rankICC(x, cluster, weights = "clusters")
rankICC(x, cluster, weights = "ess", tol = 1e-4, maxIter = 10)
</code></pre>


</div>