<div class="container">

<table style="width: 100%;"><tr>
<td>psi.findc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Tuning Constant(s) for "lqq" and "ggw" Psi Functions</h2>

<h3>Description</h3>

<p>Find psi function tuning constant sets for <code>"LQQ"</code> and <code>"GGW"</code>
psi (<code class="reqn">\psi</code>) functions by specifying largest descent (minimal
slope), efficiency and or breakdown point.
</p>
<p><code>.psi.const()</code> is called from <code>lmrob.control()</code> to
set the tuning constants for psi and chi for <code>"LQQ"</code> and
<code>"GGW"</code> psi.  Unless  the specified tuning constants are from
fixed small set where the computations are stored precomputed,
<code>.psi.const()</code> calls the corresponding <code>.psi.&lt;psi&gt;.findc()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.psi.ggw.findc(ms, b, eff = NA, bp = NA,
               subdivisions = 100L,
               rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
               tol = .Machine$double.eps^0.25, ms.tol = tol/64, maxiter = 1000)

.psi.lqq.findc(ms, b.c, eff = NA, bp = NA,
               interval = c(0.1, 4), subdivisions = 100L,
               rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
               tol = .Machine$double.eps^0.25, maxiter = 1000)
.psi.const(cc, psi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ms</code></td>
<td>
<p>number, the minimal slope, typically negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b, b.c</code></td>
<td>
<p>number, specifying <code class="reqn">b</code> or <code class="reqn">b/c</code> for <code>"ggw"</code>
or <code>"lqq"</code> respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eff</code></td>
<td>
<p>a number (or <code>NA</code>), the desired
<em>efficiency</em>, in <code class="reqn">[0,1]</code> of the estimator.  If <code>NA</code>,
<code>bp</code> must be specified as valid number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bp</code></td>
<td>
<p>a number (or <code>NA</code>), the desired
<em><b>b</b>reakdown <b>p</b>oint</em> of the estimator, in <code class="reqn">[0,1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>for finding <code class="reqn">c</code> via <code>uniroot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdivisions</code></td>
<td>
<p>passed to <code>integrate()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol, abs.tol</code></td>
<td>
<p>relative and absolute tolerance for
<code>integrate()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>relative tolerance for <code>uniroot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ms.tol</code></td>
<td>
<p>relative tolerance for the internal
<code>.psi.ggw.finda()</code>, eventually passed to <code>optimize</code>
inside (internal) <code>.psi.ggw.mxs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximal number of iterations for
<code>uniroot()</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p>(for <code>.psi.const()</code>:) numeric vector of length 4,
containing all constants <code>c(ms, b*, eff, bp)</code>, where
<code>b* = b</code>   for <code>"ggw"</code> and
<code>b* = b.c</code> for <code>"lqq"</code>, and one of <code>(eff, bp)</code>
is <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>a string, either <code>"ggw"</code> or <code>"lqq"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For some important special cases, the result of <code>.psi.*.findc()</code>
are stored precomputed for efficiency reasons.  These cases are (the
defaults for <code>tuning.chi</code> and <code>tuning.psi</code> respectively in
<code>lmrob.control()</code>s result,
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>tuning.chi</code>               </td>
<td style="text-align: left;">
<code>tuning.psi</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>c(-0.5, 1.5, NA, 0.5)</code>    </td>
<td style="text-align: left;">
<code>c(-0.5, 1.5, 0.95, NA)</code>
  </td>
</tr>
</table>
<p>and for <code>"ggw"</code> additionally, these four cases:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>tuning.chi</code>               </td>
<td style="text-align: left;">
<code>tuning.psi</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                                  </td>
<td style="text-align: left;">
<code>c(-0.5, 1.5, 0.85, NA)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>c(-0.5, 1,   NA,  0.5)</code>   </td>
<td style="text-align: left;">
<code>c(-0.5, 1,   0.95, NA)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                                  </td>
<td style="text-align: left;">
<code>c(-0.5, 1,   0.85, NA)</code>
  </td>
</tr>
</table>
<p>Note that for <code>"ggw"</code>, exactly these <code class="reqn">2+4 = 6</code> cases also
allow fast <code class="reqn">\rho</code> and <code class="reqn">\chi</code> (aka
<code class="reqn">\tilde\rho(\cdot)</code>, see <code>Mchi</code>),
function evaluations.  For all other tuning constant settings, rho()
evaluations are based on numerical integration via <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s own
<code>Rdqags()</code> C function (part of R's official API).
</p>


<h3>Value</h3>

<p>a <code>numeric</code> vector of constants, for <code>"lqq"</code> or
<code>"ggw"</code> psi functions, respectively:
</p>

<dl>
<dt>
<code>"lqq"</code>:</dt>
<dd>
<p><code class="reqn">(b, c, s) = (b/c * c, c, s = 1 - min_slope)</code>,</p>
</dd>
<dt>
<code>"ggw"</code>:</dt>
<dd>
<p><code class="reqn">(0, a, b, c, \rho(\infty))</code>.</p>
</dd>
</dl>
<p><code>.psi.const(cc, psi)</code> returns the argument <code>cc</code> with the
above constant vectors as attribute <code>"constants"</code>, in the case of
<code>psi = "lqq"</code> in all cases (since <span class="pkg">robustbase</span> version &gt;=
0.93), for <code>psi = "ggw"</code> only in the non-standard cases.
</p>


<h3>Author(s)</h3>

<p>Manuel Koller (original) and Martin Maechler (arguments, export, docs).
</p>


<h3>References</h3>

<p>See the vignette about  
“<code class="reqn">\psi</code>-Functions Available in Robustbase”.
</p>


<h3>See Also</h3>

<p><code>Mpsi()</code> etc for the psi function definitions;
<code>.Mpsi.tuning.defaults</code>, etc, for tuning constants'
defaults for <code>lmrob()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">(c.ge95 &lt;- .psi.ggw.findc(ms = -0.5, b = 1.5, eff = 0.95))
(c.ge90 &lt;- .psi.ggw.findc(ms = -0.5, b = 1.5, eff = 0.90))
(c.gb50 &lt;- .psi.ggw.findc(ms = -0.5, b = 1.5,  bp = 0.50))
stopifnot(all.equal(c.ge95, c(0, 1.386362,   1.5, 1.0628199,  4.7773893), tol = 1e-5),
          all.equal(c.ge90, c(0, 1.0282811,  1.5, 0.87086259, 3.2075233), tol = 1e-5),
          all.equal(c.gb50, c(0, 0.20367394, 1.5, 0.29591308, 0.37033962),tol = 1e-5))

(cl.e.95 &lt;- .psi.lqq.findc(ms = -0.5, b.c = 1.5, eff = .95))
(cl.b.50 &lt;- .psi.lqq.findc(ms = -0.5, b.c = 1.5,  bp = .50))
stopifnot(all.equal(cl.e.95, c(1.4734061,  0.98227073, 1.5), tol = 1e-5),
          all.equal(cl.b.50, c(0.40154568, 0.26769712, 1.5), tol = 1e-5))
</code></pre>


</div>