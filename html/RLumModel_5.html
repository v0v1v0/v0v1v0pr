<div class="container">

<table style="width: 100%;"><tr>
<td>model_LuminescenceSignals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model Luminescence Signals</h2>

<h3>Description</h3>

<p>This function models luminescence signals for quartz based on published physical models.
It is possible to simulate TL, (CW-) OSL, RF measurements in a arbitrary sequence. This
sequence is defined as a list of certain aberrations. Furthermore it is possible to
load a sequence direct from the Risø Sequence Editor. The output is an Luminescence::RLum.Analysis object and so the plots are done by the Luminescence::plot_RLum.Analysis function.
If a SAR sequence is simulated the plot output can be disabled and SAR analyse functions
can be used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_LuminescenceSignals(
  model,
  sequence,
  lab.dose_rate = 1,
  simulate_sample_history = FALSE,
  plot = TRUE,
  verbose = TRUE,
  show_structure = FALSE,
  own_parameters = NULL,
  own_state_parameters = NULL,
  own_start_temperature = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>character (<strong>required</strong>): set model to be used. Available models are:
<code>"Bailey2001"</code>, <code>"Bailey2002"</code>, <code>"Bailey2004"</code>, <code>"Pagonis2007"</code>, <code>"Pagonis2008"</code>, <code>"Friedrich2017"</code>, <code>"Friedrich2018"</code>, <code style="white-space: pre;">⁠"Peng2022⁠</code>" and for own models <code>"customized"</code> (or <code>"customised"</code>).
Note: When model = <code>"customized"</code>/<code style="white-space: pre;">⁠"customised⁠</code> is set, the argument <code>own_parameters</code> has to be set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequence</code></td>
<td>
<p>list (<strong>required</strong>): set sequence to model as list or as *.seq file from the
Risø sequence editor. To simulate SAR measurements there is an extra option to set the sequence list (cf. details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.dose_rate</code></td>
<td>
<p>numeric (<em>with default</em>): laboratory dose rate in XXX
Gy/s for calculating seconds into Gray in the *.seq file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate_sample_history</code></td>
<td>
<p>logical (with default): <code>FALSE</code> (with default):
simulation begins at laboratory conditions, <code>TRUE</code>: simulations begins at crystallization process (all levels 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical (with default): Enables or disables plot output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical (with default): Verbose mode on/off</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_structure</code></td>
<td>
<p>logical (with default): Shows the structure of the result.
Recommended to show <code>record.id</code> to analyse concentrations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>own_parameters</code></td>
<td>
<p>list (with default): This argument allows the user to submit own parameter sets. See details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>own_state_parameters</code></td>
<td>
<p>numeric (with default): Some publications (e.g., Pagonis 2009)
offer state parameters. With this argument the user can submit this state parameters. For further details
see vignette "RLumModel - Using own parameter sets" and example 3. The parameter also accepts an
Luminescence::RLum.Results object created by .set_pars as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>own_start_temperature</code></td>
<td>
<p>numeric (with default): Parameter to control the start temperature (in ºC) of
a simulation. This parameter takes effect only when 'model = "customized"' is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments and graphical parameters passed to
plot.default. See details for further information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Defining a <code>sequence</code>
</p>

<table>
<tr>
<td style="text-align: left;">
<b>Arguments</b> </td>
<td style="text-align: left;"> <b>Description</b> </td>
<td style="text-align: left;"> <b>Sub-arguments</b>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>TL</code> </td>
<td style="text-align: left;"> thermally stimulated luminescence </td>
<td style="text-align: left;"> 'temp begin' (ºC), 'temp end' (ºC), 'heating rate' (ºC/s)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>OSL</code>
</td>
<td style="text-align: left;"> optically stimulated luminescence </td>
<td style="text-align: left;"> 'temp' (ºC), 'duration' (s), 'optical_power' (%)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>ILL</code>
</td>
<td style="text-align: left;"> illumination </td>
<td style="text-align: left;"> 'temp' (ºC), 'duration' (s), 'optical_power' (%)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>LM_OSL</code>
</td>
<td style="text-align: left;"> linear modulated OSL </td>
<td style="text-align: left;"> 'temp' (ºC), 'duration' (s), optional: 'start_power' (%), 'end_power' (%)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>RL/RF</code>
</td>
<td style="text-align: left;"> radioluminescence</td>
<td style="text-align: left;"> 'temp' (ºC), 'dose' (Gy), 'dose_rate' (Gy/s) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>RF_heating</code>
</td>
<td style="text-align: left;"> RF during heating/cooling</td>
<td style="text-align: left;"> 'temp begin' (ºC), 'temp end' (ºC), 'heating rate' (ºC/s], 'dose_rate' (Gy/s) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>IRR</code>
</td>
<td style="text-align: left;"> irradiation </td>
<td style="text-align: left;"> 'temp' (ºC), 'dose' (Gy), 'dose_rate' (Gy/s) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>CH</code> </td>
<td style="text-align: left;"> cutheat </td>
<td style="text-align: left;"> 'temp' (ºC), optional: 'duration' (s), 'heating_rate' (ºC/s)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>PH</code>  </td>
<td style="text-align: left;"> preheat </td>
<td style="text-align: left;"> 'temp' (ºC), 'duration' (s), optional: 'heating_rate' (ºC/s)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>PAUSE</code> </td>
<td style="text-align: left;"> pause </td>
<td style="text-align: left;"> 'temp' (ºC), 'duration' (s)
</td>
</tr>
</table>
<p><em>Note: 100% illumination power equates to 20 mW/cm^2</em>
</p>
<p><strong>Own parameters</strong>
</p>
<p>The list has to contain the following items:
</p>

<ul>
<li>
<p>N: Concentration of electron- and hole traps (cm^(-3))
</p>
</li>
<li>
<p>E: Electron/Hole trap depth (eV)
</p>
</li>
<li>
<p>s: Frequency factor (s^(-1))
</p>
</li>
<li>
<p>A: Conduction band to electron trap and valence band to hole trap transition probability (s^(-1) * cm^(3)).
<strong>CAUTION: Not every publication uses
the same definition of parameter A and B! See vignette "RLumModel - Usage with own parameter sets" for further details</strong>
</p>
</li>
<li>
<p>B: Conduction band to hole centre transition probability (s^(-1) * cm^(3)).
</p>
</li>
<li>
<p>Th: Photo-eviction constant or photoionisation cross section, respectively
</p>
</li>
<li>
<p>E_th: Thermal assistence energy (eV)
</p>
</li>
<li>
<p>k_B: Boltzman constant 8.617e-05 (eV/K)
</p>
</li>
<li>
<p>W: activation energy 0.64 (eV) (for UV)
</p>
</li>
<li>
<p>K: 2.8e7 (dimensionless constant)
</p>
</li>
<li>
<p>model: <code>"customized"</code>
</p>
</li>
<li>
<p>R (optional): Ionisation rate (pair production rate) equivalent to 1 Gy/s (s^(-1)) * cm^(-3))
</p>
</li>
</ul>
<p>For further details see Bailey 2001, Wintle 1975, vignette "RLumModel - Using own parameter sets"
and example 3.
</p>
<p><strong>Defining a SAR-sequence</strong><br></p>

<table>
<tr>
<td style="text-align: left;">
<b>Abrivation</b> </td>
<td style="text-align: left;"> <b>Description</b> </td>
<td style="text-align: left;"> <b>examples</b> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>RegDose</code> </td>
<td style="text-align: left;"> Dose points of the regenerative cycles (Gy)</td>
<td style="text-align: left;"> c(0, 80, 140, 260, 320, 0, 80)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>TestDose</code>
</td>
<td style="text-align: left;"> Test dose for the SAR cycles  (Gy)</td>
<td style="text-align: left;"> 50 </td>
</tr>
<tr>
<td style="text-align: left;">
<code>PH</code>
</td>
<td style="text-align: left;"> Temperature of the preheat (ºC)</td>
<td style="text-align: left;"> 240 </td>
</tr>
<tr>
<td style="text-align: left;">
<code>CH</code>
</td>
<td style="text-align: left;"> Temperature of the cutheat (ºC)</td>
<td style="text-align: left;"> 200 </td>
</tr>
<tr>
<td style="text-align: left;">
<code>OSL_temp</code>
</td>
<td style="text-align: left;"> Temperature of OSL read out (ºC)</td>
<td style="text-align: left;">  125 </td>
</tr>
<tr>
<td style="text-align: left;">
<code>OSL_duration</code>
</td>
<td style="text-align: left;">  Duration of OSL read out (s)</td>
<td style="text-align: left;"> default: 40 </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Irr_temp</code> </td>
<td style="text-align: left;"> Temperature of irradiation (ºC)</td>
<td style="text-align: left;"> default: 20</td>
</tr>
<tr>
<td style="text-align: left;">
<code>PH_duration</code>  </td>
<td style="text-align: left;"> Duration of the preheat (s)</td>
<td style="text-align: left;"> default: 10 </td>
</tr>
<tr>
<td style="text-align: left;">
<code>dose_rate</code> </td>
<td style="text-align: left;"> Dose rate of the laboratory irradiation source (Gy/s)</td>
<td style="text-align: left;"> default: 1 </td>
</tr>
<tr>
<td style="text-align: left;">
<code>optical_power</code> </td>
<td style="text-align: left;"> Percentage of the full illumination power (%)</td>
<td style="text-align: left;"> default: 90 </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Irr_2recover</code> </td>
<td style="text-align: left;"> Dose to be recovered in a dose-recovery-test (Gy)</td>
<td style="text-align: left;"> 20
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns an Luminescence::RLum.Analysis object with all TL, (LM-) OSL and RF/RL steps
in the sequence. Every entry is an Luminescence::RLum.Data.Curve object and can be plotted, analysed etc. with
further <code>RLum</code>-functions.
</p>


<h3>Function version</h3>

<p>0.1.6
</p>


<h3>How to cite</h3>

<p>Friedrich, J., Kreutzer, S., 2022. model_LuminescenceSignals(): Model Luminescence Signals. Function version 0.1.6. In: Friedrich, J., Kreutzer, S., Schmidt, C., 2022. RLumModel: Solving Ordinary Differential Equations to Understand Luminescence. R package version 0.2.10. https://CRAN.R-project.org/package=RLumModel
</p>


<h3>Author(s)</h3>

<p>Johannes Friedrich, University of Bayreuth (Germany),
Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)
</p>


<h3>References</h3>

<p>Bailey, R.M., 2001. Towards a general kinetic model for optically and thermally stimulated
luminescence of quartz. Radiation Measurements 33, 17-45.
</p>
<p>Bailey, R.M., 2002. Simulations of variability in the luminescence characteristics of natural
quartz and its implications for estimates of absorbed dose.
Radiation Protection Dosimetry 100, 33-38.
</p>
<p>Bailey, R.M., 2004. Paper I-simulation of dose absorption in quartz over geological timescales
and it simplications for the precision and accuracy of optical dating.
Radiation Measurements 38, 299-310.
</p>
<p>Friedrich, J., Kreutzer, S., Schmidt, C., 2016. Solving ordinary differential equations to understand luminescence:
'RLumModel', an advanced research tool for simulating luminescence in quartz using R. Quaternary Geochronology 35, 88-100.
</p>
<p>Friedrich, J., Pagonis, V., Chen, R., Kreutzer, S., Schmidt, C., 2017: Quartz radiofluorescence: a modelling approach.
Journal of Luminescence 186, 318-325.
</p>
<p>Pagonis, V., Chen, R., Wintle, A.G., 2007: Modelling thermal transfer in optically
stimulated luminescence of quartz. Journal of Physics D: Applied Physics 40, 998-1006.
</p>
<p>Pagonis, V., Wintle, A.G., Chen, R., Wang, X.L., 2008. A theoretical model for a new dating protocol
for quartz based on thermally transferred OSL (TT-OSL).
Radiation Measurements 43, 704-708.
</p>
<p>Pagonis, V., Lawless, J., Chen, R., Anderson, C., 2009. Radioluminescence in Al2O3:C - analytical and numerical
simulation results. Journal of Physics D: Applied Physics 42, 175107 (9pp).
</p>
<p>Peng, J., Wang, X., Adamiec, G., 2022. The build-up of the laboratory-generated dose-response curve and
underestimation of equivalent dose for quartz OSL in the high dose region: A critical modelling study.
Quaternary Geochronology 67, 101231.
</p>
<p>Soetaert, K., Cash, J., Mazzia, F., 2012. Solving differential equations in R.
Springer Science &amp; Business Media.
</p>
<p>Wintle, A., 1975. Thermal Quenching of Thermoluminescence in Quartz. Geophysical Journal International 41, 107-113.
</p>


<h3>See Also</h3>

<p>plot, Luminescence::RLum,
read_SEQ2R
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##================================================================##
## Example 1: Simulate Bailey2001
## (cf. Bailey, 2001, Fig. 1)
##================================================================##

##set sequence with the following steps
## (1) Irradiation at 20 deg. C with a dose of 10 Gy and a dose rate of 1 Gy/s
## (2) TL from 20-400 deg. C with a rate of 5 K/s

sequence &lt;-
  list(
    IRR = c(20, 10, 1),
    TL = c(20, 400, 5)
  )

##model sequence
model.output &lt;- model_LuminescenceSignals(
  sequence = sequence,
  model = "Bailey2001"
)

##get all TL concentrations

TL_conc &lt;- get_RLum(model.output, recordType = "(TL)", drop = FALSE)

plot_RLum(TL_conc)

##plot 110 deg. C trap concentration

TL_110 &lt;- get_RLum(TL_conc, recordType = "conc. level 1")
plot_RLum(TL_110)

##============================================================================##
## Example 2: compare different optical powers of stimulation light
##============================================================================##

# call function "model_LuminescenceSignals", model = "Bailey2004"
# and simulate_sample_history = FALSE (default),
# because the sample history is not part of the sequence
# the optical_power of the LED is varied and then compared.

optical_power &lt;- seq(from = 0,to = 100,by = 20)

model.output &lt;- lapply(optical_power, function(x){

 sequence &lt;- list(IRR = c(20, 50, 1),
                  PH = c(220, 10, 5),
                  OSL = c(125, 50, x)
                  )

 data &lt;- model_LuminescenceSignals(
           sequence = sequence,
           model = "Bailey2004",
           plot = FALSE,
           verbose = FALSE
           )

 return(get_RLum(data, recordType = "OSL$", drop = FALSE))
})

##combine output curves
model.output.merged &lt;- merge_RLum(model.output)

##plot
plot_RLum(
 object = model.output.merged,
 xlab = "Illumination time (s)",
 ylab = "OSL signal (a.u.)",
 main = "OSL signal dependency on optical power of stimulation light",
 legend.text = paste("Optical power density", 20*optical_power/100, "mW/cm^2"),
 combine = TRUE)

##============================================================================##
## Example 3: Usage of own parameter sets (Pagonis 2009)
##============================================================================##

own_parameters &lt;- list(
  N = c(2e15, 2e15, 1e17, 2.4e16),
  E = c(0, 0, 0, 0),
  s = c(0, 0, 0, 0),
  A = c(2e-8, 2e-9, 4e-9, 1e-8),
  B = c(0, 0, 5e-11, 4e-8),
  Th = c(0, 0),
  E_th = c(0, 0),
  k_B = 8.617e-5,
  W = 0.64,
  K = 2.8e7,
  model = "customized",
  R = 1.7e15
 )
 ## Note: In Pagonis 2009 is B the valence band to hole centre probability,
 ## but in Bailey 2001 this is A_j. So the values of B (in Pagonis 2009)
 ## are A in the notation above. Also notice that the first two entries in N, A and
 ## B belong to the electron traps and the last two entries to the hole centres.

 own_state_parameters &lt;- c(0, 0, 0, 9.4e15)

 ## calculate Fig. 3 in Pagonis 2009. Note: The labels for the dose rate in the original
 ## publication are not correct.
 ## For a dose rate of 0.1 Gy/s belongs a RF signal to ~ 1.5e14 (see Fig. 6).

 sequence &lt;- list(RF = c(20, 0.1, 0.1))

 model_LuminescenceSignals(
   model = "customized",
   sequence = sequence,
   own_parameters = own_parameters,
   own_state_parameters = own_state_parameters)




## Not run: 
##============================================================================##
## Example 4: Simulate Thermal-Activation-Characteristics (TAC)
##============================================================================##

 ##set temperature
 act.temp &lt;- seq(from = 80, to = 600, by = 20)

 ##loop over temperature
 model.output &lt;- vapply(X = act.temp, FUN = function(x) {

 ##set sequence, note: sequence includes sample history
   sequence &lt;- list(
     IRR = c(20, 1, 1e-11),
     IRR = c(20, 10, 1),
     PH = c(x, 1),
     IRR = c(20, 0.1, 1),
     TL = c(20, 150, 5)
 )
 ##run simulation
   temp &lt;- model_LuminescenceSignals(
     sequence = sequence,
     model = "Pagonis2007",
     simulate_sample_history = TRUE,
     plot = FALSE,
     verbose = FALSE
   )
     ## "TL$" for exact matching TL and not (TL)
   TL_curve &lt;- get_RLum(temp, recordType = "TL$")
   ##return max value in TL curve
   return(max(get_RLum(TL_curve)[,2]))
 }, FUN.VALUE = 1)

 ##plot resutls
 plot(
   act.temp[-(1:3)],
   model.output[-(1:3)],
   type = "b",
   xlab = "Temperature [\u00B0C)",
   ylab = "TL [a.u.]"
 )

##============================================================================##
## Example 5: Simulate SAR sequence
##============================================================================##

##set SAR sequence with the following steps
## (1) RegDose: set regenerative dose (Gy) as vector
## (2) TestDose: set test dose (Gy)
## (3) PH: set preheat temperature in deg. C
## (4) CH: Set cutheat temperature in deg. C
## (5) OSL_temp: set OSL reading temperature in deg. C
## (6) OSL_duration: set OSL reading duration in s

sequence &lt;- list(
 RegDose = c(0,10,20,50,90,0,10),
 TestDose = 5,
 PH = 240,
 CH = 200,
 OSL_temp = 125,
 OSL_duration = 70)

# call function "model_LuminescenceSignals", set sequence = sequence,
# model = "Pagonis2007" (palaeodose = 20 Gy) and simulate_sample_history = FALSE (default),
# because the sample history is not part of the sequence

 model.output &lt;- model_LuminescenceSignals(
   sequence = sequence,
   model = "Pagonis2007",
   plot = FALSE
 )

# in environment is a new object "model.output" with the results of
# every step of the given sequence.
# Plots are done at OSL and TL steps and the growth curve

# call "analyse_SAR.CWOSL" from RLum package
 results &lt;- analyse_SAR.CWOSL(model.output,
                            signal.integral.min = 1,
                            signal.integral.max = 15,
                            background.integral.min = 601,
                            background.integral.max = 701,
                            fit.method = "EXP",
                            dose.points = c(0,10,20,50,90,0,10))


##============================================================================##
## Example 6: generate sequence from *.seq file and run SAR simulation
##============================================================================##

# load example *.SEQ file and construct a sequence.
# call function "model_LuminescenceSignals", load created sequence for sequence,
# set model = "Bailey2002" (palaeodose = 10 Gy)
# and simulate_sample_history = FALSE (default),
# because the sample history is not part of the sequence

path &lt;- system.file("extdata", "example_SAR_cycle.SEQ", package="RLumModel")

sequence &lt;- read_SEQ2R(file = path)

model.output &lt;- model_LuminescenceSignals(
  sequence = sequence,
  model = "Bailey2001",
  plot = FALSE
)


## call RLum package function "analyse_SAR.CWOSL" to analyse the simulated SAR cycle

results &lt;- analyse_SAR.CWOSL(model.output,
                             signal.integral.min = 1,
                             signal.integral.max = 10,
                             background.integral.min = 301,
                             background.integral.max = 401,
                             dose.points = c(0,8,14,26,32,0,8),
                             fit.method = "EXP")

print(get_RLum(results))


##============================================================================##
## Example 7: Simulate sequence at laboratory without sample history
##============================================================================##

##set sequence with the following steps
## (1) Irraditation at 20 deg. C with a dose of 100 Gy and a dose rate of 1 Gy/s
## (2) Preheat to 200 deg. C and hold for 10 s
## (3) LM-OSL at 125 deg. C. for 100 s
## (4) Cutheat at 200 dec. C.
## (5) Irraditation at 20 deg. C with a dose of 10 Gy and a dose rate of 1 Gy/s
## (6) Pause at 200 de. C. for 100 s
## (7) OSL at 125 deg. C for 100 s with 90 % optical power
## (8) Pause at 200 deg. C for 100 s
## (9) TL from 20-400 deg. C with a heat rate of 5 K/s
## (10) Radiofluorescence at 20 deg. C with a dose of 200 Gy and a dose rate of 0.01 Gy/s

sequence &lt;-
 list(
   IRR = c(20, 100, 1),
   PH = c(200, 10),
   LM_OSL = c(125, 100),
   CH = c(200),
   IRR = c(20, 10, 1),
   PAUSE = c(200, 100),
   OSL = c(125, 100, 90),
   PAUSE = c(200, 100),
   TL = c(20, 400, 5),
   RF = c(20, 200, 0.01)
)

# call function "model_LuminescenceSignals", set sequence = sequence,
# model = "Pagonis2008" (palaeodose = 200 Gy) and simulate_sample_history = FALSE (default),
# because the sample history is not part of the sequence

model.output &lt;- model_LuminescenceSignals(
   sequence = sequence,
   model = "Pagonis2008"
   )


## End(Not run)
</code></pre>


</div>