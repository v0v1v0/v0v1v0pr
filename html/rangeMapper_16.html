<div class="container">

<table style="width: 100%;"><tr>
<td>rmap_prepare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Define a canvas and process ranges</h2>

<h3>Description</h3>

<p><code>rmap_prepare</code> updates a 'raw' unprepared project to a ready to use project.
<code>rmap_prepare</code> creates the project's canvas and assign each range to its corresponding canvas cells by
performing a spatial intersection between the ranges and the canvas. The canvas is a regular grid
of squares or hexagons.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmap_prepare(con, grid_type, cellsize, chunksize, ...)

## S4 method for signature 'rmapConnection,character,numeric,missing'
rmap_prepare(con, grid_type, cellsize, chunksize, ...)

## S4 method for signature 'rmapConnection,character,numeric,numeric'
rmap_prepare(con, grid_type = "hex", cellsize, chunksize = 1/10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>con</code></td>
<td>
<p>a <code>rangeMapper</code> connection made with  <code>rmap_connect()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_type</code></td>
<td>
<p>character "hex" (default) or "square", see <code>sf::st_make_grid()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellsize</code></td>
<td>
<p>target cellsize, see <code>sf::st_make_grid()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chunksize</code></td>
<td>
<p>parallel processing chunk size expressed as proportion from the range size. Default to 1/10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>sf::st_make_grid()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Because <code>rmap_prepare</code> can be potentially time consuming it can be run in parallel using the
support provided by the <code>future</code> package.
<code>future</code> allows parallel processing on a variety of systems including high performance computing environments.
For details see <code>future::plan()</code>.
Additionally, you can keep track of of the computations using <code>progressr::handlers()</code>.
</p>


<h3>Value</h3>

<p>TRUE when the table is written to the project file, FALSE otherwise.
</p>


<h3>References</h3>

<p>Birch, C. P., Oom, S. P., &amp; Beecham, J. A. (2007). Rectangular and hexagonal grids used for observation,
experiment and simulation in ecology. Ecological modelling, 206(3-4), 347-359.
</p>


<h3>See Also</h3>

<p><code>rmap_add_ranges()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# IN-MEMORY PROJECT
require(rangeMapper)
wrens = read_wrens()
con = rmap_connect() 
rmap_add_ranges(con, wrens, 'sci_name')
rmap_prepare(con, 'hex', cellsize=500)
dbDisconnect(con)

## Not run: 

# PROJECT PREPARED IN PARALLEL

require(future) 
require(progressr)
plan(multisession, workers = 2)
handlers(global = TRUE)

Path = tempfile() 
con = rmap_connect(Path)
rmap_add_ranges(con, wrens, 'sci_name')

rmap_prepare(con, 'hex', cellsize=200, chunksize = 0.1)

dbDisconnect(con)
plan(sequential)

## End(Not run)

</code></pre>


</div>