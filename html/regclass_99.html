<div class="container">

<table style="width: 100%;"><tr>
<td>suggest_levels</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Combining levels of a categorical variable
</h2>

<h3>Description</h3>

<p>This function determines levels that are similar to each other either in terms of their average value of some quantitative variable or the percentages of each level of a two-level categorical variable.  Use it to get a rough idea of what levels are "about the same" with regard to some variable.</p>


<h3>Usage</h3>

<pre><code class="language-R">suggest_levels(formula,data,maxlevels=NA,target=NA,recode=FALSE,plot=TRUE,...) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>A standard R formula written as y~x.  Here, x is the variable whose levels you wish to combine, and y is the quantitative or two-level categorical variable.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>An optional argument giving the name of the data frame that contains x and y.  If not specified, the function will use existing definitions in the parent environment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlevels</code></td>
<td>

<p>The maximum number of combined levels to consider (cannot exceed 26).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>

<p>The number of resulting levels into which the levels of x will be combined.  Will default to the suggested value of the fewest number whose resulting BIC is no more than 4 above the lowest BIC of any combination.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recode</code></td>
<td>

<p><code>TRUE</code> or <code>FALSE</code>.  If <code>TRUE</code>, the function outputs a conversion table as well as the new level identities
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p><code>TRUE</code> or <code>FALSE</code>.  If <code>TRUE</code>, a plot is provided which shows the distribution of <code>y</code> for each level of <code>x</code> and lines showing which levels are grouped together.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments used to make the plot.  Typically this will be <code>equal=TRUE</code> and <code>inside=TRUE</code> to be passed to <code>mosaic</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the average value (or percentage of each level) of y for each level of x.  It then builds a partition model taking y to be this average value (or percentage) with x being the predictor variable.  The first split yields the "best" scheme for combining levels of x into 2 values.  The second split yields the "best" scheme for combining levels of x into 3 values, etc.  
</p>
<p>The argument <code>maxlevels</code> specifies the maximum numbers of levels in the combination scheme.  By default, it will use the number of levels of x (ie, no combination).  Setting this to a lower number saves time, since most likely a small number of combined levels is desired.  This is useful for seeing how different combination schemes compare.
</p>
<p>The argument <code>target</code> will force the algorithm to producing exactly this number of combined levels.  This is useful once you have determined how many levels of x you want.
</p>
<p>If <code>recode</code> is <code>FALSE</code>, a table showing the combined levels along with the "BIC" of the combination scheme (lower is better, but a difference of around 4 or less is negligible).  The suggested combination will be the fewer number of levels which has as BIC no more than 4 above the scheme that gave the lowest BIC.  
</p>
<p>If <code>recode</code> is <code>TRUE</code>, a list of three elements is produced.  <code>$Conversion1</code> gives a table of the Old and New levels alphabetized by Old while <code>$Conversion2</code> gives a table of the Old and New levels alphabized by New.  <code>$newlevels</code> gives a factor of the cases levels under the new combination scheme.  If <code>target</code> is not set, it will use the suggested number of levels.
</p>


<h3>Author(s)</h3>

<p>Adam Petrie
</p>


<h3>References</h3>

<p>Introduction to Regression and Modeling
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
 
  data(DONOR)
  
  #Can levels of URBANICITY be treated the same with regards to probability of donation?
  #Analysis suggests yes (all levels in one)
  suggest_levels(Donate~URBANICITY,data=DONOR)

  #Can levels of URBANICITY be treated the same with regards to donation amount?
  #Analysis suggests yes, but perhaps there are four "effective levels"
  
  suggest_levels(Donation.Amount~URBANICITY,data=DONOR)
  SL &lt;- suggest_levels(Donation.Amount~URBANICITY,data=DONOR,target=4,recode=TRUE)
	SL$Conversion

	#Add a column to the DONOR dataframe that contains these new cluster identities
  DONOR$newCLUSTER_CODE &lt;- SL$newlevels
	 </code></pre>


</div>