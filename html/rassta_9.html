<div class="container">

<table style="width: 100%;"><tr>
<td>signature</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the Spatial Signature of Classification Units</h2>

<h3>Description</h3>

<p>Using a mathematical function, a raster layer is created from the cell-wise
aggregation of a set of predicted distribution functions for a classification
unit (see <code>predict_functions</code>). Each element in this set can be
thought of as a correspondence measurement between an <em>XY</em> location in
the geographic space and the landscape configuration represented by a given
classification unit in terms of a specific variable. Therefore, aggregating
the set of predicted distribution functions into a single layer produces an
overall (multivariate) measurement of correspondence. This multivariate
landscape correspondence metric is considered to be the <em>spatial
signature</em> of the classification unit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">signature(
  pdif.rast,
  inprex,
  outname,
  fun = mean,
  to.disk = FALSE,
  outdir = ".",
  extension = ".tif",
  overwrite = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdif.rast</code></td>
<td>
<p>SpatRaster, as in <code>rast</code>. Multi-layer
SpatRaster whose raster layers represent predicted distribution functions
for continuous variables and for one or more classification units. All
predicted distribution functions for a particular classification unit are
considered as part of the same set. There must be a matching pattern in the
names of predicted distribution functions from the same set (see
<em>inprex</em>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inprex</code></td>
<td>
<p>Character. Prefix in the name of raster layers representing
predicted distribution functions belonging to the same set (i.e.,same
classification unit). If spatial signatures for multiple sets are to be
calculated, a vector of strings must be provided. See <strong>Details</strong> and
<strong>Examples</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outname</code></td>
<td>
<p>Character. Output layer/file name for the raster layer(s) of
spatial signature. If the spatial signatures for multiple classification
units are to be calculated, then a vector of strings must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>Function. The mathematical function must take a vector of values
and return a single value (e.g., mean, max, sum, etc.). See
<code>app</code>. Default: mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to.disk</code></td>
<td>
<p>Boolean. Write the output raster layer(s) of spatial signature
to disk? See details about parallel processing. Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outdir</code></td>
<td>
<p>Character. If <em>to.disk = TRUE</em>, string specifying the path
for the output  raster layer(s) of spatial signature. Default: "."</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extension</code></td>
<td>
<p>Character. If <em>to.disk = TRUE</em>, String specifying the
extension for the output raster layer(s) of spatial signature. Default:
".tif"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Boolean. If <em>to.disk = TRUE</em>, should raster layers in
disk and with same name as the output raster layer(s) of spatial signature
be overwritten? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>If <em>to.disk = TRUE</em>, additional arguments as for
<code>writeRaster</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Raster layers of predicted distribution functions belonging to the same
classification unit must be identified by a unique prefix in their layer
names (argument <em>inprex</em>). This prefix is used as a string pattern to
find all the predicted distribution functions belonging to one classification
unit. Consequently, a unique prefix must be defined for each additional
classification unit to distinguish between predicted distribution functions
for different classification units. Similarly, an additional string (or
vector of strings) of file/layer name(s) must be provided to distinguish
between the resulting spatial signatures for different classification units
(argument <em>outname</em>). The length of <em>outname</em> must match that from
<em>inprex</em>.
</p>
<p>When writing the output raster layers of spatial signature to disk, a
parallel backend can be registered before running this function with
<code>registerDoParallel</code> to speed-up computation. Note
that this is only helpful when calculating spatial signatures for many
classification units.
</p>
<p>From a spatial analysis standpoint, the aggregation of predicted distribution
functions into spatial signature is similar to the application of fuzzy
aggregation operators commonly used in GIS-based multi-criteria decision
analysis. Moreover, The use of descriptive statistics to calculate
<em>signatures</em> for landscape-related classification units can be traced
back to the works of Pike and Rozema (1975), and Pike (1988).
</p>


<h3>Value</h3>

<p>Single-layer or multi-layer SpatRaster with the spatial signature(s)
calculated from the set(s) of predicted distribution functions.
</p>


<h3>References</h3>

<p>R. Pike. The geometric signature: quantifying landslide-terrain types from
digital elevation models. Mathematical geology, 20(5):491–511, 1988.
<a href="https://doi.org/10.1007/BF00890333">doi:10.1007/BF00890333</a>
</p>
<p>R. Pike and W. Rozema. Spectral analysis of landforms. Annals of the
Association of American Geographers,65(4):499–516, 1975.
<a href="https://doi.org/10.1111/j.1467-8306.1975.tb01058.x">doi:10.1111/j.1467-8306.1975.tb01058.x</a>
</p>


<h3>See Also</h3>

<p>Other Landscape Correspondence Metrics: 
<code>predict_functions()</code>,
<code>select_functions()</code>,
<code>similarity()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(terra)
p &lt;- system.file("exdat", package = "rassta")
# Multi-layer SpatRast with predicted distribution functions
## 3 continuous variables and 5 classification units, = 15 functions
ft &lt;- list.files(path = p, pattern = "topo_", full.names = TRUE)
t &lt;- terra::rast(ft)
# Vector with the prefix for each set of predicted distribution functions
## 5 classification units = 5 sets
it &lt;- paste("topo_", seq(1, 5), "_", sep = "")
# Vector of names for output raster layers of spatial signature
## 5 spatial signatures, one per classification unit
ot &lt;- paste("topography_", seq(1, 5), sep = "")
# Calculate spatial signatures
tsig &lt;- signature(pdif.rast = t, inprex = it, outname = ot)
# Plot spatial signatures
if(interactive()){plot(tsig, col = hcl.colors(100, "Oslo", rev = TRUE))}

</code></pre>


</div>