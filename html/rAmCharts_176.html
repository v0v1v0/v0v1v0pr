<div class="container">

<table style="width: 100%;"><tr>
<td>rAmCharts-shinymodules-ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shiny module to render large time-series data with live server-client aggregation</h2>

<h3>Description</h3>

<p>Shiny module to render large time-series data with live server-client aggregation
</p>


<h3>Usage</h3>

<pre><code class="language-R">rAmChartsTimeSeriesUI(id, width = "100%", height = "400px")

rAmChartsTimeSeriesServer(
  input,
  output,
  session,
  data,
  col_date,
  col_series,
  maxPoints = shiny::reactive(600),
  tz = shiny::reactive("UTC"),
  ts = shiny::reactive(c("5 min", "10 min", "30 min", "hour", "3 hour", "12 hour",
    "day", "week", "month", "year")),
  fun_aggr = shiny::reactive("mean"),
  treat_missing = shiny::reactive(FALSE),
  maxgap = shiny::reactive(Inf),
  type_aggr = shiny::reactive("first"),
  na.rm = shiny::reactive(TRUE),
  main = shiny::reactive(""),
  ylab = shiny::reactive(""),
  color = shiny::reactive(c("#2E2EFE", "#31B404", "#FF4000", "#AEB404")),
  type = shiny::reactive(c("line")),
  bullet = shiny::reactive(NULL),
  bulletSize = shiny::reactive(2),
  linetype = shiny::reactive(c(0, 5, 10, 15, 20)),
  linewidth = shiny::reactive(c(1, 1, 1, 1, 1, 1)),
  fillAlphas = shiny::reactive(0),
  precision = shiny::reactive(1),
  connect = shiny::reactive(FALSE),
  export = shiny::reactive(FALSE),
  legend = shiny::reactive(TRUE),
  legendPosition = shiny::reactive("bottom"),
  legendHidden = shiny::reactive(FALSE),
  ZoomButton = shiny::reactive(data.frame(Unit = "MAX", multiple = 1, label = "All")),
  ZoomButtonPosition = shiny::reactive("bottom"),
  periodFieldsSelection = shiny::reactive(FALSE),
  scrollbar = shiny::reactive(TRUE),
  scrollbarPosition = shiny::reactive("bottom"),
  scrollbarHeight = shiny::reactive(40),
  scrollbarGraph = shiny::reactive(NULL),
  cursor = shiny::reactive(TRUE),
  cursorValueBalloonsEnabled = shiny::reactive(TRUE),
  creditsPosition = shiny::reactive("top-right"),
  group = shiny::reactive(NULL),
  dataDateFormat = shiny::reactive("YYYY-MM-DD JJ:NN:ss"),
  categoryBalloonDateFormats = shiny::reactive(list(list(period = "YYYY", format =
    "YYYY"), list(period = "MM", format = "YYYY-MM"), list(period = "WW", format =
    "YYYY-MM-DD"), list(period = "DD", format = "YYYY-MM-DD"), list(period = "hh", format
    = "YYYY-MM-DD JJ:NN"), list(period = "mm", format = "YYYY-MM-DD JJ:NN"), list(period
    = "ss", format = "YYYY-MM-DD JJ:NN:ss"), list(period = "fff", format =
    "YYYY-MM-DD JJ:NN:ss"))),
  dateFormats = shiny::reactive(list(list(period = "YYYY", format = "YYYY"),
    list(period = "MM", format = "MMM"), list(period = "WW", format = "MMM DD"),
    list(period = "DD", format = "MMM DD"), list(period = "hh", format = "JJ:NN"),
    list(period = "mm", format = "JJ:NN"), list(period = "ss", format = "JJ:NN:ss"),
    list(period = "fff", format = "JJ:NN:ss"))),
  thousandsSeparator = shiny::reactive(" "),
  decimalSeparator = shiny::reactive("."),
  balloonFontSize = shiny::reactive(10),
  balloonMaxWidth = shiny::reactive(400)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>character, used to specify namesapce, see <code>shiny::NS</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p><code>character</code>, the width of the chart container. For <code>amChartsOutput</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p><code>character</code>, the height of the chart container. For <code>amChartsOutput</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>standard, <code>shiny</code> input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>standard, <code>shiny</code> output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>session</code></td>
<td>
<p>standard, <code>shiny</code> session</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>: data.frame to transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_date</code></td>
<td>
<p>Date column name, default to "date".
Must be "POSIXct"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_series</code></td>
<td>
<p>Column name of quantitative variable(s) to be
transformed. Default to setdiff(colnames(data), "date")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxPoints</code></td>
<td>
<p>: Maximal number of rows in results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tz</code></td>
<td>
<p>: Timezone of result. Defaut to "UTC".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>All enabled aggregation. Default to c("5 min",  "10 min", "30 min", "hour", "3 hour", "12 hour", "day", "week", "month", "year").
Can be a number, in seconds, or a character string
containing one of "min", "hour", "day"....
This can optionally be preceded by a positive integer
and a space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun_aggr</code></td>
<td>
<p>: Aggregation function to use ("min", "max", "sum", "mean", "first", "last", "minabs", "maxabs").
Default to "mean".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat_missing</code></td>
<td>
<p>: Boolean. Default to FALSE
Whether or not to interpolate missing values ?
see <code>na.approx</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxgap</code></td>
<td>
<p>When interpolate missing values with <code>na.approx</code>.
Maximum number of consecutive NAs to fill. Defaut to Inf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_aggr</code></td>
<td>
<p><code>character</code> Type of aggregation
</p>

<ul>
<li>
<p>"first" : Date/Time result is equal to minimum of sequence, and this minimum is included in aggregation
</p>
</li>
<li>
<p>"last" : Date/Time result is equal to maximum of sequence, and this maximum is included in aggregation
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>: aggregation only. a logical value indicating whether NA values should be stripped before the computation proceeds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p><code>character</code>, title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p><code>character</code>, value axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p><code>character</code>, color of series (in hexadecimal).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>character</code>, Type of graph. Possible values are : "line" (default),
"column", "step", "smoothedLine"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bullet</code></td>
<td>
<p><code>character</code>, point shape. Possible values are : "diamond", "square", 
"bubble",  "yError", "xError", "round", "triangleLeft", "triangleRight", "triangleUp"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bulletSize</code></td>
<td>
<p><code>numeric</code>, size of bullet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linetype</code></td>
<td>
<p><code>numeric</code>, line type, 0 : solid, number : dashed length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linewidth</code></td>
<td>
<p><code>numeric</code>, line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fillAlphas</code></td>
<td>
<p><code>numeric</code>, fill. Between 0 (no fill) to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p><code>numeric</code>, default set to  1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>connect</code></td>
<td>
<p><code>logical</code>, default set to  FALSE. Specifies whether to connect data points if data is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export</code></td>
<td>
<p><code>logical</code>, default set to  FALSE. TRUE to display export feature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p><code>logical</code>, enabled or not legend ? Defaut to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendPosition</code></td>
<td>
<p><code>character</code>, legend position. Possible values are :
"left", "right", "bottom", "top"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendHidden</code></td>
<td>
<p><code>logical</code> hide some series on rendering ? Defaut to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZoomButton</code></td>
<td>
<p><code>data.frame</code>, 3 or 4 columns : 
</p>

<ul>
<li>
<p>"Unit" : Character. Times unit. 'ss', 'mm', 'hh', 'DD', 'MM', 'YYYY'
</p>
</li>
<li>
<p>"multiple" : Numeric. multiple*unit 
</p>
</li>
<li>
<p>"label" : Character. button's label 
</p>
</li>
<li>
<p>"selected" : Boolean. Optional. To set initial selection. (One TRUE, others FALSE)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZoomButtonPosition</code></td>
<td>
<p><code>character</code>, zoom button position. Possible values are :
"left", "right", "bottom", "top"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodFieldsSelection</code></td>
<td>
<p><code>boolean</code>, using zoom button, add also two fields to select period ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scrollbar</code></td>
<td>
<p><code>boolean</code>, enabled or not scrollbar ? Defaut to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scrollbarPosition</code></td>
<td>
<p><code>character</code>, scrollbar position. Possible values are :
"left", "right", "bottom", "top"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scrollbarHeight</code></td>
<td>
<p><code>numeric</code>, height of scroll bar. Default : 40.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scrollbarGraph</code></td>
<td>
<p><code>character</code>, name of serie (column) to print in scrollbar. Defaut to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cursor</code></td>
<td>
<p><code>boolean</code>, enabled or not cursor ? Defaut to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cursorValueBalloonsEnabled</code></td>
<td>
<p><code>boolean</code>, if cursor, enabled or not balloons on cursor ? Defaut to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>creditsPosition</code></td>
<td>
<p><code>character</code>, credits position. Possible values are :
"top-right", "top-left", "bottom-right", "bottom-left"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p><code>character</code>, like in <code>dygraphs</code>, for synchronization in <code>shiny</code> or <code>rmarkdown</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataDateFormat</code></td>
<td>
<p><code>character</code> Data date format. Default to 'YYYY-MM-DD JJ:NN:ss'. See <code>amTimeSeries</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categoryBalloonDateFormats</code></td>
<td>
<p><code>list</code> Date format objects for chart cursor. See <code>amTimeSeries</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dateFormats</code></td>
<td>
<p><code>list</code> Date format objects for x-axis. See <code>amTimeSeries</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thousandsSeparator</code></td>
<td>
<p><code>character</code>, default set to " "</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decimalSeparator</code></td>
<td>
<p><code>character</code>, default set to ".",</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balloonFontSize</code></td>
<td>
<p><code>numeric</code>, text font size on balloon. Default : 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balloonMaxWidth</code></td>
<td>
<p><code>numeric</code>. Default : 400.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a reactive expression with aggregate data and ts
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

library(shiny)
library(rAmCharts)
library(data.table)

# number of points
n &lt;- 1000000
data &lt;- data.frame(date = seq(c(ISOdate(1999,12,31)), by = "5 min", length.out = n),
                          value = rnorm(n, 100, 50), check.names = FALSE)

# maximun of points in javascript
max_points &lt;- 1000

# Call module in UI
ui &lt;- fluidPage(
  rAmChartsTimeSeriesUI("ts_1", height = "600px"),
  h4(textOutput("ts"))
)

# Define server
server &lt;- function(input, output) {
  
  # Call module in server
  res &lt;- callModule(rAmChartsTimeSeriesServer, "ts_1", reactive(data), reactive("date"), 
     reactive("value"), maxPoints = shiny::reactive(max_points),
     main = reactive("Example of rAmChartsTimeSeries module"),
     color = reactive("red"), periodFieldsSelection = reactive(TRUE)
   )
   
  # show module return and print ts
  output$ts &lt;- renderText({
    print(res())
    paste0("Current ts : ", res()$ts)
  })
 
}

# Run the application 
shinyApp(ui = ui, server = server)


## End(Not run)

</code></pre>


</div>