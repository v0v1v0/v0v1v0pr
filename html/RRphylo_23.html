<div class="container">

<table style="width: 100%;"><tr>
<td>move.lineage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Move tips or clades</h2>

<h3>Description</h3>

<p>Move a single tip or an entire clade to a different position
within the tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">move.lineage(tree,focal,sister,rescale=TRUE,rootage=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree. The tree needs not to be ultrametric and
fully dichotomous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focal</code></td>
<td>
<p>the lineage to be moved. It can be either a tip name/number or a
node number. If <code>tree$node.label</code> is not <code>NULL</code>, a <code>focal</code>
clade can be indicated as "Clade NAMEOFTHECLADE" when appropriate.
Similarly, an entire genus can be indicated as "Genus NAMEOFTHEGENUS" (see
examples below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sister</code></td>
<td>
<p>the sister tip/node where the <code>focal</code> must be attached. It
can be tip name/number or node number. If <code>tree$node.label</code> is not
<code>NULL</code>, a <code>focal</code> clade can be indicated as "Clade
NAMEOFTHECLADE" when appropriate. Similarly, an entire genus can be
indicated as "Genus NAMEOFTHEGENUS" (see examples below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>logical. If the most recent common ancestor of the
<code>focal</code> clade is older than its new ancestor (i.e. the node right
above <code>sister</code>), the user can choose whether the height of the
<code>focal</code> clade must be rescaled on the height of the new ancestor
(<code>rescale=TRUE</code>), or the topology of the tree must be modified to
accommodate the height of <code>focal</code> as it is (rescale=FALSE, in this
case <code>scaleTree</code> is applied).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rootage</code></td>
<td>
<p>the age of the tree root to be supplied if <code>focal</code> must
be attached to it. If <code>rootage=NULL</code> the total height of the tree
increases by 10%.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The phylogenetic tree with required topological changes.
</p>


<h3>Author(s)</h3>

<p>Silvia Castiglione, Pasquale Raia
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(phytools)
DataCetaceans$tree-&gt;tree

### Case 1. Moving a single tip
# sister to a tip
move.lineage(tree,focal="Orcinus_orca",sister="Balaenoptera_musculus")
# sister to a clade
move.lineage(tree,focal="Orcinus_orca",sister=131)
# sister to a clade by using tree$node.label
move.lineage(tree,focal="Balaenoptera_musculus",sister="Clade Delphinida")
# sister to a specific genus
move.lineage(tree,focal="Orcinus_orca",sister="Genus Balaenoptera")
# sister to the tree root with and without rootage
move.lineage(tree,focal="Balaenoptera_musculus",sister=117)
move.lineage(tree,focal="Balaenoptera_musculus",sister=117,rootage=max(diag(vcv(tree))))

### Case 2. Moving a clade
# sister to a tip
move.lineage(tree,focal="Genus Mesoplodon",sister="Balaenoptera_musculus")
move.lineage(tree,focal="Clade Delphinida",sister="Balaenoptera_musculus")
move.lineage(tree,focal=159,sister="Balaenoptera_musculus")
# sister to a clade
move.lineage(tree,focal="Genus Mesoplodon",sister=131)
move.lineage(tree,focal="Clade Delphinida",sister=131)
move.lineage(tree,focal=159,sister=131)
# sister to a clade by using tree$node.label
move.lineage(tree,focal="Genus Mesoplodon",sister="Clade Plicogulae")
move.lineage(tree,focal="Clade Delphinida",sister="Clade Plicogulae")
move.lineage(tree,focal=159,sister="Clade Plicogulae")
# sister to a specific genus
move.lineage(tree,focal="Genus Mesoplodon",sister="Genus Balaenoptera")
move.lineage(tree,focal="Clade Delphinida",sister="Genus Balaenoptera")
move.lineage(tree,focal=159,sister="Genus Balaenoptera")
# sister to the tree root with and without rootage
move.lineage(tree,focal="Genus Mesoplodon",sister=117)
move.lineage(tree,focal="Clade Delphinida",sister=117)
move.lineage(tree,focal=159,sister=117)
move.lineage(tree,focal="Genus Mesoplodon",sister=117,rootage=max(diag(vcv(tree))))
move.lineage(tree,focal="Clade Delphinida",sister=117,rootage=max(diag(vcv(tree))))
move.lineage(tree,focal=159,sister=117,rootage=max(diag(vcv(tree))))
</code></pre>


</div>