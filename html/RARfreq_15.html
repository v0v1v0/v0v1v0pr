<div class="container">

<table style="width: 100%;"><tr>
<td>SEU_simulation_main</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sequential Estimation-adjusted Urn Model with Simulated Data (Binary Data)</h2>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on sequential
estimation-adjusted urn model (SEU) with simulated data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SEU_simulation_main(n, nstart, p, urn_comp, nstop, replication, group_allo,
 add_rule_index, add_rule, add_rule_full, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of patients. The default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>Burn-in sample size of each arm. The default is n/20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector containing response probabilities
for each treatment arm (where the first element refers to the control arm).
The length of p should correspond to the number of arms.
The default is p = c(0.3, 0.3, 0.6).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>urn_comp</code></td>
<td>
<p>A vector of current urn composition. The default is NULL,
which indicates no ball in the urn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_rule_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
addition rules to target allocation functions.
1 = randomized play-the-winner (RPW) rule that targets the urn allocation
2 = the SEU model that targets Neyman allocation;
3 = the SEU model that targets Rosenberger allocation;'
4 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL. (See SEU_BINARY_raw for
details on x.df and arms.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_rule_full</code></td>
<td>
<p>Indicator of reference data for updating addition rule.
If TRUE, the addition rule is updated by full observation at each group
allocation. If FALSE,the addition rule is updated by each group observation.
The default is FALSE for add_rule_index=1 and TRUE otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_level</code></td>
<td>
<p>Significant level (one-sided). The default is 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>'SEU_simulation_main' can sample response and adaptively randomize
subjects group by group.
</p>


<h3>Value</h3>


<ul>
<li>
<p> allocation_mean - Average of allocation in each arm based on 'replication' repeats
</p>
</li>
<li>
<p> allocation_sd - Standard deviation of allocation in each arm based on 'replication' repeats
</p>
</li>
<li>
<p> SS_mean - Average of sample size in each arm based on 'replication' repeats
</p>
</li>
<li>
<p> SS_sd - Standard deviation of sample size in each arm based on 'replication' repeats
</p>
</li>
<li>
<p> power_chisq - Average power of chi-square test.
</p>
</li>
<li>
<p> power_oneside - Average power for each of the k-th arm to perform one-sided test against H0: p_1&gt;p_k without multiplicity adjustment
</p>
</li>
<li>
<p> p_estimate_mean - Average of estimated success rate p
</p>
</li>
<li>
<p> p_estimate_sd - Standard deviation of estimated success rate p
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
## Default method
SEU_simulation_main(n = 500,
nstart = round(500 / 20),
p = c(0.3, 0.3, 0.6),
nstop=c(500,500,500),
urn_comp = c(0,0,0),
replication = 5,
group_allo = 1,
add_rule_index = 1,
add_rule_full = FALSE,
sig_level = 0.05
)

</code></pre>


</div>