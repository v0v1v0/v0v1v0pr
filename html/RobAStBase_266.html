<div class="container">

<table style="width: 100%;"><tr>
<td>oneStepEstimator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for the computation of one-step estimates</h2>

<h3>Description</h3>

<p>Function for the computation of one-step estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">oneStepEstimator(x, IC, start = NULL,
      useLast = getRobAStBaseOption("kStepUseLast"),
      withUpdateInKer = getRobAStBaseOption("withUpdateInKer"),
      IC.UpdateInKer = getRobAStBaseOption("IC.UpdateInKer"),
      na.rm = TRUE, startArgList = NULL, withMakeIC = FALSE, ...,
      E.argList = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> sample </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC</code></td>
<td>
<p> object of class <code>"InfluenceCurve"</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p> initial estimate (for full parameter,i.e. in dimension <code class="reqn">k</code> respective
joint length of main and nuisance part of the parameter):
either a numerical value, or an object of class <code>"Estimate"</code> or
a function producing either a numerical value, or an object of class <code>"Estimate"</code>
when evaluated at <code>x,...</code>; if missing or <code>NULL</code>, we use slot <code>startPar</code>
of the L2family <code>L2Fam</code> from within <code>IC</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useLast</code></td>
<td>
<p> which parameter estimate (initial estimate or
one-step estimate) shall be used to fill the slots <code>pIC</code>,
<code>asvar</code> and <code>asbias</code> of the return value. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withUpdateInKer</code></td>
<td>
<p>if there is a non-trivial trafo in the model with matrix <code class="reqn">D</code>, shall
the parameter be updated on <code class="reqn">{\rm ker}(D)</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC.UpdateInKer</code></td>
<td>
<p>if there is a non-trivial trafo in the model with matrix <code class="reqn">D</code>,
the IC to be used for this; if <code>NULL</code> the result of <code>getboundedIC(L2Fam,D)</code> is taken;
this IC will then be projected onto <code class="reqn">{\rm ker}(D)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical: if  <code>TRUE</code>, the estimator is evaluated at <code>complete.cases(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startArgList</code></td>
<td>
<p>a list of arguments to be given to argument <code>start</code> if the latter
is a function; this list by default already starts with two unnamed items,
the sample <code>x</code>, and the model <code>eval(CallL2Fam(IC))</code>; in case <code>IC</code>
is not of class <code>IC</code>, the model argument <code>L2Fam</code> will be set
to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withMakeIC</code></td>
<td>
<p>logical; if <code>TRUE</code> the [p]IC is passed through
<code>makeIC</code> before return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E.argList</code></td>
<td>
<p><code>NULL</code> (default) or a named list of arguments to be passed
to calls to <code>E</code> from <code>kStepEstimator</code>; potential clashes with
arguments of the same name in <code>...</code> are resolved by inserting
the items of argument list <code>E.argList</code> as named items  to the
argument lists, so in case of collisions the item of <code>E.argList</code> overwrites the
existing one from <code>...</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given an initial estimation <code>start</code>, a sample <code>x</code> 
and an influence curve <code>IC</code> the corresponding one-step
estimator is computed.
</p>
<p>In case <code>IC</code> is an object of class <code>"IC"</code>
the slots <code>asvar</code> and <code>asbias</code> of the return 
value are filled (based on the initial estimate).
</p>
<p>The default value of argument <code>useLast</code> is set by the
global option <code>kStepUseLast</code> which by default is set to 
<code>FALSE</code>. In case of general models <code>useLast</code> 
remains unchanged during the computations. However, if 
slot <code>CallL2Fam</code> of <code>IC</code> generates an object of 
class <code>"L2GroupParamFamily"</code> the value of <code>useLast</code> 
is changed to <code>TRUE</code>.
Explicitly setting <code>useLast</code> to <code>TRUE</code> should
be done with care as in this situation the influence curve
is re-computed using the value of the one-step estimate
which may take quite a long time depending on the model.
</p>
<p>If <code>useLast</code> is set to <code>TRUE</code> and slot <code>modifyIC</code> 
of <code>IC</code> is filled with some function (which can be 
used to re-compute the IC for a different parameter), the 
computation of <code>asvar</code>, <code>asbias</code> and <code>IC</code> is 
based on the one-step estimate.
</p>


<h3>Value</h3>

<p>Object of class <code>"kStepEstimate"</code></p>


<h3>Author(s)</h3>

<p>Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a>,<br>
Peter Ruckdeschel <a href="mailto:peter.ruckdeschel@uni-oldenburg.de">peter.ruckdeschel@uni-oldenburg.de</a></p>


<h3>References</h3>

<p>Rieder, H. (1994) <em>Robust Asymptotic Statistics</em>. New York: Springer.
</p>
<p>Kohl, M. (2005) <em>Numerical Contributions to the Asymptotic Theory of Robustness</em>. 
Bayreuth: Dissertation.
</p>


<h3>See Also</h3>

<p><code>InfluenceCurve-class</code>, <code>kStepEstimate-class</code> </p>


</div>