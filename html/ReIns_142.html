<div class="container">

<table style="width: 100%;"><tr>
<td>SpliceFitGPD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Splicing of mixed Erlang and GPD using POT-MLE
</h2>

<h3>Description</h3>

<p>Fit spliced distribution of a mixed Erlang distribution and a Generalised Pareto Distribution (GPD). The parameters of the GPD are determined using the POT-MLE approach. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">SpliceFitGPD(X, const = NULL, tsplice = NULL, M = 3, s = 1:10, trunclower = 0, 
             ncores = NULL, criterium = c("BIC","AIC"), reduceM = TRUE,
             eps = 10^(-3), beta_tol = 10^(-5), maxiter = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Data used for fitting the distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>

<p>The probability of the quantile where the ME distribution will be spliced with the GPD distribution. Default is <code>NULL</code> meaning the input from <code>tsplice</code> is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsplice</code></td>
<td>

<p>The point where the ME distribution will be spliced with the GPD distribution. Default is <code>NULL</code> meaning the input from <code>const</code> is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>Initial number of Erlang mixtures, default is 3. This number can change when determining
an optimal mixed Erlang fit using an information criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>Vector of spread factors for the EM algorithm, default is <code>1:10</code>. We loop over these factors when determining
an optimal mixed Erlang fit using an information criterion, see Verbelen et al. (2016).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunclower</code></td>
<td>

<p>Lower truncation point. Default is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>

<p>Number of cores to use when determining an optimal mixed Erlang fit using an information criterion.
When <code>NULL</code> (default), <code>max(nc-1,1)</code> cores are used where <code>nc</code> is the number of cores as determined by <code>detectCores</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterium</code></td>
<td>

<p>Information criterion used to select the number of components of the ME fit and <code>s</code>. One of <code>"AIC"</code> and <code>"BIC"</code> (default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduceM</code></td>
<td>

<p>Logical indicating if M should be reduced based on the information criterion, default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>Covergence threshold used in the EM algorithm (ME part). Default is <code>10^(-3)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_tol</code></td>
<td>

<p>Threshold for the mixing weights below which the corresponding shape parameter vector is considered neglectable (ME part). Default is <code>10^(-5)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>Maximum number of iterations in a single EM algorithm  execution (ME part). Default is <code>Inf</code> meaning no maximum number of iterations.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Reynkens et al. (2017), Section 4.3.1 of Albrecher et al. (2017) and Verbelen et al. (2015) for details. The code follows the notation of the latter. Initial values follow from Verbelen et al. (2016).
</p>


<h3>Value</h3>

<p>A <code>SpliceFit</code> object.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens with <code>R</code> code from Roel Verbelen for fitting the mixed Erlang distribution.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). "Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions". <em>Insurance: Mathematics and Economics</em>, 77, 65–77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). "Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm." <em>Astin Bulletin</em>, 45, 729–758.
</p>
<p>Verbelen, R., Antonio, K. and Claeskens, G. (2016). "Multivariate Mixtures
of Erlangs for Density Estimation Under Censoring." <em>Lifetime Data Analysis</em>, 22, 429–455.
</p>


<h3>See Also</h3>

<p><code>SpliceFitPareto</code>, <code>SpliceFiticPareto</code>, <code>Splice</code>,
<code>GPDfit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# GPD random sample
X &lt;- rgpd(1000, gamma = 0.5, sigma = 2)

# Splice ME and GPD
splicefit &lt;- SpliceFitGPD(X, 0.6)



x &lt;- seq(0, 20, 0.01)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")



# Fitted survival function and empirical survival function 
SpliceECDF(x, X, splicefit)

# Log-log plot with empirical survival function and fitted survival function
SpliceLL(x, X, splicefit)

# PP-plot of empirical survival function and fitted survival function
SplicePP(X, splicefit)

# PP-plot of empirical survival function and 
# fitted survival function with log-scales
SplicePP(X, splicefit, log=TRUE)

# Splicing QQ-plot
SpliceQQ(X, splicefit)

## End(Not run)
</code></pre>


</div>