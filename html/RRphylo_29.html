<div class="container">

<table style="width: 100%;"><tr>
<td>plotConv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical representation of search.conv results</h2>

<h3>Description</h3>

<p>This function generates customized functions to produce plots out of
<code>search.conv</code> results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotConv(SC,y,variable,RR=NULL,state=NULL,aceV=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SC</code></td>
<td>
<p>an object produced by <code>search.conv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the multivariate phenotype used to perform <code>search.conv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>the index of result to plot. If convergence between clades is
inspected, this is the position within the <code>SC$'average distance from
group centroids'</code> vector of the clade pair to be plotted. In the case of
convergence between states, this is the number of the line of
<code>SC$state.res</code> where results for the state pair are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>
<p>the object produced by <code>RRphylo</code> used to perform
<code>search.conv</code>. This is not indicated if convergence between states is
tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state</code></td>
<td>
<p>the named vector of tip states used to perform <code>search.conv</code>.
This is not indicated if convergence between clades is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aceV</code></td>
<td>
<p>phenotypic values at internal nodes to be provided if used to
perform <code>search.conv</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If convergence between clades was tested, <code>plotConv</code> returns a
list of four functions:
</p>
<p><strong><code>$plotHistTips</code></strong> shows the mean Euclidean distance
computed between phenotypic vectors of all the tips belonging to the
converging clades as compared to the distribution of distances between all
possible pair of tips across the rest of the tree. The usage is:
<code>...$plotHistTips(hist.args=NULL,line.args=NULL)</code>, where
<code>hist.args</code> is a list of further arguments passed to the function
<code>hist</code>, and <code>line.args</code> is a list of further arguments passed to
the function <code>lines</code>.
</p>
<p><strong><code>$plotHistAces</code></strong> shows the Euclidean distance computed
between phenotypic vectors of the MRCAs of the converging clades as compared
to the distribution of distances between all possible pairs of nodes across
the rest of the tree. The usage is identical to <code>$plotHistTips</code>.
</p>
<p><strong><code>$plotPChull</code></strong> generates a PC1/PC2 plot obtained by
performing a PCA of the species phenotypes. Convergent clades are indicated
by colored convex hulls. Large dots represent the mean phenotypes per clade
(i.e. their group centroids) and asterisks (customizable) represent the
ancestral phenotypes of the individual clades. The usage is:
<code>...$plotPChull(plot.args=NULL,chull.args=NULL,means.args=NULL,</code>
<code>ace.args=NULL,legend.args=list()</code>,where <code>plot.args</code> is a list of
further arguments passed to the function <code>plot</code>, <code>chull.args</code> is a
list of further arguments passed to the function <code>polygon</code>,
<code>means.args</code> and <code>ace.args</code> are lists of further argument passed
to the function <code>points</code> to customize the dots representing the
centroids and the ancestral phenotypes respectively, and <code>legend.args</code>
is a list of additional arguments passed to the function <code>legend</code> (if
<code>= NULL</code> the legend is not plotted).
</p>
<p><strong><code>$plotTraitgram</code></strong> produces a modified traitgram plot (see
package <span class="pkg">picante</span>) highlighting the branches of the clades found to
converge. The usage is:
<code>plotTraitgram(colTree=NULL,colNodes=NULL,...)</code>, where <code>colTree</code>
is the color to represent the traitgram lines not pertaining the converging
clades, <code>colNodes</code> is the color (or the vector of colors) to represent
the traitgram lines pertaining the converging clades, and <code>...</code> are
further arguments passed to the function <code>plot</code> to plot lines.
</p>
<p>If convergence between states was tested, <code>plotConv</code> returns a
list of two functions:
</p>
<p><strong><code>$plotPChull</code></strong> generates a PC1/PC2 plot obtained by
performing a PCA of the species phenotypes, with colored convex hulls
enclosing species belonging to different states. The usage is:
<code>...$plotPChull(plot.args=NULL,chull.args=NULL,points.args=NULL,</code>
<code>legend.args=list()</code>, where <code>plot.args</code> is a list of further
arguments passed to the function <code>plot</code>, <code>chull.args</code> is a list of
further arguments passed to the function <code>polygon</code>, <code>points.args</code>
is a list of further argument passed to the function <code>points</code>, and
<code>legend.args</code> is a list of additional arguments passed to the function
<code>legend</code> (if <code>= NULL</code> the legend is not plotted).
</p>
<p><strong><code>$plotPolar</code></strong> produces a polar plot of the mean angle
within/between state/s as compared to the 95
angles. The usage is:
<code>...$plotPolar(polar.args=NULL,polygon.args=NULL,line.args=NULL)</code>,
where <code>polar.args</code> is a list of further arguments passed to the
function <code>polar.plot</code> to set the plot basics (i.e.
<code>radial.lim</code>, <code>start</code>, and so on), <code>polygon.args</code> is a list
of further arguments passed to the function <code>polar.plot</code> under the
condition <code>rp.type="p"</code> (see <code>plotrix::polar.plot</code> for details) to
set the angles distribution graphics, and <code>line.args</code> is a list of
further arguments passed to the function <code>polar.plot</code> under the
condition <code>rp.type="r"</code> to set the mean angle graphics.
</p>


<h3>Author(s)</h3>

<p>Silvia Castiglione
</p>


<h3>References</h3>

<p>Castiglione, S., Serio, C., Tamagnini, D., Melchionna, M.,
Mondanaro, A., Di Febbraro, M., Profico, A., Piras, P.,Barattolo, F., &amp;
Raia, P. (2019). A new, fast method to search for morphological convergence
with shape data. <em>PLoS ONE</em>, 14, e0226949.
https://doi.org/10.1371/journal.pone.0226949
</p>


<h3>See Also</h3>

<p><a href="../doc/search.conv.html"><code>search.conv</code> vignette</a>
</p>
<p><a href="../doc/Plotting-tools.html"><code>plotConv</code> vignette</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("DataFelids")
DataFelids$PCscoresfel-&gt;PCscoresfel
DataFelids$treefel-&gt;treefel
DataFelids$statefel-&gt;statefel-&gt;state2
state2[sample(which(statefel=="nostate"),20)]&lt;-"st2"
cc&lt;- 2/parallel::detectCores()

RRphylo(treefel,PCscoresfel,clus=cc)-&gt;RRfel

search.conv(RR=RRfel, y=PCscoresfel, min.dim=5, min.dist="node9",clus=cc)-&gt;sc_clade
plotConv(sc_clade,PCscoresfel,variable=2,RR=RRfel)-&gt;pc

pc$plotHistTips(hist.args = list(col="gray80",yaxt="n",cex.axis=0.8,cex.main=1.5),
                line.args = list(lwd=3,lty=4,col="purple"))
pc$plotHistAces(hist.args = list(col="gray80",cex.axis=0.8,cex.main=1.5),
                line.args = list(lwd=3,lty=4,col="gold"))
pc$plotPChull(chull.args = list(border=c("cyan","magenta"),lty=1),
              means.args = list(pch=c(23,22),cex=3,bg=c("cyan2","magenta2")),
              ace.args=list(pch=9),legend.args = NULL)
pc$plotTraitgram(colTree = "gray70",colNodes = c("cyan","magenta"))


search.conv(tree=treefel, y=PCscoresfel, state=statefel,declust=TRUE,clus=cc)-&gt;sc_state
plotConv(sc_state,PCscoresfel,variable=1,state=statefel)-&gt;pc
pc$plotPChull(chull.args = list(border=c("gray70","blue"),lty=1),
              points.args = list(pch=c(23,22),bg="gray"),
              legend.args = list(pch=c(23,22),x="top"))

pc$plotPolar(polar.args = list(clockwise=TRUE,start=0,rad.col="black",grid.col="black"),
             polygon.args = list(line.col="green",poly.col=NA,lwd=2),
             line.args = list(line.col="deeppink",lty=2,lwd=3))

    
## End(Not run)
</code></pre>


</div>