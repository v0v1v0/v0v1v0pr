<div class="container">

<table style="width: 100%;"><tr>
<td>roll_values</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shift values and wrap to range</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>Adds a specified value to each element in the vector and wraps the values around
the min-max range with:
</p>
<p><code class="reqn">(x - .min)</code><code> % </code><code class="reqn">(.max - .min + between) + .min</code>
</p>
<p>Useful when adding to the degrees of a circle, where the values should remain in the
<code>0-360</code> range. A value larger than <code>360</code> will start over from <code>0</code>, e.g. <code class="reqn">365 -&gt; 5</code>,
while a value smaller than <code>0</code> would become e.g. <code class="reqn">-5 -&gt; 355</code>.
Here, <code>0</code> and <code>360</code> are considered the same angle.
If we were instead adding days to the weekdays <code>1-7</code>,
where <code>1</code> and <code>7</code> are separate days,
we can set <code>`between = 1`</code> to have one day in-between them.
</p>
<p><code>wrap_to_range()</code> is a wrapper with <code>`add = 0`</code>.
</p>
<p>The <code>*_vec()</code> versions take and return a vector.
</p>
<p>Should not be confused with <code>roll_elements()</code>,
which changes the <em>positions</em> of the elements.
</p>


<h3>Usage</h3>

<pre><code class="language-R">roll_values(
  data,
  cols = NULL,
  add = 0,
  .min = NULL,
  .max = NULL,
  between = 0,
  na.rm = FALSE,
  suffix = "_rolled",
  keep_original = TRUE,
  range_col_name = ".range",
  overwrite = FALSE
)

wrap_to_range(
  data,
  cols = NULL,
  .min = NULL,
  .max = NULL,
  between = 0,
  na.rm = FALSE,
  suffix = "_wrapped",
  keep_original = TRUE,
  range_col_name = ".range",
  overwrite = FALSE
)

roll_values_vec(
  data,
  add = 0,
  .min = NULL,
  .max = NULL,
  between = 0,
  na.rm = FALSE
)

wrap_to_range_vec(data, .min = NULL, .max = NULL, between = 0, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>vector</code> or <code>data.frame</code> to roll/wrap values of. When a <code>data.frame</code> is
grouped, the rolling/wrapping is applied group-wise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>Names of columns to roll/wrap in <code>`data`</code>. Must be specified
when <code>`data`</code> is a <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Amount to add to each element. (<code>numeric scalar</code>)
</p>
<p>When <code>0</code>, the wrapping is applied without any rolling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.min</code></td>
<td>
<p>Minimum value allowed. If <code>NULL</code>, the
minimum value in the <code>vector</code>/<code>column</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.max</code></td>
<td>
<p>Maximum value allowed. If <code>NULL</code>, the
maximum value in the <code>vector</code>/<code>column</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>between</code></td>
<td>
<p>The wrapping distance between <code>`.max`</code> and <code>`.min`</code>.
</p>
<p>When <code>0</code>, they are considered the same. I.e. <code class="reqn">`.max == .min`</code>.
</p>
<p>When <code>1</code>, <code>`x`</code> can be greater than <code>`.max`</code> by up to <code>1</code>, why
<code>`.min`</code> and <code>`.max`</code> are two separate values with <code>1</code> in-between them. I.e.
<code class="reqn">`.max + 1 == .min`</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Whether to remove missing values (<code>NA</code>s)
when finding the <code>`.min`</code> and <code>`.max`</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>Suffix to add to the names of the generated columns.
</p>
<p>Use an empty string (i.e. <code>""</code>) to overwrite the original columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_original</code></td>
<td>
<p>Whether to keep the original columns. (Logical)
</p>
<p>Some columns may have been overwritten, in which case only the newest versions are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_col_name</code></td>
<td>
<p>Name of new column with the min-max range. If <code>NULL</code>, no column is added.
</p>
<p><strong>N.B.</strong> Ignored when <code>`data`</code> is a <code>vector</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Whether to allow overwriting of existing columns. (Logical)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>`data`</code> with new columns with values in the specified min-max range(s)
and columns with the applied ranges.
</p>
<p>The <code>*_vec()</code> versions return a <code>vector</code>.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other roll functions: 
<code>roll_elements()</code>
</p>
<p>Other mutate functions: 
<code>apply_transformation_matrix()</code>,
<code>cluster_groups()</code>,
<code>dim_values()</code>,
<code>expand_distances()</code>,
<code>expand_distances_each()</code>,
<code>flip_values()</code>,
<code>rotate_2d()</code>,
<code>rotate_3d()</code>,
<code>shear_2d()</code>,
<code>shear_3d()</code>,
<code>swirl_2d()</code>,
<code>swirl_3d()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Attach packages
library(rearrr)

# Add 90 to all degrees
# Note that 0 and 360 is considered the same angle
# why there is no distance between the two
roll_values(c(0:360), add = 90)

# Get as vector
roll_values_vec(c(0:360), add = 90)

# Change limits to 0-180
# so e.g. 270 becomes 90
roll_values(c(0:360), .min = 0, .max = 180)

# Change values first, then wrap to range
x &lt;- c(1:7)
x &lt;- x^2
wrap_to_range(x, .min = 1, .max = 7)

# With 1 in-between .min and .max
wrap_to_range(x, .min = 1, .max = 7, between = 1)

# Get as vector
wrap_to_range_vec(x, .min = 1, .max = 7, between = 1)

#
# Roll data.frame
#

# Set seed
set.seed(1)

# Create a data frame
df &lt;- data.frame(
  "w" = 1:7,
  "d" = c(0, 45, 90, 135, 180, 270, 360)
)

# Roll weekdays by 1 day
roll_values(
  df,
  cols = "w",
  add = 1,
  .min = 1,
  .max = 7,
  between = 1
)

# Roll degrees by -90 degrees
roll_values(
  df,
  cols = "d",
  add = -90,
  .min = 0,
  .max = 360,
  between = 0
)

# Roll both weekdays and degrees by 1
# We don't specify .min and .max, so they
# are based on the values in the columns
# Note: This is not that meaningful but shows
# the option
roll_values(
  df,
  cols = c("w", "d"),
  add = 1
)

# Wrap weekdays to 2-5 range
wrap_to_range(
  df,
  cols = "w",
  .min = 2,
  .max = 5,
  between = 1
)
</code></pre>


</div>