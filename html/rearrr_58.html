<div class="container">

<table style="width: 100%;"><tr>
<td>roll_elements</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Roll elements</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>Rolls positions of elements.
</p>
<p>Example:
</p>
<p>Rolling <code>c(1, 2, 3, 4, 5)</code> with <code>`n = 2`</code> becomes:
</p>
<p><code>c(3, 4, 5, 1, 2)</code>
</p>
<p><code>roll_elements_vec()</code> takes and returns a <code>vector</code>.
</p>
<p>Should not be confused with <code>roll_values()</code>,
which changes the <em>values</em> of the elements and wraps to a given range.
</p>


<h3>Usage</h3>

<pre><code class="language-R">roll_elements(
  data,
  cols = NULL,
  n = NULL,
  n_fn = NULL,
  n_col_name = ".n",
  overwrite = FALSE,
  ...
)

roll_elements_vec(data, n = NULL, n_fn = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>vector</code> or <code>data.frame</code> to roll elements of. When a <code>data.frame</code> is
grouped, the rolling is applied group-wise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>Names of columns in <code>`data`</code> to roll.
If <code>NULL</code>, the <em>index</em> is rolled and used to reorder <code>`data`</code>.
</p>
<p><strong>N.B.</strong> only used when <code>`data`</code> is a <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of positions to roll. A positive number rolls <em>left/up</em>.
A negative number rolls <em>right/down</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_fn</code></td>
<td>
<p>Function to find <code>`n`</code>. Useful when <code>`data`</code> is a
grouped <code>data.frame</code> and <code>`n`</code> should depend on the rows in the group.
</p>
<p><strong>Input</strong>: Each specified <code>vector</code>/<code>column</code> in <code>`data`</code>
is passed to the function as a separate argument.
</p>
<p><strong>Output</strong>: It should return either a <code>vector</code>
with one <code>integer-like scalar</code> <em>per column</em>
or a single <code>integer-like scalar</code> to use for all columns.
</p>
<p>Can be created with <code>create_n_fn()</code>.
See also <code>median_index()</code> and
<code>quantile_index()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_col_name</code></td>
<td>
<p>Name of new column with the applied <code>`n`</code> values.
If <code>NULL</code>, no column is added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Whether to allow overwriting of columns with the
same name as <code>`n_col_name`</code>. (Logical)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments for <code>`n_fn`</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Rolled <code>`data`</code>.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other roll functions: 
<code>roll_values()</code>
</p>
<p>Other rearrange functions: 
<code>center_max()</code>,
<code>center_min()</code>,
<code>closest_to()</code>,
<code>furthest_from()</code>,
<code>pair_extremes()</code>,
<code>position_max()</code>,
<code>position_min()</code>,
<code>rev_windows()</code>,
<code>shuffle_hierarchy()</code>,
<code>triplet_extremes()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Attach packages
library(rearrr)
library(dplyr)

# Roll vector left
roll_elements(1:10, n = 2)

# Roll vector right and return the vector
roll_elements_vec(1:10, n = -2)

# Roll vector left by median index (rounded to 6)
roll_elements(3:12, n_fn = median_index)

# Roll vector right by median value (rounded to 8)
roll_elements(3:12, n_fn = create_n_fn(median, negate = TRUE))

# Pass extra arguments (here 'prob') to 'n_fn' via '...'
roll_elements(
  1:10,
  n_fn = quantile_index,
  prob = 0.2
)

#
# Roll data.frame
#

# Set seed
set.seed(1)

# Create a data frame
df &lt;- data.frame(
  "x" = 1:20,
  "y" = runif(20) * 10,
  "g" = rep(1:4, each = 5)
)

# Roll rows left/up
roll_elements(df, n = 2)

# Roll rows right/down
roll_elements(df, n = -2)

# Roll 'x' column right/down
roll_elements(df, cols = "x", n = -2)

# Roll rows right by median index in each group
# Specify 'negate' for the 'median_index' function
roll_elements(
  df %&gt;% dplyr::group_by(g),
  n_fn = median_index,
  negate = TRUE
)
</code></pre>


</div>