<div class="container">

<table style="width: 100%;"><tr>
<td>varRegression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Regression of Sources of Variability</h2>

<h3>Description</h3>

<p>This functions regresses out variability associated with particular sources.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varRegression(object, vars = NULL, logscale = FALSE, Batch = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>SCseq</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>data.frame of variables to be regressed out. Each column corresponds to a variable and each variable corresponds to a cell.
The object must contain all cells, i.e. column names of the slot <code>ndata</code> from the <code>SCseq</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>
<p>logical. If <code>TRUE</code> data are log-transformed prior to regression. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Batch</code></td>
<td>
<p>logical. If <code>TRUE</code>, then the function will regress out batch-associated variability based on genes stored in the <code>filterpar$BGenes</code>
slot of the <code>SCseq</code> object. This requires prior batch correction with the <code>filterdata</code> function using <code>bmode="RaceID"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns an updated <code>SCseq</code> object with the corrected expression matrix written to the slot <code>dimRed$x</code> of the <code>SCseq</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sc &lt;- SCseq(intestinalDataSmall)
sc &lt;- filterdata(sc)
b &lt;- sub("(\\_\\d+)$","",colnames(intestinalData))
vars &lt;- data.frame(row.names=colnames(intestinalData),batch=b)
sc   &lt;- varRegression(sc,vars)
</code></pre>


</div>