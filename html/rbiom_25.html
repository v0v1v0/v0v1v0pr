<div class="container">

<table style="width: 100%;"><tr>
<td>taxa.rollup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a matrix of samples by taxa, at the specified taxonomic rank.</h2>

<h3>Description</h3>

<p>Generate a matrix of samples by taxa, at the specified taxonomic rank.
</p>


<h3>Usage</h3>

<pre><code class="language-R">taxa.rollup(biom, rank = "OTU", map = NULL, lineage = FALSE, sparse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>biom</code></td>
<td>
<p>A <code>matrix</code>, <code>simple_triplet_matrix</code>, or <code>BIOM</code> 
object, as returned from read.biom. For matrices, the rows and 
columns are assumed to be the taxa and samples, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>The taxonomic rank. E.g. <b>“OTU”</b>, 
<b>“Phylum”</b>, etc. May also be given numerically: 0 for
OTU, 1 for the highest level (i.e. Kingdom), and extending to the number
of taxonomic ranks encoded in the original biom file. See example below
to fetch the names of all available ranks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>A character matrix defining the value that each taxa IDs is
assigned for each taxonomic rank. If <code>map=NULL</code> and <code>biom</code> is a
<code>BIOM</code> class object, the map will be automatically loaded from 
<code>biom$taxonomy</code>. <code>map</code> must not be <code>null</code> when <code>biom</code>
is a <code>matrix</code> or <code>simple_triplet_matrix</code>. See the example below
for an example of <code>map</code>'s structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lineage</code></td>
<td>
<p>Include all ranks in the name of the taxa. For instance,
setting to <code>TRUE</code> will produce 
<code>Bacteria; Actinobacteria; Coriobacteriia; Coriobacteriales</code>. 
Whereas setting to <code>FALSE</code> (the default) will return simply
<code>Coriobacteriales</code>. You want to set this to TRUE if you have
genus names (such as <em>Incertae_Sedis</em>) that map to multiple higher
level ranks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>If true, returns a sparse matrix as described by 
<code>slam::simple_triplet_matrix</code>, otherwise returns a normal R
matrix object. Sparse matrices will likely be considerably more
memory efficient in this scenario.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric matrix with samples as column names, and taxonomic
identifiers as row names.
</p>


<h3>Examples</h3>

<pre><code class="language-R">    library(rbiom)
    
    infile &lt;- system.file("extdata", "hmp50.bz2", package = "rbiom")
    biom &lt;- read.biom(infile)
    
    colnames(biom$taxonomy)
    
    phyla &lt;- taxa.rollup(biom, 'Phylum')
    phyla[1:4,1:6]
    
    # Custom matrices should be formatted like so:
    counts &lt;- as.matrix(biom$counts)
    map    &lt;- biom$taxonomy
    
    counts[1:3,1:6]
    map[1:3,1:4]
    
    phyla &lt;- taxa.rollup(counts, 'Phylum', map=map)
    phyla[1:3,1:6]

</code></pre>


</div>