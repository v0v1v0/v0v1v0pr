<div class="container">

<table style="width: 100%;"><tr>
<td>varMat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> create a semivariogram matrix between a set of locations, or semivariogram 
matrices between and within two sets of locations</h2>

<h3>Description</h3>

<p>varMat will create a semivariogram matrix between all the supports in a set of 
locations (observations or prediction locations) or semivariogram matrices
between all the supports in one or two sets of locations, and also between them.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'rtop'
varMat(object, varMatUpdate = FALSE, fullPred = FALSE, params = list(), ...) 
## S3 method for class 'SpatialPolygonsDataFrame'
varMat(object, object2 = NULL,...) 
## S3 method for class 'SpatialPolygons'
varMat(object, object2 = NULL, variogramModel,
     overlapObs, overlapPredObs, ...) 

## S3 method for class 'list'
varMat(object, object2 = NULL, coor1, coor2, maxdist = Inf, 
              variogramModel, diag = FALSE, sub1, sub2, 
              debug.level = ifelse(interactive(), 1, 0), ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> either: 1) an object of class <code>rtop</code> (see rtop-package) 
or 2) a <br><code>SpatialPolygonsDataFrame</code>,
or <code>SpatialPolygons</code>, 
or 3) a <br><code>matrix</code> with geostatistical distances (see
<code>gDist</code>
or 4) a <code>list</code> with discretized supports</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varMatUpdate</code></td>
<td>
<p>logical; if TRUE, also existing variance matrices will 
be recomputed, if FALSE, only missing variance matrices will be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullPred</code></td>
<td>
<p>logical; whether to create the full covariance matrix also for the predictions, 
mainly used for simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a set of parameters, used to modify the default parameters for 
the <code>rtop</code> package, set in <code>getRtopParams</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object2</code></td>
<td>
<p>if <code>object</code> is not an object of class <code>rtop</code>; 
an object of the same class as <code>object</code> with a possible second 
set of locations with support</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variogramModel</code></td>
<td>
<p>variogramModel to be used in calculation of the 
semivariogram matrix (matrices)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>typical parameters to modify from the default parameters of the
rtop-package (or modifications of the previously set parameters for the 
<code>rtop</code>-object), see also <code>getRtopParams</code>. These can also 
be passed in a list named params, as for the rtop-method. Typical 
parameters to modify for this function:
</p>

<dl>
<dt>rresol = 100</dt>
<dd>
<p>miminum number of discretization points, in call to 
<code>rtopDisc</code> if necessary</p>
</dd>
<dt>rstype = "rtop"</dt>
<dd>
<p>sampling type from areas, in call to 
<code>rtopDisc</code> if necessary</p>
</dd>
<dt>gDistPred = FALSE</dt>
<dd>
<p>use geostatistical distance for semivariogram matrices</p>
</dd>
<dt>gDist</dt>
<dd>
<p>parameter to set jointly <code>gDistEst = gDistPred = gDist</code></p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlapObs</code></td>
<td>
<p>matrix with observations that overlap each other</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlapPredObs</code></td>
<td>
<p>matrix with <code>observations</code> and <code>predictionLocations</code>
that overlap each other</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coor1</code></td>
<td>
<p>coordinates of centroids of <code>object</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coor2</code></td>
<td>
<p>coordinates of centre-of-gravity of <code>object2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>maximum distance between areas for inclusion in semivariogrma matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>logical; if TRUE only the semivariogram values along the diagonal 
will be calculated, typical for semivariogram matrix of prediction locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub1</code></td>
<td>
<p>semivariogram array for subtraction of inner variances of areas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub2</code></td>
<td>
<p>semivariogram array for subtraction of inner variances of areas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug.level</code></td>
<td>
<p>debug.level &gt;= 1 will give output for every element</p>
</td>
</tr>
</table>
<h3>Value</h3>

 
<p>The lower level versions of the function calculates a semivariogram matrix
between locations in <code>object</code> or between the locations in <code>object</code> 
and the locations in <code>object2</code>. The method for object of type <code>rtop</code>
calculates semivariogram matrices between observation locations, between prediction locations, 
and between observation locations and prediction locations, and adds these 
to <code>object</code>.
</p>


<h3>Note</h3>

<p>The argument <code>varMatUpdate</code> is typically used to avoid repeated computations
of the same variance matrices. Default is FALSE, which will avoid recomputation
of the variance matrix for the observations if the procedure is cross-validation
before interpolation. Should be set to TRUE if the variogram Model has been
changed, or if observation and/or prediction locations have been changed.
</p>
<p>If an <code>rtop</code>-object contains observations and/or predictionLocations of type 
<code>STSDF</code>, the covariance matrix is computed based on the spatial 
properties of the object.
</p>


<h3>Author(s)</h3>

<p> Jon Olav Skoien </p>


<h3>References</h3>

 
<p>Skoien J. O., R. Merz, and G. Bloschl. Top-kriging - geostatistics on stream networks.
Hydrology and Earth System Sciences, 10:277-287, 2006.
</p>
<p>Skoien, J. O., Bloschl, G., Laaha, G., Pebesma, E., Parajka, J., Viglione, A., 2014. Rtop: An R package for interpolation of data with a variable spatial support, with an example from river networks. Computers &amp; Geosciences, 67.
</p>


<h3>See Also</h3>

<p><code>gDist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(sf)
rpath = system.file("extdata",package="rtop")
observations = st_read(rpath,"observations")
vmod = list(model = "Ex1", params = c(0.00001,0.007,350000,0.9,1000))
vm = varMat(observations, variogramModel = vmod)

## End(Not run)
</code></pre>


</div>