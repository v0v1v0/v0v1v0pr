<div class="container">

<table style="width: 100%;"><tr>
<td>SandT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute empirical survivals (S) and return periods (T)
</h2>

<h3>Description</h3>

<p>Compute the empirical survival values and the empirical return periods
at the observations of an object. These are used as plotting positions
in several plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  SandT(object, points = c("p", "H"), a = 0, naive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>The object containing the data, with class <code>"Renouv"</code> or
<code>"Rendata"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>

<p>Option for the computation of the plotting positions.  When
<code>points</code> is set to <code>"p"</code>, the <code class="reqn">p</code>-points formula is
used with the selected value of <code>a</code>. This formula is used to
compute the survival from which the return period is computed. When
instead <code>points</code> is set to <code>"H"</code>, <em>Nelson's formula</em>
is used to compute the return periods, the survival value still
being given by the <code class="reqn">p</code>-points formula. When the data is
heterogeneous, i.e.  when <code>object</code> contains <code>MAX</code> and/or
<code>OTS</code> data, Nelson's formula is used only to compute the return
periods of the upper slice of levels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>Parameter used in the interpolation formula for the inverse return
periods as in Hirsch and Stedinger (1987).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naive</code></td>
<td>

<p>Logical. When <code>TRUE</code>, naive plotting positions are used to
display <code>MAX</code> or <code>OTS</code> data. These can be defined only
when a main sample exists in <code>object</code> as a <code>x.OT</code> element.
For each <code>MAX</code> or <code>OTS</code> block, the positions use the
number of events predicted using the rate of events as estimated
from the main sample. When the main sample has a small durations,
such predictions are likely to be misleading.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When the object contains historical information (<code>MAX</code> or
<code>OTS</code>), the computation is an adaptation Hirsch and Stedinger
(1987) for the Marked Process (MP) context. The original method is
devoted to block maxima and interpolates the survival values at the
thresholds which are computed first. For MP, the interpolation is
done for the inverse return periods, and the survival values are
deduced from those of the inverse return periods.
</p>
<p>Nelson's formula provides unbiased estimates for the values of the
cumulative hazard <code class="reqn">H(x)</code> at the order statistics, and thus
can be used to estimate the log-return periods as required on the
return level plot.
</p>


<h3>Value</h3>

<p>A list with the following elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Numeric vector containing the ordered values from all the available
sources in the object: main sample, historical periods either 'MAX' or
'OTS'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group, groupNames</code></td>
<td>

<p>Integer and character vectors giving the source of the values in
<code>x</code>, in the same order of the values. For instance,
<code>group[10]</code> gives the group form which <code>x[10]</code> was
extracted, and the name of this group is <code>groupNames[group[10]]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S, T</code></td>
<td>

<p>Numeric vectors of the same length as <code>x</code> and containing the
corresponding estimation of the survival value and of the return
period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh, lambda.thresh, S.thresh, T.thresh</code></td>
<td>

<p>Vector of thresholds and the corresponding estimation for the event
rate, survival and return period. All the estimations are <em>for
the threshold values</em>. The value of <code>T.thresh[i]</code> for a threshold
<code>thresh[i]</code> results from a simple computation: divide the sum of
the durations for blocks with thresholds <code>&gt;= thresh[i]</code> by the
number of events for these blocks.
</p>
</td>
</tr>
</table>
<h3>seealso</h3>

<p>The <code>ppoints</code> and <code>Hpoints</code> functions.
</p>


<h3>Warning</h3>

<p>When using <code>points = "H"</code> the estimated values of the survival
returned in <code>S</code> and those for the return period <code>T</code> no
longer verify <code>T=1/S/lambda</code>, where <code>lambda</code> is the
estimated rate. In this case, the values in <code>T</code> should be used in
the return level plot, while the values in <code>S</code> should be used in
the PP-plot.
</p>


<h3>Author(s)</h3>

<p>Yves Deville
</p>


<h3>References</h3>

<p>The original method for block maxima is described in
</p>

<ul>
<li>
<p> Hirsch R.M. and Stedinger J.R.(1887) Plotting Positions
for Historical Floods and their precision. <em>Water
Ressources Research</em>, vol. 23, N. 4 pp. 715-727.
</p>
</li>
<li>
<p> Millard S. and Neerchal N. (2001). <em>Environmental
Statistics with S-Plus</em>. CRC Press
</p>
</li>
</ul>
<p>The adaptation for the Marked Process context is
described in the <em>Renext Computing Details</em>
document.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## use an object with class "Rendata"
ST1 &lt;- SandT(object = Garonne)
## basic return level plot
plot(ST1$T, ST1$x, col = ST1$group, log = "x")
## use an object with class "Renouv"
fit &lt;- Renouv(x = Garonne, plot = FALSE)
ST2 &lt;- SandT(object = fit)
plot(ST2$T, ST2$x, col = ST2$group, log = "x")
</code></pre>


</div>