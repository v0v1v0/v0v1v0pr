<div class="container">

<table style="width: 100%;"><tr>
<td>rb_unstr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binary random variates with unstructured correlations</h2>

<h3>Description</h3>

<p>Generate Bahadur order-2 multivariate Bernoulli random variates with
unstructured correlations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rb_unstr(n, mu, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>correlation matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This generates multivariate Bernoulli (MVB) random vectors with mean vector
'mu' and correlation matrix 'C'. 'mu' must take values in the open unit interval and
'C' must induce a valid second Bahadur order probability distribution. That is,
there must exist an MVB probability distribution with first moments 'mu' and
standardized central second moments 'C' such that all higher order central moments
are zero.
</p>


<h3>Value</h3>

<p>An <code class="reqn">n</code>-by-<code class="reqn">m</code> matrix of binary random variates, where <code class="reqn">m</code> is the
length of 'mu'.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
h2_0 = .5; m = 200; n = 500; r =.5; min_MAF=.1

## draw standardized diploid allele substitution effects
beta &lt;- scale(rnorm(m))*sqrt(h2_0 / m)

## draw allele frequencies
AF &lt;- runif(m, min_MAF, 1 - min_MAF)

## compute unstandardized effects
beta_unscaled &lt;- beta/sqrt(2*AF*(1-AF))

## generate corresponding haploid quantities
beta_hap &lt;- rep(beta, each=2)
AF_hap &lt;- rep(AF, each=2)

## compute equilibrium outer product covariance component
U &lt;- am_covariance_structure(beta, AF, r)

## construct Correlation matrix
S &lt;- diag(1/sqrt(AF_hap*(1-AF_hap)))
DPLR &lt;- U%o%U
diag(DPLR) &lt;- 1
C &lt;- cov2cor(S%*%DPLR%*%S)

## draw multivariate Bernoulli haplotypes
H &lt;- rb_unstr(n, AF_hap, C)

## convert to diploid genotypes
G &lt;- H[,seq(1,ncol(H),2)] + H[,seq(2,ncol(H),2)]

## empirical allele frequencies vs target frequencies
emp_afs &lt;- colMeans(G)/2
plot(AF, emp_afs)

## construct phenotype
heritable_y &lt;-  G%*%beta_unscaled
nonheritable_y &lt;-  rnorm(n, 0, sqrt(1-h2_0))
y &lt;- heritable_y + nonheritable_y

## empirical h2 vs expected equilibrium h2
(emp_h2 &lt;- var(heritable_y)/var(y))
h2_eq(r, h2_0)
</code></pre>


</div>