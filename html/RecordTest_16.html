<div class="container">

<table style="width: 100%;"><tr>
<td>lr.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood-Ratio Test for the Likelihood of the Record Indicators</h2>

<h3>Description</h3>

<p>This function performs likelihood-ratio tests
for the likelihood of the record indicators <code class="reqn">I_t</code> to study the 
hypothesis of the classical record model (i.e., of IID continuous RVs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">lr.test(
  X,
  record = c("upper", "lower"),
  alternative = c("two.sided", "greater", "less"),
  probabilities = c("different", "equal"),
  simulate.p.value = FALSE,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>record</code></td>
<td>
<p>A character string indicating the type of record, 
"upper" or "lower".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character indicating the alternative hypothesis 
(<code>"two.sided"</code>, <code>"greater"</code> or <code>"less"</code>). 
Different statistics are used in the one-sided and two-sided alternatives
(see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probabilities</code></td>
<td>
<p>A character indicating if the alternative hypothesis 
assume all series with <code>"equal"</code> or <code>"different"</code> probabilities
of record.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate.p.value</code></td>
<td>
<p>Logical. Indicates whether to compute p-values by
Monte Carlo simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An integer specifying the number of replicates used in the Monte 
Carlo estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null hypothesis of the likelihood-ratio tests is that in every vector 
(columns of the matrix <code>X</code>), the probability of record at 
time <code class="reqn">t</code> is <code class="reqn">1 / t</code> as in the classical record model, and 
the alternative depends on the <code>alternative</code> and <code>probabilities</code>
arguments. The probability at time <code class="reqn">t</code> is any value, but equal in the
<code class="reqn">M</code> series if <code>probabilities = "equal"</code>  or different in the 
<code class="reqn">M</code> series if <code>probabilities = "different"</code>. The alternative 
hypothesis is more specific in the first case than in the second one.
Furthermore, the <code>"two.sided"</code> <code>alternative</code> is tested with 
the usual likelihood ratio statistic, while the one-sided 
<code>alternatives</code> use specific statistics based on likelihoods
(see Cebrián, Castillo-Mateo and Asín, 2022, for the details).
</p>
<p>If <code>alternative = "two.sided" &amp; probabilities = "equal"</code>, under the
null, the likelihood ratio statistic has an asymptotic <code class="reqn">\chi^2</code> 
distribution with <code class="reqn">T-1</code> degrees of freedom. It has been seen that for
the approximation to be adequate <code class="reqn">M</code> must be between 4 and 5 times 
greater than <code class="reqn">T</code>. Otherwise, a <code>simulate.p.value</code> is recommended.
</p>
<p>If <code>alternative = "two.sided" &amp; probabilities = "different"</code>, the 
asymptotic behaviour is not fulfilled, but the Monte Carlo approach to 
simulate the p-value is applied. This statistic is the same as <code class="reqn">\ell</code> 
below multiplied by a factor of 2, so the p-value is the same.
</p>
<p>If <code>alternative</code> is one-sided and <code>probabilities = "equal"</code>,
the statistic of the test is
</p>
<p style="text-align: center;"><code class="reqn">-2 \sum_{t=2}^T \left\{-S_t \log\left(\frac{tS_t}{M}\right)+(M-S_t)\left( \log\left(1-\frac{1}{t}\right) - \log\left(1-\frac{S_t}{M}\right) I_{\{S_t&lt;M\}} \right) \right\} I_{\{S_t &gt; M/t\}}.</code>
</p>

<p>The p-value of this test is estimated with Monte Carlo simulations,
because the computation of its exact distribution is very expensive.   
</p>
<p>If <code>alternative</code> is one-sided and <code>probabilities = "different"</code>,
the statistic of the test is
</p>
<p style="text-align: center;"><code class="reqn">\ell = \sum_{t=2}^T  S_{t} \log(t-1) - M \log\left(1-\frac{1}{t}\right).</code>
</p>

<p>The p-value of this test is estimated with Monte Carlo simulations. 
However, it is equivalent to the statistic of the weighted number of 
records <code>N.test</code> with weights <code class="reqn">\omega_t = \log(t-1)</code> 
<code class="reqn">(t=2,\ldots,T)</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>"htest"</code> with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Value of the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>Degrees of freedom of the approximate <code class="reqn">\chi^2</code> 
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>(Estimated) P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the type of test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string indicating the alternative
hypothesis.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2): 313-330. 
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>


<h3>See Also</h3>

<p><code>global.test</code>, <code>score.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(23)
# two-sided and different probabilities of record, always simulated the p-value
lr.test(ZaragozaSeries, probabilities = "different")
# equal probabilities
lr.test(ZaragozaSeries, probabilities = "equal")
# equal probabilities with simulated p-value
lr.test(ZaragozaSeries, probabilities = "equal", simulate.p.value = TRUE)

# one-sided and different probabilities of record
lr.test(ZaragozaSeries, alternative = "greater", probabilities = "different")
# different probabilities with simulated p-value
lr.test(ZaragozaSeries, alternative = "greater", probabilities = "different", 
  simulate.p.value = TRUE)
# equal probabilities, always simulated the p-value
lr.test(ZaragozaSeries, alternative = "greater", probabilities = "equal")
</code></pre>


</div>