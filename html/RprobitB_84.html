<div class="container">

<table style="width: 100%;"><tr>
<td>update_U</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update latent utility vector</h2>

<h3>Description</h3>

<p>This function updates the latent utility vector, where (independent across deciders and choice occasions)
the utility for each alternative is updated conditional on the other utilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">update_U(U, y, sys, Sigmainv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>The current utility vector of length <code>J-1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An integer from <code>1</code> to <code>J</code>, the index of the chosen alternative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sys</code></td>
<td>
<p>A vector of length <code>J-1</code>, the systematic utility part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigmainv</code></td>
<td>
<p>The inverted error term covariance matrix of dimension <code>J-1</code> x <code>J-1</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The key ingredient to Gibbs sampling for probit models is considering the latent utilities
as parameters themselves which can be updated (data augmentation).
Independently for all deciders <code class="reqn">n=1,\dots,N</code> and choice occasions <code class="reqn">t=1,...,T_n</code>,
the utility vectors <code class="reqn">(U_{nt})_{n,t}</code> in the linear utility equation <code class="reqn">U_{nt} = X_{nt} \beta + \epsilon_{nt}</code>
follow a <code class="reqn">J-1</code>-dimensional truncated normal distribution, where <code class="reqn">J</code> is the number of alternatives,
<code class="reqn">X_{nt} \beta</code> the systematic (i.e. non-random) part of the utility and <code class="reqn">\epsilon_{nt} \sim N(0,\Sigma)</code> the error term.
The truncation points are determined by the choices <code class="reqn">y_{nt}</code>. To draw from a truncated multivariate
normal distribution, this function implemented the approach of Geweke (1998) to conditionally draw each component
separately from a univariate truncated normal distribution. See Oelschläger (2020) for the concrete formulas.
</p>


<h3>Value</h3>

<p>An updated utility vector of length <code>J-1</code>.
</p>


<h3>References</h3>

<p>See Geweke (1998) <em>Efficient Simulation from the Multivariate Normal and Student-t Distributions Subject
to Linear Constraints and the Evaluation of Constraint Probabilities</em> for Gibbs sampling
from a truncated multivariate normal distribution. See Oelschläger and Bauer (2020) <em>Bayes Estimation
of Latent Class Mixed Multinomial Probit Models</em> for its application to probit utilities.
</p>


<h3>Examples</h3>

<pre><code class="language-R">U &lt;- c(0,0,0)
y &lt;- 3
sys &lt;- c(0,0,0)
Sigmainv &lt;- solve(diag(3))
update_U(U, y, sys, Sigmainv)
</code></pre>


</div>