<div class="container">

<table style="width: 100%;"><tr>
<td>run.it.importances</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>run.it.importances</h2>

<h3>Description</h3>

<p>run.it.importances
</p>


<h3>Usage</h3>

<pre><code class="language-R">run.it.importances(qq, imp, debug.flag = 0, temp.dir = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>qq</code></td>
<td>
<p>object retuned by plotQ</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imp</code></td>
<td>
<p>"reduction in impurity" importances from a random forest model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug.flag</code></td>
<td>
<p>either 0 (no debugging information), 1 or 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.dir</code></td>
<td>
<p>if debug flag is &gt;0 then information is written to temp.dir</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>return a list contining
</p>

<ul>
<li>
<p> "C_0.95" estimate of the cutoff "C" such that there are only null values to the left of C.
Based on the 95th quantile of the density
</p>
</li>
<li>
<p> "cc"    estimate of the cutoff "C" based on the procedure of Gauran, et al., 2918, Biometrics,
</p>
</li>
<li>
<p> "estimates_C_0.95" estimate of the parameters of the SN using the data up to the C estimate
</p>
</li>
<li>
<p> "estimates_cc"     estimate of the parameters of the SN using the data up to the C estimate
</p>
</li>
<li>
<p> "fdr_0.95"       estimate of the fdr curve using the SN from "estimates_C_0.95"
</p>
</li>
<li>
<p> "fdr_cc"         estimate of the fdr curve using the SN from "estimates_cc"
</p>
</li>
<li>
<p> "x"        the x values from plotQ
</p>
</li>
<li>
<p> "temp.dir" the temp directory for dubuggin
</p>
</li>
<li>
<p> "p0"     the estmate of the proportion of null values (can be 1)
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data(imp20000)
imp &lt;- log(imp20000$importances)
t2 &lt;- imp20000$counts
plot(density((imp)))
hist(imp,col=6,lwd=2,breaks=100,main="histogram of importances")
res.temp &lt;- determine_cutoff(imp, t2 ,cutoff=c(0,1,2,3),plot=c(0,1,2,3),Q=0.75,try.counter=1)
plot(c(0,1,2,3),res.temp[,3])
imp&lt;-imp[t2 &gt; 1]
qq &lt;- plotQ(imp,debug.flag = 0)                                                          
ppp&lt;-run.it.importances(qq,imp,debug=0)                                                       
aa&lt;-significant.genes(ppp,imp,cutoff=0.2,debug.flag=0,do.plot=2, use_95_q=TRUE)                           
length(aa$probabilities) #11#                                                          
names(aa$probabilities)


library(RFlocalfdr.data)
data(ch22)                                                                                 
? ch22                                                                                     
#document how the data set is created                                                      
plot(density(log(ch22$imp)))                                                               
t2 &lt;-ch22$C                                                                                
imp&lt;-log(ch22$imp)                                                                         
#Detemine a cutoff to get a unimodal density.                                              
res.temp &lt;- determine_cutoff(imp, t2 ,cutoff=c(1,10,20,30),plot=c(1,10,20,30),Q=0.75)      
plot(c(1,2,3,4),res.temp[,3])                                                              
                                                                                           
res.temp &lt;- determine_cutoff(imp, t2 ,cutoff=c(25,30,35,40),plot=c(25,30,35,40),Q=0.75)    
plot(c(25,30,35,40),res.temp[,3])                                                          
imp&lt;-imp[t2 &gt; 30]
qq &lt;- plotQ(imp,debug.flag = 0)                                                          
ppp&lt;-run.it.importances(qq,imp,debug=0)                                                       
aa&lt;-significant.genes(ppp,imp,cutoff=0.2,debug.flag=0,do.plot=2)                           
length(aa$probabilities) # 6650                                                            
aa&lt;-significant.genes(ppp,imp,cutoff=0.05,debug.flag=0,do.plot=2)                          
length(aa$probabilities) # 3653

</code></pre>


</div>