<div class="container">

<table style="width: 100%;"><tr>
<td>spectralG.cpp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform spectral decomposition (inplemented by Rcpp)</h2>

<h3>Description</h3>

<p>Perform spectral decomposition for <code class="reqn">G = ZKZ'</code> or <code class="reqn">SGS</code> where <code class="reqn">S = I - X(X'X)^{-1}X</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spectralG.cpp(
  ZETA,
  ZWs = NULL,
  X = NULL,
  weights = 1,
  return.G = TRUE,
  return.SGS = FALSE,
  spectral.method = NULL,
  tol = NULL,
  df.H = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ZETA</code></td>
<td>
<p>A list of variance (relationship) matrix (K; <code class="reqn">m \times m</code>) and its design matrix (Z; <code class="reqn">n \times m</code>) of random effects. You can use only one kernel matrix.
For example, ZETA = list(A = list(Z = Z, K = K))
Please set names of list "Z" and "K"!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZWs</code></td>
<td>
<p>A list of additional linear kernels other than genomic relationship matrix (GRM).
We utilize this argument in RGWAS.multisnp function, so you can ignore this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code class="reqn">n \times p</code> matrix. You should assign mean vector (rep(1, n)) and covariates. NA is not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>If the length of ZETA &gt;= 2, you should assign the ratio of variance components to this argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.G</code></td>
<td>
<p>If thie argument is TRUE, spectral decomposition results of G will be returned.
(<code class="reqn">G = ZKZ'</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.SGS</code></td>
<td>
<p>If this argument is TRUE, spectral decomposition results of SGS will be returned.
(<code class="reqn">S = I - X(X'X)^{-1}X</code>, <code class="reqn">G = ZKZ'</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spectral.method</code></td>
<td>
<p>The method of spectral decomposition.
In this function, "eigen" : eigen decomposition and "cholesky" : cholesky and singular value decomposition are offered.
If this argument is NULL, either method will be chosen accorsing to the dimension of Z and X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The tolerance for detecting linear dependencies in the columns of G = ZKZ'.
Eigen vectors whose eigen values are less than "tol" argument will be omitted from results.
If tol is NULL, top 'n' eigen values will be effective.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.H</code></td>
<td>
<p>The degree of freedom of K matrix. If this argument is NULL, min(n, sum(nrow(K1), nrow(K2), ...)) will be assigned.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<dl>
<dt>$spectral.G</dt>
<dd>
<p>The spectral decomposition results of G.</p>
</dd>
<dt>$U</dt>
<dd>
<p>Eigen vectors of G.</p>
</dd>
<dt>$delta</dt>
<dd>
<p>Eigen values of G.</p>
</dd>
<dt>$spectral.SGS</dt>
<dd>
<p>Estimator for <code class="reqn">\sigma^2_e</code></p>
</dd>
<dt>$Q</dt>
<dd>
<p>Eigen vectors of SGS.</p>
</dd>
<dt>$theta</dt>
<dd>
<p>Eigen values of SGS.</p>
</dd>
</dl>
</div>