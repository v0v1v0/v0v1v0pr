<div class="container">

<table style="width: 100%;"><tr>
<td>closedp.custom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Customization of a Loglinear Model for Closed Populations Capture-Recapture Experiments </h2>

<h3>Description</h3>

<p>As of version 1.2-0 of <span class="pkg">Rcapture</span>, these functions are deprecated, but kept for back compatibility. Please use <code>closedpCI.t</code> instead. 
</p>
<p>The <code>closedp.mX</code> function fits a loglinear model given a design matrix <code>mX</code>. The <code>closedp.h</code> function 
fits Mh or Mth models for which the form of the column for heterogeneity in the design matrix is determined by the user. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">closedp.mX(X, dfreq=FALSE, mX, mname="Customized model")

closedp.h(X, dfreq=FALSE, m="Mh", h="Poisson", a=2)

## S3 method for class 'closedp.custom'
print(x, ...)

## S3 method for class 'closedp.custom'
boxplot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> The matrix of the observed capture histories (see <code>Rcapture-package</code> for a description of the accepted formats).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfreq</code></td>
<td>
<p> A logical. By default FALSE, which means that <code>X</code> has one row per unit. If TRUE, it indicates that the
matrix <code>X</code> contains frequencies in its last column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mX</code></td>
<td>
<p> The design matrix of the loglinear model. In this matrix, the order of the capture histories is as defined in the 
<code>histpos.t</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mname</code></td>
<td>
<p> A character string specifying the name of the customized model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> A character string indicating the model to fit, either "Mh"=Mh model or "Mth"=Mth model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p> The character string "Poisson" (<code class="reqn">2^k-1</code>) or a numerical function taking only one argument specifying the form of 
the column for heterogeneity in the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p> The value of the exponent's base for a Poisson model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> An object, produced by the <code>closedp.mX</code> or the <code>closedp.h</code> function, to print or to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

 
<p>An intercept is added to the model. Therefore, the mX matrix must not contain a column of ones.
</p>
<p>The abundance estimation is calculated as the number of captured units plus the exponential of the intercept. Therefore, 
these functions are not suited for models with a behavioral effect.
</p>
<p>In <code>closedp.h</code>, the argument <code>h</code> cannot take the value "Chao" or "Darroch" because these models are already 
fitted by the <code>closedp</code> function.
</p>
<p>The <code>boxplot.closedp.custom</code> function produces a boxplot of the pearson residuals of the customized model.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The number of captured units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p> A table containing the estimated population size and its standard error, the deviance, 
the number of degrees of freedom and the Akaike's information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm</code></td>
<td>
<p> The 'glm' object obtained from fitting the model.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> These functions use the <code>glm</code> function of the <span class="pkg">stats</span> package. </p>


<h3>Author(s)</h3>

<p> Louis-Paul Rivest <a href="mailto:Louis-Paul.Rivest@mat.ulaval.ca">Louis-Paul.Rivest@mat.ulaval.ca</a> and Sophie Baillargeon </p>


<h3>References</h3>

 
<p>Rivest, L.P. and Baillargeon, S. (2007) Applications and extensions of Chao's moment estimator for the size of a closed population. <em>Biometrics</em>, <b>63</b>(4), 999â€“1006.
</p>


<h3>See Also</h3>

<p><code>closedp</code>, <code>closedp.Mtb</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># HIV data set
mat &lt;- histpos.t(4)
mX2 &lt;- cbind(mat, mat[, 1] * mat[, 2])
closedp.mX(HIV, dfreq = TRUE, mX = mX2)

# Third primary period of mvole data set
period3 &lt;- mvole[, 11:15]
psi &lt;- function(x) { -log(3.5 + x) + log(3.5) }
closedp.h(period3, h = psi)
</code></pre>


</div>