<div class="container">

<table style="width: 100%;"><tr>
<td>warp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Warp elements of a univariate functional dataset</h2>

<h3>Description</h3>

<p>This function carries out the warping of elements of a univariate functional
dataset by using a set of pre-computed warping functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">warp(fData, warpings)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fData</code></td>
<td>
<p>the functional dataset whose observations must be warped in
form of <code>fData</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warpings</code></td>
<td>
<p>the warping functions <code class="reqn">H_1, \ldots, H_N</code>, in form of
<code>fData</code> object, defined over the registered/warped grid.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a univariate functional dataset <code class="reqn">X_1(t), \ldots, X_N(t)</code> and a set
of warping functions <code class="reqn">H_1(t), \ldots, H_N(t)</code>, such that:
</p>
<p style="text-align: center;"><code class="reqn"> H_i : s \longrightarrow t = H_i(s), \quad \forall i = 1, \ldots, N,</code>
</p>

<p>where <code class="reqn">s</code> spans the warped (or registered) grid and <code class="reqn">t</code> spans the
original grid, the function computes the warping given by the following
composition:
</p>
<p style="text-align: center;"><code class="reqn"> X_1 \circ H_1(t), \ldots, X_N \circ H_N(t).</code>
</p>



<h3>Value</h3>

<p>The function returns the univariate functional dataset of warped
functions, in form of <code>fData</code> object.
</p>


<h3>See Also</h3>

<p><code>fData</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed( 1618033 )

N = 30

t0 = 0
t1 = 1
P = 1e3 + 1

time_grid = seq( t0, t1, length.out = P )

means = round( runif( N,
                      t0 + (t1 - t0) / 8,
                      t1 - (t1 - t0) / 8  ), 3 )

Data = matrix( sapply( means,
                       function( m )( dnorm( time_grid, mean = m, sd = 0.05 ) ) ),
               ncol = P, nrow = N, byrow = TRUE )

fD = fData( time_grid, Data )

# Piecewise linear warpings
template_warping = function( m )( c( time_grid[ time_grid &lt;= 0.5 ] * m / 0.5,
                                     ( time_grid[ time_grid &gt; 0.5 ]
                                       - 0.5 ) * (1 - m ) / 0.5 + m ) )


warpings = matrix( sapply( means, template_warping ),
                   ncol = P,
                   nrow = N, byrow = TRUE )

wfD = fData( time_grid, warpings )

fD_warped = warp( fD, wfD )

dev.new()
oldpar &lt;- par(mfrow = c(1, 1))
par(mfrow = c(1, 3))

plot( fD,
     main = 'Unregistered functions', xlab = 'actual grid', ylab = 'values'  )
plot( wfD,
     main = 'Warping functions', xlab = 'registered grid',
     ylab = 'actual grid' )
plot( fD_warped,
     main = 'Warped functions', xlab = 'registered grid',
     ylab = 'values' )

par(oldpar)

</code></pre>


</div>