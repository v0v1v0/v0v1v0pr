<div class="container">

<table style="width: 100%;"><tr>
<td>rdsampsi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size Calculations for RD Designs</h2>

<h3>Description</h3>

<p><code>rdsampsi()</code> performs sample size calculations for RD designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdsampsi(
  data = NULL,
  cutoff = 0,
  tau = NULL,
  alpha = 0.05,
  beta = 0.8,
  samph = NULL,
  nsamples = NULL,
  all = FALSE,
  bias = NULL,
  variance = NULL,
  nratio = NULL,
  init.cond = NULL,
  plot = FALSE,
  graph.range = NULL,
  covs = NULL,
  covs_drop = TRUE,
  deriv = 0,
  p = 1,
  q = NULL,
  h = NULL,
  b = NULL,
  rho = NULL,
  kernel = "triangular",
  bwselect = "mserd",
  vce = "nn",
  cluster = NULL,
  scalepar = 1,
  scaleregul = 1,
  fuzzy = NULL,
  level = 95,
  weights = NULL,
  masspoints = "adjust",
  bwcheck = NULL,
  bwrestrict = TRUE,
  stdvars = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix (Y,R) containing the outcome variable and the running variable (as column vectors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the RD cutoff (default is 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>specifies the treatment effect under the alternative at which the power function is evaluated. The default is half the standard deviation of the outcome for the untreated group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>specifies the significance level for the power function. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>specifies the desired power. Default is 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samph</code></td>
<td>
<p>sets the bandwidths at each side of the cutoff for power calculation. The first number is the bandwidth to the left of the cutoff and the second number is the bandwidth to the right.  Default values are the bandwidths used by <code>rdrobust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamples</code></td>
<td>
<p>sets the total sample size to the left, sample size to the left inside the bandwidth, total sample size to the right and sample size to the right of the cutoff inside the bandwidth to calculate the variance when the running variable is not specified. When not specified, the values are calculated using the running variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>
<p>displays the power using the conventional variance estimator, in addition to the robust bias corrected one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias</code></td>
<td>
<p>set bias to the left and right of the cutoff. If not specified, the biases are estimated using <code>rdrobust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>set variance to the left and right of the cutoff. If not specified, the variances are estimated using <code>rdrobust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nratio</code></td>
<td>
<p>specifies the proportion of treated units in the window. Default is the ratio of the standard deviation of the treated to the sum of the standard deviations for treated and controls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.cond</code></td>
<td>
<p>sets the initial condition for the Newton-Raphson algorithm that finds the sample size.  Default is the number of observations in the sample with non-missing values of the outcome and running variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>plots the power function using the conventional and robust bias corrected standard errors from <code>rdrobust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph.range</code></td>
<td>
<p>range of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies additional covariates to be used for estimation and inference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs_drop</code></td>
<td>
<p>option for <code>rdrobust()</code>: if TRUE, it checks for collinear additional covariates and drops them. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the derivative of the regression functions to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the local-polynomial used to construct the point-estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the local-polynomial used to construct the bias-correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the values of the main bandwidth to be used on the left and on the right of the cutoff, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the values of the bias bandwidth $b$ to be used on the left and on the right of the cutoff, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the value of <code>rho</code> so that the bias bandwidth <code>b</code> equals <code>b=h/rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>option for <code>rdrobust()</code>: kernel function used to construct the local-polynomial estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwselect</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the bandwidth selection procedure to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vce</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the procedure used to compute the variance-covariance matrix estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>option for <code>rdrobust()</code>: indicates the cluster ID variable used for the cluster-robust variance estimation with degrees-of-freedom weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalepar</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies scaling factor for RD parameter of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleregul</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies scaling factor for the regularization terms of bandwidth selectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzzy</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the treatment status variable used to implement fuzzy RD estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>option for <code>rdrobust()</code>: sets the confidence level for confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>option for <code>rdrobust()</code>: is the variable used for optional weighting of the estimation procedure. The unit-specific weights multiply the kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>masspoints</code></td>
<td>
<p>option for <code>rdrobust()</code>: checks and controls for repeated observations in tue running variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwcheck</code></td>
<td>
<p>option for <code>rdrobust()</code>: if a positive integer is provided, the preliminary bandwidth used in the calculations is enlarged so that at least <code>bwcheck</code> unique observations are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwrestrict</code></td>
<td>
<p>option for <code>rdrobust()</code>: if TRUE, computed bandwidths are restricted to lie withing the range of <code>x</code>. Default is <code>bwrestrict=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdvars</code></td>
<td>
<p>option for <code>rdrobust()</code>: if <code>TRUE</code>, <code>x</code> and <code>y</code> are standardized before computing the bandwidths. Default is <code>stdvars=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>desired power</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>treatment effect under alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsi.h.tot</code></td>
<td>
<p>total number of observations inside the window</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsi.h.r</code></td>
<td>
<p>number of observations inside the window to the right of the cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsi.h.l</code></td>
<td>
<p>number of observations inside the window to the left of the cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.r</code></td>
<td>
<p>Total sample size to the right of the cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.l</code></td>
<td>
<p>Total sample size to the left of the cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samph.r</code></td>
<td>
<p>bandwidth to the right of the cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samph.l</code></td>
<td>
<p>bandwidth to the left of the cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.r</code></td>
<td>
<p>Robust bias corrected variance to the right of the cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.l</code></td>
<td>
<p>Robust bias corrected variance to the left of the cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsi.h.tot.cl</code></td>
<td>
<p>implied total number of observations inside the window using conventional s.e.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsi.h.r.cl</code></td>
<td>
<p>number of observations inside the window to the right of the cutoff using conventional s.e.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsi.h.l.cl</code></td>
<td>
<p>number of observations inside the window to the left of the cutoff using conventional s.e.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.iter</code></td>
<td>
<p>number of iterations until convergence of the Newton-Raphson algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.cond</code></td>
<td>
<p>initial condition of the Newton-Raphson algorithm</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matias Cattaneo, Princeton University. <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>
</p>
<p>Rocio Titiunik, Princeton University. <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>
</p>
<p>Gonzalo Vazquez-Bare, UC Santa Barbara. <a href="mailto:gvazquez@econ.ucsb.edu">gvazquez@econ.ucsb.edu</a>
</p>


<h3>References</h3>

<p>Cattaneo, M. D., R. Titiunik and G. Vazquez-Bare. (2019). <a href="https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2019_Stata.pdf">Power Calculations for Regression Discontinuity Designs</a>. <em>Stata Journal</em>, 19(1): 210-245.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Toy dataset
X &lt;- array(rnorm(2000),dim=c(1000,2))
R &lt;- X[,1] + X[,2] + rnorm(1000)
Y &lt;- 1 + R -.5*R^2 + .3*R^3 + (R&gt;=0) + rnorm(1000)
# Sample size to achieve power of 0.8 against tau = 1
tmp &lt;- rdsampsi(data=cbind(Y,R),tau=1)
# Sample size against tau = 1 including covariates
tmp &lt;- rdsampsi(data=cbind(Y,R),tau=1,covs=X)


</code></pre>


</div>