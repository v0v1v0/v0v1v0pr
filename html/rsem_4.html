<div class="container">

<table style="width: 100%;"><tr>
<td>rsem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The main function for robust SEM analysis
</h2>

<h3>Description</h3>

<p>This is the function to carry out all analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsem(dset, select, EQSmodel, moment=TRUE, varphi=.1, st='i', max.it=1000, 
eqsdata='data.txt', eqsweight='weight.txt', EQSpgm="C:/Progra~1/EQS61/WINEQS.EXE", 
serial="1234")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dset</code></td>
<td>

<p>A data matrix or a data frame
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>

<p>Variables to be seleted for SEM analysis. If omitted, all variables in the data set will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moment</code></td>
<td>
<p>With mean structure. For covariance only, set moment=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EQSmodel</code></td>
<td>

<p>The input file  for EQS. If omitted, only the first-stage analysis will be conducted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varphi</code></td>
<td>

<p>Proportion of data to be down-weighted. Default is 0.1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.it</code></td>
<td>
<p>Maximum number of iterations for EM. Default is 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>Starting values for EM algorithm. The default is 0 for mean and I for covariance. Alternative, the starting values can be estimated according to MCD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eqsdata</code></td>
<td>
<p>Data file name used in EQS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eqsweight</code></td>
<td>
<p>File name for weight matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EQSpgm</code></td>
<td>
<p>The path to the installed EQS program</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>serial</code></td>
<td>
<p>The serial no of EQS</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function will run the robust analysis and output results.
</p>


<h3>Value</h3>


<p>If <code>EQSmodel</code> is not supplied
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sem</code></td>
<td>
<p>Information for SEM analysis including estimated means, covariance matrix and their sandwich type covariance matrix in the order of mean first and then covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>misinfo</code></td>
<td>
<p>Information related to missing data pattern</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em</code></td>
<td>
<p>Results from expectation robust algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ascov</code></td>
<td>
<p>Covariance matrix</p>
</td>
</tr>
</table>
<p>If <code>EQSmodel</code> is supplied,   
</p>
<table><tr style="vertical-align: top;">
<td><code>sem</code></td>
<td>
<p>Information for SEM analysis including estimated means, covariance matrix and their sandwich type covariance matrix according to the requirement of EQS.</p>
</td>
</tr></table>
<p>In addition, the following model parameters are from EQS  
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit.stat</code></td>
<td>
<p>Fit indices and associated p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eqs</code></td>
<td>
<p>All information from REQS</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>See Also</h3>

<p><code>rsem.pattern</code>, <code>rsem.emmusig</code>, <code>rsem.Ascov</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## an example
 ## to use eqs, first load the package semdiag
 library(semdiag)
 data(mardiamv25)
 analysis&lt;-rsem(mardiamv25, c(1,2,4,5), 'eqsinput.eqs')
 
## End(Not run)
</code></pre>


</div>