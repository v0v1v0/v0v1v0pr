<div class="container">

<table style="width: 100%;"><tr>
<td>perturb_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perturbation analysis of a matrix population model</h2>

<h3>Description</h3>

<p>Perturbs elements within a matrix population model and measures the response
(sensitivity or elasticity) of the per-capita population growth rate at
equilibrium (<code class="reqn">\lambda</code>), or, with a user-supplied function, any other
demographic statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perturb_matrix(
  matA,
  pert = 1e-06,
  type = "sensitivity",
  demog_stat = "lambda",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matA</code></td>
<td>
<p>A matrix population model (i.e., a square projection matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pert</code></td>
<td>
<p>Magnitude of the perturbation. Defaults to <code>1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Whether to return <code>sensitivity</code> or <code>elasticity</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demog_stat</code></td>
<td>
<p>The demographic statistic to be used, as in "the
sensitivity/elasticity of <code>demog_stat</code> to matrix element
perturbations." Defaults to the per-capita population growth rate at
equilibrium (<code class="reqn">\lambda</code>). Also accepts a user-supplied function that
performs a calculation on a projection matrix and returns a single numeric
value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the function <code>demog_stat</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A sensitivity or elasticity matrix.
</p>


<h3>Author(s)</h3>

<p>Rob Salguero-Gomez &lt;rob.salguero@zoo.ox.ac.uk&gt;
</p>


<h3>References</h3>

<p>Caswell, H. 2001. Matrix Population Models: Construction,
Analysis, and Interpretation. Sinauer Associates; 2nd edition. ISBN:
978-0878930968
</p>


<h3>See Also</h3>

<p>Other perturbation analysis: 
<code>perturb_stochastic()</code>,
<code>perturb_trans()</code>,
<code>perturb_vr()</code>,
<code>pop_vectors()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">matA &lt;- rbind(
  c(0.1, 0, 1.5, 4.6),
  c(0.5, 0.2, 0.1, 0),
  c(0, 0.3, 0.3, 0.1),
  c(0, 0, 0.5, 0.6)
)

perturb_matrix(matA)

# use a larger perturbation than the default
perturb_matrix(matA, pert = 0.01)

# calculate the sensitivity/elasticity of the damping ratio to perturbations
damping &lt;- function(matA) { # define function for damping ratio
  eig &lt;- eigen(matA)$values
  dm &lt;- rle(Mod(eig))$values
  return(dm[1] / dm[2])
}

perturb_matrix(matA, demog_stat = "damping")

</code></pre>


</div>