<div class="container">

<table style="width: 100%;"><tr>
<td>fastLm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bare-bones linear model fitting function</h2>

<h3>Description</h3>

<p><code>fastLm</code> estimates the linear model using the <code>gsl_multifit_linear</code>
function of the <code>GNU GSL</code> library.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fastLmPure(X, y)

fastLm(X, ...)
## Default S3 method:
fastLm(X, y, ...)
## S3 method for class 'formula'
fastLm(formula, data = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector containing the explained variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a model matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Linear models should be estimated using the <code>lm</code> function. In
some cases, <code>lm.fit</code> may be appropriate.
</p>
<p>The <code>fastLmPure</code> function provides a reference use case of the <code>GSL</code>
library via the wrapper functions in the <span class="pkg">RcppGSL</span> package.
</p>
<p>The <code>fastLm</code> function provides a more standard implementation of
a linear model fit, offering both a default and a formula interface as
well as <code>print</code>, <code>summary</code> and <code>predict</code> methods.
</p>
<p>Lastly, one must be be careful in timing comparisons of
<code>lm</code> and friends versus this approach based on <code>GSL</code>
or <code>Armadillo</code>. The reason that <code>GSL</code> or <code>Armadillo</code> can
do something like <code>lm.fit</code> faster than the functions in
the stats package is because they use the Lapack version
of the QR decomposition while the stats package uses a <em>modified</em>
Linpack version.  Hence <code>GSL</code> and <code>Armadillo</code> uses level-3 BLAS code
whereas the stats package uses level-1 BLAS.  However,
<code>GSL</code> or <code>Armadillo</code> will choke on rank-deficient model matrices whereas
the functions from the stats package will handle them properly due to
the modified Linpack code.  Statisticians want a pivoting scheme of
“pivot only on (apparent) rank deficiency” and numerical
analysts have no idea why statisticians want this so it is not part of
conventional linear algebra software.
</p>


<h3>Value</h3>

<p><code>fastLmPure</code> returns a list with three components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a vector of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderr</code></td>
<td>
<p>a vector of the (estimated) standard errors of the coefficient estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a scalar denoting the degrees of freedom in the model</p>
</td>
</tr>
</table>
<p><code>fastLm</code> returns a richer object which also includes the
residuals and call similar to the <code>lm</code> or
<code>rlm</code> functions..
</p>


<h3>Author(s)</h3>

<p>The GNU GSL library is being written by team of authors with the
overall development, design and implementation lead by Brian Gough and
Gerard Jungman.  RcppGSL is written by Romain Francois and Dirk Eddelbuettel.
</p>


<h3>References</h3>

<p>GNU GSL project: <a href="https://www.gnu.org/software/gsl/">https://www.gnu.org/software/gsl/</a></p>


<h3>See Also</h3>

<p><code>lm</code>, <code>lm.fit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  data(trees, package="datasets")

  ## bare-bones direct interface
  flm &lt;- fastLmPure( cbind(1, log(trees$Girth)), log(trees$Volume) )
  print(flm)

  ## standard R interface for formula or data returning object of class fastLm
  flmmod &lt;- fastLm( log(Volume) ~ log(Girth), data=trees)
  summary(flmmod)

</code></pre>


</div>