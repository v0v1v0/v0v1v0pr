<div class="container">

<table style="width: 100%;"><tr>
<td>mixture_draw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Separate a chosen proportion of a reference dataset into a mixture with known population proportions</h2>

<h3>Description</h3>

<p>Takes a reference dataset and a set of population proportions, either at the collection
or reporting unit level. Randomly samples individuals to satisfy these desired proportions,
and splits them into a new "mixture" dataframe.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixture_draw(D, rhos = NULL, omegas = NULL, N, min_remaining = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>a two-column genetic dataframe with "indiv", "repunit", and "collection" columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhos</code></td>
<td>
<p>a vector of the desired reporting unit proportions in the mixture set;
if not named, will be assumed to be ordered by order of appearance in the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omegas</code></td>
<td>
<p>the desired collection proportions in the mixture set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the total size of the mixture set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_remaining</code></td>
<td>
<p>the fraction of any collection in the reference dataset which must remain
at the end of the draw</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>mixture_draw</code> returns a list of two data frames,
"mixture" being the random sample taken, and "reference" being the remaining samples
</p>


<h3>Examples</h3>

<pre><code class="language-R">rhos &lt;- as.vector(gtools::rdirichlet(1, table(alewife$repunit)))
cross_val &lt;- mixture_draw(D = alewife, rhos = rhos, N = 100, min_remaining = .005)

</code></pre>


</div>