<div class="container">

<table style="width: 100%;"><tr>
<td>kfunc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting K-functions for a Set of Surveys</h2>

<h3>Description</h3>

<p>Plots K-functions for locations in each of a set of surveys.  In
this implementation, this can be interpreted as the proportion of 
additional fish within a given distance.  This will increase as a function 
of distance, and may provide evidence of clustering or dispersion features,
particularly if the envelope is used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kfunc(
  seg,
  vert,
  survey = NULL,
  rivers,
  lwd = 2,
  envelope = TRUE,
  envreps = 1000,
  envcol = "grey80",
  envborder = NA,
  maxdist = NULL,
  xlab = "Distance",
  ylab = "% within",
  showN = TRUE,
  whichplots = NULL,
  returnoutput = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seg</code></td>
<td>
<p>A vector of river locations (segment)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vert</code></td>
<td>
<p>A vector of river locations (vertex)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survey</code></td>
<td>
<p>A vector of survey IDs corresponding to the values of 
<code>seg</code> and <code>vert</code>.  Defaults to <code>NULL</code>.  If this argument is 
used, K-functions will be calculated for each unique survey, and separate 
plots will be produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rivers</code></td>
<td>
<p>The river network object to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width used for plotting.  Defaults to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envelope</code></td>
<td>
<p>Whether to construct and display a 95 percent confidence 
envelope (see note.)  Defaults to <code>TRUE</code> if <code>survey</code> is specified, and is automatically <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envreps</code></td>
<td>
<p>Number of bootstrap replicates to use for envelope 
calculation.  Defaults to 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envcol</code></td>
<td>
<p>Color to use for envelope plotting.  Defaults to 
<code>"grey80"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envborder</code></td>
<td>
<p>Border color to use for envelope plotting.  Defaults to 
<code>NA</code>, which will result in no border being plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>Maximum distance (x-axis value) for plotting.  The default 
value (<code>NULL</code>) will result in an appropriate value being chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X-coordinate label for plotting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y-coordinate label for plotting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showN</code></td>
<td>
<p>Whether to show the sample size for each survey in each plot 
title.  Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichplots</code></td>
<td>
<p>A vector of plots to produce, if multiple plots are 
produced.  For example, specifying <code>whichplot=c(2,3,4)</code> will result in
only the second, third, and fourth plots of the sequence being produced. 
Accepting the default (<code>NULL</code>) will result in all plots being 
produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnoutput</code></td>
<td>
<p>Whether to return output instead of producing a plot.  Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional plotting parameters.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>K-function envelopes for each survey are constructed by bootstrapping 
all within-survey distances, that is, the distances between all individuals
within each survey, for all surveys.  This results in a confidence envelope
under the assumption that spacing is independent of survey; therefore a
survey K-function outside the envelope provides evidence of clustering or 
dispersal in that survey that is outside the typical range.  An envelope is not available if only one survey is plotted.
</p>
<p>A K-function above the envelope for a given distance range provides
evidence of a greater number of individuals than expected at that distance
range (clustering); A K-function below the envelope for a given distance
range provides evidence of a smaller number of individuals than expected at
that distance range (dispersal).
</p>
<p>This function is distance-computation intensive, and will be extremely slow-running if a river network is used that does not have segment routes and/or distance lookup tables for fast distance computation.  See buildsegroutes and/or buildlookup for more information.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Gulk, fakefish)

# # 10 plots will be created - recommend calling
# # par(mfrow=c(3,4))

kfunc(seg=fakefish$seg, vert=fakefish$vert, rivers=Gulk, survey=fakefish$flight,
envreps=100, maxdist=200000)

# # This shows relatively high amounts of clustering for surveys 1 and 8,
# # and relatively high amounts of dispersal in surveys 5 and 6.


# # plotting the survey locations that led to this calculation, for comparison

# # 10 plots will be created - recommend calling
# # par(mfrow=c(3,4))
for(i in 1:10) {
  plot(x=Gulk, segmentnum=FALSE, color=FALSE, main=i)
  riverpoints(seg=fakefish$seg[fakefish$flight==i], 
  vert=fakefish$vert[fakefish$flight==i], rivers=Gulk, col=2, pch=15)
}
</code></pre>


</div>