<div class="container">

<table style="width: 100%;"><tr>
<td>wald.ptheo.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Wald test for comparison of a proportion to a theoretical value
</h2>

<h3>Description</h3>

<p>Performs a Wald test for comparison of a proportion to a theoretical value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wald.ptheo.test(y, blocks = NULL, p = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>either a binary response (numeric vector or factor, with only two possible values except NA) or a two-column matrix with the columns giving the numbers of successes (left) and failures (right).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks</code></td>
<td>

<p>optional blocking (random) factor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>hypothesized probability of success.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function builds a logistic (mixed) regression and applies a Wald test to compare the estimated value of the intercept to its theoretical value under H0. Eventual overdispersion is taken into account, by using a quasi-binomial law in case of no blocks or by introducing an individual-level random factor if blocks are present.
</p>
<p>If the response is a 0/1 vector, the probability of the '1' group is tested. With other vectors, the response is transformed into a factor and the probability of the second level is tested.
</p>
<p>If the response is a two-column matrix, the probability of the left column is tested.
</p>
<p>If the reponse is a vector and no blocking factor is present, the exact binomial test performed by <code>binom.test</code> should be preferred since it is an exact test, whereas the Wald test is an approximate test.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>name of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>test statistics of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the estimated proportion (calculated without taking into account the blocking factor, if present).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis, always <code>"two.sided"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>the value of the proportion under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>the degrees of freedom for the t-statistic, only whith overdispersion and no blocks.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Maxime HERVE &lt;maxime.herve@univ-rennes1.fr&gt;
</p>


<h3>See Also</h3>

<p><code>binom.test</code>, <code>glm</code>, <code>glmer</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(2006)
response &lt;- sample(0:1,60,replace=TRUE)

# Comparison to p=0.5
wald.ptheo.test(response)

# Comparison to p=0.8
wald.ptheo.test(response,p=0.8)

# With a blocking factor

require(lme4)
blocks &lt;- gl(3,20)
wald.ptheo.test(response,blocks)
</code></pre>


</div>