<div class="container">

<table style="width: 100%;"><tr>
<td>RDestimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression Discontinuity Estimation</h2>

<h3>Description</h3>

<p><code>RDestimate</code> supports both sharp and fuzzy RDD
utilizing the <span class="pkg">AER</span> package for 2SLS regression
under the fuzzy design. Local linear regressions are performed
to either side of the cutpoint using the Imbens-Kalyanaraman
optimal bandwidth calculation, <code>IKbandwidth</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RDestimate(formula, data, subset = NULL, cutpoint = NULL, bw = NULL,
  kernel = "triangular", se.type = "HC1", cluster = NULL,
  verbose = FALSE, model = FALSE, frame = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula of the RDD. This is supplied in the
format of <code>y ~ x</code> for a simple sharp RDD, or <code>y ~ x | c1 + c2</code>
for a sharp RDD with two covariates. Fuzzy RDD may be specified as
<code>y ~ x + z</code> where <code>x</code> is the running variable, and 
<code>z</code> is the endogenous treatment variable. Covariates are then included in the 
same manner as in a sharp RDD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutpoint</code></td>
<td>
<p>the cutpoint. If omitted, it is assumed to be 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>a numeric vector specifying the bandwidths at which to estimate the RD. 
If omitted, the bandwidth is calculated using the Imbens-Kalyanaraman method, and then estimated
with that bandwidth, half that bandwidth, and twice that bandwidth. If only a single value is passed into the function,
the RD will similarly be estimated at that bandwidth, half that bandwidth, and twice that bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>a string specifying the kernel to be used in the local linear fitting. 
<code>"triangular"</code> kernel is the default and is the "correct" theoretical kernel to be used for 
edge estimation as in RDD (Lee and Lemieux 2010). Other options are <code>"rectangular"</code>, 
<code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, <code>"gaussian"</code> and <code>"cosine"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.type</code></td>
<td>
<p>this specifies the robust SE calculation method to use. Options are,
as in <code>vcovHC</code>, <code>"HC3"</code>, <code>"const"</code>, <code>"HC"</code>, <code>"HC0"</code>, 
<code>"HC1"</code>, <code>"HC2"</code>, <code>"HC4"</code>, <code>"HC4m"</code>, <code>"HC5"</code>. This option 
is overriden by <code>cluster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>an optional vector specifying clusters within which the errors are assumed
to be correlated. This will result in reporting cluster robust SEs. This option overrides
anything specified in <code>se.type</code>. It is suggested that data with a discrete running 
variable be clustered by each unique value of the running variable (Lee and Card 2008).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>will provide some additional information printed to the terminal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>logical. If <code>TRUE</code>, the model object will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame</code></td>
<td>
<p>logical. If <code>TRUE</code>, the data frame used in model fitting will be returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Covariates are problematic for inclusion in the regression
discontinuity design. This package allows their inclusion, but cautions
against them insomuch as is possible. When covariates are included in the
specification, they are simply included as exogenous regressors. In the
sharp design, this means they are simply added into the regression equation,
uninteracted with treatment. Likewise for the fuzzy design, in which they
are added as regressors in both stages of estimation.
</p>


<h3>Value</h3>

<p><code>RDestimate</code> returns an object of class "<code>RD</code>".
The functions <code>summary</code> and <code>plot</code> are used to obtain and print a summary and plot of
the estimated regression discontinuity. The object of class <code>RD</code> is a list 
containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string denoting either <code>"sharp"</code> or <code>"fuzzy"</code> RDD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>numeric vector of the estimate of the discontinuity in the outcome under a sharp design, 
or the Wald estimator in the fuzzy design for each corresponding bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>numeric vector of the standard error for each corresponding bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>numeric vector of the z statistic for each corresponding bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric vector of the p value for each corresponding bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>the matrix of the 95
for each corresponding bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>numeric vector of each bandwidth used in estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>vector of the number of observations within the corresponding bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>the observations removed from fitting due to missingness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>(if requested) For a sharp design, a list of the <code>lm</code> objects is returned.
For a fuzzy design, a list of lists is returned, each with two elements: <code>firststage</code>, the first stage <code>lm</code>
object, and <code>iv</code>, the <code>ivreg</code> object. A model is returned for each corresponding bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame</code></td>
<td>
<p>(if requested) Returns the model frame used in fitting.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Drew Dimmery &lt;<a href="mailto:drewd@nyu.edu">drewd@nyu.edu</a>&gt;
</p>


<h3>References</h3>

<p>Lee, David and Thomas Lemieux. (2010) "Regression Discontinuity Designs in Economics," <em>Journal of Economic Literature</em>. 48(2): 281-355. <a href="http://www.aeaweb.org/articles.php?doi=10.1257/jel.48.2.281">http://www.aeaweb.org/articles.php?doi=10.1257/jel.48.2.281</a>
</p>
<p>Imbens, Guido and Thomas Lemieux. (2010) "Regression discontinuity designs: A guide to practice," <em>Journal of Econometrics</em>. 142(2): 615-635. <a href="http://dx.doi.org/10.1016/j.jeconom.2007.05.001">http://dx.doi.org/10.1016/j.jeconom.2007.05.001</a>
</p>
<p>Lee, David and David Card. (2010) "Regression discontinuity inference with specification error," <em>Journal of Econometrics</em>. 142(2): 655-674. <a href="http://dx.doi.org/10.1016/j.jeconom.2007.05.003">http://dx.doi.org/10.1016/j.jeconom.2007.05.003</a>
</p>
<p>Angrist, Joshua and Jorn-Steffen Pischke. (2009) <em>Mostly Harmless Econometrics</em>. Princeton: Princeton University Press.
</p>


<h3>See Also</h3>

<p><code>summary.RD</code>, <code>plot.RD</code>, <code>DCdensity</code> <code>IKbandwidth</code>, <code>kernelwts</code>, <code>vcovHC</code>, 
<code>ivreg</code>, <code>lm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x&lt;-runif(1000,-1,1)
cov&lt;-rnorm(1000)
y&lt;-3+2*x+3*cov+10*(x&gt;=0)+rnorm(1000)
RDestimate(y~x)
# Efficiency gains can be made by including covariates
RDestimate(y~x|cov)
</code></pre>


</div>