<div class="container">

<table style="width: 100%;"><tr>
<td>linkGenesAndPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linking genes to putative regulatory elements</h2>

<h3>Description</h3>

<p>Evaluate the relationships between pairs of genes and peaks
based on specified distance metric. Usually used for inferring the
correlation between gene expression and imputed peak counts for datasets
without the modality originally (i.e. applied to <code>imputeKNN</code>
result).
</p>


<h3>Usage</h3>

<pre><code class="language-R">linkGenesAndPeaks(
  object,
  useDataset,
  pathToCoords,
  useGenes = NULL,
  method = c("spearman", "pearson", "kendall"),
  alpha = 0.05,
  verbose = getOption("ligerVerbose", TRUE),
  path_to_coords = pathToCoords,
  genes.list = useGenes,
  dist = method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A liger object, with datasets that is of
ligerATACDataset class in the <code>datasets</code> slot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useDataset</code></td>
<td>
<p>Name of one dataset, with both normalized gene expression
and normalized peak counts available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathToCoords</code></td>
<td>
<p>Path tothe gene coordinates file, usually a BED file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useGenes</code></td>
<td>
<p>Character vector of gene names to be tested. Default
<code>NULL</code> uses all genes available in <code>useDataset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Choose the type of correlation to calculate, from
<code>"spearman"</code>, <code>"pearson"</code> and <code>"kendall"</code>. Default
<code>"spearman"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric, significance threshold for correlation p-value.
Peak-gene correlations with p-values below this threshold are considered
significant. Default <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Whether to show information of the progress. Default
<code>getOption("ligerVerbose")</code> or <code>TRUE</code> if users have not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path_to_coords, genes.list, dist</code></td>
<td>
<p><b>Deprecated</b>. See Usage section
for replacement.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A sparse matrix with peak names as rows and gene names as columns,
with each element indicating the correlation between peak i and gene j, 0 if
the gene and peak are not significantly linked.
</p>


<h3>See Also</h3>

<p><code>imputeKNN</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (requireNamespace("RcppPlanc", quietly = TRUE) &amp;&amp;
    requireNamespace("GenomicRanges", quietly = TRUE) &amp;&amp;
    requireNamespace("IRanges", quietly = TRUE) &amp;&amp;
    requireNamespace("psych", quietly = TRUE)) {
    bmmc &lt;- normalize(bmmc)
    bmmc &lt;- selectGenes(bmmc)
    bmmc &lt;- scaleNotCenter(bmmc)
    bmmc &lt;- runINMF(bmmc, miniBatchSize = 100)
    bmmc &lt;- quantileNorm(bmmc)
    bmmc &lt;- normalizePeak(bmmc)
    bmmc &lt;- imputeKNN(bmmc, reference = "atac", queries = "rna")
    corr &lt;- linkGenesAndPeaks(
        bmmc, useDataset = "rna",
        pathToCoords = system.file("extdata/hg19_genes.bed", package = "rliger")
    )
}

</code></pre>


</div>