<div class="container">

<table style="width: 100%;"><tr>
<td>scaleM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>M-scale estimator</h2>

<h3>Description</h3>

<p>This function computes an M-scale, which is a robust
scale (spread) estimator.
M-estimators of scale are a robust alternative to
the sample standard deviation. Given a vector of
residuals <code>r</code>, the M-scale estimator <code>s</code>
solves the non-linear equation <code>mean(rho(r/s, cc))=b</code>,
where <code>b</code> and <code>cc</code> are user-chosen tuning constants.
In this package the function <code>rho</code> is one of
Tukey's bisquare family.
The breakdown point of the estimator is <code>min(b, 1-b)</code>,
so the optimal choice for <code>b</code> is 0.5. To obtain a
consistent estimator the constant
<code>cc</code> should be chosen such that E(rho(Z, cc)) = b, where
Z is a standard normal random variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scaleM(
  u,
  delta = 0.5,
  tuning.chi = 1.547645,
  family = "bisquare",
  max.it = 100,
  tol = 1e-06,
  tolerancezero = .Machine$double.eps
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>vector of residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the right hand side of the M-scale equation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.chi</code></td>
<td>
<p>the tuning object for the rho function as returned
by <code>lmrobdet.control</code>, bisquare, mopt or opt.
It should correspond to the family of rho functions specified in the argument <code>family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>string specifying the name of the family of loss function to be used (current valid
options are "bisquare", "opt" and "mopt").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.it</code></td>
<td>
<p>maximum number of iterations allowed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>relative tolerance for convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerancezero</code></td>
<td>
<p>smallest (in absolute value) non-zero value accepted as a scale. Defaults to <code>.Machine$double.eps</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The iterative algorithm starts from the scaled median of
the absolute values of the input vector, and then
cycles through the equation s^2 = s^2 * mean(rho(r/s, cc)) / b.
</p>


<h3>Value</h3>

<p>The scale estimate value at the last iteration or at convergence.
</p>


<h3>Author(s)</h3>

<p>Matias Salibian-Barrera, <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
r &lt;- rnorm(150, sd=1.5)
mscale(r)
sd(r)
# 10% of outliers, sd of good points is 1.5
set.seed(123)
r2 &lt;- c(rnorm(135, sd=1.5), rnorm(15, mean=-5, sd=.5))
mscale(r2)
sd(r2)

</code></pre>


</div>