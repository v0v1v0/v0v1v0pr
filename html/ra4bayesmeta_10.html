<div class="container">

<table style="width: 100%;"><tr>
<td>H_fits</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Hellinger distance between marignal posterior densities of two bayesmeta fits

</h2>

<h3>Description</h3>

<p>Computes the Hellinger distance between the
marginal posterior densities extracted from two bayesmeta fits,
for the selected parameter of interest.
Offers the option to select between integral-based and approximate moment-based computation of Hellinger distances.

</p>


<h3>Usage</h3>

<pre><code class="language-R">H_fits(fit1, fit2, parameter = "mu", individual = NA,
       method = "integral")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit1</code></td>
<td>

<p>first model fit of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit2</code></td>
<td>

<p>second model fit of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>

<p>parameter for which the the marginal posterior densities should be compared. Possible values are <code>"mu", "tau", "theta_new"</code> and <code>"theta"</code> (<code>"theta"</code> refers to the random effects and is used in combination  with the individual argment).

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individual</code></td>
<td>

<p>integer <code class="reqn">&lt;= k</code>, where <code class="reqn">k</code> is the number of studies in the meta-analysis data set. Specifies which random effect parameter to consider (according to the order of the studies in the data set). Is used only if <code>parameter = "theta"</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>method for Hellinger distance computation. Either <code>"integral"</code> for integral-based computation or <code>"moment"</code> for approximate moment-based calculation using a normal approximation. Defaults to <code>"integral"</code>.

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the random effects model for meta-analysis, the parameter mu is the overall mean parameter, tau is the between-study (heterogeneity) standard deviation, theta_new is the predicted effect for a new study and theta_i is the random effect parameter for study i.
</p>
<p>If integral-based computation (<code>method = "integral"</code>) of Hellinger distances is selected (the default), numerical integration is applied to obtain the Hellinger distance between the two marginal posterior densities (by using the function <code>H</code>).
If moment-based computation (<code>method = "moment"</code>) is selected, the marginal densities are first approximated by normal densities with the same means and standard deviations and then the Hellinger distance between these normal densities can be obtained by an analytical formula (implemented in the function <code>H_normal</code>).

</p>


<h3>Value</h3>

<p>A real number in [0,1].
</p>


<h3>Warning </h3>

<p>If the integral-based method is used to compute Hellinger distances (<code>method = "integral"</code>),
numerical problems may occur in some cases, which may lead to implausible outputs.
Therefore, we generally recommend to double-check the results of the integral-based method using the moment-based method (<code>method = "moment"</code>) - especially if the former results are implausibe. If large differences between the two methods are observed, we recommend to rely on the moment-based method unless a normal approximation of the involved densities is inappropriate.
</p>


<h3>See Also</h3>

<p><code>H</code>,
<code>H_normal</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(aa)  
 # fit under Jeffreys reference heterogeneity prior
fit1 &lt;- bayesmeta(y = aa[ , "y"], sigma = aa[, "sigma"],
                  mu.prior.mean = 0, mu.prior.sd = 4,
                  tau.prior = "Jeffreys")
# fit under standard half-normal heterogeneity prior
fit2 &lt;- bayesmeta(y = aa[ , "y"], sigma = aa[, "sigma"],
                  mu.prior.mean = 0, mu.prior.sd = 4,
                  tau.prior = function(t) dhalfnormal(t, scale = 1))
# Hellinger distance between the marginal posteriors for mu
H_fits(fit1, fit2)
# moment-based calculation
H_fits(fit1, fit2, method = "moment")
# Hellinger distance between the marginal posteriors for theta_2
# (random effect parameter)
H_fits(fit1, fit2, parameter = "theta", individual = 2)

</code></pre>


</div>