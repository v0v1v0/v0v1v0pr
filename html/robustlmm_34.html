<div class="container">

<table style="width: 100%;"><tr>
<td>fitDatasets_lmer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Functions</h2>

<h3>Description</h3>

<p>Methods to fit various mixed effects estimators to all generated datasets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitDatasets_lmer(datasets, control, label, postFit, datasetIndices = "all")

fitDatasets_lmer_bobyqa(datasets, postFit, datasetIndices = "all")

fitDatasets_lmer_Nelder_Mead(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer(
  datasets,
  method,
  tuningParameter,
  label,
  postFit,
  datasetIndices = "all",
  ...,
  init
)

fitDatasets_rlmer_DAStau(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DAStau_lmerNoFit(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DASvar(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DAStau_noAdj(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DAStau_k_0_5(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DAStau_k_0_5_noAdj(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DAStau_k_2(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DAStau_k_2_noAdj(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DAStau_k_5(datasets, postFit, datasetIndices = "all")

fitDatasets_rlmer_DAStau_k_5_noAdj(datasets, postFit, datasetIndices = "all")

fitDatasets_heavyLme(datasets, postFit, datasetIndices = "all")

fitDatasets_lqmm(datasets, postFit, datasetIndices = "all")

fitDatasets_rlme(datasets, postFit, datasetIndices = "all")

fitDatasets_varComprob(
  datasets,
  control,
  label,
  postFit,
  datasetIndices = "all"
)

fitDatasets_varComprob_compositeTau(datasets, postFit, datasetIndices = "all")

fitDatasets_varComprob_compositeTau_OGK(
  datasets,
  postFit,
  datasetIndices = "all"
)

fitDatasets_varComprob_compositeTau_2SGS(
  datasets,
  postFit,
  datasetIndices = "all"
)

fitDatasets_varComprob_compositeS(datasets, postFit, datasetIndices = "all")

fitDatasets_varComprob_compositeS_OGK(
  datasets,
  postFit,
  datasetIndices = "all"
)

fitDatasets_varComprob_compositeS_2SGS(
  datasets,
  postFit,
  datasetIndices = "all"
)

fitDatasets_varComprob_S(datasets, postFit, datasetIndices = "all")

fitDatasets_varComprob_S_OGK(datasets, postFit, datasetIndices = "all")

fitDatasets_varComprob_S_2SGS(datasets, postFit, datasetIndices = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datasets</code></td>
<td>
<p>Datasets list to be used to generate datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list (of correct class for the respective fitting function)
containing control parameters to be passed through.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>a string used to identify which fits have been created by which
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postFit</code></td>
<td>
<p>a function, taking one argument, the resulting fit. This
makes it easy to add an additional step after fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datasetIndices</code></td>
<td>
<p>optional vector of dataset indices to fit, useful to
try only a few datasets instead of all of them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>argument passed on to <code>rlmer</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuningParameter</code></td>
<td>
<p>argument passed on to
<code>extractTuningParameter</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>argument passed on to <code>createRhoFunction</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>optional argument passed on to <code>rlmer</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Existing fitting functions are:
</p>
<p><code>fitDatasets_lmer</code>: Fits datasets using <code>lmer</code>
using its default options.
</p>
<p><code>fitDatasets_lmer_bobyqa</code>: Fits datasets using <code>lmer</code> using
the <code>bobyqa</code> optimizer.
</p>
<p><code>fitDatasets_lmer_Nelder_Mead</code>: Fits datasets using
<code>lmer</code> using the <code>Nelder Mead</code> optimizer.
</p>
<p><code>fitDatasets_rlmer</code>: Fits datasets using <code>rlmer</code>
using a custom configuration. The argument 'tuningParameter' is passed to
<code>extractTuningParameter</code>, details are documented there.
</p>
<p><code>fitDatasets_rlmer_DAStau</code>: Fits datasets using
<code>rlmer</code> using method DAStau and <code>smoothPsi</code> for
the rho functions. The tuning parameters are k = 1.345 for <code>rho.e</code>.
For <code>rho.sigma.e</code>, the Proposal 2 variant is used using k = 2.28.
The choices for <code>rho.b</code> and <code>rho.sigma.b</code> depend on whether the
model uses a diagonal or a block diagonal matrix for Lambda. In the former
case, the same psi functions and tuning parameters are use as for
<code>rho.e</code> and <code>rho.sigma.b</code>. In the block diagonal case,
<code>rho.b</code> and <code>rho.sigma.b</code> both use <code>smoothPsi</code> using
a tuning parameter k = 5.14 (assuming blocks of dimension 2).
</p>
<p><code>fitDatasets_rlmer_DAStau_lmerNoFit</code>: Fits datasets using
<code>rlmer</code> using the same configuration as
<code>fitDatasets_rlmer_DAStau</code> except for that it is using
<code>lmerNoFit</code> as initial estimator.
</p>
<p><code>fitDatasets_rlmer_DASvar</code>: Fits datasets using
<code>rlmer</code> using method DASvar. The same rho functions and tuning
parameters are used as for <code>fitDatasets_rlmer_DAStau</code>.
</p>
<p><code>fitDatasets_rlmer_DAStau_noAdj</code>: Fits datasets using
<code>rlmer</code> using method DAStau. The same rho functions and tuning
parameters are used as for <code>fitDatasets_rlmer_DAStau</code>, except for
<code>rho.sigma.e</code> (and <code>rho.sigma.b</code> in the diagonal case) for which
the Proposal 2 variant of <code>smoothPsi</code> using k = 1.345 is used.
</p>
<p><code>fitDatasets_rlmer_DAStau_k_0_5</code>: Fits datasets using
<code>rlmer</code> using method DAStau. Use <code>smoothPsi</code>
psi-function with tuning parameter <code>k = 0.5</code> for <code>rho.e</code> and
<code>k = 1.47</code> for <code>rho.sigma.e</code>, the latter adjusted to reach the
same asymptotic efficiency. In the diagonal case, the same are used for
<code>rho.b</code> and <code>rho.sigma.b</code> as well. In the block-diagonal case,
the tuning parameter <code>k = 2.17</code> is used for <code>rho.b</code> and
<code>rho.sigma.b</code>. The tuning parameter is chosen to reach about the same
asymptotic efficiency for theta as for the fixed effects.
</p>
<p><code>fitDatasets_rlmer_DAStau_k_0_5_noAdj</code>: Fits datasets using
<code>rlmer</code> using method DAStau. Use <code>smoothPsi</code>
psi-function with tuning parameter <code>k = 0.5</code> for <code>rho.e</code> and
<code>rho.sigma.e</code>. In the diagonal case, the same are used for
<code>rho.b</code> and <code>rho.sigma.b</code> as well. In the block-diagonal case,
the tuning parameter <code>k = 2.17</code> is used for <code>rho.b</code> and
<code>rho.sigma.b</code>. The tuning parameter is chosen to reach about the same
asymptotic efficiency for theta as for the fixed effects.
</p>
<p><code>fitDatasets_rlmer_DAStau_k_2</code>: Fits datasets using
<code>rlmer</code> using method DAStau. Use <code>smoothPsi</code>
psi-function with tuning parameter <code>k = 2</code> for <code>rho.e</code> and
<code>k = 2.9</code> <code>rho.sigma.e</code>, the latter adjusted to reach the same
asymptotic efficiency. In the diagonal case, the same are used for
<code>rho.b</code> and <code>rho.sigma.b</code> as well. In the block-diagonal case,
the tuning parameter <code>k = 8.44</code> is used for <code>rho.b</code> and
<code>rho.sigma.b</code>. The tuning parameter is chosen to reach about the same
asymptotic efficiency for theta as for the fixed effects.
</p>
<p><code>fitDatasets_rlmer_DAStau_k_2_noAdj</code>: Fits datasets using
<code>rlmer</code> using method DAStau. Use <code>smoothPsi</code>
psi-function with tuning parameter <code>k = 2</code> for <code>rho.e</code> and
<code>rho.sigma.e</code>. In the diagonal case, the same are used for
<code>rho.b</code> and <code>rho.sigma.b</code> as well. In the block-diagonal case,
the tuning parameter <code>k = 8.44</code> is used for <code>rho.b</code> and
<code>rho.sigma.b</code>. The tuning parameter is chosen to reach about the same
asymptotic efficiency for theta as for the fixed effects.
</p>
<p><code>fitDatasets_rlmer_DAStau_k_5</code>: Fits datasets using
<code>rlmer</code> using method DAStau. Use <code>smoothPsi</code>
psi-function with tuning parameter <code>k = 5</code> for <code>rho.e</code> and
<code>k = 5.03</code> <code>rho.sigma.e</code>, the latter adjusted to reach the same
asymptotic efficiency. In the diagonal case, the same are used for
<code>rho.b</code> and <code>rho.sigma.b</code> as well. In the block-diagonal case,
the tuning parameter <code>k = 34.21</code> is used for <code>rho.b</code> and
<code>rho.sigma.b</code>. The tuning parameter is chosen to reach about the same
asymptotic efficiency for theta as for the fixed effects.
</p>
<p><code>fitDatasets_rlmer_DAStau_k_5_noAdj</code>: Fits datasets using
<code>rlmer</code> using method DAStau. Use <code>smoothPsi</code>
psi-function with tuning parameter <code>k = 5</code> for <code>rho.e</code> and
<code>rho.sigma.e</code>. In the diagonal case, the same are used for
<code>rho.b</code> and <code>rho.sigma.b</code> as well. In the block-diagonal case,
the tuning parameter <code>k = 34.21</code> is used for <code>rho.b</code> and
<code>rho.sigma.b</code>. The tuning parameter is chosen to reach about the same
asymptotic efficiency for theta as for the fixed effects.
</p>
<p><code>fitDatasets_heavyLme</code>: Fits datasets using
<code>heavyLme</code> from package <code>heavy</code>. Additional
required arguments are: <code>lmeFormula</code>, <code>heavyLmeRandom</code> and
<code>heavyLmeGroups</code>. They are passed to the <code>formula</code>,
<code>random</code> and <code>groups</code> arguments of <code>heavyLme</code>.
</p>
<p><code>fitDatasets_lqmm</code>: Fits datasets using
<code>lqmm</code> from package <code>lqmm</code>. Additional required
arguments are: <code>lmeFormula</code>, <code>lqmmRandom</code>, <code>lqmmGroup</code> and
<code>lqmmCovariance</code>. They are passed to the <code>formula</code>,
<code>random</code>, <code>groups</code> and <code>covariance</code> arguments of
<code>lqmm</code>. <code>lqmmCovariance</code> is optional, if omitted <code>pdDiag</code>
is used.
</p>
<p><code>fitDatasets_rlme</code>: Fits datasets using
<code>rlme</code> from package <code>rlme</code>.
</p>
<p><code>fitDatasets_varComprob</code>: Prototype method to fit datasets
using <code>varComprob</code> from package
<code>robustvarComp</code>. Additional required items in <code>datasets</code> are:
<code>lmeFormula</code>, <code>groups</code>, <code>varcov</code> and <code>lower</code>. They are
passed to the <code>fixed</code>, <code>groups</code>, <code>varcov</code> and <code>lower</code>
arguments of <code>varComprob</code>. The running of this method produces many
warnings of the form "passing a char vector to .Fortran is not portable"
which are suppressed.
</p>
<p><code>fitDatasets_varComprob_compositeTau</code>: Fits datasets with the
composite Tau method using <code>varComprob</code> from
package <code>robustvarComp</code>. See <code>fitDatasets_varComprob</code> for
additional details.
</p>
<p><code>fitDatasets_varComprob_compositeTau_OGK</code>: Similar to
<code>fitDatasets_varComprob_compositeTau</code> but using <code>covOGK</code> as initial
covariance matrix estimator.
</p>
<p><code>fitDatasets_varComprob_compositeTau_2SGS</code>: Similar to
<code>fitDatasets_varComprob_compositeTau</code> but using <code>2SGS</code> as initial covariance
matrix estimator.
</p>
<p><code>fitDatasets_varComprob_compositeS</code>: Similar to
<code>fitDatasets_varComprob_compositeTau</code> but using method composite S.
</p>
<p><code>fitDatasets_varComprob_compositeS_OGK</code>: Similar to
<code>fitDatasets_varComprob_compositeS</code> but using <code>covOGK</code> as
initial covariance matrix estimator.
</p>
<p><code>fitDatasets_varComprob_compositeS_2SGS</code>: Similar to
<code>fitDatasets_varComprob_compositeS</code> but using <code>2SGS</code> as initial
covariance matrix estimator.
</p>
<p><code>fitDatasets_varComprob_S</code>: Similar to
<code>fitDatasets_varComprob_compositeTau</code> but using method S and the
Rocke psi-function.
</p>
<p><code>fitDatasets_varComprob_S_OGK</code>: Similar to
<code>fitDatasets_varComprob_S</code> but using <code>covOGK</code> as initial
covariance matrix estimator.
</p>
<p><code>fitDatasets_varComprob_S_2SGS</code>: Similar to
<code>fitDatasets_varComprob_S</code> but using <code>2SGS</code> as initial
covariance matrix estimator.
</p>


<h3>Value</h3>

<p>list of fitted models. See also <code>lapplyDatasets</code> which
is called internally.
</p>


<h3>Author(s)</h3>

<p>Manuel Koller
</p>


<h3>Examples</h3>

<pre><code class="language-R">  set.seed(1)
  oneWay &lt;- generateAnovaDatasets(1, 1, 10, 4,
                                  lmeFormula = y ~ 1,
                                  heavyLmeRandom = ~ 1,
                                  heavyLmeGroups = ~ Var2,
                                  lqmmRandom = ~ 1,
                                  lqmmGroup = "Var2",
                                  groups = cbind(rep(1:4, each = 10), rep(1:10, 4)),
                                  varcov = matrix(1, 4, 4),
                                  lower = 0)
  fitDatasets_lmer(oneWay)
  ## call rlmer with custom arguments
  fitDatasets_rlmer_custom &lt;- function(datasets) {
    return(fitDatasets_rlmer(datasets,
                             method = "DASvar",
                             tuningParameter = c(1.345, 2.28, 1.345, 2.28, 5.14, 5.14),
                             label = "fitDatasets_rlmer_custom"))
  }
  fitDatasets_rlmer_custom(oneWay)
</code></pre>


</div>