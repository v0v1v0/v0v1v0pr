<div class="container">

<table style="width: 100%;"><tr>
<td>cmp_R2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute R2 with a specified C matrix</h2>

<h3>Description</h3>

<p>Compute R2 with a specified C matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">cmp_R2(c, x, SigHat, beta, method, obsperclust = NULL, nclusts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Contrast matrix for fixed effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Fixed effects design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigHat</code></td>
<td>
<p>estimated model covariance (matrix or scalar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>fixed effects estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method for computing r2beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsperclust</code></td>
<td>
<p>number of observations per cluster (i.e. subject)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclusts</code></td>
<td>
<p>number of clusters (i.e. subjects)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector with the Wald statistic (ncp), approximate Wald F
statistic (F), numerator degrees of freedom (v1), denominator degrees
of freedom (v2), and the specified r squared value (Rsq)
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(nlme)
library(lme4)
library(mgcv)
lmemod = lme(distance ~ age*Sex, random = ~1|Subject, data = Orthodont)
X = model.matrix(lmemod, data = Orthodont)
SigHat = extract.lme.cov(lmemod, data = Orthodont)
beta = fixef(lmemod)
p = length(beta)
obsperclust = as.numeric(table(lmemod$data[,'Subject']))
nclusts = length(obsperclust)
C = cbind(rep(0, p-1),diag(p-1))
partial.c = make.partial.C(p-1,p,2)

cmp_R2(c=C, x=X, SigHat=SigHat, beta=beta, obsperclust = obsperclust,
nclusts = nclusts, method = 'sgv')
cmp_R2(c=partial.c, x=X, SigHat=SigHat, beta=beta, obsperclust = obsperclust,
nclusts = nclusts, method = 'sgv')
</code></pre>


</div>