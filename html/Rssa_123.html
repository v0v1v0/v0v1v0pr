<div class="container">

<table style="width: 100%;"><tr>
<td>lrr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the min-norm Linear Recurrence Relation</h2>

<h3>Description</h3>

<p>Calculates the min-norm Linear Recurrence Relation given the one-dimensional 'ssa' object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class '1d.ssa'
lrr(x, groups, reverse = FALSE, ..., drop = TRUE)
## S3 method for class 'toeplitz.ssa'
lrr(x, groups, reverse = FALSE, ..., drop = TRUE)
## Default S3 method:
lrr(x, eps = sqrt(.Machine$double.eps),
        reverse = FALSE, ..., orthonormalize = TRUE)
## S3 method for class 'lrr'
roots(x, ..., method = c("companion", "polyroot"))
## S3 method for class 'lrr'
plot(x, ..., raw = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>SSA object holding the decomposition or matrix containing the basis vectors in columns
for <code>lrr</code> call or 'lrr' object itself for other function calls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>list, the grouping of eigentriples used to derive the LRR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reverse</code></td>
<td>
<p>logical, if 'TRUE', then LRR is assumed to go back</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to <code>decompose</code> or
<code>plot</code> call, if necessary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>logical, if 'TRUE' then the result is coerced to lrr object
itself, when possible (length of 'groups' is one)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Tolerance for verticality checking</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>methods used for calculation of the polynomial roots: via eigenvalues
of companion matrix or R's standard <code>polyroot</code> routine</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>
<p>logical, if 'TRUE' then <code>plot</code> routine will not add any
additional plot components (e.g. unit circle)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orthonormalize</code></td>
<td>
<p>logical, if 'FALSE' then the basis is assumed orthonormal.
Otherwise, orthonormalization is performed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces the min-norm linear recurrence relation from the series. The default
implementation works as follows.
</p>
<p>Denote by <code class="reqn">U_i</code> the columns of matrix <code class="reqn">x</code>. Denote by
<code class="reqn">\tilde{U}_{i}</code> the same vector <code class="reqn">U_i</code> but without the
last coordinate. Denote the last coordinate of <code class="reqn">U_i</code> by
<code class="reqn">\pi_i</code>. The returned value is
</p>
<p style="text-align: center;"><code class="reqn">
    \mathcal{R} = \frac{1}{1-\nu^2}\sum_{i=1}^{d}{\pi_i \tilde{U}_{i}},
  </code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
    \nu^2 = \pi_1^2 + \dots + \pi_d^2.
  </code>
</p>

<p>For <code>lrr.ssa</code> case the matrix <code class="reqn">U</code> used is the matrix of basis
vector corresponding to the selected elementary series.
</p>
<p>For <code>reverse = 'TRUE'</code> everything is the same, besides the
last coordinate substituted for the first coordinate.
</p>
<p>Details of the used algorithm see in Golyandina et al (2018), 
Algorithms 3.1 and 3.2.
</p>


<h3>Value</h3>

<p>Named list of object of class 'lrr' for <code>lrr</code> function call,
where elements have the same names as elements of <code>groups</code>
(if group is unnamed, corresponding component gets name ‘Fn’,
where ‘n’ is its index in <code>groups</code> list).
Or the object itself if 'drop = TRUE' and groups has length one.
</p>
<p>Vector with the roots of the of the characteristic
polynomial of the LRR for <code>roots</code> function call. Roots are
ordered by moduli decreasing.
</p>


<h3>References</h3>

<p>Golyandina N., Korobeynikov A., Zhigljavsky A. (2018):
<em>Singular Spectrum Analysis with R.</em>  Use R!.
Springer, Berlin, Heidelberg.
</p>


<h3>See Also</h3>

<p><code>Rssa</code> for an overview of the package, as well as,
<code>ssa</code>,
<code>parestimate</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Decompose 'co2' series with default parameters
s &lt;- ssa(co2, L = 24)
# Calculate the LRR out of first 3 eigentriples
l &lt;- lrr(s, groups = list(1:3))
# Calculate the roots of the LRR
r &lt;- roots(l)
# Moduli of the roots
Mod(r)
# Periods of three roots with maximal moduli
2*pi/Arg(r)[1:3]
# Plot the roots
plot(l)
</code></pre>


</div>