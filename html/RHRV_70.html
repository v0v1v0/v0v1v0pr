<div class="container">

<table style="width: 100%;"><tr>
<td>PoincarePlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poincare Plot</h2>

<h3>Description</h3>

<p>The Poincare plot is a graphical representation of the dependance
between successive RR intervals obtained by plotting the <code class="reqn">RR_{j+\tau}</code>
as a function of <code class="reqn">RR_j</code>. This dependance is often quantified by fitting an
ellipse to the plot. In this way, two parameters are obtained:  
<code class="reqn">SD_1</code>  and <code class="reqn">SD_2</code>.
<code class="reqn">SD_1</code> characterizes short-term variability
whereas that <code class="reqn">SD_2</code> characterizes long-term variability.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PoincarePlot(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  timeLag = 1,
  confidenceEstimation = FALSE,
  confidence = 0.95,
  doPlot = FALSE,
  main = "Poincare plot",
  xlab = "RR[n]",
  ylab = paste0("RR[n+", timeLag, "]"),
  pch = 1,
  cex = 0.3,
  type = "p",
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HRVData</code></td>
<td>
<p>Data structure that stores the beats register and information related to it</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexNonLinearAnalysis</code></td>
<td>
<p>Reference to the data structure that will contain the nonlinear analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeLag</code></td>
<td>
<p>Integer denoting the number of time steps that will be use to construct the 
dependance relation:  <code class="reqn">RR_{j+timeLag}</code> as a function of <code class="reqn">RR_j</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidenceEstimation</code></td>
<td>
<p>Logical value. If TRUE, the covariance matrix is
used for fitting the ellipse and computing the <code class="reqn">SD_1</code> and
<code class="reqn">SD_2</code> parameters (see details). Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence</code></td>
<td>
<p>The confidence used for plotting the confidence ellipse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>Logical value. If TRUE (default), the PoincarePlot is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>An overall title for the Poincare plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A title for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>A title for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Plotting character (symbol to use).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Character (or symbol) expansion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>What type of plot should be drawn. See <code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>x coordinates range. If not specified, a proper x range is selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y coordinates range. If not specified, a proper y range is selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters for the Poincare plot figure.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the HRV literature, when <em>timeLag = 1</em>, the <code class="reqn">SD_1</code> and <code class="reqn">SD_2</code>
parameters are computed using time domain measures. This is the default approach in this
function if <em>timeLag=1</em>. This function also allows the user to fit a ellipse
by computing the covariance matrix of 
(<code class="reqn">RR_{j}</code>,<code class="reqn">RR_{j+\tau}</code>)
(by setting <em>confidenceEstimation = TRUE</em>). In most cases, both approaches
yield similar results.
</p>


<h3>Value</h3>

<p>A <em>HRVData</em> structure containing a <em>PoincarePlot</em> field storing
the <code class="reqn">SD_1</code> and <code class="reqn">SD_2</code> parameters. The <em>PoincarePlot</em> field is
stored under the <em>NonLinearAnalysis</em> list.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
 data(HRVProcessedData)
 # rename for convenience
 hd = HRVProcessedData
 hd = CreateNonLinearAnalysis(hd)
 hd = PoincarePlot(hd, doPlot = T)

## End(Not run)
</code></pre>


</div>