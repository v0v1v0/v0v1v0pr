<div class="container">

<table style="width: 100%;"><tr>
<td>plot_RA_5bm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Reference analysis plot based on a data frame using 5 benchmarks:
Plot heterogeneity benchmark priors and the
corresponding marginal posteriors

</h2>

<h3>Description</h3>

<p>Plots the four proper benchmark heterogeneity priors proposed in the Supplementary Material of Ott et al. (2021)
and the corresponding marginal benchmark posteriors for different parameters in the
NNHM. Also displays the marginal Jeffreys reference posterior,
which is induced by an improper reference prior.
Displays the specified actual heterogeneity priors in <code>tau.prior</code>
and the corresponding marginal posteriors as well.

</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_RA_5bm(df, tau.prior=list(), type="pri.tau",
            improper.prior = NULL, show.sigma.i = FALSE,
            xlim, ylim,
            m_J=NA, M_J=NA, upper.J=3, digits.J=2,
            m_inf=NA, M_inf=NA, rlmc0=0.0001, rlmc1=0.9999,
            legend=FALSE, pos.legend="topright", legend.tau.prior=c(),
            xlab = NULL, bty = "o",
            mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>data frame with one column "y" containing the (transformed) effect estimates for the individual studies and
one column "sigma" containing the standard errors of these estimates.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.prior</code></td>
<td>

<p>list (maximum length 5) of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>specifies if heterogeneity priors or marginal posterior densities for
a given parameter should be plotted.
Options are <code>"pri.tau"</code> for heterogeneity priors, <code>"post.mu"</code> for the marg. posterior of the main effect mu, <code>"post.tau"</code> for the marg. posterior of the heterogeneity tau and
<code>"post.theta.new"</code> for the marg. posterior of the predicted effect theta_new in a new study.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>improper.prior</code></td>
<td>

<p>vector of integers specifying the position of the improper priors in the list <code>tau.prior</code>
or NULL (the default). Determines which prior densities should not be plotted. Applies only to <code>type = "pri.tau"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.sigma.i</code></td>
<td>

<p>logical. Specifies if the standard errors of the estimates for the individual studies (the entries of the column "sigma" in the data frame <code>df</code>) should be added to the density plot as dots. Defaults to FALSE. Applies only to <code>type = "pri.tau"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>a vector of two real numbers. Limits of the x-axis. (First number &gt;= 0 for densities for tau.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>a vector of two real non-negative numbers. Limits of the y-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_J</code></td>
<td>

<p>parameter value <code class="reqn">m=m_J</code> of the SGC(<code class="reqn">m</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_j_sgc</code> and some other parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_J</code></td>
<td>

<p>parameter value <code class="reqn">M=M_J</code> of the SIGC(<code class="reqn">M</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_j_sigc</code> and some other parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.J</code></td>
<td>

<p>upper bound for the parameters <code>M_J</code> and <code>m_J</code>. Real number in <code class="reqn">(1,\infty)</code>. Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits.J</code></td>
<td>

<p>specifies the desired precision of the parameter values <code class="reqn">M_J</code> and <code class="reqn">m_J</code>, i.e. to how many digits these two values
should be determined. Possible values are 1,2,3. Defaults to 2.
Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_inf</code></td>
<td>

<p>parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 0.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_inf_sgc</code>, such that the median RLMC is
approximately equal to <code>rlmc0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_inf</code></td>
<td>

<p>parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 1.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_inf_sigc</code>, such that the median RLMC is
approximately equal to <code>rlmc1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlmc0</code></td>
<td>

<p>RLMC target value for the SGC(<code class="reqn">m_{inf}</code>) benchmark prior (typically close to 0).
Is required only if <code>m_inf=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlmc1</code></td>
<td>

<p>RLMC target value for the SIGC(<code class="reqn">M_{inf}</code>) benchmark prior (typically close to 1).
Is required only if <code>M_inf=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>

<p>logical. Specifies if a legend should be added to the plot. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.legend</code></td>
<td>

<p>a character string specifing the position of the legend in the plot.
Options are all the keywords accepted by
the <code>legend</code> function in the graphics package, i.e.
<code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and <code>"center"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.tau.prior</code></td>
<td>

<p>a vector of character strings or expressions of the same length
as the list <code>tau.prior</code>. Determines the legend entries corresponding to
the actual heterogeneity priors specified in <code>tau.prior</code>,
in the same order as the priors in that list.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>x-axis label. If unspecified or set to NULL (the default), a default label specifying
the paramter of interest is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bty</code></td>
<td>

<p>the type of box to be drawn around the legend. The allowed values are "o" (the default) and "n".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The five heterogeneity benchmark priors used are
introduced in the Supplementary Material of Ott et al. (2021, Sections 2.2.1, 2.5 and 2.6, see also Section 3.4 of Ott et al. (2021) for Jeffreys reference prior),
where they are denoted by
SGC(<code class="reqn">m_{inf}</code>), SIGC(<code class="reqn">M_J</code>), SGC(<code class="reqn">m_J</code>), SIGC(<code class="reqn">M_{inf}</code>)
and Jeffreys.
Note that the latter Jeffreys reference prior
is improper, but leads to a proper posterior if
there are at least two studies in the meta-analysis data set.
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.
</p>
<p>If you wish to adapt the colors, line types or line widths of the plotted densities,
we suggest to compute the models fits first by using the function <code>fit_models_RA</code>
and then to apply the more flexible function <code>plot_RA_fits</code>
operating on model fits of class <code>bayesmeta</code>.

</p>


<h3>Value</h3>

<p>No return value, produces graphical output only.
</p>


<h3>Warning </h3>

<p>This function may take several minutes to run if the parameter <code>m_J</code> and/or <code>M_J</code>
is not specified,
especially if the desired precision is <code>digits.J=2</code> or even <code>digits.J=3</code>.
</p>
<p>A warning message will be displayed if one of the parameters <code>m_inf</code>, <code>M_J</code>, <code>m_J</code> or <code>M_inf</code>
has a value larger than 5*10^6, since this may lead to numerical problems
in the <code>bayesmeta</code> function
used for computation of the marginal posteriors.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505–4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code>fit_models_RA_5bm</code>, <code>plot_RA_fits</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># for aurigular acupuncture (AA) data set with two
# actual half-normal and half-Cauchy heterogeneity priors
data(aa)
 
# prior densities
# warning: it takes ca. 8 min. to run this function
# (computation is much faster if m_J and M_J are specified)
plot_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                  function(t)dhalfcauchy(t, scale=1)),
            type="pri.tau", xlim=c(0,2), ylim=c(0,3), legend=TRUE,
            legend.tau.prior=c("HN(1)", "HC(1)"))

# marginal posterior for the effect mu
# warning: it takes ca. 7 min. to run this function
plot_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                  function(t)dhalfcauchy(t, scale=1)),
            type="post.mu", xlim=c(-1.5,2), ylim=c(0,3), legend=TRUE,
            legend.tau.prior=c("HN(1)", "HC(1)"))
            
</code></pre>


</div>