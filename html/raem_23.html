<div class="container">

<table style="width: 100%;"><tr>
<td>head_to_potential</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert hydraulic head to potential and vice versa</h2>

<h3>Description</h3>

<p><code>head_to_potential()</code> calculates the discharge potential from the hydraulic head.
</p>
<p><code>potential_to_head()</code> calculates the hydraulic head from the discharge potential.
</p>


<h3>Usage</h3>

<pre><code class="language-R">head_to_potential(aem, h, ...)

potential_to_head(aem, phi, na.below = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>aem</code></td>
<td>
<p><code>aem</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>numeric hydraulic head values as vector or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>numeric discharge potential values as vector or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.below</code></td>
<td>
<p>logical indicating if calculated head values below the aquifer base should be set to <code>NA</code>. Defaults to <code>TRUE</code>. See details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>head_to_potential()</code> returns the discharge potentials calculated from <code>h</code>, in the same
structure as <code>h</code>.
</p>
<p><code>potential_to_head()</code> returns the hydraulic heads calculated from <code>phi</code>, in the same
structure as <code>phi</code>.
</p>
<p>The conversion of potential to head or vice versa is different for confined (constant saturated thickness)
and unconfined (variable saturated thickness) aquifers as set by the <code>type</code> argument in <code>aem()</code>.
</p>
<p>If <code>na.below = FALSE</code>, negative potentials can be converted to hydraulic heads if flow is unconfined (<code>aem$type = 'variable'</code>).
The resulting heads are below the aquifer base. This may be useful for some use cases, e.g. in preliminary model construction
or for internal functions. In most cases however, these values should be set to <code>NA</code> (the default behavior) since other analytic
elements will continue to extract or inject water even though the saturated thickness of the aquifer is negative,
which is not realistic. In those cases, setting <code>aem$type = 'confined'</code> might prove useful. Also note that these heads below the
aquifer base will not be correctly re-converted to potentials using <code>head_to_potential()</code>. As such, caution should be taken when
setting <code>na.below = FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k &lt;- 10
top &lt;- 10; base &lt;- 0
uf &lt;- uniformflow(TR = 100, gradient = 0.001, angle = -45)
rf &lt;- constant(TR, xc = -1000, yc = 0, hc = 10)
w1 &lt;- well(200, 50, Q = 250)
m &lt;- aem(k, top, base, n = 0.2, uf, rf, w1, type = 'variable') # variable saturated thickness
mc &lt;- aem(k, top, base, n = 0.2, uf, rf, w1, type = 'confined') # constant saturated thickness
xg &lt;- seq(-500, 500, length = 100)
yg &lt;- seq(-250, 250, length = 100)

h &lt;- heads(m, x = xg, y = yg, as.grid = TRUE)
hc &lt;- heads(mc, x = xg, y = yg, as.grid = TRUE)
pot &lt;- head_to_potential(m, h)
potc &lt;- head_to_potential(mc, hc)

phi &lt;- potential(m, x = xg, y = yg, as.grid = TRUE)
phic &lt;- potential(mc, x = xg, y = yg, as.grid = TRUE)
hds &lt;- potential_to_head(m, phi)
hdsc &lt;- potential_to_head(mc, phic)

# Converting negative potentials results in NA's with warning
try(
potential_to_head(m, -300)
)

# unless na.below = FALSE
potential_to_head(m, -300, na.below = FALSE)

</code></pre>


</div>