<div class="container">

<table style="width: 100%;"><tr>
<td>orthog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Orthogonalization of a matrix to another matrix</h2>

<h3>Description</h3>

<p>Function <code>orthog</code> orthogonalizes a matrix <code class="reqn">Y</code> to a matrix <code class="reqn">X</code>. The row observations can be weighted. 
</p>
<p>The function uses function <code>lm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
orthog(X, Y, weights = NULL)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A <code class="reqn">n x p</code> matrix or data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A <code class="reqn">n x q</code> matrix or data frame to orthogonalize to <code class="reqn">X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A vector of length <code class="reqn">n</code> defining a priori weights to apply to the observations. Internally, weights are "normalized" to sum to 1. Default to <code>NULL</code> (weights are set to <code class="reqn">1 / n</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The <code class="reqn">Y</code> matrix orthogonalized to <code class="reqn">X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>The regression coefficients used for orthogonalization.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 8 ; p &lt;- 3
set.seed(1)
X &lt;- matrix(rnorm(n * p, mean = 10), ncol = p, byrow = TRUE)
Y &lt;- matrix(rnorm(n * 2, mean = 10), ncol = 2, byrow = TRUE)
colnames(Y) &lt;- c("y1", "y2")
set.seed(NULL)
X
Y

res &lt;- orthog(X, Y)
res$Y
crossprod(res$Y, X)
res$b

# Same as:
fm &lt;- lm(Y ~ X)
Y - fm$fitted.values
fm$coef

#### WITH WEIGHTS

w &lt;- 1:n
fm &lt;- lm(Y ~ X, weights = w)
Y - fm$fitted.values
fm$coef

res &lt;- orthog(X, Y, weights = w)
res$Y
t(res$Y) 
res$b

</code></pre>


</div>