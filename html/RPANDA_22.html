<div class="container">

<table style="width: 100%;"><tr>
<td>CreateGeoObject_BioGeoBEARS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create biogeography object using a stochastic map from BioGeoBEARS
</h2>

<h3>Description</h3>

<p>Create biogeography object using a stochastic map created from any model in BioGeoBEARS (see documentation in BioGeoBEARS package).
</p>


<h3>Usage</h3>

<pre><code class="language-R">CreateGeoObject_BioGeoBEARS( full.phylo, trimmed.phylo = NULL, ana.events,
clado.events, stratified=FALSE, simmap.out=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>full.phylo</code></td>
<td>

<p>the object of type 'phylo' (see ape documentation) that was used to construct the stochastic map in BioGeoBEARS
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trimmed.phylo</code></td>
<td>

<p>if the desired biogeography object excludes some species that were initially included in the stochastic map, this specifies a phylo object for the trimmed set of species
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ana.events</code></td>
<td>

<p>the "ana.events" table produced in BioGeoBEARS that lists anagenetic events in the stochastic map
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clado.events</code></td>
<td>

<p>the "clado.events" table produced in BioGeoBEARS that lists cladogenetic events in the stochastic map
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratified</code></td>
<td>

<p>logical indicating whether the stochastic map was built from a stratified analysis in BioGeoBEARS
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simmap.out</code></td>
<td>

<p>logical indicating whether output should be a stochastic map (simmap) object (see note)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note: generating a stochastic map output using <code>simmap.out=TRUE</code> and passing to fit_t_comp for diversity dependent models with biogeography greatly speeds up model 
fitting compared to output generated when <code>simmap.out=FALSE</code>. This cannot be used for matching competition or any two-regime models with biogeography.
</p>


<h3>Value</h3>

<p>a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>geography.object</code></td>
<td>
<p>a list of matrices specifying sympatry (1) or allopatry (0) for each species pair for each internode interval (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>a vector containing the time since the root of the tree at which nodes or changes in biogeography occur (used internally in other functions)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spans</code></td>
<td>
<p>a vector specifying the distances between times (used internally in other functions)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan Drury <a href="mailto:jonathan.p.drury@gmail.com">jonathan.p.drury@gmail.com</a>
</p>


<h3>References</h3>

<p>Drury, J., Clavel, J., Manceau, M., and Morlon, H. 2016. Estimating the effect of competition on trait evolution using maximum likelihood inference. <em>Systematic Biology</em> doi 10.1093/sysbio/syw020
</p>
<p>Matzke, N. 2014. Model selection in historical biogeography reveals that founder-event speciation is a crucial process in island clades. <em>Systematic Biology</em> 63:951-970.
</p>


<h3>See Also</h3>

<p><code>fit_t_comp</code>
<code>CreateGeoObject</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(BGB.examples)




##Example with a non-stratified tree

Canidae.geography.object&lt;-CreateGeoObject_BioGeoBEARS(full.phylo=BGB.examples$Canidae.phylo,
ana.events=BGB.examples$Canidae.ana.events, clado.events=BGB.examples$Canidae.clado.events)

#on a subclade
Canidae.trimmed&lt;-drop.tip(BGB.examples$Canidae.phylo 
							,BGB.examples$Canidae.phylo$tip.label[1:9])
							
Canidae.trimmed.geography.object&lt;-CreateGeoObject_BioGeoBEARS(
full.phylo=BGB.examples$Canidae.phylo, trimmed.phylo=Canidae.trimmed, 
ana.events=BGB.examples$Canidae.ana.events, clado.events=BGB.examples$Canidae.clado.events)

##Example with a stratified tree

Ochotonidae.geography.object&lt;-CreateGeoObject_BioGeoBEARS( 
full.phylo = BGB.examples$Ochotonidae.phylo, ana.events = BGB.examples$Ochotonidae.ana.events,
clado.events = BGB.examples$Ochotonidae.clado.events, stratified = TRUE)

#on a subclade
Ochotonidae.trimmed&lt;-drop.tip(BGB.examples$Ochotonidae.phylo, 
BGB.examples$Ochotonidae.phylo$tip.label[1:9])
								
Ochotonidae.trimmed.geography.object&lt;-CreateGeoObject_BioGeoBEARS(
full.phylo=BGB.examples$Ochotonidae.phylo, trimmed.phylo=Ochotonidae.trimmed, 
ana.events=BGB.examples$Ochotonidae.ana.events, 
clado.events=BGB.examples$Ochotonidae.clado.events, stratified=TRUE)



</code></pre>


</div>