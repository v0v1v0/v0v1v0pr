<div class="container">

<table style="width: 100%;"><tr>
<td>torus_pairs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Toroidal pairs plot</h2>

<h3>Description</h3>

<p>Pairs plots for data on <code class="reqn">[-\pi, \pi)^d</code>, <code class="reqn">d\geq 2</code>.
The diagonal panels contain kernel density estimates tailored to
circular data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">torus_pairs(
  x,
  max_dim = 10,
  columns = NULL,
  col_data = 1,
  ylim_dens = c(0, 1.5),
  bwd = "ROT",
  scales = rep(pi, ncol(x))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of size <code>c(nx, d)</code> with angles on <code class="reqn">[-\pi, \pi)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_dim</code></td>
<td>
<p>the maximum number of scores to produce the scores plot.
Defaults to <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>if specified, the variables to be plotted. If <code>NULL</code>
(the default), the first <code>max_dim</code> variables are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_data</code></td>
<td>
<p>color(s) for the data points. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim_dens</code></td>
<td>
<p>common <code>ylim</code> for the diagonal plots. Defaults to
<code>c(0, 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwd</code></td>
<td>
<p>type of bandwidth selector used in the kernel density plots.
Either <code>"ROT"</code>, <code>"EMI"</code>, <code>"AMI"</code>, <code>"LSCV"</code>, or
<code>"LCV"</code>. See <code>bw_dir_pi</code> and
<code>bw_dir_cv</code>. Defaults to <code>"ROT"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>scales of the torus. Defaults to <code>rep(pi, ncol(x))</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default bandwidth selector is the Rule-Of-Thumb (ROT) selector in
García-Portugués (2013). It is fast, yet it may oversmooth non-unimodal
densities. The EMI selector gives more flexible fits.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code>. The density plots show the
Fréchet means (red bars) and the Fréchet standard
deviations (gray text).
</p>


<h3>References</h3>

<p>García-Portugués, E. (2013). Exact risk improvement of bandwidth selectors
for kernel density estimation with directional data. <em>Electronic Journal
of Statistics</em>, 7:1655–1685. <a href="https://doi.org/10.1214/13-ejs821">doi:10.1214/13-ejs821</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate data
n &lt;- 50
set.seed(123456)
x &lt;- sdetorus::toPiInt(rbind(
  mvtnorm::rmvnorm(n = n, mean = c(-pi, -pi) / 2,
                   sigma = diag(0.1, nrow = 2)),
  mvtnorm::rmvnorm(n = n, mean = c(-3 * pi / 2, 0) / 2,
          sigma = diag(0.1, nrow = 2)),
  mvtnorm::rmvnorm(n = n, mean = c(0, pi / 2),
                   sigma = diag(0.1, nrow = 2))
))
col &lt;- rainbow(3)[rep(1:3, each = n)]

# Torus pairs
torus_pairs(x, col_data = col)

fit &lt;- ridge_pca(x = x)
torus_pairs(fit$scores, col_data = col)
</code></pre>


</div>