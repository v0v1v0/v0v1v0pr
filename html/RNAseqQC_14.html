<div class="container">

<table style="width: 100%;"><tr>
<td>plot_pca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot results of a principal component analysis</h2>

<h3>Description</h3>

<p>Plot results of a principal component analysis
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_pca(
  obj,
  PC_x = 1,
  PC_y = 2,
  n_feats = 500,
  scale_feats = FALSE,
  na_frac = 0.3,
  metadata = NULL,
  color_by = NULL,
  shape_by = NULL,
  point_alpha = 0.7,
  point_rel_size = 2,
  show_plot = TRUE,
  rasterise = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A (features x samples) matrix or SummarizedExperiment object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PC_x</code></td>
<td>
<p>The PC to show on the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PC_y</code></td>
<td>
<p>The PC to show on the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_feats</code></td>
<td>
<p>Number of top-variable features to include.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_feats</code></td>
<td>
<p>Whether to scale the features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_frac</code></td>
<td>
<p>Only consider features with the stated maximum fraction of NAs or NaNs. NA/NaNs will be mean-imputed for PCA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>A data.frame used for annotating samples. <code>rownames(metadata)</code> must match <code>colnames(obj)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_by</code></td>
<td>
<p>Variable by which to color points. Must be a column in metadata or in <code>colData(obj)</code>.
Alternatively, it can be the name of a feature (a rowname of obj) or a gene name (an element of rowData(obj)$gene_name).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape_by</code></td>
<td>
<p>Variable by which to color points. Must be a column in metadata or in <code>colData(obj)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_alpha</code></td>
<td>
<p>alpha value of <code>geom_point()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_rel_size</code></td>
<td>
<p>relative size of <code>geom_point()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_plot</code></td>
<td>
<p>Whether to show the plot or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rasterise</code></td>
<td>
<p>Whether to rasterise the point, using ggrastr.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters passed on to ggrastr::rasterise</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the <code>metadata</code> or <code>colData</code> of <code>obj</code> contain a column <code>colname</code>, this colum will be removed in the <code style="white-space: pre;">⁠$pca_data⁠</code> slot,
because this column contains the colnames of the data matrix. Similarly, for the <code style="white-space: pre;">⁠$loadings⁠</code> slot, the column <code>rowname</code> is
reserved for the rownames of the data matrix.
</p>


<h3>Value</h3>

<p>The function displays the plot and returns invisible a list of the plot,
the data.frame to make the plot, the vector of percentages of variance explained and the loadings matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
data &lt;- matrix(rnorm(100*6), ncol=6)
data &lt;- t(t(data)+c(-1, -1.1, -1.2, 1, 1.1, 1.2))
plot_pca(data)

</code></pre>


</div>