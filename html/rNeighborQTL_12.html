<div class="container">

<table style="width: 100%;"><tr>
<td>perm_neighbor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation tests for neighbor effects with a QTL model</h2>

<h3>Description</h3>

<p>A function to calculate a genome-wide LOD threshold using permutation tests for self or neighbor effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perm_neighbor(
  genoprobs,
  pheno,
  smap,
  scale,
  addcovar = NULL,
  addQTL = NULL,
  intQTL = NULL,
  grouping = rep(1, nrow(smap)),
  response = c("quantitative", "binary"),
  type = c("neighbor", "self", "int"),
  times = 99,
  p_val = 0.05,
  n_core = 1L,
  contrasts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genoprobs</code></td>
<td>
<p>Conditional genotype probabilities as taken from <code>qtl::calc.genoprob()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>A vector of individual phenotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smap</code></td>
<td>
<p>A matrix showing a spatial map for individuals. The first and second column include spatial positions along an x-axis and y-axis, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A numeric scalar indicating the maximum spatial distance between a focal individual and neighbors to define neighbor effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addcovar</code></td>
<td>
<p>An optional matrix including additional non-genetic covariates. It contains no. of individuals x no. of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addQTL</code></td>
<td>
<p>An optional vector containing marker names that are considered covariates. Namely, this option allows composite interval mapping (Jansen 1993).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intQTL</code></td>
<td>
<p>An option when using <code>int_neighbor()</code>. A name of a focal marker to be tested for its epistasis with the other markers in neighbor effects. The marker name must be included by <code>addQTL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>An optional integer vector assigning each individual to a group. This argument can be used when <code>smap</code> contains different experimental replicates. Default setting means that all individuals are belong to a single group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>An optional argument to select trait types. The <code>"quantitative"</code> or <code>"binary"</code> calls the <code>"gaussian"</code> or <code>"binomial"</code> family in <code>glm()</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Select <code>"self"</code>, <code>"neighbor"</code>, or <code>"int"</code> to perform permutation tests for self effects, neighbor effects, or neighbor epistasis, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>No. of permutation iterations. Default at 99 times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_val</code></td>
<td>
<p>A vector indicating upper quantiles for permutation LOD scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_core</code></td>
<td>
<p>No. of cores for a parallel computation. This does not work for Windows OS. Default is a single-core computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>An optional vector composed of three TRUE/FALSE values, which represents the presence/absence of specific genotypes as c(TRUE/FALSE, TRUE/FALSE, TRUE/FALSE) = AA, AB, BB. If <code>NULL</code>, it is compiled from <code>genoprobs</code> automatically.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>LOD thresholds at given quantiles by <code>p-val</code>
</p>


<h3>Author(s)</h3>

<p>Yasuhiro Sato (<a href="mailto:sato.yasuhiro.36c@kyoto-u.jp">sato.yasuhiro.36c@kyoto-u.jp</a>)
</p>


<h3>See Also</h3>

<p><code>plot_nei</code> <code>scan_neighbor</code> <code>int_neighbor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
test_map &lt;- qtl::sim.map(len=rep(20,5),n.mar=3,include.x=FALSE)
test_cross &lt;- qtl::sim.cross(test_map,n.ind=50)
test_smap &lt;- cbind(runif(50,1,100),runif(50,1,100))
test_genoprobs &lt;- qtl::calc.genoprob(test_cross,step=2)

test_perm &lt;- perm_neighbor(genoprobs=test_genoprobs,
                           pheno=test_cross$pheno$phenotype,
                           smap=test_smap,scale=20,
                           times=3, p_val=c(1.0,0.5)
                           )
</code></pre>


</div>