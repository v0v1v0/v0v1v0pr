<div class="container">

<table style="width: 100%;"><tr>
<td>simstats0c</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Versions of FRAN</h2>

<h3>Description</h3>

<p>The functions to be called as "FRAN" by <code>siena07</code>.   
They call compiled C++. Not for general users' use.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simstats0c(z, x, data=NULL, effects=NULL, fromFiniteDiff=FALSE,
           returnDeps=FALSE, returnChains=FALSE, byWave=FALSE,
           returnDataFrame=FALSE, returnLoglik=FALSE)
maxlikec(z, x, data=NULL, effects=NULL,
           returnChains=FALSE, byGroup = FALSE, byWave=FALSE,
           returnDataFrame=FALSE, returnLoglik=FALSE,
           onlyLoglik=FALSE)
initializeFRAN(z, x, data, effects, prevAns = NULL, initC,
           profileData = FALSE, returnDeps = FALSE, returnChains =
           FALSE, byGroup = FALSE, returnDataFrame = FALSE,
           byWave = FALSE, returnLoglik = FALSE,  onlyLoglik = FALSE)
terminateFRAN(z, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Control object, passed in automatically in  <code>siena07</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A sienaAlgorithm object, passed in automatically in  <code>siena07</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A sienaData object as returned by <code>sienaDataCreate</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>A sienaEffects object as
returned by <code>getEffects</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fromFiniteDiff</code></td>
<td>
<p>Boolean used during calculation of derivatives
by finite differences. Not for user use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnDeps</code></td>
<td>
<p>Boolean. Whether to return the simulated networks in
Phase 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnChains</code></td>
<td>
<p>Boolean. Whether to return the chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byWave</code></td>
<td>
<p>Boolean. Whether to return the finite difference or
maximum likelihood
derivatives by wave (uses a great deal of memory). Only necessary
for <code>sienaTimeTest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byGroup</code></td>
<td>
<p>Boolean. For internal use: allows different thetas for each
group to be used in <code>sienaBayes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnDataFrame</code></td>
<td>
<p>Boolean. Whether to return the chains as
lists or data frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnLoglik</code></td>
<td>
<p>Boolean. Whether to return the log likelihood of
the simulated chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyLoglik</code></td>
<td>
<p>Boolean: whether to return just the likelihood for
the simulated chain, plus details of steps accepted and rejected. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prevAns</code></td>
<td>
<p>An object of class "sienaFit" as returned by
<code>siena07</code>, from which scaling
information (derivative matrix and standard deviation of the
deviations) will be extracted along with the latest version of the
parameters which will be used as the initial values, unless the
model requests the use of standard initial values. If the previous
model is exactly the same as the current one, Phase 1 will be omitted. If
not, any parameter estimates for effects which are included in
the new model will be used as initial
values, but phase 1 will still be carried out.
If the results used as <code>prevAns</code> are a reasonable starting point,
this will increase the efficiency of the algorithm. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initC</code></td>
<td>
<p>If TRUE, call is to setup the data and model in C++. For
use with multiple processes only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profileData</code></td>
<td>
<p>Boolean to force dumping of the data for profiling
with <code>sienaProfile.exe</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Not for general users' use.<br>
The name of <code>simstats0c</code> or <code>maxlikec</code>
should be used for the element FRAN of the model object, the former when using
estimation by forward simulation, the latter for maximum likelihood estimation.
The arguments with no defaults must be passed in on the call to
<code>siena07</code>.
<code>initializeFRAN</code> and <code>terminateFRAN</code> are called in both cases.
</p>


<h3>Value</h3>

<p><code>simstats0c</code> returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fra</code></td>
<td>
<p>Simulated statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>Scores with which to calculate the derivative (not phase 2
or if using finite differences or maximum likelihood).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dff</code></td>
<td>
<p>Contributions to the derivative if finite differences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntim</code></td>
<td>
<p>For conditional processing, time taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feasible</code></td>
<td>
<p>Currently set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OK</code></td>
<td>
<p>Could be set to FALSE if serious error has occurred.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>A list of simulation results, one for each period. Each
list consists of a list for each data object, each of which consists of
a list for each network, each of which consists of a list for each period,
each component of which is an edgelist in matrix form (the columns
are from, to, value) (or vector for behavior variables).
Only if <code>returnDeps</code> is TRUE.</p>
</td>
</tr>
</table>
<p><code>maxlikec</code> returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fra</code></td>
<td>
<p>Simulated scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dff</code></td>
<td>
<p>Simulated Hessians: stored as lower triangular matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntim</code></td>
<td>
<p>NULL, compatibility only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feasible</code></td>
<td>
<p>Currently set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OK</code></td>
<td>
<p>Could be set to FALSE if serious error has occurred.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dff</code></td>
<td>
<p>Simulated Hessian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>NULL, for compatibility only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>A list of sampled chains, one for each period. Each
list consists of a list for each data object, each of which consists of
a list for each network, each of which consists of a list for each period,
each component of which is a list or a data frame depending on the
value of <code>returnDataFrame</code>.
Only if <code>returnChainss</code> is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accepts</code></td>
<td>
<p>Number of accepted MH steps by dependent variable
(permute steps are counted under first dependent variable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rejects</code></td>
<td>
<p>Number of rejected MH steps by dependent variable
(permute steps are counted under first dependent variable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aborts</code></td>
<td>
<p>Number of aborted MH steps counted under first dependent
variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Loglikelihood of the simulations. Only if
<code>returnLoglik</code> is TRUE. If <code>onlyLoglik</code> is TRUE, only
<code>loglik</code>, <code>accepts</code>,<code>rejects</code> and <code>aborts</code> are
returned.</p>
</td>
</tr>
</table>
<p><code>initializeFRAN</code> and <code>terminateFRAN</code> return the control
object <code>z</code>.
</p>


<h3>Author(s)</h3>

<p>Ruth Ripley </p>


<h3>References</h3>

<p>See <a href="https://www.stats.ox.ac.uk/~snijders/siena/">https://www.stats.ox.ac.uk/~snijders/siena/</a></p>


<h3>See Also</h3>

<p><code>siena07</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
mynet1 &lt;- sienaNet(array(c(tmp3, tmp4), dim=c(32, 32, 2)))
mydata &lt;- sienaDataCreate(mynet1)
myeff &lt;- getEffects(mydata)
myeff &lt;- includeEffects(myeff, transTrip)
myalgorithm &lt;- sienaAlgorithmCreate(fn=simstats0c, nsub=2, n3=100, projname=NULL)
ans &lt;- siena07(myalgorithm, data=mydata, effects=myeff,  batch=TRUE)
</code></pre>


</div>