<div class="container">

<table style="width: 100%;"><tr>
<td>PT.Khmaladze.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation Test for Heterogeneous Treatment Effects with a Nuisance Parameter</h2>

<h3>Description</h3>

<p>A permutation test of the two-sample goodness-of-fit hypothesis in the presence of an estimated niusance parameter. The permutation test considered here is based on the Khmaladze transformation of the empirical process (Khmaladze (1981)), and adapted by Chung and Olivares (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PT.Khmaladze.fit(y1, y0, alpha = 0.05, n.perm = 999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y1</code></td>
<td>
<p>Numeric. A vector containing the response variable of the treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>Numeric. A vector containing the response variable of the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric. Nominal level for the test. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. The default is n.perm=999.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "PT.Khmaladze.fit" containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n_populations</code></td>
<td>
<p>Number of grups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Sample Size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.obs</code></td>
<td>
<p>Observed test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>The estimated nuisance parameter (average treatment effect).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>Critical Value. This value is used in the general construction of a randomization test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.perm</code></td>
<td>
<p>Vector. Test statistic recalculated for all permutations used in the stochastic approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_perm</code></td>
<td>
<p>Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_sizes</code></td>
<td>
<p>Groups size.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>


<h3>References</h3>

<p>Khmaladze, E. (1981). Martingale Approach in the Theory of Goodness-of-fit Tests. Theory of Probability and its Application, 26: 240â€“257.
Chung, E. and Olivares, M. (2021). Permutation Test for Heterogeneous Treatment Effects with a Nuisance Parameter. Forthcoming in Journal of Econometrics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
Y0 &lt;- rnorm(100, 1, 1)
# Treatment Group with constant shift equals to 1
Y1 &lt;- Y0 + 1
Tx = sample(100) &lt;= 0.5*(100)
# Observed Outcome 
Y = ifelse( Tx, Y1, Y0 )
dta &lt;- data.frame(Y = Y, Z = as.numeric(Tx))
pt.GoF&lt;-PT.Khmaladze.fit(dta$Y[dta$Z==1],dta$Y[dta$Z==0],n.perm = 49)
summary(pt.GoF)

## End(Not run)
</code></pre>


</div>