<div class="container">

<table style="width: 100%;"><tr>
<td>median</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Median rotation</h2>

<h3>Description</h3>

<p>Compute the sample projected or geometric median.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'SO3'
median(
  x,
  na.rm = FALSE,
  type = "projected",
  epsilon = 1e-05,
  maxIter = 2000,
  ...
)

## S3 method for class 'Q4'
median(
  x,
  na.rm = FALSE,
  type = "projected",
  epsilon = 1e-05,
  maxIter = 2000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code class="reqn">n\times p</code> matrix where each row corresponds to a
random rotation in matrix form (<code class="reqn">p=9</code>) or quaternion (<code class="reqn">p=4</code>) form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string indicating "projected" or "geometric" type mean estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>stopping rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>maximum number of iterations allowed before returning most
recent estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The median-type estimators are defined as
</p>
<p style="text-align: center;"><code class="reqn">\widetilde{\bm{S}}=argmin_{\bm{S}\in
SO(3)}\sum_{i=1}^nd(\bm{R}_i,\bm{S}).</code>
</p>
<p> If the choice of
distance metric <code class="reqn">d</code> is Riemannian then the estimator is called the
geometric median, and if the distance metric in Euclidean then it is called
the projected median. The algorithm used in the geometric case is discussed
in <cite>hartley11</cite> and the projected case is in <cite>stanfill2013</cite>.
</p>
<p>hartley11 stanfill2013
</p>


<h3>Value</h3>

<p>Estimate of the projected or geometric median in the same
parametrization.
</p>


<h3>See Also</h3>

<p><code>mean.SO3</code>, <code>bayes.mean</code>,
<code>weighted.mean.SO3</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">Rs &lt;- ruars(20, rvmises, kappa = 0.01)

# Projected median
median(Rs)

# Geometric median
median(Rs, type = "geometric")

# Bias of the projected median
rot.dist(median(Rs))

# Bias of the geometric median
rot.dist(median(Rs, type = "geometric"))

Qs &lt;- as.Q4(Rs)

# Projected median
median(Qs)

# Geometric median
median(Qs, type = "geometric")

# Bias of the projected median
rot.dist(median(Qs))

# Bias of the geometric median
rot.dist(median(Qs, type = "geometric"))
</code></pre>


</div>