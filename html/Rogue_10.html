<div class="container">

<table style="width: 100%;"><tr>
<td>TipVolatility</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect rogue taxa using phylogenetic information distance</h2>

<h3>Description</h3>

<p>Calculate the volatility of each tip: namely, the impact on the mean
phylogenetic information distance (Smith 2020) between
trees when that tip is removed.
Effective when the number of trees is small.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TipVolatility(trees)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>List of trees to analyse.</p>
</td>
</tr></table>
<h3>Value</h3>

<p><code>TipVolatility()</code> returns a named vector listing the volatility
index calculated for each leaf.
</p>


<h3>References</h3>

<p>Smith MR (2020).
“Information theoretic Generalized Robinson–Foulds metrics for comparing phylogenetic trees.”
<em>Bioinformatics</em>, <b>36</b>(20), 5007–5013.
<a href="https://doi.org/10.1093/bioinformatics/btaa614">doi:10.1093/bioinformatics/btaa614</a>.
</p>


<h3>See Also</h3>

<p>Other tip instability functions: 
<code>TipInstability()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("TreeTools", quietly = TRUE)

# Generate some trees with two rogue taxa
trees &lt;- AddTipEverywhere(BalancedTree(8), "Rogue")
trees[] &lt;- lapply(trees, AddTip, "Rogue", "Rogue2")

# Calculate tip volatility
sb &lt;- TipVolatility(trees)

# Use volatility to colour leaves in consensus tree
sbNorm &lt;- 1 + (99 * (sb - min(sb)) / (max(sb - min(sb))))
col &lt;- hcl.colors(128, "inferno")[sbNorm]
plot(consensus(trees), tip.color = col)

# Add a legend for the colour scale used
PlotTools::SpectrumLegend(
  "bottomleft", bty = "n", # Suppress box
  inset = -0.02,           # Avoid overlap
  title = "Volatility",
  legend = signif(seq(max(sb), min(sb), length.out = 4), 3),
  palette = hcl.colors(128, "inferno")
)

# Plot consensus after removing highly volatile taxa
plot(ConsensusWithout(trees, names(sb[sb == max(sb)])))
</code></pre>


</div>