<div class="container">

<table style="width: 100%;"><tr>
<td>opls_for_projection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>orthogonal scores algorithn of partial leat squares (opls) projection</h2>

<h3>Description</h3>

<p>Computes orthogonal socres partial least squares (opls)
projection with the NIPALS algorithm. It allows multiple response variables.
Although the main use of the function is for projection, it also retrieves
regression coefficients. NOTE: For internal use only!
</p>


<h3>Usage</h3>

<pre><code class="language-R">opls_for_projection(X, Y, ncomp, scale,
                    maxiter, tol,
                    pcSelmethod = "var",
                    pcSelvalue = 0.01, 
                    algorithm = "pls", 
                    xls_min_w = 3, 
                    xls_max_w = 15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix of predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a matrix of either a single or multiple response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>the number of pls components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical indicating whether <code>X</code> must be scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>limit for convergence of the algorithm in the nipals algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcSelmethod</code></td>
<td>
<p>if <code>regression = TRUE</code>, the method for selecting the
number of components.
Options are: <code>'manual'</code>, <code>'cumvar'</code> (for selecting the number of
principal components based on a given  cumulative amount of explained
variance) and <code>'var'</code> (for selecting the number of principal components
based on a given amount of explained variance). Default is <code>'cumvar'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcSelvalue</code></td>
<td>
<p>a numerical value that complements the selected method
(<code>pcSelmethod</code>).
If <code>'cumvar'</code> is chosen (default), <code>pcSelvalue</code> must be a value
(larger than 0 and below 1) indicating the maximum amount of cumulative
variance that the retained components should explain. Default is 0.99.
If <code>'var'</code> is chosen, <code>pcSelvalue</code> must be a value (larger than 0
and below 1) indicating that components that explain (individually)
a variance lower than this threshold must be excluded. If <code>'manual'</code>
is chosen, <code>pcSelvalue</code> has no effect and the number of components
retrieved are the one specified in <code>ncomp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>(for weights computation) a character string indicating
what method to use. Options are:
<code>'pls'</code> for pls (using covariance between X and Y),
<code>'mpls'</code> for modified pls (using correlation between X and Y) or
<code>'xls'</code> for extended pls (as implemented in BUCHI NIRWise PLUS software).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xls_min_w</code></td>
<td>
<p>(for weights computation) an integer indicating the minimum window size for the "xls"
method. Only used if <code>algorithm = 'xls'</code>. Default is 3 (as in BUCHI NIRWise PLUS software).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xls_max_w</code></td>
<td>
<p>(for weights computation) an integer indicating the maximum window size for the "xls"
method. Only used if <code>algorithm = 'xls'</code>. Default is 15 (as in BUCHI NIRWise PLUS software).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the following elements:
</p>

<ul>
<li>
<p><code>coefficients</code>: the matrix of regression coefficients.
</p>
</li>
<li>
<p><code>bo</code>: a matrix of one row containing the intercepts for
each component.
</p>
</li>
<li>
<p><code>scores</code>: the matrix of scores.
</p>
</li>
<li>
<p><code>X_loadings</code>: the matrix of X loadings.
</p>
</li>
<li>
<p><code>Y_loadings</code>: the matrix of Y loadings.
</p>
</li>
<li>
<p><code>projection_mat</code>: the projection matrix.
</p>
</li>
<li>
<p><code>Y</code>: the <code>Y</code> input.
</p>
</li>
<li>
<p><code>variance</code>: a <code>list</code> conating two objects: <code>x_var</code>
and <code>y_var</code>.
These objects contain information on the explained variance for the <code>X</code>
and <code>Y</code> matrices respectively.
</p>
</li>
<li>
<p><code>transf</code>: a <code>list</code> conating two objects: <code>Xcenter</code>
and <code>Xscale</code>.
</p>
</li>
<li>
<p><code>weights</code>: the matrix of wheights.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Leonardo Ramirez-Lopez
</p>


</div>