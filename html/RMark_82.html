<div class="container">

<table style="width: 100%;"><tr>
<td>popan.derived</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes some derived abundance estimates for POPAN models</h2>

<h3>Description</h3>

<p>Computes estimates, standard errors, confidence intervals and var-cov matrix
for population size of each group at each occasion and the sum across groups
by occasion for POPAN models. If a <code>marklist</code> is provided the estimates
are model averaged.
</p>


<h3>Usage</h3>

<pre><code class="language-R">popan.derived(x,model,revised=TRUE,normal=TRUE,N=TRUE,NGross=TRUE,drop=FALSE)
 
popan.Nt(Phi,pent,Ns,vc,time.intervals) 
 
popan.NGross(Phi,pent,Ns,vc,time.intervals)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>processed data list resulting from <code>process.data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a single mark POPAN model or a <code>marklist</code> of POPAN models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>revised</code></td>
<td>
<p>if TRUE, uses revised version of model averaged standard
error eq 6.12; otherwise uses eq 4.9 of Burnham and Anderson (2002)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normal</code></td>
<td>
<p>if TRUE, uses confidence interval based on normal
distribution; otherwise, uses log-normal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>if TRUE, will return abundance estimates by group and occasion and
total by occasion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NGross</code></td>
<td>
<p>if TRUE, will return gross abundance estimate per group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>if TRUE, models with any non-positive variance for betas are
dropped</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>interval-specific survival estimates for each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pent</code></td>
<td>
<p>occasion-specific prob of entry estimates (first computed by
subtraction) for each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ns</code></td>
<td>
<p>group specific super-population estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vc</code></td>
<td>
<p>variance-covariance matrix of the real parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.intervals</code></td>
<td>
<p>vector of time interval values</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>popan.derived</code> computes all of the real parameters using
<code>covariate.predictions</code> and handles all of the computation using
<code>popan.Nt</code>.  Description for functions <code>popan.Nt</code> and
<code>popan.NGross</code> are given here for completeness but it is not intended
that they be called directly.
</p>
<p>If a <code>model</code> is a <code>marklist</code> of models, the values returned by
<code>popan.derived</code> are model averaged using model weights in the
<code>model.table</code>; otherwise, it returns the values for the specified
model.
</p>


<h3>Value</h3>

<p><code>popan.derived</code> returns a list with the following elements
depending on the values of <code>N</code> and <code>NGross</code>: </p>
<pre> N -
dataframe of estimates by group and occasion and se, lcl,ucl and
group/occasion data N.vcv - variance-covariance matrix of abundance
estimates in N Nbyocc - dataframe of estimates by occasion (summed across
groups) and se, lcl,ucl and occasion data Nbyocc.vcv - variance-covariance
matrix of abundance estimates in Nbyocc NGross - dataframe of gross
abundance estimates by group and se, lcl,and ucl NGross.vcv -
variance-covariance matrix of NGross abundance estimates </pre>
<p><code>popan.Nt</code> returns a list with the following elements: </p>
<pre> N
- dataframe of estimates by group and occasion and se, lcl,ucl and
group/occasion data N.vcv - variance-covariance matrix of abundance
estimates in N </pre>
<p><code>popan.NGross</code> returns a list with the following elements:
</p>
<pre> NGross - vector of gross abundance estimates by group vcv -
variance-covariance matrix of abundance estimates in NGross </pre>


<h3>Author(s)</h3>

<p>Jeff Laake
</p>


<h3>References</h3>

<p>BURNHAM, K. P., AND D. R. ANDERSON. 2002. Model selection and
multimodel inference. A practical information-theoretic approach. Springer,
New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# This example is excluded from testing to reduce package check time
# Example
data(dipper)
dipper.processed=process.data(dipper,model="POPAN",groups="sex")
run.dipper.popan=function()
{
dipper.ddl=make.design.data(dipper.processed)
Phidot=list(formula=~1)
Phitime=list(formula=~time)
pdot=list(formula=~1)
ptime=list(formula=~time)
pentsex.time=list(formula=~time)
Nsex=list(formula=~sex)
#
# Run assortment of models
#
dipper.phisex.time.psex.time.pentsex.time=mark(dipper.processed,
     dipper.ddl,model.parameters=list(Phi=Phidot,p=ptime,
     pent=pentsex.time,N=Nsex),invisible=FALSE,adjust=FALSE,delete=TRUE)
dipper.psex.time.pentsex.time=mark(dipper.processed,dipper.ddl,
     model.parameters=list(Phi=Phitime,p=pdot,
     pent=pentsex.time,N=Nsex),invisible=FALSE,adjust=FALSE,delete=TRUE)
#
# Return model table and list of models
#
return(collect.models() )
}
dipper.popan.results=run.dipper.popan()
popan.derived(dipper.processed,dipper.popan.results)

</code></pre>


</div>