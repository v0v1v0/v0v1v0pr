<div class="container">

<table style="width: 100%;"><tr>
<td>rspde.matern.precision</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Precision matrix of the covariance-based rational approximation of
stationary Gaussian Matern random fields</h2>

<h3>Description</h3>

<p><code>rspde.matern.precision</code> is used for computing the
precision matrix of the
covariance-based rational SPDE approximation of a stationary Gaussian random
fields on <code class="reqn">R^d</code> with a Matern covariance function
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\sigma^2}{2^(\nu-1)\Gamma(\nu)}(\kappa h)^\nu
K_\nu(\kappa h)</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">rspde.matern.precision(
  kappa,
  nu,
  tau = NULL,
  sigma = NULL,
  rspde.order,
  dim,
  fem_mesh_matrices,
  only_fractional = FALSE,
  return_block_list = FALSE,
  type_rational_approx = "chebfun"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Range parameter of the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Shape parameter of the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Scale parameter of the covariance function. If sigma is
not provided, tau should be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Standard deviation of the covariance function. If tau is
not provided, sigma should be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rspde.order</code></td>
<td>
<p>The order of the rational approximation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>The dimension of the domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fem_mesh_matrices</code></td>
<td>
<p>A list containing the FEM-related matrices. The
list should contain elements c0, g1, g2, g3, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_fractional</code></td>
<td>
<p>Logical. Should only the fractional-order part of
the precision matrix be returned?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_block_list</code></td>
<td>
<p>Logical. For <code>type = "covariance"</code>, should the
block parts of the precision matrix be returned separately as a list?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_rational_approx</code></td>
<td>
<p>Which type of rational approximation should be
used? The current types are "chebfun", "brasil" or "chebfunLB".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The precision matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
nobs &lt;- 101
x &lt;- seq(from = 0, to = 1, length.out = nobs)
fem &lt;- rSPDE.fem1d(x)
kappa &lt;- 40
sigma &lt;- 1
d &lt;- 1
nu &lt;- 2.6
tau &lt;- sqrt(gamma(nu) / (kappa^(2 * nu) * (4 * pi)^(d / 2) *
gamma(nu + d / 2)))
range &lt;- sqrt(8*nu)/kappa
op_cov &lt;- matern.operators(
  loc_mesh = x, nu = nu, range = range, sigma = sigma,
  d = 1, m = 2, compute_higher_order = TRUE,
  parameterization = "matern"
)
v &lt;- t(rSPDE.A1d(x, 0.5))
c.true &lt;- matern.covariance(abs(x - 0.5), kappa, nu, sigma)
Q &lt;- rspde.matern.precision(
  kappa = kappa, nu = nu, tau = tau, rspde.order = 2, d = 1,
  fem_mesh_matrices = op_cov$fem_mesh_matrices
)
A &lt;- Diagonal(nobs)
Abar &lt;- cbind(A, A, A)
w &lt;- rbind(v, v, v)
c.approx_cov &lt;- (Abar) %*% solve(Q, w)

# plot the result and compare with the true Matern covariance
plot(x, matern.covariance(abs(x - 0.5), kappa, nu, sigma),
  type = "l", ylab = "C(h)",
  xlab = "h", main = "Matern covariance and rational approximations"
)
lines(x, c.approx_cov, col = 2)
</code></pre>


</div>