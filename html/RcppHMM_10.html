<div class="container">

<table style="width: 100%;"><tr>
<td>loglikelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Evaluation of multiple observed sequences given a model
</h2>

<h3>Description</h3>

<p>This function computes the log-likelihood of multiple observed sequences generated by a hidden Markov model with fixed parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loglikelihood(hmm, sequences)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hmm</code></td>
<td>
<p>a list with the necessary variables to define a hidden Markov model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequences</code></td>
<td>
<p>sequences of observations to be evaluated. HMM and PHMM use a matrix. GHMM uses a 3D array.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A value that represents the log-likelihood of the multiple observed sequences given the hiddden Markov model. HMM and PHMM use a matrix with different sequences as rows and consecutive observations in the columns. GHMM uses an array with the variables as rows, consecutive observations in the columns and different sequences as slices. 
</p>


<h3>References</h3>

<p>Cited references are listed on the RcppHMM manual page.
</p>


<h3>See Also</h3>

<p><code>generateObservations</code> , <code>verifyModel</code> , <code>evaluation</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Values for a hidden Markov model with categorical observations
# Set the model parameters
n &lt;- c("First","Second")
m &lt;- c("A","T","C","G")
A &lt;- matrix(c(0.8,0.2,
              0.1,0.9),
            nrow = 2,
            byrow = TRUE)

B &lt;- matrix(c(0.2, 0.2, 0.3, 0.3,
              0.4, 0.4, 0.1, 0.1),
            nrow = 2,
            byrow = TRUE)

Pi &lt;- c(0.5, 0.5)

params &lt;- list( "Model" = "HMM",
                "StateNames" = n,
                "ObservationNames" = m,
                "A" = A,
                "B" = B,
                "Pi" = Pi)

HMM &lt;- verifyModel(params)

# Data simulation
set.seed(100)
length &lt;- 100
seqs &lt;- 10

# Multiple sequences to be evaluated
observationSequences&lt;- c()
for(i in 1:seqs){
  Y &lt;- generateObservations(HMM , length)$Y
  observationSequences &lt;- rbind(observationSequences , Y)
}

dim(observationSequences)

#Sequences evaluation
loglikelihood(HMM, observationSequences)


## Values for a hidden Markov model with discrete observations

n &lt;- c("Low","Normal","High")

A &lt;- matrix(c(0.5, 0.3,0.2,
              0.2, 0.6, 0.2,
              0.1, 0.3, 0.6),
            ncol=length(n), byrow=TRUE)

B &lt;- c(2600,  # First distribution with mean 2600
       2700,  # Second distribution with mean 2700
       2800)  # Third distribution with mean 2800

Pi &lt;- rep(1/length(n), length(n))

HMM.discrete &lt;- verifyModel(list("Model"="PHMM", "StateNames" = n, "A" = A, "B" = B, "Pi" = Pi))

# Data simulation
set.seed(100)
length &lt;- 100
seqs &lt;- 10

# Multiple sequences to be evaluated
observationSequences&lt;- c()
for(i in 1:seqs){
  Y &lt;- generateObservations(HMM.discrete , length)$Y
  observationSequences &lt;- rbind(observationSequences , Y)
}

dim(observationSequences)

#Sequences evaluation
loglikelihood(HMM.discrete, observationSequences)

## Values for a hidden Markov model with continuous observations                          
# Number of hidden states = 3
# Univariate gaussian mixture model

N = c("Low","Normal", "High")
A &lt;- matrix(c(0.5, 0.3,0.2,
              0.2, 0.6, 0.2,
              0.1, 0.3, 0.6),
            ncol= length(N), byrow = TRUE)

Mu &lt;- matrix(c(0, 50, 100), ncol = length(N))
Sigma &lt;- array(c(144, 400, 100), dim = c(1,1,length(N)))
Pi &lt;- rep(1/length(N), length(N))

HMM.cont.univariate &lt;- verifyModel(list( "Model"="GHMM", 
                              "StateNames" = N,
                              "A" = A, 
                              "Mu" = Mu, 
                              "Sigma" = Sigma, 
                              "Pi" = Pi))

# Data simulation
set.seed(100)
length &lt;- 100
seqs &lt;- 10

# Multiple sequences to be evaluated
observationSequences&lt;- array(0, dim = c(1, length, seqs) )
for(i in 1:seqs){
  Y &lt;- generateObservations(HMM.cont.univariate , length)$Y
  observationSequences[,,i] &lt;- Y
}

dim(observationSequences)

#Sequences evaluation
loglikelihood(HMM.cont.univariate, observationSequences)


## Values for a hidden Markov model with continuous observations                          
# Number of hidden states = 2
# Multivariate gaussian mixture model
# Observed vector with dimensionality of 3
N = c("X1","X2")
M &lt;- 3

# Same number of dimensions
Sigma &lt;- array(0, dim =c(M,M,length(N)))
Sigma[,,1] &lt;- matrix(c(1.0,0.8,0.8,
                       0.8,1.0,0.8,
                       0.8,0.8,1.0), ncol = M,  
                     byrow = TRUE)
Sigma[,,2] &lt;- matrix(c(1.0,0.4,0.6,
                       0.4,1.0,0.8,
                       0.6,0.8,1.0), ncol = M,
                     byrow = TRUE)
Mu &lt;- matrix(c(0, 5, 
               10, 0, 
               5, 10), 
             nrow = M, 
             byrow = TRUE)

A &lt;- matrix(c(0.6,0.4,
              0.3, 0.7), 
            ncol = length(N),
            byrow = TRUE)
Pi &lt;- c(0.5, 0.5)

HMM.cont.multi &lt;- verifyModel(list( "Model" = "GHMM",
                              "StateNames" = N,
                              "A" = A, 
                              "Mu" = Mu, 
                              "Sigma" = Sigma, 
                              "Pi" = Pi))

# Data simulation
set.seed(100)
length &lt;- 100
seqs &lt;- 10

# Multiple sequences to be evaluated
observationSequences&lt;- array(0, dim = c(M, length, seqs) )
for(i in 1:seqs){
  Y &lt;- generateObservations(HMM.cont.multi , length)$Y
  observationSequences[,,i] &lt;- Y
}

dim(observationSequences)

#Sequences evaluation
loglikelihood(HMM.cont.multi, observationSequences)

</code></pre>


</div>