<div class="container">

<table style="width: 100%;"><tr>
<td>eqwrapup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Earthquake Wrap Uo
</h2>

<h3>Description</h3>

<p>Calculate error and summary 
information on earthquake location.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eqwrapup(Ldat, EQ, vel, distwt=20, lambdareg = 0.0, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ldat</code></td>
<td>
<p>List of station arrival times, lat-lon, and uncertainty
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EQ</code></td>
<td>
<p>List of earthquake location: Lat-Lon-z-t
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vel</code></td>
<td>
<p>velocity model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distwt</code></td>
<td>
<p>distance weight, default=20
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdareg</code></td>
<td>
<p>numeric, regularization parameter (default=0)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, TRUE=print information to screen
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Earthquakes are located with a generalized inverse (SVD).
covariance matrix is extracted and 95% confidence bounds are 
calculated.  Quality factors Q1 and Q1 estimate the 
quality iof the location based on the gap, minimum distance and rms.
</p>


<h3>Value</h3>

<p>List
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rms</code></td>
<td>
<p>Root Mean Square Residual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanres</code></td>
<td>
<p>Mean Residual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdres</code></td>
<td>
<p>Standard Dev of residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdmean</code></td>
<td>
<p>Standard error of mean residual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sswres</code></td>
<td>
<p>Sum squared weighted residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndf</code></td>
<td>
<p>Number of Degrees of Freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sterrx</code></td>
<td>
<p>km, error in X (East-West)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sterry</code></td>
<td>
<p>km, error in Y (North-South)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sterrz</code></td>
<td>
<p>km, error in Z, (depth)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sterrt</code></td>
<td>
<p>s, Delta-time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>covariance matrix (used for error ellipsoids)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap</code></td>
<td>
<p>Spatial gap (max subtended angle)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>herr</code></td>
<td>
<p>Horizontal error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distmin</code></td>
<td>
<p>Minimum distance to epicenter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q1</code></td>
<td>
<p>Quality Factor based on Gap and RMS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q2</code></td>
<td>
<p>Quality factor based on RMS, depth and min-Distance</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The Damping parameter (lambda) is set to zero.
In the UW lquake program, lambda is set to 0.02.
</p>


<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;
</p>


<h3>See Also</h3>

<p>Klocate, Glocate, getGAP
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(RSEIS, package='RSEIS')
data(GH, package='RSEIS')
data(wu_coso.vel, package='Rquake' )
vel = wu_coso.vel


gpf = GH$pickfile

w1 = which(gpf$STAS$phase=="P" | gpf$STAS$phase=="S" )

N = length(w1)

 Ldat =    list(
      name = gpf$STAS$name[w1],
      sec = gpf$STAS$sec[w1],
      phase = gpf$STAS$phase[w1],
      lat=gpf$STAS$lat[w1],
      lon = gpf$STAS$lon[w1],
      z = gpf$STAS$z[w1],
      err= gpf$STAS$err[w1],
      yr = rep(gpf$LOC$yr , times=N),
      jd = rep(gpf$LOC$jd, times=N),
      mo = rep(gpf$LOC$mo, times=N),
      dom = rep(gpf$LOC$dom, times=N),
      hr =rep( gpf$LOC$hr, times=N),
      mi = rep(gpf$LOC$mi, times=N) )

EQ = GH$pickfile$LOC

EQ$t = EQ$sec

kuality = eqwrapup(Ldat, EQ, vel, distwt = 20, verbose = TRUE )

names(kuality)

</code></pre>


</div>