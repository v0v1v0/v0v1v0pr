<div class="container">

<table style="width: 100%;"><tr>
<td>reptile_predict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predicting enhancer activity of given regions
</h2>

<h3>Description</h3>

<p>Predicting enhancer activities of query regions based on the enhancer
model from <code>reptile_train</code> in training step. This function
calculates the combined enhancer score for each query region (given
region) as the maximum among the score of whole query region and the
scores of DMRs within it. This function is for generating genome-wide
enhancer predictions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reptile_predict(reptile_model,
                epimark_region,
                epimark_DMR = NULL,
                family = "randomForest")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reptile_model</code></td>
<td>

<p>Enhancer model from <code>reptile_train</code>. It is a list containing
two objects of class <code>randomForest</code> or <code>glm</code> when
<code>family</code> is set to be "Logistic"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epimark_region</code></td>
<td>

<p>data.frame instance from read_epigenomic_data, which containing
intensity and intensity deviation values of each mark for each query
region
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epimark_DMR</code></td>
<td>

<p>data.frame instance from read_epigenomic_data, which containing
intensity and intensity deviation values of each mark for each DMR
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>classifier family used in the enhancer model
</p>
<p>Default: RandomForest
</p>
<p>Classifiers available:
</p>
<p>- RandomForest: random forest
</p>
<p>- Logistic: logistic regression
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing three vectors
</p>
<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Combined enhancer score of each query region</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Enhancer score of each query region</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DMR</code></td>
<td>
<p>Enhancer score of each DMR</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yupeng He <a href="mailto:yupeng.he.bioinfo@gmail.com">yupeng.he.bioinfo@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>reptile_predict_genome_wide</code>
</p>
<p><code>reptile_train</code>
</p>
<p><code>read_epigenomic_data</code>
</p>
<p><code>read_label</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("REPTILE")
data("rsd")

## Training
rsd_model &lt;- reptile_train(rsd$training_data$region_epimark,
                           rsd$training_data$region_label,
                           rsd$training_data$DMR_epimark,
                           rsd$training_data$DMR_label,
                           ntree=50)

## Prediction
## - REPTILE
pred &lt;- reptile_predict(rsd_model,
                        rsd$test_data$region_epimark,
                        rsd$test_data$DMR_epimark)
## - Random guessing
pred_guess = runif(length(pred$D))
names(pred_guess) = names(pred$D)

## Evaluation
res_reptile &lt;- reptile_eval_prediction(pred$D,
                                       rsd$test_data$region_label)
res_guess &lt;- reptile_eval_prediction(pred_guess,
                                     rsd$test_data$region_label)
## - Print AUROC and AUPR
cat(paste0("REPTILE\n",
           "  AUROC = ",round(res_reptile$AUROC,digit=3),
           "\n",
           "  AUPR  = ",round(res_reptile$AUPR,digit=3))
    ,"\n")
cat(paste0("Random guessing\n",
           "  AUROC = ",round(res_guess$AUROC,digit=3),
           "\n",
           "  AUPR  = ",round(res_guess$AUPR,digit=3))
   ,"\n")
</code></pre>


</div>