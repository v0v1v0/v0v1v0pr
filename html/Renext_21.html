<div class="container">

<table style="width: 100%;"><tr>
<td>fGPD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a two-parameters Generalised Pareto Distribution from a sample
</h2>

<h3>Description</h3>

<p>Fit a two-parameters Generalised Pareto Distribution from a sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
fGPD(x,
     info.observed = TRUE,
     shapeMin = -0.8,
     dCV = 1e-04,
     cov = TRUE,
     trace = 0)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>The sample data vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info.observed</code></td>
<td>

<p>Logical. The observed information matrix is used when <code>TRUE</code>
and the expected information matrix is used when <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapeMin</code></td>
<td>

<p>Lower bound on the shape parameter. This must be <code>&gt;= -1.0</code>
since otherwise the ML estimate is obtained with the <code>scale</code>
parameter equal to <code>max(x)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dCV</code></td>
<td>

<p>Half-length of a small interval centered on 1.0.  When the
Coefficient of Variation (CV) falls in this interval, an exponential
distribution is fitted, see <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>

<p>Logical. If <code>FALSE</code>, a minimal estimation is performed with
no covariance matrix or derivative returned. This can be useful
when a large number of ML estimations are required, e.g. to sample
from a likelihood ratio.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>Integer level of verbosity. The value <code>0</code> prints nothing.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function mainly relies on the <code>flomax</code> and
<code>fmaxlo</code> functions. When <code>CV</code> is larger than
<code>1.0 + dCV</code>, a Lomax distribution is fitted by Maximum Likelihood
using a concentrated log-likelihood.  When instead <code>CV</code> is
smaller than <code>1.0 - dCV</code>, a maxlo distribution is
fitted. Finally, when <code>CV -1.0</code> has absolute value <code>&lt;= dCV</code>,
an exponential distribution is fitted.  In all cases, the result is
translated into a parameter vector for the GPD.
</p>
<p>Note that when <code>CV</code> is close to <code>1.0</code>, fitting a Lomax or a
maxlo distribution can lead to problems because the estimated values
of the shape and scale parameter are large, and because the
concentrated log-likelihood is a flat function of the scale parameter.
</p>


<h3>Value</h3>

<p>A list
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>

<p>Vector containing the estimated values of the unknown parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>The coefficient of variation of <code>x</code> computed using
<code>length(x)</code> as denominator in the variance estimation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik, dlogLik</code></td>
<td>

<p>The maximised value of the log-likelihood and the vector of its
first order derivatives, which should be close to zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd, cov</code></td>
<td>

<p>Vector of approximated standard deviations and covariance matrix
for the estimated parameters. These are based on the inversion of
expected information matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd, cov</code></td>
<td>

<p>Vector of standard deviations and covariance matrix for the
estimates if the <code>cov</code> formal is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvg</code></td>
<td>

<p>Logical. Was convergence reached? This logical flag is set to
<code>TRUE</code> and remains for compatibility reasons.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It may happen that the estimated shape parameter is <code>&lt; -0.5</code>, in
which case the expected information matrix can not be computed, nor
does the covariance matrix and standard deviations. In this case, the
<code>cov</code> and <code>sd</code> objects contain <code>NA</code> values.  This
problem can arise also when the shape parameter is greater than but
close to the value <code>-0.5</code>. Even when <code>info.observed</code> is
<code>TRUE</code>, the information matrix, covariance and standard
deviations are set to <code>NA</code>.
</p>
<p>When the true (unknown) value is is <code>&lt; -0.5</code>, the regularity
conditions required in the ML approximated inference do not hold.
</p>
<p>The default value of <code>info.observed</code> was set to <code>TRUE</code> from
version <code>3.0-1</code> because standard deviations obtained with this
choice are usually better.
</p>


<h3>Author(s)</h3>

<p>Yves Deville
</p>


<h3>References</h3>

<p>See the <em>Renext Computing Details</em> document.
</p>


<h3>See Also</h3>

<p>The <code>fmaxlo</code> and <code>flomax</code> functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(123456)
n &lt;- 500
ns &lt;- 1000
xi &lt;- runif(ns, min = -0.5, max = 0.5)
X &lt;- matrix(nrow = n, ncol = ns)

for (i in 1:length(xi)) {
  Xi &lt;- rgpd(n, scale = 1, shape = xi[i])
  X[ , i] &lt;- Xi
  res1 &lt;- fGPD(Xi)
  res2 &lt;- try(fpot(Xi, threshold = 0.0))
  if (inherits(res2, "try-error")) {
    cat(res2, "\n")
    break
  }
  logLik1 &lt;- res1$loglik; logLik2 &lt;- logLik(res2)
  if (abs(logLik1 - logLik2) &gt; 0.001) {
    cat(sprintf("i = %d, xi = %7.4f\n", i, xi[i]))
    mat &lt;- rbind(c(res1$estimate[1:2], logLik = logLik1),
                 c(res2$estimate[1:2], logLik = logLik2))
    rownames(mat) &lt;- c("fGPD", "fpot")
    print(mat)
  }
}

## End(Not run)
</code></pre>


</div>