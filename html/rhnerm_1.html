<div class="container">

<table style="width: 100%;"><tr>
<td>cmseRHNERM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Conditional mean squared error estimation of the empirical Bayes estimators under random heteroscedastic nested error regression models
</h2>

<h3>Description</h3>

<p>Calculates the conditional mean squared error estimates of the empirical Bayes estimators under random heteroscedastic nested error regression models based on the parametric bootstrap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cmseRHNERM(y, X, ni, C, k=1, maxr=100, B=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>N*1 vector of response values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>N*p matrix containing N*1 vector of 1 in the first column and vectors of covariates in the rest of columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ni</code></td>
<td>

<p>m*1 vector of sample sizes in each area.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>m*p matrix of area-level covariates included in the area-level parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>area number in which the conditional mean squared error estimator is calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxr</code></td>
<td>

<p>maximum number of iteration for computing the maximum likelihood estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>number of bootstrap replicates.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>conditional mean squared error estimate in the kth area.
</p>


<h3>Author(s)</h3>

<p>Shonosuke Sugasawa
</p>


<h3>References</h3>

<p>Kubokawa, K., Sugasawa, S., Ghosh, M. and Chaudhuri, S. (2016). Prediction in Heteroscedastic nested error regression models with random dispersions. Statistica Sinica, 26, 465-492.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#generate data
set.seed(1234)
beta=c(1,1); la=1; tau=c(8,4)
m=20; ni=rep(3,m); N=sum(ni)
X=cbind(rep(1,N),rnorm(N))

mu=beta[1]+beta[2]*X[,2]
sig=1/rgamma(m,tau[1]/2,tau[2]/2); v=rnorm(m,0,sqrt(la*sig))
y=c()
cum=c(0,cumsum(ni))
for(i in 1:m){
  term=(cum[i]+1):cum[i+1]
  y[term]=mu[term]+v[i]+rnorm(ni[i],0,sqrt(sig[i]))
}

#fit the random heteroscedastic nested error regression
C=cbind(rep(1,m),rnorm(m))
cmse=cmseRHNERM(y,X,ni,C,B=10)
cmse
</code></pre>


</div>