<div class="container">

<table style="width: 100%;"><tr>
<td>estDerivs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates first and second derivatives of an oberved state variable</h2>

<h3>Description</h3>

<p>This function makes use of 2 functions written by Steven Boker, "gllaWMatrix" and "gllaEmbed" which are available on his website, http://people.virginia.edu/~smb3u/. It fits a coupled oscillator model for each dyad at different combinations of the input parameters (tau, embeds) and returns the input values and period of oscillation that maximize the R^2 for each dyad. It also estimates first and second derivatives of the observed state variable for each person at the input values that maximize the R^2 for that dyad and returns a dataframe that contains them.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estDerivs(prepData, taus, embeds, delta, idConvention)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prepData</code></td>
<td>
<p>A dataframe that was produced with the "dataPrep" function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>A vector containing the values of tau to use. Tau indicates the number of time points to lag in the lagged data matrix (see Boker, S.M., Deboeck, P.R., Edler, C., &amp; Keel, P.K. (2010). Generalized local linear approximation of derivatives from time series. In S.M. Chow &amp; E. Ferrer (Eds.), Statistical Methods for Modeling Human Dynamics: An Interdisciplinary Dialogue (pp. 161-178). New York, NY: Taylor &amp; Francis Group). The first derivative is estimated as the mean of the two adjacent slopes across that number of lags, e.g., if tau = 2 then the estimate of the first derivative at time = t is based on the mean of the slopes left and right of time t across 2 observations each. The second derivative is the difference in the two slopes with respect to time. Tau = 1 is sensitive to noise and increasing its value acts as smoothing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embeds</code></td>
<td>
<p>A vector containing the values of embeds to use. Embeds indicates the number of columns in the lagged data matrix. The minimum = 3 for 2nd order derivatives and higher values increase smoothing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>A value indicating the inter-observation interval. For example, if delta = 2, then every second observation is used in the estimation process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idConvention</code></td>
<td>
<p>The value that was added to the dist1 ID number to get the dist2 ID number</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list including: 1) "data" which is a dataframe containing first and second derivative estimates of an observed state variable, and 2) "fitTable" which shows the maximal R^2 achieved for each dyad for a coupled oscillator model, along with the associated tau, embed and estimated period of oscillation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- rties_ExampleDataShort
newData &lt;- dataPrep(basedata=data, dyadId="couple", personId="person", 
obs_name="dial", dist_name="female", time_name="time")
taus &lt;-c(2,3)
embeds &lt;- c(3,4)
delta &lt;- 1
derivs &lt;- estDerivs(prepData=newData, taus=taus, embeds=embeds, delta=delta, idConvention=500)
head(derivs$fitTable)
summary(derivs$fitTable[ ,4]) # summary of R-square
summary(derivs$fitTable[ ,5]) # summary of period of oscillation

</code></pre>


</div>