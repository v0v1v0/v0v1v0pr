<div class="container">

<table style="width: 100%;"><tr>
<td>diagnose_channel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Show channel signals with diagnostic plots</h2>

<h3>Description</h3>

<p>The diagnostic plots include 'Welch Periodogram'
(<code>pwelch</code>) and histogram (<code>hist</code>)
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnose_channel(
  s1,
  s2 = NULL,
  sc = NULL,
  srate,
  name = "",
  try_compress = TRUE,
  max_freq = 300,
  window = ceiling(srate * 2),
  noverlap = window/2,
  std = 3,
  which = NULL,
  main = "Channel Inspection",
  col = c("black", "red"),
  cex = 1.2,
  cex.lab = 1,
  lwd = 0.5,
  plim = NULL,
  nclass = 100,
  start_time = 0,
  boundary = NULL,
  mar = c(3.1, 4.1, 2.1, 0.8) * (0.25 + cex * 0.75) + 0.1,
  mgp = cex * c(2, 0.5, 0),
  xaxs = "i",
  yaxs = "i",
  xline = 1.66 * cex,
  yline = 2.66 * cex,
  tck = -0.005 * (3 + cex),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s1</code></td>
<td>
<p>the main signal to draw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>the comparing signal to draw; usually <code>s1</code> after some filters;
must be in the same sampling rate with <code>s1</code>; can be <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>decimated <code>s1</code> to show if <code>srate</code> is too high; will
be automatically generated if <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>srate</code></td>
<td>
<p>sampling rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>name of <code>s1</code>, or a vector of two names of <code>s1</code> and
<code>s2</code> if <code>s2</code> is provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try_compress</code></td>
<td>
<p>whether try to compress (decimate) <code>s1</code> if
<code>srate</code> is too high for performance concerns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_freq</code></td>
<td>
<p>the maximum frequency to display in 'Welch Periodograms'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window, noverlap</code></td>
<td>
<p>see <code>pwelch</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std</code></td>
<td>
<p>the standard deviation of the channel signals used to determine
<code>boundary</code>; default is plus-minus 3 standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p><code>NULL</code> or integer from 1 to 4; if <code>NULL</code>, all plots
will be displayed; otherwise only the subplot will be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>the title of the signal plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colors of <code>s1</code> and <code>s2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex, lwd, mar, cex.lab, mgp, xaxs, yaxs, tck, ...</code></td>
<td>
<p>graphical parameters; see
<code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plim</code></td>
<td>
<p>the y-axis limit to draw in 'Welch Periodograms'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p>number of classes to show in histogram
(<code>hist</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_time</code></td>
<td>
<p>the starting time of channel (will only be used to draw
signals)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>a red boundary to show in channel plot; default is
to be automatically determined by <code>std</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xline, yline</code></td>
<td>
<p>distance of axis labels towards ticks</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of boundary and y-axis limit used to draw the channel
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ravetools)

# Generate 20 second data at 2000 Hz
time &lt;- seq(0, 20, by = 1 / 2000)
signal &lt;- sin( 120 * pi * time) +
  sin(time * 20*pi) +
  exp(-time^2) *
  cos(time * 10*pi) +
  rnorm(length(time))

signal2 &lt;- notch_filter(signal, 2000)

diagnose_channel(signal, signal2, srate = 2000,
                 name = c("Raw", "Filtered"), cex = 1)

</code></pre>


</div>