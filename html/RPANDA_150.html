<div class="container">

<table style="width: 100%;"><tr>
<td>sim_t_comp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Recursive simulation (root-to-tip) of competition models 
</h2>

<h3>Description</h3>

<p>Simulates datasets for a given phylogeny under matching competition (MC), diversity dependent linear (DDlin), or diversity dependent exponential (DDexp) models of trait evolution. Simulations are carried out from the root to the tip of the tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
sim_t_comp(phylo,pars,root.value,Nsegments=1000,model="MC,DDexp,DDlin")

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>

<p>a vector containing the two parameters for the chosen model; all models require <code>sig2</code>, and additionally, the MC model requires <code>S</code>,
specifying the level of competition (larger negative values correspond to higher levels of competition), the DDlin model 
requires <code>b</code> and DDexp require <code>r</code>, the slope parameters (negative in cases of decline in evolutionary 
rates with increasing diversity). <code>sig2</code> must be listed first.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.value</code></td>
<td>

<p>a number specifying the trait value for the ancestor
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsegments</code></td>
<td>

<p>a value specifying the total number of time segments to simulate across for the phylogeny (see Details)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>model chosen to fit trait data, <code>"MC"</code> is the matching competition model of Nuismer &amp; Harmon 2014, <code>"DDlin"</code> is the diversity-dependent linear model, and <code>"DDexp"</code> is the diversity-dependent exponential model of Weir &amp; Mursleen 2013.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Adjusting <code>Nsegments</code> will impact the length of time the simulations take. 
The length of each segment (<code>max(nodeHeights(phylo))/Nsegments</code>) 
should be much smaller than the smallest branch (<code>min(phylo$edge.length)</code>).
</p>


<h3>Value</h3>

<p>a named vector with simulated trait values for <code class="reqn">n</code> species in the phylogeny
</p>


<h3>Author(s)</h3>

<p>J Drury <a href="mailto:jonathan.p.drury@gmail.com">jonathan.p.drury@gmail.com</a></p>


<h3>References</h3>

<p>Drury, J., Clavel, J., Manceau, M., and Morlon, H. 2016. Estimating the effect of competition on trait evolution using maximum likelihood inference. <em>Systematic Biology</em> doi 10.1093/sysbio/syw020
</p>
<p>Nuismer, S. &amp; Harmon, L. 2015. Predicting rates of interspecific interaction from phylogenetic trees. <em>Ecology Letters</em> 18:17-27.
</p>
<p>Weir, J. &amp; Mursleen, S. 2012. Diversity-dependent cladogenesis and trait evolution in the adaptive radiation of the auks (Aves: Alcidae). <em>Evolution</em> 67:403-416.
</p>


<h3>See Also</h3>

<p><code>fit_t_comp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Cetacea)


# Simulate data under the matching competition model
MC.data&lt;-sim_t_comp(Cetacea,pars=c(sig2=0.01,S=-0.1),root.value=0,Nsegments=1000,model="MC")

# Simulate data under the diversity dependent linear model
DDlin.data&lt;-sim_t_comp(Cetacea,pars=c(sig2=0.01,b=-0.0001),root.value=0,Nsegments=1000,
	model="DDlin")

# Simulate data under the diversity dependent linear model
DDexp.data&lt;-sim_t_comp(Cetacea,pars=c(sig2=0.01,r=-0.01),root.value=0,Nsegments=1000,model="DDexp")


</code></pre>


</div>