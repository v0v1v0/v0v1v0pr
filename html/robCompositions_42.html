<div class="container">

<table style="width: 100%;"><tr>
<td>daCoDa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear and quadratic discriminant analysis for compositional data.</h2>

<h3>Description</h3>

<p>Linear and quadratic discriminant analysis for compositional data using either robust or 
classical estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">daCoDa(x, grp, coda = TRUE, method = "classical", rule = "linear", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame containing the explanatory variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p>grouping variable: a factor specifying the class for each
observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coda</code></td>
<td>
<p>TRUE, when the underlying data are compositions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>“classical” or “robust”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>a character, either “linear” (the default) or “quadratic”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the functions passed through</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compositional data are expressed in orthonormal (ilr) coordinates (if <code>coda==TRUE</code>). For linear 
discriminant analysis the functions LdaClassic (classical) and Linda (robust) from the 
package rrcov are used. Similarly, quadratic discriminant analysis 
uses the functions QdaClassic and QdaCov (robust) from the same package.
</p>
<p>The classical linear and quadratic discriminant rules are invariant to ilr coordinates and clr
coefficients. The robust rules are invariant to ilr transformations if
affine equivariant robust estimators of location and covariance are taken.
</p>


<h3>Value</h3>

<p>An S4 object of class LdaClassic, Linda, QdaClassic or QdaCov. See package 
rrcov for details.
</p>


<h3>Author(s)</h3>

<p>Jutta Gamper
</p>


<h3>References</h3>

<p>Filzmoser, P., Hron, K., Templ, M. (2012) 
Discriminant analysis for compositional data and robust parameter estimation. 
<em>Computational Statistics</em>, 27(4), 585-604.
</p>


<h3>See Also</h3>

<p><code>LdaClassic</code>, <code>Linda</code>, 
<code>QdaClassic</code>, <code>QdaCov</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## toy data (non-compositional)
require(MASS)
x1 &lt;- mvrnorm(20,c(0,0,0),diag(3))
x2 &lt;- mvrnorm(30,c(3,0,0),diag(3))
x3 &lt;- mvrnorm(40,c(0,3,0),diag(3))
X &lt;- rbind(x1,x2,x3)
grp=c(rep(1,20),rep(2,30),rep(3,40))

clas1 &lt;- daCoDa(X, grp, coda=FALSE, method = "classical", rule="linear")
summary(clas1)
## predict runs only with newest verison of rrcov
## Not run: 
predict(clas1)

## End(Not run)
# specify different prior probabilities
clas2 &lt;- daCoDa(X, grp, coda=FALSE, prior=c(1/3, 1/3, 1/3))
summary(clas2)

## compositional data
data(coffee)
x &lt;- coffee[coffee$sort!="robusta",2:7]
group &lt;- droplevels(coffee$sort[coffee$sort!="robusta"])
cof.cla &lt;- daCoDa(x, group, method="classical", rule="quadratic")
cof.rob &lt;- daCoDa(x, group, method="robust", rule="quadratic")
## predict runs only with newest verison of rrcov
## Not run: 
predict(cof.cla)@ct
predict(cof.rob)@ct

## End(Not run)
</code></pre>


</div>