<div class="container">

<table style="width: 100%;"><tr>
<td>getFactorMarkers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find shared and dataset-specific markers</h2>

<h3>Description</h3>

<p>Applies various filters to genes on the shared (<code class="reqn">W</code>) and
dataset-specific (<code class="reqn">V</code>) components of the factorization, before selecting
those which load most significantly on each factor (in a shared or
dataset-specific way).
</p>


<h3>Usage</h3>

<pre><code class="language-R">getFactorMarkers(
  object,
  dataset1,
  dataset2,
  factorShareThresh = 10,
  datasetSpecificity = NULL,
  logFCThresh = 1,
  pvalThresh = 0.05,
  nGenes = 30,
  printGenes = FALSE,
  verbose = getOption("ligerVerbose", TRUE),
  factor.share.thresh = factorShareThresh,
  dataset.specificity = datasetSpecificity,
  log.fc.thresh = logFCThresh,
  pval.thresh = pvalThresh,
  num.genes = nGenes,
  print.genes = printGenes
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>liger object with factorization results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset1</code></td>
<td>
<p>Name of first dataset. Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset2</code></td>
<td>
<p>Name of second dataset. Required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factorShareThresh</code></td>
<td>
<p>Numeric. Only factors with a dataset specificity
less than or equal to this threshold will be used. Default <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datasetSpecificity</code></td>
<td>
<p>Numeric vector. Pre-calculated dataset specificity
if available. Length should match number of all factors available. Default
<code>NULL</code> automatically calculates with
<code>calcDatasetSpecificity</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logFCThresh</code></td>
<td>
<p>Numeric. Lower log-fold change threshold for differential
expression in markers. Default <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalThresh</code></td>
<td>
<p>Numeric. Upper p-value threshold for Wilcoxon rank test for
gene expression. Default <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nGenes</code></td>
<td>
<p>Integer. Max number of genes to report for each dataset.
Default <code>30</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printGenes</code></td>
<td>
<p>Logical. Whether to print ordered markers passing logFC,
UMI and frac thresholds, when <code>verbose = TRUE</code>. Default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Whether to show information of the progress. Default
<code>getOption("ligerVerbose")</code> or <code>TRUE</code> if users have not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor.share.thresh, dataset.specificity, log.fc.thresh, pval.thresh, num.genes, print.genes</code></td>
<td>
<p><b>Deprecated</b>. See Usage section for replacement.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list object consisting of the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>[value of 'dataset1']</code></td>
<td>
<p>data.frame of dataset1-specific markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shared</code></td>
<td>
<p>data.frame of shared markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>[value of 'dataset1']</code></td>
<td>
<p>data.frame of dataset2-specific markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_factors_V1</code></td>
<td>
<p>A frequency table indicating the number of factors each
marker appears, in dataset1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_factors_V2</code></td>
<td>
<p>A frequency table indicating the number of factors each
marker appears, in dataset2</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
result &lt;- getFactorMarkers(pbmcPlot, dataset1 = "ctrl", dataset2 = "stim")
print(class(result))
print(names(result))
result$shared %&gt;% group_by(factor_num) %&gt;% top_n(2, logFC)
</code></pre>


</div>