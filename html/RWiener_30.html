<div class="container">

<table style="width: 100%;"><tr>
<td>scorefun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Empirical Estimating Functions</h2>

<h3>Description</h3>

<p>!EXPERIMENTAL FUNCTION!
</p>
<p>Generic function for extracting the empirical estimating functions
of a fitted model. 
</p>
<p>!EXPERIMENTAL FUNCTION!
</p>


<h3>Usage</h3>

<pre><code class="language-R">scorefun(x, ...)
estfun(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a fitted model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix containing the empirical estimating functions.
Typically, this should be an <code class="reqn">n \times k</code> matrix corresponding
to <code class="reqn">n</code> observations and <code class="reqn">k</code> parameters. The columns should be named
as in <code>coef</code> or <code>terms</code>, respectively.
</p>
<p>The estimating function (or score function) for a model - <code>scorefun</code> - is the derivative of the objective function
with respect to the parameter vector. The empirical estimating functions is
the evaluation of the estimating function at the observed data (<code class="reqn">n</code> observations)
and the estimated parameters (of dimension <code class="reqn">k</code>).
</p>
<p>The <code>estfun</code> function is basically the score function, but with the
additional functionality to sum up the scores by the given covariable
<code>id</code> in the dataset.
</p>


<h3>References</h3>

<p>Zeileis A (2006), Object-Oriented Computation of Sandwich Estimators.
<em>Journal of Statistical Software</em>, <b>16</b>(9), 1â€“16.
URL <a href="http://www.jstatsoft.org/v16/i09/">http://www.jstatsoft.org/v16/i09/</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate random data
dat &lt;- rwiener(100,1,.2,.5,0.5)

## fit wdm
wdm1 &lt;- wdm(dat)

## estimating function
scores &lt;- scorefun(wdm1)

## print
head(scores)

## plot
par(mfrow=c(2,2))
plot(scores[,1]);plot(scores[,2]);plot(scores[,3]);plot(scores[,4])
</code></pre>


</div>