<div class="container">

<table style="width: 100%;"><tr>
<td>pClas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Classical estimators for the CDF
</h2>

<h3>Description</h3>

<p>Compute approximations of the CDF using the normal approximation,
normal-power approximation, shifted Gamma approximation or normal approximation to the shifted Gamma distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pClas(x, mean = 0, variance = 1, skewness = NULL, 
      method = c("normal", "normal-power", "shifted Gamma", "shifted Gamma normal"), 
      lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Vector of points to approximate the CDF in.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>

<p>Mean of the distribution, default is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>

<p>Variance of the distribution, default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skewness</code></td>
<td>

<p>Skewness coefficient of the distribution, this argument is not used for the normal approximation. Default is <code>NULL</code> meaning no skewness coefficient is provided.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Approximation method to use, one of <code>"normal"</code>, <code>"normal-power"</code>, <code>"shifted Gamma"</code> or <code>"shifted Gamma normal"</code>. Default is <code>"normal"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li>
<p> The <em>normal approximation</em> for the CDF of the r.v. <code class="reqn">X</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">F_X(x) \approx \Phi((x-\mu)/\sigma)</code>
</p>

<p>where <code class="reqn">\mu</code> and <code class="reqn">\sigma^2</code> are the mean and variance of <code class="reqn">X</code>, respectively.
</p>
</li>
<li>
<p> This approximation can be improved when the skewness parameter  
</p>
<p style="text-align: center;"><code class="reqn">\nu=E((X-\mu)^3)/\sigma^3</code>
</p>

<p>is available. The <em>normal-power approximation</em> of the CDF is then given by
</p>
<p style="text-align: center;"><code class="reqn">F_X(x) \approx \Phi(\sqrt{9/\nu^2 + 6z/\nu+1}-3/\nu)</code>
</p>

<p>for <code class="reqn">z=(x-\mu)/\sigma\ge 1</code> and <code class="reqn">9/\nu^2 + 6z/\nu+1\ge 0</code>.
</p>
</li>
<li>
<p> The <em>shifted Gamma approximation</em> uses the approximation
</p>
<p style="text-align: center;"><code class="reqn">X \approx \Gamma(4/\nu^2, 2/(\nu\times\sigma)) + \mu -2\sigma/\nu.</code>
</p>

<p>Here, we need that <code class="reqn">\nu&gt;0</code>.
</p>
</li>
<li>
<p> The <em>normal approximation to the shifted Gamma distribution</em> approximates the CDF of <code class="reqn">X</code> as
</p>
<p style="text-align: center;"><code class="reqn">F_X(x) \approx \Phi(\sqrt{16/\nu^2 + 8z/\nu}-\sqrt{16/\nu^2-1})</code>
</p>

<p>for <code class="reqn">z=(x-\mu)/\sigma\ge 1</code>. We need again that <code class="reqn">\nu&gt;0</code>.
</p>
</li>
</ul>
<p>See Section 6.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>Vector of estimates for the probabilities <code class="reqn">F(x)=P(X\le x)</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code>pEdge</code>, <code>pGC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Chi-squared sample
X &lt;- rchisq(1000, 2)

x &lt;- seq(0, 10, 0.01)

# Classical approximations
p1 &lt;- pClas(x, mean(X), var(X))
p2 &lt;- pClas(x, mean(X), var(X), mean((X-mean(X))^3)/sd(X)^3, method="normal-power")
p3 &lt;- pClas(x, mean(X), var(X), mean((X-mean(X))^3)/sd(X)^3, method="shifted Gamma")
p4 &lt;- pClas(x, mean(X), var(X), mean((X-mean(X))^3)/sd(X)^3, method="shifted Gamma normal")

# True probabilities
p &lt;- pchisq(x, 2)


# Plot true and estimated probabilities
plot(x, p, type="l", ylab="F(x)", ylim=c(0,1), col="red")
lines(x, p1, lty=2)
lines(x, p2, lty=3, col="green")
lines(x, p3, lty=4)
lines(x, p4, lty=5, col="blue")

legend("bottomright", c("True CDF", "normal approximation", "normal-power approximation",
                        "shifted Gamma approximation", "shifted Gamma normal approximation"), 
      lty=1:5, col=c("red", "black", "green", "black", "blue"), lwd=2)
</code></pre>


</div>