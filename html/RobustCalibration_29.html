<div class="container">

<table style="width: 100%;"><tr>
<td>rcalibration-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Robust Calibration class </h2>

<h3>Description</h3>

<p>S4 class for Robust rcalibration with or without the specification of the discrepancy model.</p>


<h3>Objects from the Class</h3>

<p>Objects of this class are created and initialized with the function <code>rcalibration</code> that computes the calculations needed for setting up the calibration and prediction.</p>


<h3>Slots</h3>


<dl>
<dt>
<code>p_x</code>:</dt>
<dd>
<p>Object of class <code>integer</code>. The dimension of the observed inputs.</p>
</dd>
<dt>
<code>p_theta</code>:</dt>
<dd>
<p>Object of class <code>integer</code>. The  calibration parameters.</p>
</dd>
<dt>
<code>num_obs</code>:</dt>
<dd>
<p>Object of class <code>integer</code>. The number of experimental observations.</p>
</dd>
<dt>
<code>input</code>:</dt>
<dd>
<p>Object of class <code>matrix</code> with dimension n x p_x. The design of experiments.</p>
</dd>
<dt>
<code>output</code>:</dt>
<dd>
<p>Object of class <code>vector</code> with dimension n x 1. The vector of the experimental observations.</p>
</dd>
<dt>
<code>X</code>:</dt>
<dd>
<p>Object of class <code>matrix</code> of with dimension n x q. The mean/trend discrepancy basis function.</p>
</dd>
<dt>
<code>have_trend</code>:</dt>
<dd>
<p>Object of class <code>bool</code> to specify whether the mean/trend discrepancy is zero. "TRUE" means it has zero mean discrepancy and "FALSE"" means the mean discrepancy is not zero.</p>
</dd>
<dt>
<code>q</code>:</dt>
<dd>
<p>Object of class <code>integer</code>. The number of basis functions of the mean/trend discrepancy.</p>
</dd>
<dt>
<code>R0</code>:</dt>
<dd>
<p>Object of class <code>list</code> of matrices where the j-th matrix is an absolute difference matrix of the j-th input vector.</p>
</dd>
<dt>
<code>kernel_type</code>:</dt>
<dd>
<p>A <code>character</code> to specify the type of kernel to use.</p>
</dd>
<dt>
<code>alpha</code>:</dt>
<dd>
<p>Object of class <code>vector</code>. Each element is the parameter for the roughness for each input coordinate in the kernel.</p>
</dd>
<dt>
<code>theta_range</code>:</dt>
<dd>
<p>A <code>matrix</code> for the range of the calibration parameters.</p>
</dd>
<dt>
<code>lambda_z</code>:</dt>
<dd>
<p>Object of class <code>vector</code> about how close the math model to the reality in squared distance when the S-GaSP model is used for modeling the discrepancy.</p>
</dd>
<dt>
<code>S</code>:</dt>
<dd>
<p>Object of class <code>integer</code> about how many posterior samples to run.</p>
</dd>
<dt>
<code>S_0</code>:</dt>
<dd>
<p>Object of class <code>integer</code> about the number of burn-in samples.</p>
</dd>
<dt>
<code>prior_par</code>:</dt>
<dd>
<p>Object of class <code>vector</code> about prior parameters.</p>
</dd>
<dt>
<code>output_weights</code>:</dt>
<dd>
<p>Object of class <code>vector</code> about the weights of the experimental data.</p>
</dd>
<dt>
<code>sd_proposal</code>:</dt>
<dd>
<p>Object of class <code>vector</code> about the standard deviation of the proposal distribution.</p>
</dd>
<dt>
<code>discrepancy_type</code>:</dt>
<dd>
<p>Object of class <code>character</code> about the discrepancy. If it is 'no-discrepancy', it means no discrepancy function. If it is 'GaSP', it means the GaSP model for the discrepancy function. If it is 'S-GaSP', it means the S-GaSP model for the discrepancy function.</p>
</dd>
<dt>
<code>simul_type</code>:</dt>
<dd>
<p>Object of class <code>integer</code> about the math model/simulator. If the simul_type is 0, it means we use RobustGaSP R package to build an emulator for emulation. If the simul_type is 1, it means the function of the math model is given by the user. When simul_type is 2 or 3, the mathematical model is the geophyiscal model for Kilauea Volcano.  If the simul_type is 2, it means it is for the ascending mode InSAR data; if the simul_type is 3, it means it is for the descending mode InSAR data.</p>
</dd>
<dt>
<code>emulator_rgasp</code>:</dt>
<dd>
<p>An S4 class of <code>rgasp</code> from the RobustGaSP package.</p>
</dd>
<dt>
<code>emulator_ppgasp</code>:</dt>
<dd>
<p>An S4 class of <code>ppgasp</code> from the RobustGaSP package.</p>
</dd>
<dt>
<code>post_sample</code>:</dt>
<dd>
<p>Object of class <code>matrix</code> for the posterior samples after burn-in.</p>
</dd>
<dt>
<code>post_value</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for the posterior values after burn-in.</p>
</dd>
<dt>
<code>accept_S</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for the number of proposed samples of the calibation parameters are accepted in MCMC. The first value is the number of proposed calibration parameters  are accepted in MCMC. The second value is  the number of proposed range and nugget parameters  are accepted.</p>
</dd>
<dt>
<code>count_boundary</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for the number of proposed samples of the calibation parameters are outside the range and they are rejected directly.</p>
</dd>
<dt>
<code>have_replicates</code>:</dt>
<dd>
<p>Object of class <code>bool</code> for having repeated experiments (replicates) or not.</p>
</dd>
<dt>
<code>num_replicates</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for the number of replicates at each observable input.</p>
</dd>
<dt>
<code>thinning</code>:</dt>
<dd>
<p>Object of class <code>integer</code> for the ratio between the number of posterior samples and the number of  samples to be recorded.</p>
</dd>
<dt>
<code>S_2_f</code>:</dt>
<dd>
<p>Object of class <code>numeric</code> for the variance of the field observations.</p>
</dd>
<dt>
<code>num_obs_all</code>:</dt>
<dd>
<p>Object of class <code>integer</code> for the total number of field observations.</p>
</dd>
<dt>
<code>method</code>:</dt>
<dd>
<p>Object of class <code>character</code> for posterior sampling or maximum likelihood estimation.</p>
</dd>
<dt>
<code>initial_values</code>:</dt>
<dd>
<p>Object of class <code>matrix</code> for initial starts of kernel parameters in maximum likelihood estimation.</p>
</dd>
<dt>
<code>param_est</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for estimated range and nugget parameter in parameter estimation.</p>
</dd>
<dt>
<code>opt_value</code>:</dt>
<dd>
<p>Object of class <code>numeric</code> for optimized likelihood or loss function.</p>
</dd>
<dt>
<code>emulator_type</code>:</dt>
<dd>
<p>Object of class <code>character</code> for the type of emulator. 'rgasp' means scalar-valued emulator and 'ppgasp' means vectorized emulator.</p>
</dd>
<dt>
<code>loc_index_emulator</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for location index to output in the ppgasp emulator  for computer models with vectorized output.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>show</dt>
<dd>
<p>Prints the main slots of the object. </p>
</dd>
<dt>predict</dt>
<dd>
<p>See <code>predict</code>.</p>
</dd>
<dt>predict_separable_2dim</dt>
<dd>
<p>See <code>predict_separable_2dim</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Mengyang Gu [aut, cre]
</p>
<p>Maintainer: Mengyang Gu &lt;mengyang@pstat.ucsb.edu&gt;
</p>


<h3>References</h3>

<p>A. O'Hagan and M. C. Kennedy (2001), <em>Bayesian calibration of computer models</em>, <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology</em>, <b>63</b>, 425-464.
</p>
<p>M. Gu (2016), <em>Robust Uncertainty Quantification and Scalable Computation for Computer Models with Massive Output</em>, Ph.D. thesis., Duke University.
</p>
<p>M. Gu and L. Wang (2017) <em>Scaled Gaussian Stochastic Process for Computer Model Calibration and Prediction</em>. arXiv preprint arXiv:1707.08215.
</p>
<p>M. Gu (2018) <em>Jointly Robust Prior for Gaussian Stochastic Process in Emulation, Calibration and Variable Selection
</em>. arXiv preprint arXiv:1804.09329.
</p>


<h3>See Also</h3>

 <p><code>rcalibration</code> for more details about how to create a <code>rcalibration</code> object.

</p>


</div>