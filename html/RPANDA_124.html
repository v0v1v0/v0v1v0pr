<div class="container">

<table style="width: 100%;"><tr>
<td>plot_phylo_comb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot shifts of diversifcation on a phylogeny
</h2>

<h3>Description</h3>

<p>Plots the phylogeny with colored branches according to shifts of diversification.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_phylo_comb(phylo, data, sampling.fractions, shift.res = NULL,
                combi, backbone.option = "crown.shift",
                main = NULL, col.sub = NULL, col.bck = "black",
                lty.bck = 1, tested_nodes = F, lad = T,
                leg = T, text.cex = 1, pch.cex = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data.frame containing a database of monophyletic groups for which potential shifts can be tested. This database should be based on taxonomy, ecology or traits and must contain a column named "Species" with species names as in phylo. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling.fractions</code></td>
<td>

<p>the output resulting from get.sampling.fractions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift.res</code></td>
<td>

<p>the output resulting from shift.estimates or NULL (default). This latter case allows to represent combinations only from the output of <code>get.comb.shift</code> by specifying the combination (see argument combi).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combi</code></td>
<td>

<p>character or numeric. If shift.res is provided, this argument is a numeric and corresponds to the rank of the combination in the global comparison (shift.res$total). If shift.res is NULL, this argument should be a character giving a combination of node IDs as in get.comb.shift output. This latter manner to specify combination allows to visualize a combination of shifts before having results.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backbone.option</code></td>
<td>

<p>type of the backbone analysis (see backbone.option in shift.estimates for more details):
</p>
 
<ul>
<li>
<p>"stem.shift": the stems of subclades are included in subclade analyses;
</p>
</li>
<li>
<p>"crown.shift": the stems of subclades are included in the backbone analysis (Default).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Character. The name of the plot. Default is NULL and the combination rank with AICc will be printed if shift.res is not NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.sub</code></td>
<td>

<p>character. A vector to specify colors of subclade(s). Can be let NULL (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.bck</code></td>
<td>

<p>character. A vector to specify colors of backbone(s). Default is "black" for simple backbone (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lad</code></td>
<td>

<p>bolean. Allows to ladderize the tree.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg</code></td>
<td>

<p>bolean. If TRUE, legend of the selected combination is added to the plot with names from data and best model names. Default is TRUE. The position is automatically adjusted in function of lad argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.bck</code></td>
<td>

<p>numeric. Define lty for the backbone.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tested_nodes</code></td>
<td>

<p>bolean. If TRUE, all the tested nodes are highlighted by a red point.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.cex</code></td>
<td>

<p>numeric. Define the size of legend text.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.cex</code></td>
<td>

<p>numeric. Define the size of points if tested_nodes = TRUE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments to be passed to plot or to plot.phylo.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If col.sub is not specified, color vector for subclades is c(c(brewer.pal(8, "Dark2"),brewer.pal(8, "Set1"),"darkmagenta","dodgerblue2", "orange", "forestgreen")). For multiple backbone, default vector is c("blue4", "orange4", "red4", "grey40", "coral4", "deeppink4", "khaki4", "darkolivegreen", "darkslategray",”black”).
... allows to set different graphical parameters from plot.phylo such as cex for size of tip labels or edge.width for the thickness of the phylogeny edges.
</p>


<h3>Value</h3>

<p>plot the phylogeny and returns the same invisible object as plot.phylo.
</p>


<h3>Author(s)</h3>

<p>Nathan Mazet</p>


<h3>References</h3>

<p>Mazet, N., Morlon, H., Fabre, P., Condamine, F.L., (2023). Estimating clade‐specific diversification rates and palaeodiversity dynamics from reconstructed phylogenies. <em>Methods in Ecology and in Evolution</em> 14, 2575–2591. https://doi.org/10.1111/2041-210X.14195
</p>


<h3>See Also</h3>

<p><code>shift.estimates</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# loading data
data("Cetacea")
data("taxo_cetacea")

taxo_cetacea_no_genus &lt;- taxo_cetacea[names(taxo_cetacea) != "Genus"]

# main procedure
f_cetacea &lt;- get.sampling.fractions(phylo = Cetacea, lad = FALSE,
                                    data = taxo_cetacea_no_genus,
                                    plot = TRUE, cex = 0.3)

comb.shift_cetacea &lt;- get.comb.shift(phylo = Cetacea,
                                     data = taxo_cetacea_no_genus,
                                     sampling.fractions = f_cetacea,
                                     Ncores = 4)

# use of plot_phylo_comb
# without shift.estimates results but with comb.shift_cetacea

plot_phylo_comb(phylo = Cetacea,
                data = taxo_cetacea,
                sampling.fractions = f_cetacea,
                combi = comb.shift_cetacea[15],
                label.offset = 0.3,
                main = "", lad = FALSE ,cex = 0.4)

</code></pre>


</div>