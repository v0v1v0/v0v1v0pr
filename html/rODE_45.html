<div class="container">

<table style="width: 100%;"><tr>
<td>Verlet-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Verlet ODE solver class</h2>

<h3>Description</h3>

<p>Verlet ODE solver class
</p>
<p>Verlet generic
</p>
<p>Verlet class constructor ODE
</p>


<h3>Usage</h3>

<pre><code class="language-R">Verlet(ode, ...)

## S4 method for signature 'Verlet'
init(object, stepSize, ...)

## S4 method for signature 'Verlet'
getRateCounter(object, ...)

## S4 method for signature 'Verlet'
step(object, ...)

## S4 method for signature 'ODE'
Verlet(ode, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ode</code></td>
<td>
<p>an ODE object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a class object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepSize</code></td>
<td>
<p>size of the step</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># ++++++++++++++++++++++++++++++++++++++++++++++++++  example: KeplerEnergyApp.R
# Demostration of the use of the Verlet ODE solver
#

importFromExamples("KeplerEnergy.R") # source the class Kepler

KeplerEnergyApp &lt;- function(verbose = FALSE) {
    # initial values
    x  &lt;- 1
    vx &lt;- 0
    y  &lt;- 0
    vy &lt;- 2 * pi
    dt &lt;- 0.01
    tol &lt;- 1e-3
    particle &lt;- KeplerEnergy()

    # Two ways of initializing the ODE object
      # particle &lt;- init(particle, c(x, vx, y, vy, 0))
    init(particle) &lt;- c(x, vx, y, vy, 0)

    odeSolver &lt;- Verlet(particle)

    # Two ways of initializing the solver
      # odeSolver &lt;- init(odeSolver, dt)
    init(odeSolver) &lt;-  dt

    particle@odeSolver &lt;- odeSolver
    initialEnergy      &lt;- getEnergy(particle)
    rowVector &lt;- vector("list")
    i &lt;- 1
    while (getTime(particle) &lt;= 1.20) {
        rowVector[[i]] &lt;- list(t  = getState(particle)[5],
                               x  = getState(particle)[1],
                               vx = getState(particle)[2],
                               y  = getState(particle)[3],
                               vy = getState(particle)[4],
                               E  = getEnergy(particle))
        particle &lt;- doStep(particle)
        energy   &lt;- getEnergy(particle)
        i &lt;- i + 1
    }
    DT &lt;- data.table::rbindlist(rowVector)
    return(DT)
}

solution &lt;- KeplerEnergyApp()
plot(solution)

# +++++++++++++++++++++++++++++++++++++++++++++++++++   application:  Logistic.R
# Simulates the logistic equation
importFromExamples("Logistic.R")

# Run the application
LogisticApp &lt;- function(verbose = FALSE) {
    x  &lt;- 0.1
    vx &lt;- 0
    r  &lt;- 2        # Malthusian parameter (rate of maximum population growth)
    K  &lt;- 10.0     # carrying capacity of the environment
    dt   &lt;- 0.01; tol  &lt;- 1e-3; tmax &lt;- 10

    population &lt;- Logistic()                # create a Logistic ODE object

    # Two ways of initializing the object
      # population &lt;- init(population, c(x, vx, 0), r, K)
    init(population) &lt;-  list(initState = c(x, vx, 0),
                              r = r,
                              K = K)

    odeSolver &lt;- Verlet(population)        # select the solver

    # Two ways of initializing the solver
      # odeSolver &lt;- init(odeSolver, dt)
    init(odeSolver) &lt;-  dt

    population@odeSolver &lt;- odeSolver
    # setSolver(population) &lt;-  odeSolver

    rowVector &lt;- vector("list")
    i &lt;- 1
    while (getTime(population) &lt;= tmax) {
        rowVector[[i]] &lt;- list(t = getTime(population),
                               s1 = getState(population)[1],
                               s2 = getState(population)[2])
        population &lt;- doStep(population)
        i &lt;- i + 1
    }
    DT &lt;- data.table::rbindlist(rowVector)
    return(DT)
}
# show solution
solution &lt;- LogisticApp()
plot(solution)
# ++++++++++++++++++++++++++++++++++++++++++++++++++  example: KeplerEnergyApp.R
# Demostration of the use of the Verlet ODE solver
#

importFromExamples("KeplerEnergy.R") # source the class Kepler

KeplerEnergyApp &lt;- function(verbose = FALSE) {
    # initial values
    x  &lt;- 1
    vx &lt;- 0
    y  &lt;- 0
    vy &lt;- 2 * pi
    dt &lt;- 0.01
    tol &lt;- 1e-3
    particle &lt;- KeplerEnergy()

    # Two ways of initializing the ODE object
      # particle &lt;- init(particle, c(x, vx, y, vy, 0))
    init(particle) &lt;- c(x, vx, y, vy, 0)

    odeSolver &lt;- Verlet(particle)

    # Two ways of initializing the solver
      # odeSolver &lt;- init(odeSolver, dt)
    init(odeSolver) &lt;-  dt

    particle@odeSolver &lt;- odeSolver
    initialEnergy      &lt;- getEnergy(particle)
    rowVector &lt;- vector("list")
    i &lt;- 1
    while (getTime(particle) &lt;= 1.20) {
        rowVector[[i]] &lt;- list(t  = getState(particle)[5],
                               x  = getState(particle)[1],
                               vx = getState(particle)[2],
                               y  = getState(particle)[3],
                               vy = getState(particle)[4],
                               E  = getEnergy(particle))
        particle &lt;- doStep(particle)
        energy   &lt;- getEnergy(particle)
        i &lt;- i + 1
    }
    DT &lt;- data.table::rbindlist(rowVector)
    return(DT)
}

solution &lt;- KeplerEnergyApp()
plot(solution)

# +++++++++++++++++++++++++++++++++++++++++++++++++++   application:  Logistic.R
# Simulates the logistic equation
importFromExamples("Logistic.R")

# Run the application
LogisticApp &lt;- function(verbose = FALSE) {
    x  &lt;- 0.1
    vx &lt;- 0
    r  &lt;- 2        # Malthusian parameter (rate of maximum population growth)
    K  &lt;- 10.0     # carrying capacity of the environment
    dt   &lt;- 0.01; tol  &lt;- 1e-3; tmax &lt;- 10

    population &lt;- Logistic()                # create a Logistic ODE object

    # Two ways of initializing the object
      # population &lt;- init(population, c(x, vx, 0), r, K)
    init(population) &lt;-  list(initState = c(x, vx, 0),
                              r = r,
                              K = K)

    odeSolver &lt;- Verlet(population)        # select the solver

    # Two ways of initializing the solver
      # odeSolver &lt;- init(odeSolver, dt)
    init(odeSolver) &lt;-  dt

    population@odeSolver &lt;- odeSolver
    # setSolver(population) &lt;-  odeSolver

    rowVector &lt;- vector("list")
    i &lt;- 1
    while (getTime(population) &lt;= tmax) {
        rowVector[[i]] &lt;- list(t = getTime(population),
                               s1 = getState(population)[1],
                               s2 = getState(population)[2])
        population &lt;- doStep(population)
        i &lt;- i + 1
    }
    DT &lt;- data.table::rbindlist(rowVector)
    return(DT)
}
# show solution
solution &lt;- LogisticApp()
plot(solution)
</code></pre>


</div>