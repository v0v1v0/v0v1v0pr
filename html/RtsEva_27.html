<div class="container">

<table style="width: 100%;"><tr>
<td>tsEvaFindTrendThreshold</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Trend Threshold</h2>

<h3>Description</h3>

<p>This function calculates the optimal trend threshold for a given time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tsEvaFindTrendThreshold(series, timeStamps, timeWindow)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>The time series data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeStamps</code></td>
<td>
<p>The timestamps corresponding to the time series data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeWindow</code></td>
<td>
<p>The time window for detrending the time series.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function iterates over different percentiles and calculates the
threshold based on each percentile. It then removes data points below the
threshold and detrends the time series using the specified time window.
The function calculates the correlation between the normalized trend
and the time series and stores the correlation coefficient for each percentile.
It performs a changepoint analysis to determine if there is a significant change
in the correlation coefficients. If a change point is found, the function returns
the percentile corresponding to the change point. If no change point is found,
the function returns the percentile with the highest correlation coefficient.
If there are negative values in the detrended time series,
the function returns the percentile with the fewest negative values.
</p>


<h3>Value</h3>

<p>The trend threshold value.
</p>


<h3>Examples</h3>

<pre><code class="language-R">timeAndSeries &lt;- ArdecheStMartin
#go from six-hourly values to daily max
timeAndSeries &lt;- max_daily_value(timeAndSeries)
#keep only the 30 last years
yrs &lt;- as.integer(format(timeAndSeries[,1], "%Y"))
tokeep &lt;- which(yrs&gt;=1990)
timeAndSeries &lt;- timeAndSeries[tokeep,]
timeWindow &lt;- 10*365 # 10 years
timeStamps &lt;- timeAndSeries[,1]
series &lt;- timeAndSeries[,2]
tsEvaFindTrendThreshold(series, timeStamps, timeWindow)

</code></pre>


</div>