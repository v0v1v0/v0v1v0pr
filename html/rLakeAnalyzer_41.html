<div class="container">

<table style="width: 100%;"><tr>
<td>wtr.layer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exploration of lake water column layers</h2>

<h3>Description</h3>

<p>Extract water column parameters of a given parameter from a profile using
the split-and-merge algorithm.  The cline is defined as the midpoint of the
layer of water where the physical property change in the greatest over a
small difference. The exact cline depends on the specification of measure.
For example if temperature is specified, then we can expect cline to output
the thermocline.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wtr.layer(data, depth, measure, thres = 0.1, z0 = 2.5, zmax = 150,
  nseg = "unconstrained")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data supplied as a bare (unquoted) value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>depth in metres; should be an increasing vector; supplied as a
bare (unquoted) value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>parameter measured in the water column profile; supplied as a
bare (unquoted) value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>error norm; defaults to 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0</code></td>
<td>
<p>initial depth in metres. Defaults to 2.5m</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zmax</code></td>
<td>
<p>maximum depth in metres: defaults to 150m</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseg</code></td>
<td>
<p>optional parameter to define the number of segments a priori;
defaults to an unconstrained approach whereby the algorithm determines
segmentations by minimzing the error norm over each segment</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a dataframes with a list column. This includes: nseg (number of
segments), mld (mix layer depth), cline (the midpoint of the segment
connecting inflection points that has the maximum slope; thermocline for
temperature measures) and segments calculated by the sm algorithm.
</p>


<h3>References</h3>

<p>Thomson, R. and I. Fine. 2003. Estimating Mixed Layer Depth from
Oceanic Profile Data. Journal of Atmospheric and Oceanic Technology. 20(2),
319-329.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("latesummer")
df1 &lt;- wtr.layer(depth=latesummer$depth, measure = latesummer$temper)
df1$mld
df1$segments

wtr.layer(data = latesummer, depth=depth, measure = temper, nseg=4)


</code></pre>


</div>