<div class="container">

<table style="width: 100%;"><tr>
<td>RE2C</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random effect meta-analysis for correlated test statistics</h2>

<h3>Description</h3>

<p>Random effect meta-analysis for correlated test statistics using RE2C
</p>


<h3>Usage</h3>

<pre><code class="language-R">RE2C(beta, stders, cor = diag(1, length(beta)), twoStep = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>regression coefficients from each analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stders</code></td>
<td>
<p>standard errors corresponding to betas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>correlation matrix between of test statistics.  Default considers uncorrelated test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twoStep</code></td>
<td>
<p>Apply two step version of RE2C that is designed to be applied only after the fixed effect model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Perform random effect meta-analysis for correlated test statistics using RE2 method of Han and Eskin (2011), or RE2 for correlated test statistics from Han, et al., (2016).  Also uses RE2C method of Lee, Eskin and Han (2017) to further test for heterogenity in effect size. By default, correlation is set to identity matrix to for independent test statistics.
</p>
<p>This method requires the correlation matrix to be symmatric positive definite (SPD).  If this condition is not satisfied, results will be NA.  If the matrix is not SPD, there is likely an issue with how it was generated. 
</p>
<p>However, evaluating the correlation between observations that are not pairwise complete can give correlation matricies that are not SPD.  In this case, consider running <code>Matrix::nearPD( x, corr=TRUE)</code> to produce the nearest SPD matrix to the input.
</p>


<h3>Value</h3>


<dl>
<dt>stat1:</dt>
<dd>
<p>statistic testing effect mean</p>
</dd>
<dt>stat2:</dt>
<dd>
<p>statistic testing effect heterogeneity</p>
</dd>
<dt>RE2Cp:</dt>
<dd>
<p>RE2 p-value accounting for correlelation between tests</p>
</dd>
<dt>RE2Cp.twoStep:</dt>
<dd>
<p>two step RE2C test after fixed effect test.  Only evaluated if <code>twoStep==TRUE</code></p>
</dd>
<dt>QE:</dt>
<dd>
<p>test statistic for the test of (residual) heterogeneity</p>
</dd>
<dt>QEp:</dt>
<dd>
<p>p-value for the test of (residual) heterogeneity</p>
</dd>
<dt>Isq:</dt>
<dd>
<p>I^2 statistic</p>
</dd>
</dl>
<p><code>QE</code>, <code>QEp</code> and <code>ISq</code> are only evaluted if correlation is diagonal
</p>


<h3>References</h3>


<p>Lee CH, Eskin E, Han B (2017).
“Increasing the power of meta-analysis of genome-wide association studies to detect heterogeneous effects.”
<em>Bioinformatics</em>, <b>33</b>(14), i379–i388.
<a href="https://doi.org/10.1093/bioinformatics/btx242">https://doi.org/10.1093/bioinformatics/btx242</a>.
</p>
<p>Han B, Duong D, Sul JH, de Bakker PI, Eskin E, Raychaudhuri S (2016).
“A general framework for meta-analyzing dependent studies with overlapping subjects in association mapping.”
<em>Human Molecular Genetics</em>, <b>25</b>(9), 1857–1866.
<a href="https://doi.org/10.1093/hmg/ddw049">https://doi.org/10.1093/hmg/ddw049</a>.
</p>
<p>Han B, Eskin E (2011).
“Random-effects model aimed at discovering associations in meta-analysis of genome-wide association studies.”
<em>The American Journal of Human Genetics</em>, <b>88</b>(5), 586–598.
<a href="https://doi.org/10.1016/j.ajhg.2011.04.014">https://doi.org/10.1016/j.ajhg.2011.04.014</a>.

</p>


<h3>Examples</h3>

<pre><code class="language-R">library(clusterGeneration)
library(mvtnorm)

# sample size
n = 30

# number of response variables
m = 6

# Error covariance
Sigma = genPositiveDefMat(m)$Sigma

# regression parameters
beta = matrix(.6, 1, m)

# covariates
X = matrix(rnorm(n), ncol=1)

# Simulate response variables
Y = X %*% beta + rmvnorm(n, sigma = Sigma)

# Multivariate regression
fit = lm(Y ~ X)

# Correlation between residuals
C = cor(residuals(fit))

# Extract effect sizes and standard errors from model fit
df = lapply(coef(summary(fit)), function(a) 
 data.frame(beta = a["X", 1], se = a["X", 2]))
df = do.call(rbind, df)

# Run fixed effects meta-analysis, 
# assume identity correlation  
LS( df$beta, df$se)

# Run random effects meta-analysis,
# assume identity correlation  
RE2C( df$beta, df$se)

# Run fixed effects meta-analysis, 
# account for correlation 
LS( df$beta, df$se, C)

# Run random effects meta-analysis,
# account for correlation 
RE2C( df$beta, df$se, C)

</code></pre>


</div>