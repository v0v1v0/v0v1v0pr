<div class="container">

<table style="width: 100%;"><tr>
<td>autoplot.predictCox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Predictions From a Cox Model</h2>

<h3>Description</h3>

<p>Plot predictions from a Cox model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'predictCox'
autoplot(
  object,
  type = NULL,
  ci = object$se,
  band = object$band,
  plot = TRUE,
  smooth = NULL,
  digits = 2,
  alpha = NA,
  group.by = "row",
  reduce.data = FALSE,
  ylab = NULL,
  first.derivative = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object obtained with the function <code>predictCox</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>[character] The type of predicted value to display.
Choices are:
<code>"hazard"</code> the hazard function,
<code>"cumhazard"</code> the cumulative hazard function, 
or <code>"survival"</code> the survival function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>[logical] If <code>TRUE</code> display the confidence intervals for the predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band</code></td>
<td>
<p>[logical] If <code>TRUE</code> display the confidence bands for the predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>[logical] Should the graphic be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>[logical] Should a smooth version of the risk function be plotted instead of a simple function?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>[integer] Number of decimal places when displaying the values of the covariates in the caption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>[numeric, 0-1] Transparency of the confidence bands. Argument passed to <code>ggplot2::geom_ribbon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.by</code></td>
<td>
<p>[character] The grouping factor used to color the prediction curves. Can be <code>"row"</code>, <code>"strata"</code>, or <code>"covariates"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduce.data</code></td>
<td>
<p>[logical] If <code>TRUE</code> only the covariates that does take indentical values for all observations are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>[character] Label for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first.derivative</code></td>
<td>
<p>[logical] If <code>TRUE</code>, display the first derivative over time of the risks/risk differences/risk ratios.
(confidence intervals are obtained via simulation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to cutomize the display.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Invisible. A list containing:
</p>

<ul>
<li>
<p> plot: the ggplot object.
</p>
</li>
<li>
<p> data: the data used to create the plot.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>predictCox</code> to compute cumulative hazard and survival based on a Cox model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
library(ggplot2)

#### simulate data ####
set.seed(10)
d &lt;- sampleData(1e2, outcome = "survival")
seqTau &lt;- c(0,sort(unique(d$time[d$event==1])), max(d$time))

#### Cox model ####
m.cox &lt;- coxph(Surv(time,event)~ X1 + X2 + X3,
                data = d, x = TRUE, y = TRUE)

## display baseline hazard
e.basehaz &lt;- predictCox(m.cox)
autoplot(e.basehaz, type = "cumhazard")
## Not run: 
autoplot(e.basehaz, type = "cumhazard", size.point = 0) ## without points
autoplot(e.basehaz, type = "cumhazard", smooth = TRUE)
autoplot(e.basehaz, type = "cumhazard", smooth = TRUE, first.derivative = TRUE)

## End(Not run)

## display baseline hazard with type of event
## Not run: 
e.basehaz &lt;- predictCox(m.cox, keep.newdata = TRUE)
autoplot(e.basehaz, type = "cumhazard")
autoplot(e.basehaz, type = "cumhazard", shape.point = c(3,NA))

## End(Not run)

## display predicted survival
## Not run: 
pred.cox &lt;- predictCox(m.cox, newdata = d[1:2,],
  times = seqTau, type = "survival", keep.newdata = TRUE)
autoplot(pred.cox)
autoplot(pred.cox, smooth = TRUE)
autoplot(pred.cox, group.by = "covariates")
autoplot(pred.cox, group.by = "covariates", reduce.data = TRUE)
autoplot(pred.cox, group.by = "X1", reduce.data = TRUE)

## End(Not run)

## predictions with confidence interval/bands
## Not run: 
pred.cox &lt;- predictCox(m.cox, newdata = d[1:2,,drop=FALSE],
  times = seqTau, type = "survival", band = TRUE, se = TRUE, keep.newdata = TRUE)
res &lt;- autoplot(pred.cox, ci = TRUE, band = TRUE, plot = FALSE)
res$plot + facet_wrap(~row)
res2 &lt;- autoplot(pred.cox, ci = TRUE, band = TRUE, alpha = 0.1, plot = FALSE)
res2$plot + facet_wrap(~row)

## End(Not run)

#### Stratified Cox model ####
## Not run: 
m.cox.strata &lt;- coxph(Surv(time,event)~ strata(X1) + strata(X2) + X3 + X4,
                      data = d, x = TRUE, y = TRUE)

## baseline hazard
pred.baseline &lt;- predictCox(m.cox.strata, keep.newdata = TRUE, type = "survival")
res &lt;- autoplot(pred.baseline)
res$plot + facet_wrap(~strata, labeller = label_both)

## predictions
pred.cox.strata &lt;- predictCox(m.cox.strata, newdata = d[1:3,,drop=FALSE],
                              time = seqTau, keep.newdata = TRUE, se = TRUE)

res2 &lt;- autoplot(pred.cox.strata, type = "survival", group.by = "strata", plot = FALSE)
res2$plot + facet_wrap(~strata, labeller = label_both) + theme(legend.position="bottom")

## smooth version
autoplot(pred.cox.strata, type = "survival", group.by = "strata", smooth = TRUE, ci = FALSE)

## End(Not run)

#### Cox model with splines ####
## Not run: 
require(splines)
m.cox.spline &lt;- coxph(Surv(time,event)~ X1 + X2 + ns(X6,4),
                data = d, x = TRUE, y = TRUE)
grid &lt;- data.frame(X1 = factor(0,0:1), X2 = factor(0,0:1),
                   X6 = seq(min(d$X6),max(d$X6), length.out = 100))
pred.spline &lt;- predictCox(m.cox.spline, newdata = grid, keep.newdata = TRUE,
                          se = TRUE, band = TRUE, centered = TRUE, type = "lp")
autoplot(pred.spline, group.by = "X6")
autoplot(pred.spline, group.by = "X6", alpha = 0.5)

grid2 &lt;- data.frame(X1 = factor(1,0:1), X2 = factor(0,0:1),
                    X6 = seq(min(d$X6),max(d$X6), length.out = 100))
pred.spline &lt;- predictCox(m.cox.spline, newdata = rbind(grid,grid2), keep.newdata = TRUE,
                          se = TRUE, band = TRUE, centered = TRUE, type = "lp")
autoplot(pred.spline, group.by = c("X6","X1"), alpha = 0.5, plot = FALSE)$plot + facet_wrap(~X1)

## End(Not run)
</code></pre>


</div>