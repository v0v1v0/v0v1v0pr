<div class="container">

<table style="width: 100%;"><tr>
<td>extractCorrelation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract the posterior distribution of evolutionary correlation</h2>

<h3>Description</h3>

<p>Function extracts the posterior distribution of evolutionary correlation among traits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extractCorrelation(post)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>post</code></td>
<td>
<p>a posterior distribution object as returned by the function 'readMCMC' or a merged posterior generated by 'mergePosterior'.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Returns a list with length equal to the number of regimes. Each list element is composed by a matrix with trait correlation types in the columns and the evolutionary correlations for each sample at the rows. <br><br>
One can plot the correlation values using boxplots and compare their distribution. Pairwise statistical tests across the samples is also possible.
</p>


<h3>Value</h3>

<p>a list with the posterior distribution of evolutionary correlations among traits. If the data is a 2x2 matrix then the object will be a matrix and each regime will be a column of this matrix.
</p>


<h3>Author(s)</h3>

<p>Daniel Caetano and Luke Harmon
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data( centrarchidae )
handle &lt;- ratematrixMCMC(data=centrarchidae$data, phy=centrarchidae$phy.map
                         , gen=10000, dir=tempdir())
posterior &lt;- readMCMC(handle, burn = 0.2, thin = 1)
## Get the correlations:
cor.list &lt;- extractCorrelation(post = posterior)
## Plot the results:
class( cor.list ) ## In this case we have a matrix.
boxplot(cor.list, names = c("Regime 1", "Regime 2"))
## Same example with more traits.
data( anoles )
handle &lt;- ratematrixMCMC(data=anoles$data[,1:3], phy=anoles$phy
                         , gen=5000, dir=tempdir())
anole_post &lt;- readMCMC(handle, burn = 0.2, thin = 1)
## Get the correlations:
cor.anole &lt;- extractCorrelation(post = anole_post)
## Plot the results:
class( cor.anole ) ## In this case we have a list!
names( cor.anole ) ## Each element is a regime.
## We can plot the regimes in separate.
boxplot(cor.anole$island)
boxplot(cor.anole$mainland)

</code></pre>


</div>