<div class="container">

<table style="width: 100%;"><tr>
<td>bootstrap_regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression parameters estimated using bootstrap resampling</h2>

<h3>Description</h3>

<p>Computes uncertainty in regression parameters of y(x) after Rustomji and Wilkinson (2008)
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootstrap_regression(Calibration, fit_eq, fit_glm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Calibration</code></td>
<td>
<p>data frame with surrogate(s) followed by analyte in last column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_eq</code></td>
<td>
<p>equation used to fit y(x), string (e.g, "y ~ x + x2", "y ~ x", "log10(y)~x')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_glm</code></td>
<td>
<p>logical to use Generalized Linear Models for models with factor (i.e., categorical) predictors</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with bootstrap regression parameters and list output from stats::lm()
</p>


<h3>Warning</h3>

<p>User should inspect regression residuals and relevant statistics to ensure model form is reasonable, suggested reading: regression diagnostics in Statistical Methods in Water Resources (https://doi.org/10.3133/tm4a3).
</p>
<p>One can call plot(fit) to view various regression diagnostic plots
</p>


<h3>Note</h3>

<p>Bias Correction Factor (BCF) is only relevant when analyte is transformed to log units, see https://doi.org/10.3133/tm4a3
to convert a model that used log(analyte) back to linear units use: analyte = 10^(f(surrogates)) x BCF
</p>


<h3>Author(s)</h3>

<p>Daniel Livsey (2023) ORCID: 0000-0002-2028-6128
</p>


<h3>References</h3>

<p>Rustomji, P., &amp; Wilkinson, S. N. (2008). Applying bootstrap resampling to quantify uncertainty in fluvial suspended sediment loads estimated using rating curves. Water resources research, 44(9).https://doi.org/10.1029/2007WR006088
</p>
<p>Helsel, D.R., Hirsch, R.M., Ryberg, K.R., Archfield, S.A., and Gilroy, E.J., 2020, #' Statistical methods in water resources: U.S. Geological Survey Techniques and Methods, book 4, chap. A3, 458 p. https://doi.org/10.3133/tm4a3
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# linear model
x &lt;- 1:10
y &lt;- 0.5*x + 10
boot &lt;- bootstrap_regression(data.frame(x,y),"y~x")
# polynomial model, call to I() needed for squaring x in equation string
x &lt;- 1:10
y &lt;- x + x^2
boot &lt;- bootstrap_regression(data.frame(x,y),"y ~ x+I(x^2)")
# power law model
# BCF returned since y is transformed to log units
x &lt;- 1:10
y &lt;- x^0.3
boot &lt;- bootstrap_regression(data.frame(x,y),"log10(y)~log10(x)")
# multivariate model
a &lt;- 1:10
b &lt;- a*2
c &lt;- a^2*b^3
boot &lt;- bootstrap_regression(data.frame(a,b,c),"log10(c)~log10(a)+log10(b)")

</code></pre>


</div>