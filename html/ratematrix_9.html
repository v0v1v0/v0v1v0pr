<div class="container">

<table style="width: 100%;"><tr>
<td>getStartPointFromPosterior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract sample from MCMC to use as starting point for another MCMC</h2>

<h3>Description</h3>

<p>Extract last sample from a previous MCMC analysis performed using either 'ratematrixMCMC' or 'ratematrixJointMCMC' to use as the starting point state for another MCMC analysis (also using 'ratematrixMCMC' or 'ratematrixJointMCMC', respectivelly). The number of traits and number of regimes need to be the same between the MCMC runs (the phylogeny and the configuration of the regimes can be changed).
</p>


<h3>Usage</h3>

<pre><code class="language-R">getStartPointFromPosterior(handle, dir = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>handle</code></td>
<td>
<p>the output object from the 'ratematrixMCMC' or 'ratematrixJointMCMC' functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>directory with the output files. If 'NULL' (default), then files are read from the directory chosen when running the MCMC chain using the argument 'dir' of the 'ratematrixMCMC' or 'ratematrixJointMCMC' functions (stored on handle). Otherwise function will read files from 'dir'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function can be used to replicate multiple MCMC runs starting from another MCMC. It can also be used to continue a MCMC chain from its last point, because it was was terminated prematurely or did not converge. Also see 'continueMCMC'. Note that 'continueMCMC' will not work with 'ratematrixJointMCMC' analyses, but this function does.
</p>


<h3>Value</h3>

<p>a sample from the posterior of a previous analysis to be used as the 'start' argument for the 'ratematrixMCMC' or 'ratematrixJointMCMC' functions.
</p>


<h3>Author(s)</h3>

<p>Daniel S. Caetano and Luke J. Harmon
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Load data
data(anoles)
## Run MCMC. This is just a very short chain.
phy &lt;- mergeSimmap(anoles$phy[[1]], drop.regimes = TRUE) ## Turn simmap into phylo.
traits &lt;- anoles$data[,c(1,2)] ## The continuous traits
## The predictor data.
pred &lt;- setNames(object = as.character(anoles$data$area), nm = rownames(anoles$data))
handle &lt;- ratematrixJointMCMC(data_BM = traits, data_Mk = pred, phy = phy
                              , gen = 1000, dir = tempdir())
## Load posterior distribution, make plots and check the log.
posterior &lt;- readMCMC(handle, burn=0.25, thin=1)
plotRatematrix(posterior)
plotRootValue(posterior)
## Start another MCMC from the last sample of the previous one.
st_pt &lt;- getStartPointFromPosterior(handle = handle)
handle_new &lt;- ratematrixJointMCMC(data_BM = traits, data_Mk = pred, phy = phy
                                  , start = st_pt, gen=1000, dir=tempdir())
post_new &lt;- readMCMC(handle_new, burn=0.25, thin=1)
plotRatematrix(post_new)
plotRootValue(post_new)

</code></pre>


</div>