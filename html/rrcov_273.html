<div class="container">

<table style="width: 100%;"><tr>
<td>Wilks.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Classical and Robust One-way MANOVA: Wilks Lambda
</h2>

<h3>Description</h3>

<p>Classical and Robust One-way MANOVA: Wilks Lambda
</p>


<h3>Usage</h3>

<pre><code class="language-R">
## S3 method for class 'formula'
Wilks.test(formula, data, ..., subset, na.action)

## Default S3 method:
Wilks.test(x, grouping, method=c("c", "mcd", "rank"), 
    approximation=c("Bartlett", "Rao", "empirical"),
    xd=NULL, xq=NULL, xfn = NULL, xwl=NULL, nrep=3000, trace=FALSE, ...)

## S3 method for class 'data.frame'
Wilks.test(x, ...)

## S3 method for class 'matrix'
Wilks.test(x, grouping, ..., subset, na.action)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>A formula of the form <code>groups ~ x1 + x2 + ...</code>  That is, the
response is the grouping factor and the right hand side specifies
the (non-factor) variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data frame from which variables specified in <code>formula</code> are
to be taken.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>(required if no formula is given as the principal argument.)
a matrix or data frame or Matrix containing the explanatory variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>

<p>grouping variable - a factor specifying the class for each 
observation (required if no formula argument is given.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>An index vector specifying the cases to be used. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>A function to specify the action to be taken if <code>NA</code>s are found.
The default action is for the procedure to fail.  An alternative is
<code>na.omit</code>, which leads to rejection of cases with missing values on
any required variable. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p><code>"c"</code> for standard estimators of the mean and variance,
<code>"mcd"</code> for MCD estimators of mean and variances and 
<code>"rank"</code> for rank based wilks' lambda as proposed by Nath and Pavur (1985).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approximation</code></td>
<td>

<p><code>"Bartlett"</code> for Bartlett approximation (default),
<code>"Rao"</code> for rao approximation (only for method="c") and
<code>"empirical"</code> for simulated empirical distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xd</code></td>
<td>
<p>multiplication factor for the approximate distribution of 
the robust Lambda statistic. If <code>xd=NULL</code> the factor will
computed by simulation and will be returned in the value (see Details)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xq</code></td>
<td>
<p>the degrees of freedom for the approximate <code class="reqn">\chi^2</code> distribution of 
the robust Lambda statistic. If <code>xq=NULL</code> the degrees of freedom will
computed by simulation and will be returned in the value (see Details)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xfn</code></td>
<td>
<p>the empirical distribution function. If <code>xfn=NULL</code> the empirical function  will
be estimated by simulation and will be returned in the value (see Details)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xwl</code></td>
<td>
<p>the simulated values of the robust statistic. If <code>xwl=NULL</code> the simulation 
will be performed and the calculated result will be returned in the value (see Details)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of trials for the simulations for computing the 
multiplication factor <code>xd</code> and the degrees of freedom <code>xq</code>. Default is <code>nrep=3000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>whether to print intermediate results. Default is <code>trace = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The classical Wilks' Lambda statistic for testing the equality of 
the group means of two or more groups is modified into a robust 
one through substituting the classical estimates by the highly robust 
and efficient reweighted MCD estimates, which can be computed efficiently 
by the FAST-MCD algorithm - see <code>CovMcd</code>. 
An approximation for the finite sample distribution of the
Lambda statistic is obtained, based on matching the mean and 
variance of a multiple of an <code class="reqn">\chi^2</code> distribution which 
are computed by simultaion.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the Wilks' Lambda statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>The corresponding approximation of the Wilks' lambda statistic and the degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the estimated mean vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xd</code></td>
<td>
<p>multiplication factor for the approximate distribution of 
the robust Lambda statistic. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xq</code></td>
<td>
<p>the degrees of freedom for the approximate <code class="reqn">\chi^2</code> distribution of 
the robust Lambda statistic. 
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function may be called giving either a formula and
optional data frame, or a matrix and grouping factor as the first
two arguments.  All other arguments are optional.
</p>


<h3>Author(s)</h3>

<p> Valentin Todorov <a href="mailto:valentin.todorov@chello.at">valentin.todorov@chello.at</a>
</p>


<h3>References</h3>

 
<p>Todorov, V. and Filzmoser, P. (2007) Robust statistic for the one-way MANOVA,
<em>submetted to the Journal of Environmetrics</em>.
</p>
<p>Todorov, V. (2007) Robust selection of variables in linear discriminant 
analysis, <em>Statistical Methods and Applications</em>, <b>15</b>, 
395.407, doi:10.1007/s10260-006-0032-6.
</p>
<p>Nath, R. and Pavur, R. (1985) A new statistic in the one way 
multivariate analysis of variance, <em>Computatational 
Statistics and Data Analysis</em>, <b>2</b>, 297â€“315
</p>


<h3>See Also</h3>

 <p><code>CovMcd</code>, <code>T2.test</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
data(anorexia)
grp &lt;- as.factor(anorexia[,1])
x &lt;- as.matrix(anorexia[,2:3])
##  Using the default interface, classical test
Wilks.test(x, grouping=grp, method="c")

##  Using the default interface, rank based test
Wilks.test(x, grouping=grp, method="rank")

## For this data set: p=2, n=n1+n2+n3=29+26+17
## were computed the following multiplication factor xd and degrees of freedom xq
##  for the MCD estimates with alpha=0.5
xd &lt;-  -0.02162666
xq &lt;- 3.63971
Wilks.test(x, grouping=grp, method="mcd", xd=xd, xq=xq)

## Now the same with the formula interface
Wilks.test(Treat~Prewt+Postwt, data=anorexia, method="mcd", xd=xd, xq=xq)

##Iris data with formula interface
data(iris)
Wilks.test(Species~., data=iris, method="c")

## and with default interface
Wilks.test(iris[,1:4],grouping=iris[,5], method="c")

# hemophilia data - classical, rank and MCD test
data(hemophilia)
hemophilia$gr &lt;- as.factor(hemophilia$gr)

Wilks.test(gr~., data=hemophilia, method="c")
Wilks.test(gr~., data=hemophilia, method="rank")
## already simulated parameters for MCD with alpha=0.5
xd &lt;- -0.01805436
xq &lt;- 1.950301
Wilks.test(gr~., data=hemophilia, xd=xd, xq=xq, method="mcd")

</code></pre>


</div>