<div class="container">

<table style="width: 100%;"><tr>
<td>RL4</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
(Block) randomization of subjects, patients into sequence groups
</h2>

<h3>Description</h3>

<p>This function creates a randomization list of subjects, patients 
into sequences of treatments.<br>
It is mainly intended for use in crossover studies but may be used also
for parallel group designs if for sequences c("T","R") is used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RL4(nsubj, seqs = c("TR", "RT"), blocksize, seed=runif(1,max=1E7), 
    randctrl=TRUE, pmethod=c("normal", "exact", "cc"), alpha=0.025)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsubj</code></td>
<td>

<p>Number of subjects, patients ... to be randomized.<br>
Or a vector of the subject numbers (f.i. 1001:1012)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqs</code></td>
<td>

<p>Character representation of the sequences.<br>
In BE studies for a 2x2 cross-over usually something like <code>c("TR", "RT")</code>.<br>
If you prefer the ABC notation write down here f.i. <code>c("AB", "BA")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocksize</code></td>
<td>

<p>Size of the blocks to randomize within.<br>
If blocksize is missing it defaults to 2*number of sequences.<br><br><code>blocksize</code> may be a vector of numbers. <br>
In that case the sizes of the blocks are randomly chosen from that vector.<br><br>
If <code>blocksize=0</code> then the randomization takes place in the one block 
with all subjects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>An integer for the initialisation of the random number generator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randctrl</code></td>
<td>

<p>Shall the creation of the randomlist controlled by a runs test of randomness?<br>
Defaults to <code>TRUE</code>.<br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmethod</code></td>
<td>

<p>A character string describing the method for the p-value calculation of the runs
test.<br><br><code>"normal"</code> denotes the normal approximation like the function(s) <code>runs.test()</code>
of the packages <code>tseries</code> or <code>lawstat</code>.<br><code>"exact"</code> chooses the calculation via exact distribution of the # of runs.<br><code>"cc"</code> chooses the continuity correction to the large sample approximation 
like in the statistical software SPSS.<br><br>
Default is <code>pmethod="normal"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Critical alpha value for re-creation of the randomlist based on the runs test.<br>
Recommended is <code>alpha=0.025</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As default the randomization is done as block randomization.<br>
If <code>blocksize</code> is given as a vector of numbers the sizes of the blocks 
are randomly chosen from that vector.<br>
If <code>blocksize=0</code> then the randomization takes place in the one block 
with all subjects.<br><br>
The randomization is in the default settings controlled by a Wald-Wolfowitz
runs test of randomness, i.e. if this test shows significant deviation from randomness
(p-value&lt;0.025 as default) the randomization list is recreated.<br> 
This behavior may be switched off by setting <code>randctrl=FALSE</code> if you don't
see any needfulness for such a control.<br>
The reason for such a control was originally to avoid randomlists with only
'alternating' sequences f.i. "TR" "RT" "TR" "RT" ...<br>
See <a href="http://forum.bebac.at/mix_entry.php?id=8745">http://forum.bebac.at/mix_entry.php?id=8745</a><br><br>
In its original form the runs test is only defined for dichotomous outcomes 
(i.e if 2 sequences are used).<br>
If more than 2 sequences are used the runs test is modified by dichotomizing
the sample of sequence numbers into cases &lt; median and &gt; median.<br>
See package <code>lawstat</code> or <a href="https://de.wikipedia.org/wiki/Run-Test">https://de.wikipedia.org/wiki/Run-Test</a> for this.
</p>


<h3>Value</h3>

<p>Returns a list of class "rl4".
This list has the components 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rl </code></td>
<td>
<p>A data.frame with the random list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed </code></td>
<td>
<p>The used seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocksize </code></td>
<td>
<p>The used blocksize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ninseqs </code></td>
<td>
<p>A named vector containing the number of subjects in the sequence groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs.pvalue </code></td>
<td>
<p>The p-value of a runs test of randomness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date </code></td>
<td>
<p>Date and time of creation.</p>
</td>
</tr>
</table>
<p><br>
The class rl4 has the S3 method <code>print.rl4</code>.
</p>


<h3>Note</h3>

<p>The blocksize(s) should be a multiple of the used # of sequences. 
If this is not the case it (they) will be adjusted accordingly.<br><br>
The number of subjects should be a multiple of the used # of sequences. 
If this is not the case a warning is thrown that the design is not balanced.<br><br>
The default for <code>pmethod</code> is the calculation via standard normal approximation.
This has shown the 'best' potential in rejecting the randomness for alternating
random lists.<br>
The randomness control does not work properly if more than 2 sequences are used.
In that case a test of repeated patterns of sequences in blocks of length=nseq is
done additionally to the runs test. Example (seqno) 1 2 3 1 2 3 ... 
</p>


<h3>Author(s)</h3>

<p>D. Labes<br>
Part of the code for using the runs test for randomness 
according to a suggestion by Helmut Schuetz.
</p>


<h3>See Also</h3>

<p><code>print.rl4, runs.pvalue</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># block randomization of 12 subjects for a 2x2 cross-over using the defaults
# seqs = c("TR", "RT"), blocksize=4 and seed from Sys.time()
RL4(nsubj=12)

# block randomization of a full replicate design with randomly
# chosen blocksizes 2 or 4
rl &lt;- RL4(nsubj=12, blocksize=c(2, 4), seqs=c("TRRT","RTTR"))
print(rl)

# randomization of 12 subjects for a 2x2 cross-over
# where the original random list don't pass the runs test
# watch the message.
RL4(nsubj=12, blocksize=0, seed=10)
#if you don't worry about some 'extreme' lists
RL4(nsubj=12, blocksize=0, seed=10, randctrl=FALSE)

# randomness control does'nt work that good in case of more 
# than 2 sequences: 3x3 latin square example
rl &lt;- RL4(nsubj=12, seq &lt;- c("ABC","BCA","CAB"), blocksize=3, seed=5125)
print(rl, sumry=TRUE)
# gives runs p.value=0.2502
</code></pre>


</div>