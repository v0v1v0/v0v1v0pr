<div class="container">

<table style="width: 100%;"><tr>
<td>optimizeNewK</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform factorization for new value of k</h2>

<h3>Description</h3>

<p>This uses an efficient strategy for updating that takes
advantage of the information in the existing factorization. It is most
recommended for values of <code>kNew</code> smaller than current value (<code>k</code>,
which is set when running <code>runINMF</code>), where it is more likely to
speed up the factorization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optimizeNewK(
  object,
  kNew,
  lambda = NULL,
  nIteration = 30,
  seed = 1,
  verbose = getOption("ligerVerbose"),
  k.new = kNew,
  max.iters = nIteration,
  rand.seed = seed,
  thresh = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A liger object. Should have integrative
factorization performed e.g. (<code>runINMF</code>) in advance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kNew</code></td>
<td>
<p>Number of factors of factorization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Numeric regularization parameter. By default <code>NULL</code>, this
will use the lambda value used in the latest factorization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIteration</code></td>
<td>
<p>Number of block coordinate descent iterations to
perform. Default <code>30</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed to allow reproducible results. Default <code>1</code>. Used
by <code>runINMF</code> factorization and initialization only when if
<code>kNew</code> is greater than <code>k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Whether to show information of the progress. Default
<code>getOption("ligerVerbose")</code> which is <code>TRUE</code> if users have not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.new, max.iters, rand.seed</code></td>
<td>
<p>These arguments are now replaced by others
and will be removed in the future. Please see usage for replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p><b>Deprecated</b>. New implementation of iNMF does not require
a threshold for convergence detection. Setting a large enough
<code>nIteration</code> will bring it to convergence.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>object</code> with <code>W</code> slot updated with the new <code class="reqn">W</code>
matrix, and the <code>H</code> and <code>V</code> slots of each
ligerDataset object in the <code>datasets</code> slot updated with
the new dataset specific <code class="reqn">H</code> and <code class="reqn">V</code> matrix, respectively.
</p>


<h3>See Also</h3>

<p><code>runINMF</code>, <code>optimizeNewLambda</code>,
<code>optimizeNewData</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">pbmc &lt;- normalize(pbmc)
pbmc &lt;- selectGenes(pbmc)
pbmc &lt;- scaleNotCenter(pbmc)
# Only running a few iterations for fast examples
if (requireNamespace("RcppPlanc", quietly = TRUE)) {
    pbmc &lt;- runINMF(pbmc, k = 20, nIteration = 2)
    pbmc &lt;- optimizeNewK(pbmc, kNew = 25, nIteration = 2)
}
</code></pre>


</div>