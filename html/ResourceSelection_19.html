<div class="container">

<table style="width: 100%;"><tr>
<td>rsf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Resource Selection (Probability) Functions for Use-Availability Data
</h2>

<h3>Description</h3>

<p>Resource Selection (Probability) Functions for
use-availability wildlife data as described in
Lele and Keim (2006) and Lele (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsf(formula, data, m, B = 99, inits, method = "Nelder-Mead",
control, model = TRUE, x = FALSE, ...)

rspf(formula, data, m, B = 99, link = "logit", inits,
method = "Nelder-Mead", control, model = TRUE, x = FALSE, ...)

rsf.fit(X, Y, m, link = "logit", B = 99,
inits, method = "Nelder-Mead", control, ...)

rsf.null(Y, m, inits, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>two sided model formula of the form <code>y ~ x</code>,
where <code>y</code> is a vector of observations,
<code>x</code> is the set of covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>argument describing the matching of use and available points, see Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>number of bootstrap iterations to make.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>character, type of link function to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>

<p>initial values, optional.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>method to be used in <code>optim</code> for numerical optimization.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>control options for <code>optim</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>a logical value indicating whether model frame should be included as a component of the returned value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>logical values indicating whether the model matrix used in the
fitting process should be returned as components of the returned value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>vector of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>covariate matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other arguments passed to the functions.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>rsf</code> function fits the Exponential Resource Selection Function
(RSF) model to presence only data.
</p>
<p>The <code>rspf</code> function fits the Resource Selection Probability Function
(RSPF) model to presence only data Link function <code>"logit"</code>,
<code>"cloglog"</code>, and <code>"probit"</code> can be specified via the
<code>link</code> argument.
</p>
<p>The <code>rsf.fit</code> is the workhorse behind the two functions.
<code>link="log"</code> leads to Exponential RSF.
</p>
<p>The <code>rsf.null</code> function fits the 'no selection' version
of the Exponential Resource Selection Function (RSF) model to presence only data.
</p>
<p>LHS of the <code>formula</code> data must be binary, ones indicating used locations,
while zeros indicating available location.
</p>
<p>All available points are used for each use points if <code>m=0</code>
(global availability). If <code>m</code> is a single value, e.g. <code>m=5</code>,
it is assumed that available data points are grouped in batches of 5,
e.g. with IDs <code>c(1,2)</code> for used point locations and
<code>c(1, 1, 1, 1, 1, 2, 2, 2, 2, 2)</code> for available locations
(local availability, matched use-available design).
Similarly, a vector of matching IDs can also be provided, e.g.
<code>c(1, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2)</code> by combining the above two.
This potentially could allow for unbalanced matching
(e.g. <code>c(1, 2, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2)</code>)
and for easier subsetting of the data,
but comes with an increased computing time.
Note, the response in the LHS of the formula
should be coded as <code>c(1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)</code>
for all of the above examples. When <code>m</code> is defined as
a mapping vector or the value is 0, the order of course does not matter.
However, ordering matters when <code>m</code> is constant because that
implies a certain structure.
</p>
<p>For model description and estimation details, see Lele and Keim (2006),
Lele (2009), and Solymos and Lele (2016).
</p>


<h3>Value</h3>

<p>A list with class <code>"rsf"</code>, <code>"rsf.null"</code>, or <code>"rspf"</code>
containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector from LHS of the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.error</code></td>
<td>
<p>a named vector of standard errors
for the coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the maximized pseudo log-likelihood according to Lele 2009.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p><code>optim</code> results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>character, value of the link function used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>control parameters for <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>initial values used in optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>value of the <code>m</code> argument with possibly matched
use-available design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>number of active parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>vector of fitted values. These are relative
selection values for RSF models, and probability of selection for
RSPF models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>number of used locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>component to store bootstrap results if <code>B</code>&gt;0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>logical, indicating convergence of the optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the <code>terms</code> object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a record of the levels of the factors used in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>the contrasts used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>if requested, the model frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>if requested, the model matrix.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Subhash R. Lele, Jonah L. Keim, Peter Solymos
</p>


<h3>References</h3>

<p>Lele, S.R. (2009)
A new method for estimation of resource selection probability function.
Journal of Wildlife Management 73, 122–127.
</p>
<p>Lele, S. R. &amp;  Keim, J. L. (2006)
Weighted distributions and estimation of resource selection probability functions.
Ecology 87, 3021–3028.
</p>
<p>Solymos, P. &amp; Lele, S. R. (2016)
Revisiting resource selection probability functions and single-visit methods:
clarification and extensions.
Methods in Ecology and Evolution 7, 196–205.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## --- Simulated data example ---

## settings
n.used &lt;- 1000
m &lt;- 10
n &lt;- n.used * m
set.seed(1234)
x &lt;- data.frame(x1=rnorm(n), x2=runif(n))
cfs &lt;- c(1.5,-1,0.5)
## fitting Exponential RSF model
dat1 &lt;- simulateUsedAvail(x, cfs, n.used, m, link="log")
m1 &lt;- rsf(status ~ .-status, dat1, m=0, B=0)
summary(m1)
## fitting Logistic RSPF model
dat2 &lt;- simulateUsedAvail(x, cfs, n.used, m, link="logit")
m2 &lt;- rspf(status ~ .-status, dat2, m=0, B=0)
summary(m2)

## --- Real data analysis from Lele &amp; Keim 2006 ---

## Not run: 
goats$exp.HLI &lt;- exp(goats$HLI)
goats$sin.SLOPE &lt;- sin(pi * goats$SLOPE / 180)
goats$ELEVATION &lt;- scale(goats$ELEVATION)
goats$ET &lt;- scale(goats$ET)
goats$TASP &lt;- scale(goats$TASP)

## Fit two RSPF models:
## global availability (m=0) and bootstrap (B=99)
m1 &lt;- rspf(STATUS ~ TASP + sin.SLOPE + ELEVATION, goats, m=0, B = 99)
m2 &lt;- rspf(STATUS ~ TASP + ELEVATION, goats, m=0, B = 99)

## Inspect the summaries
summary(m1)
summary(m2)

## Compare models: looks like m1 is better supported
CAIC(m1, m2)

## Visualize the relationships
plot(m1)
mep(m1) # marginal effects similar to plot but with CIs
kdepairs(m1) # 2D kernel density estimates
plot(m2)
kdepairs(m2)
mep(m2)

## fit and compare to null RSF model (not available for RSPF)
m3 &lt;- rsf(STATUS ~ TASP + ELEVATION, goats, m=0, B = 0)
m4 &lt;- rsf.null(Y=goats$STATUS, m=0)
CAIC(m3, m4)

## End(Not run)
</code></pre>


</div>