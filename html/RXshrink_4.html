<div class="container">

<table style="width: 100%;"><tr>
<td>correct.signs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normal-Theory Maximum Likelihood Estimation of Beta Coefficients with "Correct" Signs</h2>

<h3>Description</h3>

<p>Obenchain(1978) discussed the risk of linear generalized ridge estimators in individual directions
within p-dimensional X-space. While shrinkage to ZERO is clearly optimal for all directions
strictly ORTHOGONAL to the true BETA, he showed that optimal shrinkage in the UNKNOWN direction
PARALLEL to the true BETA is possible. This optimal BETA estimate is of the form k * X'y, where
k is the positive scalar given in equation (4.2), page 1118. The correct.signs() function computes
this estimate, B(=), that uses GRR delta-shrinkage factors proportional to X-matrix eigenvalues.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  correct.signs(form, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>A regression formula [y~x1+x2+...] suitable for use with lm().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing observations on all variables in the formula.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Ill-conditioned (nearly multi-collinear) regression models can produce Ordinary Least
Squares estimates with numerical signs that differ from those of the X'y vector. This is disturbing
because X'y contains the sample <b>correlations</b> between the X-predictor variables and
y-response variable. After all, these variables have been "centered" by subtracting off their
mean values and rescaled to vectors of length one.  Besides displaying OLS estimates, the
correct.signs() function also displays the "correlation form" of X'y, the estimated delta-shrinkage
factors, and the k-rescaled beta-coefficients. Finally, the "Bfit" vector of estimates proportional
to B(=) is displayed that minimizes the restricted Residual Sum-of-Squares. This restricted RSS of
Bfit cannot, of course, be less than the RSS of OLS, but it can be MUCH less that the RSS of B(=)
whenever B(=) shrinkage appears excessive.
</p>


<h3>Value</h3>

<p> An output list object of class "correct.signs":
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>The regression formula specified as the first argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of regression predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>Numerical value of R-square goodness-of-fit statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>Numerical value of the residual mean square estimate of error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prinstat</code></td>
<td>
<p>Listing of principal statistics (p by 5) from qm.ridge().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kpb</code></td>
<td>
<p>Maximum likelihood estimate of k-factor in equation (4.2) of Obenchain(1978).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bmf</code></td>
<td>
<p>Rescaling factor for B(=) to minimize the Residual Sum-of-Squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signs</code></td>
<td>
<p>Listing of five Beta coefficient statistics (p by 5): OLS, X'y, Delta, B(=) and Bfit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loff</code></td>
<td>
<p>Lack-of-Fit statistics: Residual Sum-of-Squares for OLS, X'y, B(=) and Bfit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqcor</code></td>
<td>
<p>Squared Correlation between the y-vector and its predicted values. The two values
displayed are for OLS predictions or for predictions using Bfit, X'y or B(=). These two values
are the familiar R^2 coefficients of determination for OLS and Bfit.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (1978) Good and Optimal Ridge Estimators. <em>Annals of Statistics</em>
<b>6</b>, 1111-1121. <a href="https://doi.org/10.1214/aos/1176344314">doi:10.1214/aos/1176344314</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.2. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>See Also</h3>

<p><code>eff.ridge</code>, <code>qm.ridge</code> and <code>MLtrue</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxcsobj &lt;- correct.signs(form, data=longley2)
  rxcsobj
  str(rxcsobj)
</code></pre>


</div>