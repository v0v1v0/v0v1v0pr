<div class="container">

<table style="width: 100%;"><tr>
<td>logit.env</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the envelope model in logistic regression</h2>

<h3>Description</h3>

<p>Fit the envelope model in logistic regression with dimension u.</p>


<h3>Usage</h3>

<pre><code class="language-R">logit.env(X, Y, u, asy = TRUE, init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Predictors. An n by p matrix, p is the number of predictors and n is number of observations.  The predictors must be continuous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response. An n by 1 matrix. The univariate response must be binary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Dimension of the envelope. An integer between 0 and p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy</code></td>
<td>
<p>Flag for computing the asymptotic variance of the envelope estimator.  The default is <code>TRUE</code>. When p and r are large, computing the asymptotic variance can take much time and memory.  If only the envelope estimators are needed, the flag can be set to <code>asy = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>The user-specified value of Gamma for the envelope subspace in logistic regression. An p by u matrix. The default is the one generated by function logit.envMU.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits the envelope model in logistic regression, </p>
<p style="text-align: center;"><code class="reqn">
 Y = exp(\mu + \beta' X) / (1 + exp(\mu + \beta' X)), \Sigma_{X}=\Gamma\Omega\Gamma'+\Gamma_{0}\Omega_{0}\Gamma'_{0}
</code>
</p>

<p>using the maximum likelihood estimation.  When the dimension of the envelope is between 1 and p-1, the starting value and blockwise coordinate descent algorithm in Cook et al. (2016) is implemented.  This model works the best when X is multivariate normal.
</p>


<h3>Value</h3>

<p>The output is a list that contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The envelope estimator of the canonical parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaX</code></td>
<td>
<p>The envelope estimator of the covariance matrix of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>An orthonormal basis of the envelope subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma0</code></td>
<td>
<p>An orthonormal basis of the complement of the envelope subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>The estimated beta of the canonical parameter with respect to Gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>The coordinates of SigmaX with respect to Gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega0</code></td>
<td>
<p>The coordinates of SigmaX with respect to Gamma0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The estimated intercept of the canonical parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The maximized log likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMatrix</code></td>
<td>
<p>The asymptotic covariance of vec(beta). The covariance matrix returned are asymptotic.  For the actual standard errors, multiply by 1 / n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asySE</code></td>
<td>
<p>The asymptotic standard error for elements in beta under the envelope model.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1 / sqrt(n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>The asymptotic standard error ratio of the standard multivariate linear regression estimator over the envelope estimator, for each element in beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations in the data.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cook, R. D., Zhang, X. (2015). Foundations for Envelope Models and Methods. Journal of the American Statistical Association 110, 599 - 611.
</p>
<p>Cook, R. D., Forzani, L. and Su, Z. (2016) A Note on Fast Envelope Estimation. Journal of Multivariate Analysis. 150, 42-54.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(horseshoecrab)
X1 &lt;- as.numeric(horseshoecrab[ , 1] == 2)
X2 &lt;- as.numeric(horseshoecrab[ , 1] == 3)
X3 &lt;- as.numeric(horseshoecrab[ , 1] == 4)
X4 &lt;- as.numeric(horseshoecrab[ , 2] == 2)
X5 &lt;- as.numeric(horseshoecrab[ , 2] == 3)
X6 &lt;- horseshoecrab[ , 3]
X7 &lt;- horseshoecrab[ , 5]
X &lt;- cbind(X1, X2, X3, X4, X5, X6, X7)
Y &lt;- as.numeric(ifelse(horseshoecrab[ , 4] &gt; 0, 1, 0))

## Not run: u &lt;- u.logit.env(X, Y)
## Not run: u

## Not run: m &lt;- logit.env(X, Y, 1)
## Not run: m$beta
</code></pre>


</div>