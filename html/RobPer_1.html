<div class="container">

<table style="width: 100%;"><tr>
<td>RobPer-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The RobPer-package
</h2>

<h3>Description</h3>

<p>Calculates periodograms based on (robustly) fitting periodic functions to light curves and other irregulary observed time series and detects high periodogram bars.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> RobPer</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.2.2</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2016-03-27</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-3 </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Light curves occur in astroparticle physics and are irregularly sampled times series
<code class="reqn">(t_i, y_i)_{i=1,\ldots,n}</code>  or <code class="reqn">(t_i, y_i, s_i)_{i=1,\ldots,n}</code> consisting of unequally 
spaced observation times <code class="reqn">t_1, \ldots, t_n</code>, observed values
<code class="reqn">y_1, \ldots, y_n</code> and possibly measurement accuracies <code class="reqn">s_1, \ldots, s_n</code>.
The pattern of the observation times <code class="reqn">t_i</code> may be periodic with sampling period <code class="reqn">p_s</code>. 
The observed values <code class="reqn">y_i</code> may possibly contain a periodic fluctuation <code class="reqn">y_{f;i}</code> with 
fluctuation period <code class="reqn">p_f</code>.  One is interested in finding <code class="reqn">p_f</code>. The measurement 
accuracies <code class="reqn">s_i</code> give information about how precise the <code class="reqn">y_i</code> were measured. 
They can be interpreted as estimates for the standard deviations of the observed values.
For more details see Thieler et al. (2013) or Thieler, Fried and Rathjens (2016). 
</p>
<p>This package includes three main functions: <code>RobPer</code> calculates the periodogram, possibly taking into account measurement accuracies. With <code>betaCvMfit</code>, outlying periodogram bars (indicating a period) can be detected. This function bases on robustly fitting a distribution using Cram√©r-von-Mises (CvM) distance minimization (see also Clarke, McKinnon and Riley 2012).  The function <code>tsgen</code> can be used to generate artificial light curves. For more details about the implementation see Thieler, Fried and Rathjens (2016).
</p>
<p>A preliminary version of this package is used in Thieler et al. (2013). The <code>FastS</code>-function  
and the <code>FastTau</code>-function
presented here are slightly changed versions of R-Code published in Salibian-Barrera and Yohai (2006)
and Salibian-Barrera, Willems and Zamar (2008).
</p>
<p>The financial support of the DFG (SFB 876 "Providing Information by Resource-Constrained Data Analysis", project C3, and GK 1032 "Statistische Modellbildung") is gratefully acknowledged. We thank the ITMC at TU Dortmund University for providing computer resources on LiDO.
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler, Jonathan Rathjens and Roland Fried, with contributions from Brenton R. Clarke (see  <code>betaCvMfit</code>),  Matias Salibian-Barrera, Gert Willems and Victor Yohai (see <code>FastS</code> and <code>FastTau</code>) and Uwe Ligges (see <code>TK95</code>).
</p>
<p>Maintainer: Jonathan Rathjens &lt;jonathan.rathjens@tu-dortmund.de&gt;
</p>


<h3>References</h3>

<p>Clarke, B. R., McKinnon, P. L. and Riley, G. (2012): A Fast Robust Method for Fitting Gamma Distributions. Statistical Papers, 53 (4), 1001-1014
</p>
<p>Salibian-Barrera, M. and Yohai, V. (2006): A Fast Algorithm for 
S-Regression Estimates. Journal of Computational and Graphical 
Statistics, 15 (2), 414-427 
</p>
<p>Salibian-Barrera, M., Willems, G. and Zamar, R. (2008): The Fast-tau Estimator for Regression. Journal of Computational and Graphical Statistics, 17 (3), 659-682
</p>
<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a disturbed light curve:
set.seed(22)
lightcurve &lt;- tsgen(ttype="sine",ytype="peak" , pf=7, redpart=0.1, s.outlier.fraction=0.1,
    interval=TRUE, npoints=200, ncycles=25, ps=20, SNR=3, alpha=0)

# Plotting the light curve (vertical bars show measurement accuracies)
plot(lightcurve[,1], lightcurve[,2], pch=16, cex=0.5, xlab="t", ylab="y", 
    main="a Light Curve")
rect(lightcurve[,1], lightcurve[,2]+lightcurve[,3], lightcurve[,1], 
    lightcurve[,2]-lightcurve[,3])

# The lightcurve has a period of 7:
plot(lightcurve[,1]%%7, lightcurve[,2], pch=16, cex=0.5, xlab="t", ylab="y",
    main="Phase Diagram of a Light Curve")
rect(lightcurve[,1]%%7, lightcurve[,2]+lightcurve[,3], lightcurve[,1]%%7, 
    lightcurve[,2]-lightcurve[,3])

# Calculate a periodogram of a light curve:
PP &lt;- RobPer(lightcurve, model="splines", regression="huber", weighting=FALSE, 
    var1=FALSE, periods=1:50)

# Searching for extremely high periodogram bars:
betavalues &lt;- betaCvMfit(PP)
crit.val &lt;- qbeta((0.95)^(1/50),shape1=betavalues[1], shape2=betavalues[2])

hist(PP, breaks=20, freq=FALSE, ylim=c(0,100), xlim=c(0,0.08), col=8, main ="")
betafun &lt;- function(x) dbeta(x, shape1=betavalues[1], shape2=betavalues[2])
curve(betafun, add=TRUE, lwd=2)
abline(v=crit.val, lwd=2)

# alternatives for fitting beta distributions:
# method of moments:
par.mom &lt;- betaCvMfit(PP, rob=FALSE, CvM=FALSE)
myf.mom &lt;- function(x) dbeta(x, shape1=par.mom[1], shape2=par.mom[2])
curve(myf.mom, add=TRUE, lwd=2, col="red")
crit.mom &lt;- qbeta((0.95)^(1/50),shape1=par.mom[1], shape2=par.mom[2])
abline(v=crit.mom, lwd=2, col="red")

# robust method of moments
par.rob &lt;- betaCvMfit(PP, rob=TRUE, CvM=FALSE)
myf.rob &lt;- function(x) dbeta(x, shape1=par.rob[1], shape2=par.rob[2])
curve(myf.rob, add=TRUE, lwd=2, col="blue")
crit.rob &lt;- qbeta((0.95)^(1/50),shape1=par.rob[1], shape2=par.rob[2])
abline(v=crit.rob, lwd=2, col="blue")

legend("topright", fill=c("black","red","blue"), 
    legend=c("CvM", "moments", "robust moments"), bg="white")
box()

# Detect fluctuation period:
plot(1:50, PP, xlab="Trial Period", ylab="Periodogram", type="l", 
    main="Periodogram fitting periodic splines using M-regression (Huber function)")
abline(h=crit.val, lwd=2)
text(c(7,14), PP[c(7,14)], c(7,14), adj=1, pos=4)
axis(1, at=7, labels=expression(p[f]==7))

# Comparison with non-robust periodogram
# (see package vignette, section 5.1 for further graphical analysis)
PP2 &lt;- RobPer(lightcurve, model="splines", regression="L2",
    weighting=FALSE, var1=FALSE, periods=1:50)
betavalues2 &lt;- betaCvMfit(PP2)
crit.val2   &lt;- qbeta((0.95)^(1/50),shape1=betavalues2[1], shape2=betavalues2[2])

plot(1:50, PP2, xlab="Trial Period", ylab="Periodogram", type="l", 
    main="Periodogram fitting periodic splines using L2-regression")
abline(h=crit.val2, lwd=2)
</code></pre>


</div>