<div class="container">

<table style="width: 100%;"><tr>
<td>cp_gen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate PARAFAC data sets, optionally with outliers</h2>

<h3>Description</h3>

<p>Generates <code>nsim</code> data sets according to the given parameters.
If <code>eps &gt; 0</code>, the specified fraction of random outliers of the identified by the 
parameter <code>type</code> type are added to the data sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cp_gen(
  I = 20,
  J = 20,
  K = 20,
  nsim = 200,
  nf = 3,
  noise = 0.05,
  noise1 = 0,
  Acol = TRUE,
  Bcol = TRUE,
  Ccol = TRUE,
  congA = 0.5,
  congB = 0.5,
  congC = 0.5,
  eps = 0,
  type = c("none", "bl", "gl", "og"),
  c1 = 10,
  c2 = 0.1,
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>number of variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of occasions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of data sets to generate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>number of PARAFAC components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>level of homoscedastic (HO) noise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise1</code></td>
<td>
<p>level of heteroscedastic (HE) noise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Acol</code></td>
<td>
<p>whether to apply collinearity with factor congA to mode A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bcol</code></td>
<td>
<p>whether to apply collinearity with factor congB to mode B</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ccol</code></td>
<td>
<p>whether to apply collinearity with factor congC to mode C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>congA</code></td>
<td>
<p>collinearity factor for mode A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>congB</code></td>
<td>
<p>collinearity factor for mode B</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>congC</code></td>
<td>
<p>collinearity factor for mode C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>fraction of outliers (percent contamination)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of outliers: one of <code>"none"</code> for no outliers (possible only of <code>eps==0</code>), 
<code>"bl"</code> for bad leverage points, <code>"gl"</code> for good leverage points and
<code>"og"</code> for orthogonal outliers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>parameter for outlier generation (<code>c1=10</code> for <code>type="bl"</code> 
or  <code>type="gl"</code> and <code>c1=1</code> for <code>type="og"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c2</code></td>
<td>
<p>parameter for outlier generation (<code>c2=0.1</code> for <code>type="bl"</code>
or <code>type="og"</code> and <code>c2=0</code> for <code>type="gl"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>whether to issue warnings</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list consisting of the following lists:
</p>

<ul>
<li>
<p> As list of <code>nsim</code> matrices for the mode A
</p>
</li>
<li>
<p> Bs list of <code>nsim</code> matrices for the mode B
</p>
</li>
<li>
<p> Cs list of <code>nsim</code> matrices for the mode C
</p>
</li>
<li>
<p> Xs list of <code>nsim</code> PARAFAC data sets, each with dimension IxJxK
</p>
</li>
<li>
<p> Os list of <code>nsim</code> vectors containing the added outliers (if any)
</p>
</li>
<li>
<p> param list of parameters used for generation of the data sets
</p>
</li>
</ul>
<h3>References</h3>

<p>Todorov, V. and Simonacci, V. and Gallo, M. and Trendafilov, N. (2023). A novel 
estimation procedure for robust CANDECOMP/PARAFAC model fitting. 
<em>Econometrics and Statistics</em>. In press.
</p>
<p>Tomasi, G. and Bro, R., (2006). A comparison of algorithms for fitting the PARAFAC model. 
<em>Computational Statistics &amp; Data Analysis</em> <b>50</b> (7), 1700–1734.
</p>
<p>Faber, N.M. and Bro, R. and Hopke, P.K. (2003). Recent developments in CANDECOMP/PARAFAC algorithms: 
A critical review. <em>Chemometrics and Intelligent Laboratory Systems</em> <b>65</b>, 119–137.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ##  Generate one PARAFAC data set (nsim=1) with R=2 components (nf=2) and dimensions
 ##  50x10x10. Apply 0.15 homoscedastic noise and 0.10 heteroscedastic noise, apply 
 ##  collinearity with congruence factor 0.5 to all modes. Add 20% bad leverage points.

 library(rrcov3way)
 xdat &lt;- cp_gen(I=50, J=100, K=10, nsim=1, nf=2,
     noise=0.15, noise1=0.10, Acol=TRUE, Bcol=TRUE, Ccol=TRUE,
     congA=0.5, congB=0.5, congC=0.5,
     eps=0.2, type="bl")
 names(xdat)
   
</code></pre>


</div>