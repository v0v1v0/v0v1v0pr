<div class="container">

<table style="width: 100%;"><tr>
<td>rankICC3levels</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank ICC with three hierarchies</h2>

<h3>Description</h3>

<p><code>rankICC3levels</code> computes the rank intraclass correlation coefficient (ICC) with three hierarchies. Starting from the innermost level, the three levels are named level 1, level 2, and level 3. The rank ICC at level 2 evaluates the rank correlation between a random pair from the same level-2 unit. The rank ICC at level 3 evaluates the rank correlation between a random pair from the same level-3 unit but different level-2 units.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rankICC3levels(
  x,
  level2,
  level3,
  weights = c("level1", "level2", "level3"),
  conf.int = 0.95,
  fisher = FALSE,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric or factor vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level2</code></td>
<td>
<p>a vector indicating level-2 membership.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level3</code></td>
<td>
<p>a vector indicating level-3 membership.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a character string indicating which weighting method is used. Or an optional vector of user-defined weights to be used. Should be one of the strings <code>"level1"</code>, <code>"level2"</code>, <code>"level3"</code>, or a numeric vector. Default is <code>"level1"</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>numeric specifying confidence interval level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisher</code></td>
<td>
<p>logical, indicating whether to apply Fisher transformation to compute confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>"level1"</code> assigns equal weights to level-1 units; <code class="reqn">p_{ijk}=1/(\sum_{i=1}^n\sum_{j=1}^{n_i}m_{ij})</code>, where <code class="reqn">n</code> is the total number of level-3 units, <code class="reqn">n_i</code> is the number of level-2 units in the <code class="reqn">i</code>th level-3 unit, and <code class="reqn">m_{ij}</code> is the number of level-1 units in the <code class="reqn">j</code>th level-2 unit and the <code class="reqn">i</code>th level-3 unit. <code>"level2"</code> assigns equal weights to level-2 units; <code class="reqn">p_{ijk}=1/(m_{ij}\sum_{i=1}^n n_{i})</code>. <code>"level3"</code> assigns equal weights to level-3 units; <code class="reqn">p_{ijk}=1/(nn_{i}m_{ij})</code>.
</p>


<h3>Value</h3>

<p>a matrix with two rows. The first row is for rank ICC at level 2 and the second row is for rank ICC at level 3. Each row has the following components.
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>rankICC</code> </td>
<td style="text-align: left;"> the rank ICC. </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>SE</code> </td>
<td style="text-align: left;"> the standard error. </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>Lower, Upper</code> </td>
<td style="text-align: left;"> the lower and upper bound of the confidence interval.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Tu, S., Li, C., Zeng, D., and Shepherd, B. E. (2023). Rank intraclass correlation for clustered data. Statistics in Medicine 42, 4333-4348.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k &lt;- 50; m &lt;- 5
sigma.u &lt;- 1; sigma.e &lt;- 2
u &lt;- rnorm(k, 5, sigma.u)
x1 &lt;- matrix(NA, k, m)
for (i in 1:k){
x1[i,] &lt;- u[i] + rnorm(5, 0, sigma.e)
}
x &lt;- as.vector(t(x1))
level2 &lt;- rep(1:k, each=5)
level3 &lt;- round(level2 / 10)
rankICC3levels(x, level2, level3, weights = "level2")
</code></pre>


</div>