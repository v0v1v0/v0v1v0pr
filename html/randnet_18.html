<div class="container">

<table style="width: 100%;"><tr>
<td>nSmooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
estimates probabilty matrix by neighborhood smoothing
</h2>

<h3>Description</h3>

<p>estimates probabilty matrix by neighborhood smoothing of Zhang
et. al. (2017)
</p>


<h3>Usage</h3>

<pre><code class="language-R">nSmooth(A, h = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>

<p>adjacency matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>quantile value used for smoothing. Recommended to be in the scale of
sqrt(log(n)/n) where n is the size of the network. The default value
is sqrt(log(n)/n) from the paper.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method assumes a graphon model where the underlying graphon function
is piecewise Lipchitz. However, it may be slow for moderately large
networks, though it is one of the fastest methods for graphon models.
</p>


<h3>Value</h3>

<p>the probability matrix
</p>


<h3>Author(s)</h3>

<p>Tianxi Li, Elizaveta Levina, Ji Zhu<br></p>
<p>Maintainer: Tianxi Li &lt;tianxili@virginia.edu&gt;
</p>


<h3>References</h3>

<p>Zhang, Y.; Levina, E. &amp; Zhu, J. Estimating network edge probabilities by neighbourhood smoothing Biometrika, Oxford University Press, 2017, 104, 771-783
</p>


<h3>Examples</h3>

<pre><code class="language-R">

N &lt;- 100

U = matrix(1:N,nrow=1) / (N+1)
V = matrix(1:N,nrow=1) / (N+1)

W = (t(U))^2
W = W/3*cos(1/(W + 1e-7)) + 0.15

upper.index &lt;- which(upper.tri(W))

A &lt;- matrix(0,N,N)


rand.ind &lt;- runif(length(upper.index))

edge.index &lt;- upper.index[rand.ind &lt; W[upper.index]]

A[edge.index] &lt;- 1

A &lt;- A + t(A)
diag(A) &lt;- 0

What &lt;- nSmooth(A)


</code></pre>


</div>