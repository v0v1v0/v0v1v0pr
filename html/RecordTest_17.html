<div class="container">

<table style="width: 100%;"><tr>
<td>N.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Number of Records Plot</h2>

<h3>Description</h3>

<p>This function builds a ggplot object to compare the sample
means of the (weighted) number of records in a vector up to time <code class="reqn">t</code>, 
<code class="reqn">\bar N_{t}^\omega</code>, and the expected values 
<code class="reqn">\textrm{E}(N_t^{\omega})</code> 
under the classical record model (i.e., of IID continuous RVs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">N.plot(
  X,
  weights = function(t) 1,
  record = c(FU = 1, FL = 1, BU = 1, BL = 1),
  backward = c("T", "t"),
  point.col = c(FU = "red", FL = "blue", BU = "red", BL = "blue"),
  point.shape = c(FU = 19, FL = 19, BU = 4, BL = 4),
  conf.int = TRUE,
  conf.level = 0.9,
  conf.aes = c("ribbon", "errorbar"),
  conf.col = "grey69"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A function indicating the weight given to the different 
records according to their position in the series,
e.g., if <code>function(t) t-1</code> then <code class="reqn">\omega_t = t-1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>record</code></td>
<td>
<p>Logical vector. Vector with four elements indicating if 
forward upper, forward lower, backward upper and backward lower are going
to be shown, respectively. Logical values or 0,1 values are accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backward</code></td>
<td>
<p>A character string <code>"T"</code> or <code>"t"</code> indicating if 
the backward number of records shown are calculated up to time <code class="reqn">t</code> in 
the backward series <code class="reqn">\{X_T,\ldots,X_1\}</code> or in the series 
<code class="reqn">\{X_t,\ldots,X_1\}</code>. While the first option considers the evolution 
of a series of records observed up to time <code class="reqn">T</code>, the second considers 
that until each time <code class="reqn">t</code> the series has only been observed up to 
<code class="reqn">t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.col, point.shape</code></td>
<td>
<p>Vector with four elements indicating the colour
and shape of the points. Every one of the four elements represents forward
upper, forward lower, backward upper and backward lower, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>Logical. Indicates if the RIs are also shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>(If <code>conf.int == TRUE</code>) Confidence level of the RIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.aes</code></td>
<td>
<p>(If <code>conf.int == TRUE</code>) A character string indicating 
the aesthetic to display for the RIs, <code>"ribbon"</code> (grey area) or 
<code>"errorbar"</code> (vertical lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.col</code></td>
<td>
<p>Colour used to plot the expected value and (if 
<code>conf.int == TRUE</code>) RIs.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This plot is associated to the test <code>N.test</code>.
It calculates the sample means of the number of records in a set of
vectors up to every time <code class="reqn">t</code> (see <code>Nmean.record</code>). 
These sample means <code class="reqn">\bar N_{t}^\omega</code> are calculated from the sample of
<code class="reqn">M</code> values obtained from <code class="reqn">M</code> vectors, the columns of matrix 
<code>X</code>. Then, these values are plotted and compared with the expected 
values <code class="reqn">\textrm{E}(N_t^{\omega})</code> and their reference intervals (RIs), under
the hypothesis of the classical record model. The RIs of 
<code class="reqn">\bar N_{t}^\omega</code> uses the fact that, under the classical record 
model, the statistic is asymptotically Normal.
</p>
<p>The plot can show the four types of record at the same time (i.e., 
forward upper, forward lower, backward upper and backward lower).
In their interpretations one must be careful, for forward records 
each time <code class="reqn">t</code> corresponds to the same year of observation, but for 
the backward series, time <code class="reqn">t</code> corresponds to the year of observation
<code class="reqn">T-t+1</code> where <code class="reqn">T</code> is the total number of observations in every 
series. Two types of backward records can be considered (see argument
<code>backward</code>).
</p>
<p>More details of this plot are shown in Cebrián, Castillo-Mateo, Asín 
(2022).
</p>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2): 313-330. 
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>


<h3>See Also</h3>

<p><code>N.record</code>, <code>N.test</code>, 
<code>foster.test</code>, <code>foster.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Plot at Zaragoza, with linear weights and error bar as RIs aesthetic
N.plot(ZaragozaSeries, weights = function(t) t-1, conf.aes = "errorbar")

# Plot only upper records
N.plot(ZaragozaSeries, record = c(1, 0, 1, 0))

# Change point colour and shape
Zplot &lt;- N.plot(ZaragozaSeries, 
  point.col = c("red", "red", "blue", "blue"), 
  point.shape = c(19, 4, 19, 4))

## Not run: Load package ggplot2 to change the plot
#library("ggplot2")
## Remove legend
#Zplot + ggplot2::theme(legend.position = "none")
## Fancy axis
# Zplot + 
#   ggplot2::scale_x_continuous(name = "Year (forward)",
#     breaks = c(10, 30, 50, 70), 
#     labels=c("1960", "1980", "2000", "2020"), 
#     sec.axis = ggplot2::sec_axis(~ 2021 - ., name = "Year (backward)",
#                                  breaks = 1950 + c(10, 30, 50, 70))) +
#   ggplot2::theme(axis.title.x = ggplot2::element_text(colour = "red"), 
#     axis.text.x = ggplot2::element_text(colour = "red"),
#     axis.title.x.top = ggplot2::element_text(colour = "blue"), 
#     axis.text.x.top = ggplot2::element_text(colour = "blue"))
</code></pre>


</div>