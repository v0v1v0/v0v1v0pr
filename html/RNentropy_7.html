<div class="container">

<table style="width: 100%;"><tr>
<td>RN_calc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

RN_calc
</h2>

<h3>Description</h3>


<p>Computes both global and local p-values, and returns the results in a list containing for each gene the original expression values and the associated global and local p-values (as  -log10(p-value)).
</p>


<h3>Usage</h3>

<pre><code class="language-R">RN_calc(X, design)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>


<p>data.frame with expression values. It may contain additional non numeric columns (eg. a column with gene names).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>


<p>The RxC design matrix where R (rows) corresponds to the number of numeric columns (samples) in 'file' and C (columns) to the number of conditions. It must be a binary matrix with one and only one '1' for every row, corresponding to the condition (column) for which the sample corresponding to the row has to be considered a biological ot technical replicate. See the example 'RN_Brain_Example_design' for the design matrix of 'RN_Brain_Example_tpm' which has three replicates for three conditions (three rows) for a total of nine samples (nine rows). design defaults to a square matrix of independent samples (diagonal = 1, everything else = 0)
</p>
</td>
</tr>
</table>
<h3>Value</h3>






<table>
<tr style="vertical-align: top;">
<td><code>gpv</code></td>
<td>
<p>-log10 of the global p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpv</code></td>
<td>
<p>-log10 of the local p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_like</code></td>
<td>
<p>results formatted as in the output of the C++ implementation of RNentropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>The results data.frame with the original expression values and the associated -log10 of global and local p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>the experimental design matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>


<p>Giulio Pavesi - Dep. of Biosciences, University of Milan
</p>
<p>Federico Zambelli - Dep. of Biosciences, University of Milan
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("RN_Brain_Example_tpm", "RN_Brain_Example_design")
#compute statistics and p-values (considering only a subset of genes due to
#examples running time limit of CRAN)
Results &lt;- RN_calc(RN_Brain_Example_tpm[1:10000,], RN_Brain_Example_design)

## The function is currently defined as

function(X, design = NULL)
{
  if(is.null(design))
  {
    design &lt;- .RN_default_design(sum(sapply(X, is.numeric)))
  }
  
	Results &lt;- list(expr = X, design = design)

	GPV &lt;- RN_calc_GPV(X, bind = FALSE)
	LPV &lt;- RN_calc_LPV(X, design = design, bind = FALSE)	

	TABLE = cbind(X,'---',GPV,'---',LPV)	

	Results$gpv &lt;- GPV
	Results$lpv &lt;- LPV
	Results$c_like &lt;- TABLE
	Results$res &lt;- cbind(X, GPV, LPV)
	
	return(Results)
}
</code></pre>


</div>