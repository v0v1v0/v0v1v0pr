<div class="container">

<table style="width: 100%;"><tr>
<td>RushWorker</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rush Worker</h2>

<h3>Description</h3>

<p>RushWorker evaluates tasks and writes results to the data base.
The worker inherits from Rush.
</p>


<h3>Value</h3>

<p>Object of class R6::R6Class and <code>RushWorker</code> with worker methods.
</p>


<h3>Super class</h3>

<p><code>rush::Rush</code> -&gt; <code>RushWorker</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>worker_id</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
Identifier of the worker.</p>
</dd>
<dt><code>remote</code></dt>
<dd>
<p>(<code>logical(1)</code>)<br>
Whether the worker is on a remote machine.</p>
</dd>
<dt><code>heartbeat</code></dt>
<dd>
<p>('r_process“)<br>
Background process for the heartbeat.</p>
</dd>
</dl>
</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>terminated</code></dt>
<dd>
<p>(<code>logical(1)</code>)<br>
Whether to shutdown the worker.
Used in the worker loop to determine whether to continue.</p>
</dd>
<dt><code>terminated_on_idle</code></dt>
<dd>
<p>(<code>logical(1)</code>)<br>
Whether to shutdown the worker if no tasks are queued.
Used in the worker loop to determine whether to continue.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-RushWorker-new"><code>RushWorker$new()</code></a>
</p>
</li>
<li> <p><a href="#method-RushWorker-push_running_tasks"><code>RushWorker$push_running_tasks()</code></a>
</p>
</li>
<li> <p><a href="#method-RushWorker-pop_task"><code>RushWorker$pop_task()</code></a>
</p>
</li>
<li> <p><a href="#method-RushWorker-push_results"><code>RushWorker$push_results()</code></a>
</p>
</li>
<li> <p><a href="#method-RushWorker-set_terminated"><code>RushWorker$set_terminated()</code></a>
</p>
</li>
<li> <p><a href="#method-RushWorker-clone"><code>RushWorker$clone()</code></a>
</p>
</li>
</ul>
<details><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="create_worker_script"><a href="../../rush/html/Rush.html#method-Rush-create_worker_script"><code>rush::Rush$create_worker_script()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="detect_lost_workers"><a href="../../rush/html/Rush.html#method-Rush-detect_lost_workers"><code>rush::Rush$detect_lost_workers()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="fetch_failed_tasks"><a href="../../rush/html/Rush.html#method-Rush-fetch_failed_tasks"><code>rush::Rush$fetch_failed_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="fetch_finished_tasks"><a href="../../rush/html/Rush.html#method-Rush-fetch_finished_tasks"><code>rush::Rush$fetch_finished_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="fetch_new_tasks"><a href="../../rush/html/Rush.html#method-Rush-fetch_new_tasks"><code>rush::Rush$fetch_new_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="fetch_priority_tasks"><a href="../../rush/html/Rush.html#method-Rush-fetch_priority_tasks"><code>rush::Rush$fetch_priority_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="fetch_queued_tasks"><a href="../../rush/html/Rush.html#method-Rush-fetch_queued_tasks"><code>rush::Rush$fetch_queued_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="fetch_running_tasks"><a href="../../rush/html/Rush.html#method-Rush-fetch_running_tasks"><code>rush::Rush$fetch_running_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="fetch_tasks"><a href="../../rush/html/Rush.html#method-Rush-fetch_tasks"><code>rush::Rush$fetch_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="fetch_tasks_with_state"><a href="../../rush/html/Rush.html#method-Rush-fetch_tasks_with_state"><code>rush::Rush$fetch_tasks_with_state()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="format"><a href="../../rush/html/Rush.html#method-Rush-format"><code>rush::Rush$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="is_failed_task"><a href="../../rush/html/Rush.html#method-Rush-is_failed_task"><code>rush::Rush$is_failed_task()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="is_running_task"><a href="../../rush/html/Rush.html#method-Rush-is_running_task"><code>rush::Rush$is_running_task()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="print"><a href="../../rush/html/Rush.html#method-Rush-print"><code>rush::Rush$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="print_log"><a href="../../rush/html/Rush.html#method-Rush-print_log"><code>rush::Rush$print_log()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="push_failed"><a href="../../rush/html/Rush.html#method-Rush-push_failed"><code>rush::Rush$push_failed()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="push_priority_tasks"><a href="../../rush/html/Rush.html#method-Rush-push_priority_tasks"><code>rush::Rush$push_priority_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="push_tasks"><a href="../../rush/html/Rush.html#method-Rush-push_tasks"><code>rush::Rush$push_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="read_hash"><a href="../../rush/html/Rush.html#method-Rush-read_hash"><code>rush::Rush$read_hash()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="read_hashes"><a href="../../rush/html/Rush.html#method-Rush-read_hashes"><code>rush::Rush$read_hashes()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="read_log"><a href="../../rush/html/Rush.html#method-Rush-read_log"><code>rush::Rush$read_log()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="reset"><a href="../../rush/html/Rush.html#method-Rush-reset"><code>rush::Rush$reset()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="restart_local_workers"><a href="../../rush/html/Rush.html#method-Rush-restart_local_workers"><code>rush::Rush$restart_local_workers()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="retry_tasks"><a href="../../rush/html/Rush.html#method-Rush-retry_tasks"><code>rush::Rush$retry_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="start_local_workers"><a href="../../rush/html/Rush.html#method-Rush-start_local_workers"><code>rush::Rush$start_local_workers()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="start_remote_workers"><a href="../../rush/html/Rush.html#method-Rush-start_remote_workers"><code>rush::Rush$start_remote_workers()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="stop_workers"><a href="../../rush/html/Rush.html#method-Rush-stop_workers"><code>rush::Rush$stop_workers()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="tasks_with_state"><a href="../../rush/html/Rush.html#method-Rush-tasks_with_state"><code>rush::Rush$tasks_with_state()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="wait_for_finished_tasks"><a href="../../rush/html/Rush.html#method-Rush-wait_for_finished_tasks"><code>rush::Rush$wait_for_finished_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="wait_for_new_tasks"><a href="../../rush/html/Rush.html#method-Rush-wait_for_new_tasks"><code>rush::Rush$wait_for_new_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="wait_for_tasks"><a href="../../rush/html/Rush.html#method-Rush-wait_for_tasks"><code>rush::Rush$wait_for_tasks()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="wait_for_workers"><a href="../../rush/html/Rush.html#method-Rush-wait_for_workers"><code>rush::Rush$wait_for_workers()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rush" data-topic="Rush" data-id="write_hashes"><a href="../../rush/html/Rush.html#method-Rush-write_hashes"><code>rush::Rush$write_hashes()</code></a></span></li>
</ul></details><hr>
<a id="method-RushWorker-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Creates a new instance of this R6 class.
</p>


<h5>Usage</h5>

<div class="r"><pre>RushWorker$new(
  network_id,
  config = NULL,
  remote,
  worker_id = NULL,
  heartbeat_period = NULL,
  heartbeat_expire = NULL,
  lgr_thresholds = NULL,
  lgr_buffer_size = 0,
  seed = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>network_id</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
Identifier of the rush network.
Controller and workers must have the same instance id.
Keys in Redis are prefixed with the instance id.</p>
</dd>
<dt><code>config</code></dt>
<dd>
<p>(redux::redis_config)<br>
Redis configuration options.
If <code>NULL</code>, configuration set by <code>rush_plan()</code> is used.
If <code>rush_plan()</code> has not been called, the <code>REDIS_URL</code> environment variable is parsed.
If <code>REDIS_URL</code> is not set, a default configuration is used.
See redux::redis_config for details.</p>
</dd>
<dt><code>remote</code></dt>
<dd>
<p>(<code>logical(1)</code>)<br>
Whether the worker is started on a remote machine.
See Rush for details.</p>
</dd>
<dt><code>worker_id</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
Identifier of the worker.
Keys in redis specific to the worker are prefixed with the worker id.</p>
</dd>
<dt><code>heartbeat_period</code></dt>
<dd>
<p>(<code>integer(1)</code>)<br>
Period of the heartbeat in seconds.</p>
</dd>
<dt><code>heartbeat_expire</code></dt>
<dd>
<p>(<code>integer(1)</code>)<br>
Time to live of the heartbeat in seconds.</p>
</dd>
<dt><code>lgr_thresholds</code></dt>
<dd>
<p>(named <code>character()</code> | named <code>numeric()</code>)<br>
Logger threshold on the workers e.g. <code>c(rush = "debug")</code>.</p>
</dd>
<dt><code>lgr_buffer_size</code></dt>
<dd>
<p>(<code>integer(1)</code>)<br>
By default (<code>lgr_buffer_size = 0</code>), the log messages are directly saved in the Redis data store.
If <code>lgr_buffer_size &gt; 0</code>, the log messages are buffered and saved in the Redis data store when the buffer is full.
This improves the performance of the logging.</p>
</dd>
<dt><code>seed</code></dt>
<dd>
<p>(<code>integer()</code>)<br>
Initial seed for the random number generator.
Either a L'Ecuyer-CMRG seed (<code>integer(7)</code>) or a regular RNG seed (<code>integer(1)</code>).
The later is converted to a L'Ecuyer-CMRG seed.
If <code>NULL</code>, no seed is used for the random number generator.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-RushWorker-push_running_tasks"></a>



<h4>Method <code>push_running_tasks()</code>
</h4>

<p>Push a task to running tasks without queue.
</p>


<h5>Usage</h5>

<div class="r"><pre>RushWorker$push_running_tasks(xss, extra = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>xss</code></dt>
<dd>
<p>(list of named <code>list()</code>)<br>
Lists of arguments for the function e.g. <code style="white-space: pre;">⁠list(list(x1, x2), list(x1, x2)))⁠</code>.</p>
</dd>
<dt><code>extra</code></dt>
<dd>
<p>(<code>list</code>)<br>
List of additional information stored along with the task e.g. <code style="white-space: pre;">⁠list(list(timestamp), list(timestamp)))⁠</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>(<code>character()</code>)<br>
Keys of the tasks.
</p>


<hr>
<a id="method-RushWorker-pop_task"></a>



<h4>Method <code>pop_task()</code>
</h4>

<p>Pop a task from the queue.
Task is moved to the running tasks.
</p>


<h5>Usage</h5>

<div class="r"><pre>RushWorker$pop_task(timeout = 1, fields = "xs")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>timeout</code></dt>
<dd>
<p>(<code>numeric(1)</code>)<br>
Time to wait for task in seconds.</p>
</dd>
<dt><code>fields</code></dt>
<dd>
<p>(<code>character()</code>)<br>
Fields to be returned.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-RushWorker-push_results"></a>



<h4>Method <code>push_results()</code>
</h4>

<p>Pushes results to the data base.
</p>


<h5>Usage</h5>

<div class="r"><pre>RushWorker$push_results(keys, yss, extra = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>keys</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
Keys of the associated tasks.</p>
</dd>
<dt><code>yss</code></dt>
<dd>
<p>(named <code>list()</code>)<br>
List of lists of named results.</p>
</dd>
<dt><code>extra</code></dt>
<dd>
<p>(named <code>list()</code>)<br>
List of lists of additional information stored along with the results.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-RushWorker-set_terminated"></a>



<h4>Method <code>set_terminated()</code>
</h4>

<p>Mark the worker as terminated.
Last step in the worker loop before the worker terminates.
</p>


<h5>Usage</h5>

<div class="r"><pre>RushWorker$set_terminated()</pre></div>


<hr>
<a id="method-RushWorker-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>RushWorker$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Note</h3>

<p>The worker registers itself in the data base of the rush network.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># This example is not executed since Redis must be installed

   config_local = redux::redis_config()
   rush = rsh(network_id = "test_network", config = config_local)

   fun = function(x1, x2, ...) list(y = x1 + x2)
   rush$start_local_workers(fun = fun)

   rush$stop_workers()

</code></pre>


</div>