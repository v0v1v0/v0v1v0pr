<div class="container">

<table style="width: 100%;"><tr>
<td>siena08</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to perform a meta analysis of a collection of Siena fits.
</h2>

<h3>Description</h3>

<p>Estimates a meta analysis based on a collection of Siena fits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">siena08(..., projname = "sienaMeta", bound = 5, alpha = 0.05, maxit=20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>names of <code>sienaFit</code> objects, returned from
<code>siena07</code>.
They will be renamed if entered in format <code>newname=oldname</code>.
It is also allowed to give for ... a list of <code>sienaFit</code>
objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projname</code></td>
<td>

<p>Base name of report file if required
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>

<p>Upper limit of standard error for inclusion in the meta analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>1 minus confidence level of confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>Number of iterations of iterated least squares procedure.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A meta analysis is performed as described
in the Siena manual, section "Meta-analysis of Siena results". This
consists of three parts: an iterated weighted least squares (IWLS)
modification of the method described in the reference below;
maximum likelihood estimates and confidence intervals based on
profile likelihoods under normality assumptions;
and Fisher combinations of left-sided and right-sided <code class="reqn">p</code>-values.
These are produced for all effects separately.
</p>
<p>Note that the corresponding effects must have the same effect name in each
model fit. This implies that at least covariates and behavior variables must
have the same name in each model fit.
</p>


<h3>Value</h3>

<p>An object of class <code>sienaMeta</code>.  There are <code>print</code>,
<code>summary</code> and <code>plot</code> methods for this class.
This object contains at least the following.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>thetadf</code></td>
<td>
<p>Data frame containing the coefficients, standard errors
and score test results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projname</code></td>
<td>
<p>Root name for any output file to be produced by the print method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>
<p>Estimates with standard error above this value were
excluded from the calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Object of class <code>by</code> indicating, for each effect in
the models, whether score test  information was present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>requestedEffects</code></td>
<td>
<p>The <code>requestedEffects</code> component of the first
<code>sienaFit</code> object in ....</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muhat</code></td>
<td>
<p>The vector of IWLS estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.muhat</code></td>
<td>
<p>The vector of standard errors of the IWLS estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The vector of ML estimates <code>mu.ml</code> (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>The vector of standard errors of the ML estimates <code>mu.ml.se</code>
(see below).</p>
</td>
</tr>
</table>
<p>Then for each effect, there is a list with at least the following.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cor.est</code></td>
<td>
<p>Spearman rank correlation coefficient between estimates
and their standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.pval</code></td>
<td>
<p>p-value for above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regfit</code></td>
<td>
<p>Part of the result of the fit of <code>iwlsm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regsummary</code></td>
<td>
<p>The summary of the fit, which includes the
coefficient table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tsq</code></td>
<td>
<p>test statistic for effect zero in every model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pTsq</code></td>
<td>
<p>p-value for above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tratio</code></td>
<td>
<p>test statistics that mean effect is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptratio</code></td>
<td>
<p>p-value for above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qstat</code></td>
<td>
<p>Test statistic for variance of effects is zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pttilde</code></td>
<td>
<p>p-value for above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjplus</code></td>
<td>
<p>Test statistic for at least one theta strictly greater than 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjminus</code></td>
<td>
<p>Test statistic for at least one theta strictly less than 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjplusp</code></td>
<td>
<p>p-value for <code>cjplus</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjminusp</code></td>
<td>
<p>p-value for <code>cjminus</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.ml</code></td>
<td>
<p>ML estimate of population mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.ml.se</code></td>
<td>
<p>standard error of ML estimate of population mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.ml</code></td>
<td>
<p>ML estimate of population standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.confint</code></td>
<td>
<p>confidence interval for population mean
based on profile likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.confint</code></td>
<td>
<p>confidence interval for population standard deviation
based on profile likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>Number of fits on which the meta analysis is based</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjplus</code></td>
<td>
<p>Test statistic for combination of right one-sided
Fisher combination tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjminus</code></td>
<td>
<p>Test statistic for combination of left one-sided
Fisher combination tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjplusp</code></td>
<td>
<p>p-value for <code>cjplus</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjminusp</code></td>
<td>
<p>p-value for <code>cjminus</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoreplus</code></td>
<td>
<p>Test statistic for combination of right one-sided
<code class="reqn">p</code>-values from score tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoreminus</code></td>
<td>
<p>Test statistic for combination of left one-sided
<code class="reqn">p</code>-values from score tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoreplusp</code></td>
<td>
<p>p-value for <code>scoreplus</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoreminusp</code></td>
<td>
<p>p-value for <code>scoreminus</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>Number of fits on which the score test analysis is based</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ruth Ripley, Tom Snijders</p>


<h3>References</h3>

<p>Snijders, T.A.B, and Baerveldt, C. (2003),
A Multilevel Network Study of the Effects of Delinquent Behavior
on Friendship Evolution.
<em>Journal of Mathematical Sociology</em> <b>27</b>, 123â€“151.
</p>
<p>See also the manual (Section 11.2)
and <a href="https://www.stats.ox.ac.uk/~snijders/siena/">https://www.stats.ox.ac.uk/~snijders/siena/</a>
</p>


<h3>See Also</h3>

<p><code>print.sienaMeta</code>, <code>funnelPlot</code>,
<code>meta.table</code>, <code>iwlsm</code>, <code>siena07</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# A meta-analysis for three groups does not make much sense
# for generalizing to a population of networks,
# but the Fisher combinations of p-values are meaningful.
# However, using three groups does show the idea.

Group1 &lt;- sienaDependent(array(c(N3401, HN3401), dim=c(45, 45, 2)))
Group3 &lt;- sienaDependent(array(c(N3403, HN3403), dim=c(37, 37, 2)))
Group4 &lt;- sienaDependent(array(c(N3404, HN3404), dim=c(33, 33, 2)))
dataset.1 &lt;- sienaDataCreate(Friends = Group1)
dataset.3 &lt;- sienaDataCreate(Friends = Group3)
dataset.4 &lt;- sienaDataCreate(Friends = Group4)
OneAlgorithm &lt;- sienaAlgorithmCreate(projname = "SingleGroups", seed=128)
effects.1 &lt;- getEffects(dataset.1)
effects.3 &lt;- getEffects(dataset.3)
effects.4 &lt;- getEffects(dataset.4)
effects.1 &lt;- includeEffects(effects.1, transTrip)
effects.1 &lt;- setEffect(effects.1, transRecTrip, fix=TRUE, test=TRUE)
effects.3 &lt;- includeEffects(effects.3, transTrip)
effects.3 &lt;- setEffect(effects.3, transRecTrip, fix=TRUE, test=TRUE)
effects.4 &lt;- includeEffects(effects.4, transTrip)
effects.4 &lt;- setEffect(effects.4, transRecTrip, fix=TRUE, test=TRUE)
ans.1 &lt;- siena07(OneAlgorithm, data=dataset.1, effects=effects.1, batch=TRUE)
ans.3 &lt;- siena07(OneAlgorithm, data=dataset.3, effects=effects.3, batch=TRUE)
ans.4 &lt;- siena07(OneAlgorithm, data=dataset.4, effects=effects.4, batch=TRUE)
ans.1
ans.3
ans.4
(meta &lt;- siena08(ans.1, ans.3, ans.4))
plot(meta, which=2:3, layout = c(2,1))
# For specifically presenting the Fisher combinations:
# First determine the components of meta with estimated effects:
which.est &lt;- sapply(meta, function(x){ifelse(is.list(x),!is.null(x$cjplus),FALSE)})
Fishers &lt;- t(sapply(1:sum(which.est),
        function(i){c(meta[[i]]$cjplus, meta[[i]]$cjminus,
                        meta[[i]]$cjplusp, meta[[i]]$cjminusp, 2*meta[[i]]$n1 )}))
Fishers &lt;- as.data.frame(Fishers, row.names=names(meta)[which.est])
names(Fishers) &lt;- c('Fplus', 'Fminus', 'pplus', 'pminus', 'df')
Fishers
round(Fishers,4)

## End(Not run)
</code></pre>


</div>