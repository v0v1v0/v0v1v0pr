<div class="container">

<table style="width: 100%;"><tr>
<td>flow_through_line</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the total flow passing through a line</h2>

<h3>Description</h3>

<p><code>flow_through_line()</code> computes the integrated flow passing through a straight line at a right angle.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flow_through_line(
  aem,
  x0,
  y0,
  x1,
  y1,
  flow = c("discharge", "darcy"),
  split = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>aem</code></td>
<td>
<p><code>aem</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>numeric, starting x location of line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>numeric, starting y location of line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>numeric, ending x location of line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1</code></td>
<td>
<p>numeric, ending y location of line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flow</code></td>
<td>
<p>character specifying which flow variable to use. Possible values are <code>discharge</code> (default) and <code>darcy</code>. See <code>flow()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>logical, should the flow be split up into positive and negative flows (<code>TRUE</code>) or should they be summed (<code>FALSE</code>; default)? See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The flow is computed normal to the line and integrated along the line length using <code>stats::integrate()</code>.
The flow value is positive going to the left when looking in the direction of the line (i.e. to the left going from <code>x0-y0</code>
to <code>x1-y1</code>).
</p>
<p>If <code>split = FALSE</code> (the default), a single value is returned which is the sum of the positive and negative flows perpendicular to the line.
If <code>split = TRUE</code>, both the positive and negative component of the total flow through the line are returned.
</p>
<p>If the line corresponds to a line element, the integration might fail. Try to perturbate the line vertices slightly in that case.
</p>


<h3>Value</h3>

<p>If <code>split = FALSE</code>, a single value with the total flow of variable <code>flow</code> passing through the line at a right angle.
If <code>split = TRUE</code> a named vector with the total positive and total negative value of <code>flow</code> passing through the line.
</p>


<h3>See Also</h3>

<p><code>flow()</code>, <code>dirflow()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">rf &lt;- constant(-1000, 0, hc = 10)
uf &lt;- uniformflow(TR = 100, gradient = 0.001, angle = -45)
m &lt;- aem(k = 10, top = 10, base = 0, n = 0.2, rf, uf)

xg &lt;- seq(-500, 500, l=100); yg &lt;- seq(-300, 300, l=100)
contours(m, xg, yg, col='dodgerblue', nlevels=20)

x0 &lt;- -200
y0 &lt;- -50
x1 &lt;- 300
y1 &lt;- 100
lines(matrix(c(x0, y0, x1, y1), ncol = 2, byrow = TRUE))

flow_through_line(m, x0, y0, x1, y1)
flow_through_line(m, x1, y1, x0, y0) # reverse direction of line

w &lt;- well(125, 200, 150)
m &lt;- aem(k = 10, top = 10, base = 0, n = 0.2, rf, uf, w)
contours(m, xg, yg, col='dodgerblue', nlevels=20)
lines(matrix(c(x0, y0, x1, y1), ncol = 2, byrow = TRUE))

flow_through_line(m, x0, y0, x1, y1, flow = 'darcy')
flow_through_line(m, x0, y0, x1, y1, flow = 'darcy', split = TRUE)

</code></pre>


</div>