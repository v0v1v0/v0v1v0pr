<div class="container">

<table style="width: 100%;"><tr>
<td>osv_query</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Query OSV API for individual package vulnerabilities</h2>

<h3>Description</h3>

<p>Will connect to OSV API and query vulnerabilities from the specified packages.
Unlike the other query functions, <code>osv_query</code> will only return content and not
the response object. By default all vulnerabilities are returned for any versions of the package flagged
in OSV. This can be subset manually or via the parameter <code>all_affected</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">osv_query(
  name = NULL,
  version = NULL,
  ecosystem = NULL,
  all_affected = TRUE,
  cache = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Character vector of package names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>Character vector of package versions, <code>NA</code> if ignoring versions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecosystem</code></td>
<td>
<p>Character vector of ecosystem(s) within which the package(s) exist.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_affected</code></td>
<td>
<p>Boolean value, if <code>TRUE</code> return all package results found per vulnerability discovered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache</code></td>
<td>
<p>Boolean value to determine if should use a cached version of the function and API results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any other parameters to pass to nested functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Since the <a href="https://google.github.io/osv.dev/post-v1-query/">query</a> and
<a href="https://google.github.io/osv.dev/post-v1-querybatch/">batchquery</a> API endpoints have different outputs, this
function will align their contents to be a list of vulnerabilities. For 'query' this
meant flattening the returned list once; for 'batchquery' the returned IDs are used to fetch additional
vulnerability information and then flattened to a list.
</p>
<p>If only an <code>ecosystem</code> parameter is provided, all vulnerabilities for that selection
will be downloaded from the OSV database and parsed into a tidied table. Since some
vulnerabilities can exist across ecosystems, <code>all_affected</code> may need to be set to <code>FALSE</code>.
</p>
<p>Since the OSV database is organized by vulnerability, the returned content may have duplicate
package details as the same package, and possibly its version, may occur within several different
reported vulnerabilities. To avoid this behaviour, set the <code>all_affected</code> parameter to <code>FALSE</code>.
</p>
<p>Due to variations in formatting from the OSV API, not all responses have versions associated in
the response but instead use ranges. Filtering currently does not apply to this field and may return
all versions affected within the ranges. If you suspect ranges are used instead of specific version codes,
examine the response object using lower-level functions like <code>osv_query_1()</code>.
</p>
<p>To speed up the process for large ecosystems you can set <code>future::plan()</code>
for parallelization; this will be respected via the <code>furrr</code> package. The default will be to run sequentially.
There are performance impacts to allow for mixed ecosystems to be queried. For packages with many vulnerabilities,
it can be faster to perform those separately so all vulnerabilities can be pulled at once and not individually. Alternative
approaches may be implemented in future versions.
</p>


<h3>Value</h3>

<p>A data.frame with query results parsed.
</p>


<h3>See Also</h3>

<p><a href="https://ossf.github.io/osv-schema/#affectedpackage-field">Ecosystem list</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Single package
pkg_vul &lt;- osv_query('dask', ecosystem = 'PyPI')

# Batch query
name_vec &lt;- c('dask', 'dash')
ecosystem_vec &lt;- rep('PyPI', length(name_vec))
pkg_vul &lt;- osv_query(name_vec, ecosystem = ecosystem_vec)

</code></pre>


</div>