<div class="container">

<table style="width: 100%;"><tr>
<td>msc.depth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check the read depth of assembled minicircles</h2>

<h3>Description</h3>

<p>The msc.depth function allows you to analyze the read depth of assembled minicircles using depth statistics generated by KOMICS. These statistics provide information such as the average, median, minimum, and maximum read depth per site for each minicircle contig. By standardizing the median read depths per minicircle contig to the median genome-wide read depths, you can estimate minicircle copy numbers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msc.depth(depthstats, groups, HCN = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>depthstats</code></td>
<td>
<p>character vector containing the file names of the depth statistics generated by KOMICS. Each file should be in the format "sample_name.depthstats.txt" (e.g., sampleA.depthstats.txt, sampleB.depthstats.txt,...).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a vector specifying the groups (e.g., species) to which the samples belong.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HCN</code></td>
<td>
<p>an optional numeric vector containing haploid copy numbers of the corresponding samples. This argument is set to null by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>
<p>a table that merges the depth statistics of all samples. The table includes the average, median, minimum, and maximum per site read depth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>a plot per sample that visualizes the median read depth distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medianRD</code></td>
<td>
<p>a graph summarizing the median read depth distribution of all samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CN</code></td>
<td>
<p>a graph summarizing the copy number (if HCN is not null) of all samples.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">require(ggpubr)
data(exData)

### run function

depth &lt;- msc.depth(depthstats = system.file("extdata", 
                  exData$depthstats, package = "rKOMICS"), groups = exData$species,
                  HCN = exData$medGWD/2)

### visualize results 
hist(depth$all[,"MEDIAN.DEPTH"], breaks=100, 
    main="Global median depth distribution",xlab = (''))

### alter plot 
annotate_figure(depth$plots$CUM29A1, fig.lab = "CUM29A1", 
               fig.lab.pos = "bottom.right", fig.lab.face = 'italic')

</code></pre>


</div>