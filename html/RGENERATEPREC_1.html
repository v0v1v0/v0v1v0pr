<div class="container">

<table style="width: 100%;"><tr>
<td>CCGamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This function extends <code>continuity_ratio</code> and adds the corresponding gaussian correlation matrix for no-precipitation occurrence.</h2>

<h3>Description</h3>

<p>This function extends <code>continuity_ratio</code> and adds the corresponding gaussian correlation matrix for no-precipitation occurrence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CCGamma(
  data,
  lag = 0,
  p0_v1 = NULL,
  p = NA,
  valmin = 0.5,
  nearPD = (lag &gt;= 0),
  interval = c(-1, 1),
  tolerance = .Machine$double.eps,
  only.matrix = FALSE,
  return.value = NULL,
  null.gcorrelation = 1e-05,
  sample = NULL,
  origin = "1961-1-1",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame or 'zoo'  R object containing daily precipitation time series for several gauges (one gauge time series per column). See <code>continuity_ratio</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>numeric lag (expressed as number of days) used for computation for "cross" continuity ratio and joint probability of prercipitation (no)occurrence. See <code>continuity_ratio</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0_v1</code></td>
<td>
<p>vector for marginal probablities, see <code>omega</code> and <code>omega_inv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>positive integer parameter. Default is <code>NA</code>, otherwise, <code>lag</code> is calculated as the vector <code>0:p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valmin</code></td>
<td>
<p>threshold precipitation value [mm] for wet/dry day indicator. 
If precipitation is lower than <code>valmin</code>, day is considered dry. Default is 0.5 mm. See <code>continuity_ratio</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nearPD</code></td>
<td>
<p>see <code>omega_inv</code>. Default is <code>(lag==0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval, tolerance</code></td>
<td>
<p>see <code>omega_inv</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.matrix</code></td>
<td>
<p>logical value. If <code>TRUE</code> the function returns only the gaussian correlaton matrix. Deafaul is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.value</code></td>
<td>
<p>string. If it is not either <code>NULL</code> (Default) and <code>NA</code>, function returns only the argument indicated by this argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.gcorrelation</code></td>
<td>
<p>numerical value <code>nooccurrence_gcorrelation</code>  under which is considered to be 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>character string indicated if function must be calculated differently for subset of the year, e.g. monthly. Admitted values are <code>NULL</code> (Default), <code>"all"</code> or <code>"monthly"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>character string (yyyy-dd-mm) indicated the date of the first row of <code>"data"</code>. It is used if <code>data</code> and <code>sample</code> are not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional agruments of <code>omega_inv</code> or <code>CCGamma</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object which is a list containing the following fields: 
</p>
<p><code>continuity_ratio</code> : <code>lag</code>-day lagged  continuity ratio, as returned by <code>continuity_ratio</code>; 
</p>
<p><code>occurrence</code>  : joint probability of <code>lag</code>-day lagged precipitation occurrence, as returned by <code>continuity_ratio</code>; 
</p>
<p><code>nooccurrence</code> : joint probability of <code>lag</code>-day lagged no precipitation occurrence, as returned by <code>continuity_ratio</code>;
</p>
<p><code>lag</code> : number of days lagged between the two compared events (see argument <code>lag</code>);
</p>
<p><code>p0_v1</code> : vector of marginal probability of no precipitation occurrence. If <code>lag</code>
is 0, it corresponds to the diagonal of  <code>nooccurrence</code> matrix (see argument <code>p0_v1</code>);
</p>
<p><code>nooccurrence_gcorrelation</code> corresponding gaussian correlation for no precipitation occurrence obtained by applying <code>omega_inv</code> to <code>nooccurrence</code>,
</p>
<p>If the argument <code>only.matrix</code> is <code>TRUE</code>, only <code>nooccurrence_gcorrelation</code> is returned as a matrix. 
In case the argument <code>lag</code> is a vector wirh length more than one, the function returns a list of the above-cited return object for each value of the vector <code>lag</code>.
</p>


<h3>Note</h3>

<p>This functon is useful to generate the serial cross-correlation matrices for no precipitation occurrence for Yule-Walker Equations. In case <code>lag</code> is a vactor, <code>nearPD</code> must be a vector of the same size, 
default is <code>(lag==0)</code>.
</p>
<p>See the R code for major details
</p>


<h3>Author(s)</h3>

<p>Emanuele Cordano
</p>


<h3>References</h3>

<p>D.S. Wilks (1998), Multisite Generalization of a Daily Stochastic Precipitation Generation Model, Journal of Hydrology, Volume 210, Issues 1-4, September 1998, Pages 178-191,
<a href="https://www.sciencedirect.com/science/article/pii/S0022169498001863">https://www.sciencedirect.com/science/article/pii/S0022169498001863</a>
</p>
<p>Muamaraldin Mhanna and Willy Bauwens (2011) A Stochastic Space-Time Model for the Generation of Daily Rainfall in the Gaza Strip, International Journal of Climatology, Volume 32, Issue 7, pages 1098-1112,
doi: <a href="https://doi.org/10.1002/joc.2305">10.1002/joc.2305</a>, <a href="https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305">https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305</a>
</p>


<h3>See Also</h3>

<p><code>continuity_ratio</code>,<code>omega_inv</code>,<code>omega</code>,<code>CCGammaToBlockmatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990
origin &lt;- paste(year_min,1,1,sep="-")

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
station &lt;- names(PRECIPITATION)[!(names(PRECIPITATION) %in% c("day","month","year"))]
prec_mes &lt;- PRECIPITATION[period,station]  

## removing nonworking stations (e.g. time series with NA)
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
		 accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it]))
}

prec_mes &lt;- prec_mes[,accepted]
## the dateset is reduced!!! 
prec_mes &lt;- prec_mes[,1:2]

CCGamma &lt;- CCGamma(data=prec_mes,lag=0,tolerance=0.001,only.matrix=FALSE)

## Not Run in the examples, uncomment to run the following line
 CCGamma &lt;- CCGamma(data=prec_mes,lag=0:2,tolerance=0.001,only.matrix=FALSE)

## Not Run in the examples, uncomment to run the following line
 CCGamma_monthly &lt;- CCGamma(data=prec_mes,lag=0,tolerance=0.001,only.matrix=FALSE,
                     sample="monthly",origin=origin)


</code></pre>


</div>