<div class="container">

<table style="width: 100%;"><tr>
<td>prep1wig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare structure for RSEIS</h2>

<h3>Description</h3>

<p>Takes list of traces and prepares new list
for analysis in RSEIS
</p>


<h3>Usage</h3>

<pre><code class="language-R">prep1wig(wig=vector(), dt=1, sta="STA", comp="CMP",
units="UNITS", starttime=list(yr=0, jd=1,mo=1,dom=1,
hr=1,mi=1,sec=0) )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wig</code></td>
<td>
<p>vector of time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>sample interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sta</code></td>
<td>
<p>character, station name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>character,component name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>character, units of signal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starttime</code></td>
<td>
<p>list(yr=1972, jd=1,mo=1,dom=1,hr=1,mi=1,sec=0)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>prep1wig is offered to reformat a time series
</p>
<p>for input to program swig()
</p>


<h3>Value</h3>

<p>Rsac output list
</p>
<table>
<tr style="vertical-align: top;">
<td><code>amp</code></td>
<td>
<p>amplitude</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>sample rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nzyear</code></td>
<td>
<p>year</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nzhour</code></td>
<td>
<p>hour</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nzmin</code></td>
<td>
<p>minutes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nzsec</code></td>
<td>
<p>seconds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nzmsec</code></td>
<td>
<p>msec</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>sac stuff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>sac stuff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>o</code></td>
<td>
<p>sac stuff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>character, file name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sta</code></td>
<td>
<p>character</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>character</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DATTIM</code></td>
<td>
<p>list of date and time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>character</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees.edu&gt;</p>


<h3>See Also</h3>

<p>swig, prepSEIS</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(sunspots)
AA &lt;- attributes(sunspots)
starttime&lt;-list(yr=AA$tsp[1], jd=1,mo=1,dom=1,hr=0,mi=0,sec=0)
ES &lt;- prep1wig(wig=sunspots, dt=1/12, sta="STA", comp="CMP",
units="UNITS", starttime=starttime     )

EH&lt;-prepSEIS(ES)

STDLAB &lt;- c("DONE",  "zoom out", "refresh", "restore",
 "XTR", "SPEC", "SGRAM" ,"WLET")

######  set SHOWONLY=FALSE for interactive
xx &lt;-  swig( EH, STDLAB = STDLAB, SHOWONLY=0)

####################
####################
####################   example with multiple signals

dt &lt;- 0.001
t &lt;- seq(0, 6, by=0.001)
######    sample rate = 1000 Hz, 0.001 seconds 601 samples

###  set up the fequencies and amplitudes for signals that have 2 frequencies
afreqs1 &lt;- c(50, 40,10, 5 )
amps1 &lt;- c(6, 2,3, 2 )
####
afreqs2 &lt;- c(120,30,20, 30  )
amps2 &lt;- c(10,5, 9, 2 )


 x &lt;- cbind( amps1[1]*sin(2*pi*afreqs1[1]*t) +
amps2[1]* sin(2*pi*afreqs2[1]*t),
amps1[2]*sin(2*pi*afreqs1[2]*t) + amps2[2]* sin(2*pi*afreqs2[2]*t),
amps1[3]*sin(2*pi*afreqs1[3]*t) + amps2[3]* sin(2*pi*afreqs2[3]*t),
amps1[4]*sin(2*pi*afreqs1[4]*t) + amps2[4]* sin(2*pi*afreqs2[4]*t))

d &lt;- dim(x)

########  names of signals
mysta&lt;-c("R1", "R2", "R3", "R4")

MYLIST &lt;- list()
starttime &lt;- list(yr=2008, jd=1,mo=1,dom=1,hr=0,mi=0,sec=0)
############  set up the initial list of wiggles
for(i in 1:d[2])
{

A &lt;- prep1wig(wig =x[,i], sta=mysta[i], dt=dt, comp="DO",
units= "amp", starttime=starttime)

A[[1]]$DATTIM$yr &lt;- 2000
MYLIST &lt;- c(MYLIST, A)

}

###  reorganize into RSEIS format:
PH1 &lt;- prepSEIS(MYLIST)

STDLAB &lt;- c("DONE",  "zoom out", "refresh", "restore",
"XTR", "SPEC", "SGRAM" ,"WLET")

swig(PH1, STDLAB = STDLAB)



</code></pre>


</div>