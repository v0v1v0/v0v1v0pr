<div class="container">

<table style="width: 100%;"><tr>
<td>PostPercentile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Posterior expected percentiles
</h2>

<h3>Description</h3>

<p>Computes posterior expected percentiles for both parametric
and nonparametric models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PostPercentile(object)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>An object of class "rvals"
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>With parameters of interest <code class="reqn">\theta_1,...,\theta_n</code> the rank of 
the ith parameter (when we set the ranking so that the largest <code class="reqn">\theta_i</code>
gets rank 1) is defined as <code class="reqn"> rank(\theta_i) = sum_j(\theta_j \ge \theta_i)</code> 
and the associated percentile is 
<code class="reqn"> perc(\theta_i) = rank(\theta_i)/(n+1).</code> The posterior expected percentile 
for the ith unit (see e.g., Lin et. al. (2006)) is simply
the expected value of <code class="reqn">perc(\theta_i)</code> given the data.
</p>
<p>The function <code>PostPercentile</code> computes an asymptotic version of the 
posterior expected percentile, which is defined as 
</p>
<p style="text-align: center;"><code class="reqn"> P(\theta_i \le \theta|data),</code>
</p>

<p>where <code class="reqn">\theta</code> has the same distribution as <code class="reqn">\theta_i</code> and is 
independent of both <code class="reqn">\theta_i</code> and the data.  
See Henderson and Newton (2014) for additional details.
</p>


<h3>Value</h3>

<p>A vector of estimated posterior expected percentiles.
</p>


<h3>Author(s)</h3>

<p>Nicholas Henderson and Michael Newton
</p>


<h3>References</h3>

<p>Henderson, N.C. and Newton, M.A. (2016). <em>Making the cut: improved ranking and selection
for large-scale inference</em>. J. Royal Statist. Soc. B., 78(4), 781-804.
doi: <a href="https://doi.org/10.1111/rssb.12131">10.1111/rssb.12131</a>
<a href="https://arxiv.org/abs/1312.5776">https://arxiv.org/abs/1312.5776</a>
</p>
<p>Lin, R., Louis, T.A., Paddock, S.M., and Ridgeway, G. (2006). Loss function based
ranking in two-stage, hierarchical models. <em>Bayesian Analysis</em>, <b>1</b>, 
915â€“946.
</p>


<h3>See Also</h3>

<p><code>rvalues</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 3000
theta &lt;- rnorm(n, sd = 3)
ses &lt;- sqrt(rgamma(n, shape = 1, scale = 1))
XX &lt;- theta + ses*rnorm(n)
dd &lt;- cbind(XX,ses)

rv &lt;- rvalues(dd, family = gaussian)

perc &lt;- PostPercentile(rv)
plot(rv$rvalues, perc)
</code></pre>


</div>