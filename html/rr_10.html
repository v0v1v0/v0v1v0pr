<div class="container">

<table style="width: 100%;"><tr>
<td>rrreg.bayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Randomized Response Regression</h2>

<h3>Description</h3>

<p>Function to conduct multivariate regression analyses of survey data with the
randomized response technique using Bayesian MCMC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rrreg.bayes(formula, p, p0, p1, design, data, group.mixed,
formula.mixed = ~1, verbose = FALSE, n.draws = 10000, burnin = 5000, thin =
1, beta.start, beta.mu0, beta.A0, beta.tune, Psi.start, Psi.df, Psi.scale,
Psi.tune)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class "formula": a symbolic description of the
model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The probability of receiving the sensitive question (Mirrored
Question Design, Unrelated Question Design); the probability of answering
truthfully (Forced Response Design); the probability of selecting a red card
from the 'yes' stack (Disguised Response Design).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>The probability of forced 'no' (Forced Response Design).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>The probability of forced 'yes' (Forced Response Design).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>Character indicating the design. Currently only "forced-known"
is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.mixed</code></td>
<td>
<p>A string indicating the variable name of a numerical
group indicator specifying which group each individual belongs to for a
mixed effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.mixed</code></td>
<td>
<p>To specify a mixed effects model, include this formula
object for the group-level fit. ~1 allows intercepts to vary, and including
covariates in the formula allows the slopes to vary also.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value indicating whether model diagnostics are
printed out during fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.draws</code></td>
<td>
<p>Number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The number of initial MCMC iterations that are discarded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The interval of thinning between consecutive retained iterations
(1 for no thinning).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.start</code></td>
<td>
<p>Optional starting values for the sensitive item fit. This
should be a vector of length the number of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.mu0</code></td>
<td>
<p>Optional vector of prior means for the sensitive item fit
parameters, a vector of length the number of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.A0</code></td>
<td>
<p>Optional matrix of prior precisions for the sensitive item
fit parameters, a matrix of dimension the number of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.tune</code></td>
<td>
<p>A required vector of tuning parameters for the Metropolis
algorithm for the sensitive item fit. This must be set and refined by the
user until the acceptance ratios are approximately .4 (reported in the
output).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi.start</code></td>
<td>
<p>Optional starting values for the variance of the random
effects in the mixed effects models. This should be a scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi.df</code></td>
<td>
<p>Optional prior degrees of freedom parameter for the variance
of the random effects in the mixed effects models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi.scale</code></td>
<td>
<p>Optional prior scale parameter for the variance of the
random effects in the mixed effects models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi.tune</code></td>
<td>
<p>A required vector of tuning parameters for the Metropolis
algorithm for variance of the random effects in the mixed effects models.
This must be set and refined by the user until the acceptance ratios are
approximately .4 (reported in the output).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function allows the user to perform regression analysis on data from
the randomized response technique using a Bayesian MCMC algorithm.
</p>
<p>The Metropolis algorithm for the Bayesian MCMC estimators in this function
must be tuned to work correctly. The <code>beta.tune</code> and, for the mixed
effects model <code>Psi.tune</code>, are required, and the values, one for each
estimated parameter, will need to be manipulated. The output of the
<code>rrreg.bayes</code> function displays the acceptance ratios from the
Metropolis algorithm. If these values are far from 0.4, the tuning
parameters should be changed until the ratios approach 0.4.
</p>
<p>Convergence is at times difficult to achieve, so we recommend running
multiple chains from overdispersed starting values by, for example, running
an MLE using the rrreg() function, and then generating a set of
overdispersed starting values using those estimates and their estimated
variance-covariance matrix. An example is provided below for each of the
possible designs. Running <code>summary()</code> after such a procedure will
output the Gelman-Rubin convergence statistics in addition to the estimates.
If the G-R statistics are all below 1.1, the model is said to have
converged.
</p>


<h3>Value</h3>

<p><code>rrreg.bayes</code> returns an object of class "rrreg.bayes".  The
function <code>summary</code> is used to obtain a table of the results.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The coefficients for the sensitive item fit. An object of class
"mcmc" that can be analyzed using the <code>coda</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The
<code>data</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.names</code></td>
<td>
<p>Variable names as defined in the
data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The model matrix of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The
randomized response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>Call of standard design used:
"forced-known", "mirrored", "disguised", or "unrelated-known".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The
<code>p</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>The <code>p0</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>The
<code>p1</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.tune</code></td>
<td>
<p>The <code>beta.tune</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixed</code></td>
<td>
<p>Indicator for whether a mixed effects
model was run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<p>If a mixed-effects model is used, then several additional objects are
included: </p>
<table>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>The coefficients for the group-level fit. An object of
class "mcmc" that can be analyzed using the <code>coda</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The random effects estimates. An object of class "mcmc" that
can be analyzed using the <code>coda</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.names.mixed</code></td>
<td>
<p>Variable names for the predictors for the
second-level model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>The predictors for the second-level model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>A vector of group indicators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi.tune</code></td>
<td>
<p>The <code>Psi.tune</code> argument.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Blair, Graeme, Kosuke Imai and Yang-Yang Zhou. (2014) "Design
and Analysis of the Randomized Response Technique."  <em>Working Paper.</em>
Available at <a href="http://imai.princeton.edu/research/randresp.html">http://imai.princeton.edu/research/randresp.html</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
data(nigeria)
 
## Define design parameters
p &lt;- 2/3  # probability of answering honestly in Forced Response Design
p1 &lt;- 1/6 # probability of forced 'yes'
p0 &lt;- 1/6 # probability of forced 'no'

## run three chains with overdispersed starting values

set.seed(1)

## starting values constructed from MLE model
mle.estimates &lt;- rrreg(rr.q1 ~ cov.asset.index + cov.married + 
                         I(cov.age/10) + I((cov.age/10)^2) + cov.education + cov.female, 
                         data = nigeria, 
                      p = p, p1 = p1, p0 = p0,
                      design = "forced-known")
                      


library(MASS)
draws &lt;- mvrnorm(n = 3, mu = coef(mle.estimates), 
  Sigma = vcov(mle.estimates) * 9)

## run three chains
bayes.1 &lt;- rrreg.bayes(rr.q1 ~ cov.asset.index + cov.married + 
                         I(cov.age/10) + I((cov.age/10)^2) + cov.education + cov.female,   
                      data = nigeria, p = p, p1 = p1, p0 = p0,
                      beta.tune = .0001, beta.start = draws[1,],
                      design = "forced-known")
bayes.2 &lt;- rrreg.bayes(rr.q1 ~ cov.asset.index + cov.married + 
                         I(cov.age/10) + I((cov.age/10)^2) + cov.education + cov.female,   
                      data = nigeria, p = p, p1 = p1, p0 = p0,
                      beta.tune = .0001, beta.start = draws[2,],
                      design = "forced-known")

bayes.3 &lt;- rrreg.bayes(rr.q1 ~ cov.asset.index + cov.married + 
                         I(cov.age/10) + I((cov.age/10)^2) + cov.education + cov.female,   
                      data = nigeria, p = p, p1 = p1, p0 = p0,
                      beta.tune = .0001, beta.start = draws[3,],
                      design = "forced-known")
                      
bayes &lt;- as.list(bayes.1, bayes.2, bayes.3)

summary(bayes)



</code></pre>


</div>