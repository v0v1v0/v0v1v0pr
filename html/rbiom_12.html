<div class="container">

<table style="width: 100%;"><tr>
<td>rarefy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Subset counts so that all samples have the same number of observations.</h2>

<h3>Description</h3>

<p>Subset counts so that all samples have the same number of observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rarefy(biom, depth = NULL, seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>biom</code></td>
<td>
<p>A <code>matrix</code>, <code>simple_triplet_matrix</code>, or <code>BIOM</code> 
object, as returned from read.biom. For matrices, the rows and 
columns are assumed to be the taxa and samples, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>The number of observations to keep, per sample. If set to
<code>NULL</code>, a depth will be automatically selected. Samples that have
fewer than this number of observations will be dropped. If called on
data with non-integer abundances, values will be re-scaled to integers 
between 1 and <code>depth</code> such that they sum to <code>depth</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer to use for seeding the random number generator. If
you need to create different random rarefactions of the same <code>BIOM</code>
object, set this seed value to a different number each time.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>matrix</code>, <code>simple_triplet_matrix</code>, or <code>BIOM</code> 
object, depending on the input object type. The type of object provided
is the same type that is returned. The retained observations are randomly
selected, based on a seed value derived from the <code>BIOM</code> object. 
Therefore, rarefying the same biom to the same depth will always produce
the same resultant rarification.
</p>


<h3>Examples</h3>

<pre><code class="language-R">    library(rbiom)

    infile &lt;- system.file("extdata", "hmp50.bz2", package = "rbiom")
    biom &lt;- read.biom(infile)
    range(slam::col_sums(biom$counts))

    biom &lt;- rarefy(biom, depth=1000)
    range(slam::col_sums(biom$counts))

</code></pre>


</div>