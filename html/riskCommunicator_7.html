<div class="container">

<table style="width: 100%;"><tr>
<td>pointEstimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform g-computation to estimate difference and ratio effects of an exposure</h2>

<h3>Description</h3>

<p>Generate a point estimate of the outcome difference and ratio
using G-computation
</p>


<h3>Usage</h3>

<pre><code class="language-R">pointEstimate(
  data,
  outcome.type = c("binary", "count", "count_nb", "rate", "rate_nb", "continuous"),
  formula = NULL,
  Y = NULL,
  X = NULL,
  Z = NULL,
  subgroup = NULL,
  offset = NULL,
  rate.multiplier = 1,
  exposure.scalar = 1,
  exposure.center = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(Required) A data.frame containing variables for
<code>Y</code>, <code>X</code>, and <code>Z</code> or with variables matching the model
variables specified in a user-supplied formula. Data set should also
contain variables for the optional <code>subgroup</code> and <code>offset</code>, if
they are specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome.type</code></td>
<td>
<p>(Required) Character argument to describe the outcome
type. Acceptable responses, and the corresponding error distribution and
link function used in the <code>glm</code>, include: </p>

<dl>
<dt>binary</dt>
<dd>
<p>(Default) A binomial distribution with link = 'logit' is
used.</p>
</dd> 
<dt>count</dt>
<dd>
<p>A Poisson distribution with link = 'log' is used.</p>
</dd>
<dt>count_nb</dt>
<dd>
<p>A negative binomial model with link = 'log' is used, where the theta 
parameter is estimated internally; ideal for over-dispersed count data.</p>
</dd>
<dt>rate</dt>
<dd>
<p>A Poisson distribution with link = 'log' is used; ideal for 
events/person-time outcomes.</p>
</dd> 
<dt>rate_nb</dt>
<dd>
<p>A negative binomial model with link = 'log' is used, where the theta 
parameter is estimated internally; ideal for over-dispersed events/person-time outcomes.</p>
</dd>
<dt>continuous</dt>
<dd>
<p>A gaussian distribution with link = 'identity' is used.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>(Optional) Default NULL. An object of class "formula" (or one
that can be coerced to that class) which provides the the complete model
formula, similar to the formula for the glm function in R (e.g. 'Y ~ X + Z1
+ Z2 + Z3'). Can be supplied as a character or formula object. If no
formula is provided, Y and X must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>(Optional) Default NULL. Character argument which specifies the
outcome variable. Can optionally provide a formula instead of <code>Y</code> and
<code>X</code> variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>(Optional) Default NULL. Character argument which specifies the
exposure variable (or treatment group assignment), which can be binary,
categorical, or continuous. This variable can be supplied as a factor
variable (for binary or categorical exposures) or a continuous variable.
For binary/categorical exposures, <code>X</code> should be supplied as a factor 
with the lowest level set to the desired referent. Numeric variables are 
accepted, but will be centered (see Note). Character variables are not 
accepted and will throw an error. Can optionally provide a formula
instead of <code>Y</code> and <code>X</code> variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>(Optional) Default NULL. List or single character vector which
specifies the names of covariates or other variables to adjust for in the
<code>glm</code> function. All variables should either be factors, continuous, 
or coded 0/1 (i.e. not character variables). Does not allow interaction terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgroup</code></td>
<td>
<p>(Optional) Default NULL. Character argument that indicates
subgroups for stratified analysis. Effects will be reported for each
category of the subgroup variable. Variable will be automatically converted
to a factor if not already.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>(Optional, only applicable for rate/count outcomes) Default NULL.
Character argument which specifies the variable name to be used as the 
person-time denominator for rate outcomes to be included as an offset in the
Poisson regression model. Numeric variable should be on the linear scale; 
function will take natural log before including in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.multiplier</code></td>
<td>
<p>(Optional, only applicable for rate/count outcomes). 
Default 1. Numeric variable signifying the person-time value to use in 
predictions; the offset variable will be set to this when predicting under 
the counterfactual conditions. This value should be set to the person-time 
denominator desired for the rate difference measure and must be inputted in 
the units of the original offset variable (e.g. if the offset variable is 
in days and the desired rate difference is the rate per 100 person-years, 
rate.multiplier should be inputted as 365.25*100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exposure.scalar</code></td>
<td>
<p>(Optional, only applicable for continuous exposure)
Default 1. Numeric value to scale effects with a continuous exposure. This 
option facilitates reporting effects for an interpretable contrast (i.e. 
magnitude of difference) within the continuous exposure. For example, if 
the continuous exposure is age in years, a multiplier of 10 would result 
in estimates per 10-year increase in age rather than per a 1-year increase 
in age.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exposure.center</code></td>
<td>
<p>(Optional, only applicable for continuous exposure)
Default TRUE. Logical or numeric value to center a continuous exposure. This
option facilitates reporting effects at the mean value of the exposure 
variable, and allows for a mean value to be provided directly to the function
in cases where bootstrap resampling is being conducted and a standardized 
centering value should be used across all bootstraps. See note below on 
continuous exposure variables for additional details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>pointEstimate</code> function executes the following steps on
the data: 
</p>
 
<ol>
<li>
<p> Fit a regression of the outcome on the exposure
and relevant covariates, using the provided data set. 
</p>
</li>
<li>
<p> Using the model fit in step 1, predict counterfactuals (e.g. 
calculate predicted outcomes for each observation in the data set under 
each level of the treatment/exposure). 
</p>
</li>
<li>
<p> Estimate the marginal difference/ratio of treatment effect by 
taking the difference or ratio of the average of all observations under 
the treatment/no treatment regimes. 
</p>
</li>
</ol>
<p>As counterfactual predictions are generated with random sampling of the
distribution, users should set a seed (<code>set.seed</code>) prior to 
calling the function for reproducible confidence intervals.
</p>


<h3>Value</h3>

<p>A named list containing the following: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$parameter.estimates</code></td>
<td>
<p>Point estimates for the risk difference, risk
ratio, odds ratio, incidence rate difference, incidence rate ratio, mean
difference and/or number needed to treat/harm, depending on the outcome.type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$formula</code></td>
<td>
<p>Model formula used to fit the <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$contrast</code></td>
<td>
<p>Contrast levels compared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$Y</code></td>
<td>
<p>The response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$covariates</code></td>
<td>
<p>Covariates used in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$n</code></td>
<td>
<p>Number of observations provided to the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$family</code></td>
<td>
<p>Error distribution used in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$predicted.data</code></td>
<td>
<p>A data.frame with the predicted values for the exposed 
and unexposed counterfactual predictions for each observation in the original 
dataset (on the log scale)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$predicted.outcome</code></td>
<td>
<p>A data.frame with the marginal mean
predicted outcomes for each exposure level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$glm.result</code></td>
<td>
<p>The <code>glm</code> class object returned from the 
fitted regression of the outcome on the exposure and relevant covariates.</p>
</td>
</tr>
</table>
<p>formula = formula,
</p>


<h3>Note</h3>

<p>While offsets are used to account for differences in follow-up time 
between individuals in the <code>glm</code> model, rate differences are 
calculated assuming equivalent follow-up of all individuals (i.e. 
predictions for each exposure are based on all observations having the 
same offset value). The default is 1 (specifying 1 unit of the original 
offset variable) or the user can specify an offset to be used in the 
predictions with the rate.multiplier argument.
</p>
<p>Note that for a protective exposure (risk difference less than 0), the 
'Number needed to treat/harm' is interpreted as the number needed to treat, 
and for a harmful exposure (risk difference greater than 0), it is 
interpreted as the number needed to harm.
</p>
<p>For continuous exposure variables, the default effects are provided 
for a one unit difference in the exposure at the mean value of the exposure 
variable. Because the underlying parametric model for a binary outcome is 
logistic regression, the risks for a continuous exposure will be estimated 
to be linear on the log-odds (logit) scale, such that the odds ratio for 
any one unit increase in the continuous variable is constant. However, 
the risks will not be linear on the linear (risk difference) or log (risk 
ratio) scales, such that these parameters will not be constant across the 
range of the continuous exposure. Users should be aware that the risk 
difference, risk ratio, number needed to treat/harm (for a binary outcome) 
and the incidence rate difference (for a rate/count outcome) reported with 
a continuous exposure apply specifically at the mean of the continuous 
exposure. The effects do not necessarily apply across the entire range of 
the variable. However, variations in the effect are likely small, 
especially near the mean.
</p>
<p>@note       
Interaction terms are not allowed in the model formula. The <code>subgroup</code> 
argument affords interaction between the exposure variable and a single 
covariate (that is forced to categorical if supplied as numeric) to 
estimate effects of the exposure within subgroups defined by the 
interacting covariate. To include additional interaction terms with 
variables other than the exposure, we recommend that users create the 
interaction term as a cross-product of the two interaction variables in  
a data cleaning step prior to running the model.
</p>
<p>@note 
For negative binomial models, <code>MASS::glm.nb</code> is used instead of the
standard <code>stats::glm</code> function used for all other models.
</p>


<h3>References</h3>

<p>Ahern J, Hubbard A, Galea S. Estimating the effects of potential public health 
interventions on population disease burden: a step-by-step illustration of 
causal inference methods. Am. J. Epidemiol. 2009;169(9):1140–1147.
<a href="https://doi.org/10.1093/aje/kwp015">doi:10.1093/aje/kwp015</a>
</p>
<p>Altman DG, Deeks JJ, Sackett DL. Odds ratios should be avoided when events 
are common. BMJ. 1998;317(7168):1318. <a href="https://doi.org/10.1136/bmj.317.7168.1318">doi:10.1136/bmj.317.7168.1318</a>
</p>
<p>Hernán MA, Robins JM (2020). Causal Inference: What If. Boca Raton: 
Chapman &amp; Hall/CRC. <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">Book link</a>
</p>
<p>Robins J. A new approach to causal inference in mortality studies with a 
sustained exposure period—application to control of the healthy worker 
survivor effect. Mathematical Modelling. 1986;7(9):1393–1512. <a href="https://doi.org/10.1016/0270-0255%2886%2990088-6">doi:10.1016/0270-0255(86)90088-6</a>
</p>
<p>Snowden JM, Rose S, Mortimer KM. Implementation of G-computation on a 
simulated data set: demonstration of a causal inference technique. 
Am. J. Epidemiol. 2011;173(7):731–738. <a href="https://doi.org/10.1093/aje/kwq472">doi:10.1093/aje/kwq472</a>
</p>
<p>Westreich D, Cole SR, Young JG, et al. The parametric g-formula to 
estimate the effect of highly active antiretroviral therapy on incident 
AIDS or death. Stat Med. 2012;31(18):2000–2009. <a href="https://doi.org/10.1002/sim.5316">doi:10.1002/sim.5316</a>
</p>


<h3>See Also</h3>

<p><code>gComp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Obtain the risk difference and risk ratio for cardiovascular disease or death
## between patients with and without diabetes, while controlling for
## age,
## sex,
## BMI,
## whether the individual is currently a smoker, and
## if they have a history of hypertension.
data(cvdd)
ptEstimate &lt;- pointEstimate(data = cvdd, Y = "cvd_dth", X = "DIABETES",
Z = c("AGE", "SEX", "BMI", "CURSMOKE", "PREVHYP"), outcome.type = "binary")

</code></pre>


</div>