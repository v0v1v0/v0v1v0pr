<div class="container">

<table style="width: 100%;"><tr>
<td>sensitivity.analysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sensitivity analysis of basic reproduction ratio to begin/end dates</h2>

<h3>Description</h3>

<p>Sensitivity analysis of reproduction ratio using supported estimation methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sensitivity.analysis(
  incid,
  GT = NULL,
  begin = NULL,
  end = NULL,
  est.method = NULL,
  sa.type,
  res = NULL,
  GT.type = NULL,
  GT.mean.range = NULL,
  GT.sd.range = NULL,
  t = NULL,
  date.first.obs = NULL,
  time.step = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>incid</code></td>
<td>
<p>A vector of incident cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT</code></td>
<td>
<p>Generation time distribution from <code>generation.time()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>Vector of begin dates for the estimation of epidemic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>Vector of end dates for estimation of the epidemic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.method</code></td>
<td>
<p>Estimation method used for sensitivity analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sa.type</code></td>
<td>
<p>String argument to choose between <code>time</code> and <code>GT</code> sensitivity analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>If specified, will extract most of data from a <code>R0.R</code>-class result already generated by <code>estimate.R()</code> and run sensitivity analysis on it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT.type</code></td>
<td>
<p>Type of distribution for GT (see GT.R for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT.mean.range</code></td>
<td>
<p>Range of mean values used for all GT distributions throughout the simulation. Must be provided as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT.sd.range</code></td>
<td>
<p>Range of standard deviation values used for GT distributions. Must be provided as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Dates vector to be passed to estimation function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.first.obs</code></td>
<td>
<p>Optional date of first observation, if t not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to inner functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a generic call function to use either sa.time or sa.GT.
Argument must be chosen accordingly to <code>sa.type</code>. Please refer to <code>sa.time()</code>
and <code>sa.GT()</code> for further details about arguments.
</p>
<p><code>begin</code> and <code>end</code> vectors must have the same length for the sensitivity
analysis to run. They can be provided either as dates or numeric values,
depending on the other parameters (see <code>check.incid()</code>. If some <code>begin</code> or <code>end</code>
dates overlap, they are ignored and corresponding uncomputed data are set to <code>NA</code>.
Also, note that unreliable Rsquared values are achieved for very small time
periods (begin ~ end). These values are not representative of the epidemic
outbreak behaviour.
</p>


<h3>Value</h3>

<p>A sensitivity analysis object of class <code>R0.S</code> with components depending on sensitivity analysis <code>sa.type</code>.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Loading package
library(R0)

## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
## outbreak during 1918 influenza pandemic in Germany)
data(Germany.1918)

## For this exemple, we use the exact same call as for the internal sensitivity analysis function

## sa.type = "GT"

## Here we will test GT with means of 1 to 5, each time with SD constant (1)
## GT and SD can be either fixed value or vectors of values
## Actual value in simulations may differ, as they are adapted according to the distribution type
tmp &lt;- sensitivity.analysis(
     sa.type     = "GT", 
     incid       = Germany.1918, 
     GT.type     = "gamma", 
     GT.mean     = seq(1,5,1), 
     GT.sd.range = 1, 
     begin       = 1, 
     end         = 27, 
     est.method  = "EG")

## Results are stored in a matrix, each line dedicated to a (mean,sd) couple
plot(
     x    = tmp[,"GT.Mean"], 
     xlab = "mean GT (days)", 
     y    = tmp[,"R"], 
     ylim = c(1.2, 2.1), 
     ylab = "R0 (95% CI)", 
     type = "p", 
     pch  = 19, 
     col  = "black", 
     main = "Sensitivity of R0 to mean GT"
)
arrows(
     x0 = as.numeric(tmp[,"GT.Mean"]), 
     y0 = as.numeric(tmp[,"CI.lower"]), 
     y1 = as.numeric(tmp[,"CI.upper"]), 
     angle = 90, 
     code = 3, 
     col = "black", 
     length = 0.05
)
## One could tweak this example to change sorting of values (per mean, or per standard deviation)
## eg: 'x=tmp[,c('GT.Mean')]' could become 'x=tmp[,c('GT.SD')]'


## sa.type="time"

mGT &lt;- generation.time("gamma", c(2.6,1))
sen &lt;- sensitivity.analysis(
     sa.type    = "time", 
     incid      = Germany.1918, 
     GT         = mGT, 
     begin      = 1:10, 
     end        = 16:25, 
     est.method = "EG"
)
# ...
# Warning message:
# If 'begin' and 'end' overlap, cases where begin &gt;= end are skipped.
# These cases often return Rsquared = 1 and are thus ignored.
## A list with different estimates of reproduction ratio, exponential growth rate and 95%CI 
## wtih different pairs of begin and end dates in form of data frame is returned.
## If method is "EG", results will include growth rate and deviance R-squared measure
## Else, if "ML" method is used, growth rate and R-squared will be set as NA

## Interesting results include the variation of R0 given specific begin/end dates.
## Such results can be plot as a colored matrix and display Rsquared=f(time period)
plot(sen, what=c("criterion","heatmap"))
## Returns complete data.frame of best R0 value for each time period 
## (allows for quick visualization)
## The "best.fit" is the time period over which the estimate is the more robust

# $best.fit
#    Time.period Begin.dates  End.dates       R Growth.rate  Rsquared CI.lower. CI.upper.
# 92          15  1970-01-08 1970-01-23 1.64098   0.1478316 0.9752564  1.574953  1.710209
</code></pre>


</div>