<div class="container">

<table style="width: 100%;"><tr>
<td>tune.rrmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reduced-rank mixture models with optimal tuning parameter(s)</h2>

<h3>Description</h3>

<p>Reduced-rank mixture models with optimal tuning parameter(s)
</p>


<h3>Usage</h3>

<pre><code class="language-R">tune.rrmix(K = NULL, K.max = NULL, X, Y, est = c("FR", "RP", "ANNP"),
           lambda = NULL, n.lambda = 20, gamma = 2,
           ind0 = NULL, para0 = NULL, seed = NULL, kmscale = FALSE, km.nstart = 20,
           n.init = 100, commonvar = FALSE, maxiter = 1000, maxiter.int = 100,
           thres = 1e-05, thres.int = 1e-05, 
           para.true = NULL, ind.true = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of mixture components. Required when K.max is ‘NULL’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.max</code></td>
<td>
<p>maximum of mixture components. Default is ‘NULL’. When provided,
the argument K is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>n by p design matrix where n is the number of observations and
p is the number of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>n by q response matrix where n is the number of observations and
q is the number of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>character, specifying the estimation method. ‘FR’, ‘RP’, and ‘ANNP’
refers to as the full-ranked, rank-penalized, and adaptive nuclear norm
penalized method, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>vector consisting of lambda candidates. Only used in the
estimation method of ‘RP’ and ‘ANNP’. If 0, all estimation methods (‘FR’,
‘RP’, and ‘ANNP’) provide the same estimation results. Default is 'NULL'.
If 'NULL', data-adaptive range of lambda will be provided internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.lambda</code></td>
<td>
<p>number of lambda candidates to explore. Only used when
'lambda' is 'NULL'. Default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>numerical value, specifying additional tuning parameter, only
used in the estimation method of ‘ANNP’. It must be nonnegative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind0</code></td>
<td>
<p>vector of length n, specifying the initial assignment of the
mixture membership of n observations when there is prior information on
the membership. If ‘NULL’, K-means clustering technique is used to assign
the membership for n observations. Default is ‘NULL’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para0</code></td>
<td>
<p>array of length K. It consists of K lists, each of which contains
initial values of membership probability, coefficient matrix, and variance-
covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed number for the reproducibility of results. Default of ‘NULL’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmscale</code></td>
<td>
<p>logical value, indicating whether Y is scaled prior to K-means
clustering for initialization. Default is ‘FALSE’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>km.nstart</code></td>
<td>
<p>number of random sets considered to perform K-means
clustering for initialization. Default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.init</code></td>
<td>
<p>number of initializations to try. Two methods for initial
clustering are used: K-means and random clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>commonvar</code></td>
<td>
<p>logical value, indicating the homogeneity assumption of
variance-covariance matrices across K mixture components. Default is ‘FALSE’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations for external iterative
algorithm, used in all estimation methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter.int</code></td>
<td>
<p>maximum number of iterations for internal iterative
algorithm, only used in the estimation method of ‘ANNP’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>threshold value for external EM algorithm, used in all
estimation methods. It controls the termination of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres.int</code></td>
<td>
<p>threshold value for internal iterative algorithm, only used
in the estimation method of ‘ANNP’. It controls the termination of the
internal algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para.true</code></td>
<td>
<p>array of length K. It consists of K lists, each of which
contains a coefficient matrix and its true rank. Only used when true models
are known, e.g., in a simulation study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.true</code></td>
<td>
<p>vector of length n, specifying the true mixture membership
for n observations. Only used when true models are known, e.g., in a
simulation study.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda.cand</code></td>
<td>
<p>lambda values used as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penloglik</code></td>
<td>
<p>penalized log-likelihood values corresponding to the set
of lambda values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>BIC values corresponding to the set of lambda values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.rank</code></td>
<td>
<p>estimated ranks corresponding to the set of lambda values.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Suyeon Kang, University of California, Riverside, <a href="mailto:skang062@ucr.edu">skang062@ucr.edu</a>;
Weixin Yao, University of California, Riverside, <a href="mailto:weixin.yao@ucr.edu">weixin.yao@ucr.edu</a>;
Kun Chen, University of Connecticut, <a href="mailto:kun.chen@uconn.edu">kun.chen@uconn.edu</a>.
</p>


<h3>References</h3>

<p>Kang, S., Chen, K., and Yao, W. (2022+). "Reduced rank estimation in mixtures
of multivariate linear regression".
</p>


<h3>See Also</h3>

<p><code>rrmix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#-----------------------------------------------------------#
# Real Data Example: Tuna Data
#-----------------------------------------------------------#
require(bayesm)
data(tuna)
tunaY &lt;- log(tuna[, c("MOVE1", "MOVE2", "MOVE3", "MOVE4",
                  "MOVE5", "MOVE6", "MOVE7")])
tunaX &lt;- tuna[, c("NSALE1", "NSALE2", "NSALE3", "NSALE4",
              "NSALE5", "NSALE6", "NSALE7",
              "LPRICE1", "LPRICE2", "LPRICE3", "LPRICE4",
              "LPRICE5", "LPRICE6", "LPRICE7")]
tunaX &lt;- cbind(intercept = 1, tunaX)


tuna.tune &lt;- tune.rrmix(K.max = 3, X = tunaX, Y = tunaY, est = "RP",
             lambda = exp(seq(0, log(100), length = 20)),
             seed = 100, n.init = 100)
summary(tuna.tune)
plot(tuna.tune, transform.y = log, ylab = "log(lambda)") 
</code></pre>


</div>