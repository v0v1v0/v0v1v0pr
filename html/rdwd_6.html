<div class="container">

<table style="width: 100%;"><tr>
<td>createIndex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create file and meta index of the DWD CDC FTP Server</h2>

<h3>Description</h3>

<p>This is mainly an internal function.
Create data.frames out of the vector index returned by <code>indexFTP()</code>.
For <code>fileIndex</code> (the first output element) <code>createIndex</code>
tries to obtain res, var, per, file, id, start and end from the paths.
If <code>meta=TRUE</code>, <code>metaIndex</code> and <code>geoIndex</code> are also
created. They combine all Beschreibung files into a single data.frame.<br>
If you create your own index as suggested in selectDWD (argument <code>findex</code>),
you can read the produced file as shown in the example section.
</p>


<h3>Usage</h3>

<pre><code class="language-R">createIndex(
  paths,
  base = dwdbase,
  dir = "DWDdata",
  fname = "fileIndex.txt",
  meta = FALSE,
  metadir = "meta",
  mname = "metaIndex.txt",
  gname = "geoIndex.txt",
  overwrite = FALSE,
  checkwarn = TRUE,
  checklog = tempfile(),
  quiet = rdwdquiet(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>paths</code></td>
<td>
<p>Char: vector of DWD paths returned by <code>indexFTP()</code> called
with the same <code>base</code> value as this function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>Main directory of DWD ftp server, defaulting to observed climatic records.
DEFAULT: <code>dwdbase</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>Char: writeable directory name where to save the main output(s).
Created if not existent. DEFAULT: "DWDdata" at current <code>getwd()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fname</code></td>
<td>
<p>Char: Name of file in <code>dir</code> in which to write <code>fileIndex</code>.
Use <code>fname=""</code> to suppress writing. DEFAULT: "fileIndex.txt"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta</code></td>
<td>
<p>Logical: should metaIndex also be created from fileIndex?
Uses <code>dataDWD()</code> to download files if not present.
DEFAULT: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadir</code></td>
<td>
<p>Char: Directory (subfolder of <code>dir</code>) where original
description files are downloaded to if meta=TRUE. Passed to
<code>dataDWD()</code>. "" to write in <code>dir</code>. DEFAULT: "meta"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mname</code></td>
<td>
<p>Char: Name of file in <code>dir</code> (not <code>metadir</code>) in which to
write <code>metaIndex</code>.
Use <code>mname=""</code> to suppress writing. DEFAULT: "metaIndex.txt"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gname</code></td>
<td>
<p>Filename for <code>geoIndex</code>. DEFAULT: "geoIndex.txt"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Logical: Overwrite existing <code>fname / mname / gname</code> files?
If not, "_n" is added to the filenames, see
<code>berryFunctions::newFilename()</code>.
DEFAULT: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkwarn</code></td>
<td>
<p>Logical: warn about <code>checkIndex()</code> issues? DEFAULT: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checklog</code></td>
<td>
<p>Logfile for <code>checkIndex()</code>. DEFAULT: <code>tempfile()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Logical: Suppress messages about progress and filenames?
DEFAULT: FALSE through <code>rdwdquiet()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>dataDWD()</code> for the meta part.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>invisible data.frame (or if meta=TRUE, list with two data.frames)
with a number of columns inferred from the paths. Each is also written to disc.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Oct-Nov 2016, June 2017
</p>


<h3>See Also</h3>

<p><code>indexFTP()</code>, <code>updateIndexes()</code>, <code>index</code>, <code>selectDWD()</code>,
<a href="https://bookdown.org/brry/rdwd/fileindex.html">website index chapter</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  # Not tested with R CMD check because of file writing
link &lt;- "daily/kl/historical/tageswerte_KL_00699_19490101_19580630_hist.zip"
ind &lt;- createIndex(link, dir=tempdir())
ind
# res  var        per  id    start          end ismeta
# daily kl historical 699 1949-01-01 1958-06-30 FALSE
link2 &lt;- "daily/kl/historical/KL_Tageswerte_Beschreibung_Stationen.txt"
link3 &lt;- "daily/kl/recent/KL_Tageswerte_Beschreibung_Stationen.txt"
ind2 &lt;- createIndex(c(link,link2,link3), dir=tempdir(), meta=TRUE, checkwarn=FALSE)
lapply(ind2, head)
link4 &lt;- "1_minute/precipitation/meta_data/Meta_Daten_ein_min_rr_00755.zip"
ind &lt;- createIndex(link4, dir=tempdir())
ind

## End(Not run)

</code></pre>


</div>