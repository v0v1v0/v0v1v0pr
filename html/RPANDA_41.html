<div class="container">

<table style="width: 100%;"><tr>
<td>fit_sgd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum likelihood fit of the SGD model
</h2>

<h3>Description</h3>

<p>Fits the SGD model with exponential growth of the metacommunity, by maximum likelihood. Notations follow Manceau et al. (2015)
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_sgd(phylo, tot_time, par, f=1, meth = "Nelder-Mead")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tot_time</code></td>
<td>

<p>the age of the phylogeny (crown age, or stem age if known). If working with crown ages, tot_time is given by max(node.age(phylo)$ages)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>a numeric vector of initial values for the parameters (b,d,nu) to be estimated (these values are used by the optimization algorithm)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>the fraction of extant species included in the phylogeny
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>

<p>optimization to use to maximize the likelihood function, see <em>optim</em> for more details.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the name of the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LH</code></td>
<td>
<p>the maximum log-likelihood value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aicc</code></td>
<td>
<p>the second order Akaike's Information Criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>a numeric vector of estimated values of b (birth), b-d (growth) and nu (mutation)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>While b-d and nu can in general be well estimated, the likelihood surface is quite flat whith respect to b, such that the estimated b can vary a lot depending on the choice of the initial parameter values. Estimates of b should not be trusted.
</p>


<h3>Author(s)</h3>

<p>M Manceau
</p>


<h3>References</h3>

<p>Manceau, M., Lambert, A., Morlon, H. (2015) Phylogenies support out-of-equilibrium models of biodiversity Ecology Letters 18: 347-356
</p>


<h3>See Also</h3>

<p><code>likelihood_sgd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Some examples may take a little bit of time. Be patient!
data(Calomys)
tot_time &lt;- max(node.age(Calomys)$ages)
par_init &lt;- c(1e7, 1e7-0.5, 1)
#fit_sgd(Calomys, tot_time, par_init, f=11/13)
</code></pre>


</div>