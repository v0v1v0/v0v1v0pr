<div class="container">

<table style="width: 100%;"><tr>
<td>mpm_to_table</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a life table from a matrix population model</h2>

<h3>Description</h3>

<p>This function uses age-from-stage decomposition methods to generate a life
table from a matrix population model. A detailed description of these methods
can be found in section 5.3 "Age-specific traits from stage-specific models"
of Caswell (2001).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpm_to_table(
  matU,
  matF = NULL,
  matC = NULL,
  start = 1L,
  xmax = 1000,
  lx_crit = 0.01,
  radix = 1,
  remove_final = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matU</code></td>
<td>
<p>The survival component of a matrix population model (i.e., a
square projection matrix reflecting survival-related transitions; e.g.,
progression, stasis, and/or retrogression). Optionally with named rows and
columns indicating the corresponding life stage names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matF</code></td>
<td>
<p>(Optional) The sexual component of a matrix population model
(i.e., a square projection matrix reflecting transitions due to sexual
reproduction). Optionally with named rows and columns indicating the
corresponding life stage names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matC</code></td>
<td>
<p>(Optional) The clonal component of a matrix population model
(i.e., a square projection matrix reflecting transitions due to clonal
reproduction). Optionally with named rows and columns indicating the
corresponding life stage names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>The index (or stage name) of the first stage at which the author
considers the beginning of life. Defaults to <code>1</code>. Alternately, a
numeric vector giving the starting population vector (in which case
<code>length(start)</code> must match <code>ncol(matU))</code>. See section
<em>Starting from multiple stages</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>Maximum age to which the life table will be calculated (defaults
to <code>1000</code>). Time steps are in the same units as the matrix population
model (see MatrixPeriodicity metadata variable COM(P)ADRE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lx_crit</code></td>
<td>
<p>Minimum value of lx to which age-specific traits will be
calculated (defaults to <code>0.01</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radix</code></td>
<td>
<p>The starting number of individuals in the synthetic life table
(defaults to <code>1</code>). If <code>radix</code> is set to 1, a simplified life
table is produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_final</code></td>
<td>
<p>Life table calculations typically assume that the final
age class is closed and that all individuals die in that age class. This
can mean that mortality/hazard is artificially inflated for this age class.
Users can prevent this by setting 'remove_final' to 'TRUE' (the default is
'FALSE').</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code> containing a variable number columns, depending
on input variables. Columns include:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>age at the start of the age interval <code>[x, x+1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nx</code></td>
<td>
<p>The number of individuals alive at age x. The initial number is
set with <code>radix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dx</code></td>
<td>
<p>proportion of original cohort dying during the age interval
<code>[x, x+1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lx</code></td>
<td>
<p>survivorship, defined as the proportion of initial cohort
surviving to the start of age interval <code>[x, x+1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx</code></td>
<td>
<p>proportion of original cohort dying in the age interval <code>[x,
  x+1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ax</code></td>
<td>
<p>The average time survived within the interval by those that die
during the age interval <code>[x, x+1)</code>. Assumed to be 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hx</code></td>
<td>
<p>force of mortality (hazard) during the age interval <code>[x,
  x+1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qx</code></td>
<td>
<p>probability of death during the interval <code>[x, x+1)</code> for
those entering the interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>px</code></td>
<td>
<p>probability of survival for the interval <code>[x, x+1)</code> for
those entering the interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lx</code></td>
<td>
<p>total person-years lived during the interval <code>[x, x+1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tx</code></td>
<td>
<p>total person years lived beyond age x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>remaining life expectancy at age x</p>
</td>
</tr>
</table>
<p>If <code>matF</code> is provided, also includes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mx</code></td>
<td>
<p>per-capita rate of sexual reproduction during the interval
<code>[x, x+1)</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lxmx</code></td>
<td>
<p>expected number of sexual offspring per original
cohort member produced during the interval <code>[x, x+1)</code></p>
</td>
</tr>
</table>
<p>If <code>matC</code> is provided, also includes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cx</code></td>
<td>
<p>per-capita rate of clonal reproduction  during the interval
<code>[x, x+1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lxcx</code></td>
<td>
<p>expected number of clonal offspring per original
cohort member produced during the interval <code>[x, x+1)</code></p>
</td>
</tr>
</table>
<p>If both <code>matF</code> and <code>matC</code> are provided, also includes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mxcx</code></td>
<td>
<p>per-capita rate of total reproduction (sexual + clonal) during
the interval <code>[x, x+1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lxmxcx</code></td>
<td>
<p>expected number of total offspring (sexual + clonal) per
original cohort member produced during the interval <code>[x, x+1)</code></p>
</td>
</tr>
</table>
<h3>Starting from multiple stages</h3>

<p>Rather than specifying argument
<code>start</code> as a single stage class from which all individuals start life,
it may sometimes be desirable to allow for multiple starting stage classes.
For example, if the user wants to start the calculation of age-specific
traits from reproductive maturity (i.e., first reproduction), the user
should account for the possibility that there may be multiple stage classes
in which an individual could first reproduce.
</p>
<p>To specify multiple starting stage classes, specify argument <code>start</code> as
the desired starting population vector (<strong>n1</strong>), giving the proportion
of individuals starting in each stage class (the length of <code>start</code>
should match the number of columns in the relevant MPM).
</p>
<p>See function <code>mature_distrib</code> for calculating the proportion of
individuals achieving reproductive maturity in each stage class.
</p>


<h3>Note</h3>

<p>The life table is calculated recursively until the age class (x)
reaches <code>xmax</code> or survivorship (lx) falls below <code>lx_crit</code> —
whichever comes first. To force calculation to <code>xmax</code>, set
<code>lx_crit = 0</code>. Conversely, to force calculation to <code>lx_crit</code>, set
<code>xmax = Inf</code>.
</p>
<p>The life table calculations assume that the final age interval is
closed and that all remaining individuals die in this interval. Therefore,
for this interval, the probability of death <code>qx</code> is 1, the probability
of survival <code>px</code> is 0 and, because we assume that deaths are evenly
distributed during the interval, the remaining life expectancy for
individuals at the start of the interval is 0.5. Depending on analyses, it
may be a good idea to remove the final row of the table.
</p>
<p>If <code>lx_crit</code> is sufficiently small that only a very small proportion
of the cohort reach this age (i.e., &lt; 0.05), this should have minimal
impact on results. Nevertheless, for many analyses, the final row of the
life table should be treated with caution and perhaps removed from
subsequent analyses.
</p>
<p>Note that the units of time (e.g.. 'x' and 'ex') in the returned life
table are the same as the projection interval ('ProjectionInterval') of the
MPM.
</p>


<h3>Author(s)</h3>

<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>
<p>Roberto Salguero-Gómez &lt;rob.salguero@zoo.ox.ac.uk&gt;
</p>
<p>Hal Caswell &lt;h.caswell@uva.nl&gt;
</p>


<h3>References</h3>

<p>Caswell, H. 2001. Matrix Population Models: Construction, Analysis, and
Interpretation. Sinauer Associates; 2nd edition. ISBN: 978-0878930968
</p>
<p>Caswell, H. 2006. Applications of Markov chains in demography. pp. 319-334 in
A.N. Langville and W.J. Stewart (editors) MAM2006: Markov Anniversary
Meeting. Boson Books, Raleigh, North Caroline, USA
</p>
<p>Horvitz, C. &amp; Tuljapurkar, S. 2008. Stage dynamics, period survival, and
mortality plateaus. The American Naturalist 172: 203-2015.
&lt;doi:10.1086/589453&gt;
</p>
<p>Jones, O. R., Scheuerlein, A., Salguero-Gomez, R., Camarda, C. G., Schaible,
R., Casper, B. B., Dahlgren, J. P., Ehrlén, J., García, M. B., Menges, E.,
Quintana-Ascencio, P. F., Caswell, H., Baudisch, A. &amp; Vaupel, J. 2014.
Diversity of ageing across the tree of life. Nature 505, 169-173.
&lt;doi:10.1038/nature12789&gt;
</p>
<p>Jones O. R. 2021. Life tables: Construction and interpretation In:
Demographic Methods Across the Tree of Life. Edited by Salguero-Gomez R &amp;
Gamelon M. Oxford University Press. Oxford, UK. ISBN: 9780198838609
</p>
<p>Preston, S., Heuveline, P., &amp; Guillot, M. 2000. Demography: Measuring and
Modeling Population Processes. Wiley. ISBN: 9781557864512
</p>


<h3>See Also</h3>

<p>Other life tables: 
<code>age_from_stage</code>,
<code>lifetable_convert</code>,
<code>qsd_converge()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mpm1)

mpm_to_table(matU = mpm1$matU, start = 2, xmax = 15)

# equivalent using named life stages
mpm_to_table(matU = mpm1$matU, start = "small", xmax = 15)
mpm_to_table(matU = mpm1$matU, matF = mpm1$matF, start = 2, xmax = 15)

### starting from first reproduction
repStages &lt;- repro_stages(mpm1$matF)
n1 &lt;- mature_distrib(matU = mpm1$matU, start = 2, repro_stages = repStages)
mpm_to_table(matU = mpm1$matU, start = n1)
</code></pre>


</div>