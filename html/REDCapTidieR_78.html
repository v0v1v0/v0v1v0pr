<div class="container">

<table style="width: 100%;"><tr>
<td>write_redcap_xlsx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Write Supertibbles to XLSX</h2>

<h3>Description</h3>

<p>Transform a supertibble into an XLSX file, with each REDCap data tibble in a separate sheet.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write_redcap_xlsx(
  supertbl,
  file,
  add_labelled_column_headers = NULL,
  use_labels_for_sheet_names = TRUE,
  include_toc_sheet = TRUE,
  include_metadata_sheet = TRUE,
  table_style = "tableStyleLight8",
  column_width = "auto",
  recode_logical = TRUE,
  na_replace = "",
  overwrite = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>supertbl</code></td>
<td>
<p>A supertibble generated using <code>read_redcap()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>The name of the file to which the output will be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_labelled_column_headers</code></td>
<td>
<p>If <code>TRUE</code>, the first row of each sheet will contain variable labels,
with variable names in the second row. If <code>FALSE</code>, variable names will be in the first row.
The default value, <code>NULL</code>, tries to determine if <code>supertbl</code> contains variable labels and,
if present, includes them in the first row. The <code>labelled</code> package must be installed
if <code>add_labelled_column_headers</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_labels_for_sheet_names</code></td>
<td>
<p>If <code>FALSE</code>, sheet names will come from the REDCap instrument names.
If <code>TRUE</code>, sheet names will come from instrument labels. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_toc_sheet</code></td>
<td>
<p>If <code>TRUE</code>, the first sheet in the XLSX output will be a table of contents,
providing information about each data tibble in the workbook. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_metadata_sheet</code></td>
<td>
<p>If <code>TRUE</code>, the final sheet in the XLSX output will contain metadata
about each variable, combining the content of <code>supertbl$redcap_metadata</code>. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table_style</code></td>
<td>
<p>Any Excel table style name or "none". For more details, see
the
<a href="https://ycphs.github.io/openxlsx/articles/Formatting.html#use-of-pre-defined-table-styles">"formatting" vignette</a>
of the <code>openxlsx</code> package. The default is "tableStyleLight8".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>column_width</code></td>
<td>
<p>Sets the width of columns throughout the workbook.
The default is "auto", but you can specify a numeric value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recode_logical</code></td>
<td>
<p>If <code>TRUE</code>, fields with "yesno" field type are recoded to "yes"/"no" and fields
with a "checkbox" field type are recoded to "Checked"/"Unchecked". The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_replace</code></td>
<td>
<p>The value used to replace <code>NA</code> values in <code>supertbl</code>. The default is "".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>If <code>FALSE</code>, will not overwrite <code>file</code> when it exists. The default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>openxlsx2</code> workbook object, invisibly
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
redcap_uri &lt;- Sys.getenv("REDCAP_URI")
token &lt;- Sys.getenv("REDCAP_TOKEN")

supertbl &lt;- read_redcap(redcap_uri, token)

supertbl %&gt;%
  write_redcap_xlsx(file = "supertibble.xlsx")

# Add variable labels

library(labelled)

supertbl %&gt;%
  make_labelled() %&gt;%
  write_redcap_xlsx(file = "supertibble.xlsx", add_labelled_column_headers = TRUE)

## End(Not run)

</code></pre>


</div>