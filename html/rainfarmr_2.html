<div class="container">

<table style="width: 100%;"><tr>
<td>downscale</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Downscale a precipitation field</h2>

<h3>Description</h3>

<p>Downscales an input precipitation matrix using a metagaussian
spectral field <code>f</code> previously generated with <code>initmetagauss()</code>.
The target resolution is defined by the dimensions of <code>f</code>.
An optional weights array can be specified.
</p>


<h3>Usage</h3>

<pre><code class="language-R">downscale(r, f, weights = 1, fglob = FALSE, fsmooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>matrix of precipitation data to downscale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>matrix containing a complex spectrum generated by the
<code>initmetagauss()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>matrix with climatological weights generated with the
<code>rfweights()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fglob</code></td>
<td>
<p>logical to conserve global average over domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsmooth</code></td>
<td>
<p>logical to use smoothing for conservation.
If neither option is set precipitation is conserved over each coarse box.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The downscaled field, with the same dimensions as <code>f</code>.
</p>


<h3>Author(s)</h3>

<p>Jost von Hardenberg, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Make some sample synthetic rainfall data
r &lt;- exp(rnorm(4 * 4))
dim(r) &lt;- c(4, 4)
r
#           [,1]      [,2]      [,3]      [,4]
# [1,] 1.8459816 1.8536550 2.1600665 1.3102116
# [2,] 1.3851011 1.4647348 0.2708219 0.4571810
# [3,] 0.2492451 0.8227134 0.4790567 1.9320403
# [4,] 0.5985922 3.3065678 2.1282795 0.6849944
# Create help field `f` with logarithmic slope 1.7
# with `dim(f) = c(8 * 4 ,8 * 4)`
f &lt;- initmetagauss(1.7, 8 * 4)
rd &lt;- downscale(r, f, fsmooth=FALSE) 
# Verify that downscaled data maintained original box averages
agg(rd, 4) 
#           [,1]      [,2]      [,3]      [,4]
# [1,] 1.8459816 1.8536550 2.1600665 1.3102116
# [2,] 1.3851011 1.4647348 0.2708219 0.4571810
# [3,] 0.2492451 0.8227134 0.4790567 1.9320403
# [4,] 0.5985922 3.3065678 2.1282795 0.6849944
</code></pre>


</div>