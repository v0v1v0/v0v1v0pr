<div class="container">

<table style="width: 100%;"><tr>
<td>calc_Kv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to calculate the Gram matrices and their eigenvalues and eigenvectors for a chosen reproducing kernel.
</h2>

<h3>Description</h3>

<p>Calculates the Gram matrices <code class="reqn">K_v</code> for <code class="reqn">v=1,\ldots,</code>vMax, and returns their associated eigenvalues and eigenvectors. The calculated Gram matrices may be not positive definite. The option "correction" of this function allows to replace the matrices <code class="reqn">K_v</code> that are not positive definite by their "nearest positive definite" matrices.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_Kv(X, kernel, Dmax, correction, verbose, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of observations with <code class="reqn">n</code> rows and <code class="reqn">d</code> columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>Character, the type of the reproducing kernel: matern <code class="reqn">(</code>matern kernel<code class="reqn">)</code>, brownian <code class="reqn">(</code>brownian kernel<code class="reqn">)</code>, gaussian <code class="reqn">(</code>gaussian kernel<code class="reqn">)</code>, linear <code class="reqn">(</code>linear kernel<code class="reqn">)</code>, quad <code class="reqn">(</code>quadratic kernel<code class="reqn">)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dmax</code></td>
<td>
<p>Integer, between <code class="reqn">1</code> and <code class="reqn">d</code>, indicates the order of interactions considered in the meta model: Dmax<code class="reqn">=1</code> is used to consider only the main effects, Dmax<code class="reqn">=2</code> to include the main effects and the interactions of order <code class="reqn">2,\ldots</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>Logical, if TRUE, the program makes the correction to the matrices <code class="reqn">K_v</code> that are not positive definite (see details). Set as TRUE by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, if TRUE, the group <code class="reqn">v</code> for which the correction is done is printed. Set as TRUE by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Scalar, used if correction is TRUE. For each matrix <code class="reqn">K_v</code> if <code class="reqn">\lambda_{min} &lt; \lambda_{max}\times</code>tol, then the correction to <code class="reqn">K_v</code> is done (see details). Set as <code class="reqn">1e^{-8}</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">\lambda_{v,i},i=1,...,n</code> be the eigenvalues associated with matrix <code class="reqn">K_v</code>. Set <code class="reqn">\lambda_{max}={max}_{i}\lambda_{v,i}</code> and <code class="reqn">\lambda_{min}={min}_{i}\lambda_{v,i}</code>. The eigenvalues of <code class="reqn">K_v</code> that is not positive definite are replaced by <code class="reqn">\lambda_{v,i}+</code>epsilon, with espilon<code class="reqn">=\lambda_{max}\times</code>tol. The value of tol depends on the type of the kernel and it is chosen small.
</p>


<h3>Value</h3>

<p>List of two components "names.Grp" and "kv":
</p>
<table>
<tr style="vertical-align: top;">
<td><code>names.Grp</code></td>
<td>
<p>Vector of size vMax, indicates the name of groups included in the meta model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kv</code></td>
<td>
<p>List of vMax components with the same names as the vector names.Grp. Each element of the list is a list of two components "Evalues" and "Q":</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Evalues</code></td>
<td>
<p>Vector of size <code class="reqn">n</code>, eigenvalues of each Gram matrix <code class="reqn">K_v</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Matrix with <code class="reqn">n</code> rows and <code class="reqn">n</code> columns, eigenvectors of each Gram matrix <code class="reqn">K_v</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Note.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code>RKHSMetaMod</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
Kv &lt;- calc_Kv(X, kernel, Dmax)
names &lt;- Kv$names.Grp
Eigen.val1 &lt;- Kv$kv$v1.$Evalues
Eigen.vec1 &lt;- Kv$kv$v1.$Q
</code></pre>


</div>