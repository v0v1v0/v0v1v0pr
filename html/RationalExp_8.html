<div class="container">

<table style="width: 100%;"><tr>
<td>test_base</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The test statistic for the RE test with survey weights</h2>

<h3>Description</h3>

<p>This is an internal function used in the function test to compute the test statistic with survey weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_base(Y_tilde, X, D, data_test, epsilon, B, N3, c, kappa, p, N,
  weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y_tilde</code></td>
<td>
<p>the vector stacking the realisations y then the anticipated values psi of respective sizes n_y and n_p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the matrix of covariates. Set to a vector of 1 by default (in which case the test without covariates is performed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>the vector stacking the dummies for the dataset of realisation : n_y ones then n_p zeros</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_test</code></td>
<td>
<p>the matrix of sample moments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>the parameter epsilonon inSection 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the number of bootstrap samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N3</code></td>
<td>
<p>a parameter equal to 1 if no covariates, to N otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>the parameter c in  Section 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>the parameter kappapa in  Section 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the parameter p in  Section 3. Equals 0.0 if generalized RE test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>total number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>the vector of survey weights. Uniform by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, the test is implemented without covariates. To perform the test with covariates, one has to indicate in X a non-constant vector or matrix. Also, one can perform the « generalized » tests allowing for aggregate shocks by using the dummy variable generalized. Survey weights can be added. The user can modify the number of cores used by R to reduce the computational time. Tuning parameters used in the test can also be modified.
</p>


<h3>Value</h3>

<p>a list containing, in order:
</p>
<p>-  T_n : the test statistic
</p>
<p>- phi_n: the vector of coresponding GMS functions
</p>
<p>- M_bar : the matrix of M_bar  in  Section 3
</p>


<h3>References</h3>

<p>D’Haultfoeuille X, Gaillac C, Maurel A (2018). “Rationalizing Rational Expectations? Tests and Deviations.” CREST Working paper
</p>
<p>Andrews D, Shi X (2017). “Inference Based on Many Conditional Moment Inequalities.” Journal of Econometrics, 196(2), 275–287.
</p>
<p>Andrews DW, Kim W, Shi X (2017). “Commands for testing conditional moment inequalities and equalities.” The Stata journal, 17(1).
</p>


</div>