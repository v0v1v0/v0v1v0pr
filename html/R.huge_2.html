<div class="container">

<table style="width: 100%;"><tr>
<td>AbstractFileArray</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class representing a persistent array stored in a file</h2>

<h3>Description</h3>

<p>Package:  R.huge <br><b>Class AbstractFileArray</b><br></p>
<p><code>Object</code><br><code>~~|</code><br><code>~~+--</code><code>AbstractFileArray</code><br></p>
<p><b>Directly known subclasses:</b><br>
FileByteMatrix, FileByteVector, FileDoubleMatrix, FileDoubleVector, FileFloatMatrix, FileFloatVector, FileIntegerMatrix, FileIntegerVector, FileMatrix, FileShortMatrix, FileShortVector, FileVector<br></p>
<p>public static class <b>AbstractFileArray</b><br>
extends Object<br></p>
<p>Note that this is an abstract class, i.e. it is not possible to create
an object of this class but only from one of its subclasses.
For a vector data type, see <code>FileVector</code>.
For a matrix data type, see <code>FileMatrix</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AbstractFileArray(filename=NULL, path=NULL, storageMode=c("integer", "double"),
  bytesPerCell=1, dim=NULL, dimnames=NULL, dimOrder=NULL, comments=NULL,
  nbrOfFreeBytes=4096)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>The name of the file storing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>An optional path where data should be stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>storageMode</code></td>
<td>
<p>The storage <code>mode</code>() of the data elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bytesPerCell</code></td>
<td>
<p>The number of bytes each element (cell) takes up
on the file system.  If <code>NULL</code>, it is inferred from the
<code>storageMode</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>A <code>numeric</code> <code>vector</code> specifying the dimensions of the array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimnames</code></td>
<td>
<p>An optional <code>list</code> of dimension names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimOrder</code></td>
<td>
<p>The order of the dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comments</code></td>
<td>
<p>An optional <code>character</code> string of arbitrary length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbrOfFreeBytes</code></td>
<td>
<p>The number of "spare" bytes after the comments
before the data section begins.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The purpose of this class is to be able to work with large arrays
in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> without being limited by the amount of memory available.
Data is kept on the file system and elements are read and written
whenever queried.
</p>


<h3>Fields and Methods</h3>

<p><b>Methods:</b><br></p>

<table>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>as.character</code> </td>
<td style="text-align: left;"> Returns a short string describing the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>as.vector</code> </td>
<td style="text-align: left;"> Returns the elements of a file array as an R vector.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>clone</code> </td>
<td style="text-align: left;"> Clones a file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>close</code> </td>
<td style="text-align: left;"> Closes a connection to the data file of the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>delete</code> </td>
<td style="text-align: left;"> Deletes the file array from the file system.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>dim</code> </td>
<td style="text-align: left;"> Gets the dimension of the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>dimnames</code> </td>
<td style="text-align: left;"> Gets the dimension names of a file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>finalize</code> </td>
<td style="text-align: left;"> Internal: Clean up when file array is deallocated from memory.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>flush</code> </td>
<td style="text-align: left;"> Internal: Flushes the write buffer.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getBasename</code> </td>
<td style="text-align: left;"> Gets the basename (filename) of the data file.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getBytesPerCell</code> </td>
<td style="text-align: left;"> Gets the number of bytes per element in a file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getCloneNumber</code> </td>
<td style="text-align: left;"> Gets the clone number of the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getComments</code> </td>
<td style="text-align: left;"> Gets the comments for this file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getDataOffset</code> </td>
<td style="text-align: left;"> Gets file position of the data section in a file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getDimensionOrder</code> </td>
<td style="text-align: left;"> Gets the order of dimension.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getExtension</code> </td>
<td style="text-align: left;"> Gets the filename extension of the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getFileSize</code> </td>
<td style="text-align: left;"> Gets the size of the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getName</code> </td>
<td style="text-align: left;"> Gets the name of the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getPath</code> </td>
<td style="text-align: left;"> Gets the path (directory) where the data file lives.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getPathname</code> </td>
<td style="text-align: left;"> Gets the full pathname to the data file.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getSizeOfComments</code> </td>
<td style="text-align: left;"> Gets the number of bytes the comments occupies.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getSizeOfData</code> </td>
<td style="text-align: left;"> Gets the size of the data section in bytes.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getStorageMode</code> </td>
<td style="text-align: left;"> Gets the storage mode of the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>isOpen</code> </td>
<td style="text-align: left;"> Checks whether the data file of the file array is open or not.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>length</code> </td>
<td style="text-align: left;"> Gets the number of elements in a file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>open</code> </td>
<td style="text-align: left;"> Opens a connection to the data file of the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>readAllValues</code> </td>
<td style="text-align: left;"> Reads all values in the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>readContiguousValues</code> </td>
<td style="text-align: left;"> Reads sets of contiguous values in the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>readHeader</code> </td>
<td style="text-align: left;"> Read the header of a file array data file.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>readValues</code> </td>
<td style="text-align: left;"> Reads individual values in the file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>setComments</code> </td>
<td style="text-align: left;"> Sets the comments for this file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>writeAllValues</code> </td>
<td style="text-align: left;"> Writes all values to a file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>writeEmptyData</code> </td>
<td style="text-align: left;"> Writes an empty data section to the data file of a file array.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>writeHeader</code> </td>
<td style="text-align: left;"> Writes the header of a file array to file.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>writeHeaderComments</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>writeValues</code> </td>
<td style="text-align: left;"> Writes values to a file array.</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p><b>Methods inherited from Object</b>:<br>
$, $&lt;-, [[, [[&lt;-, as.character, attach, attachLocally, clearCache, clearLookupCache, clone, detach, equals, extend, finalize, getEnvironment, getFieldModifier, getFieldModifiers, getFields, getInstantiationTime, getStaticInstance, hasField, hashCode, ll, load, names, objectSize, print, save
</p>


<h3>Maximum number of elements</h3>

<p>It is only the header that is kept in memory, not the data, and
therefore the maximum length of a array that can be allocate, is limited
by the amount of available space on the file system.
Since element names (optional) are stored in the header,
these may also be a limiting factor.
</p>


<h3>Element names</h3>

<p>The element names are stored in the header and are currently read and
written to file one by one.  This may slow down the performance
substantially if the dimensions are large.  For optimal opening
performance, avoid names.
</p>
<p>For now, do <em>not</em> change names after file has been allocated.
</p>


<h3>File format</h3>

<p>The file format consist of a header section and a data section.
The header contains information about the file format, the length
and element names of the array, as well as data type
(storage <code>mode</code>()), the size of each element.
The data section, which follows immediately after the header section,
consists of all data elements with non-assigned elements being
pre-allocated with zeros.
</p>
<p>For more details, see the source code.
</p>


<h3>Limitations</h3>

<p>The size of the array in bytes is limited by the maximum file size
of the file system.
For instance, the maximum file size on a Windows FAT32 system is
4GB (2GB?).  On Windows NTFS the limit is in practice ~16TB.
</p>


<h3>Author(s)</h3>

<p>Henrik Bengtsson</p>


<h3>References</h3>

<p>[1] New Technology File System (NTFS), Wikipedia, 2006
<a href="https://en.wikipedia.org/wiki/NTFS">https://en.wikipedia.org/wiki/NTFS</a>.
</p>


</div>