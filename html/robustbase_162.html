<div class="container">

<table style="width: 100%;"><tr>
<td>smoothWgt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooth Weighting Function - Generalized Biweight</h2>

<h3>Description</h3>

<p>“The Biweight on a Stick” —
Compute a smooth (when <code class="reqn">h &gt; 0</code>) weight function typically for
computing weights from large (robust) “distances” using a
piecewise polynomial function which in fact is a
2-parameter generalization of Tukey's 1-parameter “biweight”.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smoothWgt(x, c, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of abscissa values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>“cutoff”, a typically positive number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>“bandwidth”, a positive number.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">w(x;c,h) := </code><code>smoothWgt(x, c, h)</code>.  Then,
</p>
<p style="text-align: center;"><code class="reqn">% "FIXME": rather use amsmath package \cases{.}
    w(x; c,h) := 0 \ \ \ \ \ \mathrm{if}\ |x| \ge c + h/2,</code>
</p>

<p style="text-align: center;"><code class="reqn">
    w(x; c,h) := 1 \ \ \ \ \ \mathrm{if}\ |x| \le c - h/2,</code>
</p>

<p style="text-align: center;"><code class="reqn">
    w(x; c,h) := \bigl((1 - |x| - (c-h/2))^2\bigr)^2 \ \mathrm{if}\ c-h/2 &lt; |x| &lt; c+h/2,</code>
</p>

<p><code>smoothWgt()</code> is <em>scale invariant</em> in the sense that
</p>
<p style="text-align: center;"><code class="reqn">w(\sigma x; \sigma c, \sigma h) = w(x; c, h),</code>
</p>
<p> when <code class="reqn">\sigma &gt; 0</code>.
</p>


<h3>Value</h3>

<p>a numeric vector of the same length as <code>x</code> with weights between
zero and one.  Currently all <code>attributes</code> including
<code>dim</code> and <code>names</code> are dropped.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code>Mwgt(.., psi = "bisquare")</code> of which <code>smoothWgt()</code>
is a generalization, and
<code>Mwgt(.., psi = "optimal")</code> which looks similar for larger
<code>c</code> with its constant one part around zero, but also has only
one parameter.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## a somewhat typical picture:
curve(smoothWgt(x, c=3, h=1), -5,7, n = 1000)

csW &lt;- curve(smoothWgt(x, c=1/2, h=1), -2,2) # cutoff 1/2, bandwidth 1
## Show that the above is the same as
## Tukey's "biweight" or "bi-square" weight function:
bw &lt;- function(x) pmax(0, (1 - x^2))^2
cbw &lt;- curve(bw,                     col=adjustcolor(2, 1/2), lwd=2, add=TRUE)
cMw &lt;- curve(Mwgt(x,c=1,"biweight"), col=adjustcolor(3, 1/2), lwd=2, add=TRUE)
stopifnot(## proving they are all the same:
   all.equal(csW, cbw, tol=1e-15),
   all.equal(csW, cMw, tol=1e-15))
</code></pre>


</div>