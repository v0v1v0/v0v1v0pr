<div class="container">

<table style="width: 100%;"><tr>
<td>causalegm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function for estimating causal effect in either binary or continuous treatment settings.</h2>

<h3>Description</h3>

<p>This function takes observation data (x,y,v) as input, and estimate the ATE/ITE/ADRF.
</p>


<h3>Usage</h3>

<pre><code class="language-R">causalegm(
  x,
  y,
  v,
  z_dims = c(3, 3, 6, 6),
  output_dir = ".",
  dataset = "myData",
  lr = 2e-04,
  bs = 32,
  alpha = 1,
  beta = 1,
  gamma = 10,
  g_d_freq = 5,
  g_units = c(64, 64, 64, 64, 64),
  e_units = c(64, 64, 64, 64, 64),
  f_units = c(64, 32, 8),
  h_units = c(64, 32, 8),
  dv_units = c(64, 32, 8),
  dz_units = c(64, 32, 8),
  save_model = FALSE,
  save_res = FALSE,
  binary_treatment = TRUE,
  use_z_rec = TRUE,
  use_v_gan = TRUE,
  random_seed = 123,
  n_iter = 30000,
  normalize = FALSE,
  x_min = NULL,
  x_max = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>is the treatment variable, one-dimensional array with size n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>is the potential outcome, one-dimensional array with size n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>is the covariates, two-dimensional array with size n by p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_dims</code></td>
<td>
<p>is the latent dimensions for <code class="reqn">z_0,z_1,z_2,z_3</code> respectively. Total dimension should be much smaller than the dimension of covariates <code class="reqn">v</code>. Default: c(3,3,6,6)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_dir</code></td>
<td>
<p>is the folder to save the results including model hyperparameters and the estimated causal effect. Default is ".".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>is the name for the input data. Default: "myData".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lr</code></td>
<td>
<p>is the learning rate. Default: 0.0002.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs</code></td>
<td>
<p>is the batch size. Default: 32.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>is the coefficient for the reconstruction loss. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>is the coefficient for the MSE loss of <code class="reqn">x</code> and <code class="reqn">y</code>. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>is the coefficient for the gradient penalty loss. Default: 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_d_freq</code></td>
<td>
<p>is the iteration frequency between training generator and discriminator in the Roundtrip framework. Default: 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_units</code></td>
<td>
<p>is the list of hidden nodes in the generator/decoder network. Default: c(64,64,64,64,64).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e_units</code></td>
<td>
<p>is the list of hidden nodes in the encoder network. Default: c(64,64,64,64,64).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_units</code></td>
<td>
<p>is the list of hidden nodes in the f network for predicting <code class="reqn">y</code>. Default: c(64,32,8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_units</code></td>
<td>
<p>is the list of hidden nodes in the h network for predicting <code class="reqn">x</code>. Default: c(64,32,8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dv_units</code></td>
<td>
<p>is the list of hidden nodes in the discriminator for distribution match <code class="reqn">v</code>. Default: c(64,32,8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dz_units</code></td>
<td>
<p>is the list of hidden nodes in the discriminator for distribution match <code class="reqn">z</code>. Default: c(64,32,8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_model</code></td>
<td>
<p>whether to save the trained model. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_res</code></td>
<td>
<p>whether to save the results during training. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary_treatment</code></td>
<td>
<p>whether the treatment is binary or continuous. Default: TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_z_rec</code></td>
<td>
<p>whether to use the reconstruction loss for <code class="reqn">z</code>. Default: TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_v_gan</code></td>
<td>
<p>whether to use the GAN training for <code class="reqn">v</code>. Default: TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_seed</code></td>
<td>
<p>is the random seed to fix randomness. Default: 123.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_iter</code></td>
<td>
<p>is the training iterations. Default: 30000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>whether apply normalization to covariates. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_min</code></td>
<td>
<p>ADRF start value. Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_max</code></td>
<td>
<p>ADRF end value. Default: NULL</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>causalegm</code> returns an object of <code>class</code> "causalegm".
</p>
<p>An object of class <code>"causalegm"</code> is a list containing the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>causal_pre</code></td>
<td>
<p>the predicted causal effects, which are individual causal effects (ITEs) in binary treatment settings and dose-response values in continous treatment settings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>getCATE</code></td>
<td>
<p>the method for getting the conditional average treatment effect (CATE).It takes covariates v as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict</code></td>
<td>
<p>the method for outcome function. It takes treatment x and covariates v as inputs.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Qiao Liu, Zhongren Chen, Wing Hung Wong.  CausalEGM: a general causal inference framework by encoding generative modeling. <em>arXiv preprint arXiv:2212.05925, 2022</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Generate a simple simulation data.
n &lt;- 1000
p &lt;- 10
v &lt;- matrix(rnorm(n * p), n, p)
x &lt;- rbinom(n, 1, 0.4 + 0.2 * (v[, 1] &gt; 0))
y &lt;- pmax(v[, 1], 0) * x + v[, 2] + pmin(v[, 3], 0) + rnorm(n)
model &lt;- causalegm(x=x, y=y, v=v, n_iter=3000)
paste("The average treatment effect (ATE):", round(model$ATE, 2))


</code></pre>


</div>