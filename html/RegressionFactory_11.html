<div class="container">

<table style="width: 100%;"><tr>
<td>regfac.expand.1par</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Expander Function for Single-Parameter Base Distributions
</h2>

<h3>Description</h3>

<p>This function produces the full, high-dimensional gradient and Hessian from the base-distribution derivatives for linear transformations of the arguments of a single-parameter base distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">regfac.expand.1par(beta, X, y, fbase1, fgh=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Vector of coefficients in the regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of covariates in the regression model. Note that <code>ncol(X)</code> must be equal to <code>length(beta)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of response variable in the regression model. Note that <code>length(y)</code> must be equal to <code>nrow(X)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fbase1</code></td>
<td>
<p>Base distribution function <code>fbase1(u, y, ...)</code> for the regression model. It must return a list with elements <code>f,g,h</code> corresponding to the function and its first and second derivatives relative to its first argument, <code>u</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fgh</code></td>
<td>
<p>Integer with possible values 0,1,2. If <code>fgh=0</code>, the function only calculates and returns the log-likelihood function. If <code>fgh=1</code>, it returns the log-likelihood and its gradient vector. If <code>fgh=2</code>, it returns the log-likelihood, the gradient vector and the Hessian matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed to <code>fbase1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements <code>f,g,h</code> corresponding to the function, gradient vector, and Hessian matrix of the function <code>fbase(X%*%beta,y)</code>, i.e. the base function <code>fbase(u,y)</code> projected onto the high-dimensional space of <code>beta</code> through the linear transformation of its first argument (<code>u &lt;- X%*%beta</code>).
</p>


<h3>Author(s)</h3>

<p>Alireza S. Mahani, Mansour T.A. Sharabiani
</p>


<h3>References</h3>

<p>Mahani, Alireza S. and Sharabiani, Mansour T.A. (2013)
<em>Metropolis-Hastings Sampling Using Multivariate Gaussian Tangents</em>
<a href="https://arxiv.org/pdf/1308.0657v1.pdf">https://arxiv.org/pdf/1308.0657v1.pdf</a> 
</p>


<h3>See Also</h3>

<p><code>regfac.expand.2par</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(sns)
# simulating logistic regression data
N &lt;- 1000 # number of observations
K &lt;- 10 # number of variables
X &lt;- matrix(runif(N*K, min=-0.5, max=+0.5), ncol=K)
beta &lt;- runif(K, min=-0.5, max=+0.5)
Xbeta &lt;- X%*%beta
y &lt;- 1*(runif(N)&lt;1/(1+exp(-Xbeta)))
beta.est &lt;- rep(0,K)
# run sns in non-stochastic mode, i.e. Newton-Raphson optimization
for (i in 1:10) {
  beta.est &lt;- sns(beta.est, regfac.expand.1par, rnd=F, X=X, y=y
    , fbase1=fbase1.binomial.logit)
}
# use glm to estimate beta and compare
beta.est.glm &lt;- glm(y~X-1, family="binomial")$coefficients
cbind(beta.est, beta.est.glm)

## End(Not run)
</code></pre>


</div>