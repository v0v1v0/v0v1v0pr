<div class="container">

<table style="width: 100%;"><tr>
<td>mn.nreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model-assisted inference for population means without regularization</h2>

<h3>Description</h3>

<p>This function implements model-assisted inference for population means with missing data,
using non-regularized calibrated estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mn.nreg(y, tr, x, ploss = "cal", yloss = "gaus", off = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes with missing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of non-missing indicators (=1 if <code>y</code> is observed or 0 if <code>y</code> is missing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">p</code> matix of covariates (excluding a constant), used in both propensity score and outcome regression models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploss</code></td>
<td>
<p>A loss function used in propensity score estimation (either "ml" or "cal").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yloss</code></td>
<td>
<p>A loss function used in outcome regression (either "gaus" for continuous outcomes or "ml" for binary outcomes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>off</code></td>
<td>
<p>An offset value (e.g., the true value in simulations) used to calculate the z-statistic from augmented IPW estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two steps are involved in this function: first fitting propensity score and outcome regression models and then applying the augmented IPW estimator 
for a population mean. For <code>ploss</code>="cal", calibrated estimation is performed similarly as in Tan (2020a, 2020b), but without regularization. 
The method then leads to model-assisted inference, in which confidence intervals are valid if the propensity score model is correctly specified but 
the outcome regression model may be misspecified.
With linear outcome models, the inference is also doubly robust (Kim and Haziza 2014; Vermeulen and Vansteelandt 2015).  
For <code>ploss</code>="ml", maximum likelihood estimation is used (Robins et al. 1994). In this case, standard errors are in general conservative 
if the propensity score model is correctly specified but the outcome regression model may be misspecified.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ps</code></td>
<td>
<p>A list containing the results from fitting the propensity score model by <code>glm.nreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fp</code></td>
<td>
<p>The <code class="reqn">n</code> x <code class="reqn">1</code> vector of fitted propensity scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>or</code></td>
<td>
<p>A list containing the results from fitting the outcome regression model by <code>glm.nreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fo</code></td>
<td>
<p>The <code class="reqn">n</code> x <code class="reqn">1</code> vector of fitted values from outcome regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>A list containing the results from augmented IPW estimation by <code>mn.aipw</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Kim, J.K. and Haziza, D. (2014) Doubly robust inference with missing data in survey sampling, <em>Statistica Sinica</em>, 24, 375-394.
</p>
<p>Robins, J.M., Rotnitzky, A., and Zhao, L.P. (1994) Estimation of regression coefficients when some regressors are not always observed, 
<em>Journal of the American Statistical Association</em>, 89, 846-866.
</p>
<p>Vermeulen, K. and Vansteelandt, S. (2015) Bias-reduced doubly robust estimation, <em>Journal of the American Statistical Association</em>, 110, 1024-1036.
</p>
<p>Tan, Z. (2020a) Regularized calibrated estimation of propensity scores with model misspecification and high-dimensional data, <em>Biometrika</em>, 107, 137–158.
</p>
<p>Tan, Z. (2020b) Model-assisted inference for treatment effects using regularized calibrated estimation with high-dimensional data, <em>Annals of Statistics</em>, 48, 811–837.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(simu.data)
n &lt;- dim(simu.data)[1]
p &lt;- dim(simu.data)[2]-2

y &lt;- simu.data[,1]
tr &lt;- simu.data[,2]
x &lt;- simu.data[,2+1:p]
x &lt;- scale(x)

# missing data
y[tr==0] &lt;- NA

# include only 10 covariates
x2 &lt;- x[,1:10]

mn.cal &lt;- mn.nreg(y, tr, x2, ploss="cal", yloss="gaus")
unlist(mn.cal$est)

</code></pre>


</div>