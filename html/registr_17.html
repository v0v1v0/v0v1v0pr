<div class="container">

<table style="width: 100%;"><tr>
<td>fpca_gauss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional principal components analysis via variational EM</h2>

<h3>Description</h3>

<p>Function used in the FPCA step for registering functional data,
called by <code>register_fpca</code> when <code>family = "gaussian"</code>. 
Parameters estimated based on probabilistic PCA framework originally 
introduced by Tipping and Bishop in 1999. <br><br>
The number of functional principal components (FPCs) can either be specified
directly (argument <code>npc</code>) or chosen based on the explained share of
variance (<code>npc_varExplained</code>). In the latter case, the explained share of
variance and accordingly the number of FPCs is estimated before the main
estimation step by once running the FPCA with <code>npc = 20</code> (and
correspondingly <code>Kt = 20</code>). Doing so, we approximate the overall
variance in the data <code>Y</code> with the variance represented by the FPC basis
with 20 FPCs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fpca_gauss(
  Y,
  npc = NULL,
  npc_varExplained = NULL,
  Kt = 8,
  maxiter = 20,
  t_min = NULL,
  t_max = NULL,
  print.iter = FALSE,
  row_obj = NULL,
  seed = 1988,
  periodic = FALSE,
  error_thresh = 1e-04,
  subsample = TRUE,
  verbose = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Dataframe. Should have variables id, value, index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc, npc_varExplained</code></td>
<td>
<p>The number of functional principal components (FPCs)
has to be specified either directly as <code>npc</code> or based on their explained
share of variance. In the latter case, <code>npc_varExplained</code> has to be set
to a share between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kt</code></td>
<td>
<p>Number of B-spline basis functions used to estimate mean functions
and functional principal components. Default is 8. If <code>npc_varExplained</code>
is used, <code>Kt</code> is set to 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations to perform for EM algorithm. Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_min</code></td>
<td>
<p>Minimum value to be evaluated on the time domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_max</code></td>
<td>
<p>Maximum value to be evaluated on the time domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.iter</code></td>
<td>
<p>Prints current error and iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_obj</code></td>
<td>
<p>If NULL, the function cleans the data and calculates row indices. 
Keep this NULL if you are using standalone <code>register</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Set seed for reproducibility. Defaults to 1988.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodic</code></td>
<td>
<p>If TRUE, uses periodic b-spline basis functions. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_thresh</code></td>
<td>
<p>Error threshold to end iterations. Defaults to 0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsample</code></td>
<td>
<p>if the number of rows of the data is greater than 
10 million rows, the 'id' values are subsampled to get the mean coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Can be set to integers between 0 and 4 to control the level of
detail of the printed diagnostic messages. Higher numbers lead to more detailed
messages. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to or from other functions</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>fpca</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fpca_type</code></td>
<td>
<p>Information that FPCA was performed with the 'variationEM' approach,
in contrast to registr::gfpca_twoStep.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_vec</code></td>
<td>
<p>Time vector over which the mean <code>mu</code> and the functional principal
components <code>efunctions</code> were evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Cutpoints for B-spline basis used to rebuild <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efunctions</code></td>
<td>
<p><code class="reqn">D \times npc</code> matrix of estimated FPC basis functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalues</code></td>
<td>
<p>Estimated variance of the FPC scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalues_sum</code></td>
<td>
<p>Approximation of the overall variance in <code>Y</code>, based
on an initial run of the FPCA with <code>npc = 20</code>. Is <code>NULL</code> if
<code>npc_varExplained</code> was not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>number of FPCs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p><code class="reqn">I \times npc</code> matrix of estimated FPC scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Estimated population-level mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Estimated population-level mean. Same value as <code>alpha</code> but included for compatibility
with <code>refund.shiny</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject_coefs</code></td>
<td>
<p>B-spline basis coefficients used to construct subject-specific means. 
For use in <code>registr()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yhat</code></td>
<td>
<p>FPC approximation of subject-specific means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The observed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p><code>gaussian</code>, for compatibility with <code>refund.shiny</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>Estimated error variance</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Julia Wrobel <a href="mailto:julia.wrobel@cuanschutz.edu">julia.wrobel@cuanschutz.edu</a>,
Jeff Goldsmith <a href="mailto:ajg2202@cumc.columbia.edu">ajg2202@cumc.columbia.edu</a>,
Alexander Bauer <a href="mailto:alexander.bauer@stat.uni-muenchen.de">alexander.bauer@stat.uni-muenchen.de</a>
</p>


<h3>References</h3>

<p>Tipping, M. E. and Bishop, C (1999). Probabilistic Principal Component Analysis.
<em>Journal of the Royal Statistical Society Series B,</em>, 592â€“598.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(growth_incomplete)

# estimate 2 FPCs
fpca_obj = fpca_gauss(Y = growth_incomplete, npc = 2)
plot(fpca_obj)

# estimate npc adaptively, to explain 90% of the overall variation

fpca_obj2 = fpca_gauss(Y = growth_incomplete, npc_varExplained = 0.9)
plot(fpca_obj, plot_FPCs = 1:2)


</code></pre>


</div>