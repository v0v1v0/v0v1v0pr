<div class="container">

<table style="width: 100%;"><tr>
<td>ate.regu.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model-assisted inference for average treatment effects based on cross validation</h2>

<h3>Description</h3>

<p>This function implements model-assisted inference for average treatment effects,
using regularized calibrated estimation based on cross validation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ate.regu.cv(fold, nrho = NULL, rho.seq = NULL, y, tr, x, ploss = "cal",
  yloss = "gaus", off = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fold</code></td>
<td>
<p>A vector of length 2 giving the fold numbers for cross validation in propensity score estimation and outcome regression respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrho</code></td>
<td>
<p>A vector of length 2 giving the numbers of tuning parameters searched in cross validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.seq</code></td>
<td>
<p>A list of two vectors giving the tuning parameters in propensity score estimation (first vector) and outcome regression (second vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of observed outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of treatment indicators (=1 if treated or 0 if untreated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">p</code> matix of covariates, used in both propensity score and outcome regression models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploss</code></td>
<td>
<p>A loss function used in propensity score estimation (either "ml" or "cal").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yloss</code></td>
<td>
<p>A loss function used in outcome regression (either "gaus" for continuous outcomes or "ml" for binary outcomes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>off</code></td>
<td>
<p>A <code class="reqn">2</code> x <code class="reqn">1</code> vector of offset values (e.g., the true values in simulations) used to calculate the z-statistics from augmented IPW estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to <code>glm.regu.cv</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For calibrated estimation, two sets of propensity scores are separately estimated for the untreated and treated as discussed in Tan (2020a, 2020b).
See also <strong>Details</strong> for <code>mn.regu.cv</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ps</code></td>
<td>
<p>A list containing the results from fitting the propensity score model by <code>glm.regu.cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfp</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">2</code> matrix of fitted propensity scores for untreated (first column) and treated (second column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>or</code></td>
<td>
<p>A list containing the results from fitting the outcome regression model by <code>glm.regu.cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfo</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">2</code> matrix of fitted values from outcome regression, for untreated (first column) and treated (second column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>A list containing the results from augmented IPW estimation by <code>ate.aipw</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Tan, Z. (2020a) Regularized calibrated estimation of propensity scores with model misspecification and high-dimensional data, <em>Biometrika</em>, 107, 137–158.
</p>
<p>Tan, Z. (2020b) Model-assisted inference for treatment effects using regularized calibrated estimation with high-dimensional data, <em>Annals of Statistics</em>, 48, 811–837.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(simu.data)
n &lt;- dim(simu.data)[1]
p &lt;- dim(simu.data)[2]-2

y &lt;- simu.data[,1]
tr &lt;- simu.data[,2]
x &lt;- simu.data[,2+1:p]
x &lt;- scale(x)

ate.cv.rcal &lt;- ate.regu.cv(fold=5*c(1,1), nrho=(1+10)*c(1,1), rho.seq=NULL, y, tr, x, 
                           ploss="cal", yloss="gaus")

matrix(unlist(ate.cv.rcal$est), ncol=2, byrow=TRUE, 
dimnames=list(c("one", "ipw", "or", "est", "var", "ze", 
"diff.est", "diff.var", "diff.ze"), c("untreated", "treated")))


</code></pre>


</div>