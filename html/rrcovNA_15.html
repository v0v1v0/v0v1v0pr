<div class="container">

<table style="width: 100%;"><tr>
<td>CovNASest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> S Estimates of Multivariate Location and Scatter for incomplete data</h2>

<h3>Description</h3>

<p>Computes S-Estimates of multivariate location and scatter based on Tukey's
biweight function for incomplete data using a fast algorithm similar to the one proposed by
Salibian-Barrera and Yohai (2006) for the case of regression. Alternativley, the
Ruppert's SURREAL algorithm, bisquare or Rocke type estimation can be used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">    CovNASest(x, bdp = 0.5, arp = 0.1, eps = 1e-5, maxiter = 120,
        nsamp = 500, impMeth = c("norm" , "seq", "rseq"), seed = NULL, 
        trace = FALSE, tolSolve = 1e-13,
        scalefn,
        method = c("sfast", "surreal", "bisquare", "rocke", "suser", "sdet"), control,
        t0, S0, initcontrol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a matrix or data frame. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdp</code></td>
<td>
<p>a numeric value specifying the required
breakdown point.  Allowed values are between
<code>(n - p)/(2 * n)</code> and 1 and the default is <code>bdp=0.5</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arp</code></td>
<td>
<p>a numeric value specifying the asympthotic
rejection point (for the Rocke type S estimates),
i.e. the fraction of points receiving zero
weight (see Rocke (1996)).  Default is <code>arp=0.1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>a numeric value specifying the
relative precision of the solution of the S-estimate
(bisquare and Rocke type). Default is to <code>eps=1e-5</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations allowed
in the computation of the S-estimate (bisquare and Rocke type).
Default is <code>maxiter=120</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>the number of random subsets considered. Default is <code>nsamp = 500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impMeth</code></td>
<td>
<p> select imputation method to use - choose one of "norm" , "seq" or "rseq". The default is "norm"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>starting value for random generator. Default is <code>seed = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>whether to print intermediate results. Default is <code>trace = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolSolve</code></td>
<td>
<p>numeric tolerance to be used for inversion
(<code>solve</code>) of the covariance matrix in
<code>mahalanobis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalefn</code></td>
<td>
<p><code>function</code> to compute a robust scale
estimate or character string specifying a rule determining such a
function. Used for computing the "deterministic" S-estimates (<code>method="sdet"</code>).
If <code>scalefn</code> is missing or is <code>NULL</code>, 
the function is selected depending on the data 
set size, following the recomendation of Hubert et al. (2012) - 
<code>Qn</code> if <code>n &lt;= 1000</code> and <code>scaleTau2</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> Which algorithm to use: 'sfast'=FAST-S, 'surreal'=SURREAL, 'bisquare', 
'rocke' or 'sdet', which will invoke the deterministic algorihm of Hubert et al. (2012).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> a control object (S4) of class <code>CovControlSest-class</code>
containing estimation options - same as these provided in the fucntion
specification. If the control object is supplied, the parameters from it
will be used. If parameters are passed also in the invocation statement, they will
override the corresponding elements of the control object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p> optional initial HBDP estimate for the center </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p> optional initial HBDP estimate for the covariance matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initcontrol</code></td>
<td>
<p> optional control object to be used for computing the initial HBDP estimates </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes biweight multivariate S-estimator of location and scatter. The computation will be
performed by one of the following algorithms:
</p>

<dl>
<dt>FAST-S</dt>
<dd>
<p>An algorithm similar to the one proposed by Salibian-Barrera and Yohai (2006) for the case of regression</p>
</dd>
<dt>SURREAL</dt>
<dd>
<p>Ruppert's SURREAL algorithm when <code>method</code> is set to 'surreal'</p>
</dd>
<dt>BISQUARE</dt>
<dd>
<p>Bisquare S-Estimate with <code>method</code> set to 'bisquare'</p>
</dd>
<dt>ROCKE</dt>
<dd>
<p>Rocke type S-Estimate with <code>method</code> set to 'rocke'</p>
</dd>
</dl>
<p>.

</p>


<h3>Value</h3>

<p>An S4 object of class <code>CovNASest</code> which is a subclass of the
virtual class <code>CovNARobust</code>.
</p>


<h3>Author(s)</h3>

<p> Valentin Todorov <a href="mailto:valentin.todorov@chello.at">valentin.todorov@chello.at</a>,
Matias Salibian-Barrera <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a> and
Victor Yohai <a href="mailto:vyohai@dm.uba.ar">vyohai@dm.uba.ar</a>.  See also the code from
Kristel Joossens, K.U. Leuven, Belgium and Ella Roelant, Ghent University, Belgium.
</p>


<h3>References</h3>

<p>M. Salibian-Barrera and V. Yohai (2006) A fast algorithm for S-regression
estimates, <em>Journal of Computational and Graphical Statistics</em>, <b>15</b>,
414–427.
</p>
<p>R. A. Maronna, D. Martin and V. Yohai (2006). <em>Robust Statistics: Theory and Methods</em>.
Wiley, New York.
</p>
<p>Todorov V &amp; Filzmoser P (2009),
An Object Oriented Framework for Robust Multivariate Analysis.
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1–47.
&lt;doi:10.18637/jss.v032.i03&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(rrcov)
data(bush10)
CovNASest(bush10)

## the following four statements are equivalent
c0 &lt;- CovNASest(bush10)
c1 &lt;- CovNASest(bush10, bdp = 0.25)
c2 &lt;- CovNASest(bush10, control = CovControlSest(bdp = 0.25))
c3 &lt;- CovNASest(bush10, control = new("CovControlSest", bdp = 0.25))

## direct specification overrides control one:
c4 &lt;- CovNASest(bush10, bdp = 0.40,
             control = CovControlSest(bdp = 0.25))
c1
summary(c1)

## Use the SURREAL algorithm of Ruppert
cr &lt;- CovNASest(bush10, method="surreal")
cr

## Use Bisquare estimation
cr &lt;- CovNASest(bush10, method="bisquare")
cr

## Use Rocke type estimation
cr &lt;- CovNASest(bush10, method="rocke")
cr


</code></pre>


</div>