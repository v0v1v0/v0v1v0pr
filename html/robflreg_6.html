<div class="container">

<table style="width: 100%;"><tr>
<td>getPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional principal component analysis</h2>

<h3>Description</h3>

<p>This function is used to perform functional principal component analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getPCA(data, nbasis, ncomp, gp, emodel = c("classical", "robust"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An <code class="reqn">n \times p</code>-dimensional data matrix for functional data <code class="reqn">X(s)</code>, where <code class="reqn">n</code> denotes the sample size
and <code class="reqn">p</code> denotes the number of grid points for <code class="reqn">X(s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>An integer specifying the number of B-spline basis expansion functions used to approximate the functional principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>An integer specifying the number of functional principal components to be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp</code></td>
<td>
<p>A vector containing the grid points for the functional data for <code class="reqn">X(s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emodel</code></td>
<td>
<p>Method to be used for functional principal component decomposition. Possibilities are "classical" and "robust".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functional principal decomposition of a functional data <code class="reqn">X(s)</code> is given by </p>
<p style="text-align: center;"><code class="reqn">X(s) = \bar{X}(s) + \sum_{k=1}^K \xi_k \psi_k(s),</code>
</p>
<p> where <code class="reqn">\bar{X}(s)</code> is the mean function, <code class="reqn">\psi_k(s)</code> is the <code class="reqn">k</code>-th weight function, and <code class="reqn">\xi_k</code> is the corresponding principal component score which is given by </p>
<p style="text-align: center;"><code class="reqn">\xi_k = \int (X(s) - \bar{X}(s)) \psi_k(s) ds.</code>
</p>
<p> When computing the estimated functional principal components, first, the functional data is expressed by a set of B-spline basis expansion. Then, the functional principal components are equal to the principal components extracted from the matrix <code class="reqn">D \varphi^{1/2}</code>, where <code class="reqn">D</code> is the matrix of basis expansion coefficients and <code class="reqn">\varphi</code> is the inner product matrix of the basis functions, i.e., <code class="reqn">\varphi = \int \varphi(s) \varphi^\top(s) ds</code>. Finally, the <code class="reqn">k</code>-th weight function is given by <code class="reqn">\psi_k(s) = \varphi^{-1/2} a_k</code>, where <code class="reqn">a_k</code> is the <code class="reqn">k</code>-th eigenvector of the sample covariance matrix of <code class="reqn">D \varphi^{1/2}</code>.
</p>
<p>If <code>emodel = "classical"</code>, then, the standard functional principal component decomposition is used as given by
Ramsay and Dalzell (1991).
</p>
<p>If <code>emodel = "robust"</code>, then, the robust principal component algorithm of Hubert, Rousseeuw and Verboven (2002) is used.
</p>


<h3>Value</h3>

<p>A list object with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>PCAcoef</code></td>
<td>
<p>A functional data object for the eigenfunctions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCAscore</code></td>
<td>
<p>A matrix of principal component scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanScore</code></td>
<td>
<p>A functional data object for the mean function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs_basis</code></td>
<td>
<p>A functional data object for B-spline basis expansion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalbase</code></td>
<td>
<p>A matrix of the B-spline basis expansion functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>An integer denoting the computed number of functional principal components. If the input “<code>ncomp</code>” is NULL, then, the output <code>ncomp</code> equals to the number of functional principal components whose usage results in at least 95% explained variation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp</code></td>
<td>
<p>A vector containing the grid points for the functional data for <code class="reqn">X(s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emodel</code></td>
<td>
<p>A character vector denoting the method used for functional principal component decomposition.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ufuk Beyaztas and Han Lin Shang
</p>


<h3>References</h3>

<p>J. O. Ramsay and C. J. Dalzell (1991) "Some tools for functional data analysis (with discussion)", <em>Journal of the Royal Statistical Society: Series B</em>, <b>53</b>(3), 539-572.
</p>
<p>M. Hubert and P. J. Rousseeuw and S. Verboven (2002) "A fast robust method for principal components with applications to chemometrics", <em>Chemometrics and Intelligent Laboratory Systems</em>, <b>60</b>(1-2), 101-111.
</p>
<p>P. Filzmoser and H. Fritz and K Kalcher (2021) pcaPP: Robust PCA by Projection Pursuit, R package version 1.9-74, URL: https://cran.r-project.org/web/packages/pcaPP/index.html.
</p>
<p>J. L. Bali and G. Boente and D. E. Tyler and J.-L. Wang (2011) "Robust functional principal components: A projection-pursuit approach", <em>The Annals of Statistics</em>, <b>39</b>(6), 2852-2882.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sim.data &lt;- generate.ff.data(n.pred = 5, n.curve = 200, n.gp = 101)
Y &lt;- sim.data$Y
gpY &lt;- seq(0, 1, length.out = 101) # grid points
rob.fpca &lt;- getPCA(data = Y, nbasis = 20, ncomp = 4, gp = gpY, emodel = "robust")
</code></pre>


</div>