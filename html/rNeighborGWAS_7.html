<div class="container">

<table style="width: 100%;"><tr>
<td>nei_coval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating neighbor genotypic identity</h2>

<h3>Description</h3>

<p>A function to calculate neighbor genotypic identity, with a given reference scale and a degree of distance decay.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nei_coval(
  geno,
  smap,
  scale,
  alpha = Inf,
  kernel = c("exp", "gaussian"),
  grouping = rep(1, nrow(smap)),
  n_core = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geno</code></td>
<td>
<p>An individual x marker matrix. Bialleles (i.e., A or a) must be converted into -1 or 1 digit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smap</code></td>
<td>
<p>A matrix showing a spatial map for individuals. The first and second column include spatial points along an x-axis and y-axis, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A numeric scalar indicating the maximum spatial distance between a focal individual and neighbors to define neighbor effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>An option to set a distance decay coefficient <code class="reqn">\alpha</code> in a dispersal kernel. Default is set at Inf, meaning no distance decay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>An option to select either <code>"exp"</code> or <code>"gaussian"</code> for a negative exponential kernel or Gaussian kernel, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>A positive integer vector assigning each individual to a group. This argument can be useful when a "smap" contains different experimental replicates. Default setting means that all individuals are belong to a single group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_core</code></td>
<td>
<p>No. of cores for a multi-core computation. This does not work for Windows OS. Default is a single-core computation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Default setting is recommended for <code>alpha</code> and <code>kernel</code> arguments unless spatial distance decay of neighbor effects needs to be modeled.
If <code>alpha</code> is not <code>Inf</code>, output variables are weighted by a distance decay from a focal individual to <code>scale</code>.
For the type of dispersal kernel in the distance decay, we can choose a negative exponential or Gaussian kernel as a fat-tailed or thin-tailed distribution, respectively.
See Nathan et al. (2012) for detailed characteristics of the two dispersal kernels.
</p>


<h3>Value</h3>

<p>A numeric matrix for neighbor covariates, with no. of individuals x markers.
</p>


<h3>Author(s)</h3>

<p>Yasuhiro Sato (<a href="mailto:sato.yasuhiro.36c@kyoto-u.jp">sato.yasuhiro.36c@kyoto-u.jp</a>)
</p>


<h3>References</h3>

<p>Nathan R, Klein E, Robledo-Arnuncio JJ, Revilla E. (2012) Dispersal kernels: review. In: Clobert J, Baguette M, Benton TG, Bullock JM (Eds.), <em>Dispersal Ecology and Evolution</em>. Oxford University Press, pp.186-210.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
g &lt;- matrix(sample(c(-1,1),100*1000,replace = TRUE),100,1000)
gmap &lt;- cbind(c(rep(1,nrow(g)/2),rep(2,nrow(g)/2)),c(1:ncol(g)))
x &lt;- runif(nrow(g),1,100)
y &lt;- runif(nrow(g),1,100)
smap &lt;- cbind(x,y)
grouping &lt;- c(rep(1,nrow(g)/2), rep(2,nrow(g)/2))

g_nei &lt;- nei_coval(g,smap,44,grouping = grouping)
</code></pre>


</div>