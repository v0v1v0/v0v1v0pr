<div class="container">

<table style="width: 100%;"><tr>
<td>MEAsmooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moving average smoothing for motion energy data</h2>

<h3>Description</h3>

<p>This function applies a moving average filter, based on SAS "proc expand" procedure. The moving average is applied independently on each subject's motion energy data.
NA values are set to 0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MEAsmooth(mea, moving.average.win = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mea</code></td>
<td>
<p>an object of class <code>MEA</code> or a list of <code>MEA</code> objects (see function <code>readMEA</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moving.average.win</code></td>
<td>
<p>numeric. The size of the filter window, in seconds or fractions of seconds.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The filtered object(s)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## read the first 4 minutes of the normal sample
##   (intake interviews of patients that carried on therapy)
path_normal &lt;- system.file("extdata/normal", package = "rMEA")
mea_raw &lt;- readMEA(path_normal, sampRate = 25, s1Col = 1, s2Col = 2,
                     s1Name = "Patient", s2Name = "Therapist",
                     idOrder = c("id","session"), idSep="_", skip=1, nrow = 6000)

## filter with moving average
mea_filter = MEAsmooth(mea_raw)

## assign groups names
mea_raw &lt;- setGroup(mea_raw, "raw")
mea_filter &lt;- setGroup(mea_filter, "filtered")

## Compute ccf
mea_raw &lt;- MEAccf(mea_raw, lagSec = 5, winSec = 60, incSec = 30, r2Z = TRUE, ABS = FALSE)
mea_filter &lt;- MEAccf(mea_filter, lagSec = 5, winSec = 60, incSec = 30, r2Z = TRUE, ABS = FALSE)

## Compare the effect of filtering on ccf
MEAlagplot(mea_filter, contrast = mea_raw)

</code></pre>


</div>