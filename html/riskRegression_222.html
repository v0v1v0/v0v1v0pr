<div class="container">

<table style="width: 100%;"><tr>
<td>transformCIBP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Confidence Intervals/Bands and P-values After a Transformation</h2>

<h3>Description</h3>

<p>Compute confidence intervals/bands and p-values after a transformation
</p>


<h3>Usage</h3>

<pre><code class="language-R">transformCIBP(
  estimate,
  se,
  iid,
  null,
  conf.level,
  alternative,
  ci,
  type,
  min.value,
  max.value,
  band,
  method.band,
  n.sim,
  seed,
  p.value,
  df = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>[numeric matrix] the estimate value before transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>[numeric matrix] the standard error before transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iid</code></td>
<td>
<p>[numeric array] the iid decomposition before transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>[numeric] the value of the estimate (before transformation) under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>[numeric, 0-1] Level of confidence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>[character] a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code> or <code>"less"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>[logical] should confidence intervals be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>[character] the transforamtion.
Can be <code>"log"</code>, <code>"loglog"</code>, <code>"cloglog"</code>, or <code>"atanh"</code> (Fisher transform), or <code>"atanh2"</code> (modified Fisher transform for [0-1] variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.value</code></td>
<td>
<p>[numeric] if not <code>NULL</code> and the lower bound of the confidence interval is below <code>min</code>,
it will be set at <code>min</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.value</code></td>
<td>
<p>[numeric] if not <code>NULL</code> and the lower bound of the confidence interval is below <code>max</code>,
it will be set at <code>max</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band</code></td>
<td>
<p>[integer 0,1,2] When non-0, the confidence bands are computed for each contrasts (<code>band=1</code>) or over all contrasts (<code>band=2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.band</code></td>
<td>
<p>[character] method used to adjust for multiple comparisons.
Can be any element of <code>p.adjust.methods</code> (e.g. <code>"holm"</code>), <code>"maxT-integration"</code>, or <code>"maxT-simulation"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>[integer, &gt;0] the number of simulations used to compute the quantiles for the confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>[integer, &gt;0] seed number set before performing simulations for the confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>[logical] should p-values and adjusted p-values be computed. Only active if <code>ci=TRUE</code> or <code>band&gt;0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>[integer, &gt;0] optional. Degrees of freedom used for the student distribution of the test statistic. If not specified, use a normal distribution instead.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The iid decomposition must have dimensions [n.obs,time,n.prediction]
while estimate and se must have dimensions [n.prediction,time].
</p>
<p>Single step max adjustment for multiple comparisons, i.e. accounting for the correlation between the test statistics but not for the ordering of the tests, can be performed setting the arguemnt <code>method.band</code> to <code>"maxT-integration"</code> or <code>"maxT-simulation"</code>. The former uses numerical integration (<code>pmvnorm</code> and <code>qmvnorm</code> to perform the adjustment while the latter using simulation. Both assume that the test statistics are jointly normally distributed.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(10)
n &lt;- 100
X &lt;- rnorm(n)

res2sided &lt;- transformCIBP(estimate = mean(X), se = cbind(sd(X)/sqrt(n)), null = 0,
              type = "none", ci = TRUE, conf.level = 0.95, alternative = "two.sided",
              min.value = NULL, max.value = NULL, band = FALSE,
              p.value = TRUE, seed = 10, df = n-1)

resLess &lt;- transformCIBP(estimate = mean(X), se = cbind(sd(X)/sqrt(n)), null = 0,
              type = "none", ci = TRUE, conf.level = 0.95, alternative = "less",
              min.value = NULL, max.value = NULL, band = FALSE,
              p.value = TRUE, seed = 10, df = n-1)

resGreater &lt;- transformCIBP(estimate = mean(X), se = cbind(sd(X)/sqrt(n)), null = 0,
              type = "none", ci = TRUE, conf.level = 0.95, alternative = "greater",
              min.value = NULL, max.value = NULL, band = FALSE,
              p.value = TRUE, seed = 10, df = n-1)


## comparison with t-test
GS &lt;- t.test(X, alternative = "two.sided")
res2sided$p.value - GS$p.value
unlist(res2sided[c("lower","upper")]) - GS$conf.int

GS &lt;- t.test(X, alternative = "less")
resLess$p.value - GS$p.value
unlist(resLess[c("lower","upper")]) - GS$conf.int

GS &lt;- t.test(X, alternative = "greater")
resGreater$p.value - GS$p.value
unlist(resGreater[c("lower","upper")]) - GS$conf.int

</code></pre>


</div>