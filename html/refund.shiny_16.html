<div class="container">

<table style="width: 100%;"><tr>
<td>plot_shiny</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot_shiny The generic function for interactive plots of functional data analyses</h2>

<h3>Description</h3>

<p>Interactive Plotting for Functional Data
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_shiny(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>object to be plotted. Currently, allowed data types are <code>fpca</code> <code>mfpca</code> <code>lfpca</code> and <code>fosr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to plotting functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function for interactive plotting of functional data analysis results.
</p>
<p>This package builds on the <code>refund</code> package: tools in <code>refund</code> are used to
conduct analyses and functions in this package create interactive visualizations of the results
of those analyses. There are four major categories of analyses that can be viewed:
</p>

<ol>
<li>
<p>Functional principal components analyses implemented by <code>fpca.sc</code>, <code>fpca.face</code>,
<code>fpca.ssvd</code>, and <code>fpca2s</code>. Plots show the mean +/- 2SD times each FPC; scree plots;
linear combinations of score values and FPCs; reconstructions for each subject; and score scatterplots.
</p>
</li>
<li>
<p>Function-on-scalar regression analyses implemented by <code>bayes_fosr</code>. Plots show the raw data
colored by covariate values; fitted values depending on covariates; coefficient functions; and residuals.
</p>
</li>
<li>
<p>Multilevel functional principal components analyses implemented by <code>mfpca.sc</code>.  Plots show the
mean +/- 2SD times each FPC; scree plots; linear combinations of score values and FPCs;
reconstructions for each subject; and score scatterplots for levels 1 and 2.
#' </p>
</li>
<li>
<p>Longitudinal functional principal components analyses
</p>
</li>
</ol>
<h3>Value</h3>

<p>This function outputs a shiny app based on the class of the input object.
</p>


<h3>Author(s)</h3>

<p>Jeff Goldsmith <a href="mailto:jeff.goldsmith@columbia.edu">jeff.goldsmith@columbia.edu</a>,
Julia Wrobel <a href="mailto:julia.wrobel@cuanschutz.edu">julia.wrobel@cuanschutz.edu</a>
</p>


<h3>See Also</h3>

<p><code>plot_shiny.fpca</code>, <code>plot_shiny.mfpca</code>,  <code>plot_shiny.fosr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
library(dplyr)
##### FPCA Example on real data #####

data(cd4)
SC = fpca.sc(cd4)
plot_shiny(SC)


##### FoSR Example #####

data(DTI)
DTI = DTI[complete.cases(DTI),]
fit.fosr = refund::bayes_fosr(cca ~ pasat + sex, data = DTI)
plot_shiny(fit.fosr)

##### FoSR Example with outliers #####

DTI$cca[1,] = DTI$cca[1,] + .4
DTI$cca[2,] = DTI$cca[2,] + .4

fosr.dti2 = bayes_fosr(cca ~ pasat + sex, data = DTI)
plot_shiny(fosr.dti2)

##### Longitudinal FoSR Examples #####

data(DTI2)
class(DTI2$cca) = class(DTI2$cca)[-1]
DTI2 = subset(DTI2, select = c(cca, id, pasat))
DTI2 = DTI2[complete.cases(DTI2),]

fosr.dti3 = bayes_fosr(cca ~ pasat + re(id), data = DTI2, Kt = 10, Kp = 4, cov.method = "FPCA")
plot_shiny(fosr.dti3)
plot_shiny(fosr.dti3$fpca.obj)

##### LFPCA Example on real data #####

data(DTI)
MS &lt;- subset(DTI, case ==1)  # subset data with multiple sclerosis (MS) case

index.na &lt;- which(is.na(MS$cca))
Y &lt;- MS$cca; Y[index.na] &lt;- fpca.sc(Y)$Yhat[index.na]; sum(is.na(Y))
id &lt;- MS$ID
visit.index &lt;- MS$visit
visit.time &lt;- MS$visit.time/max(MS$visit.time)

lfpca.dti1 &lt;- fpca.lfda(Y = Y, subject.index = id,
                       visit.index = visit.index, obsT = visit.time,
                       LongiModel.method = 'lme',
                       mFPCA.pve = 0.95)
plot_shiny(lfpca.dti1)

lfpca.dti2 &lt;- fpca.lfda(Y = Y, subject.index = id,
                       visit.index = visit.index, obsT = visit.time,
                       LongiModel.method = 'fpca.sc',
                       mFPCA.pve = 0.80, sFPCA.pve = 0.80)
plot_shiny(lfpca.dti2)

## End(Not run)


</code></pre>


</div>