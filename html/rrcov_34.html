<div class="container">

<table style="width: 100%;"><tr>
<td>CovMcd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Robust Location and Scatter Estimation via MCD </h2>

<h3>Description</h3>

<p>Computes a robust multivariate location and scatter estimate with a high
breakdown point, using the ‘Fast MCD’ (Minimum Covariance
Determinant) estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CovMcd(x,
       raw.only=FALSE, alpha=control@alpha, nsamp=control@nsamp,
       scalefn=control@scalefn, maxcsteps=control@maxcsteps,
       initHsets=NULL, save.hsets=FALSE,
       seed=control@seed, trace=control@trace,
       use.correction=control@use.correction,
       control=CovControlMcd(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.only</code></td>
<td>
<p>should only the “raw” estimate be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric parameter controlling the size of the subsets
over which the determinant is minimized, i.e., <code>alpha*n</code>
observations are used for computing the determinant.  Allowed values
are between 0.5 and 1 and the default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p> number of subsets used for initial estimates or <code>"best"</code>,
<code>"exact"</code> or <code>"deterministic"</code>.  Default is <code>nsamp = 500</code>.
For <code>nsamp="best"</code> exhaustive enumeration is done, as long as the
number of trials does not exceed 5000. For <code>"exact"</code>,
exhaustive enumeration will be attempted however many samples are
needed.  In this case a warning message will be displayed saying
that the computation can take a very long time.
</p>
<p>For <code>"deterministic"</code>, the <em>deterministic</em> MCD is computed; as
proposed by Hubert et al. (2012) it starts from the <code class="reqn">h</code> most
central observations of <em>six</em> (deterministic) estimators.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalefn</code></td>
<td>
<p><code>function</code> to compute a robust scale
estimate or character string specifying a rule determining such a
function, see <code>rrcov.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcsteps</code></td>
<td>
<p>maximal number of concentration steps in the
deterministic MCD; should not be reached.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initHsets</code></td>
<td>
<p>NULL or a <code class="reqn">K x h</code> integer matrix of initial
subsets of observations of size <code class="reqn">h</code> (specified by the indices in
<code>1:n</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.hsets</code></td>
<td>
<p>(for deterministic MCD) logical indicating if the
initial subsets should be returned as <code>initHsets</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>starting value for random generator. Default is <code>seed = NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>whether to print intermediate results. Default is <code>trace = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.correction</code></td>
<td>
<p> whether to use finite sample correction factors.
Default is <code>use.correction=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> a control object (S4) of class <code>CovControlMcd-class</code>
containing estimation options - same as these provided in the function
specification. If the control object is supplied, the parameters from it
will be used. If parameters are passed also in the invocation statement, they will
override the corresponding elements of the control object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments passed to <span class="pkg">robustbase</span>'s
<code>covMcd</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes the minimum covariance determinant estimator
of location and scatter and returns an S4 object of class
<code>CovMcd-class</code> containing the estimates.
The implementation of the function is similar to the existing <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function
<code>covMcd()</code> which returns an S3 object.
The MCD method looks for the <code class="reqn">h (&gt; n/2)</code>
observations (out of <code class="reqn">n</code>) whose classical
covariance matrix has the lowest possible determinant.  The raw MCD
estimate of location is then the average of these <code class="reqn">h</code> points,
whereas the raw MCD estimate of scatter is their covariance matrix,
multiplied by a consistency factor and a finite sample correction factor
(to make it consistent at the normal model and unbiased at small samples).
Both rescaling factors are returned also in the vector <code>raw.cnp2</code>
of length 2. Based on these raw MCD estimates, a reweighting step is performed
which increases the finite-sample efficiency considerably - see Pison et al. (2002).
The rescaling factors for the reweighted estimates are returned in the
vector <code>cnp2</code> of length 2. Details for the computation of the finite
sample correction factors can be found in Pison et al. (2002).
The finite sample corrections can be suppressed by setting <code>use.correction=FALSE</code>.
The implementation in rrcov uses the Fast MCD algorithm of Rousseeuw and Van Driessen (1999)
to approximate the minimum covariance determinant estimator.
</p>


<h3>Value</h3>

<p>An S4 object of class <code>CovMcd-class</code> which is a subclass of the
virtual class <code>CovRobust-class</code>.
</p>


<h3>Author(s)</h3>

<p> Valentin Todorov <a href="mailto:valentin.todorov@chello.at">valentin.todorov@chello.at</a>
</p>


<h3>References</h3>

<p>P. J. Rousseeuw and A. M. Leroy (1987)
<em>Robust Regression and Outlier Detection.</em> Wiley.
</p>
<p>P. J. Rousseeuw and K. van Driessen (1999)
A fast algorithm for the minimum covariance determinant estimator.
<em>Technometrics</em> <b>41</b>, 212–223.
</p>
<p>M. Hubert, P. Rousseeuw and T. Verdonck (2012) A deterministic algorithm
for robust location and scatter.
<em>Journal of Computational and Graphical Statistics</em> <b>21</b>(3), 618–637.
</p>
<p>Pison, G., Van Aelst, S., and Willems, G. (2002),
Small Sample Corrections for LTS and MCD,
<em>Metrika</em>, <b>55</b>, 111-123.
</p>
<p>Todorov V &amp; Filzmoser P (2009), An Object Oriented Framework for Robust Multivariate Analysis. 
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1–47.
<a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>.
</p>


<h3>See Also</h3>

<p><code>cov.rob</code> from package <span class="pkg">MASS</span>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(hbk)
hbk.x &lt;- data.matrix(hbk[, 1:3])
CovMcd(hbk.x)
cD &lt;- CovMcd(hbk.x, nsamp = "deterministic")
summary(cD)

## the following three statements are equivalent
c1 &lt;- CovMcd(hbk.x, alpha = 0.75)
c2 &lt;- CovMcd(hbk.x, control = CovControlMcd(alpha = 0.75))
## direct specification overrides control one:
c3 &lt;- CovMcd(hbk.x, alpha = 0.75,
             control = CovControlMcd(alpha=0.95))
c1
</code></pre>


</div>