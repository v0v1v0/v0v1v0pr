<div class="container">

<table style="width: 100%;"><tr>
<td>plotTrend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical representation of search.trend results</h2>

<h3>Description</h3>

<p>This function generates customized functions to produce plots of
phenotype versus time and absolute evolutionary rates versus time
regressions for the entire phylogeny and individual clades. Each custom
function takes as first argument the index or name of the variable (as in
the <code>search.trend</code> output in <code>$trends.data$phenotypeVStime</code>) to be
plotted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotTrend(ST)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>ST</code></td>
<td>
<p>an object produced by <code>search.trend</code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>The function returns a list of functions:
</p>
<p><strong><code>$plotSTphen</code></strong> returns the plot of rescaled phenotype versus age
regression. The 95% confidence intervals of slopes produced by regressing
phenotypes simulated under the Brownian motion are plotted as a polygon. The
usage is
<code>...$plotSTphen(variable,plot.args=NULL,polygon.args=NULL,line.args=NULL)</code>,
where <code>variable</code> is the index or name of the variable to be plotted,
<code>plot.args</code> is a list of further arguments passed to the function
<code>plot</code>, <code>polygon.args</code> is a list of further arguments passed to
the function <code>polygon</code>, and <code>line.args</code> is a list of further
arguments passed to the function <code>lines</code>. The functions automatically
plots white points for internal nodes, red points for tips, a blue
regression line, and a gray shaded polygon to represent the 95% confidence
intervals of Brownian motion slopes.
</p>
<p><strong><code>$plotSTrates</code></strong> returns the plot of log rescaled rates versus age
regression. The 95% confidence intervals of slopes produced by regressing
rates simulated under the Brownian motion are plotted as a shaded area. The
arguments are the same as described for <code>$plotSTphen</code>. In the case of
multivariate <code>y</code>, the 2-norm vector of multiple rates (see
<code>RRphylo</code> for details) can be plotted by setting <code>variable
 = "rate"</code> or <code>variable = </code> the number of actual variables + 1.
</p>
<p><strong><code>$plotSTphenNode</code></strong> returns plots of rescaled phenotype versus age
regression for individual clades. The usage is
<code>...$plotSTphenNode(variable,node,plot.args=NULL,lineTree.args=NULL,</code>
<code>lineNode.args=NULL,node.palette=NULL)</code>, where <code>variable</code> is the
same as <code>plotSTphen</code> and <code>node</code> is the vector of indices or numbers
(as inputted to <code>search.trend</code>, to be indicated as character) of nodes
to be plotted. The function allows up to nine nodes at the same time.
<code>plot.args</code> is a list of further arguments passed to the function
<code>plot</code>, including <code>pch.node</code>, a custom argument to set individual
<code>pch</code> at nodes (its length can be one or as long as the number of
nodes). <code>lineTree.args</code> is a list of further arguments passed to the
function <code>lines</code> used to plot the regression line for the entire tree
<code>lineNode.args</code> is a list of further arguments passed to the function
<code>lines</code> used to plot the regression line for individual nodes.
<code>node.palette</code> is the vector of colors specific to nodes points and
lines. Its length can be one or as long as the number of nodes.
</p>
<p><strong><code>$plotSTratesNode</code></strong> returns plots of absolute rates versus age
regression for individual clades. The arguments are the same as described
for <code>$plotSTphenNode</code>. In the case of multivariate <code>y</code>, the 2-norm
vector of multiple rates (see <code>RRphylo</code> for details) can be
plotted by setting <code>variable = "rate"</code> or <code>variable = </code> the number
of actual variables + 1.
</p>


<h3>Author(s)</h3>

<p>Silvia Castiglione, Carmela Serio
</p>


<h3>References</h3>

<p>Castiglione, S., Serio, C., Mondanaro, A., Di Febbraro, M.,
Profico, A., Girardi, G., &amp; Raia, P. (2019) Simultaneous detection of
macroevolutionary patterns in phenotypic means and rate of change with and
within phylogenetic trees including extinct species. <em>PLoS ONE</em>, 14:
e0210101. https://doi.org/10.1371/journal.pone.0210101
</p>


<h3>See Also</h3>

<p><a href="../doc/search.trend.html"><code>search.trend</code> vignette</a>
</p>
<p><a href="../doc/Plotting-tools.html"><code>plotTrend</code> vignette</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
data("DataOrnithodirans")
DataOrnithodirans$treedino-&gt;treedino
DataOrnithodirans$massdino-&gt;massdino
cc&lt;- 2/parallel::detectCores()

# Extract Pterosaurs tree and data
library(ape)
extract.clade(treedino,746)-&gt;treeptero
massdino[match(treeptero$tip.label,names(massdino))]-&gt;massptero
massptero[match(treeptero$tip.label,names(massptero))]-&gt;massptero

RRphylo(tree=treeptero,y=log(massptero),clus=cc)-&gt;RRptero

search.trend(RR=RRptero, y=log(massptero), nsim=100, node=143, clus=cc,cov=NULL)-&gt;ST

plotTrend(ST)-&gt;plotST

plotST$plotSTphen(1) # to plot phenotypic trend through time for entire tree
plotST$plotSTphen("log(massptero)",plot.args=list(cex=1.2,col="blue")) # equivalent to above

plotST$plotSTrates(1) # to plot rates trend through time for entire tree

# to plot phenotypic trend through time for the clade
plotST$plotSTphenNode("log(massptero)",plot.args=list(xlab="Age",main="Phenotypic trend"),
                    lineTree.args=list(lty=1,col="pink"),lineNode.args=list(lwd=3),
                    node.palette=c("chartreuse"))

# to plot rates trend through time for the clade
plotST$plotSTratesNode("rate")

   
## End(Not run)
</code></pre>


</div>