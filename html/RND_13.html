<div class="container">

<table style="width: 100%;"><tr>
<td>extract.ew.density</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Edgeworth Based Density</h2>

<h3>Description</h3>

<p><code>ew.extraction</code> extracts the parameters for the density approximated by the Edgeworth expansion method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extract.ew.density(initial.values = c(NA, NA, NA), r, y, te, s0, market.calls, 
  call.strikes, call.weights = 1, lambda = 1, hessian.flag = F, 
  cl = list(maxit = 10000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>initial.values</code></td>
<td>
<p>initial values for the optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>risk free rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>dividend yield</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>te</code></td>
<td>
<p>time to expiration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>
<p>current asset value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>market.calls</code></td>
<td>
<p>market calls (most expensive to cheapest)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call.strikes</code></td>
<td>
<p>strikes for the calls (smallest to largest)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call.weights</code></td>
<td>
<p>weights to be used for calls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Penalty parameter to enforce the martingale condition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian.flag</code></td>
<td>
<p>if F, no hessian is produced</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>list of parameter values to be passed to the optimization function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>initial.values</code> are not specified then the function will attempt to pick them
automatically.  <code>cl</code> in form of a list can be used to pass parameters to the <code>optim</code>
function.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigma </code></td>
<td>
<p>volatility of the underlying lognormal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew </code></td>
<td>
<p>normalized skewness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kurt </code></td>
<td>
<p>normalized kurtosis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge.result </code></td>
<td>
<p>Did the result converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p> Hessian matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kam Hamidieh</p>


<h3>References</h3>

<p>E. Jondeau and S. Poon and M. Rockinger (2007):
<em>Financial Modeling Under Non-Gaussian Distributions</em> 
Springer-Verlag, London
</p>
<p>R. Jarrow and A. Rudd (1982)
Approximate valuation for arbitrary stochastic processes.
<em>Journal of Finanical Economics</em>, 10, 347-369
</p>
<p>C.J. Corrado and T. Su (1996)
S&amp;P 500 index option tests of Jarrow and Rudd's approximate option valuation formula.
<em>Journal of Futures Markets</em>, 6, 611-629
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#
#  ln.skew &amp; ln.kurt are the normalized skewness and kurtosis of a true lognormal.
#

r       = 0.05
y       = 0.03
s0      = 1000
sigma   = 0.25
te      = 100/365
strikes = seq(from=600, to = 1400, by = 1)
v       = sqrt(exp(sigma^2 * te) - 1)
ln.skew = 3 * v + v^3
ln.kurt = 16 * v^2 + 15 * v^4 + 6 * v^6 + v^8

#
# Now "perturb" the lognormal
#

new.skew = ln.skew * 1.50
new.kurt = ln.kurt * 1.50

#
# new.skew &amp; new.kurt should not be extracted.
# Note that weights are automatically set to 1.
#

market.calls      =  price.ew.option(r = r, te = te, s0 = s0, k=strikes, sigma=sigma, 
                     y=y, skew = new.skew, kurt = new.kurt)$call
ew.extracted.obj  =  extract.ew.density(r = r, y = y, te = te, s0 = s0, 
                     market.calls = market.calls, call.strikes = strikes, 
                     lambda = 1, hessian.flag = FALSE)
ew.extracted.obj
</code></pre>


</div>