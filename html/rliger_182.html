<div class="container">

<table style="width: 100%;"><tr>
<td>plotClusterGeneDot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make dot plot of gene expression in cell groups</h2>

<h3>Description</h3>

<p>This function produces dot plots. Each column represent a group
of cells specified by <code>groupBy</code>, each row is a gene specified by
<code>features</code>. The color of dots reflects mean of normalized expression of
specified genes in each cell group and sizes reflects the percentage of cells
expressing each gene in a group. We utilize
<a href="https://jokergoo.github.io/ComplexHeatmap-reference/book/index.html">ComplexHeatmap</a>
for simplified management of adding annotation and slicing subplots. This was
inspired by the implementation in
<a href="https://samuel-marsh.github.io/scCustomize/reference/Clustered_DotPlot.html">scCustomize</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotClusterGeneDot(
  object,
  features,
  groupBy = NULL,
  splitBy = NULL,
  featureScaleFunc = function(x) log2(10000 * x + 1),
  cellIdx = NULL,
  legendColorTitle = "Mean\nExpression",
  legendSizeTitle = "Percent\nExpressed",
  viridisOption = "magma",
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A liger object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Use a character vector of gene names to make plain dot plot
like a heatmap. Use a data.frame where the first column is gene names and
second column is a grouping variable (e.g. subset <code>runMarkerDEG</code> output)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupBy</code></td>
<td>
<p>The names of the columns in <code>cellMeta</code> slot storing
categorical variables. Expression data would be aggregated basing on these,
together with <code>splitBy</code>. Default uses default clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitBy</code></td>
<td>
<p>The names of the columns in <code>cellMeta</code> slot storing
categorical variables. Dotplot panel splitting would be based on these.
Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>featureScaleFunc</code></td>
<td>
<p>A function object applied to normalized data for
scaling the value for better visualization. Default <code>function(x)
log2(10000*x + 1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellIdx</code></td>
<td>
<p>Valid cell subscription. See <code>subsetLiger</code>.
Default <code>NULL</code> for using all cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendColorTitle</code></td>
<td>
<p>Title for colorbar legend. Default
<code>"Mean\nExpression"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendSizeTitle</code></td>
<td>
<p>Title for size legend. Default
<code>"Percent\nExpressed"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridisOption</code></td>
<td>
<p>Name of available viridis palette. See
<code>viridis</code>. Default <code>"magma"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Whether to show progress information. Mainly when
subsetting data. Default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional theme setting arguments passed to
<code>.complexHeatmapDotPlot</code> and heatmap setting arguments passed to
<code>Heatmap</code>. See Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>...</code>, please notice that arguments <code>colorMat</code>,
<code>sizeMat</code>, <code>featureAnnDF</code>, <code>cellSplitVar</code>, <code>cellLabels</code>
and <code>viridisOption</code> from <code>.complexHeatmapDotPlot</code> are
already occupied by this function internally. A lot of arguments from
<code>Heatmap</code> have also been occupied: <code>matrix,
name, heatmap_legend_param, rect_gp, col, layer_fun, km, border, border_gp,
column_gap, row_gap, cluster_row_slices, cluster_rows, row_title_gp,
row_names_gp, row_split, row_labels, cluster_column_slices, cluster_columns,
column_split, column_title_gp, column_title, column_labels, column_names_gp,
top_annotation</code>.
</p>


<h3>Value</h3>

<p><code>HeatmapList</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Use character vector of genes
features &lt;- varFeatures(pbmcPlot)[1:10]
plotClusterGeneDot(pbmcPlot, features = features)

# Use data.frame with grouping information, with more tweak on plot
features &lt;- data.frame(features, rep(letters[1:5], 2))
plotClusterGeneDot(pbmcPlot, features = features,
                   clusterFeature = TRUE, clusterCell = TRUE, maxDotSize = 6)
</code></pre>


</div>