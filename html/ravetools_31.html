<div class="container">

<table style="width: 100%;"><tr>
<td>design_filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Design a digital filter</h2>

<h3>Description</h3>

<p>Provides 'FIR' and 'IIR' filter options; default is 'FIR', see also
<code>design_filter_fir</code>; for 'IIR' filters, see
<code>design_filter_iir</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">design_filter(
  sample_rate,
  data = NULL,
  method = c("fir_kaiser", "firls", "fir_remez", "butter", "cheby1", "cheby2", "ellip"),
  high_pass_freq = NA,
  high_pass_trans_freq = NA,
  low_pass_freq = NA,
  low_pass_trans_freq = NA,
  passband_ripple = 0.1,
  stopband_attenuation = 40,
  filter_order = NA,
  ...,
  data_size = length(data)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample_rate</code></td>
<td>
<p>data sample rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data to be filtered, can be optional (<code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>filter method, options are <code>"fir"</code> (default),
<code>"butter"</code>, <code>"cheby1"</code>, <code>"cheby2"</code>, and <code>"ellip"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high_pass_freq, low_pass_freq</code></td>
<td>
<p>high-pass or low-pass frequency,
see <code>design_filter_fir</code> or <code>design_filter_iir</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high_pass_trans_freq, low_pass_trans_freq</code></td>
<td>
<p>transition bandwidths,
see <code>design_filter_fir</code> or <code>design_filter_iir</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>passband_ripple</code></td>
<td>
<p>allowable pass-band ripple in decibel; default is
<code>0.1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopband_attenuation</code></td>
<td>
<p>minimum stop-band attenuation (in decibel) at
transition frequency; default is <code>40</code> dB.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_order</code></td>
<td>
<p>suggested filter order; 'RAVE' may or may not adopt this
suggestion depending on the data and numerical feasibility</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to filter generator functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_size</code></td>
<td>
<p>used by 'FIR' filter design to determine maximum order,
ignored in 'IIR' filters; automatically derived from <code>data</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>data</code> is specified and non-empty, this function returns
filtered data via forward and backward <code>filtfilt</code>; if <code>data</code> is
<code>NULL</code>, then returns the generator function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

sample_rate &lt;- 200
t &lt;- seq(0, 10, by = 1 / sample_rate)
x &lt;- sin(t * 4 * pi) + sin(t * 20 * pi) +
  2 * sin(t * 120 * pi) + rnorm(length(t), sd = 0.4)

# ---- Using FIR ------------------------------------------------

# Low-pass filter
y1 &lt;- design_filter(
  data = x,
  sample_rate = sample_rate,
  low_pass_freq = 3, low_pass_trans_freq = 0.5
)

# Band-pass cheby1 filter 8-12 Hz with custom transition
y2 &lt;- design_filter(
  data = x,
  method = "cheby1",
  sample_rate = sample_rate,
  low_pass_freq = 12, low_pass_trans_freq = .25,
  high_pass_freq = 8, high_pass_trans_freq = .25
)

y3 &lt;- design_filter(
  data = x,
  sample_rate = sample_rate,
  low_pass_freq = 80,
  high_pass_freq = 30
)

oldpar &lt;- par(mfrow = c(2, 1),
              mar = c(3.1, 2.1, 3.1, 0.1))
plot(t, x, type = 'l', xlab = "Time", ylab = "",
     main = "Mixture of 2, 10, and 60Hz", xlim = c(0,1))
# lines(t, y, col = 'red')
lines(t, y3, col = 'green')
lines(t, y2, col = 'blue')
lines(t, y1, col = 'red')
legend(
  "topleft", c("Input", "Low: 3Hz", "Pass 8-12Hz", "Pass 30-80Hz"),
  col = c(par("fg"), "red", "blue", "green"), lty = 1,
  cex = 0.6
)

# plot pwelch
pwelch(x, fs = sample_rate, window = sample_rate * 2,
       noverlap = sample_rate, plot = 1, ylim = c(-100, 10))
pwelch(y1, fs = sample_rate, window = sample_rate * 2,
       noverlap = sample_rate, plot = 2, col = "red")
pwelch(y2, fs = sample_rate, window = sample_rate * 2,
       noverlap = sample_rate, plot = 2, col = "blue")
pwelch(y3, fs = sample_rate, window = sample_rate * 2,
       noverlap = sample_rate, plot = 2, col = "green")


# ---- Clean this demo --------------------------------------------------
par(oldpar)


</code></pre>


</div>