<div class="container">

<table style="width: 100%;"><tr>
<td>calc_co</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate canopy openness</h2>

<h3>Description</h3>

<p>Calculate canopy openness
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_co(bin, m = NULL, z, a, angle_width)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bin</code></td>
<td>
<p>SpatRaster. Binarized hemispherical canopy image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>SpatRaster. A mask. For hemispherical photographs,
check <code>mask_hs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>SpatRaster built with <code>zenith_image()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>SpatRaster built with <code>azimuth_image()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle_width</code></td>
<td>
<p>Numeric vector of length one. It should be <code style="white-space: pre;">⁠30, 15, 10, 7.5, 6, 5, 3.75, 3, 2.5, 1.875, 1⁠</code> or <code>0.5</code> degrees. This
constrain is rooted in the requirement of a value able to divide both the
<code>0</code> to <code>360</code> and <code>0</code> to <code>90</code> ranges into a whole number
of segments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Canopy openness calculated as in the equation from
Gonsamo et al. (2011):
</p>
<p><code class="reqn">CO = \sum_{i = 1}^{N} GF(\phi_i, \theta_i) \cdot [(cos(\theta_1) -
cos(\theta_2))/n]</code>,
</p>
<p>where <code class="reqn">GF(\phi_i, \theta_i)</code> is the gap fraction of the cell <code class="reqn">i</code>,
<code class="reqn">\theta_1</code> and <code class="reqn">\theta_2</code> are the minimum and maximum zenith angle of
the cell <code class="reqn">i</code>, <code class="reqn">n</code> is the number of cells on the ring delimited by
<code class="reqn">\theta_1</code> and <code class="reqn">\theta_2</code>, and <code class="reqn">N</code> is the total number of cells.
</p>
<p>When a mask is provided through the <code>m</code> argument, the equation is modified as
follow:
</p>
<p><code class="reqn">
\frac{
CO = \sum_{i = 1}^{N} GF(\phi_i, \theta_i) \cdot [(cos(\theta_1) -
cos(\theta_2))/n]
}{ \sum_{i = 1}^{N} (cos(\theta_1) - cos(\theta_2))/n}
</code>.
</p>
<p>This allows the masking of any individual cell.
</p>


<h3>Value</h3>

<p>Numeric vector of length one.
</p>


<h3>References</h3>

<p>Gonsamo A, Walter JN, Pellikka P (2011).
“CIMES: A package of programs for determining canopy geometry and solar radiation regimes through hemispherical photographs.”
<em>Computers and Electronics in Agriculture</em>, <b>79</b>(2), 207–215.
<a href="https://doi.org/10.1016/j.compag.2011.10.001">doi:10.1016/j.compag.2011.10.001</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">caim &lt;- read_caim()
z &lt;- zenith_image(ncol(caim), lens())
a &lt;- azimuth_image(z)
m &lt;- mask_hs(z, 0, 70)
bin &lt;- apply_thr(caim$Blue, thr_isodata(caim$Blue[m]))
plot(bin)
calc_co(bin, m, z, a, 10)

</code></pre>


</div>