<div class="container">

<table style="width: 100%;"><tr>
<td>ref.MCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC for Reference Prior on an Intrinsic Conditional Autoregressive Random Effects Model for Areal Data</h2>

<h3>Description</h3>

<p>Implements the Metropolis-within-Gibbs sampling algorithm proposed by Ferreira et al. (2021),
to perform posterior inference for the intrinsic conditional autoregressive model with spatial
random effects.  This algorithm uses the spectral domain for the hierarchical model to create the
Spectral Gibbs Sampler (SGS), which provides notable speedups to the MCMC algorithm proposed by Keefe et al (2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ref.MCMC(
  y,
  X,
  H,
  iters = 10000,
  burnin = 5000,
  verbose = TRUE,
  tauc.start = 1,
  beta.start = 1,
  sigma2.start = 1,
  step.tauc = 0.5,
  step.sigma2 = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of covariates.  This should include a column of 1's for models with a non-zero intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>The neighborhood matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>Number of MCMC iterations to perform.  Defaults to 10,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of MCMC iterations to discard as burn-in.  Defaults to 5,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If FALSE, MCMC progress is not printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauc.start</code></td>
<td>
<p>Starting value for the spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.start</code></td>
<td>
<p>Starting value for the vector of fixed effect regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2.start</code></td>
<td>
<p>Starting value for the variance of the unstructured random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.tauc</code></td>
<td>
<p>Step size for the spatial dependence parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.sigma2</code></td>
<td>
<p>Step size for the variance of the unstructured random effects.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing MCMC chains and parameter summaries.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MCMCchain</code></td>
<td>
<p>Matrix of MCMC chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauc.MCMC</code></td>
<td>
<p>MCMC chains for the spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2.MCMC</code></td>
<td>
<p>MCMC chains for the variance of the unstructured random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.MCMC</code></td>
<td>
<p>MCMC chains for the spatial random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.MCMC</code></td>
<td>
<p>MCMC chains for the fixed effect regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.sigma2</code></td>
<td>
<p>Final acceptance number for variance of the unstructured random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.tauc</code></td>
<td>
<p>Final acceptance number for spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.phi</code></td>
<td>
<p>Final acceptance number for spatial random effects.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Erica M. Porter, Matthew J. Keefe, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>References</h3>

<p>Keefe MJ, Ferreira MAR, Franck CT (2019).
“Objective Bayesian analysis for Gaussian hierarchical models with intrinsic conditional autoregressive priors.”
<em>Bayesian Analysis</em>, <b>14</b>(1), 181 – 209.
<a href="https://doi.org/10.1214/18-BA1107">doi:10.1214/18-BA1107</a>.
</p>
<p>Keefe MJ, Ferreira MAR, Franck CT (2018).
“On the formal specification of sum-zero constrained intrinsic conditional autoregressive models.”
<em>Spatial Statistics</em>, <b>24</b>, 54–65.
<a href="https://doi.org/10.1016/j.spasta.2018.03.007">doi:10.1016/j.spasta.2018.03.007</a>.
</p>
<p>Ferreira MAR, Porter EM, Franck CT (2021).
“Fast and scalable computations for Gaussian hierarchical models with intrinsic conditional autoregressive spatial random effects.”
<em>Computational Statistics and Data Analysis</em>, <b>162</b>, 107264.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107264">doi:10.1016/j.csda.2021.107264</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321000980">https://www.sciencedirect.com/science/article/pii/S0167947321000980</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### Fit the model for simulated areal data on a grid ####

### Load extra libraries
library(sp)
library(methods)
library(spdep)
library(mvtnorm)

### Generate areal data on a grid
rows=5; cols=5
tauc=1
sigma2=2; beta=c(1,5)

### Create grid
grid &lt;- GridTopology(c(1,1), c(1,1), c(cols,rows))
polys &lt;- as(grid, "SpatialPolygons")
spgrid &lt;- SpatialPolygonsDataFrame(polys,data=data.frame(row.names=row.names(polys)))

### Create neighborhood matrix
grid.nb &lt;- poly2nb(spgrid,queen=FALSE)
W &lt;- nb2mat(grid.nb, style="B")

### Put spatially correlated data in grid
p &lt;- length(beta)
num.reg &lt;- (rows*cols)
if(p&gt;1){x1&lt;-rmvnorm(n=num.reg,mean=rep(0,p-1),sigma=diag(p-1))} else{x1&lt;-NULL}
X &lt;- cbind(rep(1,num.reg),x1)
Dmat &lt;- diag(apply(W,1,sum))
H &lt;- Dmat - W
row.names(H) &lt;- NULL

### Obtain true response vector
theta_true &lt;- rnorm(num.reg,mean=0,sd=sqrt(sigma2))
Q &lt;- eigen(H,symmetric=TRUE)$vectors
eigH &lt;- eigen(H,symmetric=TRUE)$values
D &lt;- diag(eigH)
Qmat &lt;- Q[,1:(num.reg-1)]
phimat &lt;- diag(1/sqrt(eigH[1:(num.reg-1)]))
z &lt;- t(rmvnorm(1,mean=rep(0,num.reg-1),sigma=diag(num.reg-1)))
phi_true &lt;- sqrt((1/tauc)*sigma2)*(Qmat%*%phimat%*%z)
Y &lt;- X%*%beta + theta_true + phi_true

### Fit the model
set.seed(5432)
model &lt;- ref.MCMC(y=Y,X=X,H=H,iters=15000,burnin=5000,verbose=TRUE,tauc.start=.1,beta.start=-1,
sigma2.start=.1,step.tauc=0.5,
      step.sigma2=0.5)
      

#### Small example for checking
model &lt;- ref.MCMC(y=Y,X=X,H=H,iters=1000,burnin=50,verbose=TRUE,tauc.start=.1,beta.start=-1,
sigma2.start=.1,step.tauc=0.5,
      step.sigma2=0.5)
</code></pre>


</div>