<div class="container">

<table style="width: 100%;"><tr>
<td>densiTreeWithBranchData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>DensiTree-style plot with branch-specific data</h2>

<h3>Description</h3>

<p>This function plots a distribution of trees (e.g obtained from an
MCMC inference) with branch-specific rates or other data.
The plot is similar to those produced by DensiTree, i.e all the trees are
overlapped with each other. The data is expected to be given per node,
and will be associated with the branch above its corresponding node.
Its values are plotted as a color gradient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">densiTreeWithBranchData(
  tree_files = NULL,
  burnin = 0.1,
  trees = NULL,
  data = NULL,
  data_name = NULL,
  type = "cladogram",
  consensus = NULL,
  direction = "rightwards",
  scaleX = FALSE,
  width = 1,
  lty = 1,
  cex = 0.8,
  font = 3,
  tip.color = 1,
  adj = 0,
  srt = 0,
  keep_underscores = FALSE,
  label_offset = 0.01,
  scale_bar = TRUE,
  jitter = list(amount = 0, random = TRUE),
  color_gradient = c("red", "yellow", "green"),
  alpha = NULL,
  bias = 1,
  data_intervals = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree_files</code></td>
<td>
<p>vector of tree files in NEXUS format with data attached
to the branches/nodes of the tree. All trees should have the same tip
labels (the order can change). Either <code>tree_files</code> or both
<code>trees</code> and <code>data</code> have to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>fraction of samples to discard from the tree files as burn-in.
Default 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>multiPhylo object or list of trees in phylo format.
All trees should have the same tip labels (the order can change). Either
<code>tree_files</code> or both <code>trees</code> and <code>data</code> have to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data to be plotted on the tree - expected to be a list of
vectors in the same order as the trees, each vector in the order of the
tips and nodes of the corresponding tree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_name</code></td>
<td>
<p>Only used when reading from <code>tree_files</code>.
Name of the data to be plotted, if multiple are present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string specifying the type of phylogeny.
Options are "cladogram" (default) or "phylogram".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consensus</code></td>
<td>
<p>A tree or character vector which is used to define
the order of the tip labels. If NULL will be calculated from the trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>a character string specifying the direction of the tree.
Options are "rightwards" (default), "leftwards", "upwards" and "downwards".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleX</code></td>
<td>
<p>whether to scale trees to have identical heights.
Default FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width of the tree edges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type of the tree edges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>a numeric value giving the factor scaling of the tip labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font</code></td>
<td>
<p>an integer specifying the type of font for the labels: 1
(plain text), 2 (bold), 3 (italic, the default), or 4 (bold italic).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.color</code></td>
<td>
<p>color of the tip labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>a numeric specifying the justification of the text strings of
the tip labels: 0 (left-justification), 0.5 (centering), or 1
(right-justification).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>srt</code></td>
<td>
<p>a numeric giving how much the labels are rotated in degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_underscores</code></td>
<td>
<p>whether the underscores in tip labels should be
written as spaces (the default) or left as they are (if TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_offset</code></td>
<td>
<p>a numeric giving the space between the nodes and the
tips of the phylogeny and their corresponding labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_bar</code></td>
<td>
<p>whether to add a scale bar to the plot. Default TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>controls whether to shift trees. a list with two arguments:
the amount of jitter and random or equally spaced (see details below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_gradient</code></td>
<td>
<p>range of colors to be used for the data, in order of
increasing values. Defaults to red to yellow to green.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>transparency parameter for tree colors. If NULL will be set
based on the number of trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias</code></td>
<td>
<p>bias applied to the color gradient. See
<code>colorRampPalette</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_intervals</code></td>
<td>
<p>value intervals used for the color gradient.
Can be given as a vector of interval boundaries or min and max values.If
NULL will be set based on the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no consensus tree is provided, a consensus tree will be computed.
This should avoid too many unnecessary crossings of edges.
Trees should be rooted, other wise the output may not be visually pleasing.
The <code>jitter</code> parameter controls whether to shift trees so that
they are not exactly on top of each other.
If <code>amount = 0</code>, no jitter is applied. If <code>random = TRUE</code>,
the applied jitter is calculated as <code>runif(n, -amount, amount)</code>,
otherwise <code>seq(-amount, amount, length=n)</code>, where <code>n</code>
is the number of trees.
</p>


<h3>Value</h3>

<p>No return value, produces plot in base R
</p>


<h3>References</h3>

<p>This code is adapted from the <code>densiTree</code>
function by Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>.
densiTree is inspired from the
<a href="https://www.cs.auckland.ac.nz/~remco/DensiTree/">DensiTree</a>
program by Remco Bouckaert.
</p>
<p>Remco R. Bouckaert (2010) DensiTree: making sense of sets of phylogenetic
trees <em>Bioinformatics</em>, <b>26 (10)</b>, 1372-1373.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# generate random trees &amp; data
trees &lt;- lapply(1:5, function(x) ape::rcoal(5))
data &lt;- lapply(1:5, function(x) stats::runif(9, 1, 10))

# densiTree plot
densiTreeWithBranchData(trees = trees, data = data, width = 2)

# densiTree plot with different colors
densiTreeWithBranchData(trees = trees, data = data,
                        color_gradient = c("green", "blue"), width = 2)

</code></pre>


</div>