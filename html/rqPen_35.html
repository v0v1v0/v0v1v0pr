<div class="container">

<table style="width: 100%;"><tr>
<td>rq.pen.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Does k-folds cross validation for rq.pen. If multiple values of a are specified then does a grid based search for best value of <code class="reqn">\lambda</code> and a.</h2>

<h3>Description</h3>

<p>Does k-folds cross validation for rq.pen. If multiple values of a are specified then does a grid based search for best value of <code class="reqn">\lambda</code> and a.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rq.pen.cv(
  x,
  y,
  tau = 0.5,
  lambda = NULL,
  penalty = c("LASSO", "Ridge", "ENet", "aLASSO", "SCAD", "MCP"),
  a = NULL,
  cvFunc = NULL,
  nfolds = 10,
  foldid = NULL,
  nlambda = 100,
  groupError = TRUE,
  cvSummary = mean,
  tauWeights = rep(1, length(tau)),
  printProgress = FALSE,
  weights = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Quantiles to be modeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Values of <code class="reqn">\lambda</code>. Default will automatically select the <code class="reqn">\lambda</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Choice of penalty between LASSO, Ridge, Elastic Net (ENet), Adaptive Lasso (aLASSO), SCAD and MCP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Tuning parameter of a. LASSO and Ridge has no second tuning parameter, but for notation is set to 1 or 0 respectively, the values for elastic net. Defaults are Ridge ()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvFunc</code></td>
<td>
<p>Loss function for cross-validation. Defaults to quantile loss, but user can specify their own function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>Ids for folds. If set will override nfolds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>Number of lambda, ignored if lambda is set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupError</code></td>
<td>
<p>If set to false then reported error is the sum of all errors, not the sum of error for each fold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvSummary</code></td>
<td>
<p>Function to summarize the errors across the folds, default is mean. User can specify another function, such as median.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauWeights</code></td>
<td>
<p>Weights for the different tau models. Only used in group tau results (gtr).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printProgress</code></td>
<td>
<p>If set to TRUE prints which partition is being worked on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weights for the quantile loss objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to rq.pen()</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two cross validation results are returned. One that considers the best combination of a and lambda for each quantile. The second considers the best combination of the tuning 
parameters for all quantiles. Let <code class="reqn">y_{b,i}</code>, <code class="reqn">x_{b,i}</code>, and <code class="reqn">m_{b,i}</code> index the response, predictors, and weights of observations in 
fold b. Let <code class="reqn">\hat{\beta}_{\tau,a,\lambda}^{-b}</code> be the estimator for a given quantile and tuning parameters that did not use the bth fold. Let <code class="reqn">n_b</code> be the number of observations in fold
b. Then the cross validation error for fold b is 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{CV}(b,\tau) = \frac{1}{n_b} \sum_{i=1}^{n_b} m_{b,i} \rho_\tau(y_{b,i}-x_{b,i}^\top\hat{\beta}_{\tau,a,\lambda}^{-b}).</code>
</p>

<p>Note that <code class="reqn">\rho_\tau()</code> can be replaced by a different function by setting the cvFunc parameter. The function returns two different cross-validation summaries. The first is btr, by tau results. 
It provides the values of <code>lambda</code> and <code>a</code> that minimize the average, or whatever function is used for <code>cvSummary</code>, of <code class="reqn">\mbox{CV}(b)</code>. In addition it provides the 
sparsest solution that is within one standard error of the minimum results. 
</p>
<p>The other approach is the group tau results, gtr. Consider the case of estimating Q quantiles of <code class="reqn">\tau_1,\ldots,\tau_Q</code> with quantile (tauWeights) of <code class="reqn">v_q</code>. The gtr returns the values of <code>lambda</code> and <code>a</code> that minimizes the average, or again whatever function is used for <code>cvSummary</code>, of 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{q=1}^Q v_q\mbox{CV}(b,\tau_q).</code>
</p>
<p> If only one quantile is modeled then the gtr results can be ignored as they provide the same minimum solution as btr.
</p>


<h3>Value</h3>

<p>An rq.pen.seq.cv object. 
</p>

<dl>
<dt>cverr:</dt>
<dd>
<p> Matrix of cvSummary function, default is average, cross-validation error for each model, tau and a combination, and lambda.</p>
</dd>
<dt>cvse:</dt>
<dd>
<p> Matrix of the standard error of cverr foreach model, tau and a combination, and lambda.</p>
</dd>
<dt>fit:</dt>
<dd>
<p> The rq.pen.seq object fit to the full data.</p>
</dd>
<dt>btr:</dt>
<dd>
<p> A data.table of the values of a and lambda that are best as determined by the minimum cross validation error and the one standard error rule, which fixes a. In btr the values of lambda and a are selected seperately for each quantile.</p>
</dd>
<dt>gtr:</dt>
<dd>
<p> A data.table for the combination of a and lambda that minimize the cross validation error across all tau.</p>
</dd>
<dt>gcve:</dt>
<dd>
<p> Group, across all quantiles, cross-validation error results for each value of a and lambda.</p>
</dd>
<dt>call:</dt>
<dd>
<p> Original call to the function.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Ben Sherwood, <a href="mailto:ben.sherwood@ku.edu">ben.sherwood@ku.edu</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
x &lt;- matrix(runif(800),ncol=8)
y &lt;- 1 + x[,1] + x[,8] + (1+.5*x[,3])*rnorm(100)
r1 &lt;- rq.pen.cv(x,y) #lasso fit for median
# Elastic net fit for multiple values of a and tau
r2 &lt;- rq.pen.cv(x,y,penalty="ENet",a=c(0,.5,1),tau=c(.25,.5,.75)) 
#same as above but more weight given to median when calculating group cross validation error. 
r3 &lt;- rq.pen.cv(x,y,penalty="ENet",a=c(0,.5,1),tau=c(.25,.5,.75),tauWeights=c(.25,.5,.25))
# uses median cross-validation error instead of mean.
r4 &lt;- rq.pen.cv(x,y,cvSummary=median)  
#Cross-validation with no penalty on the first variable.
r5 &lt;- rq.pen.cv(x,y,penalty.factor=c(0,rep(1,7)))

## End(Not run)
</code></pre>


</div>