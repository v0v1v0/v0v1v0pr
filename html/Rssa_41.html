<div class="container">

<table style="width: 100%;"><tr>
<td>grouping.auto.pgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Group elementary series using periodogram
</h2>

<h3>Description</h3>

<p>Group elementary components automatically using their frequency contributions 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S3 method for class '1d.ssa'
grouping.auto.pgram(x, groups,
             base = c("series", "eigen", "factor"),
             freq.bins = 2,
             threshold = 0,
             method = c("constant", "linear"),
             ...,
             drop = TRUE)
  ## S3 method for class 'grouping.auto.pgram'
plot(x, superpose, order, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>SSA object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>indices of elementary components for grouping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>input for periodogram: elementary reconstructed series, eigenvectors or factor vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.bins</code></td>
<td>
<p>single integer number &gt; 1 (the number of intervals),
vector of frequency breaks (of length &gt;=2) or list of frequency ranges.
For each range, if only one element provided it will
be used as the upper bound and the lower bound will be zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>contribution threshold. If zero then dependent grouping approach will be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method of periodogram interpolation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>superpose</code></td>
<td>
<p>logical, whether to plot contributions for all intervals on one panel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>logical, whether to reorder components by contribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>reconstruct</code> and
<code>xyplot</code> routines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>logical, whether to exclude empty groups from resulted list</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Elementary components are grouped using their frequency contribution (periodogram).
Optionally (see argument 'base') periodogram of eigen or factor vectors may be used.
</p>
<p>For each elementary component and for each frequency interval
(which are specified by 'freq.bins' argument)
relative (from 0 till 1) contribution
is computed using one of two methods:
'constant' (periodogram is considered as a sequence of separate bars)
or 'linear' (periodogram is linearly interpolated).
</p>
<p>Two approaches of grouping is implemented:
</p>

<dl>
<dt>'independent' or 'threshold'</dt>
<dd>
<p>Each group includes components
with frequency contribution in correspondent interval is greater than specified threshold;
resulted groups can intersect.
If 'threshold' is a vector, correspondent value of threshold will be using
for each interval. See Algorithm 2.16 in Golyandina et al (2018).</p>
</dd>
<dt>'dependent' or 'splitting'</dt>
<dd>
<p>Elementary components are separated to disjoint subsets;
for each component interval with the highest contribution is selected. 
See Algorithm 2.17 in Golyandina et al (2018)</p>
</dd>
</dl>
<p>If 'freq.bins' is named, result groups will take the same names.
</p>
<p>If drop = 'TRUE' (by default), empty groups will be excluded from result.
</p>
<p>See  Section 2.7 in Golyandina et al (2018) and the paper Alexandrov, Golyandina (2005) for the details of the algorithm.
</p>


<h3>Value</h3>

<p>object of class 'grouping.auto.pgram' (list of groups with some additional info) for grouping method;
'trellis' object for plot method.
</p>


<h3>References</h3>

<p>Golyandina N., Korobeynikov A., Zhigljavsky A. (2018):
<em>Singular Spectrum Analysis with R.</em>  Use R!.
Springer, Berlin, Heidelberg.
</p>
<p>Alexandrov, Th., Golyandina, N. (2005):
<em>Automatic extraction and forecast of time series cyclic components
within the framework of SSA.</em>
In Proceedings of the 5th St.Petersburg Workshop on Simulation,
June 26 – July 2, 2005, St.Petersburg State University, St.Petersburg, Pp. 45–50
<a href="https://www.gistatgroup.com/gus/autossa2.pdf">https://www.gistatgroup.com/gus/autossa2.pdf</a>
</p>


<h3>See Also</h3>

<p><code>Rssa</code> for an overview of the package, as well as,
<code>reconstruct</code>,
<code>rforecast</code>,
<code>vforecast</code>,
<code>parestimate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ss &lt;- ssa(co2)
  plot(ss, type = "vectors", idx = 1:12)
  plot(ss, type = "vectors", vectors = "factor", idx = 1:12)
  plot(ss, type = "series", groups = 1:12)

  g1 &lt;- grouping.auto(ss, base = "series", freq.bins = list(0.005), threshold = 0.95)
  g2 &lt;- grouping.auto(ss, base = "eigen", freq.bins = 2, threshold = 0)
  g3 &lt;- grouping.auto(ss, base = "factor", freq.bins = list(c(0.1), c(0.1, 0.2)), 
                      threshold = 0, method = "linear")
  g4 &lt;- grouping.auto(ss, freq.bins = c(0.1, 0.2), threshold = 0)

  g &lt;- grouping.auto(ss, freq.bins = 8, threshold = 0)
  plot(reconstruct(ss, groups = g))
  plot(g)

  g &lt;- grouping.auto(ss, freq.bins = list(0.1, 0.2, 0.3, 0.4, 0.5), threshold = 0.95)
  plot(reconstruct(ss, groups = g))
  plot(g)
</code></pre>


</div>