<div class="container">

<table style="width: 100%;"><tr>
<td>fgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional Generalized Additive Models</h2>

<h3>Description</h3>

<p>Implements functional generalized additive models for functional and scalar covariates and scalar responses.
Additionally implements functional linear models.  This function is a wrapper for mgcv's <code>[mgcv]{gam}</code>
and its siblings to fit models of the general form
</p>
<p style="text-align: center;"><code class="reqn">g(E(Y_i)) = \beta_0 + \int_{T_1} F(X_{i1},t)dt+ \int_{T_2} \beta(t)X_{i2}dt + f(z_{i1}) + f(z_{i2}, z_{i3}) + \ldots</code>
</p>

<p>with a scalar (but not necessarily continuous) response Y, and link function g
</p>


<h3>Usage</h3>

<pre><code class="language-R">fgam(formula, fitter = NA, tensortype = c("te", "t2"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula with special terms as for gam, with additional special terms
<code>{af}</code>(), <code>{lf}</code>(), <code>{re}</code>().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitter</code></td>
<td>
<p>the name of the function used to estimate the model. Defaults to <code>[mgcv]{gam}</code>
if the matrix of functional responses has less than 2e5 data points and to
<code>[mgcv]{bam}</code> if not. "gamm" (see <code>[mgcv]{gamm}</code>) and "gamm4"
(see <code>[gamm4]{gamm4}</code>) are valid options as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tensortype</code></td>
<td>
<p>defaults to <code>[mgcv]{te}</code>, other valid option is <code>[mgcv]{t2}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments that are valid for <code>[mgcv]{gam}</code> or <code>[mgcv]{bam}</code>; for example,
specify a <code>gamma</code> &gt; 1 to increase amount of smoothing when using GCV to choose smoothing
parameters or <code>method="REML"</code> to change to REML for estimation of smoothing parameters
(default is GCV).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a fitted fgam-object, which is a <code>{gam}</code>-object with some additional information
in a fgam-entry. If fitter is "gamm" or "gamm4", only the $gam part of the
returned list is modified in this way.
</p>


<h3>Warning</h3>

<p>Binomial responses should be specified as a numeric vector rather than as a matrix or a factor.
</p>


<h3>Author(s)</h3>

<p>Mathew W. McLean <a href="mailto:mathew.w.mclean@gmail.com">mathew.w.mclean@gmail.com</a> and Fabian Scheipl
</p>


<h3>References</h3>

<p>McLean, M. W., Hooker, G., Staicu, A.-M., Scheipl, F., and Ruppert, D. (2014). Functional
generalized additive models. <em>Journal of Computational and Graphical Statistics</em>, <b>23 (1)</b>,
pp. 249-269.
</p>


<h3>See Also</h3>

<p><code>{af}</code>, <code>{lf}</code>, <code>{predict.fgam}</code>, <code>{vis.fgam}</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DTI)
## only consider first visit and cases (no PASAT scores for controls)
y &lt;- DTI$pasat[DTI$visit==1 &amp; DTI$case==1]
X &lt;- DTI$cca[DTI$visit==1 &amp; DTI$case==1, ]
X_2 &lt;- DTI$rcst[DTI$visit==1 &amp; DTI$case==1, ]

## remove samples containing missing data
ind &lt;- rowSums(is.na(X)) &gt; 0
ind2 &lt;- rowSums(is.na(X_2)) &gt; 0

y &lt;- y[!(ind | ind2)]
X &lt;- X[!(ind | ind2), ]
X_2 &lt;- X_2[!(ind | ind2), ]

N &lt;- length(y)

## fit fgam using FA measurements along corpus callosum
## as functional predictor with PASAT as response
## using 8 cubic B-splines for marginal bases with third
## order marginal difference penalties
## specifying gamma &gt; 1 enforces more smoothing when using
## GCV to choose smoothing parameters
#fit &lt;- fgam(y ~ af(X, k = c(8, 8), m = list(c(2, 3), c(2, 3))), gamma = 1.2)


## fgam term for the cca measurements plus an flm term for the rcst measurements
## leave out 10 samples for prediction
test &lt;- sample(N, 10)
#fit &lt;- fgam(y ~ af(X, k = c(7, 7), m = list(c(2, 2), c(2, 2))) +
 #      lf(X_2, k=7, m = c(2, 2)), subset=(1:N)[-test])
#plot(fit)
## predict the ten left outs samples
#pred &lt;- predict(fit, newdata = list(X=X[test, ], X_2 = X_2[test, ]), type='response',
 #               PredOutOfRange = TRUE)
#sqrt(mean((y[test] - pred)^2))
## Try to predict the binary response disease status (case or control)
##   using the quantile transformed measurements from the rcst tract
##   with a smooth component for a scalar covariate that is pure noise
y &lt;- DTI$case[DTI$visit==1]
X &lt;- DTI$cca[DTI$visit==1, ]
X_2 &lt;- DTI$rcst[DTI$visit==1, ]

ind &lt;- rowSums(is.na(X)) &gt; 0
ind2 &lt;- rowSums(is.na(X_2)) &gt; 0

y &lt;- y[!(ind | ind2)]
X &lt;- X[!(ind | ind2), ]
X_2 &lt;- X_2[!(ind | ind2), ]
z1 &lt;- rnorm(length(y))

## select=TRUE allows terms to be zeroed out of model completely
#fit &lt;- fgam(y ~ s(z1, k = 10) + af(X_2, k=c(7,7), m = list(c(2, 1), c(2, 1)),
 #           Qtransform=TRUE), family=binomial(), select=TRUE)
#plot(fit)

</code></pre>


</div>