<div class="container">

<table style="width: 100%;"><tr>
<td>RobMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RobMM</h2>

<h3>Description</h3>

<p>Robust Mixture Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">RobMM(X, nclust=2:5, model="Gaussian", ninit=10,
               nitermax=50, niterEM=50, niterMC=50, df=3,
               epsvp=10^(-4), mc_sample_size=1000, LogLike=-Inf,
               init='genie', epsPi=10^-4, epsout=-20,scale='none',
               alpha=0.75, c=ncol(X), w=2, epsilon=10^(-8),
               criterion='BIC',methodMC="RobbinsMC", par=TRUE,
               methodMCM="Weiszfeld")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix giving the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclust</code></td>
<td>
<p>A vector of positive integers giving the possible number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The mixture model. Can be <code>'Gaussian'</code> (by default), <code>'Student'</code> and <code>'Laplace'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ninit</code></td>
<td>
<p>The number of random initisalizations. Befault is <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitermax</code></td>
<td>
<p>The number of iterations for the Weiszfeld algorithm if <code>MethodMCM= 'Weiszfeld'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niterEM</code></td>
<td>
<p>The number of iterations for the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niterMC</code></td>
<td>
<p>The number of iterations for estimating robustly the variance of each class if <code>methodMC='FixMC'</code> or <code>methodMC='GradMC'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The degrees of freedom for the Student law if <code>model='Student'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Run the algorithm on scaled data if <code>scale='robust'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsvp</code></td>
<td>
<p>The minimum values the estimates of the eigenvalues of the Median Covariation Matrix can take. Default is <code>10^-4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc_sample_size</code></td>
<td>
<p>The number of data generated for the Monte-Carlo method for estimating robustly the variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LogLike</code></td>
<td>
<p>The initial loglikelihood to "beat". Defulat is <code>-Inf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Can be <code>F</code> if no non random initialization of the algorithm is done, <code>'genie'</code> if the algorithm is initialized with the help of the function <code>'genie'</code> of the package <code>genieclust</code> or <code>'Mclust'</code> if the initialization is done with the function <code>hclass</code> of the package <code>Mclust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsPi</code></td>
<td>
<p>A scalar to ensure the estimates of the probabilities of belonging to a class or uniformly lower bounded by a positive constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsout</code></td>
<td>
<p>If the probability of belonging of a data to a class is smaller than <code>exp(epsout)</code>, this probbility is replaced by <code>exp(epsout)</code> for calculating the logLikelihood. If the probability is too weak for each class, the data is considered as an outlier. Defautl is <code>-20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A scalar between 1/2 and 1 used in the stepsequence for the Robbins-Monro method if <code>methodMC='RobbinsMC'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>The constant in the stepsequence if <code>methodMC='RobbinsMC'</code> or <code>methodMC='GradMC'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>The power for the weighted averaged Robbins-Monro algorithm if <code>methodMC='RobbinsMC'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Stoping condition for the Weiszfeld algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>The criterion for selecting the number of cluster. Can be <code>'ICL'</code> (default) or <code>'BIC'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methodMC</code></td>
<td>
<p>The method chosen to estimate robustly the variance. Can be <code>'RobbinsMC'</code>, <code>'GradMC'</code> or <code>'FixMC'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Is equal to <code>T</code> if the parallelization of the algorithm is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methodMCM</code></td>
<td>
<p>The method chosen for estimating the Median Covariation Matrix. Can be <code>'Gmedian'</code> or <code>'Weiszfeld'</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bestresult</code></td>
<td>
<p> A list giving all the results fo the best clustering (chosen with respect to the selected criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allresults</code></td>
<td>
<p>A list containing all the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ICL</code></td>
<td>
<p>The ICL criterion for all the number of classes selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>The ICL criterion for all the number of classes selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The initial data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclust</code></td>
<td>
<p>A vector of positive integers giving the possible number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kopt</code></td>
<td>
<p>The number of clusters chosen by the selected criterion.</p>
</td>
</tr>
</table>
<p>For the lists <code>bestresult</code> and <code>allresults[[k]]</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>A matrix whose rows are the centers of the classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>A matrix containing all the variance of the classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LogLike</code></td>
<td>
<p>The final LogLikelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi</code></td>
<td>
<p>A matrix giving the probabilities of each data to belong to each class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>The number of iterations of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initEM</code></td>
<td>
<p>A vector giving the initialized clustering if <code>init='Mclust'</code> or <code>init='genie'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>A vector giving the proportions of each classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers</code></td>
<td>
<p>A vector giving the detected  outliers.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cardot, H., Cenac, P. and Zitt, P-A. (2013). Efficient and fast estimation of the geometric median in Hilbert spaces with an averaged stochastic gradient algorithm. <em>Bernoulli</em>, 19, 18-43.
</p>
<p>Cardot, H. and Godichon-Baggioni, A. (2017). Fast Estimation of the Median Covariation Matrix with Application to Online Robust Principal Components Analysis.  <em>Test</em>, 26(3), 461-480
</p>
<p>Vardi, Y. and Zhang, C.-H. (2000). The multivariate L1-median and associated data depth. <em>Proc. Natl. Acad. Sci. USA</em>, 97(4):1423-1426.
</p>


<h3>See Also</h3>

<p>See also <code>Gen_MM</code>, <code>RMMplot</code> and <code>RobVar</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
ech &lt;- Gen_MM(mu = matrix(c(rep(-2,3),rep(2,3),rep(0,3)),byrow = TRUE,nrow=3))
 X &lt;- ech$X
 res &lt;- RobMM(X , nclust=3)
 RMMplot(res,graph=c('Two_Dim'))
 
## End(Not run)
</code></pre>


</div>