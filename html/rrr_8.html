<div class="container">

<table style="width: 100%;"><tr>
<td>residuals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reduced-Rank Regression Residuals</h2>

<h3>Description</h3>

<p><code>residuals</code> calculates the regression residuals for reduced-rank regression and canonical variate analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">residuals(x, y, type = "identity", rank = "full", k = 0, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data frame or matrix of predictor variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>data frame or matrix of response variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of reduced-rank regression model to fit. <code>type = "identity"</code>, the default, uses <code class="reqn">\mathbf{\Gamma} = \mathbf{I}</code> to fit a reduced-rank regression. <code>type = "pca"</code> fits a principal component analysis model as a special case of reduced-rank regression. <code>type = "cva"</code> fits a canonical variate analysis model as a special case of reduced-rank regression. <code>type = "lda"</code> fits a linear discriminant analysis model as a special case of reduced-rank regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>rank of coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>small constant added to diagonal of covariance matrices to make inversion easier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if FALSE, returns data frame of rank trace coordinates.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>scatterplot matrix of residuals if <code>plot = TRUE</code>, the default, or a data frame of residuals if <code>plot = FALSE</code>.
</p>


<h3>References</h3>

<p>Izenman, A.J. (2008) <em>Modern Multivariate Statistical Techniques</em>. Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(tobacco)
tobacco_x &lt;- tobacco[,4:9]
tobacco_y &lt;- tobacco[,1:3]
tobacco_rrr &lt;- rrr(tobacco_x, tobacco_y, rank = 1)
residuals(tobacco_x, tobacco_y, rank = 1, plot = FALSE)
residuals(tobacco_x, tobacco_y, rank = 1)

library(dplyr)
data(COMBO17)
galaxy &lt;- as_data_frame(COMBO17)
galaxy &lt;- select(galaxy, -starts_with("e."), -Nr, -UFS:-IFD)
galaxy &lt;- na.omit(galaxy)
galaxy_x &lt;- select(galaxy, -Rmag:-chi2red)
galaxy_y &lt;- select(galaxy, Rmag:chi2red)
residuals(galaxy_x, galaxy_y, type = "cva", rank = 2, k = 0.001)

</code></pre>


</div>