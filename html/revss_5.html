<div class="container">

<table style="width: 100%;"><tr>
<td>robScale</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Estimate of Scale</h2>

<h3>Description</h3>

<p>Compute the robust estimate of scale for very small samples.</p>


<h3>Usage</h3>

<pre><code class="language-R">robScale(x, loc = NULL, implbound = 1e-4, na.rm = FALSE, maxit = 80L,
         tol = sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>The location, if known, can be used to enhance the estimate for
the scale; defaults to unknown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>implbound</code></td>
<td>
<p>The smallest value that <code>mad</code> is allowed before being
considered too close to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>If <code>TRUE</code> then <code>NA</code> values are stripped from <code>x</code>
before computation takes place.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>The maximum number of iterations; defaults to 80.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The desired accuracy.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the M-estimator for scale using a smooth <code class="reqn">\rho</code>-function defined as
the square of the logistic <code class="reqn">\psi</code> function used in location estimation
(Rousseeuw &amp; Verboven, 2002, 4.2). When the sequence of observations is too
short for a robust estimate, the scale estimate will default to <code>mad</code> so
long as <code>mad</code> has not “imploded”, i.e. it is greater than
<code>implbound</code> which defaults to 0.0001. When <code>mad</code> has imploded,
<code>adm</code> is used instead.
</p>
<p>If the location is known and passed through <code>loc</code>, the algorithm uses the
suggestion in Rousseeuw &amp; Verboven section 5 (2002) converting the observations
to distances from 0 and iterating on the adjusted sequence.
</p>
<p>If <code>na.rm</code> is <code>TRUE</code> then <code>NA</code> values are stripped from <code>x</code>
before computation takes place. If this is not done then an <code>NA</code> value in
<code>x</code> will cause <code>mad</code> to return <code>NA</code>.
</p>
<p>The tolerance and number of iterations are similar to those in existing base R
functions.
</p>
<p>Rousseeuw &amp; Verboven suggest using this function when there are 3–8 samples.
It is implied that having more than 8 samples allows the use of more standard
estimators.
</p>


<h3>Value</h3>

<p>Solves for the robust estimate of scale, <code class="reqn">S_n</code>, which is the solution
to</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n}\sum_{i = 1}^n\rho\left(\frac{x_i - T_n}{S_n}\right) = \beta
</code>
</p>

<p>where <code class="reqn">T_n</code> is fixed at <code>median(x)</code> and <code class="reqn">\beta</code> is fixed at
0.5. The <code class="reqn">\rho</code>-function selected by Rousseeuw &amp; Verboven is based on the
square of the <code class="reqn">\psi</code>-function used in <code>robLoc</code>. Specifically
</p>
<p style="text-align: center;"><code class="reqn">\rho_{log}(x) = \psi_{log}^2\left(\frac{x}{0.37394112142347236}\right)
</code>
</p>

<p>The constant 0.37394112142347236 is necessary so that
</p>
<p style="text-align: center;"><code class="reqn">\beta = \int\rho(u)\;d\Phi(u)=0.5</code>
</p>



<h3>Author(s)</h3>

<p>Avraham Adler <a href="mailto:Avraham.Adler@gmail.com">Avraham.Adler@gmail.com</a></p>


<h3>References</h3>

<p>Rousseeuw, Peter J. and Verboven, Sabine (2002) Robust estimation in very small
samples. <em>Computational Statistics &amp; Data Analysis</em>, <b>40</b>, (4),
741–758. <a href="https://doi.org/10.1016/S0167-9473%2802%2900078-6">doi:10.1016/S0167-9473(02)00078-6</a>
</p>


<h3>See Also</h3>

<p><code>adm</code> and <code>mad</code> as basic robust estimators of scale.
</p>
<p><code>Qn</code> and <code>Sn</code> in the
<a href="https://CRAN.R-project.org/package=robustbase"><span class="pkg">robustbase</span></a> package
which are specialized robust scale estimators for larger samples. The latter two
are based on code written by Peter Rousseeuw.
</p>


<h3>Examples</h3>

<pre><code class="language-R">robScale(c(1:9))
x &lt;- c(1,2,3,5,7,8)
c(robScale(x), robScale(x, loc = 5))
</code></pre>


</div>