<div class="container">

<table style="width: 100%;"><tr>
<td>lmCoDaX</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Classical and robust regression of non-compositional (real) response on
compositional and non-compositional predictors</h2>

<h3>Description</h3>

<p>Delivers appropriate inference for regression of y on a compositional matrix
X or and compositional and non-compositional combined predictors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmCoDaX(
  y,
  X,
  external = NULL,
  method = "robust",
  pivot_norm = "orthonormal",
  max_refinement_steps = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response which should be non-compositional</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The compositional and/or non-compositional predictors as a matrix, data.frame or numeric
vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>external</code></td>
<td>
<p>Specify the columns name of the external variables. The name has to be introduced as follows:
external = c("variable_name"). Multiple selection is supported for the external variable. Factor variables are
automatically detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>If robust, LTS-regression is applied, while with method equals
“classical”, the conventional least squares regression is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pivot_norm</code></td>
<td>
<p>if FALSE then the normalizing constant is not used, if TRUE sqrt((D-i)/(D-i+1))
is used (default). The user can also specify a self-defined constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_refinement_steps</code></td>
<td>
<p>(for the fast-S algorithm): maximal number of refinement
steps for the fully iterated best candidates.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compositional explanatory variables should not be directly used in a linear
regression model because any inference statistic can become misleading.
While various approaches for this problem were proposed, here an approach
based on the pivot coordinates is used. Further these compositional explanatory 
variables can be supplemented with external non-compositional data
and factor variables.
</p>


<h3>Value</h3>

<p>An object of class ‘lts’ or ‘lm’ and two summary
objects.
</p>


<h3>Author(s)</h3>

<p>Peter Filzmoser, Roman Wiedemeier, Matthias Templ
</p>


<h3>References</h3>

<p>Filzmoser, P., Hron, K., Thompsonc, K. (2012) Linear regression
with compositional explanatory variables. <em>Journal of Applied
Statistics</em>, 39, 1115-1128.
</p>


<h3>See Also</h3>

<p><code>lm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## How the total household expenditures in EU Member
## States depend on relative contributions of 
## single household expenditures:
data(expendituresEU)
y &lt;- as.numeric(apply(expendituresEU,1,sum))
lmCoDaX(y, expendituresEU, method="classical")

## How the relative content of sand of the agricultural
## and grazing land soils in Germany depend on
## relative contributions of the main chemical trace elements,
## their different soil types and the Annual mean temperature:
data("gemas")
gemas$COUNTRY &lt;- as.factor(gemas$COUNTRY)
gemas_GER &lt;- dplyr::filter(gemas, gemas$COUNTRY == 'POL')
ssc &lt;- cenLR(gemas_GER[, c("sand", "silt", "clay")])$x.clr
y &lt;- ssc$sand
X &lt;- dplyr::select(gemas_GER, c(MeanTemp, soilclass, Al:Zr))
X$soilclass &lt;- factor(X$soilclass)
lmCoDaX(y, X, external = c('MeanTemp', 'soilclass'),
method='classical', pivot_norm = 'orthonormal')
lmCoDaX(y, X, external = c('MeanTemp', 'soilclass'),
method='robust', pivot_norm = 'orthonormal')
</code></pre>


</div>