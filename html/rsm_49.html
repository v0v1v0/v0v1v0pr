<div class="container">

<table style="width: 100%;"><tr>
<td>FO</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Response-surface model components</h2>

<h3>Description</h3>

<p>Use of one of these functions in a model is how you specify the portion of the model
that is to be regarded as a response-surface component.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FO (...)
TWI (..., formula)
PQ (...)
SO (...)
PE (...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>The numerical predictors for the response surface, 
separated by commas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Alternative way to specify two-way interactions. Use <code>formula</code> or <code>...</code>, never both.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Use <code>FO()</code> in the model formula in <code>rsm</code>
to specify a first-order response surface (i.e., a linear function) 
in its arguments.  Use <code>TWI()</code> to generate two-way interactions, and <code>PQ()</code> to generate
pure quadratic terms (squares of the <code>FO()</code> terms).  A call to
<code>SO()</code> creates all terms in <code>FO()</code>, <code>TWI()</code>, and <code>PQ()</code> (in that order) for those
variables.  However, specifying <code>SO()</code> in a model formula in <code>rsm</code> will be replaced 
by the explicit sum of model terms, so that the <code>anova</code> table shows separate sums of squares.
Other variables (such as blocks or factors) may be included in the model
but should never be included in the arguments to <code>FO</code> or <code>SO</code>.
</p>
<p><code>PE</code> is used for fitting pure-error models.  It should not be used in
response-surface models.  This function exists primarily for use
by <code>loftest</code>, but could be useful in other linear-model
contexts for fitting a model that interpolates the means at each distinct
combination of argument values.
</p>
<p>The <code>formula</code> argument in <code>TWI</code> can simplify specifying models where only certain interactions are included. For example, ‘<span class="samp">⁠TWI(formula = ~x1:(x2+x3))⁠</span>’ is equivalent to ‘<span class="samp">⁠TWI(x1,x2) + TWI(x1,x3)⁠</span>’. The formula is expanded using <code>terms</code>, and then only the second-order terms are retained. If this results in only one term, an error condition is raised. This is necessary to prevent <code>rsm</code> from getting confused in identifying second-order terms.
</p>


<h3>Value</h3>

<p>The functions <code>FO</code>, <code>TWI</code>, <code>PQ</code>, and <code>SO</code> return a matrix whose
columns are the required predictors.
</p>
<p><code>PE</code> returns a <code>factor</code> whose levels are all the distinct combinations of
arguments provided to the function.
</p>


<h3>Author(s)</h3>

<p>Russell V. Lenth</p>


<h3>References</h3>

<p>Lenth RV (2009) “Response-Surface Methods in R, Using rsm”, 
<em>Journal of Statistical Software</em>, 32(7), 1–17. 
<a href="https://doi.org/10.18637/jss.v032.i07">doi:10.18637/jss.v032.i07</a>
</p>


<h3>See Also</h3>

<p><code>rsm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  ### See 'rsm' help for examples of FO, TWI, etc
  
  library(rsm)
  ### Test LOF for a regression model
  ChemReact.lm &lt;- lm(Yield ~ Time*Temp, data = ChemReact1)
  PureError.lm &lt;- update (ChemReact.lm, . ~ PE(Time,Temp))
  anova (ChemReact.lm, PureError.lm)
</code></pre>


</div>