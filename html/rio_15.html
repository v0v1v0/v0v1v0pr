<div class="container">

<table style="width: 100%;"><tr>
<td>import_list</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Import list of data frames</h2>

<h3>Description</h3>

<p>Use <code>import()</code> to import a list of data frames from a vector of file names or from a multi-object file (Excel workbook, .Rdata file, compressed directory in a zip file or tar archive, or HTML file)
</p>


<h3>Usage</h3>

<pre><code class="language-R">import_list(
  file,
  setclass = getOption("rio.import.class", "data.frame"),
  which,
  rbind = FALSE,
  rbind_label = "_file",
  rbind_fill = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>A character string containing a single file name for a multi-object file (e.g., Excel workbook, zip file, tar archive, or HTML file), or a vector of file paths for multiple files to be imported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setclass</code></td>
<td>
<p>An optional character vector specifying one or more classes
to set on the import. By default, the return object is always a
“data.frame”. Allowed values include “tbl_df”, “tbl”, or
“tibble” (if using tibble), “arrow”, “arrow_table” (if using arrow table; the suggested package <code>arrow</code> must be installed) or “data.table” (if using
data.table). Other values are ignored, such that a data.frame is returned.
The parameter takes precedents over parameters in ... which set a different class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>If <code>file</code> is a single file path, this specifies which objects should be extracted (passed to <code>import()</code>'s <code>which</code> argument). Ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rbind</code></td>
<td>
<p>A logical indicating whether to pass the import list of data frames through <code>data.table::rbindlist()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rbind_label</code></td>
<td>
<p>If <code>rbind = TRUE</code>, a character string specifying the name of a column to add to the data frame indicating its source file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rbind_fill</code></td>
<td>
<p>If <code>rbind = TRUE</code>, a logical indicating whether to set the <code>fill = TRUE</code> (and fill missing columns with <code>NA</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>import()</code>. Behavior may be unexpected if files are of different formats.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When file is a vector of file paths and any files are missing, those files are ignored (with warnings) and this function will not raise any error. For compressed files, the file name must also contain information about the file format of all compressed files, e.g. <code>files.csv.zip</code> for this function to work.
</p>


<h3>Value</h3>

<p>If <code>rbind=FALSE</code> (the default), a list of a data frames. Otherwise, that list is passed to <code>data.table::rbindlist()</code> with <code>fill = TRUE</code> and returns a data frame object of class set by the <code>setclass</code> argument; if this operation fails, the list is returned.
</p>


<h3>Trust</h3>

<p>For serialization formats (.R, .RDS, and .RData), please note that you should only load these files from trusted sources. It is because these formats are not necessarily for storing rectangular data and can also be used to store many things, e.g. code. Importing these files could lead to arbitary code execution. Please read the security principles by the R Project (Plummer, 2024). When importing these files via <code>rio</code>, you should affirm that you trust these files, i.e. <code>trust = TRUE</code>. See example below. If this affirmation is missing, the current version assumes <code>trust</code> to be true for backward compatibility and a deprecation notice will be printed. In the next major release (2.0.0), you must explicitly affirm your trust when importing these files.
</p>


<h3>Which</h3>

<p>For compressed archives (zip and tar, where a compressed file can contain multiple files), it is possible to come to a situation where the parameter <code>which</code> is used twice to indicate two different concepts. For example, it is unclear for <code>.xlsx.zip</code>whether <code>which</code> refers to the selection of an exact file in the archive or the selection of an exact sheet in the decompressed Excel file. In these cases, <code>rio</code> assumes that <code>which</code> is only used for the selection of file. After the selection of file with <code>which</code>, <code>rio</code> will return the first item, e.g. the first sheet.
</p>
<p>Please note, however, <code>.gz</code> and <code>.bz2</code> (e.g. <code>.xlsx.gz</code>) are compressed, but not archive format. In those cases, <code>which</code> is used the same way as the non-compressed format, e.g. selection of sheet for Excel.
</p>


<h3>References</h3>

<p>Plummer, M (2024). Statement on CVE-2024-27322. <a href="https://blog.r-project.org/2024/05/10/statement-on-cve-2024-27322/">https://blog.r-project.org/2024/05/10/statement-on-cve-2024-27322/</a>
</p>


<h3>See Also</h3>

<p><code>import()</code>, <code>export_list()</code>, <code>export()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## For demo, a temp. file path is created with the file extension .xlsx
xlsx_file &lt;- tempfile(fileext = ".xlsx")
export(
    list(
        mtcars1 = mtcars[1:10, ],
        mtcars2 = mtcars[11:20, ],
        mtcars3 = mtcars[21:32, ]
    ),
    xlsx_file
)

# import a single file from multi-object workbook
import(xlsx_file, sheet = "mtcars1")
# import all worksheets, the return value is a list
import_list(xlsx_file)

# import and rbind all worksheets, the return value is a data frame
import_list(xlsx_file, rbind = TRUE)
</code></pre>


</div>