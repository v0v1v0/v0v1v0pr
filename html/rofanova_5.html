<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate data for Robust Functional ANOVA</h2>

<h3>Description</h3>

<p>Generate synthetic data as in the simulation study of Centofanti et al. (2021) with the addition of the case of bi-variate functional data. All the details are in  Centofanti et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_data(
  scenario = "one-way",
  mean = "M1",
  con = "C0",
  p = 0.1,
  M = 1,
  n_i = 25,
  k_1 = 3,
  k_2 = 3,
  alpha = 0,
  beta = 0,
  sd = 0.01,
  grid = seq(0, 1, length.out = 30),
  err = "s"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scenario</code></td>
<td>
<p>A  character strings indicating the scenario considered. It could be "one-way", "two-way", "one-way surface" and "two-way surface".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>A character strings indicating the type of mean function in one-way ANOVA. It could be "M1", "M2", and "M3".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con</code></td>
<td>
<p>A character strings indicating the type of contamination function. It could be "C0", for no contamination, "C1", "C2", "C3", "C4", "C5", and "C6".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The parameter related to the bernoulli variable in the contamination function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The contamination size constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_i</code></td>
<td>
<p>The number of observation for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_1</code></td>
<td>
<p>The number of level for the first main effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_2</code></td>
<td>
<p>The number of level for the second main effect. For One-way ANOVA, it is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The parameter a in the Two-way ANOVA scenarios. For One-way ANOVA, it is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The parameter b in the Two-way ANOVA scenarios. For One-way ANOVA, it is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>The sigma parameter in the covariance of the error function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>The grid over which the functional data are observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>The direction of the dependence in the error function for the case of bi-variate functional data. It could be either "s", for dependence along the first dimension or "t" for dependence along the second dimension.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following arguments:
</p>

<ul>
<li> <p><code>X_fdata</code>: The generated functional data.
</p>
</li>
<li>
<p><code>label_1</code>: The vector of containing group label corresponding to the first main effect.
</p>
</li>
<li>
<p><code>label_2</code>: The vector of containing group label corresponding to the second main effect. For one-way ANOVA, it is NULL.
</p>
</li>
</ul>
<h3>References</h3>

<p>Centofanti, F., Colosimo, B.M., Grasso, M.L., Menafoglio, A., Palumbo, B., Vantini, S. (2021).
Robust Functional ANOVA with Application to Additive Manufacturing.
<em>arXiv preprint arXiv:2112.10643</em>.
</p>


<h3>See Also</h3>

<p><code>rofanova</code> <code>fusem</code> <code>funmad</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(rofanova)
data_out&lt;-simulate_data(scenario="one-way")
label_1=data_out$label_1
X_fdata&lt;-data_out$X_fdata
B=10
cores=1
per_list_median&lt;-rofanova(X_fdata,label_1,B = B,family="median",cores=cores)
pvalue_median_vec&lt;-per_list_median$pval_vec
per_list_huber&lt;-rofanova(X_fdata,label_1,B = B,family="huber",cores=cores)
pvalue_huber_vec&lt;-per_list_huber$pval_vec
per_list_bisquare&lt;-rofanova(X_fdata,label_1,B = B,family="bisquare",cores=cores)
pvalue_bisquare_vec&lt;-per_list_bisquare$pval_vec
per_list_hampel&lt;-rofanova(X_fdata,label_1,B = B,family="hampel",cores=cores)
pvalue_hampel_vec&lt;-per_list_hampel$pval_vec
per_list_optimal&lt;-rofanova(X_fdata,label_1,B = B,family="optimal",cores=cores)
pvalue_optimal&lt;-per_list_optimal$pval
</code></pre>


</div>