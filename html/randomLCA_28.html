<div class="container">

<table style="width: 100%;"><tr>
<td>simulate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate</h2>

<h3>Description</h3>

<p>Simulate data from a fitted randomLCA model</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'randomLCA'
simulate(object, nsim, seed, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>randomLCA object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of data sets to be simulated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional optional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates random data from the supplied object.
</p>


<h3>Value</h3>

<p>A simulated data frame or a list of simulated data frames.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class="language-R">
myocardial.lca1 &lt;- randomLCA(myocardial[, 1:4], freq = myocardial$freq, nclass = 1, cores = 1)
myocardial.lca2 &lt;- randomLCA(myocardial[, 1:4], freq = myocardial$freq, cores = 1)
# calculate observed lrt
obslrt &lt;- 2*(logLik(myocardial.lca2)-logLik(myocardial.lca1))

print(obslrt)

nsims &lt;- 999
# generate the simulations
thesims &lt;- simulate(myocardial.lca1, nsims)
# for each simulation determin lrt
simlrt &lt;- rep(NA, nsims)
for (isim in 1:nsims) {
  submodel &lt;- refit(myocardial.lca1, newpatterns = thesims[[isim]])
  fullmodel &lt;- refit(myocardial.lca2, newpatterns = thesims[[isim]])
  simlrt[isim] &lt;- 2*(logLik(fullmodel)-logLik(submodel))
  print(c(isim, simlrt[isim]))
}
# calculate p value as proportion of simulated lrt greater than observed, 
# corrected by adding one to numerator and denominator
print((sum(simlrt &gt;= obslrt)+1)/(nsims+1))
</code></pre>


</div>