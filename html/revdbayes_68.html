<div class="container">

<table style="width: 100%;"><tr>
<td>wbinpost</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random sampling from a binomial posterior distribution, using weights</h2>

<h3>Description</h3>

<p>Samples from the posterior distribution of the probability <code class="reqn">p</code>
of a binomial distribution.  User-supplied weights are applied to each
observation when constructing the log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wbinpost(n, prior, ds_bin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric scalar. The size of posterior sample required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A function to evaluate the prior, created by
<code>set_bin_prior</code>.
<code>prior$prior</code> must be <code>"bin_beta"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ds_bin</code></td>
<td>
<p>A numeric list.  Sufficient statistics for inference
about the binomial probability <code class="reqn">p</code>.  Contains
</p>

<ul>
<li> <p><code>sf</code> : a logical vector of success (<code>TRUE</code>) and failure
(<code>FALSE</code>) indicators.
</p>
</li>
<li> <p><code>w</code> : a numeric vector of length <code>length(sf)</code> containing
the values by which to multiply the observations when constructing the
log-likelihood.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>prior$prior == "bin_beta"</code> the posterior for <code class="reqn">p</code>
is a beta distribution so <code>rbeta</code> is used to
sample from the posterior.
</p>


<h3>Value</h3>

<p>An object (list) of class <code>"binpost"</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>bin_sim_vals</code>:</td>
<td>
<p>An <code>n</code> by 1 numeric matrix of values
simulated from the posterior for the binomial
probability <code class="reqn">p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>bin_logf</code>:</td>
<td>
<p>A function returning the log-posterior for
<code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>bin_logf_args</code>:</td>
<td>
<p>A list of arguments to <code>bin_logf</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>set_bin_prior</code> for setting a prior distribution
for the binomial probability <code class="reqn">p</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">u &lt;- quantile(gom, probs = 0.65)
ds_bin &lt;- list(sf = gom &gt; u, w = rep(1, length(gom)))
bp &lt;- set_bin_prior(prior = "jeffreys")
temp &lt;- wbinpost(n = 1000, prior = bp, ds_bin = ds_bin)
graphics::hist(temp$bin_sim_vals, prob = TRUE)
</code></pre>


</div>