<div class="container">

<table style="width: 100%;"><tr>
<td>registr_oneCurve</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function to register one curve</h2>

<h3>Description</h3>

<p>This internal function is only to be used from within <code>registr</code>.
It performs the main optimization step with <code>constrOptim</code> for the
registration of one curve.
</p>


<h3>Usage</h3>

<pre><code class="language-R">registr_oneCurve(
  obj = NULL,
  Y = NULL,
  Kt = 8,
  Kh = 4,
  family = "gaussian",
  gradient = TRUE,
  incompleteness = NULL,
  lambda_inc = NULL,
  beta = NULL,
  t_min = NULL,
  t_max = NULL,
  periodic = FALSE,
  warping = "nonparametric",
  gamma_scales = NULL,
  global_knots = NULL,
  mean_coefs = NULL,
  ...,
  verbose = 1,
  just_return_list = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Current estimate of FPC object. 
Can be NULL only if Y argument is selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Dataframe. Should have values id, value, index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kt</code></td>
<td>
<p>Number of B-spline basis functions used to estimate mean functions. Default is 8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kh</code></td>
<td>
<p>Number of B-spline basis functions used to estimate warping functions <em>h</em>. Default is 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>One of <code>c("gaussian","binomial","gamma","poisson")</code>. Defaults to
<code>"gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>If <code>TRUE</code>, uses analytic gradient to calculate derivative. 
If <code>FALSE</code>, calculates gradient numerically. Not available for families
<code>"gamma","poisson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incompleteness</code></td>
<td>
<p>Optional specification of incompleteness structure.
One of <code>c("leading","trailing","full")</code>, specifying that incompleteness
is present only in the initial measurements, only in the trailing measurements, or
in both, respectively. For details see the accompanying vignette.
Defaults to NULL, i.e. no incompleteness structure.
Can only be set when <code>warping = "nonparametric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_inc</code></td>
<td>
<p>Penalization parameter to control the amount of
overall dilation of the domain.
The higher this lambda, the more the registered domains are forced to have the
same length as the observed domains.
Only used if <code>incompleteness</code> is not NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Current estimates for beta for each subject. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_min</code></td>
<td>
<p>Minimum value to be evaluated on the time domain.
if 'NULL', taken to be minimum observed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_max</code></td>
<td>
<p>Maximum value to be evaluated on the time domain. 
if 'NULL', taken to be maximum observed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodic</code></td>
<td>
<p>If <code>TRUE</code>, uses periodic b-spline basis functions. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warping</code></td>
<td>
<p>If <code>nonparametric</code> (default), inverse warping functions are estimated nonparametrically. 
If <code>piecewise_linear2</code> they follow a piecewise linear function with 2 knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_scales</code></td>
<td>
<p>Only used for <code>family = "gamma"</code>.
Vector with one entry for each subject, containing the current estimate for the scale parameter of its
gamma distribution. Default is NULL, which sets the starting value for the scale parameter to 1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global_knots</code></td>
<td>
<p>knots for the basis/splines, passed to [pbs::pbs()] 
or [stats::bs()]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_coefs</code></td>
<td>
<p>Mean coefficients for the mean of all curves or 
GFPCA based.  May extract from 'obj' object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to or from other functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Can be set to integers between 0 and 4 to control the level of
detail of the printed diagnostic messages. Higher numbers lead to more detailed
messages. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>just_return_list</code></td>
<td>
<p>Do not use.  For developers only</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>hinv_innerKnots</code></td>
<td>
<p>Inner knots for setting up the spline basis
for the inverse warping function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hinv_beta</code></td>
<td>
<p>Estimated B-spline basis coefficients used to construct
subject-specific inverse warping functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_hat</code></td>
<td>
<p>Vector of registered time domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>
<p>Loss of the optimal solution.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Julia Wrobel <a href="mailto:julia.wrobel@cuanschutz.edu">julia.wrobel@cuanschutz.edu</a>,
Erin McDonnell <a href="mailto:eim2117@cumc.columbia.edu">eim2117@cumc.columbia.edu</a>,
Alexander Bauer <a href="mailto:alexander.bauer@stat.uni-muenchen.de">alexander.bauer@stat.uni-muenchen.de</a>
</p>


</div>