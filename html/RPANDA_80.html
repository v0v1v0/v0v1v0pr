<div class="container">

<table style="width: 100%;"><tr>
<td>likelihood_t_DD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Likelihood of a dataset under diversity-dependent models.
</h2>

<h3>Description</h3>

<p>Computes the likelihood of a dataset under either the linear or exponential diversity dependent model with specified <code>sigma2</code> and slope values. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">likelihood_t_DD(phylo, data, par,model=c("DDlin","DDexp"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
  
<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a named vector of continuous data with names corresponding to <code>phylo$tip.label</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>a vector listing a value for <code>log(sig2)</code> (see Note) and either <code>b</code> (for the linear diversity dependent model) or <code>r</code> (for the exponential diversity dependent model), in that order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>model chosen to fit trait data, <code>"DDlin"</code> is the diversity-dependent linear model, and <code>"DDexp"</code> is the diversity-dependent exponential model of Weir &amp; Mursleen 2013.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When specifying <code>par</code>, <code>log(sig2)</code> must be listed before the slope parameter (<code>b</code> or <code>r</code>).
</p>


<h3>Value</h3>

<p>the negative log-likelihood value of the dataset (accordingly, the negative of the output should be recorded as the likelihood), given the phylogeny and <code>sig2</code> and slope values
</p>


<h3>Note</h3>

<p>To stabilize optimization, this function exponentiates the input <code>sig2</code> value, thus the user must input the log(sig2) value to compute the correct log likelihood (see example).
</p>


<h3>Author(s)</h3>

<p>Jonathan Drury <a href="mailto:jonathan.p.drury@gmail.com">jonathan.p.drury@gmail.com</a>
</p>
<p>Julien Clavel
</p>


<h3>References</h3>

<p>Drury, J., Clavel, J., Manceau, M., and Morlon, H. 2016. Estimating the effect of competition on trait evolution using maximum likelihood inference. <em>Systematic Biology</em> doi 10.1093/sysbio/syw020
</p>
<p>Weir, J. &amp; Mursleen, S. 2012. Diversity-dependent cladogenesis and trait evolution in the adaptive radiation of the auks (Aves: Alcidae). <em>Evolution</em> 67:403-416.
</p>


<h3>See Also</h3>

<p><code>fit_t_comp</code>
<code>likelihood_t_DD_geog</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Anolis.data)
phylo &lt;- Anolis.data$phylo
pPC1 &lt;- Anolis.data$data

# Compute the likelihood that the r value is twice the ML estimate for the DDexp model
par &lt;- c(0.08148371, (2*-0.3223835))
lh &lt;- -likelihood_t_DD(phylo,pPC1,par,model="DDexp")
</code></pre>


</div>