<div class="container">

<table style="width: 100%;"><tr>
<td>lines.fit_t.env.ou</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Add to a plot line segments joining the phenotypic evolutionary optimum through time estimated by the <em>fit_t_env_ou</em> function
</h2>

<h3>Description</h3>

<p>Plot estimated optimum as a function of the environmental data and time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
## S3 method for class 'fit_t.env.ou'
lines(x, steps = 100, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class 'fit_t.env.ou' obtained from a <em>fit_t_env_ou</em> fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>

<p>the number of steps from the root to the present used to compute the optimum <code class="reqn">\theta(t)</code> through time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments to be passed to <code>plot</code>. See ?<code>plot</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>lines.fit_t.env.ou</code> returns invisibly a list with the following components used to add the line segments to the current plot:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>time_steps</code></td>
<td>
<p>the times steps where the climatic function was evaluated to compute the rate. The number of steps is controlled through the argument <code>steps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>the estimated optimum through time estimated at each <code>time_steps</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>All the graphical parameters (see <code>par</code>) can be passed through (e.g. line type: <code>lty</code>, line width: <code>lwd</code>, color: <code>col</code> ...)
</p>


<h3>Author(s)</h3>

<p>J. Clavel</p>


<h3>References</h3>

<p>Clavel, J. &amp; Morlon, H., 2017. Accelerated body size evolution during cold climatic periods in the Cenozoic. Proceedings of the National Academy of Sciences,  114(16): 4183-4188.
</p>
<p>Troyer, E., Betancur-R, R., Hughes, L., Westneat, M., Carnevale, G., White W.T., Pogonoski, J.J., Tyler, J.C., Baldwin, C.C., Orti, G., Brinkworth, A., Clavel, J., Arcila, D., 2022. The impact of paleoclimatic changes on body size evolution in marine fishes. Proceedings of the National Academy of Sciences, 119 (29), e2122486119.
</p>
<p>Goswami, A. &amp; Clavel, J., 2024. Morphological evolution in a time of Phenomics. EcoEvoRxiv, https://doi.org/10.32942/X22G7Q
</p>


<h3>See Also</h3>


<p><code>plot.fit_t.env.ou</code>, <code>fit_t_env_ou</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(test){

data(InfTemp)
set.seed(9999) # for reproducibility

# Let's start by simulating a trait under a climatic OU
beta = 0.6           # relationship to the climate curve
sim_theta = 4        # value of the optimum if the relationship to the climate 
# curve is 0 (this corresponds to an 'intercept' in the linear relationship used below)
sim_sigma2 = 0.025   # variance of the scatter = sigma^2
sim_alpha = 0.36     # alpha value = strength of the OU; quite high here...
delta = 0.001        # time step used for the forward simulations =&gt; here its 1000y steps
tree &lt;- pbtree(n=200, d=0.3) # simulate a bd tree with some extinct lineages
root_age = 60        # height of the root (almost all the Cenozoic here)
tree$edge.length &lt;- root_age*tree$edge.length/max(nodeHeights(tree)) 
# here - for this contrived example - I scale the tree so that the root is at 60 Ma

trait &lt;- sim_t_env_ou(tree, sigma=sqrt(sim_sigma2), alpha=sim_alpha, theta0=sim_theta, param=beta, 
              env_data=InfTemp, step=0.01, scale=TRUE, plot=FALSE)

## Fit the Environmental model (default)

result1 &lt;- fit_t_env_ou(phylo = tree, data = trait, env_data =InfTemp,
                        method = "Nelder-Mead", df=50, scale=TRUE)
plot(result1, lty=2)

result2 &lt;- fit_t_env_ou(phylo = tree, data = trait, env_data =InfTemp, 
                        method = "Nelder-Mead", df=10, scale=TRUE)
lines(result2, col="red")

}

</code></pre>


</div>