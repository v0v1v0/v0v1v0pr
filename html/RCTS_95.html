<div class="container">

<table style="width: 100%;"><tr>
<td>update_g</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function that estimates group membership.</h2>

<h3>Description</h3>

<p>Function that estimates group membership.
</p>


<h3>Usage</h3>

<pre><code class="language-R">update_g(
  Y,
  X,
  beta_est,
  g,
  factor_group,
  lambda,
  comfactor,
  S,
  k,
  kg,
  vars_est,
  robust,
  method_estimate_factors,
  method_estimate_beta,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Y: NxT dataframe with the panel data of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>X: NxTxp array containing the observable variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_est</code></td>
<td>
<p>estimated values of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Vector with estimated group membership for all individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_group</code></td>
<td>
<p>estimated group specific factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>loadings of the estimated common factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comfactor</code></td>
<td>
<p>estimated common factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>number of estimated groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of common factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kg</code></td>
<td>
<p>number of group specific factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars_est</code></td>
<td>
<p>number of variables that will be included in the algorithm and have their coefficient estimated. This is usually equal to the number of observable variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>robust or classical estimation of group membership</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_estimate_factors</code></td>
<td>
<p>defines method of robust estimaton of the factors: "macro", "pertmm" or "cz"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_estimate_beta</code></td>
<td>
<p>defines how beta is estimated. Default case is an estimated beta for each individual. Default value is "individual." Possible values are "homogeneous", "group" or "individual".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>when TRUE, it prints messages</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list. The first element contains a vector with the estimated group membership for all time series. The second element contains the values
which were used to determine the group membership. The third element is only relevant if method_estimate_factors is set to "cz" (non-default) and
contains the group membership before moving some of the time series to class zero.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
X &lt;- X_dgp3
Y &lt;- Y_dgp3
# Set estimations for group factors and its loadings, and group membership to the true value
lambda_group &lt;- lambda_group_true_dgp3
factor_group &lt;- factor_group_true_dgp3
g_true &lt;- g_true_dgp3 # true values of group membership
g &lt;- g_true # estimated values of group membership; set in this example to be equal to true values
# There are no common factors to be estimated  -&gt;  use placeholder with values set to zero
lambda &lt;- matrix(0, nrow = 1, ncol = 300)
comfactor &lt;- matrix(0, nrow = 1, ncol = 30)
# Choose how coefficients of the observable are estimated
beta_est &lt;- estimate_beta(
  Y, X, NA, g, lambda_group, factor_group,
  lambda, comfactor,
  S = 3, k = 0, kg = c(3, 3, 3),
  vars_est = 3, robust = TRUE
)[[1]]
g_new &lt;- update_g(
  Y, X, beta_est, g,
  factor_group, lambda, comfactor,
  S = 3,
  k = 0,
  kg = c(3, 3, 3),
  vars_est = 3,
  robust = TRUE,
  "macro", "individual"
)[[1]]

</code></pre>


</div>