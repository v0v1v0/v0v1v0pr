<div class="container">

<table style="width: 100%;"><tr>
<td>plot.ru</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot diagnostics for an ru object</h2>

<h3>Description</h3>

<p><code>plot</code> method for class <code>"ru"</code>.  For <code>d = 1</code> a histogram of
the simulated values is plotted with a the density function superimposed.
The density is normalized crudely using the trapezium rule.  For
<code>d = 2</code> a scatter plot of the simulated values is produced with
density contours superimposed.  For <code>d &gt; 2</code> pairwise plots of the
simulated values are produced.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ru'
plot(
  x,
  y,
  ...,
  n = ifelse(x$d == 1, 1001, 101),
  prob = c(0.1, 0.25, 0.5, 0.75, 0.95, 0.99),
  ru_scale = FALSE,
  rows = NULL,
  xlabs = NULL,
  ylabs = NULL,
  var_names = NULL,
  points_par = list(col = 8)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"ru"</code>, a result of a call to <code>ru</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to <code>hist</code>, <code>lines</code>,
<code>contour</code> or <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric scalar.  Only relevant if <code>x$d = 1</code> or
<code>x$d = 2</code>. The meaning depends on the value of x$d.
</p>

<ul>
<li>
<p> For d = 1 : n + 1 is the number of abscissae in the trapezium
method used to normalize the density.
</p>
</li>
<li>
<p> For d = 2 : an n by n regular grid is used to contour the density.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Numeric vector. Only relevant for <code>d = 2</code>.  The contour
lines are drawn such that the respective probabilities that the variable
lies within the contour are approximately equal to the values in
<code>prob</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ru_scale</code></td>
<td>
<p>A logical scalar.  Should we plot data and density on the
scale used in the ratio-of-uniforms algorithm (<code>TRUE</code>) or on the
original scale (<code>FALSE</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows</code></td>
<td>
<p>A numeric scalar.  When <code>d &gt; 2</code> this sets the number of
rows of plots.  If the user doesn't provide this then it is set
internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabs, ylabs</code></td>
<td>
<p>Numeric vectors.  When <code>d &gt; 2</code> these set the labels
on the x and y axes respectively.  If the user doesn't provide these then
the column names of the simulated data matrix to be plotted are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_names</code></td>
<td>
<p>A character (or numeric) vector of length <code>x$d</code>. This
argument can be used to replace variable names set using <code>var_names</code>
in the call to <code>ru</code> or <code>ru_rcpp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points_par</code></td>
<td>
<p>A list of arguments to pass to
<code>points</code> to control the appearance of points
depicting the simulated values. Only relevant when <code>d = 2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>No return value, only the plot is produced.
</p>


<h3>See Also</h3>

<p><code>summary.ru</code> for summaries of the simulated values
and properties of the ratio-of-uniforms algorithm.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Log-normal density ----------------
x &lt;- ru(logf = dlnorm, log = TRUE, d = 1, n = 1000, lower = 0, init = 1)

plot(x)

# Improve appearance using arguments to plot() and hist()

plot(x, breaks = seq(0, ceiling(max(x$sim_vals)), by = 0.25),
  xlim = c(0, 10))

# Two-dimensional normal with positive association ----------------
rho &lt;- 0.9
covmat &lt;- matrix(c(1, rho, rho, 1), 2, 2)
log_dmvnorm &lt;- function(x, mean = rep(0, d), sigma = diag(d)) {
  x &lt;- matrix(x, ncol = length(x))
  d &lt;- ncol(x)
  - 0.5 * (x - mean) %*% solve(sigma) %*% t(x - mean)
}
x &lt;- ru(logf = log_dmvnorm, sigma = covmat, d = 2, n = 1000, init = c(0, 0))

plot(x)

</code></pre>


</div>