<div class="container">

<table style="width: 100%;"><tr>
<td>IOAORKF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An innovative and additive outlier robust Kalman filter</h2>

<h3>Description</h3>

<p>An implementation of Computationally Efficient Bayesian Anomaly detection by Sequential Sampling (CE-BASS) by Fisch et al. (2020).
This function assumes that both the innovations and additions are potentially polluted by a heavy tailed process, which is approximated by a t-distribution.
To approximate the posterior, particles for the precision (inverse variance) are sampled using a robust approximation to the posterior. Conditionally on those samples, the classical Kalman updates are used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IOAORKF(
  Y,
  mu_0,
  Sigma_0 = NULL,
  A,
  C,
  Sigma_Add,
  Sigma_Inn,
  Particles,
  Descendants = 1,
  s = 2,
  anom_add_prob = NULL,
  anom_inn_prob = NULL,
  epsilon = 1e-06,
  horizon_matrix = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A list of matrices containing the observations to be filtered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_0</code></td>
<td>
<p>A matrix indicating the mean of the prior for the hidden states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_0</code></td>
<td>
<p>A matrix indicating the variance of the prior for the hidden states. It defaults to the limit of the variance of the Kalman filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A matrix giving the updates for the hidden states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>A matrix mapping the hidden states to the observed states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_Add</code></td>
<td>
<p>A positive definite diagonal matrix giving the additive noise covariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_Inn</code></td>
<td>
<p>A positive definite diagonal matrix giving the innovative noise covariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Particles</code></td>
<td>
<p>An integer giving the number of particles to be maintained at each step. More particles lead to more accuracy, but also require more memory and CPU time. The parameter should be at least p + q + 1, where p s the dimension of the observations and q the dimension of the hidden states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Descendants</code></td>
<td>
<p>An integer giving the number of descendants to be sampled for each of the possible anomalies. Increasing Descendants leads to higher accuracy but also higher memory and CPU requirements. The default value is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>A numeric giving the shape of the t-distribution to be considered. It defaults to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anom_add_prob</code></td>
<td>
<p>A vector of probabilities with length equal to the dimension of the observations giving the probabilities of additive outliers in each of the components. It defaults to 1/10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anom_inn_prob</code></td>
<td>
<p>A vector of probabilities with length equal to the dimension of the hidden state giving the probabilities of innovative outliers in each of the components. It defaults to 1/10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>A positive numeric giving the precision to which the limit of the covariance is to be computed. It defaults to 0.000001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizon_matrix</code></td>
<td>
<p>A matrix of 0s and 1s giving the horizon's at which innovative particles are to be resampled. It defaults to a k by q matrix, where k is the number of observations required for observability of the system and q is the dimension of the hidden states.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An ioaorkf S3 class.
</p>


<h3>References</h3>

<p>Fisch A, Eckley IA, Fearnhead P (2020).
“Innovative And Additive Outlier Robust Kalman Filtering With A Robust Particle Filter.”
<em>arXiv preprint arXiv:2007.03238</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(RobKF)

set.seed(2018)

A = diag(2)*0.99
A[1,2] = -0.05
C = matrix(c(10,0.1),nrow=1)
mu = matrix(c(0,0),nrow=2)
Sigma_Inn = diag(c(1,0.01)*0.00001,nrow=2)
Sigma_Add = diag(c(1)*0.1,nrow=1)

Y_list = Generate_Data(100,A,C,Sigma_Add,Sigma_Inn, mu_0 = mu,  anomaly_loc = c(10,30,50), 
                      anomaly_type = c("Inn","Add","Inn"), 
                      anomaly_comp = c(1,1,2),  anomaly_strength = c(400,-10,3000))
                      
horizon_matrix = matrix(1,nrow = 3 ,ncol = 2)

Particle_List = IOAORKF(Y_list,mu,Sigma_0=NULL,A,C,Sigma_Add,Sigma_Inn,Particles=20,
                        horizon_matrix=horizon_matrix)

plot(Particle_List)
summary(Particle_List)


</code></pre>


</div>