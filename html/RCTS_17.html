<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_PIC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to determine PIC (panel information criterium)</h2>

<h3>Description</h3>

<p>This depends on kappa1 -&gt; kappaN, through p (=number of nonzero elements of beta_est).
The parameter 'sigma2' is the non-robust sigma2. As it is only used in term 2 to 4, it does not actually matter what its value is (needs to be &gt; 0).
It could be set to 1 as well.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_PIC(
  C,
  robust,
  S,
  k,
  kg,
  e2,
  sigma2,
  NN,
  TT,
  method_estimate_beta,
  beta_est,
  g,
  vars_est,
  choice_pic = "pic2017"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>determines relative contribution of the penalty terms compared to the estimation error term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>TRUE or FALSE: defines using the classical or robust algorithm to estimate beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>number of estimated groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of common factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kg</code></td>
<td>
<p>number of group specific factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e2</code></td>
<td>
<p>NxT matrix with error terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>scalar: sum of squared error terms, scaled by NT</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NN</code></td>
<td>
<p>number of time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TT</code></td>
<td>
<p>length of time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_estimate_beta</code></td>
<td>
<p>defines how beta is estimated. Default case is an estimated beta for each individual. Default value is "individual." Possible values are "homogeneous", "group" or "individual".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_est</code></td>
<td>
<p>estimated values of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Vector with estimated group membership for all individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars_est</code></td>
<td>
<p>number of variables that will be included in the algorithm and have their coefficient estimated. This is usually equal to the number of observable variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice_pic</code></td>
<td>
<p>indicates which PIC to use to estimate the number of groups and factors:
options are "pic2017" (uses the PIC of Ando and Bai (2017); works better for large N),
"pic2016" (Ando and Bai (2016); works better for large T) weighs the fourth term with an extra factor relative to the size of the groups,
and "pic2022" which shrinks the NT-space where the number of groups and factors would be over- or underestimated compared to pic2016 and pic2017.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>numeric
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
NN &lt;- 30
TT &lt;- 10
e &lt;- matrix(rnorm(NN * TT), nrow = NN)
beta_est &lt;- matrix(rnorm(NN * 4), ncol = NN) #random values for beta
g &lt;- round(runif(NN, 1, 3))
calculate_PIC(0.51, TRUE, 3, 0, c(3, 3, 3), e, e^2/(NN*TT), NN, TT, "individual", beta_est, g, 3)
</code></pre>


</div>