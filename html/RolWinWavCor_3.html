<div class="container">

<table style="width: 100%;"><tr>
<td>estim_RWWC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate rolling window wavelet correlation coefficients  
</h2>

<h3>Description</h3>

<p>The <code>estim_RWWC</code> function estimates the rolling window wavelet correlation (RWWC) coefficients between two regular or evenly spaced time series. This function is based on the work of Polanco-Martínez et al. (2018). However, we use the functions <code>modwt</code> and <code>wave.correlation</code> from the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package 'waveslim' (Whitcher et al. 2000, Whitcher 2022) to decompose via MODWT the two time series under study and to estimate the wavelet correlation between these two time series. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">estim_RWWC(inputdata, Wname="la8", J, W, Align="center", Scale=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputdata</code></td>
<td>
 
<p>A matrix of three columns: the first one is the time (regular or evenly spaced) and the other two columns are the variables under study. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wname</code></td>
<td>

<p>Name of the wavelet filter used in the wavelet transform (MODWT) decomposition. There are several wavelet filters to be used, but we use by default the Daubechies orthonormal compactly supported wavelet of length L=8, that is, “<code>la8</code>”. A relatively long wavelet filter (e.g. LA(4) or LA(8)) is adequate to analyse non-stationary time series but also correlation structures that are not stationary, as was pointed out by Fernández-Macho (2018) and Polanco-Martínez et al. (2020). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>

<p>The maximum level of the MODWT decomposition. It is recommended to use <code class="reqn">log_{2}(N) - 3</code>, where <code class="reqn">N</code> is the number of rows or elements of <code>inputdata</code> (Fernández-Macho 2018, Polanco-Martínez et al. 2020). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>The window-length or size of the window used when the rolling window wavelet correlation coefficients are estimated. The optimal window-length is a key question when the RWWC is estimated and the answer is closely related with the time-scales of the phenomenon under study. It is advisable to use one window-length around the target time-scale, not too short and not too long, and always test several window-lengths to analyse its sensibility (Polanco-Martínez et al. (2018)). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Align</code></td>
<td>

<p>This is used to align the rolling object. There are three options: <code>left</code>, <code>center</code> and <code>right</code>, but the <code>center</code> option is used by default to ensure that variations in the correlations are aligned with the variations in the relationships of the variables under study, rather than being shifted to the left or right (Polanco-Martínez 2019, Polanco-Martínez 2020). However, this implies that the window-length must be an odd number.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scale</code></td>
<td>

<p>Scale (by default is “TRUE”; “FALSE”  otherwise) is used to “normalize” or “standardize” the variables under analysis. It is advisable to ”normalize/standardize” the time series under study to have them in the same scales. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>estim_RWWC</code> function estimates the rolling window wavelet correlation coefficients and their statistical significance between two time series sampled on identical time points for a given window-length. The <code>estim_RWWC</code> function is based on the work of Polanco-Martínez et al. (2018), but this function uses the functions <code>modwt</code> and <code>wave.correlation</code> from the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package 'waveslim' package (Whitcher et al. 2000, Whitcher et al. 2022) to decompose via MODWT the two time series under analysis and to compute the wavelet correlation coefficients between these two series. 
</p>


<h3>Value</h3>

<p>Outputs:
A multidimensional matrix containing three columns: the rolling window wavelet correlation coefficients and their respective 95% confidence interval in the second (lower bound) and third (upper bound) columns. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br>
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br>
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br>
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br>
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> <br>
Acknowledgement:<br> 
We acknowledge to the Excellence Unit GECOS (grant reference number CLU-2019-03), Universidad de Salamanca for its funding support. 
</p>


<h3>References</h3>

<p>Polanco-Martínez, J. M., Fernández-Macho, J., Neumann, M. B., &amp; Faria, S. H. (2018). A pre-crisis vs. crisis analysis of peripheral EU stock markets by means of wavelet transform and a nonlinear causality test. Physica A: Statistical Mechanics and its Applications, 490, 1211-1227. &lt;URL: doi: <a href="https://doi.org/10.1016/j.physa.2017.08.065">10.1016/j.physa.2017.08.065</a>&gt;. <br></p>
<p>Fernández-Macho, J. (2018). Time-localized wavelet multiple regression and correlation. Physica A: Statistical Mechanics and its Applications, 492, 1226-1238. &lt;URL: doi: <a href="https://doi.org/10.1016/j.physa.2017.11.050">10.1016/j.physa.2017.11.050</a>&gt;. <br></p>
<p>Whitcher, B., Guttorp, P., &amp; Percival, D. B. (2000). Wavelet analysis of covariance with application to atmospheric time series. Journal of Geophysical Research: Atmospheres, 105(D11), 14941-14962. &lt;URL: doi: <a href="https://doi.org/10.1029/2000JD900110">10.1029/2000JD900110</a>&gt;. <br></p>
<p>Gencay, R., F. Selcuk and B. Whitcher (2001) An Introduction to Wavelets and Other Filtering Methods in Finance and Economics, Academic Press. <br></p>
<p>Whitcher, B. (2022). waveslim: Basic Wavelet Routines for One-, Two-, and Three-Dimensional Signal Processing.  &lt;URL: https://cran.r-project.org/package=waveslim&gt;, R package version 1.8.4.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># We reproduce Figure 2 presented in Polanco-Martínez et al. (2018). 
datPIGS     &lt;- EU_stock_markets 
sindatePIGS &lt;- datPIGS[-1] # To remove dates 
sindatePIGS &lt;- sindatePIGS[c(1:5, 8)]
lrdatPIGS   &lt;- apply(log(sindatePIGS), 2, diff)
lrDATES     &lt;- as.Date(datPIGS[,1][-1])
tsdatPIGS   &lt;- ts(lrdatPIGS, start=1, freq=1)
Nnam        &lt;- dim(tsdatPIGS)[2]
lrdatPIGS   &lt;- lrdatPIGS[,1:Nnam]
inputdata   &lt;- tsdatPIGS[,c(2,5)]

Wname &lt;- "la8"  
J     &lt;- 4    
W     &lt;- 241 
Align &lt;- "center"

rwwc &lt;- estim_RWWC(inputdata, Wname, J, W, Align=Align)
</code></pre>


</div>