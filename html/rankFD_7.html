<div class="container">

<table style="width: 100%;"><tr>
<td>rankFD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank-based tests for general factorial designs</h2>

<h3>Description</h3>

<p>The function implements purely nonparametric rank-based methods for the analysis 
of general factorial designs. You can chose to use either classical ranks (mid-ranks) 
(<code>effect="weighted"</code>) or pseudo-ranks (<code>effect="unweighted"</code>)
for making inference. Pseudo-ranks are used by default. 
The package implements point estimators of relative effects (weighted and unweighted) as
well as test procedures (Wald-Type and ANOVA-Type statistics) for testing global null hypotheses
formulated in either (i) distribution functions <code>hypothesis="H0F"</code> 
or (ii) relative effects <code>hypothesis="H0p"</code>. In case of one-way factorial 
designs, the function additionally computes 
the Kruskal-Wallis test either with ranks or pseudo-ranks. In addition, multiple 
contrast tests (and simultaneous confidence intervals)
for the main or interaction effects are implemented within the <code>contrast</code> 
statement. You can either choose from pre-defined contrasts (options see below) or
you can provide your own user-defined contrast matrix. Both the
Fisher-transformation (<code>sci.method="fisher"</code>) as well as a multivariate
t-approximation (<code>sci.method="multi.t"</code>) are implemented.
The Fisher approximation is used by default. To visualize the results, you can plot
the simultaneous confidence intervals using the <code>plot.sci</code> function.
Furthermore, confidence interval plots for the main or interaction relative effects
(not simultaneous) are available within the <code>plot</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rankFD(
  formula,
  data,
  alpha = 0.05,
  CI.method = c("logit", "normal"),
  effect = c("unweighted", "weighted"),
  hypothesis = c("H0F", "H0p"),
  Factor.Information = FALSE,
  contrast = NULL,
  sci.method = c("fisher", "multi.t"),
  info = TRUE,
  covariance = FALSE,
  rounds = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A model <code>formula</code> object. The left hand side
contains the response variable and the right hand side contains 
the factor variables of interest. An interaction term must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in 
<code>formula</code>. The default option is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A number specifying the significance level; the default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.method</code></td>
<td>
<p>Either "logit" or "normal", specifying the method used for
calculation of the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>In case of weighted, then weighted (by sample sizes) relative 
effects are estimated using classical ranks (mid-ranks) of the data. 
Otherwise, in case of effect="unweighted", unweighted relative 
effects are estimated with pseudo-ranks. The default option is "unweighted" resulting in pseudo-rank statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypothesis</code></td>
<td>
<p>The null hypothesis to be tested, either "H0F" or "H0p". The option "H0F" computes tests for testing hypotheses
formulated in terms of distribution functions. Otherwise, 
hypotheses in relative effects are tested. The latter allows for variance heteroscedasticity even
under the null hypothesis of no treatment effect and thus covers the Nonparametric Behrens-Fisher problem.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Factor.Information</code></td>
<td>
<p>Logical. If TRUE, descriptive statistics with point estimators, standard error as well as confidence intervals for 
each main and interaction effect in the model are printed. The results can furthermore be plotted with the plot function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>a list containing the name of the main or interaction effect (written as group1:group2), 
a pre-defined contrast ("Dunnett", "Tukey", "Sequen", "AVE", "Changepoint", 
"Williams", "Marcus", "McDermott", "UmbrellaWilliams", "GrandMean") or a user-defined contrast matrix. If the contrast coefficients do not
sum up to 0, or if their sum of absolutes differs from 2, the coefficients are normalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sci.method</code></td>
<td>
<p>Either "fisher" or "multi.t" as approximation method for the multiple contrast tests and simultaneous confidence intervals. 
The default option is "fisher".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>Logical. If TRUE, additional output information and explanation is printed to the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance</code></td>
<td>
<p>Logical. If TRUE, the estimated covariance matrix of the vector of relative effects is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rounds</code></td>
<td>
<p>Number of  decimals of the output values. The default option is rounds=4 (4 decimals).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The rankFD() function calculates the Wald-type statistic (WTS), ANOVA-type 
statistic (ATS) as well as multiple contrast tests for general factorial designs 
for testing the null hypotheses <code class="reqn">H_0^F: CF = 0</code> or <code class="reqn">H_0^p: Cp = 0</code>. 
Almost every method explained in the comprehensive textbook from Brunner et al. (2019) 
is implemented in rankFD. The test procedures for testing null hypotheses in distribution 
functions have initially been proposed by Akritas et al. (1997), whereas methods for testing null 
hypotheses formulated in relative effects have been proposed by Brunner et al. (2017). 
We note that the multiple contrast test procedure using Fisher approximation computes critical and 
p-values from a multivariate t-distribution with respective degrees of freedom. Simulation studies by
Konietschke et al. (2012) demonstrated an accurate control of the type-1 error rate and
the procedure is therefore recommended.
</p>


<h3>Value</h3>

<p>A <code>rankFD</code> object containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>Given response and factor names (formula)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Descriptive</code></td>
<td>
<p>Descriptive statistics of the data for all factor
level combinations. Displayed are the number of individuals per factor
level combination (size), the relative effect (Rel.Effect), Standard Error and  100*(1-alpha)% confidence
intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WTS</code></td>
<td>
<p>The value of the WTS along with degrees of freedom of the central chi-square distribution and p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ATS</code></td>
<td>
<p>The value of the ATS, degrees of freedom of the central F distribution and the corresponding p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kruskal-Wallis-Test</code></td>
<td>
<p>The value of the Kruskal-Wallis test along with degrees of freedom and p-value. If effect="unweighted", the Kruskal-Wallis test
using pseudo-ranks is computed. Otherwise, if effect="unweighted", the "established" Kruskal-Wallis test based on ranks is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCTP</code></td>
<td>
<p>Contrast matrix, local Results in terms of point estimates, standard error, value of the test statistic, (1-alpha)100
intervals as well as adjusted p-values. As a summary, the function also returns the global test decision by printing the maximum test
statistic (in absolute value) as well as the (1-alpha) critical value from the multivariate T-distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covariance.Matrix</code></td>
<td>
<p>The estimated covariance matrix of the vector of the estimated relative effects. Note that the vector is multiplied by root N.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Factor.Information</code></td>
<td>
<p>Descriptive tables containing the point estimators, standard errors as well as (1-alpha)100
and interaction effects in the model. The confidence intervals are not simultaneous and for data descriptive purpose only.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Brunner, E., Bathke, A.C., Konietschke, F. Rank and Pseudo-Rank Procedures 
for Independent Observations in Factorial Designs. Springer International Publishing, 2018.
</p>
<p>Brunner, E., Konietschke, F., Pauly, M., Puri, M. L. (2017). Rank-based procedures in factorial designs: 
Hypotheses about non-parametric treatment effects. Journal of the Royal Statistical Society: Series B 
(Statistical Methodology), 79(5), 1463-1485.
</p>
<p>Akritas, M. G., Arnold, S. F., and Brunner, E. (1997). Nonparametric hypotheses and rank statistics for unbalanced factorial designs.
Journal of the American Statistical Association 92, 258-265.
</p>
<p>Brunner, E., Dette, H., and Munk, A. (1997). Box-Type Approximations in Nonparametric Factorial Designs. Journal
of the American Statistical Association 92, 1494-1502.
</p>
<p>Konietschke, F., Hothorn, L. A., Brunner, E. (2012). Rank-based multiple test procedures and simultaneous confidence intervals. Electronic Journal of Statistics,
6, 738-759.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Coal)
model &lt;- rankFD(Acidity ~ NaOH * Type, data = Coal, CI.method = "normal",
effect = "unweighted", hypothesis = "H0F")

data(Muco)
model.oneway &lt;- rankFD(HalfTime ~ Disease, data = Muco, CI.method = "logit",
effect = "weighted", hypothesis = "H0p")
plot(model.oneway)


</code></pre>


</div>