<div class="container">

<table style="width: 100%;"><tr>
<td>simtraits</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate traits for phylopars estimation
</h2>

<h3>Description</h3>

<p>Simulates traits for <code>phylopars</code> estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simtraits(ntaxa = 15, ntraits = 4, nreps = 1, nmissing = 0, tree, v, anc, 
intraspecific, model="BM", parameters, nsim, return.type="data.frame")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ntaxa</code></td>
<td>

<p>Either number of taxa (<code>ntaxa</code>) or a <code>tree</code> can be supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits</code></td>
<td>

<p>Number of traits to be simulated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>

<p>Number of replicates per trait per species to simulate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmissing</code></td>
<td>

<p>Number of randomly missing trait values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>Either number of taxa (<code>ntaxa</code>) or a <code>tree</code> can be supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>

<p>Trait covariance (<code>v</code>) can be optionally supplied; otherwise off-diagonal elements are set to <code>0.8</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anc</code></td>
<td>

<p>Value for ancestral state at root node.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intraspecific</code></td>
<td>

<p>Optional value for within-species variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Model of evolution (default="BM"). Other options include "OUfixedRoot", "OUrandomRoot", "lambda", "kappa", "delta", "EB".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>

<p>List of parameters for the model. alpha for the selection strength in the OU model, lambda, kappa, delta, or rate for the EB model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>Number of simulations to perform (default is 1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.type</code></td>
<td>

<p>Default is "data.frame". Can also specify "matrix" if nreps=1.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trait_data</code></td>
<td>
<p>Data for <code>phylopars()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>The original phylogenetic tree (either provided to the function or generated internally)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_tree</code></td>
<td>
<p>The transformed tree on which trait simulations were performed (identical to tree if model="BM")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>original_X</code></td>
<td>
<p>If within-species variation is simulated, original_X is the original species mean values before adding within-species variation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eric W. Goolsby <a href="mailto:eric.goolsby.evolution@gmail.com">eric.goolsby.evolution@gmail.com</a>
</p>


<h3>References</h3>

<p>Bruggeman J, Heringa J and Brandt BW. (2009) PhyloPars: estimation of missing parameter values using phylogeny. <em>Nucleic Acids Research</em> 37: W179-W184.
</p>
<p>Harmon Luke J, Jason T Weir, Chad D Brock, Richard E Glor, and Wendell Challenger. 2008. GEIGER: investigating evolutionary radiations. Bioinformatics 24:129-131.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate data
sim_data &lt;- simtraits(ntaxa = 15,ntraits = 4,nreps = 3,nmissing = 10)

# estimate parameters under Brownian motion
# pheno_error = TRUE assumes intraspecific variation
# pheno_correlated = FALSE assumes intraspecific variation is not correlated
# phylo_correlated = TRUE assumed traits are correlated

PPE &lt;- phylopars(trait_data = sim_data$trait_data,tree = sim_data$tree,
  pheno_error = TRUE,phylo_correlated = TRUE,pheno_correlated = FALSE)

PPE
</code></pre>


</div>