<div class="container">

<table style="width: 100%;"><tr>
<td>counttest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Count test</h2>

<h3>Description</h3>

<p><code>counttest()</code> conducts a test whether the number of detected outliers
deviates significantly from the expected number of outliers under the null
hypothesis that there are no outliers in the sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">counttest(
  robust2sls_object,
  alpha,
  iteration,
  one_sided = FALSE,
  tsmethod = c("central", "minlike", "blaker")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>robust2sls_object</code></td>
<td>
<p>An object of class <code>"robust2sls"</code> or a
list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric value between 0 and 1 representing the significance
level of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>An integer &gt;= 0 or the character "convergence" that
determines which iteration is used for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one_sided</code></td>
<td>
<p>A logical value whether a two-sided test (<code>FALSE</code>)
should be conducted or a one-sided test (<code>TRUE</code>) that rejects only
when the number of detected outliers is above the expected number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsmethod</code></td>
<td>
<p>A character specifying the method for calculating two-sided
p-values. Ignored for one-sided test.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>outlier_detection()</code> and
<code>multi_cutoff()</code> for creating an object of class
<code>"robust2sls"</code> or a list thereof.
</p>
<p>See <code>exactci::poisson.exact()</code> for the
different methods of calculating two-sided p-values.
</p>


<h3>Value</h3>

<p><code>counttest()</code> returns a data frame with the iteration (m) to be
tested, the actual iteration that was tested (generally coincides with the
iteration that was specified to be tested but is the convergent iteration
if the fixed point is tested), the setting of the probability of exceeding
the cut-off (gamma), the number of detected outliers, the expected number
of outliers under the null hypothesis that there are no outliers, the type
of test (one- or two-sided), the p-value, the significance level
<code>alpha</code>, the decision, and which method was used to calculate
(two-sided) p-values. The number of rows of the data frame corresponds to
the length of the argument <code>robust2sls_object</code>.
</p>


</div>