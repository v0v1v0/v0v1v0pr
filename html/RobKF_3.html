<div class="container">

<table style="width: 100%;"><tr>
<td>Generate_Data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate data from a Kalman model</h2>

<h3>Description</h3>

<p>This function simulates data obeying a Kalman model whilst allowing the user to add innovative and additive anomalies.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Generate_Data(
  n,
  A,
  C,
  Sigma_Add,
  Sigma_Inn,
  mu_0 = NULL,
  anomaly_loc = integer(0),
  anomaly_type = character(0),
  anomaly_comp = integer(0),
  anomaly_strength = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A positive integer giving the number of observations desired</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A matrix giving the updates for the hidden states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>A matrix mapping the hidden states to the observed states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_Add</code></td>
<td>
<p>A positive definite diagonal matrix giving the additive noise covariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_Inn</code></td>
<td>
<p>A positive definite diagonal matrix giving the innovative noise covariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_0</code></td>
<td>
<p>A matrix indicating the mean of the prior for the hidden states. It defaults to a zero-vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anomaly_loc</code></td>
<td>
<p>A vector of integers giving the locations of anomalies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anomaly_type</code></td>
<td>
<p>A vector of strings, either "Add" or "Inn" indicating whether the anomaly is additive or innovative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anomaly_comp</code></td>
<td>
<p>A vector of integers giving the component affected by the anomalies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anomaly_strength</code></td>
<td>
<p>A vector of numerics giving the strength of the anomalies (in sigmas).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of matrices, each corresponding to an observation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(RobKF)
library(ggplot2)

set.seed(2018)

A = diag(2)*0.99
A[1,2] = -0.05
C = matrix(c(10,0.1),nrow=1)
mu = matrix(c(0,0),nrow=2)
Sigma_Inn = diag(c(1,0.01)*0.00001,nrow=2)
Sigma_Add = diag(c(1)*0.1,nrow=1)

Y_list = Generate_Data(100,A,C,Sigma_Add,Sigma_Inn, mu_0 = mu,  anomaly_loc = c(10,30,50), 
                      anomaly_type = c("Inn","Add","Inn"), 
                      anomaly_comp = c(1,1,2),  anomaly_strength = c(400,-10,3000))
                      
qplot(1:100,unlist(Y_list),xlab="time",ylab="observation")+theme_minimal()


</code></pre>


</div>