<div class="container">

<table style="width: 100%;"><tr>
<td>impRZalr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>alr EM-based imputation of rounded zeros</h2>

<h3>Description</h3>

<p>A modified EM alr-algorithm for replacing rounded zeros in compositional
data sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impRZalr(
  x,
  pos = ncol(x),
  dl = rep(0.05, ncol(x) - 1),
  eps = 1e-04,
  maxit = 50,
  bruteforce = FALSE,
  method = "lm",
  step = FALSE,
  nComp = "boot",
  R = 10,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>compositional data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>position of the rationing variable for alr transformation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dl</code></td>
<td>
<p>detection limit for each part</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergence criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bruteforce</code></td>
<td>
<p>if TRUE, imputations over dl are set to dl. If FALSE,
truncated (Tobit) regression is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either “lm” (default) or “MM”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>if TRUE, a stepwise (AIC) procedure is applied when fitting
models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nComp</code></td>
<td>
<p>if determined, it fixes the number of pls components. If
“boot”, the number of pls components are estimated using a
bootstraped cross validation approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of bootstrap samples for the determination of pls
components. Only important for method “pls”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>additional print output during calculations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Statistical analysis of compositional data including zeros runs into
problems, because log-ratios cannot be applied.  Usually, rounded zeros are
considerer as missing not at random missing values. The algorithm first
applies an additive log-ratio transformation to the compositions. Then the
rounded zeros are imputed using a modified EM algorithm.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xOrig </code></td>
<td>
<p>Original data frame or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xImp </code></td>
<td>
<p>Imputed
data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind </code></td>
<td>
<p>Index of the missing values in the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter
</code></td>
<td>
<p>Number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps </code></td>
<td>
<p>eps</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matthias Templ and Karel Hron
</p>


<h3>References</h3>

<p>Palarea-Albaladejo, J., Martin-Fernandez, J.A. Gomez-Garcia, J. (2007) 
A parametric approach for dealing with compositional rounded zeros. 
<em>Mathematical Geology</em>, 39(7), 625-645.
</p>


<h3>See Also</h3>

<p><code>impRZilr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(arcticLake)
x &lt;- arcticLake
## generate rounded zeros artificially:
x[x[,1] &lt; 5, 1] &lt;- 0
x[x[,2] &lt; 47, 2] &lt;- 0
xia &lt;- impRZalr(x, pos=3, dl=c(5,47), eps=0.05)
xia$xImp

</code></pre>


</div>