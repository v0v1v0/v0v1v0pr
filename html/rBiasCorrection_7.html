<div class="container">

<table style="width: 100%;"><tr>
<td>createbarerrorplots</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>createbarerrorplots helper function</h2>

<h3>Description</h3>

<p>Internal function to create relative-error bar plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">createbarerrorplots(
  statstable_pre,
  statstable_post,
  rv,
  type,
  locus_id = NULL,
  plotdir,
  logfilename,
  mode = NULL,
  plot_height = 5,
  plot_width = 7.5,
  plot_textsize = 16
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>statstable_pre</code></td>
<td>
<p>A data.table object, containing the output of
<code>statisticsList_()</code> of the calculated regression parameters (form
the provided calibration data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statstable_post</code></td>
<td>
<p>A data.table object, containing the output of
<code>statisticsList_()</code> of the calculated regression parameters form
the corrected calibration data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rv</code></td>
<td>
<p>A list object. A list that contains additional objects needed
for the algorithms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A single integer. Type of data to be corrected: either "1"
(one locus in many samples, e.g. pyrosequencing data) or "2" (many loci
in one sample, e.g. next-generation sequencing data or microarray data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locus_id</code></td>
<td>
<p>A character string. Default: NULL. ID of the respective
locus (only used in type 2 correction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotdir</code></td>
<td>
<p>A character string. Path to the folder,
where plots are saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logfilename</code></td>
<td>
<p>A character string. Path to a file to save the log
messages (default = paste0(tempdir(), "/log.txt")).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>A character string. Default: NULL. Used to indicate "corrected"
calibration data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_height</code></td>
<td>
<p>A integer value. The height (unit: inch) of the
resulting plots (default: 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_width</code></td>
<td>
<p>A integer value. The width (unit: inch) of the
resulting plots (default: 7.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_textsize</code></td>
<td>
<p>A integer value. The textsize of the
resulting plots (default: 16).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function creates error bar-plots to visualize the relative
error before and after bias correction and writes these plots to the
local filesystem.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# define list object to save all data
rv &lt;- list()
rv$minmax &lt;- TRUE
rv$selection_method &lt;- "RelError"
rv$sample_locus_name &lt;- "Test"
rv$seed &lt;- 1234

# define plotdir
rv$plotdir &lt;- paste0(tempdir(), "/plots/")
dir.create(rv$plotdir)

# define logfilename
logfilename &lt;- paste0(tempdir(), "/log.txt")

# import experimental file
exp_type_1 &lt;- rBiasCorrection::example.data_experimental
rv$fileimport_experimental &lt;- exp_type_1$dat

# import calibration file
cal_type_1 &lt;- rBiasCorrection::example.data_calibration
rv$fileimport_calibration &lt;- cal_type_1$dat
rv$vec_cal &lt;- cal_type_1$vec_cal


# perform regression
regression_results &lt;- regression_utility(
  rv$fileimport_calibration,
  "Testlocus",
  locus_id = NULL,
  rv = rv,
  mode = NULL,
  logfilename,
  minmax = rv$minmax,
  seed = rv$seed
)

# extract regression results
rv$result_list &lt;- regression_results$result_list

# get regression statistics
rv$reg_stats &lt;- statistics_list(
  rv$result_list,
  minmax = TRUE
)

# select the better model based on the sum of squared errrors ("SSE")
rv$choices_list &lt;- better_model(
  statstable_pre = rv$reg_stats,
  selection_method = "SSE"
)

# correct calibration data (to show corrected calibration curves)
solved_eq_h &lt;- solving_equations(datatable = rv$fileimport_calibration,
                                 regmethod = rv$choices_list,
                                 type = 1,
                                 rv = rv,
                                 mode = "corrected",
                                 logfilename = logfilename,
                                 minmax = rv$minmax)
rv$fileimport_cal_corrected_h &lt;- solved_eq_h$results
colnames(rv$fileimport_cal_corrected_h) &lt;- colnames(
  rv$fileimport_calibration
)

# calculate new calibration curves from corrected calibration data
regression_results &lt;- regression_utility(
  data = rv$fileimport_cal_corrected_h,
  samplelocusname = rv$sample_locus_name,
  rv = rv,
  mode = "corrected",
  logfilename = logfilename,
  minmax = rv$minmax,
  seed = rv$seed
)
rv$result_list_hyperbolic &lt;- regression_results$result_list


# save regression statistics to reactive value
rv$reg_stats_corrected_h &lt;- statistics_list(
  resultlist = rv$result_list_hyperbolic,
  minmax = rv$minmax
)

createbarerrorplots(
  statstable_pre = rv$reg_stats,
  statstable_post = rv$reg_stats_corrected_h,
  rv = rv,
  type = 1,
  locus_id = NULL,
  plotdir = rv$plotdir,
  logfilename = logfilename,
  mode = "corrected_h",
  plot_height = 5,
  plot_width = 7.5,
  plot_textsize = 1
)


</code></pre>


</div>