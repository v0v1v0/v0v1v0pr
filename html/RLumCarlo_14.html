<div class="container">

<table style="width: 100%;"><tr>
<td>run_MC_LM_OSL_LOC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run Monte-Carlo Simulation for LM-OSL (localized transitions)</h2>

<h3>Description</h3>

<p>Runs a Monte-Carlo (MC) simulation of linearly modulated optically stimulated
luminescence (LM-OSL) using the generalized one trap (GOT) model. Localized transitions refer to
transitions which do not involve the conduction or valence band. These transitions take place
between the ground state and an excited state of the trap, and also involve
a an energy state of the recombination centre.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_MC_LM_OSL_LOC(
  A,
  times,
  clusters = 10,
  n_filled = 100,
  r,
  method = "par",
  output = "signal",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>numeric (<strong>required</strong>): The optical excitation rate from the ground state into the excited
state of the trap (s^-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>numeric (<strong>required</strong>): The sequence of time steps within the simulation (s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>numeric (<em>with default</em>): The number of created clusters for the MC runs. The input can be the output of create_ClusterSystem. In that case <code>n_filled</code> indicate absolute numbers of a system.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_filled</code></td>
<td>
<p>integer (<em>with default</em>): The number of filled electron traps at the
beginning of the simulation (dimensionless). Can be a vector of <code>length(clusters)</code>, shorter values are recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>numeric (<strong>required</strong>): The retrapping ratio for localized transitions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character (<em>with default</em>): Sequential <code>'seq'</code> or parallel <code>'par'</code>processing. In
the parallel mode the function tries to run the simulation on multiple CPU cores (if available) with
a positive effect on the computation time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>character (<em>with default</em>): output is either the <code>'signal'</code> (the default)
or <code>'remaining_e'</code> (the remaining charges, electrons, in the trap)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, such as <code>cores</code> to control the number of used CPU cores or <code>verbose</code> to silence the terminal</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>The model</strong>
</p>
<p style="text-align: center;"><code class="reqn">
I_{LOC}(t) = -dn/dt = (A * t/P) * (n^2 / (r + n))
</code>
</p>

<p>Where in the function: <br>
A := optical excitation rate from the ground state into the excited state of the trap (1/s)<br>
P := total excitation time (s) <br>
t := time (s) <br>
n := <code>n_filled</code>, the instantaneous number of electrons <br>
r := the retrapping ratio for localized transitions
</p>


<h3>Value</h3>

<p>This function returns an object of class <code>RLumCarlo_Model_Output</code> which
is a list consisting of an array with dimension length(times) x clusters
and a numeric time vector.
</p>


<h3>Function version</h3>

<p>0.1.0
</p>


<h3>How to cite</h3>

<p>Kreutzer, S., 2022. run_MC_LM_OSL_LOC(): Run Monte-Carlo Simulation for LM-OSL (localized transitions). Function version 0.1.0. In: Friedrich, J., Kreutzer, S., Pagonis, V., Schmidt, C., 2022. RLumCarlo: Monte-Carlo Methods for Simulating Luminescence Phenomena. R package version 0.1.9. https://CRAN.R-project.org/package=RLumCarlo
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
</p>


<h3>References</h3>

<p>Pagonis, V., Friedrich, J., Discher, M., Müller-Kirschbaum, A., Schlosser, V.,
Kreutzer, S., Chen, R. and Schmidt, C., 2019. Excited state luminescence signals
from a random distribution of defects: A new Monte Carlo simulation approach for feldspar.
Journal of Luminescence 207, 266–272. <a href="https://doi.org/10.1016/j.jlumin.2018.11.024">doi:10.1016/j.jlumin.2018.11.024</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## short example
run_MC_LM_OSL_LOC(
 A = 1,
 times = 0:40,
 clusters = 10,
 n_filled = 100,
 r = 1e-7,
 method = "seq",
 output = "signal") %&gt;%
plot_RLumCarlo(legend = TRUE)

## Not run: 
## the long (meaningful) example
results &lt;- run_MC_LM_OSL_LOC(
 A = 1,
 times = 0:100,
 clusters = 100,
 n_filled = 100,
 r = 1e-7,
 method = "par",
 output = "signal")

## plot
plot_RLumCarlo(results, legend = TRUE)

## End(Not run)

</code></pre>


</div>