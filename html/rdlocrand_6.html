<div class="container">

<table style="width: 100%;"><tr>
<td>rdwinselect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Window selection for RD designs under local randomization</h2>

<h3>Description</h3>

<p><code>rdwinselect</code> implements the window-selection procedure
based on balance tests for RD designs under local randomization.
Specifically, it constructs a sequence of nested windows around the RD cutoff
and reports binomial tests for the running variable runvar and covariate balance
tests for covariates covariates (if specified). The recommended window is the
largest window around the cutoff such that the minimum p-value of the balance test
is larger than a prespecified level for all nested (smaller) windows. By default,
the p-values are calculated using randomization inference methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdwinselect(
  R,
  X,
  cutoff = 0,
  obsmin = NULL,
  wmin = NULL,
  wobs = NULL,
  wstep = NULL,
  wasymmetric = FALSE,
  wmasspoints = FALSE,
  dropmissing = FALSE,
  nwindows = 10,
  statistic = "diffmeans",
  p = 0,
  evalat = "cutoff",
  kernel = "uniform",
  approx = FALSE,
  level = 0.15,
  reps = 1000,
  seed = 666,
  plot = FALSE,
  quietly = FALSE,
  obsstep = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>a vector containing the values of the running variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the matrix of covariates to be used in the balancing tests. The matrix is optional but the recommended window is only provided when at least one covariate is specified. This should be a matrix of size n x k where n is the total sample size and $k$ is the number of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the RD cutoff (default is 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsmin</code></td>
<td>
<p>the minimum number of observations above and below the cutoff in the smallest window. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmin</code></td>
<td>
<p>the smallest window to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wobs</code></td>
<td>
<p>the number of observations to be added at each side of the cutoff at each step. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wstep</code></td>
<td>
<p>the increment in window length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wasymmetric</code></td>
<td>
<p>allows for asymmetric windows around the cutoff when (<code>wobs</code> is specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmasspoints</code></td>
<td>
<p>specifies that the running variable is discrete and each masspoint should be used as a window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropmissing</code></td>
<td>
<p>drop rows with missing values in covariates when calculating windows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nwindows</code></td>
<td>
<p>the number of windows to be used. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the statistic to be used in the balance tests. Allowed options are <code>diffmeans</code> (difference in means statistic), <code>ksmirnov</code> (Kolmogorov-Smirnov statistic), <code>ranksum</code> (Wilcoxon-Mann-Whitney standardized statistic) and <code>hotelling</code> (Hotelling's T-squared statistic). Default option is <code>diffmeans</code>. The statistic <code>ttest</code> is equivalent to <code>diffmeans</code> and included for backward compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the order of the polynomial for outcome adjustment model (for covariates). Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalat</code></td>
<td>
<p>specifies the point at which the adjusted variable is evaluated. Allowed options are <code>cutoff</code> and <code>means</code>. Default is <code>cutoff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>specifies the type of kernel to use as weighting scheme. Allowed kernel types are <code>uniform</code> (uniform kernel), <code>triangular</code> (triangular kernel) and <code>epan</code> (Epanechnikov kernel). Default is <code>uniform</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>forces the command to conduct the covariate balance tests using a large-sample approximation instead of finite-sample exact randomization inference methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the minimum accepted value of the p-value from the covariate balance tests. Default is .15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>number of replications. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed to be used for the randomization tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>draws a scatter plot of the minimum p-value from the covariate balance test against window length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quietly</code></td>
<td>
<p>suppress output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsstep</code></td>
<td>
<p>the minimum number of observations to be added on each side of the cutoff for the sequence of fixed-increment nested windows. This option is deprecated and only included for backward compatibility.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>recommended window (NA is covariates are not specified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wlist</code></td>
<td>
<p>list of window lengths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>table including window lengths, minimum p-value in each window, corresponding number of the variable with minimum p-value (i.e. column of covariate matrix), Binomial test p-value and sample sizes to the left and right of the cutoff in each window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>summary statistics.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matias Cattaneo, Princeton University. <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>
</p>
<p>Rocio Titiunik, Princeton University. <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>
</p>
<p>Gonzalo Vazquez-Bare, UC Santa Barbara. <a href="mailto:gvazquez@econ.ucsb.edu">gvazquez@econ.ucsb.edu</a>
</p>


<h3>References</h3>

<p>Cattaneo, M.D., R. Titiunik and G. Vazquez-Bare. (2016). <a href="https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2016_Stata.pdf">Inference in Regression Discontinuity Designs under Local Randomization</a>. <em>Stata Journal</em> 16(2): 331-367.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Toy dataset
X &lt;- array(rnorm(200),dim=c(100,2))
R &lt;- X[1,] + X[2,] + rnorm(100)
# Window selection adding 5 observations at each step
# Note: low number of replications to speed up process.
tmp &lt;- rdwinselect(R,X,obsmin=10,wobs=5,reps=500)
# Window selection setting initial window and step
# The user should increase the number of replications.
tmp &lt;- rdwinselect(R,X,wmin=.5,wstep=.125,reps=500)
# Window selection with approximate (large sample) inference and p-value plot
tmp &lt;- rdwinselect(R,X,wmin=.5,wstep=.125,approx=TRUE,nwin=80,quietly=TRUE,plot=TRUE)


</code></pre>


</div>