<div class="container">

<table style="width: 100%;"><tr>
<td>retrieve.angles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extracting a user-specified subset of the evo.dir results</h2>

<h3>Description</h3>

<p>This function takes the result list produced by
<code>evo.dir</code> as the input, and extracts a specific subset of it.
The user may specify whether to extract the set of angles between species
resultant vectors and the MRCA, the size of resultant vectors, or the set of
angles between species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">retrieve.angles(angles.res,wishlist=c("anglesMRCA","angleDir","angles.between.species"),
  random=c("yes","no"),focus=c("node","species","both","none"),
 node=NULL,species=NULL,write2csv=c("no","yes"),csvfile=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>angles.res</code></td>
<td>
<p>the object resulting from <code>evo.dir</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wishlist</code></td>
<td>
<p>specifies whether to extract angles and sizes
(<code>"anglesMRCA"</code>) of resultant vectors between individual species and
the MRCA, angles and sizes (<code>"angleDir"</code>) of vectors between individual
species and a fixed reference vector (the same for all species), or angles
between species resultant vectors (<code>"angles.between.species"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>it needs to be <code>"yes"</code> if <code>'angles.res'</code> object
contains randomization results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focus</code></td>
<td>
<p>it can be <code>"node"</code>, <code>"species"</code>, <code>"both"</code>, or
<code>"none"</code>, whether the user wants the results for a focal node, or for a
given species, for both, or just wants to visualize everything.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>must be indicated if <code>focus = "node"</code> or <code>"both"</code>. As
for <code>evo.dir</code>, the node number must refer to the dichotomic version of
the original tree, as produced by <code>RRphylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>must be indicated if <code>focus = "species"</code> or <code>"both"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write2csv</code></td>
<td>
<p>has been deprecated; please see the argument
<code>csvfile</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>csvfile</code></td>
<td>
<p>if results should be saved to a .csv file, a character
indicating the name of the csv file and the path where it is to be saved.
If no path is indicated the file is stored in the working directory.
If left unspecified, no file will be saved.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>retrieve.angles</code> allows to focalize the extraction to a
particular node, species, or both. Otherwise it returns the whole dataset.
</p>


<h3>Value</h3>

<p><code>retrieve.angles</code> outputs an object of class <code>'data.frame'</code>.
</p>
<p>If <code>wishlist = "anglesMRCA"</code>, the data frame includes:
</p>
<ul>
<li>
<p><strong>MRCA</strong> the most recent common ancestor the angle is
computed to </p>
</li>
<li>
<p><strong>species</strong> species ID </p>
</li>
<li>
<p><strong>angle</strong> the angle
between the resultant vector of species and the MRCA
</p>
</li>
<li>
<p><strong>vector.size</strong> the size of the resultant vector computed from
species to MRCA </p>
</li>
</ul>
<p>If <code>wishlist = "angleDir"</code>, the data frame includes:
</p>
<ul>
<li>
<p><strong>MRCA</strong> the most recent common ancestor the vector is
computed to </p>
</li>
<li>
<p><strong>species</strong> species ID </p>
</li>
<li>
<p><strong>angle.direction</strong>
the angle between the vector of species and a fixed reference
</p>
</li>
<li>
<p><strong>vector.size</strong> the size of the vector of species </p>
</li>
</ul>
<p>If <code>wishlist = "angles.between.species"</code>, the data frame
includes: </p>
<ul>
<li>
<p><strong>MRCA</strong> the most recent common ancestor the
vector is computed from </p>
</li>
<li>
<p><strong>species</strong> pair IDs of the species pair
the "angle between species" is computed for
</p>
</li>
<li>
<p><strong>angleBTWspecies2MRCA</strong> angle between species resultant vectors
to MRCA </p>
</li>
<li>
<p><strong>anglesBTWspecies</strong> angle between species resultant
vectors </p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Pasquale Raia, Silvia Castiglione, Carmela Serio, Alessandro
Mondanaro, Marina Melchionna, Mirko Di Febbraro, Antonio Profico, Francesco
Carotenuto
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
    data("DataApes")
    DataApes$PCstage-&gt;PCstage
    DataApes$Tstage-&gt;Tstage

    cc&lt;- 2/parallel::detectCores()
    RRphylo(tree=Tstage,y=PCstage,clus=cc)-&gt;RR

# Case 1. "evo.dir" without performing randomization
    evo.dir(RR,angle.dimension="rates",pair.type="node",
    node=  57,random="no")-&gt;evo.p

 # Case 1.1 angles and sizes of resultant vectors between individual species and the MRCA:
  # for a focal node
    retrieve.angles(evo.p,wishlist="anglesMRCA",random="no",focus="node",
    node=68)
  # for a focal species
    retrieve.angles(evo.p,wishlist="anglesMRCA",random="no",focus="species",
    species="Sap")
  # for both focal node and species
    retrieve.angles(evo.p,wishlist="anglesMRCA",random="no",focus="both",
    node=68,species="Sap")
  # without any specific requirement
    retrieve.angles(evo.p,wishlist="anglesMRCA",random="no",focus="none")

 # Case 1.2 angles and sizes of vectors between individual species
 #and a fixed reference vector:
  # for a focal node
    retrieve.angles(evo.p,wishlist="angleDir",random="no",focus="node",
    node=68)
  # for a focal species
    retrieve.angles(evo.p,wishlist="angleDir",random="no",focus="species",
    species="Sap")
  # for both focal node and species
    retrieve.angles(evo.p,wishlist="angleDir",random="no",focus="both",
    node=68,species="Sap")
  # without any specific requirement
    retrieve.angles(evo.p,wishlist="angleDir",random="no",focus="none")

 # Case 1.3 angles between species resultant vectors:
  # for a focal node
    retrieve.angles(evo.p,wishlist="angles.between.species",random="no",
    focus="node", node=68)
  # for a focal species
    retrieve.angles(evo.p,wishlist="angles.between.species",random="no",
    focus="species", species="Sap")
  # for both focal node and species
    retrieve.angles(evo.p,wishlist="angles.between.species",random="no",
    focus="both",node=68,species="Sap")
  # without any specific requirement
    retrieve.angles(evo.p,wishlist="angles.between.species",random="no",
    focus="none")


# Case 2. "evo.dir" with performing randomization
    evo.dir(RR,angle.dimension="rates",pair.type="node",node=57,
    random="yes",nrep=10)-&gt;evo.p

 # Case 2.1 angles and sizes of resultant vectors between individual species and the MRCA:
  # for a focal node
    retrieve.angles(evo.p,wishlist="anglesMRCA",random="yes",focus="node",
    node=68)
  # for a focal species
    retrieve.angles(evo.p,wishlist="anglesMRCA",random="yes", focus="species",
    species="Sap")
  # for both focal node and species
    retrieve.angles(evo.p,wishlist="anglesMRCA",random="yes",focus="both",
    node=68,species="Sap")
  # without any specific requirement
    retrieve.angles(evo.p,wishlist="anglesMRCA",random="yes",focus="none")

 # Case 2.2 angles and sizes of vectors between individual species and a fixed reference vector:
  # for a focal node
    retrieve.angles(evo.p,wishlist="angleDir",random="yes",focus="node",
    node=68)
  # for a focal species
    retrieve.angles(evo.p,wishlist="angleDir",random="yes",focus="species",
    species="Sap")
  # for both focal node and species
    retrieve.angles(evo.p,wishlist="angleDir",random="yes",focus="both",
    node=68, species="Sap")
  # without any specific requirement
    retrieve.angles(evo.p,wishlist="angleDir",random="yes",focus="none")

 # Case 2.3 retrieve angles between species resultant vectors:
  # for a focal node
    retrieve.angles(evo.p,wishlist="angles.between.species",random="yes",
    focus="node", node=68)
  # for a focal species
    retrieve.angles(evo.p,wishlist="angles.between.species",random="yes",
    focus="species", species="Sap")
  # for both focal node and species
    retrieve.angles(evo.p,wishlist="angles.between.species",random="yes",
    focus="both",node=68,species="Sap")
  # without any specific requirement
    retrieve.angles(evo.p,wishlist="angles.between.species",random="yes",
    focus="none")
    
## End(Not run)
</code></pre>


</div>