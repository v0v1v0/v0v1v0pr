<div class="container">

<table style="width: 100%;"><tr>
<td>fit_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit probit model to choice data</h2>

<h3>Description</h3>

<p>This function performs Markov chain Monte Carlo simulation for fitting
different types of probit models (binary, multivariate, mixed, latent class,
ordered, ranked) to discrete choice data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_model(
  data,
  scale = "Sigma_1,1 := 1",
  R = 1000,
  B = R/2,
  Q = 1,
  print_progress = getOption("RprobitB_progress"),
  prior = NULL,
  latent_classes = NULL,
  seed = NULL,
  fixed_parameter = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object of class <code>RprobitB_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A character which determines the utility scale. It is of the form
<code style="white-space: pre;">⁠&lt;parameter&gt; := &lt;value&gt;⁠</code>, where <code style="white-space: pre;">⁠&lt;parameter&gt;⁠</code> is either the name of a fixed
effect or <code style="white-space: pre;">⁠Sigma_&lt;j&gt;,&lt;j&gt;⁠</code> for the <code style="white-space: pre;">⁠&lt;j&gt;⁠</code>th diagonal element of <code>Sigma</code>, and
<code style="white-space: pre;">⁠&lt;value&gt;⁠</code> is the value of the fixed parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of iterations of the Gibbs sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The length of the burn-in period, i.e. a non-negative number of samples to
be discarded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>The thinning factor for the Gibbs samples, i.e. only every <code>Q</code>th
sample is kept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_progress</code></td>
<td>
<p>A boolean, determining whether to print the Gibbs sampler progress and the
estimated remaining computation time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A named list of parameters for the prior distributions. See the documentation
of <code>check_prior</code> for details about which parameters can be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latent_classes</code></td>
<td>
<p>Either <code>NULL</code> (for no latent classes) or a list of parameters specifying
the number of latent classes and their updating scheme:
</p>

<ul>
<li> <p><code>C</code>: The fixed number (greater or equal 1) of latent classes,
which is set to 1 per default. If either <code>weight_update = TRUE</code>
or <code>dp_update = TRUE</code> (i.e. if classes are updated), <code>C</code>
equals the initial number of latent classes.
</p>
</li>
<li> <p><code>weight_update</code>: A boolean, set to <code>TRUE</code> to weight-based
update the latent classes. See ... for details.
</p>
</li>
<li> <p><code>dp_update</code>: A boolean, set to <code>TRUE</code> to update the latent
classes based on a Dirichlet process. See ... for details.
</p>
</li>
<li> <p><code>Cmax</code>: The maximum number of latent classes.
</p>
</li>
<li> <p><code>buffer</code>: The number of iterations to wait before a next
weight-based update of the latent classes.
</p>
</li>
<li> <p><code>epsmin</code>: The threshold weight (between 0 and 1) for removing
a latent class in the weight-based updating scheme.
</p>
</li>
<li> <p><code>epsmax</code>: The threshold weight (between 0 and 1) for splitting
a latent class in the weight-based updating scheme.
</p>
</li>
<li> <p><code>distmin</code>: The (non-negative) threshold in class mean difference
for joining two latent classes in the weight-based updating scheme.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Set a seed for the Gibbs sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_parameter</code></td>
<td>
<p>Optionally specify a named list with fixed parameter values for <code>alpha</code>,
<code>C</code>, <code>s</code>, <code>b</code>, <code>Omega</code>, <code>Sigma</code>, <code>Sigma_full</code>,
<code>beta</code>, <code>z</code>, or <code>d</code> for the simulation.
See <a href="https://loelschlaeger.de/RprobitB/articles/v01_model_definition.html">the vignette on model definition</a>
for definitions of these variables.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <a href="https://loelschlaeger.de/RprobitB/articles/v03_model_fitting.html">the vignette on model fitting</a>
for more details.
</p>


<h3>Value</h3>

<p>An object of class <code>RprobitB_fit</code>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>prepare_data()</code> and <code>simulate_choices()</code> for building an
<code>RprobitB_data</code> object
</p>
</li>
<li> <p><code>update()</code> for estimating nested models
</p>
</li>
<li> <p><code>transform()</code> for transforming a fitted model
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data &lt;- simulate_choices(
  form = choice ~ var | 0, N = 100, T = 10, J = 3, seed = 1
)
model &lt;- fit_model(data = data, R = 1000, seed = 1)
summary(model)

</code></pre>


</div>