<div class="container">

<table style="width: 100%;"><tr>
<td>sfar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of an SFAR(1) Model</h2>

<h3>Description</h3>

<p>Estimate a seasonal functional autoregressive (SFAR) model of order 1 for a given functional time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sfar(
  X,
  seasonal,
  cpv = 0.85,
  kn = NULL,
  method = c("MME", "ULSE", "KOE"),
  a = ncol(Coefs)^(-1/6)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a functional time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seasonal</code></td>
<td>
<p>a positive integer variable specifying the seasonality parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpv</code></td>
<td>
<p>a numeric with values in [0,1] which determines the cumulative proportion variance explained by the first kn eigencomponents.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kn</code></td>
<td>
<p>an integer variable specifying the number of eigencomponents.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string giving the method of estimation. The following values are possible:
"MME" for Method of Moments, "ULSE" for Unconditional Least Square Estimation Method, and "KOE" for Kargin-Ontaski Estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a numeric with value in [0,1].</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix of size p*p.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate Brownian motion noise
N &lt;- 300 # the length of the series
n &lt;- 200 # the sample rate that each function will be sampled
u &lt;- seq(0, 1, length.out = n) # argvalues of the functions
d &lt;- 45 # the number of bases
basis &lt;- create.fourier.basis(c(0, 1), d) # the basis system
sigma &lt;- 0.05 # the std of noise norm
Z0 &lt;- matrix(rnorm(N * n, 0, sigma), nrow = n, nc = N)
Z0[, 1] &lt;- 0
Z_mat &lt;- apply(Z0, 2, cumsum) # N standard Brownian motion
Z &lt;- smooth.basis(u, Z_mat, basis)$fd

# Simulate random SFAR(1) data
kr &lt;- function(x, y) {
 (2 - (2 * x - 1)^2 - (2 * y - 1)^2) / 2
}
s &lt;- 5 # the period number
X &lt;- rsfar(kr, s, Z)
plot(X)

# SFAR(1) model parameter estimation:
Model1 &lt;- sfar(X, seasonal = s, kn = 1)
</code></pre>


</div>