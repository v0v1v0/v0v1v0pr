<div class="container">

<table style="width: 100%;"><tr>
<td>rspde.result</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>rSPDE result extraction from INLA estimation results</h2>

<h3>Description</h3>

<p>Extract field and parameter values and distributions
for an rspde effect from an inla result object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rspde.result(
  inla,
  name,
  rspde,
  compute.summary = TRUE,
  parameterization = "detect",
  n_samples = 5000,
  n_density = 1024
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inla</code></td>
<td>
<p>An <code>inla</code> object obtained from a call to
<code>inla()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>A character string with the name of the rSPDE effect
in the inla formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rspde</code></td>
<td>
<p>The <code>inla_rspde</code> object used for the effect in
the inla formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute.summary</code></td>
<td>
<p>Should the summary be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterization</code></td>
<td>
<p>If 'detect', the parameterization from the model will be used. Otherwise, the options are 'spde', 'matern' and 'matern2'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_samples</code></td>
<td>
<p>The number of samples to be used if parameterization is different from the one used to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_density</code></td>
<td>
<p>The number of equally spaced points to estimate the density.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If the model was fitted with <code>matern</code> parameterization (the default), it returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>marginals.range</code></td>
<td>
<p>Marginal densities for the range parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginals.log.range</code></td>
<td>
<p>Marginal densities for log(range)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginals.std.dev</code></td>
<td>
<p>Marginal densities for std. deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginals.log.std.dev</code></td>
<td>
<p>Marginal densities for log(std. deviation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginals.values</code></td>
<td>
<p>Marginal densities for the field values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.log.range</code></td>
<td>
<p>Summary statistics for log(range)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.log.std.dev</code></td>
<td>
<p>Summary statistics for log(std. deviation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.values</code></td>
<td>
<p>Summary statistics for the field values</p>
</td>
</tr>
</table>
<p>If <code>compute.summary</code> is <code>TRUE</code>, then the list will also contain
</p>
<table>
<tr style="vertical-align: top;">
<td><code>summary.kappa</code></td>
<td>
<p>Summary statistics for kappa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.tau</code></td>
<td>
<p>Summary statistics for tau</p>
</td>
</tr>
</table>
<p>If the model was fitted with the <code>spde</code> parameterization, it returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>marginals.kappa</code></td>
<td>
<p>Marginal densities for kappa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginals.log.kappa</code></td>
<td>
<p>Marginal densities for log(kappa)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginals.log.tau</code></td>
<td>
<p>Marginal densities for log(tau)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginals.tau</code></td>
<td>
<p>Marginal densities for tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginals.values</code></td>
<td>
<p>Marginal densities for the field values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.log.kappa</code></td>
<td>
<p>Summary statistics for log(kappa)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.log.tau</code></td>
<td>
<p>Summary statistics for log(tau)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.values</code></td>
<td>
<p>Summary statistics for the field values</p>
</td>
</tr>
</table>
<p>If <code>compute.summary</code> is <code>TRUE</code>, then the list will also contain
</p>
<table>
<tr style="vertical-align: top;">
<td><code>summary.kappa</code></td>
<td>
<p>Summary statistics for kappa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.tau</code></td>
<td>
<p>Summary statistics for tau</p>
</td>
</tr>
</table>
<p>For both cases, if nu was estimated, then the list will also contain
</p>
<table><tr style="vertical-align: top;">
<td><code>marginals.nu</code></td>
<td>
<p>Marginal densities for nu</p>
</td>
</tr></table>
<p>If nu was estimated and a beta prior was used, then the list will
also contain
</p>
<table>
<tr style="vertical-align: top;">
<td><code>marginals.logit.nu</code></td>
<td>
<p>Marginal densities for logit(nu)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.logit.nu</code></td>
<td>
<p>Marginal densities for logit(nu)</p>
</td>
</tr>
</table>
<p>If nu was estimated and a truncated lognormal prior was used,
then the list will also contain
</p>
<table>
<tr style="vertical-align: top;">
<td><code>marginals.log.nu</code></td>
<td>
<p>Marginal densities for log(nu)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.log.nu</code></td>
<td>
<p>Marginal densities for log(nu)</p>
</td>
</tr>
</table>
<p>If nu was estimated and <code>compute.summary</code> is <code>TRUE</code>,
then the list will also contain
</p>
<table><tr style="vertical-align: top;">
<td><code>summary.nu</code></td>
<td>
<p>Summary statistics for nu</p>
</td>
</tr></table>
<h3>Examples</h3>

<pre><code class="language-R"> #tryCatch version
tryCatch({
if (requireNamespace("INLA", quietly = TRUE)){
library(INLA)

set.seed(123)

m &lt;- 100
loc_2d_mesh &lt;- matrix(runif(m * 2), m, 2)
mesh_2d &lt;- inla.mesh.2d(
  loc = loc_2d_mesh,
  cutoff = 0.05,
  max.edge = c(0.1, 0.5)
)
sigma &lt;- 1
range &lt;- 0.2
nu &lt;- 0.8
kappa &lt;- sqrt(8 * nu) / range
op &lt;- matern.operators(
  mesh = mesh_2d, nu = nu,
  range = range, sigma = sigma, m = 2,
  parameterization = "matern"
)
u &lt;- simulate(op)
A &lt;- inla.spde.make.A(
  mesh = mesh_2d,
  loc = loc_2d_mesh
)
sigma.e &lt;- 0.1
y &lt;- A %*% u + rnorm(m) * sigma.e
Abar &lt;- rspde.make.A(mesh = mesh_2d, loc = loc_2d_mesh)
mesh.index &lt;- rspde.make.index(name = "field", mesh = mesh_2d)
st.dat &lt;- inla.stack(
  data = list(y = as.vector(y)),
  A = Abar,
  effects = mesh.index
)
rspde_model &lt;- rspde.matern(
  mesh = mesh_2d,
  nu.upper.bound = 2
)
f &lt;- y ~ -1 + f(field, model = rspde_model)
rspde_fit &lt;- inla(f,
  data = inla.stack.data(st.dat),
  family = "gaussian",
  control.predictor =
    list(A = inla.stack.A(st.dat))
)
result &lt;- rspde.result(rspde_fit, "field", rspde_model)
summary(result)
}
#stable.tryCatch
}, error = function(e){print("Could not run the example")})

</code></pre>


</div>