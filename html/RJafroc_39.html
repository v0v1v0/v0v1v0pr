<div class="container">

<table style="width: 100%;"><tr>
<td>FitBinormalRoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the binormal model to selected treatment and reader in an ROC dataset</h2>

<h3>Description</h3>

<p>Fit the binormal model-predicted ROC curve for a dataset. 
This is the R equivalent of ROCFIT or RSCORE
</p>


<h3>Usage</h3>

<pre><code class="language-R">FitBinormalRoc(dataset, trt = 1, rdr = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>The ROC dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trt</code></td>
<td>
<p>The desired treatment, default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdr</code></td>
<td>
<p>The desired reader, default is 1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the binormal model ratings (more accurately the latent decision variables) 
from diseased cases are sampled from <code class="reqn">N(a,1)</code> while ratings for 
non-diseased cases are sampled from <code class="reqn">N(0,b^2)</code>. To avoid clutter error 
bars are only shown for the lowest and uppermost operating points. An FROC
dataset is internally converted to a highest rating inferred ROC dataset. To
many bins containing zero counts will cause the algorithm to fail; so be sure
to bin the data appropriately to fewer bins, where each bin has at least one
count.
</p>


<h3>Value</h3>

<p>The returned value is a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>The mean of the diseased distribution; 
the non-diseased distribution is assumed to have zero mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>The standard deviation of the non-diseased 
distribution. The diseased distribution is assumed to have 
unit standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zetas</code></td>
<td>
<p>The binormal model cutoffs, zetas or thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUC</code></td>
<td>
<p>The binormal model fitted ROC-AUC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdAUC</code></td>
<td>
<p>The standard deviation of AUC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NLLIni</code></td>
<td>
<p>The initial value of negative LL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NLLFin</code></td>
<td>
<p>The final value of negative LL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ChisqrFitStats</code></td>
<td>
<p>The chisquare goodness of fit results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMat</code></td>
<td>
<p>The covariance matrix of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fittedPlot</code></td>
<td>
<p>A <span class="pkg">ggplot2</span> object containing the 
fitted operating characteristic along with the empirical operating 
points. Use <code>print()</code> to display the object</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Dorfman DD, Alf E (1969) Maximum-Likelihood Estimation of Parameters of Signal-Detection Theory and Determination of Confidence Intervals - 
Rating-Method Data, Journal of Mathematical Psychology 6, 487-496.
</p>
<p>Grey D, Morgan B (1972) Some aspects of ROC curve-fitting: normal and logistic models. Journal of Mathematical Psychology 9, 128-139.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Test with an included ROC dataset
retFit &lt;- FitBinormalRoc(dataset02);## print(retFit$fittedPlot)


## Test with an included FROC dataset; it needs to be binned
## as there are more than 5 discrete ratings levels
binned &lt;- DfBinDataset(dataset05, desiredNumBins = 5, opChType = "ROC")
retFit &lt;- FitBinormalRoc(binned);## print(retFit$fittedPlot)


## Test with single interior point data
fp &lt;- c(rep(1,7), rep(2, 3))
tp &lt;- c(rep(1,5), rep(2, 5))
dataset &lt;- Df2RJafrocDataset(fp, tp)
retFit &lt;- FitBinormalRoc(dataset);## print(retFit$fittedPlot)

## Test with two interior data points
fp &lt;- c(rep(1,7), rep(2, 5), rep(3, 3))
tp &lt;- c(rep(1,3), rep(2, 5), rep(3, 7))
dataset &lt;- Df2RJafrocDataset(fp, tp)
retFit &lt;- FitBinormalRoc(dataset);## print(retFit$fittedPlot)

## Test with TONY data for which chisqr can be calculated
ds &lt;- DfFroc2Roc(dataset01)
retFit &lt;- FitBinormalRoc(ds, 2, 3);## print(retFit$fittedPlot)
retFit$ChisqrFitStats
 
## Test with included degenerate ROC data
retFit &lt;- FitBinormalRoc(datasetDegenerate);## print(retFit$fittedPlot)


 

</code></pre>


</div>