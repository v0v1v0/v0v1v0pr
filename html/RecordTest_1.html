<div class="container">

<table style="width: 100%;"><tr>
<td>RecordTest-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<strong>RecordTest</strong>: A Package for Testing the Classical Record Model</h2>

<h3>Description</h3>

<p><strong>RecordTest</strong> provides data preparation, exploratory data 
analysis and inference tools based on theory of records to describe the 
record occurrence and detect trends, change-points or non-stationarities 
in the tails of the time series. Details about the implemented tools can
be found in Castillo-Mateo, Cebrián and Asín (2023a, 2023b).
</p>


<h3>Details</h3>

<p>The Classical Record Model:
</p>
<p>Record statistics are used primarily to quantify the stochastic behaviour
of a process at never-seen-before values, either upper or lower. The setup
of independent and identically distributed (IID) continuous random 
variables (RVs), often called the classical record model, is 
particularly interesting because the common continuous distribution 
underlying the IID continuous RVs will not affect the distribution of the 
variables relative to the record occurrence. Many fields have begun to use
the theory of records to study these remarkable events. Particularly 
productive is the study of record-breaking temperatures and their 
connection with climate change, but also records in other environmental
fields (precipitations, floods, earthquakes, etc.), economy, biology, 
physics or even sports have been analysed.
See Arnold, Balakrishnan and Nagaraja (1998) for an extensive theoretical
introduction to the theory of records and in particular the classical 
record model. See Foster and Stuart (1954), Diersen and Trenkler (1996, 
2001) and Cebrián, Castillo-Mateo and Asín (2022) for the 
distribution-free trend detection tests, and Castillo-Mateo (2022) for the
distribution-free change-point detection tests based on the classical 
record model. See Castillo-Mateo, Cebrián and Asín (2023b) for the version
as permutation tests. For an easy introduction to <strong>RecordTest</strong> use 
<code>vignette("RecordTest")</code>, and see Castillo-Mateo, Cebrián and Asín 
(2023a).
</p>
<p>This package provides tests to study the hypothesis of the classical 
record model, that is that the record occurrence from a series of values 
observed at regular time units come from an IID series of continuous RVs. 
If we have sequences of independent variables with no seasonal component,
the hypothesis of IID variables is equivalent to test the hypothesis of 
homogeneity and stationarity.
</p>
<p>The functions in the data preparation step:
</p>
<p>The functions admit a vector <code>X</code> corresponding to a single series as
an argument. However, some situations could take advantage of having 
<code class="reqn">M</code> uncorrelated vectors to infer from the sample. Then, the input of
the functions to perform the statistical tools can be a matrix <code>X</code> 
where each column corresponds to a vector formed by the values of a 
series <code class="reqn">X_t</code>, for <code class="reqn">t=1,\ldots,T</code>, so that each row of the matrix
correspond to a time <code class="reqn">t</code>.
</p>
<p>In  many real problems, such as those related to environmental phenomena, 
the series of variables to analyse show a seasonal behaviour, and only one
realisation is available. In order to be able to apply the suggested tools
to detect the existence of a trend, the seasonal component has to be 
removed and a sample of <code class="reqn">M</code> uncorrelated series should be obtained. 
Those problems can be solved by preparing the data adequately. 
A wide set of tools to carry out a preliminary analysis and to prepare 
data with a seasonal pattern are implemented in the following functions.
Note that the <code class="reqn">M</code> series can be dependent if the p-values are 	
approximated by permutations.
</p>
<p><code>series_record</code>: If only the record times are available.
</p>
<p><code>series_split</code>, <code>series_double</code>: To split the
series in several subseries and remove the seasonal component and 
autocorrelation.
</p>
<p><code>series_uncor</code>: To extract a subset of uncorrelated subseries 
</p>
<p><code>series_ties</code>, <code>series_untie</code>: To deal with record
ties.
</p>
<p><code>series_rev</code>: To study the series backwards.
</p>
<p>The functions to compute the record statistics are:
</p>
<p><code>I.record</code>: Computes the observed record indicators. <code>NA</code> 
values are taken as no records unless they appear at <code class="reqn">t = 1</code>.
</p>
<p><code>N.record</code>, <code>Nmean.record</code>: Compute the observed
number of records up to time <code class="reqn">t</code>.
</p>
<p><code>S.record</code>: Computes the observed number of records at every
time <code class="reqn">t</code>, using <code class="reqn">M</code> series.
</p>
<p><code>p.record</code>: Computes the estimated record probability at every
time <code class="reqn">t</code>, using <code class="reqn">M</code> series.
</p>
<p><code>L.record</code>: Computes the observed record times.
</p>
<p><code>R.record</code>: Computes the observed record values.
</p>
<p>The functions to compute the tests:
</p>
<p>All the tests performed are distribution-free/non-parametric tests in 
time series for trend, change-point and non-stationarity in the extremes 
of the distribution based on the null hypothesis that the record 
indicators are independent and the probabilities of record at time <code class="reqn">t</code>
are <code class="reqn">p_t = 1 / t</code>. 
</p>
<p><code>change.point</code>: Implements Castillo-Mateo change-point tests.
</p>
<p><code>foster.test</code>: Implements Foster-Stuart and Diersen-Trenkler
trend tests. 
</p>
<p><code>N.test</code>: Implements tests based on the (weighted) number of
records.
</p>
<p><code>brown.method</code>: Brown's method to combine dependent p-values 
from <code>N.test</code>.
</p>
<p><code>fisher.method</code>: General function to apply Fisher's method to
independent p-values.
</p>
<p><code>p.regression.test</code>: Implements a regression test based on the
record probabilities.
</p>
<p><code>p.chisq.test</code>: Implements a <code class="reqn">\chi^2</code>-test based on the 
record probabilities.
</p>
<p><code>lr.test</code>: Implements likelihood ratio tests based on the 
record indicators.
</p>
<p><code>score.test</code>: Implements score or Lagrange multiplier
tests based on the record indicators.
</p>
<p>The functions to compute the graphical tools:
</p>
<p><code>records</code>: Shows the series remarking its records.
</p>
<p><code>L.plot</code>: Shows record times in several series.
</p>
<p><code>foster.plot</code>: Shows plots based on Foster-Stuart and
Diersen-Trenkler statistics.
</p>
<p><code>N.plot</code>: Shows the (weighted) number of records.
</p>
<p><code>p.plot</code>: Shows the record probabilities in different plots.
</p>
<p>All the tests and graphical tools can be applied to both upper and lower 
records in the forward and backward directions.
</p>
<p>Other functions:
</p>
<p><code>rcrm</code>: Random generation for the classical record model.
</p>
<p><code>dpoisbinom</code>, <code>ppoisbinom</code>, 
<code>qpoisbinom</code>, <code>rpoisbinom</code>: Density, distribution
function, quantile function and random generation for the Poisson binomial
distribution. Related to the probability distribution function of the 
number of records under the null hypothesis.
</p>
<p>Example datasets:
</p>
<p>There are two example datasets included with this package. It is possible
to load these datasets into R using the <code>data</code> function. The 
datasets have their own help file, which can be accessed by 
<code>help([dataset_name])</code>. 
Data included with <strong>RecordTest</strong> are:
</p>
<p><code>TX_Zaragoza</code> - Daily maximum temperatures at Zaragoza 
(Spain).
</p>
<p><code>ZaragozaSeries</code> - Split and uncorrelated subseries 
<code>TX_Zaragoza$TX</code>.
</p>
<p><code>Olympic_records_200m</code> - 200-meter Olympic records from 1900
to 2020.
</p>
<p>To see how to cite <strong>RecordTest</strong> in publications or elsewhere,
use <code>citation("RecordTest")</code>.
</p>


<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo  &lt;jorgecastillomateo@gmail.com&gt;, AC Cebrián, J Asín
</p>


<h3>References</h3>

<p>Arnold BC, Balakrishnan N, Nagaraja HN (1998). 
<em>Records</em>. 
Wiley Series in Probability and Statistics. Wiley, New York.
<a href="https://doi.org/10.1002/9781118150412">doi:10.1002/9781118150412</a>.
</p>
<p>Castillo-Mateo J (2022).
“Distribution-Free Changepoint Detection Tests Based on the Breaking of Records.”
<em>Environmental and Ecological Statistics</em>, <strong>29</strong>(3), 655-676. 
<a href="https://doi.org/10.1007/s10651-022-00539-2">doi:10.1007/s10651-022-00539-2</a>.
</p>
<p>Castillo-Mateo J, Cebrián AC, Asín J (2023a).
“<strong>RecordTest</strong>: An <code>R</code> Package to Analyze Non-Stationarity in the Extremes Based on Record-Breaking Events.”
<em>Journal of Statistical Software</em>, <strong>106</strong>(5), 1-28. 
<a href="https://doi.org/10.18637/jss.v106.i05">doi:10.18637/jss.v106.i05</a>.
</p>
<p>Castillo-Mateo J, Cebrián AC, Asín J (2023b).
“Statistical Analysis of Extreme and Record-Breaking Daily Maximum Temperatures in Peninsular Spain during 1960–2021.”
<em>Atmospheric Research</em>, <strong>293</strong>, 106934.
<a href="https://doi.org/10.1016/j.atmosres.2023.106934">doi:10.1016/j.atmosres.2023.106934</a>.
</p>
<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2), 313-330. 
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>
<p>Diersen J, Trenkler G (1996). “Records Tests for Trend in Location.”
<em>Statistics</em>, <strong>28</strong>(1), 1-12.
<a href="https://doi.org/10.1080/02331889708802543">doi:10.1080/02331889708802543</a>.
</p>
<p>Diersen J, Trenkler G (2001). 
“Weighted Records Tests for Splitted Series of Observations.”
In J Kunert, G Trenkler (eds.), 
<em>Mathematical Statistics with Applications in Biometry: Festschrift in Honour of Prof. Dr. Siegfried Schach</em>, 
pp. 163–178. Lohmar: Josef Eul Verlag.
</p>
<p>Foster FG, Stuart A (1954). 
“Distribution-Free Tests in Time-Series Based on the Breaking of Records.”
<em>Journal of the Royal Statistical Society B</em>, 
<strong>16</strong>(1), 1-22.
<a href="https://doi.org/10.1111/j.2517-6161.1954.tb00143.x">doi:10.1111/j.2517-6161.1954.tb00143.x</a>.
</p>


</div>