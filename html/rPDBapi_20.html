<div class="container">

<table style="width: 100%;"><tr>
<td>get_pdb_file</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Download and Process PDB Files from the RCSB Database</h2>

<h3>Description</h3>

<p>The 'get_pdb_file' function is a versatile tool designed to download Protein Data Bank (PDB) files from the RCSB database.
It supports various file formats such as 'pdb', 'cif', 'xml', and 'structfact', with options for file compression and handling
alternate locations (ALT) and insertion codes (INSERT) in PDB files. This function also provides the flexibility to save
the downloaded files to a specified directory or to a temporary directory for immediate use.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_pdb_file(
  pdb_id,
  filetype = "cif",
  rm.insert = FALSE,
  rm.alt = TRUE,
  compression = TRUE,
  save = FALSE,
  path = NULL,
  verbosity = TRUE,
  download_base_url = DOWNLOAD_BASE_URL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdb_id</code></td>
<td>
<p>A 4-character string specifying the PDB entry of interest (e.g., "1XYZ"). This identifier uniquely represents
a macromolecular structure within the PDB database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filetype</code></td>
<td>
<p>A string specifying the format of the file to be downloaded. The default is 'cif'. Supported file types include:
</p>

<dl>
<dt>'pdb'</dt>
<dd>
<p>The older PDB file format, which provides atomic coordinates and metadata.</p>
</dd>
<dt>'cif'</dt>
<dd>
<p>The Crystallographic Information File (CIF) format, which is a newer standard replacing PDB files.</p>
</dd>
<dt>'xml'</dt>
<dd>
<p>An XML format file, providing structured data that can be easily parsed for various applications.</p>
</dd>
<dt>'structfact'</dt>
<dd>
<p>Structure factor files in CIF format, available for certain PDB entries, containing experimental
data used to determine the structure.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.insert</code></td>
<td>
<p>Logical flag indicating whether to ignore PDB insertion codes. Default is FALSE. If TRUE, records with insertion
codes will be removed from the final data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.alt</code></td>
<td>
<p>Logical flag indicating whether to ignore alternate location indicators (ALT) in PDB files. Default is TRUE. If
TRUE, only the first alternate location is kept, and others are removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compression</code></td>
<td>
<p>Logical flag indicating whether to download the file in a compressed format (e.g., .gz). Default is TRUE,
which is recommended for faster downloads, especially for CIF files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>
<p>Logical flag indicating whether to save the downloaded file to a specified directory. Default is FALSE, which means
the file is processed and optionally saved, but not retained after processing unless specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>A string specifying the directory where the downloaded file should be saved. If NULL, the file is saved in a
temporary directory. If 'save' is TRUE, this path is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>A boolean flag indicating whether to print status messages during the function execution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>download_base_url</code></td>
<td>
<p>A string representing the base URL for the PDB file retrieval. By default, this is set to the global constant <code>DOWNLOAD_BASE_URL</code>, but users can specify a different URL if needed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The 'get_pdb_file' function is an essential tool for structural biologists and bioinformaticians who need to download and
process PDB files for further analysis. By providing options to handle alternate locations and insertion codes, this function
ensures that the data is clean and ready for downstream applications. Additionally, the ability to save files locally or
work with them in a temporary directory provides flexibility for various workflows. Error handling and informative messages
are included to guide the user in case of issues with file retrieval or processing.
</p>


<h3>Value</h3>

<p>A list of class <code>"pdb"</code> containing the following components:
</p>

<dl>
<dt><code>atom</code></dt>
<dd>
<p>A data frame containing atomic coordinate data (ATOM and HETATM records). Each row corresponds to an
atom, and each column to a specific record type (e.g., element, residue, chain).</p>
</dd>
<dt><code>xyz</code></dt>
<dd>
<p>A numeric matrix of class <code>"xyz"</code> containing the atomic coordinates from the ATOM and HETATM records.</p>
</dd>
<dt><code>calpha</code></dt>
<dd>
<p>A logical vector indicating whether each atom is a C-alpha atom (TRUE) or not (FALSE).</p>
</dd>
<dt><code>call</code></dt>
<dd>
<p>The matched call, storing the function call for reference.</p>
</dd>
<dt><code>path</code></dt>
<dd>
<p>The file path where the file was saved, if 'save' was TRUE.</p>
</dd>
</dl>
<p>The function handles errors and warnings for various edge cases, such as unsupported file types, failed downloads, or issues
with reading the file.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # Download a CIF file and process it without saving
  pdb_file &lt;- get_pdb_file(pdb_id = "4HHB", filetype = "cif")

  # Download a PDB file, save it, and remove alternate location records
  pdb_file &lt;- get_pdb_file(pdb_id = "4HHB", filetype = "pdb", save = TRUE, path = tempdir())


</code></pre>


</div>