<div class="container">

<table style="width: 100%;"><tr>
<td>nagelkerke</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo r-squared measures for various models</h2>

<h3>Description</h3>

<p>Produces McFadden, Cox and Snell, and Nagelkerke pseudo 
r-squared measures, along with p-values, for models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nagelkerke(fit, null = NULL, restrictNobs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The fitted model object for which to determine pseudo r-squared.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>The null model object against which to compare the fitted model 
object. The null model must be nested in the fitted model to be 
valid. Specifying the null
is optional for some model object types
and is required for others.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restrictNobs</code></td>
<td>
<p>If <code>TRUE</code>, limits the observations for the null
model to those used in the fitted model.
Works with only some model object types.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Pseudo R-squared values are not directly comparable to the  
R-squared for OLS models.  Nor can they be interpreted as the  
proportion of the variability in the dependent variable that is  
explained by model. Instead pseudo R-squared measures are relative
measures among similar models indicating how well the model
explains the data.
</p>
<p>Cox and Snell is also referred to as ML. Nagelkerke is also  
referred to as Cragg and Uhler.
</p>
<p>Model objects accepted are lm, glm, gls, lme, lmer, lmerTest, nls,
clm, clmm, vglm, glmer, glmmTMB, negbin, zeroinfl, betareg, and rq.            
</p>
<p>Model objects that require the null model to 
be defined are nls, lmer, glmer, and clmm. 
Other objects use the <code>update</code> function to
define the null model.
</p>
<p>Likelihoods are found using ML (<code>REML = FALSE</code>).
</p>
<p>The fitted model and the null model
should be properly nested.
That is, the terms of one need to be a subset of the the other,
and they should have the same set of observations.
One issue arises when there are <code>NA</code>
values in one variable but not another, and observations with 
<code>NA</code> are removed in the model fitting.  The result may be
fitted and null models with
different sets of observations.
Setting <code>restrictNobs</code> to <code>TRUE</code> 
ensures that only observations in
the fit model are used in the null model.
This appears to work for <code>lm</code> and some <code>glm</code> models,
but causes the function to fail for other model
object types.
</p>
<p>Some pseudo R-squared measures may not be appropriate
or useful for some model types.
</p>
<p>Calculations are based on log likelihood values for models.
Results may be different than those based on deviance.
</p>


<h3>Value</h3>

<p>A list of six objects describing the models used, the pseudo 
r-squared values, the likelihood ratio test for the model,
the number of observations for the models,
messages, and any warnings.
</p>


<h3>Acknowledgments</h3>

<p>My thanks to
Jan-Herman Kuiper of Keele University for suggesting
the <code>restrictNobs</code> fix.
</p>


<h3>Author(s)</h3>

<p>Salvatore Mangiafico, <a href="mailto:mangiafico@njaes.rutgers.edu">mangiafico@njaes.rutgers.edu</a>
</p>


<h3>References</h3>

<p><a href="https://rcompanion.org/handbook/G_10.html">https://rcompanion.org/handbook/G_10.html</a>
</p>


<h3>See Also</h3>

<p><code>efronRSquared</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Logistic regression example
data(AndersonBias)
model = glm(Result ~ County + Gender + County:Gender,
           weight = Count,
           data = AndersonBias,
           family = binomial(link="logit"))
nagelkerke(model)

### Quadratic plateau example 
### With nls, the  null needs to be defined
data(BrendonSmall)
quadplat = function(x, a, b, clx) {
          ifelse(x  &lt; clx, a + b * x   + (-0.5*b/clx) * x   * x,
                           a + b * clx + (-0.5*b/clx) * clx * clx)}
model = nls(Sodium ~ quadplat(Calories, a, b, clx),
            data = BrendonSmall,
            start = list(a   = 519,
                         b   = 0.359,
                         clx = 2304))
nullfunct = function(x, m){m}
null.model = nls(Sodium ~ nullfunct(Calories, m),
             data = BrendonSmall,
             start = list(m   = 1346))
nagelkerke(model, null=null.model)

</code></pre>


</div>