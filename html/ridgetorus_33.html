<div class="container">

<table style="width: 100%;"><tr>
<td>bvm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density evaluation, sampling, and parameter estimation of the
bivariate sine von Mises distribution</h2>

<h3>Description</h3>

<p>Computation of the density and normalizing constant
<code class="reqn">T(\kappa_1, \kappa_2, \lambda)</code> of the bivariate sine von Mises
</p>
<p style="text-align: center;"><code class="reqn">f(\theta_1, \theta_2)= T(\kappa_1, \kappa_2, \lambda)
\exp\{\kappa_1 \cos(\theta_1-\mu_1) +
\kappa_2 \cos(\theta_2-\mu_2) +
\lambda \sin(\theta_1-\mu_1) \sin(\theta_2-\mu_2)\}.</code>
</p>

<p>Simulation of samples from a bivariate sine von Mises.
</p>
<p>Maximum likelihood and method of moments estimation of the
parameters <code class="reqn">(\mu_1, \mu_2, \kappa_1, \kappa_2, \lambda)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d_bvm(x, mu, kappa, log_const = NULL)

const_bvm(kappa, M = 25, MC = 10000)

r_bvm(n, mu, kappa)

fit_bvm_mm(
  x,
  lower = c(0, 0, -30),
  upper = c(30, 30, 30),
  start = NULL,
  M = 25,
  hom = FALSE,
  indep = FALSE,
  ...
)

fit_bvm_mle(
  x,
  start = NULL,
  M = 25,
  lower = c(-pi, -pi, 0, 0, -30),
  upper = c(pi, pi, 30, 30, 30),
  hom = FALSE,
  indep = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix of size <code>c(nx, 2)</code> with the angles on which the density
is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>circular means of the density, a vector of length <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>vector of length <code>3</code> with the concentrations
<code class="reqn">(\kappa_1, \kappa_2)</code> and the dependence parameter <code class="reqn">\lambda</code>
of the density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_const</code></td>
<td>
<p>logarithm of the normalizing constant. Computed internally
if <code>NULL</code> (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>truncation of the series expansion for computing the normalizing
constant. Defaults to <code>25</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>
<p>Monte Carlo replicates for computing the normalizing
constant when there is no series expansion. Defaults to <code>1e4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>
<p>vectors of length <code>5</code> with the bounds for the
likelihood optimizer. Default to <code>c(-pi, -pi, 0, 0, -30)</code> and
<code>c(pi, pi, 30, 30, 30)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a vector of length <code>5</code> with the initial values for the
maximum likelihood optimizer. The first two entries are disregarded in
<code>fit_bvm_mm</code>. If <code>NULL</code> (default), the starting values are taken
from the estimation of marginal von Mises in <code>fit_bvm_mm</code>. In
<code>fit_bvm_mle</code>, the method of moments estimates are employed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hom</code></td>
<td>
<p>assume a homogeneous distribution with equal marginal
concentrations? Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indep</code></td>
<td>
<p>set the dependence parameter to zero? Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters passed to
<code>mleOptimWrapper</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li> <p><code>d_bvm</code>: a vector of length <code>nx</code> with the density evaluated
at <code>x</code>.
</p>
</li>
<li> <p><code>const_bvm</code>: the value of the normalizing constant
<code class="reqn">T(\kappa_1, \kappa_2, \lambda)</code>.
</p>
</li>
<li> <p><code>r_bvm</code>: a matrix of size <code>c(n, 2)</code> with the random sample.
</p>
</li>
<li> <p><code>fit_mme_bvm, fit_mle_bvm</code>: a list with the estimated parameters
<code class="reqn">(\mu_1, \mu_2, \kappa_1, \kappa_2, \lambda)</code> and the object <code>opt</code>
containing the optimization summary.
</p>
</li>
</ul>
<h3>References</h3>

<p>Mardia, K. V., Hughes, G., Taylor, C. C., and Singh, H. (2008).
A multivariate von Mises with applications to bioinformatics.
<em>Canadian Journal of Statistics</em>, 36(1):99–109.
<a href="https://doi.org/10.1002/cjs.5550360110">doi:10.1002/cjs.5550360110</a>
</p>
<p>Singh, H., Hnizdo, V., and Demchuk, E. (2002). Probabilistic model for two
dependent circular variables. <em>Biometrika</em>, 89(3):719–723.
<a href="https://doi.org/10.1093/biomet/89.3.719">doi:10.1093/biomet/89.3.719</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Density evaluation

mu &lt;- c(0, 0)
kappa &lt;- 3:1
nth &lt;- 50
th &lt;- seq(-pi, pi, l = nth)
x &lt;- as.matrix(expand.grid(th, th))
const &lt;- const_bvm(kappa = kappa)
d &lt;- d_bvm(x = x, mu = mu, kappa = kappa, log_const = log(const))
filled.contour(th, th, matrix(d, nth, nth), col = viridisLite::viridis(31),
               levels = seq(0, max(d), l = 30))

## Sampling and estimation

n &lt;- 100
samp &lt;- r_bvm(n = n, mu = mu, kappa = kappa)
(param_mm &lt;- fit_bvm_mm(samp)$par)
(param_mle &lt;- fit_bvm_mle(samp)$par)
</code></pre>


</div>