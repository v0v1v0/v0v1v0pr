<div class="container">

<table style="width: 100%;"><tr>
<td>LightResponseCurveFitter_optimLRCOnAdjustedPrior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>LightResponseCurveFitter optimLRCOnAdjustedPrior</h2>

<h3>Description</h3>

<p>Lower bound flux uncertainty and adjust prior uncertainty before calling optimLRC</p>


<h3>Usage</h3>

<pre><code class="language-R">LightResponseCurveFitter_optimLRCOnAdjustedPrior(theta, 
    iOpt, dsDay, parameterPrior, ctrl, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric vector of starting values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iOpt</code></td>
<td>
<p>integer vector: positions of subset of parameters
that are optimized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsDay</code></td>
<td>
<p>dataframe of NEE, sdNEE and predictors Rg, VPD and Temp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterPrior</code></td>
<td>
<p>numeric vector of prior parameter estimates
(corresponding to theta) # TODO rename to thetaPrior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrl</code></td>
<td>
<p>list of further controls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to
<code>LightResponseCurveFitter_optimLRC</code>
(passed to <code>LightResponseCurveFitter_computeCost</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Only those records are used for optimization where both NEE
and sdNEE are finite.
In larger settings, already filtered at
</p>
<p>Optimization of LRC parameters takes into account the uncertainty
of the flux values. In order to avoid very strong leverage, values with a
very low uncertainty (&lt; a lower quantile) are assigned the lower quantile is
assigned. This procedure downweighs records with a high uncertainty, but does
not apply a large leverage for records with a very low uncertainty. Avoid
this correction by setting <code>ctrl$isBoundLowerNEEUncertainty =
FALSE</code>
</p>
<p>The uncertainty of the prior, that maybe derived from fluxes)  is allowed to
adapt to the uncertainty of the fluxes.
This is done in <code>link{LightResponseCurveFitter_getPriorScale}</code></p>


<h3>Value</h3>

<p>result of <code>LightResponseCurveFitter_optimLRC</code> with
items theta, iOpt and convergence</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


</div>