<div class="container">

<table style="width: 100%;"><tr>
<td>use_workflow</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use GitHub Actions workflow</h2>

<h3>Description</h3>

<p>Create workflow that calls an 
<a href="https://github.com/neurogenomics/rworkflows">rworkflows</a>
<a href="https://github.com/features/actions">GitHub Actions (GHA)</a>
</p>


<h3>Usage</h3>

<pre><code class="language-R">use_workflow(
  template = "rworkflows",
  name = template,
  tag = "@master",
  on = c("push", "pull_request"),
  branches = c("master", "main", "devel", "RELEASE_**"),
  runners = construct_runners(),
  github_token = "${{ secrets.GITHUB_TOKEN }}",
  cache_version = "cache-v1",
  enable_act = FALSE,
  run_bioccheck = FALSE,
  run_rcmdcheck = TRUE,
  as_cran = TRUE,
  run_vignettes = TRUE,
  has_testthat = TRUE,
  has_runit = FALSE,
  run_covr = TRUE,
  has_latex = FALSE,
  tinytex_installer = "TinyTeX-1",
  tinytex_version = NULL,
  pandoc_version = "2.19",
  run_pkgdown = TRUE,
  run_docker = FALSE,
  docker_registry = "ghcr.io",
  docker_user = NULL,
  docker_org = docker_user,
  docker_token = "${{ secrets.DOCKER_TOKEN }}",
  miniforge_variant = FALSE,
  miniforge_version = NULL,
  activate_environment = "test",
  environment_file = NULL,
  channels = NULL,
  save_dir = here::here(".github", "workflows"),
  return_path = TRUE,
  force_new = FALSE,
  preview = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>
<p>Workflow template name.
</p>

<dl>
<dt>"rworkflows"</dt>
<dd>
<p>A short workflow script that calls
the GitHub action from the GitHub Marketplace.
The action is continually updated 
so users do not need to worry about maintaining it.</p>
</dd>
<dt>"rworkflows_static"</dt>
<dd>
<p>A longer workflow scripts that 
explicitly copies all steps from the <span class="pkg">rworkflows</span> action
into a static file. Users may need to update this file themselves over time,
though this does allow for a fully customisable workflow.</p>
</dd>
</dl>
<p>Optionally, you can include the suffix ":&lt;branch&gt;" to specify which branch 
you would like to download the "action.yml" file from to create the 
static workflow template.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>An arbitrary name to call the workflow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag</code></td>
<td>
<p>Which version of the <code>rworkflows</code> action to use. 
Can be a branch name on the
<a href="https://github.com/neurogenomics/rworkflows/branches">
GitHub repository</a> (e.g. "\@master"), 
or a <a href="https://github.com/neurogenomics/rworkflows/tags">Release Tag</a> 
(e.g. "\@v1").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>on</code></td>
<td>
<p>GitHub trigger conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branches</code></td>
<td>
<p>GitHub trigger branches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runners</code></td>
<td>
<p>Runner configurations for multiple Operating Systems (OS), 
including R versions, Bioc versions, and container sources.
Can use the construct_runners functions to assist 
in constructing customized runners configurations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>github_token</code></td>
<td>
<p>GitHub authentication token with permissions to push 
to the R package's GitHub repository. 
Also used to bypass GitHub download limits.
By default, uses {{ secrets.GITHUB_TOKEN }}
which is automatically set up by GitHub. 
However users can also choose to pass a custom GitHub secret variable
(e.g. {{ secrets.PAT_GITHUB }}) which allows access to private
repositories.
Read 
<a href="https://docs.github.com/en/actions/security-guides/automatic-token-authentication">
here for more details</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache_version</code></td>
<td>
<p>Name of the cache sudirectory to be used
when reinstalling software in GHA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enable_act</code></td>
<td>
<p>Whether to add extra lines to the yaml to 
enable local workflow checking with 
<a href="https://github.com/nektos/act">act</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_bioccheck</code></td>
<td>
<p>Run Bioconductor checks using
<a href="https://doi.org/doi:10.18129/B9.bioc.BiocCheck">
<code>BiocCheck::BiocCheck()</code></a>. 
Must pass in order to continue workflow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_rcmdcheck</code></td>
<td>
<p>Run R CMD checks using 
<a href="https://rcmdcheck.r-lib.org/"><code>rcmdcheck::rcmdcheck()</code></a>. 
Must pass in order to continue workflow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as_cran</code></td>
<td>
<p>When running R CMD checks, 
use the '–as-cran' flag to apply CRAN standards</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_vignettes</code></td>
<td>
<p>Build and check R package vignettes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>has_testthat</code></td>
<td>
<p>Run unit tests and report results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>has_runit</code></td>
<td>
<p>Run R Unit tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_covr</code></td>
<td>
<p>Run code coverage tests and publish results to codecov.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>has_latex</code></td>
<td>
<p>Install a suite of LaTeX dependencies used for 
rendering Sweave (.rnw) and other documentation files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tinytex_installer</code></td>
<td>
<p>Which release of tinytex (bundles of LaTeX
packages) to use. All options can be found 
<a href="https://github.com/rstudio/tinytex-releases/">here</a>.
Note, 'TinyTeX-2' is only available for <code>tinytex_version='daily'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tinytex_version</code></td>
<td>
<p>Which version of tinytex to use. 
When set to ”, uses the latest daily build.
All versions can be found 
<a href="https://github.com/rstudio/tinytex-releases/releases">here</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pandoc_version</code></td>
<td>
<p>Which version of pandoc to use.
For details see  
<a href="https://github.com/r-lib/actions/tree/v2-branch/setup-pandoc">here</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_pkgdown</code></td>
<td>
<p>Knit the <em>README.Rmd</em> (if available), 
build documentation website, and deploy to <em>gh-pages</em> branch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_docker</code></td>
<td>
<p>Whether to build and push a Docker container to DockerHub.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>docker_registry</code></td>
<td>
<p>Docker container registry to push to. 
Options include:
</p>

<dl>
<dt>"ghcr.io" : </dt>
<dd>
<p><a href="https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry">
GitHub Container Registry</a></p>
</dd>  
<dt>"docker.io" : </dt>
<dd>
<p><a href="https://hub.docker.com/">DockerHub</a></p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>docker_user</code></td>
<td>
<p>Docker registry username.
Not used when <code>docker_registry="ghcr.io"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>docker_org</code></td>
<td>
<p>Docker registry organization name. 
Is the same as <code>docker_user</code> by default.
Not used when <code>docker_registry="ghcr.io"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>docker_token</code></td>
<td>
<p>Docker registry token.
Not used when <code>docker_registry="ghcr.io"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miniforge_variant</code></td>
<td>
<p>If provided, this variant of Miniforge will be
downloaded and installed. If <code>miniforge_variant=false</code>, 
Miniforge will not be installed at all.
If <code>miniforge_variant=""</code>, the "Miniforge3" variant will be installed.
If <code>miniforge_version</code> is not provided, the <code>latest</code> 
version will be used.
Currently-known values: - "Miniforge3" (default) - "Miniforge-pypy3" -
"Mambaforge" - "Mambaforge-pypy3".
Visit
https://github.com/conda-forge/miniforge/releases/ for more information on
available variants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miniforge_version</code></td>
<td>
<p>If provided, this version of the given Miniforge
variant will be downloaded and installed. If <code>miniforge_variant</code> is 
not provided, "Miniforge3" will be used. Visit
https://github.com/conda-forge/miniforge/releases/ for more information on
available versions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>activate_environment</code></td>
<td>
<p>Environment name (or path) to activate on all 
shells. Default is "test" which will be created in <em>$CONDA/envs/test</em>. 
If an empty string is used, no environment is activated by default 
(For "base" activation see the <code>auto-activate-base</code> option). 
If the environment does not exist, it will
be created and activated. If <code>environment-file</code> is used and you want 
that to be the environment used, you need to explicitly provide the name of
that environment on <code>activate-environment</code>. 
If using <code>sh/bash/cmd.exe</code>
shells please read the IMPORTANT! section on the README.md! to properly
activate conda environments on these shells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment_file</code></td>
<td>
<p>Path or URL to a .yml file to build the 
conda environment with. For more information see
<a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#creating-an-environment-from-an-environment-yml-file">
here</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channels</code></td>
<td>
<p>Conda configuration. Comma separated list of channels 
to use in order of priority. See
<a href="https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/">here</a>
for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_dir</code></td>
<td>
<p>Directory to save workflow to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_path</code></td>
<td>
<p>Return the path to the saved <em>yaml</em> workflow file
(default: <code>TRUE</code>), or return the <em>yaml</em> object directly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_new</code></td>
<td>
<p>If the GHA workflow yaml already exists, 
overwrite with new one (default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preview</code></td>
<td>
<p>Print the yaml file to the R console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print messages.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Path or yaml object.
</p>


<h3>Source</h3>

<p><a href="https://github.com/vubiostat/r-yaml/issues/5">
Issue reading in "on:"/"y","n" elements</a>.
</p>
<p><a href="https://github.com/vubiostat/r-yaml/issues/123">
Issue writing "on:" as "'as':"</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">path &lt;- use_workflow(save_dir = file.path(tempdir(),".github","workflows"))
</code></pre>


</div>