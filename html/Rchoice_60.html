<div class="container">

<table style="width: 100%;"><tr>
<td>ivpml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Instrumental Variable Probit model by Maximum Likelihood.</h2>

<h3>Description</h3>

<p>Estimation of Probit model with one endogenous and continuous variable by Maximum Likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ivpml(formula, data, messages = TRUE, ...)

## S3 method for class 'ivpml'
terms(x, ...)

## S3 method for class 'ivpml'
model.matrix(object, ...)

## S3 method for class 'ivpml'
estfun(x, ...)

## S3 method for class 'ivpml'
bread(x, ...)

## S3 method for class 'ivpml'
vcov(object, ...)

## S3 method for class 'ivpml'
df.residual(object, ...)

## S3 method for class 'ivpml'
coef(object, ...)

## S3 method for class 'ivpml'
logLik(object, ...)

## S3 method for class 'ivpml'
print(x, ...)

## S3 method for class 'ivpml'
summary(object, eigentol = 1e-12, ...)

## S3 method for class 'summary.ivpml'
print(x, digits = max(3, getOption("digits") - 2), ...)

## S3 method for class 'ivpml'
predict(object, newdata = NULL, type = c("xb", "pr", "stdp"), asf = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model of the form <code>y ~ x | z</code> where <code>y</code> is the binary dependent variable, <code>x</code> includes the exogenous and the endogenous continuous variable, and <code>z</code> is the complete set of instruments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data of class <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>if <code>TRUE</code>, then additional messages for the estimation procedure are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>maxLik</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>an object of class <code>ivpml</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigentol</code></td>
<td>
<p>the standard errors are only calculated if the ratio of the smallest and largest eigenvalue of the Hessian matrix is less than <code>eigentol</code>.  Otherwise the Hessian is treated as singular.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of digits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with which to predict.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of prediction required. The default, <code>type = xb</code>, is on the linear prediction. If <code>type = pr</code>, the predicted probabilities of a positive outcome is returned. Finally, if <code>type = stdp</code> the standard errors of the linear predictions for each individual is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asf</code></td>
<td>
<p>if <code>TRUE</code>, the average structural function is used. This option is not allowed with <code>xb</code> or <code>stdp</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The IV probit for cross-sectional data has the following structure:
</p>
<p style="text-align: center;"><code class="reqn">
y_{1i}^*  = x_i^\top\beta + \gamma y_{2i}+ \epsilon_i,
</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
 y_{2i}  = z_i^\top\delta +  \upsilon_i,   
</code>
</p>

<p>where <code class="reqn">y_{1i}^*</code> is the latent (unobserved) dependent variable for individual <code class="reqn">i = 1,...,N</code>; 
<code class="reqn">y_{2i}</code> is the endogenous continuous variable; <code class="reqn">z_i</code> is the vector of exogenous variables 
which also includes the instruments for <code class="reqn">y_{2i}</code>; 
and <code class="reqn">(\epsilon, \upsilon)</code> are normal jointly distributed.
</p>
<p>The model is estimated using the <code>maxLik</code> function from <code>maxLik</code> package using 
analytic gradient.
</p>


<h3>Author(s)</h3>

<p>Mauricio Sarrias.
</p>


<h3>References</h3>

<p>Greene, W. H. (2012). Econometric Analysis. 7 edition. Prentice Hall.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
# Data
library("AER")
data("PSID1976")
PSID1976$lfp  &lt;- as.numeric(PSID1976$participation == "yes")
PSID1976$kids &lt;- with(PSID1976, factor((youngkids + oldkids) &gt; 0,
                                      levels = c(FALSE, TRUE), 
                                      labels = c("no", "yes")))
                                      
# IV probit model by MLE
# (nwincome is endogenous and heducation is the additional instrument)
PSID1976$nwincome &lt;- with(PSID1976, (fincome - hours * wage)/1000)
fiml.probit &lt;- ivpml(lfp ~  education + experience + I(experience^2) + age + 
                            youngkids + oldkids + nwincome |
                            education + experience + I(experience^2) + age + 
                            youngkids + oldkids + heducation, 
                     data = PSID1976)
summary(fiml.probit)

</code></pre>


</div>