<div class="container">

<table style="width: 100%;"><tr>
<td>mvregmed.grid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a grid of mvregmed models over a vector of lambda penalty parameters
</h2>

<h3>Description</h3>

<p>For each lambda in an input vector of values, fit a penalized mvregmed
model
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvregmed.grid(x, mediator, y, lambda.vec, max.outer = 5000,
max.inner = 2, x.std = TRUE, med.std = TRUE, y.std = TRUE,
step.multiplier = 0.5, print.iter = FALSE, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>matrix with columns representing "exposure" variable (sometimes called instrumental variable)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mediator</code></td>
<td>

<p>matrix with columns representing mediator variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>matrix with columns representing outcome variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.vec</code></td>
<td>

<p>Vector of values of penalty parameter lambda's
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.outer</code></td>
<td>

<p>maximum number of outer loop iterations. The outer loop cycles over several inner loops.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.inner</code></td>
<td>

<p>maximum number of iterations for each inner loop. There is an inner loop
for each paramemeter in the matrices alpha, beta, delta, and vary.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize x by dividing by
standard devation of x. Note that each column of x will be centered on its mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>med.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize mediator by dividing by
standard devation of mediator. Note that each column of mediator will be centered on its mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize y by dividing by
standard devation of y. Note that each column of y will be centered on its mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.multiplier</code></td>
<td>

<p>In inner loop, the step size is shrunk by the step.multiplier to
assure that step size is not too large. Generally, the default of
0.5 works well.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.iter</code></td>
<td>

<p>print iteration number during fitting routine
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.cor</code></td>
<td>

<p>maximum correlation within y, x, or mediators, so fitting is more robust
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class mvregmed.grid
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code>mvregmed.fit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(medsim)
  mvfit.grid &lt;- mvregmed.grid(x, med[,1:10], y, lambda.vec=seq(.3, .04, by=-.01))
  summary(mvfit.grid)
  ## plot(mvfit.grid)
</code></pre>


</div>