<div class="container">

<table style="width: 100%;"><tr>
<td>cor_spearman</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spearman's correlation coefficient for multivariate functional data</h2>

<h3>Description</h3>

<p>This function computes the Spearman's correlation coefficient for a
multivariate functional dataset, with either a Modified Epigraph Index (MEI)
or Modified Hypograph Index (MHI) ranking of univariate elements of data
components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cor_spearman(mfD, ordering = "MEI")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mfD</code></td>
<td>
<p>a multivariate functional dataset whose Spearman's correlation
coefficient must be computed, in form of multivariate <code>mfData</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordering</code></td>
<td>
<p>the ordering relation to use on functional observations,
either <code>"MEI"</code> for MEI or <code>"MHI"</code> for MHI (default is
<code>"MEI"</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a multivariate functional dataset, with first components <code class="reqn">X^1_1(t),
X^1_2(t), \ldots, X^1_N(t)</code>, second components <code class="reqn">X^2_1(t), X^2_2(t),
\ldots, X^2_N(t)</code>, etc., the function exploits either the MEI or MHI to
compute the matrix of Spearman's correlation coefficients. Such matrix is
symmetrical and has ones on the diagonal. The entry (i, j) represents the
Spearman correlation coefficient between curves of component i and j.
</p>
<p>See the references for more details.
</p>


<h3>Value</h3>

<p>If the original dataset is bivariate, the function returns only the
scalar value of the correlation coefficient for the two components. When
the number of components is L &gt;2, it returns the whole matrix of Spearman's
correlation coefficients for all the components.
</p>


<h3>References</h3>

<p>Valencia, D., Romo, J. and Lillo, R. (2015). Spearman coefficient for
functions, <em>Universidad Carlos III de Madrid technical report</em>,
<code>http://EconPapers.repec.org/RePEc:cte:wsrepe:ws133329</code>.
</p>


<h3>See Also</h3>

<p><code>mfData</code>, <code>MEI</code>, <code>MHI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#### TOTALLY INDEPENDENT COMPONENTS

N = 2e2
P = 1e3

grid = seq( 0, 1, length.out = P )

# Creating an exponential covariance function to simulate guassian data
Cov = exp_cov_function( grid, alpha = 0.3, beta = 0.4 )

# Simulating (independent) gaussian functional data with given center and
# covariance function
Data_1 = generate_gauss_fdata( N, centerline = sin( 2 * pi * grid ), Cov = Cov )
Data_2 = generate_gauss_fdata( N, centerline = sin( 2 * pi * grid ), Cov = Cov )

# Using the simulated data as (independent) components of a bivariate functional
# dataset
mfD = mfData( grid, list( Data_1, Data_2 ) )

# Correlation approx. zero (components were created independently)
cor_spearman( mfD, ordering = 'MEI' )

# Correlation approx. zero (components were created independently)
cor_spearman( mfD, ordering = 'MHI' )

#### TOTALLY DEPENDENT COMPONENTS

# Nonlinear transform of first component
Data_3 = t( apply( Data_1, 1, exp ) )

# Creating bivariate dataset starting from nonlinearly-dependent components
mfD = mfData( grid, list( Data_1, Data_3 ) )

# Correlation very high (components are nonlinearly dependent)
cor_spearman( mfD, ordering = 'MEI' )

# Correlation very high (components are nonlinearly dependent)
cor_spearman( mfD, ordering = 'MHI' )

</code></pre>


</div>