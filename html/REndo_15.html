<div class="container">

<table style="width: 100%;"><tr>
<td>latentIV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Linear Models with one Endogenous Regressor using Latent Instrumental Variables</h2>

<h3>Description</h3>

<p>Fits linear models with one endogenous regressor and no additional explanatory variables using the latent instrumental variable approach
presented in Ebbes, P., Wedel, M.,  Böckenholt, U., and Steerneman, A. G. M. (2005). This is a statistical technique to address the endogeneity problem where no external instrumental
variables are needed. The important assumption of the model is that the latent variables are discrete with at least two groups with different means and
the structural error is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">latentIV(
  formula,
  data,
  start.params = c(),
  optimx.args = list(),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A symbolic description of the model to be fitted. Of class "formula".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame containing the data of all parts specified in the formula parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.params</code></td>
<td>
<p>A named vector containing a set of parameters to use in the first optimization iteration.
The names have to correspond exactly to the names of the components specified in the formula parameter.
If not provided, a linear model is fitted to derive them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimx.args</code></td>
<td>
<p>A named list of arguments which are passed to <code>optimx</code>. This allows users to tweak optimization settings to their liking.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Show details about the running of the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let's consider the model:
</p>
<br><div style="text-align:center">Y<sub>t</sub>=β<sub>0</sub>+αP<sub>t</sub>+ε<sub>t</sub>
</div>
<div style="text-align:center">P<sub>t</sub>=π'Z<sub>t</sub>+ν<sub>t</sub>
</div>
<p>where <code class="reqn">t = 1,..,T</code> indexes either time or cross-sectional units, Y<sub>t</sub> is the dependent variable,
P<sub>t</sub> is a <code>k x 1</code> continuous, endogenous regressor,
ε<sub>t</sub> is a structural error term with mean zero
and E(ε<sup>2</sup>)=σ<sub>ε</sub><sup>2</sup>,
<code class="reqn">\alpha</code> and β<sub>0</sub> are model parameters.
Z;<sub>t</sub> is a <code>l x 1</code> vector of instruments,
and ν<sub>t</sub> is a random error with mean zero and
E(ν<sup>2</sup>)=σ<sub>ν</sub><sup>2</sup>.
The endogeneity problem arises from the correlation of <code class="reqn">P</code> and ε<sub>t</sub>
through E(εν)=σ<sub>εν</sub></p>
<p><code>latentIV</code> considers Z<sub>t</sub>' to be a latent, discrete, exogenous variable with an unknown number of groups <code class="reqn">m</code> and <code class="reqn">\pi</code> is a vector of group means.
It is assumed that <code class="reqn">Z</code> is independent of the error terms <code class="reqn">\epsilon</code> and <code class="reqn">\nu</code> and that it has at least two groups with different means.
The structural and random errors are considered normally distributed with mean zero and variance-covariance matrix <code class="reqn">\Sigma</code>:
</p>
<div style="text-align:center">Σ=(σ<sub>ε</sub><sup>2</sup>, σ<sub>0</sub><sup>2</sup>,
<br>     σ<sub>0</sub><sup>2</sup>, σ<sub>ν</sub><sup>2</sup>)</div>
<p>The identification of the model lies in the assumption of the non-normality of
P<sub>t</sub>, the discreteness of the unobserved instruments and the existence of
at least two groups with different means.
</p>
<p>The method has been implemented such that the latent variable has two groups. Ebbes et al.(2005) show in a Monte Carlo experiment that
even if the true number of the categories of the instrument is larger than two, estimates are approximately consistent. Besides, overfitting in terms
of the number of groups/categories reduces the degrees of freedom and leads to efficiency loss. For a model with additional explanatory variables a Bayesian approach is needed, since
in a frequentist approach identification issues appear.
</p>
<p>Identification of the parameters relies on the distributional assumptions of the latent instruments as well as that of
the endogenous regressor P<sub>t</sub>.
Specifically, the endogenous regressor should have a non-normal distribution while the unobserved instruments, <code class="reqn">Z</code>, should be discrete and have at least two groups with different means Ebbes, Wedel, and Böckenholt (2009).
A continuous distribution for the instruments leads to an unidentified model, while a normal distribution of the endogenous regressor gives rise to inefficient estimates.
</p>
<p>Additional parameters used during model fitting and printed in <code>summary</code> are:
</p>

<dl>
<dt>pi1</dt>
<dd>
<p>The instrumental variables <code class="reqn">Z</code> are assumed to be divided into two groups. <code>pi1</code> represents the estimated group mean of the first group.</p>
</dd>
<dt>pi2</dt>
<dd>
<p>The estimated group mean of the second group of the instrumental variables <code class="reqn">Z</code>.</p>
</dd>
<dt>theta5</dt>
<dd>
<p>The probability of being in the first group of the instruments.</p>
</dd>
<dt>theta6</dt>
<dd>
<p>The variance, σ<sub>ε</sub><sup>2</sup></p>
</dd>
<dt>theta7</dt>
<dd>
<p>The covariance, σ<sub>εν</sub></p>
</dd>
<dt>theta8</dt>
<dd>
<p>The variance, σ<sub>ν</sub><sup>2</sup></p>
</dd>
</dl>
<h3>Value</h3>

<p>An object of classes <code>rendo.latent.IV</code> and <code>rendo.base</code> is returned which is a list and contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The formula given to specify the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>The terms object used for model fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model.frame used for model fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>A named vector of all coefficients resulting from model fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.main.coefs</code></td>
<td>
<p>a vector specifying which coefficients are from the model. For internal usage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.params</code></td>
<td>
<p>A named vector with the initial set of parameters used to optimize the log-likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.optimx</code></td>
<td>
<p>The result object returned by the function <code>optimx</code> after optimizing the log-likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>A named, symmetric matrix giving an estimate of the Hessian at the found solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.delta.diag</code></td>
<td>
<p>A diagonal matrix needed when deriving the vcov to apply the delta method on theta5 which was transformed during the LL optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>Fitted values at the found optimal solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>The residuals at the found optimal solution.</p>
</td>
</tr>
</table>
<p>The function <code>summary</code> can be used to obtain and print a summary of the results.
The generic accessor functions <code>coefficients</code>, <code>fitted.values</code>, <code>residuals</code>, <code>vcov</code>, <code>confint</code>, <code>logLik</code>, <code>AIC</code>, <code>BIC</code>, <code>case.names</code>, and <code>nobs</code> are available.
</p>


<h3>References</h3>

<p>Ebbes, P., Wedel,M., Böckenholt, U., and Steerneman, A. G. M. (2005). 'Solving and Testing for Regressor-Error
(in)Dependence When no Instrumental Variables are Available: With New Evidence for the Effect of Education on Income'.
Quantitative Marketing and Economics, 3:365–392.
</p>
<p>Ebbes P., Wedel M., Böckenholt U. (2009). “Frugal IV Alternatives to Identify the Parameter for an Endogenous Regressor.” Journal of Applied Econometrics, 24(3), 446–468.
</p>


<h3>See Also</h3>

<p><code>summary</code> for how fitted models are summarized
</p>
<p><code>optimx</code> for possible elements of parameter <code>optimx.arg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("dataLatentIV")

# function call without any initial parameter values
l  &lt;- latentIV(y ~ P, data = dataLatentIV)
summary(l)

# function call with initial parameter values given by the user
l1 &lt;- latentIV(y ~ P, start.params = c("(Intercept)"=2.5, P=-0.5),
               data = dataLatentIV)
summary(l1)

# use own optimization settings (see optimx())
# set maximum number of iterations to 50'000
l2 &lt;- latentIV(y ~ P, optimx.args = list(itnmax = 50000),
               data = dataLatentIV)

# print detailed tracing information on progress
l3 &lt;- latentIV(y ~ P, optimx.args = list(control = list(trace = 6)),
               data = dataLatentIV)

# use method L-BFGS-B instead of Nelder-Mead and print report every 50 iterations
l4 &lt;- latentIV(y ~ P, optimx.args = list(method = "L-BFGS-B", control=list(trace = 2, REPORT=50)),
               data = dataLatentIV)

# read out all coefficients, incl auxiliary coefs
lat.all.coefs &lt;- coef(l4)
# same as above
lat.all.coefs &lt;- coef(l4, complete = TRUE)
# only main model coefs
lat.main.coefs &lt;- coef(l4, complete = FALSE)


</code></pre>


</div>