<div class="container">

<table style="width: 100%;"><tr>
<td>likelihood_t_env</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Likelihood of a dataset under environmental models of trait evolution.
</h2>

<h3>Description</h3>

<p>Computes the likelihood of a dataset under either the linear or exponential environmental model, or an user defined environmental model. This function is used internally by fit_t_env.
</p>


<h3>Usage</h3>

<pre><code class="language-R">likelihood_t_env(phylo, data, model=c("EnvExp", "EnvLin"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
  
<p>an object of class 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a named vector of continuous data with names corresponding to <code>phylo$tip.label</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>"param", "fun", "times", "mtot" and "error" arguments.
</p>
<p>-param: a vector with the parameters used in the environmental function. The first value is <code>sig2</code> and the second is <code>beta</code>.
</p>
<p>-fun: a time contnuous function of an environmental variable (see e.g. ?fit_t_env)
</p>
<p>-times: a vector of branching times starting at zero 
(e.g. max(branching.times(phylo))-branching.times(phylo))
</p>
<p>-mtot: root age of the tree (e.g. max(branching.times(phylo)))
</p>
<p>-error: a vector of standard error (se) for each species
</p>
<p>If the "times" argument is not provided, the "phylo" object is used to compute it as well as "mtot".
</p>
<p>Note that the argument "mu" can be used to specify the root state (e.g. when using an mcmc sampler)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>model chosen to fit trait data, <code>"EnvExp"</code> is the exponential-environmental model, and <code>"EnvLin"</code> is the linear-environmental model. Otherwise, an user specified model can be provided.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>the "fun" argument can be filled by an environmental dataframe.
</p>


<h3>Value</h3>

<p>the log-likelihood value of the environmental model
</p>


<h3>Author(s)</h3>

<p>Julien Clavel
</p>


<h3>References</h3>

<p>Clavel, J. &amp; Morlon, H., 2017. Accelerated body size evolution during cold climatic periods in the Cenozoic. Proceedings of the National Academy of Science, 114(16): 4183-4188.
</p>


<h3>See Also</h3>

<p><code>fit_t_env</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(test){
data(Cetacea)
data(InfTemp)

# Simulate a trait with temperature dependence on the Cetacean tree
set.seed(123)

trait &lt;- sim_t_env(Cetacea, param=c(0.1,-0.2), env_data=InfTemp, model="EnvExp", 
					root.value=0, step=0.001, plot=TRUE)
					
# Compute the likelihood 
likelihood_t_env(Cetacea, trait, param=c(0.1, 0), fun=InfTemp, model="EnvExp")

# Provide the times
brtime&lt;-branching.times(Cetacea)
mtot&lt;-max(brtime)
times&lt;-mtot-brtime

likelihood_t_env(Cetacea,trait,param=c(0.1, 0), fun=InfTemp, 
                  times=times, mtot=mtot, model="EnvExp")

# Provide the environmental function rather than the dataset (faster if used recursively)
#require(pspline)
#spline_result &lt;- sm.spline(InfTemp[,1],InfTemp[,2], df=50)
#env_func &lt;- function(t){predict(spline_result,t)}
#t&lt;-unique(InfTemp[,1])
# We build the interpolated smoothing spline function
#env_data&lt;-splinefun(t,env_func(t))
  
#likelihood_t_env(Cetacea, trait, param=c(0.1, 0), fun=env_data, 
#                 times=times, mtot=mtot, model="EnvExp")

	}  
</code></pre>


</div>