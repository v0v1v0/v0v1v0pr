<div class="container">

<table style="width: 100%;"><tr>
<td>fit_blended</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Blended mixture using an ECME-Algorithm</h2>

<h3>Description</h3>

<p>Fit a Blended mixture using an ECME-Algorithm
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_blended(
  dist,
  obs,
  start,
  min_iter = 0L,
  max_iter = 100L,
  skip_first_e = FALSE,
  tolerance = 1e-05,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A <code>BlendedDistribution</code>. It is assumed, that <code>breaks</code> and
<code>bandwidths</code> are not a placeholder and that <code>weights</code> are to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Set of observations as produced by <code>trunc_obs()</code> or convertible
via <code>as_trunc_obs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Initial values of all placeholder parameters.
If missing, starting values are obtained from <code>fit_dist_start()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_iter</code></td>
<td>
<p>Minimum number of EM-Iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of EM-Iterations (weight updates)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_first_e</code></td>
<td>
<p>Skip the first E-Step (update Probability weights)?
This can help if the initial values cause a mixture component to vanish in
the first E-Step before the starting values can be improved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>Numerical tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>Include tracing information in output?
If <code>TRUE</code>, additional tracing information will be added to the result list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passed to <code>fit_dist_start()</code> if <code>start</code> is missing.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements
</p>

<ul>
<li> <p><code>params</code> the fitted parameters in the same structure as <code>init</code>.
</p>
</li>
<li> <p><code>params_hist</code> (if <code>trace</code> is TRUE) the history of parameters
(after each e- and m- step)
</p>
</li>
<li> <p><code>iter</code> the number of outer EM-iterations
</p>
</li>
<li> <p><code>logLik</code> the final log-likelihood
</p>
</li>
</ul>
<h3>See Also</h3>

<p>Other distribution fitting functions: 
<code>fit_dist()</code>,
<code>fit_erlang_mixture()</code>,
<code>fit_mixture()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dist &lt;- dist_blended(
   list(
     dist_exponential(),
     dist_genpareto()
   )
 )

params &lt;- list(
  probs = list(0.9, 0.1),
  dists = list(
    list(rate = 2.0),
    list(u = 1.5, xi = 0.2, sigmau = 1.0)
  ),
  breaks = list(1.5),
  bandwidths = list(0.3)
)

x &lt;- dist$sample(100L, with_params = params)

dist$default_params$breaks &lt;- params$breaks
dist$default_params$bandwidths &lt;- params$bandwidths
if (interactive()) {
  fit_blended(dist, x)
}

</code></pre>


</div>