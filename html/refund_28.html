<div class="container">

<table style="width: 100%;"><tr>
<td>fosr.perm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation testing for function-on-scalar regression</h2>

<h3>Description</h3>

<p><code>fosr.perm()</code> is a wrapper function calling <code>fosr.perm.fit()</code>,
which fits models to permuted data, followed by <code>fosr.perm.test()</code>,
which performs the actual simultaneous hypothesis test.  Calling the latter
two functions separately may be useful for performing tests at different
significance levels.  By default, <code>fosr.perm()</code> produces a plot using
the plot function for class <code>fosr.perm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fosr.perm(
  Y = NULL,
  fdobj = NULL,
  X,
  con = NULL,
  X0 = NULL,
  con0 = NULL,
  argvals = NULL,
  lambda = NULL,
  lambda0 = NULL,
  multi.sp = FALSE,
  nperm,
  level = 0.05,
  plot = TRUE,
  xlabel = "",
  title = NULL,
  prelim = if (multi.sp) 0 else 15,
  ...
)

fosr.perm.fit(
  Y = NULL,
  fdobj = NULL,
  X,
  con = NULL,
  X0 = NULL,
  con0 = NULL,
  argvals = NULL,
  lambda = NULL,
  lambda0 = NULL,
  multi.sp = FALSE,
  nperm,
  prelim,
  ...
)

fosr.perm.test(x, level = 0.05)

## S3 method for class 'fosr.perm'
plot(x, level = 0.05, xlabel = "", title = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y, fdobj</code></td>
<td>
<p>the functional responses, given as either an <code class="reqn">n\times d</code>
matrix <code>Y</code> or a functional data object (class <code>"fd"</code>)
as in the <span class="pkg">fda</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the design matrix, whose columns represent scalar predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con</code></td>
<td>
<p>a row vector or matrix of linear contrasts of the coefficient
functions, to be restricted to equal zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X0</code></td>
<td>
<p>design matrix for the null-hypothesis model.  If <code>NULL</code>, the
null hypothesis is the intercept-only model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con0</code></td>
<td>
<p>linear constraints for the null-hypothesis model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argvals</code></td>
<td>
<p>the <code class="reqn">d</code> argument values at which the coefficient
functions will be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>smoothing parameter value.  If <code>NULL</code>, the smoothing
parameter(s) will be estimated.  See <code>fosr</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>smoothing parameter for null-hypothesis model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi.sp</code></td>
<td>
<p>a logical value indicating whether separate smoothing
parameters should be estimated for each coefficient function.  Currently
must be <code>FALSE</code> if <code>method = "OLS"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>significance level for the simultaneous test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical value indicating whether to plot the real- and
permuted-data pointwise F-type statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>x-axis label for plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>title for plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prelim</code></td>
<td>
<p>number of preliminary permutations.  The smoothing parameter
in the main permutations will be fixed to the median value from these
preliminary permutations.  If <code>prelim=0</code>, this is not done. Preliminary
permutations are not available when <code>multi.sp = TRUE</code> (hence the complicated default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for <code>fosr.perm</code> and <code>fosr.perm.fit</code>, additional
arguments passed to <code>fosr</code>.  These arguments may include
<code>max.iter</code>, <code>method</code>, <code>gam.method</code>, and <code>scale</code>.  For
<code>plot.fosr.perm</code>, graphical parameters (see <code>par</code>) for the
plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>fosr.perm</code>, outputted by <code>fosr.perm</code>,
<code>fosr.perm.fit</code>, or <code>fosr.perm.test</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>fosr.perm</code> or <code>fosr.perm.test</code> produces an object of
class <code>fosr.perm</code>, which is a list with the elements below.
<code>fosr.perm.fit</code> also outputs an object of this class, but without the
last five elements. </p>
<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>pointwise F-type statistics at each of the
points given by <code>argvals</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F.perm</code></td>
<td>
<p>a matrix, each of whose rows
gives the pointwise F-type statistics for a permuted data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argvals</code></td>
<td>
<p>points at which F-type statistics are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.real</code></td>
<td>
<p>smoothing parameter(s) for the real-data fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.prelim</code></td>
<td>
<p>smoothing parameter(s) for preliminary permuted-data
fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.perm</code></td>
<td>
<p>smoothing parameter(s) for main permuted-data
fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0.real, lambda0.prelim, lambda0.perm</code></td>
<td>
<p>as above, but for
null hypothesis models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>significance level of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>critval</code></td>
<td>
<p>critical value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif</code></td>
<td>
<p>vector of
logical values indicating whether significance is attained at each of the
points <code>argvals</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2s</code></td>
<td>
<p>subset of 1, ...,
length(argvals) identifying the points at which the test statistic
changes from non-significant to significant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2n</code></td>
<td>
<p>points at which
the test statistic changes from significant to non-significant.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Philip Reiss <a href="mailto:phil.reiss@nyumc.org">phil.reiss@nyumc.org</a> and Lan Huo
</p>


<h3>References</h3>

<p>Reiss, P. T., Huang, L., and Mennes, M. (2010).  Fast
function-on-scalar regression with penalized basis expansions.
<em>International Journal of Biostatistics</em>, 6(1), article 28.  Available
at <a href="https://pubmed.ncbi.nlm.nih.gov/21969982/">https://pubmed.ncbi.nlm.nih.gov/21969982/</a>
</p>


<h3>See Also</h3>

<p><code>fosr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# Test effect of region on mean temperature in the Canadian weather data
# The next two lines are taken from the fRegress.CV help file (package fda)
smallbasis  &lt;- create.fourier.basis(c(0, 365), 25)
tempfd &lt;- smooth.basis(day.5,
          CanadianWeather$dailyAv[,,"Temperature.C"], smallbasis)$fd

Xreg = cbind(1, model.matrix(~factor(CanadianWeather$region)-1))
conreg = matrix(c(0,1,1,1,1), 1)   # constrain region effects to sum to 0

# This is for illustration only; for a real test, must increase nperm
# (and probably prelim as well)
regionperm = fosr.perm(fdobj=tempfd, X=Xreg, con=conreg, method="OLS", nperm=10, prelim=3)

# Redo the plot, using axisIntervals() from the fda package
plot(regionperm, axes=FALSE, xlab="")
box()
axis(2)
axisIntervals(1)

## End(Not run)

</code></pre>


</div>