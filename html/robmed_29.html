<div class="container">

<table style="width: 100%;"><tr>
<td>ellipse_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic plot with a tolerance ellipse</h2>

<h3>Description</h3>

<p>Produce a scatter plot of two variables used in (robust) mediation analysis
together with a tolerance ellipse.  Exploiting the relationship between the
regression coefficients and the covariance matrix, that tolerance ellipse
illustrates how well the regression results represent the data. In addition,
a line that visualizes the estimated regression coefficient is added when
relevant.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ellipse_plot(object, ...)

## Default S3 method:
ellipse_plot(
  object,
  horizontal = NULL,
  vertical = NULL,
  partial = FALSE,
  level = 0.975,
  npoints = 100,
  ...
)

## S3 method for class 'setup_ellipse_plot'
ellipse_plot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"fit_mediation"</code>
or <code>"test_mediation"</code> containing results from (robust) mediation
analysis, or a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed down.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p>a character string specifying the variable to be
plotted on the horizontal axis.  If the dependent variable is chosen for
the vertical axis, a hypothsized mediator or an independent variable must
be selected for the horizontal axis.  If a hypothesized mediator is chosen
for the vertical axis, an independent variable must be selected for the
horizontal axis (in case of a serial multiple mediator model, a hypothesized
mediator occurring earlier in the sequence is also allowed).  The default is
to plot the first independent variable on the horizontal axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical</code></td>
<td>
<p>a character string specifying the variable to be
plotted on the vertical axis: the dependent variable or a hypothesized
mediator.  The default is to plot the first hypothesized mediator on the
vertical axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>a logical indicating whether the vertical axis should
display the observed values of the selected variable (<code>FALSE</code>), or
the partial residuals with respect to the variable on the horizontal axis
(<code>TRUE</code>).  The latter allows to display the corresponding regression
coefficient by a line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>numeric; the confidence level of the tolerance ellipse.  It
gives the percentage of observations that are expected to lie within the
ellipse under the assumption of a normal distribution, and therefore it
controls the size of the ellipse.  The default is such that the ellipse is
expected to contain 97.5% of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>the number of grid points used to evaluate and draw the
ellipse.  The default is to use 100 grid points.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A line to visualize the corresponding regression coefficient is added if
<code>partial = TRUE</code>, or in case of a simple mediation model
(without control variables) when the hypothesized mediator is plotted on
the vertical axis and the independent variable is plotted on the horizontal
axis.
</p>
<p>For robust estimation methods that return outlyingness weights for each
data point, those weights are visualized by coloring the points on a grey
scale.  If a list of objects has been supplied and there are multiple
objects from such robust methods, each method is placed in a separate panel.
</p>
<p>Methods first call <code>setup_ellipse_plot()</code> to extract all
necessary information to produce the plot, then the
<code>"setup_ellipse_plot"</code> method is called to produce the plot.
</p>


<h3>Value</h3>

<p>An object of class <code>"ggplot"</code>.
</p>


<h3>Author(s)</h3>

<p>Andreas Alfons
</p>


<h3>References</h3>

<p>Alfons, A., Ates, N.Y. and Groenen, P.J.F. (2022) Robust Mediation Analysis:
The <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package <span class="pkg">robmed</span>.  <em>Journal of Statistical Software</em>,
<b>103</b>(13), 1â€“45.  doi:10.18637/jss.v103.i13.
</p>


<h3>See Also</h3>

<p><code>fit_mediation()</code>, <code>test_mediation()</code>,
<code>setup_ellipse_plot()</code>
</p>
<p><code>ci_plot()</code>, <code>density_plot()</code>,
<code>weight_plot()</code>, <code>plot()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("BSG2014")

# run fast-and-robust bootstrap test
robust_boot &lt;- test_mediation(BSG2014,
                              x = "ValueDiversity",
                              y = "TeamCommitment",
                              m = "TaskConflict",
                              robust = TRUE)

# create plot for robust bootstrap test
ellipse_plot(robust_boot)

# original data and partial residuals
ellipse_plot(robust_boot, horizontal = "TaskConflict",
             vertical = "TeamCommitment")
ellipse_plot(robust_boot, horizontal = "TaskConflict",
             vertical = "TeamCommitment", partial = TRUE)

# run OLS bootstrap test
ols_boot &lt;- test_mediation(BSG2014,
                           x = "ValueDiversity",
                           y = "TeamCommitment",
                           m = "TaskConflict",
                           robust = FALSE)

# compare robust and OLS bootstrap tests
boot_list &lt;- list("OLS bootstrap" = ols_boot,
                  "ROBMED" = robust_boot)
ellipse_plot(boot_list)

# the plot can be customized in the usual way
ellipse_plot(boot_list) + theme_bw() +
  labs(title = "OLS vs robust estimation")

</code></pre>


</div>