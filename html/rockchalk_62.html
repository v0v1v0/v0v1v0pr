<div class="container">

<table style="width: 100%;"><tr>
<td>plotPlane</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw a 3-D regression plot for two predictors from any linear or nonlinear lm or glm object</h2>

<h3>Description</h3>

<p>This allows user to fit a regression model with many variables and
then plot 2 of its predictors and the output plane for those
predictors with other variables set at mean or mode (numeric or
factor).  This is a front-end (wrapper) for R's persp function.
Persp does all of the hard work, this function reorganizes the
information for the user in a more readily understood way.  It
intended as a convenience for students (or others) who do not
want to fight their way through the details needed to use persp to
plot a regression plane.  The fitted model can have any number of
input variables, this will display only two of them. And, at least
for the moment, I insist these predictors must be numeric
variables. They can be transformed in any of the usual ways, such
as poly, log, and so forth.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotPlane(
  model = NULL,
  plotx1 = NULL,
  plotx2 = NULL,
  drawArrows = FALSE,
  plotPoints = TRUE,
  npp = 20,
  x1lab,
  x2lab,
  ylab,
  x1lim,
  x2lim,
  x1floor = 5,
  x2floor = 5,
  pch = 1,
  pcol = "blue",
  plwd = 0.5,
  pcex = 1,
  llwd = 0.3,
  lcol = 1,
  llty = 1,
  acol = "red",
  alty = 4,
  alwd = 0.3,
  alength = 0.1,
  linesFrom,
  lflwd = 3,
  envir = environment(formula(model)),
  ...
)

## Default S3 method:
plotPlane(
  model = NULL,
  plotx1 = NULL,
  plotx2 = NULL,
  drawArrows = FALSE,
  plotPoints = TRUE,
  npp = 20,
  x1lab,
  x2lab,
  ylab,
  x1lim,
  x2lim,
  x1floor = 5,
  x2floor = 5,
  pch = 1,
  pcol = "blue",
  plwd = 0.5,
  pcex = 1,
  llwd = 0.3,
  lcol = 1,
  llty = 1,
  acol = "red",
  alty = 4,
  alwd = 0.3,
  alength = 0.1,
  linesFrom,
  lflwd = 3,
  envir = environment(formula(model)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an lm or glm fitted model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotx1</code></td>
<td>
<p>name of one variable to be used on the x1 axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotx2</code></td>
<td>
<p>name of one variable to be used on the x2 axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawArrows</code></td>
<td>
<p>draw red arrows from prediction plane toward observed values TRUE or FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotPoints</code></td>
<td>
<p>Should the plot include scatter of observed scores?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npp</code></td>
<td>
<p>number of points at which to calculate prediction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1lab</code></td>
<td>
<p>optional label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2lab</code></td>
<td>
<p>optional label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>optional label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1lim</code></td>
<td>
<p>optional lower and upper bounds for x1, as vector like c(0,1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2lim</code></td>
<td>
<p>optional lower and upper bounds for x2, as vector like c(0,1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1floor</code></td>
<td>
<p>Default=5. Number of "floor" lines to be drawn for variable x1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2floor</code></td>
<td>
<p>Default=5. Number of "floor" lines to be drawn for variable x2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>plot character, passed on to the "points" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcol</code></td>
<td>
<p>color for points, col passed to "points" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plwd</code></td>
<td>
<p>line width, lwd passed to "points" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcex</code></td>
<td>
<p>character expansion, cex passed to "points" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llwd</code></td>
<td>
<p>line width, lwd passed to the "lines" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p>line color, col passed to the "lines" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llty</code></td>
<td>
<p>line type, lty passed to the "lines" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acol</code></td>
<td>
<p>color for arrows, col passed to "arrows" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alty</code></td>
<td>
<p>arrow line type, lty passed to the "arrows" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alwd</code></td>
<td>
<p>arrow line width, lwd passed to the "arrows" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alength</code></td>
<td>
<p>arrow head length, length passed to "arrows" function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linesFrom</code></td>
<td>
<p>object with information about "highlight" lines to be added to the 3d plane (output from plotCurves or plotSlopes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lflwd</code></td>
<td>
<p>line widths for linesFrom highlight lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>environment from whence to grab data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters that will go to persp</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Besides a fitted model object, plotPlane requires two additional
arguments, plotx1 and plotx2. These are the names of the plotting
variables. Please note, that if the term in the regression is
something like poly(fish,2) or log(fish), then the argument to
plotx1 should be the quoted name of the variable "fish".
plotPlane will handle the work of re-organizing the information so
that R's predict functions can generate the desired information.
This might be thought of as a 3D version of "termplot", with a
significant exception. The calculation of predicted values depends
on predictors besides plotx1 and plotx2 in a different ways. The
sample averages are used for numeric variables, but for factors
the modal value is used.
</p>
<p>This function creates an empty 3D drawing and then fills in the
pieces. It uses the R functions <code>lines</code>, <code>points</code>, and
<code>arrows</code>. To allow customization, several parameters are
introduced for the users to choose colors and such. These options
are prefixed by "l" for the lines that draw the plane, "p" for the
points, and "a" for the arrows. Of course, if plotPoints=FALSE or
drawArrows=FALSE, then these options are irrelevant.
</p>


<h3>Value</h3>

<p>The main point is the plot that is drawn, but for record
keeping the return object is a list including 1) res: the
transformation matrix that was created by persp 2) the call that
was issued, 3) x1seq, the "plot sequence" for the x1 dimension, 4)
x2seq, the "plot sequence" for the x2 dimension, 5) zplane, the
values of the plane corresponding to locations x1seq and x2seq.
</p>


<h3>Author(s)</h3>

<p>Paul E. Johnson <a href="mailto:pauljohn@ku.edu">pauljohn@ku.edu</a>
</p>


<h3>See Also</h3>

<p><code>persp</code>, <code>scatterplot3d</code>, <code>regr2.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(rockchalk)


set.seed(12345)
x1 &lt;- rnorm(100)
x2 &lt;- rnorm(100)
x3 &lt;- rnorm(100)
x4 &lt;- rnorm(100)
y &lt;- rnorm(100)
y2 &lt;- 0.03 + 0.1*x1 + 0.1*x2 + 0.25*x1*x2 + 0.4*x3 -0.1*x4 + 1*rnorm(100)
dat &lt;- data.frame(x1,x2,x3,x4,y, y2)
rm(x1, x2, x3, x4, y, y2)

## linear ordinary regression
m1 &lt;- lm(y ~ x1 + x2 +x3 + x4, data = dat)

plotPlane(m1, plotx1 = "x3", plotx2 = "x4")

plotPlane(m1, plotx1 = "x3", plotx2 = "x4", drawArrows = TRUE)

plotPlane(m1, plotx1 = "x1", plotx2 = "x4", drawArrows = TRUE)


plotPlane(m1, plotx1 = "x1", plotx2 = "x2", drawArrows = TRUE, npp = 10)
plotPlane(m1, plotx1 = "x3", plotx2 = "x2", drawArrows = TRUE, npp = 40)

plotPlane(m1, plotx1 = "x3", plotx2 = "x2", drawArrows = FALSE,
          npp = 5, ticktype = "detailed")


## regression with interaction
m2 &lt;- lm(y ~ x1  * x2 +x3 + x4, data = dat)

plotPlane(m2, plotx1 = "x1", plotx2 = "x2", drawArrows = TRUE)


plotPlane(m2, plotx1 = "x1", plotx2 = "x4", drawArrows = TRUE)
plotPlane(m2, plotx1 = "x1", plotx2 = "x3", drawArrows = TRUE)

plotPlane(m2, plotx1 = "x1", plotx2 = "x2", drawArrows = TRUE,
          phi = 10, theta = 30)



## regression with quadratic;
## Required some fancy footwork in plotPlane, so be happy
dat$y3 &lt;- 0 + 1 * dat$x1 + 2 * dat$x1^2 + 1 * dat$x2 +
    0.4*dat$x3 + 8 * rnorm(100)
m3 &lt;- lm(y3 ~ poly(x1,2) + x2 +x3 + x4, data = dat)
summary(m3)

plotPlane(m3, plotx1 = "x1", plotx2 = "x2", drawArrows = TRUE,
          x1lab = "my great predictor", x2lab = "a so-so predictor",
          ylab = "Most awesomest DV ever")

plotPlane(m3, plotx1 = "x1", plotx2 = "x2", drawArrows = TRUE,
          x1lab = "my great predictor", x2lab = "a so-so predictor",
          ylab = "Most awesomest DV ever", phi = -20)

plotPlane(m3, plotx1 = "x1", plotx2 = "x2", drawArrows = TRUE,
          phi = 10, theta = 30)

plotPlane(m3, plotx1 = "x1", plotx2 = "x4", drawArrows = TRUE,
          ticktype = "detailed")
plotPlane(m3, plotx1 = "x1", plotx2 = "x3", drawArrows = TRUE)

plotPlane(m3, plotx1 = "x1", plotx2 = "x2", drawArrows = TRUE,
          phi = 10, theta = 30)

m4 &lt;- lm(y ~ sin(x1) + x2*x3 +x3 + x4, data = dat)
summary(m4)


plotPlane(m4, plotx1 = "x1", plotx2 = "x2", drawArrows = TRUE)
plotPlane(m4, plotx1 = "x1", plotx2 = "x3", drawArrows = TRUE)



eta3 &lt;- 1.1 + .9*dat$x1 - .6*dat$x2 + .5*dat$x3
dat$y4 &lt;- rbinom(100, size = 1, prob = exp( eta3)/(1+exp(eta3)))
gm1 &lt;- glm(y4 ~ x1 + x2 + x3, data = dat, family = binomial(logit))
summary(gm1)
plotPlane(gm1, plotx1 = "x1", plotx2 = "x2")
plotPlane(gm1, plotx1 = "x1", plotx2 = "x2", phi = -10)

plotPlane(gm1, plotx1 = "x1", plotx2 = "x2", ticktype = "detailed")
plotPlane(gm1, plotx1 = "x1", plotx2 = "x2", ticktype = "detailed",
          npp = 30, theta = 30)
plotPlane(gm1, plotx1 = "x1", plotx2 = "x3", ticktype = "detailed",
          npp = 70, theta = 60)

plotPlane(gm1, plotx1 = "x1", plotx2 = "x2", ticktype = c("detailed"),
          npp = 50, theta = 40)

dat$x2 &lt;- 5 * dat$x2
dat$x4 &lt;- 10 * dat$x4
eta4 &lt;- 0.1 + .15*dat$x1 - 0.1*dat$x2 + .25*dat$x3 + 0.1*dat$x4
dat$y4 &lt;- rbinom(100, size = 1, prob = exp( eta4)/(1+exp(eta4)))
gm2 &lt;- glm(y4 ~ x1 + x2 + x3 + x4, data = dat, family = binomial(logit))
summary(gm2)
plotPlane(gm2, plotx1 = "x1", plotx2 = "x2")
plotPlane(gm2, plotx1 = "x2", plotx2 = "x1")
plotPlane(gm2, plotx1 = "x1", plotx2 = "x2", phi = -10)
plotPlane(gm2, plotx1 = "x1", plotx2 = "x2", phi = 5, theta = 70, npp = 40)

plotPlane(gm2, plotx1 = "x1", plotx2 = "x2", ticktype = "detailed")
plotPlane(gm2, plotx1 = "x1", plotx2 = "x2", ticktype = "detailed",
          npp = 30, theta = -30)
plotPlane(gm2, plotx1 = "x1", plotx2 = "x3", ticktype = "detailed",
          npp = 70, theta = 60)

plotPlane(gm2, plotx1 = "x4", plotx2 = "x3", ticktype = "detailed",
          npp = 50, theta = 10)

plotPlane(gm2, plotx1 = "x1", plotx2 = "x2", ticktype = c("detailed"))
</code></pre>


</div>