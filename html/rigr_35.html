<div class="container">

<table style="width: 100%;"><tr>
<td>regress</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>General Regression for an Arbitrary Functional</h2>

<h3>Description</h3>

<p>Produces point estimates, interval estimates, and p values for an arbitrary
functional (mean, geometric mean, proportion, odds, hazard) of a
variable of class <code>integer</code>, or <code>numeric</code> when
regressed on an arbitrary number of covariates. Multiple Partial F-tests can
be specified using the <code>U</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">regress(
  fnctl,
  formula,
  data,
  intercept = TRUE,
  weights = rep(1, nrow(data.frame(data))),
  subset = rep(TRUE, nrow(data.frame(data))),
  robustSE = TRUE,
  conf.level = 0.95,
  exponentiate = fnctl != "mean",
  replaceZeroes,
  useFdstn = TRUE,
  suppress = FALSE,
  na.action,
  method = "qr",
  qr = TRUE,
  singular.ok = TRUE,
  contrasts = NULL,
  init = NULL,
  ties = "efron",
  offset,
  control = list(...),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fnctl</code></td>
<td>
<p>a character string indicating
the functional (summary measure of the distribution) for which inference is
desired. Choices include <code>"mean"</code>, <code>"geometric mean"</code>,
<code>"odds"</code>, <code>"rate"</code>, <code>"hazard"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> as might be passed to 
<code>lm</code>, <code>glm</code>, or <code>coxph</code>. Functions of variables, specified using <code>dummy</code>
or <code>polynomial</code> may also be included in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame, matrix, or other data structure with matching
names to those entered in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>a logical value
indicating whether a intercept exists or not. Default value is <code>TRUE</code> for all 
functionals. Intercept may also be removed if a "-1" is present in <code>formula</code>. If "-1"
is present in <code>formula</code> but <code>intercept = TRUE</code> is specified, the model will fit
without an intercept. Note that when <code>fnctl = "hazard"</code>, the intercept is always set to
<code>FALSE</code> because Cox proportional hazards regression models do not explicitly estimate 
an intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector indicating
optional weights for weighted regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>vector indicating a subset
to be used for all inference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robustSE</code></td>
<td>
<p>a logical indicator
that standard errors (and confidence intervals) are to be computed using the Huber-White sandwich
estimator. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric scalar
indicating the level of confidence to be used in computing confidence
intervals. The default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exponentiate</code></td>
<td>
<p>a logical
indicator that the regression parameters should be exponentiated. This is by
default true for all functionals except the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replaceZeroes</code></td>
<td>
<p>if not
<code>FALSE</code>, this indicates a value to be used in place of zeroes when
computing a geometric mean. If <code>TRUE</code>, a value equal to one-half the
lowest nonzero value is used. If a numeric value is supplied, that value is
used. Defaults to <code>TRUE</code> when <code>fnctl = "geometric mean"</code>. This parameter
is always <code>FALSE</code> for all other values of <code>fnctl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useFdstn</code></td>
<td>
<p>a logical indicator
that the F distribution should be used for test statistics instead of the
chi squared distribution even in logistic regression
models. When using the F distribution, the degrees of freedom are taken to
be the sample size minus the number of parameters, as it would be in a
linear regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress</code></td>
<td>
<p>if <code>TRUE</code>, and a model which requires exponentiation
(for instance, regression on the geometric mean) is computed, then a table
with only the exponentiated coefficients and confidence interval is
returned. Otherwise, two tables are returned - one with the original
unexponentiated coefficients, and one with the exponentiated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action, qr, singular.ok, offset, contrasts, control</code></td>
<td>
<p>optional arguments that are passed to the functionality of <code>lm</code> or
<code>glm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used in fitting the model. The default value for
<code>fnctl = "mean"</code> and <code>fnctl = "geometric mean"</code> is <code>"qr"</code>, and the default value for
<code>fnctl = "odds"</code> and <code>fnctl = "rate"</code> is <code>"glm.fit"</code>. This argument is passed into the
lm() or glm() function, respectively. You may optionally specify <code>method = "model.frame"</code>, which
returns the model frame and does no fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>a numeric vector of initial values for the regression parameters for the hazard regression. 
Default initial value is zero for all variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties</code></td>
<td>
<p>a character string describing method for breaking ties in hazard regression. 
Only <code>efron</code>, <code>breslow</code>, or <code>exact</code> is accepted. 
See more details in the documentation for this argument in the survival::coxph function. 
Default to <code>efron</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the <code>lm</code> function call</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Regression models include linear regression (for the “mean” functional), logistic
regression with logit link (for the “odds” functional), Poisson regression with log link (for the
“rate” functional), linear regression of a log-transformed outcome 
(for the “geometric mean” functional), and Cox proportional hazards regression (for the hazard functional). 
</p>
<p>Currently, for the hazard functional, only 'coxph' syntax is supported; in other words, using 'dummy', 'polynomial',
and <code>U</code> functions will result in an error when 'fnctl = hazard'.
</p>
<p>Note that the only possible link function in 'regress' with 'fnctl = odds"' is the logit link. 
Similarly, the only possible link function in 'regress' with 'fnctl = "rate"' is the log link.
</p>
<p>Objects created using the
<code>U</code> function can also be passed in. If the
<code>U</code> call involves a partial formula of the form
<code>~ var1 + var2</code>, then <code>regress</code> will return a multiple-partial
F-test involving <code>var1</code> and <code>var2</code>. If an F-statistic will already be 
calculated regardless of the <code>U</code> specification,
then any naming convention specified via <code>name ~ var1</code> will be ignored.
The multiple partial tests must be the last terms specified in the model (i.e. no other predictors can
follow them).
</p>


<h3>Value</h3>

<p>An object of class uRegress is
returned. Parameter estimates, confidence intervals, and p values are
contained in a matrix $augCoefficients.
</p>


<h3>See Also</h3>

<p>Functions for fitting linear models (<code>lm</code>), and
generalized linear models (<code>glm</code>). Also see the function to specify
multiple-partial F-tests, <code>U</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Loading dataset
data(mri)

# Linear regression of atrophy on age
regress("mean", atrophy ~ age, data = mri)

# Linear regression of atrophy on sex and height and their interaction, 
# with a multiple-partial F-test on the height-sex interaction
regress("mean", atrophy ~ height + sex + U(hs=~height:sex), data = mri)

# Logistic regression of sex on atrophy
mri$sex_bin &lt;- ifelse(mri$sex == "Female", 1, 0)
regress("odds", sex_bin ~ atrophy, data = mri)

# Cox regression of age on survival 
library(survival)
regress("hazard", Surv(obstime, death)~age, data=mri)
</code></pre>


</div>