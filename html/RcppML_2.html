<div class="container">

<table style="width: 100%;"><tr>
<td>bipartition</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bipartition a sample set</h2>

<h3>Description</h3>

<p>Spectral biparitioning by rank-2 matrix factorization
</p>


<h3>Usage</h3>

<pre><code class="language-R">bipartition(
  A,
  tol = 1e-05,
  maxit = 100,
  nonneg = TRUE,
  samples = 1:ncol(A),
  seed = NULL,
  verbose = FALSE,
  calc_dist = FALSE,
  diag = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>matrix of features-by-samples in dense or sparse format (preferred classes are "matrix" or "Matrix::dgCMatrix", respectively). Prefer sparse storage when more than half of all values are zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>stopping criteria, the correlation distance between <code class="reqn">w</code> across consecutive iterations, <code class="reqn">1 - cor(w_i, w_{i-1})</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>stopping criteria, maximum number of alternating updates of <code class="reqn">w</code> and <code class="reqn">h</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonneg</code></td>
<td>
<p>enforce non-negativity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>samples to include in bipartition, numbered from 1 to <code>ncol(A)</code>. Default is <code>NULL</code> for all samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed for model initialization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print model tolerances between iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc_dist</code></td>
<td>
<p>calculate the relative cosine distance of samples within a cluster to either cluster centroid. If <code>TRUE</code>, centers for clusters will also be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>scale factors in <code class="reqn">w</code> and <code class="reqn">h</code> to sum to 1 by introducing a diagonal, <code class="reqn">d</code>. This should generally never be set to <code>FALSE</code>. Diagonalization enables symmetry of models in factorization of symmetric matrices, convex L1 regularization, and consistent factor scalings.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Spectral bipartitioning is a popular subroutine in divisive clustering. The sign of the difference between sample loadings in factors of a rank-2 matrix factorization
gives a bipartition that is nearly identical to an SVD.
</p>
<p>Rank-2 matrix factorization by alternating least squares is faster than rank-2-truncated SVD (i.e. <em>irlba</em>).
</p>
<p>This function is a specialization of rank-2 <code>nmf</code> with support for factorization of only a subset of samples, and with additional calculations on the factorization model relevant to bipartitioning. See <code>nmf</code> for details regarding rank-2 factorization.
</p>


<h3>Value</h3>

<p>A list giving the bipartition and useful statistics:
</p>

<ul>
<li>
<p> v       : vector giving difference between sample loadings between factors in a rank-2 factorization
</p>
</li>
<li>
<p> dist    : relative cosine distance of samples within a cluster to centroids of assigned vs. not-assigned cluster
</p>
</li>
<li>
<p> size1   : number of samples in first cluster (positive loadings in 'v')
</p>
</li>
<li>
<p> size2   : number of samples in second cluster (negative loadings in 'v')
</p>
</li>
<li>
<p> samples1: indices of samples in first cluster
</p>
</li>
<li>
<p> samples2: indices of samples in second cluster
</p>
</li>
<li>
<p> center1 : mean feature loadings across samples in first cluster
</p>
</li>
<li>
<p> center2 : mean feature loadings across samples in second cluster
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Zach DeBruine
</p>


<h3>References</h3>

<p>Kuang, D, Park, H. (2013). "Fast rank-2 nonnegative matrix factorization for hierarchical document clustering." Proc. 19th ACM SIGKDD intl. conf. on Knowledge discovery and data mining.
</p>


<h3>See Also</h3>

<p><code>nmf</code>, <code>dclust</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(Matrix)
data(iris)
A &lt;- as(as.matrix(iris[,1:4]), "dgCMatrix")
bipartition(A, calc_dist = TRUE)

## End(Not run)
</code></pre>


</div>