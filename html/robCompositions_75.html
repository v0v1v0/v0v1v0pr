<div class="container">

<table style="width: 100%;"><tr>
<td>impRZilr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM-based replacement of rounded zeros in compositional data</h2>

<h3>Description</h3>

<p>Parametric replacement of rounded zeros for compositional data using
classical and robust methods based on ilr coordinates with a special
choice of balances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impRZilr(
  x,
  maxit = 10,
  eps = 0.1,
  method = "pls",
  dl = rep(0.05, ncol(x)),
  variation = FALSE,
  nComp = "boot",
  bruteforce = FALSE,
  noisemethod = "residuals",
  noise = FALSE,
  R = 10,
  correction = "normal",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data.frame or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergency criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either “lm”, “MM” or “pls”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dl</code></td>
<td>
<p>Detection limit for each variable. zero for variables with
variables that have no detection limit problems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variation</code></td>
<td>
<p>matrix is used to first select number of parts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nComp</code></td>
<td>
<p>if determined, it fixes the number of pls components. If
“boot”, the number of pls components are estimated using a
bootstraped cross validation approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bruteforce</code></td>
<td>
<p>sets imputed values above the detection limit to the
detection limit. Replacement above the detection limit only exceptionally
occur due to numerical instabilities. The default is FALSE!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noisemethod</code></td>
<td>
<p>adding noise to imputed values. Experimental</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>TRUE to activate noise (experimental)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of bootstrap samples for the determination of pls
components. Only important for method “pls”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>normal or density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>additional print output during calculations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Statistical analysis of compositional data including zeros runs into
problems, because log-ratios cannot be applied. Usually, rounded zeros are
considered as missing not at random missing values.
</p>
<p>The algorithm iteratively imputes parts with rounded zeros whereas in each
step (1) compositional data are expressed in pivot coordinates (2) tobit regression is
applied (3) the rounded zeros are replaced by the expected values (4) the
corresponding inverse ilr mapping is applied. After all parts are
imputed, the algorithm starts again until the imputations do not change.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>imputed data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria </code></td>
<td>
<p>change between last and
second last iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter </code></td>
<td>
<p>number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit
</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind</code></td>
<td>
<p>index of zeros</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nComp</code></td>
<td>
<p>number of components for method pls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>chosen
method</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matthias Templ and Peter Filzmoser
</p>


<h3>References</h3>

<p>Martin-Fernandez, J.A., Hron, K., Templ, M., Filzmoser, P., Palarea-Albaladejo, J. (2012)
Model-based replacement of rounded zeros in compositional data: Classical and robust approaches. 
<em>Computational Statistics and Data Analysis</em>, 56 (9), 2688-2704.
</p>
<p>Templ, M., Hron, K., Filzmoser, P., Gardlo, A. (2016) Imputation of rounded zeros
for high-dimensional compositional data. <em>Chemometrics and Intelligent
Laboratory Systems</em>, 155, 183-190.
</p>


<h3>See Also</h3>

<p><code>impRZalr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(arcticLake)
x &lt;- arcticLake
## generate rounded zeros artificially:
#x[x[,1] &lt; 5, 1] &lt;- 0
x[x[,2] &lt; 44, 2] &lt;- 0
xia &lt;- impRZilr(x, dl=c(5,44,0), eps=0.01, method="lm")
xia$x

</code></pre>


</div>