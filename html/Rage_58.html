<div class="container">

<table style="width: 100%;"><tr>
<td>vr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derive mean vital rates from a matrix population model</h2>

<h3>Description</h3>

<p>Derive mean vital rates of survival, growth (or development), shrinkage (or
de-development), stasis, dormancy, or reproduction from a matrix population
model, by averaging across stage classes. These functions include optional
arguments for custom weighting of different stage classes (see
<em>Weighting stages</em>), excluding certain stage classes from the
calculation (see <em>Excluding stages</em>), and defining the set of
biologically-possible transitions (see <em>Possible transitions</em>).
</p>
<p>These decompositions assume that all transition rates are products of a
stage-specific survival term (column sums of <code>matU</code>) and a lower level
vital rate that is conditional on survival (growth/development,
shrinkage/de-development, stasis, dormancy, or a/sexual reproduction).
Reproductive vital rates that are not conditional on survival (i.e., within a
stage class from which there is no survival) are also allowed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vr_survival(matU, posU = matU &gt; 0, exclude_col = NULL, weights_col = NULL)

vr_growth(
  matU,
  posU = matU &gt; 0,
  exclude = NULL,
  exclude_row = NULL,
  exclude_col = NULL,
  weights_col = NULL,
  surv_only_na = TRUE
)

vr_shrinkage(
  matU,
  posU = matU &gt; 0,
  exclude = NULL,
  exclude_row = NULL,
  exclude_col = NULL,
  weights_col = NULL,
  surv_only_na = TRUE
)

vr_stasis(
  matU,
  posU = matU &gt; 0,
  exclude = NULL,
  weights_col = NULL,
  surv_only_na = TRUE
)

vr_dorm_enter(matU, posU = matU &gt; 0, dorm_stages, weights_col = NULL)

vr_dorm_exit(matU, posU = matU &gt; 0, dorm_stages, weights_col = NULL)

vr_fecundity(
  matU,
  matR,
  posR = matR &gt; 0,
  exclude_col = NULL,
  weights_row = NULL,
  weights_col = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matU</code></td>
<td>
<p>The survival component of a matrix population model (i.e., a
square projection matrix reflecting survival-related transitions; e.g.,
progression, stasis, and retrogression)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posU</code></td>
<td>
<p>A logical matrix of the same dimension as <code>matU</code>, with
elements indicating whether a given <code>matU</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matU &gt; 0</code> (see
<em>Possible transitions</em>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_col</code></td>
<td>
<p>Integer, character or logical vector indicating stages for
which transitions both <em>to</em> and <em>from</em> the stage should be
excluded from the calculation of vital rates. See section
<em>Excluding stages</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights_col</code></td>
<td>
<p>Vector of stage-specific weights to apply while averaging
vital rates across columns. See section <em>Weighting stages</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>Integer, character or logical vector indicating stages for
which transitions both <em>to</em> and <em>from</em> the stage should be
excluded from the calculation of vital rates. See section
<em>Excluding stages</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_row</code></td>
<td>
<p>Integer, character or logical vector indicating stages for
which transitions both <em>to</em> and <em>from</em> the stage should be
excluded from the calculation of vital rates. See section
<em>Excluding stages</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv_only_na</code></td>
<td>
<p>If there is only one possible <code>matU</code> transition in a
given column, should that transition be attributed exclusively to survival?
If <code>TRUE</code>, the vital rate of growth/stasis/shrinkage in that column
will be coerced to <code>NA</code>. If <code>FALSE</code>, dividing the single
transition by the stage-specific survival probability will always yield a
value of <code>1</code>. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dorm_stages</code></td>
<td>
<p>Integer or character vector indicating dormant stage
classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matR</code></td>
<td>
<p>The reproductive component of a matrix population model (i.e., a
square projection matrix reflecting transitions due to reproduction; either
sexual, clonal, or both)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posR</code></td>
<td>
<p>A logical matrix of the same dimension as <code>matR</code>, with
elements indicating whether a given <code>matR</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matR &gt; 0</code> (see
<em>Possible transitions</em>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights_row</code></td>
<td>
<p>Vector of stage-specific weights to apply while summing
vital rates across rows within columns. See section <em>Weighting
stages</em>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Vector of vital rates. Vital rates corresponding to impossible
transitions are coerced to <code>NA</code> (see <em>Possible transitions</em>).
</p>


<h3>Possible transitions</h3>

<p>A transition rate of <code>0</code> within a matrix population model may indicate
that the transition is not possible in the given life cycle (e.g., tadpoles
never revert to eggs), or that the transition rate is possible but was
estimated to be <code>0</code> in the relevant population and time period. If vital
rates are to be averaged across multiple stage classes, or compared across
populations, it may be important to distinguish between these two types of
zeros.
</p>
<p>By default, the <code>vr_</code> functions assume that a transition rate of
<code>0</code> indicates an impossible transition, in which case a value of
<code>NA</code> will be used in relevant calculations. Specifically, the arguments
<code>posU</code> and <code>posR</code> are specified by the logical expressions
<code>(matU &gt; 0)</code> and <code>(matR &gt; 0)</code>, respectively. If the matrix
population model includes transitions that are estimated to be <code>0</code> but
still in fact possible, one should specify the <code>posU</code> and/or <code>posR</code>
arguments manually.
</p>


<h3>Weighting stages</h3>

<p>In averaging vital rates across stages, it may be desirable to weight stage
classes differently (e.g., based on reproductive values or stable
distributions). Weights are generally applied when averaging across columns,
i.e., across transitions <em>from</em> a set of stage classes (e.g., averaging
stage-specific survival probabilities across multiple stages). All <code>vr_</code>
functions therefore include an optional argument <code>weights_from</code>.
</p>
<p>In principle, particularly for vital rates of reproduction, the user can also
apply weights when summing across rows within columns, i.e., across
reproductive transitions <em>to</em> a set of stage classes (e.g., summing the
production of different types of offspring, such as seeds vs. seedlings). The
function <code>vr_fecundity</code> therefore also includes an optional
argument <code>weights_to</code>.
</p>
<p>If supplied, <code>weights_from</code> will automatically be scaled to sum to 1
over the set of possible transitions, whereas <code>weights_to</code> will not be
rescaled because we wish to enable the use of reproductive values here, which
do not naturally sum to 1.
</p>


<h3>Excluding stages</h3>

<p>It may be desirable to exclude one or more stages from the calculation of
certain vital rates. For instance, we might not believe that 'growth' to a
dormant stage class really reflects biological growth, in which case we could
exclude transitions <em>to</em> the dormant stage class using the argument
<code>exclude_row</code>. We may or may not want to ignore 'growth' transitions
<em>from</em> the dormant stage class, which can be done using
<code>exclude_col</code>. To exclude transitions both <em>to and from</em> a given
set of stages, use argument <code>exclude</code>.
</p>


<h3>Author(s)</h3>

<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other vital rates: 
<code>vital_rates()</code>,
<code>vr_mat</code>,
<code>vr_vec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create example MPM (stage 4 is dormant)
matU &lt;- rbind(
  c(0.1, 0, 0, 0),
  c(0.5, 0.2, 0.1, 0.1),
  c(0, 0.3, 0.3, 0.1),
  c(0, 0, 0.5, 0.4)
)

matF &lt;- rbind(
  c(0, 0.7, 1.1, 0),
  c(0, 0.3, 0.8, 0),
  c(0, 0, 0, 0),
  c(0, 0, 0, 0)
)

vr_survival(matU, exclude_col = 4)
vr_growth(matU, exclude = 4)
vr_shrinkage(matU, exclude = 4)
vr_stasis(matU, exclude = 4)

# `exclude*` and `*_stages` arguments can accept stage names
matU &lt;- name_stages(matU)
matF &lt;- name_stages(matF)
vr_dorm_enter(matU, dorm_stages = "stage_4")
vr_dorm_exit(matU, dorm_stages = 4)

vr_fecundity(matU, matF, exclude_col = 4)

</code></pre>


</div>