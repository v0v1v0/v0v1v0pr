<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_template</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Template Spectrum</h2>

<h3>Description</h3>

<p>This function uses local quadratic regression to estimate the template
spectrum from a collection of observed spectra from a star as described in
<a href="https://arxiv.org/abs/2005.14083">Holzer et al. (2020)</a>. All observed
spectra are assumed to be normalized. The bandwidth is chosen locally through
generalized cross-validation. We <strong>strongly</strong> recommend using parallel
computing for this function. Therefore, the <code>cores</code> argument has the
default value of 19.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_template(
  SPECTRA,
  min_wvl = NULL,
  max_wvl = NULL,
  bandwidth_bnds = c(0.017, 0.05),
  min_count = 100,
  cores = 19
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SPECTRA</code></td>
<td>
<p>a list of all observed spectra to use in estimating the template.
Each observed spectrum should have the format of being a list with the following
names (or a dataframe with the following columns): “Wavelength" and “Flux".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_wvl</code></td>
<td>
<p>a number that indicates the minimum wavelength for the estimated
template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_wvl</code></td>
<td>
<p>a number that indicates the maximum wavelength for the estimated
template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth_bnds</code></td>
<td>
<p>a vector of length 2 that gives the interval of bandwidth
values (in the same units as the wavelength of the spectra) to be considered in
the generalized cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_count</code></td>
<td>
<p>the minimum number of data points required for local regression
to be done on a given wavelength chunk</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>the number of cores to parallelize over (if set to 1, no
parallelizing is done)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Wavelength</code></td>
<td>
<p>the wavelength axis of the estimated template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Flux</code></td>
<td>
<p>the normalized flux of the estimated template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Chunk_bounds</code></td>
<td>
<p>a list of length 2 vectors that give
the wavelength bounds for each chunk for which the smoothing was done on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bandwidths</code></td>
<td>
<p>the bandwidths chosen for each of the chunks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Std_err</code></td>
<td>
<p>the standard errors of the estimated normalized flux that can
be used for prediction confidence intervals</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(spectra)
plot(spectra[[1]]$Wavelength, spectra[[1]]$Flux, col='gray', type='l')
for(spec in spectra){
 lines(spec$Wavelength, spec$Flux, col='gray')
}
tempest = estimate_template(spectra, cores = 1)
lines(tempest$Wavelength, tempest$Flux, col='red')
</code></pre>


</div>