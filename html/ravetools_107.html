<div class="container">

<table style="width: 100%;"><tr>
<td>wavelet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>'Morlet' wavelet transform (Discrete)</h2>

<h3>Description</h3>

<p>Transform analog voltage signals with 'Morlet'
wavelets: complex wavelet kernels with <code class="reqn">\pi/2</code> phase
differences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wavelet_kernels(freqs, srate, wave_num)

morlet_wavelet(
  data,
  freqs,
  srate,
  wave_num,
  precision = c("float", "double"),
  trend = c("constant", "linear", "none"),
  signature = NULL,
  ...
)

wavelet_cycles_suggest(
  freqs,
  frequency_range = c(2, 200),
  cycle_range = c(3, 20)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>frequency in which <code>data</code> will be projected on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>srate</code></td>
<td>
<p>sample rate, number of time points per second</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wave_num</code></td>
<td>
<p>desired number of cycles in wavelet kernels to
balance the precision in time and amplitude (control the
smoothness); positive integers are strongly suggested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>numerical vector such as analog voltage signals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>the precision of computation; choices are
<code>'float'</code> (default) and <code>'double'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>choices are <code>'constant'</code>: center the signal at zero;
<code>'linear'</code>: remove the linear trend; <code>'none'</code> do nothing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signature</code></td>
<td>
<p>signature to calculate kernel path to save, internally used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further passed to <code>detrend</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequency_range</code></td>
<td>
<p>frequency range to calculate, default is 2 to 200</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycle_range</code></td>
<td>
<p>number of cycles corresponding to <code>frequency_range</code>.
For default frequency range (2 - 200), the default <code>cycle_range</code> is
3 to 20. That is, 3 wavelet kernel cycles at 2 Hertz, and 20 cycles at 200
Hertz.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>wavelet_kernels</code> returns wavelet kernels to be
used for wavelet function; <code>morlet_wavelet</code> returns a file-based array
if <code>precision</code> is <code>'float'</code>, or a list of real and imaginary
arrays if <code>precision</code> is <code>'double'</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# generate sine waves
time &lt;- seq(0, 3, by = 0.01)
x &lt;- sin(time * 20*pi) + exp(-time^2) * cos(time * 10*pi)

plot(time, x, type = 'l')

# freq from 1 - 15 Hz; wavelet using float precision
freq &lt;- seq(1, 15, 0.2)
coef &lt;- morlet_wavelet(x, freq, 100, c(2,3))

# to get coefficients in complex number from 1-10 time points
coef[1:10, ]

# power
power &lt;- Mod(coef[])^2

# Power peaks at 5Hz and 10Hz at early stages
# After 1.0 second, 5Hz component fade away
image(power, x = time, y = freq, ylab = "frequency")

# wavelet using double precision
coef2 &lt;- morlet_wavelet(x, freq, 100, c(2,3), precision = "double")
power2 &lt;- (coef2$real[])^2 + (coef2$imag[])^2

image(power2, x = time, y = freq, ylab = "frequency")

# The maximum relative change of power with different precisions
max(abs(power/power2 - 1))

# display kernels
freq &lt;- seq(1, 15, 1)
kern &lt;- wavelet_kernels(freq, 100, c(2,3))
print(kern)

plot(kern)



</code></pre>


</div>