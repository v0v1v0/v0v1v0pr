<div class="container">

<table style="width: 100%;"><tr>
<td>StableTraitsR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run StableTraits from within R</h2>

<h3>Description</h3>

<p>This function runs StableTraits and StableTraitsSum
(<cite>Elliot and Mooers 2014</cite>) from within the R environment and returns
its output into the workspace.
</p>


<h3>Usage</h3>

<pre><code class="language-R">StableTraitsR(tree,y,path,output=NULL,aces=NULL,argST=NULL,argSTS=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree. The tree needs not to be either ultrametric
or fully dichotomous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a named vector of phenotypic trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>the folder path where the StableTraits output will be stored.
Notice that the input tree and data (modified automatically if the original
tree is not fully dichotomous or if <code>aces</code> are specified) will be
stored in this folder as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>name of the output to be returned, if unspecified it will be
named "output".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aces</code></td>
<td>
<p>a named vector of ancestral character values at nodes specified
in advance. Names correspond to the nodes in the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argST</code></td>
<td>
<p>a list of further arguments passed to StableTraits. If the
argument has no value (for example "brownian") it must be specified as
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argSTS</code></td>
<td>
<p>list of further arguments passed to StableTraitsSum. If the
argument has no value (for example "brownian") it must be specified as
<code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The StableTraits software is available at https://mickelliot.com/,
along with instructions for compilation. Once it is installed, the user
must set as R working directory the folder where the StableTraits software
are installed. Further information about the arguments and outputs of
StableTraits and StableTraitsSum can be found at https://mickelliot.com/.
<code>StableTraitsR</code> automatically recognizes which Operating System is
running on the computer (it has been tested successfully on MacOS and
Windows machines).
</p>


<h3>Value</h3>

<p>The function returns a 'list' containing the output of StableTraits
and StableTraitsSum.
</p>
<p><strong>$progress</strong> a table reporting the DIC and PRSF diagnostics.
</p>
<p><strong>$rates_tree</strong> a copy of the original tree with branch lengths
set to the evolutionary rate imputed by the stable reconstruction.
Specifically, each branch length is equal to the absolute difference in the
stable reconstruction occurring on that branch divided by the square root
of the input branch length.
</p>
<p><strong>$rates</strong> the original branch lengths, evolutionary rates, node
height and (optionally) scaled branch lengths.
</p>
<p><strong>$aces</strong> the median estimates of ancestral states and stable
parameters along with the 95% credible interval.
</p>
<p><strong>$brownian_tree</strong> if "brownian" is <code>TRUE</code> in
<code>argSTS</code>, a copy of the original tree with branch lengths set such
that the Brownian motion reconstruction of the character on this tree is
approximately the same as the stable ancestral reconstruction.
</p>
<p><strong>$ace.prior.values</strong> if <code>aces</code> is specified, the function
returns a dataframe containing the corresponding node number on the
<code>RRphylo</code> tree for each node, the original (preset) and the estimated
values, and the 95% credible interval.
</p>


<h3>Author(s)</h3>

<p>Silvia Castiglione, Carmela Serio, Pasquale Raia
</p>


<h3>References</h3>

<p>Elliot, M. G., &amp; Mooers, A. Ã˜. (2014). Inferring ancestral states
without assuming neutrality or gradualism using a stable model of
continuous character evolution. <em>BMC evolutionary biology</em>, 14: 226.
doi.org/10.1186/s12862-014-0226-8
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(ape)
library(phytools)

# Set as working directory the folder where StableTraits software are stored
# setwd("~/StableTraits")

dir.create("Analyses")
rtree(100)-&gt;tree
fastBM(tree)-&gt;y
c(1,2,3)-&gt;acev
sample(Ntip(tree)+seq(1:Nnode(tree)),3)-&gt;names(acev)
StableTraitsR(tree,y,path="Analyses/",output="my_output",aces=acev,
argST=list(iterations=500000,chains=4),argSTS=list(brownian=TRUE))-&gt;ST

## End(Not run)
</code></pre>


</div>