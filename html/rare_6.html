<div class="container">

<table style="width: 100%;"><tr>
<td>group.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize groups by coloring branches and leaves of an hclust tree</h2>

<h3>Description</h3>

<p>The function plots an <code>hclust</code> tree with branches and leaves colored
based on group membership. The groups span the covariate indices {1, ..., <code>nvars</code>}.
Covariates from the same group share equal coefficient (<code>beta</code>), and sibling
groups have different coefficients. The function determines groups based on
the sparsity in <code>gamma</code>. In an <code>hclust</code> tree with <code>beta[i]</code> on the
<code>i</code>th leaf, the branch and leaf are colored in blue, red or gray according to <code>beta[i]</code>
being positive, negative or zero, respectively. The larger the magnitude of <code>beta[i]</code> is,
the darker the color will be. So branches and leaves from the same group will have the
same color.
</p>


<h3>Usage</h3>

<pre><code class="language-R">group.plot(beta, gamma, A, hc, nbreaks = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Length-<code>nvars</code> vector of covariate coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Length-<code>nnodes</code> vector of latent variable coefficient. Note that <code>rarefit</code>
returns <code>NA</code> as <code>gamma</code> value when <code>alpha</code> is zero,
in which case our problem becomes the lasso on <code>beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p><code>nvars</code>-by-<code>nnodes</code> binary matrix encoding ancestor-descendant relationships
between leaves and nodes in the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hc</code></td>
<td>
<p>An <code>hclust</code> tree of <code>nvars</code> leaves where each leaf corresponds to a covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbreaks</code></td>
<td>
<p>Number of breaks in binning <code>beta</code> elements (positive part and negative part
are done separately). Each bin is associated with a color based on the magnitude and
positivity/negativity of <code>beta</code> elements in the bin.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# See vignette for more details.
set.seed(100)
ts &lt;- sample(1:length(data.rating), 400) # Train set indices
# Fit the model on train set
ourfit &lt;- rarefit(y = data.rating[ts], X = data.dtm[ts, ], hc = data.hc, lam.min.ratio = 1e-6,
                  nlam = 20, nalpha = 10, rho = 0.01, eps1 = 1e-5, eps2 = 1e-5, maxite = 1e4)
# Cross validation
ourfit.cv &lt;- rarefit.cv(ourfit, y = data.rating[ts], X = data.dtm[ts, ],
                        rho = 0.01, eps1 = 1e-5, eps2 = 1e-5, maxite = 1e4)
# Visualize the groups at optimal beta and gamma
ibest.lambda &lt;- ourfit.cv$ibest[1]
ibest.alpha &lt;- ourfit.cv$ibest[2]
beta.opt &lt;- ourfit$beta[[ibest.alpha]][, ibest.lambda]
gamma.opt &lt;- ourfit$gamma[[ibest.alpha]][, ibest.lambda] # works if ibest.alpha &gt; 1
# Visualize the groups at optimal beta and gamma
group.plot(beta.opt, gamma.opt, ourfit$A, data.hc)

## End(Not run)

</code></pre>


</div>