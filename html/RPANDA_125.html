<div class="container">

<table style="width: 100%;"><tr>
<td>plot_prob_dtt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot diversity through time with confidence intervals.
</h2>

<h3>Description</h3>

<p>Plots confidence intervals of the estimated number of species through time using a matrix of probabilities given by the function 'prob_dtt'. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  plot_prob_dtt(mat, grain =0.1, plot.prob = TRUE, 
                plot.mean = TRUE, int = TRUE, plot.bound=FALSE,
                conf = 0.95, add = FALSE, col.mean = "red", col.bound = "blue",
                lty="solid", lwd=1, lty.bound=1, add.present=T, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>

<p>matrix of probabilities, with species numbers as rows and times as columns with rownames and colnames set to the values of each. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grain</code></td>
<td>

<p>the upper limit of a range of probabilities plotted in a gray scale (lower limit is zero). Higher probabilities are plotted in black. Default value is 0.1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.prob</code></td>
<td>

<p>logical: set to TRUE (default value) to plot the probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.mean</code></td>
<td>

<p>logical: set to TRUE (default value) to plot a line for the mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.bound</code></td>
<td>

<p>logical: set to TRUE to plot the bounds of the confidence interval, int must be set to TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>

<p>logical: set to TRUE (default value) to plot a confidence interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>

<p>confidence level. The default value is 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical: set to TRUE to add the plot on an existing graph.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.mean</code></td>
<td>

<p>color of the line for the mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.bound</code></td>
<td>

<p>color of the confidence interval bounds
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>style of the line for the mean (if added on a current plot)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>the line width, a positive number (default to 1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.bound</code></td>
<td>

<p>style of the line for the bound (if added on a current plot)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.present</code></td>
<td>

<p>whether or not to add the present diversity value to the plot. Default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments to be passed to plot or to plot.phylo.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

  
<p>The function assumes that the matrix of probabilities 'mat' has species numbers as rows and times as columns with rownames and colnames set to the values of each.
</p>
<p>'Grain' must be between 0 and 1. If the plot is too pale 'grain' should be diminished (and inversely if the plot is too dark)
</p>


<h3>Value</h3>

<p>Plot representing how the estimated number of species vary through time with confidence intervals. The darker is the plot, the higher is the probability.
</p>


<h3>Author(s)</h3>

<p>O.Billaud, T.L.Parsons, D.S.Moen, H.Morlon</p>


<h3>References</h3>

<p>Morlon, H., Parsons, T.L. and Plotkin, J.B. (2011) Reconciling molecular phylogenies with the fossil record. Proc. Nat. Acad. Sci. 108: 16327-16332.
</p>
<p>Billaud, O., Moen, D. S., Parsons, T. L., Morlon, H. (under review) Estimating Diversity Through Time using Molecular Phylogenies: Old and Species-Poor Frog Families are the Remnants of a Diverse Past.  
</p>


<h3>See Also</h3>

<p><code>fit_bd</code>, <code>plot_dtt</code>, <code>prob_dtt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Balaenopteridae)
tot_time&lt;-max(node.age(Balaenopteridae)$ages)


if(test){
# Fit the pure birth model (no extinction) with exponential variation of the speciation rate
# with time
f.lamb &lt;-function(t,y){y[1] * exp(y[2] * t)}
f.mu&lt;-function(t,y){0}
lamb_par&lt;-c(0.08, 0.01)
mu_par&lt;-c()
result &lt;- fit_bd(Balaenopteridae,tot_time,f.lamb,f.mu,lamb_par,mu_par,f=1,
                     expo.lamb = TRUE, fix.mu=TRUE)

# Compute the matrix of probabilities                     
prob &lt;- prob_dtt(result, tot_time, 1:tot_time, N0=9, type="crown")

# Check that the sums of probabilities are equal to 1
colSums(prob)

# Plot Diversity through time
plot_prob_dtt(prob)
}
</code></pre>


</div>