<div class="container">

<table style="width: 100%;"><tr>
<td>lmExact</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create random values that deliver linear regressions with exact parameters</h2>

<h3>Description</h3>

<p>Takes self-supplied x/y values or x/random values and transforms these as to deliver linear regressions <code class="reqn">y = \beta_0 + \beta_1x + \varepsilon</code> (with potential replicates) with either<br></p>
<p><b>1)</b> exact slope <code class="reqn">\beta_1</code> and intercept <code class="reqn">\beta_0</code>,<br><b>2)</b> exact <em>p</em>-value and intercept <code class="reqn">\beta_0</code>, or<br><b>3)</b> exact <code class="reqn">R^2</code> and intercept <code class="reqn">\beta_0</code>.<br></p>
<p>Intended for testing and education, not for cheating ! ;-)
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmExact(x = 1:20, y = NULL, ny = 1, intercept = 0, slope = 0.1, error = 0.1, 
        seed = NULL, pval = NULL, rsq = NULL, plot = TRUE, verbose = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the predictor values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>NULL</code>. A possible vector of <code class="reqn">y</code> values with <code>length(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p>the number of replicate response values per predictor value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>the desired intercept <code class="reqn">\beta_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>the desired slope <code class="reqn">\beta_1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>if a single value, the standard deviation <code class="reqn">\sigma</code> for sampling from a normal distribution, or a user-supplied vector of length <code>x</code> with random deviates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optional. The random generator seed for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>the desired <em>p</em>-value of the slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsq</code></td>
<td>
<p>the desired <code class="reqn">R^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. If <code>TRUE</code>, the linear regression is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, a summary is printed to the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to <code>lm</code> or <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For case <b>1)</b>, the <code>error</code> values are added to the exact <code class="reqn">(x_i, \beta_0 + \beta_1 x_i)</code> values, the linear model <code class="reqn">y_i = \beta_0 + \beta_1 x_i + \varepsilon</code> is fit, and the residuals <code class="reqn">y_i - \hat{y_i}</code> are re-added to <code class="reqn">(x_i, \beta_0 + \beta_1 x_i)</code>.<br>
For case <b>2)</b>, the same as in <b>1)</b> is conducted, however the slope delivering the desired <em>p</em>-value is found by an optimizing algorithm.<br>
Finally, for case <b>3)</b>, a QR reconstruction, rescaling and refitting is conducted, using the code found under 'References'.<br></p>
<p>If <code>y</code> is supplied, changes in slope, intercept and <em>p</em>-value will deliver the sames residuals as the linear regression through <code>x</code> and <code>y</code>. A different <code class="reqn">R^2</code> will change the response value structure, however.
</p>


<h3>Value</h3>

<p>A list with the following items:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>lm</code></td>
<td>
<p>the linear model of class <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the predictor values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the (random) response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>the model summary for quick checking of obtained parameters.</p>
</td>
</tr>
</table>
<p>Using both <code>x</code> and <code>y</code> will give a linear regression with the desired parameter values when refitted.
</p>


<h3>Author(s)</h3>

<p>Andrej-Nikolai Spiess
</p>


<h3>References</h3>

<p>For method <b>3</b>):<br>
http://stats.stackexchange.com/questions/15011/generate-a-random-variable-with-a-defined-correlation-to-an-existing-variable.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## No replicates, intercept = 3, slope = 0.2, sigma = 2, n = 20.
res1 &lt;- lmExact(x = 1:20, ny = 1, intercept = 3, slope = 2, error = 2)

## Same as above, but with 3 replicates, sigma = 1,  n = 20.
res2 &lt;- lmExact(x = 1:20, ny = 3, intercept = 3, slope = 2, error = 1)

## No replicates, intercept = 2 and p-value = 0.025, sigma = 3, n = 50.
## =&gt; slope = 0.063
res3 &lt;- lmExact(x = 1:50, ny = 1, intercept = 2, pval = 0.025, error = 3)

## 5 replicates, intercept = 1, R-square = 0.85, sigma = 2, n = 10.
## =&gt; slope = 0.117
res4 &lt;- lmExact(x = 1:10, ny = 5, intercept = 1, rsq = 0.85, error = 2)

## Heteroscedastic (magnitude-dependent) noise.
error &lt;- sapply(1:20, function(x) rnorm(3, 0, x/10))
res5 &lt;- lmExact(x = 1:20, ny = 3, intercept = 1, slope = 0.2,
                error = error)
                
## Supply own x/y values, residuals are similar to an
## initial linear regression.
X &lt;- c(1.05, 3, 5.2, 7.5, 10.2, 11.7)
set.seed(123)
Y &lt;- 0.5 + 2 * X + rnorm(6, 0, 2)
res6 &lt;- lmExact(x = X, y = Y, intercept = 1, slope = 0.2)
all.equal(residuals(lm(Y ~ X)), residuals(res6$lm))
</code></pre>


</div>