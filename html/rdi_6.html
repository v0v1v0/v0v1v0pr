<div class="container">

<table style="width: 100%;"><tr>
<td>rdiAxis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RDI Axis annotation function</h2>

<h3>Description</h3>

<p>This function takes a RDI model, as generated by rdiModel, 
and adds an axis with annotations in the fold change space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdiAxis(model, side = 2, at = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A model object, as generated by rdiModel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>The side the axis will be added to. (1 - bottom; 2 - left; 3 - top;
4 - right). Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>The points at which the tick marks are drawn. By default, 
tickmarks are placed at 'round' fold/percent change values
using the "pretty" breakpoints function. This may
not be ideal if log-RDI values are being plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to pass to axis</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is designed to replace the default axes generated by a plot 
function. Instead of annotating the true RDI value, <code>rdiAxis</code> will estimate
the "true difference" values at various points within the plotting region, and will
annotate the axis with those estimates. 
</p>
<p>It is worth noting that although the RDI value can range below <code>rdiModel</code>'s 
estimate for "identical" repertoires, no negative true difference values will be 
annotated, as these values do not make sense.
</p>


<h3>See Also</h3>

<p>rdiModel, rdiLadder, plotRDIladder
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#create genes
genes = sample(letters, 10000, replace=TRUE)
#create sequence annotations
seqAnnot = data.frame(donor = sample(1:10, 10000, replace=TRUE))
#calculate RDI
d = rdi(genes, seqAnnot)

##create a "baseVect" with the same probability as our features
##since we sampled uniformly, the base vector has equal probability
baseVect = rep(1/length(letters),length(letters))

##generate an RDI model
m = rdiModel(attr(d, "nseq"), baseVects=baseVect)

##convert RDI to lfc
td = convertRDI(d,models=m)$pred

par(mar=c(4,4,1,4),las=1,mgp=c(3,0.5,0))
plot(td,d, ylab="RDI", xlab="LFC")

##now add "true difference" axis annotation to the right side of the plot
rdiAxis(m, side=4)

</code></pre>


</div>