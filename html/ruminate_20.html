<div class="container">

<table style="width: 100%;"><tr>
<td>NCA_find_col</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determines Default Column Name</h2>

<h3>Description</h3>

<p>Based on the current analysis, value from the UI, an optional
list of patterns to search, and column names from a dataset this function
tries to find a default value for a column in the analysis (e.g. subject id,
dose, concentration, etc).
</p>
<p>Generally the following is done:
</p>

<ul>
<li>
<p> If curr_ui has a non-NULL, non-"" value it is compared to dscols. If it
is found there that value is returned.
</p>
</li>
<li>
<p> If not then the patterns are considered. If the patterns from the YAML
file are not NULL they are compared sequentially to the columns names.
The first match found is returned.
</p>
</li>
<li>
<p> If nothing is found then the first value of dscols is returned.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">NCA_find_col(
  curr_ana = NULL,
  curr_ui = NULL,
  patterns = NULL,
  dscols,
  null_ok = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>curr_ana</code></td>
<td>
<p>Current value in the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curr_ui</code></td>
<td>
<p>Current value in UI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patterns</code></td>
<td>
<p>List of regular expression patterns to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dscols</code></td>
<td>
<p>Columns from the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null_ok</code></td>
<td>
<p>Logical value indicating if a null result (nothing found) is
OK (default: <code>FALSE</code>)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Name of column found based on the rules above.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ruminate)
# Module IDs                                                                   
id     = "NCA"                                                                 
id_UD  = "UD"                                                                  
id_DW  = "DW"                                                                  
id_ASM = "ASM"                                                                 
# We need session and input variables to be define                             
 sess_res = NCA_test_mksession(session=list(),                                 
      id     = id,                                                             
      id_UD  = id_UD,                                                          
      id_DW  = id_DW,                                                          
      id_ASM = id_ASM,
      full_session=FALSE)
                                                                               
# Extracting the session and input variables                                   
session      = sess_res$session                                                
input        = sess_res$input                                                  
react_state  = list()                                                          
                                                                               
# We also need configuration files                                             
FM_yaml_file  = system.file(package = "formods",  "templates", "formods.yaml") 
MOD_yaml_file = system.file(package = "ruminate", "templates", "NCA.yaml")     
                                                                               
# Getting the current module state                                             
state = NCA_fetch_state(id             = id,                                   
                       input           = input,                                
                       session         = session,                              
                       FM_yaml_file    = FM_yaml_file,                         
                       MOD_yaml_file   = MOD_yaml_file,                        
                       id_ASM          = id_ASM,                               
                       id_UD           = id_UD,                                
                       id_DW           = id_DW,                                
                       react_state     = react_state)                          
                                                                               
# Pulls out the active analysis                                                
current_ana = NCA_fetch_current_ana(state)

# This will get the dataset associated with this analysis
ds = NCA_fetch_ana_ds(state, current_ana)

# After making changes you can update those in the state
state = NCA_set_current_ana(state, current_ana)

# You can use this to check the current analysis
current_ana = NCA_process_current_ana(state)

# This will pull out the code for the module
fc_res = NCA_fetch_code(state)

# This will use patterns defined for the site to detect
# columns. In this example we are detecting the id column:
id_col = NCA_find_col(
  patterns = state[["MC"]][["detect_col"]][["id"]],
  dscols   = names(ds$DS))

# This creates a new analysis
state = NCA_new_ana(state)
</code></pre>


</div>