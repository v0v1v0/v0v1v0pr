<div class="container">

<table style="width: 100%;"><tr>
<td>rtopFitVariogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit variogram model to sample variogram of data with spatial support</h2>

<h3>Description</h3>

<p>rtopFitVariogram will fit a variogram model to the estimated binned variogram or cloud variogram of data
with an areal support.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'rtop'
rtopFitVariogram(object, params = list(), iprint = 0, ...) 
## S3 method for class 'SpatialPolygonsDataFrame'
rtopFitVariogram(object, params=list(), ...) 
## S3 method for class 'SpatialPointsDataFrame'
rtopFitVariogram(object, params=list(), ...) 
## S3 method for class 'rtopVariogram'
rtopFitVariogram(object, observations, dists = NULL, 
                    params=list(), mr = FALSE, aOver = NULL, iprint = 0, ...) 
## S3 method for class 'rtopVariogramCloud'
rtopFitVariogram(object, observations, dists = NULL, 
                    aOver = NULL, params=list(), mr = FALSE, iprint = 0, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>rtopVariogram</code> or <code>rtopVariogramCloud</code>,
or an object with class <code>rtop</code> that includes the sample variograms.
</p>
<p>The object can also be of class <code>SpatialPolygonsDataFrame</code> or <br><code>SpatialPointsDataFrame</code>
with observations. If <code>object</code> is a <br><code>SpatialPointsDataFrame</code>,
it must have a column with name <code>area</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observations</code></td>
<td>
<p>the observations, passed as a Spatial*DataFrame object, if
object is an <br><code>rtopVariogram</code> or <code>rtopVariogramCloud</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a set of parameters, used to modify the default parameters for 
the <code>rtop</code> package, set in <code>getRtopParams</code>. The argument params can also be used
for the other methods, through the ...-argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dists</code></td>
<td>
<p>either a matrix with geostatistical distances (created by a call
to the function <code>gDist</code> or a list with the
areas  discretized (from a call to <code>rtopDisc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mr</code></td>
<td>
<p>logical; defining whether the function should return a list with 
discretized elements and geostatistical distances, even if it was not
called with an rtop-object as argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aOver</code></td>
<td>
<p>a matrix with the overlapping areas of the observations, used for computation of the nugget effect. 
It will normally be recomputed by the function if it is NULL and necessary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iprint</code></td>
<td>
<p>print flag that is passed to <code>sceua</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to functions called from <code>rtopFitVarigoram</code>. For the
three first methods of the function, <code>...</code> can also include
parameters to the last two methods. </p>
</td>
</tr>
</table>
<h3>Value</h3>

 
<p>The function creates an object with the fitted 
variogram Model (<code>variogramModel</code>) 
and a <br><code>data.frame</code> (<code>varFit</code>) with the 
differences between the sample semivariances and the regularized semivariances.
If <code>mr</code> = TRUE, the function also returns other objects (discretized elements
and geostatistical distances, if created) as a part of the returned object.
If the function is called with an rtop-object as argument, it will return an
rtop-object with <code>variogramModel</code> and <code>varFit</code> added to the object,
in addition to other objects created.
</p>


<h3>Note</h3>

<p>There are several options for fitting of the variogramModel, where the parameters
can be set in <code>params</code>, which is a list of parameters for modification
of the default parameters of the rtop-package given in a call to 
<code>getRtopParams</code>. The first choice is between individual fitting and binned
fitting. This is based on the type of variogram submitted, individual fitting is done
if a cloud variogram (of class <code>rtopVariogramCloud</code>) is passed as argument, 
and binned fitting if the submitted variogram is of class <code>rtopVariogram</code>.
If the function is called with an object of class <code>rtop</code>, having both
<code>variogram</code> and <code>variogramCloud</code> among its arguments, the variogram
model is fitted to the variogram which is consistent with the parameter <code>cloud</code>.
</p>


<h3>Author(s)</h3>

<p> Jon Olav Skoien </p>


<h3>References</h3>

 
<p>Skoien J. O., R. Merz, and G. Bloschl. Top-kriging - geostatistics on stream networks.
Hydrology and Earth System Sciences, 10:277-287, 2006.
</p>
<p>Skoien, J. O. and G. Bloschl. Spatio-Temporal Top-Kriging of Runoff Time Series. Water Resources Research 43:W09419, 2007.
</p>
<p>Skoien, J. O., Bloschl, G., Laaha, G., Pebesma, E., Parajka, J., Viglione, A., 2014. Rtop: An R package for interpolation of data with a variable spatial support, with an example from river networks. Computers &amp; Geosciences, 67.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
rpath = system.file("extdata",package="rtop")
library(sf)
observations = st_read(rpath, "observations")
predictionLocations = st_read(rpath,"predictionLocations")

# Create a column with the specific runoff:
observations$obs = observations$QSUMMER_OB/observations$AREASQKM

# Setting some parameters 
params = list(gDist = TRUE, cloud = FALSE)
# Create a column with the specific runoff:
observations$obs = observations$QSUMMER_OB/observations$AREASQKM
# Build an object
rtopObj = createRtopObject(observations,predictionLocations, 
                           params = params)
# Fit a variogram (function also creates it)
rtopObj = rtopFitVariogram(rtopObj)
rtopObj$variogramModel

</code></pre>


</div>