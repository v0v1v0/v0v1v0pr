<div class="container">

<table style="width: 100%;"><tr>
<td>sim_MCBD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of macroevolutionary diversification under the integrated model described in Aristide &amp; Morlon 2019
</h2>

<h3>Description</h3>

<p>Simulates the joint diversification of species and a continuous trait, where changes in both dimensions are interlinked through competitive interactions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_MCBD(pars, root.value = 0, age.max = 50, step.size = 0.01, bounds = c(-Inf,Inf),
         plot = TRUE, ylims=NULL, full.sim = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>

<p>Vector of simulation parameters:
</p>
<p><code>pars[1]</code> corresponds to <code class="reqn">lambda1</code>, the speciation intitation rate
</p>
<p><code>pars[2]</code> corresponds to <code class="reqn">tau0</code>, the basal speciation completion rate
</p>
<p><code>pars[3]</code> corresponds to <code class="reqn">beta</code>, the effect of trait differences on the speciation completion rate
</p>
<p><code>pars[4]</code> corresponds to <code class="reqn">mu0</code>, the competitive extinction parameter for good species
</p>
<p><code>pars[5]</code> corresponds to <code class="reqn">mubg</code>, the background good species extinction rate
</p>
<p><code>pars[6]</code> corresponds to <code class="reqn">mui0</code>, the competitive extinction parameter for incipient species
</p>
<p><code>pars[7]</code> corresponds to <code class="reqn">muibg</code>, the background incipient species extinction rate
</p>
<p><code>pars[8]</code> corresponds to <code class="reqn">alpha1</code>, the competition effect on extinction (competition strength)
</p>
<p><code>pars[9]</code> corresponds to <code class="reqn">alpha1</code>, the competition effect on trait evolution (competition strength)
</p>
<p><code>pars[10]</code> corresponds to <code class="reqn">sig2</code>, the variance (rate) of the Brownian motion
</p>
<p><code>pars[11]</code> corresponds to <code class="reqn">m</code>, the relative contribution of character displacement (competition) with respect to stochastic (brownian) evolution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.value</code></td>
<td>
<p>the starting trait value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age.max</code></td>
<td>
<p>maximum time for the simulation (if the process doesn't go extinct)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.size</code></td>
<td>
<p>size of each simulation step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>lower and upper value for bounds in trait space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical indicating wether to plot the simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylims</code></td>
<td>
<p>y axis (trait values) limits for the simulation plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.sim</code></td>
<td>
<p>logical indicating wether to return the full simulation (see details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It might be difficult to find parameter combinations that are sensitive. It is recommended to use the parameter settings of the examples as a staring point and from there modify them to understand the behaviour of the model.
If trees produced are too big, simulation can become too slow to ever finish. 
</p>


<h3>Value</h3>

<p>returns a list with the following elements:
</p>
<p><b>all</b> contains the complete tree of the process (extant and extinct good and incipient lineages) and trait values for each tip in the tree
</p>
<p><b>gsp_fossil</b> contains the extant and extinct good species tree and trait values for each tip in the tree
</p>
<p><b>gsp_extant</b> contains the reconstructed (extant only) good species tree and trait values for each tip in the tree
</p>
<p>If full.sim = TRUE, two additional elements are returned inside <b>all</b>:
</p>
<p>note: both elements are used internally to keep track of the simulation and are dynamically updated, so returned elements only reflect the last state
</p>
<p><b>lin_mat</b> a matrix with information about the diversification process. Each row represents a new lineage in the process with the following elements:
- Parental node, descendent node (0 if a tip), starting time, ending time, status at end (extinct(-2); incipient(-1); good(1)), speciation completion or extinction time; speciation completion time (NA if still incipient).
</p>
<p><b>trait_mat</b> a list with trait values for each lineage at each time step throghout the simulation. Each element is a vector composed of the following:
Lineage number (same as row number in lin_mat), status (as in lin_mat), sister lineage number, trait values (NA if lineage didn't exist yet at that time step)
</p>


<h3>Author(s)</h3>

<p>Leandro Aristide (leandroaristi@gmail.com)
</p>


<h3>References</h3>

<p>Aristide, L., and Morlon, H. 2019. Understanding the effect of competition during evolutionary radiations: an integrated model of phenotypic and species diversification
</p>


<h3>Examples</h3>

<pre><code class="language-R">lambda1 = 0.25
tau0 = 0.01
beta = 0.6
mu0 = 0.5
mubg = 0.01
mui0 = 0.8
muibg = 0.02
alpha1 = alpha2 = 0.04
sig2 = 0.5
m = 20

pars &lt;- c(lambda1, tau0, beta, mu0, mubg,mui0, muibg, alpha1, alpha2, sig2, m)


if(test){

#1000 steps, unbounded
res &lt;- sim_MCBD(pars, age.max=10, step.size=0.01) 

#asymmetric bounds
res &lt;- sim_MCBD(pars, age.max=10, step.size=0.01, bounds=c(-10,Inf)) 

#only deterministic component
pars &lt;- c(lambda1, tau0, beta, mu0, mubg, mui0, muibg, alpha1, alpha2, sig2=0, m)
res &lt;- sim_MCBD(pars, age.max=10)

plot(res$gsp_extant$tree)

}

</code></pre>


</div>