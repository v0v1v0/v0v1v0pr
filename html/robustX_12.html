<div class="container">

<table style="width: 100%;"><tr>
<td>rbwheel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Barrow Wheel Distribution Random Vectors</h2>

<h3>Description</h3>

<p>Generate <code class="reqn">p</code>-dimensional random vectors according to Stahel's
Barrow Wheel Distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rbwheel(n, p, frac = 1/p, sig1 = 0.05, sig2 = 1/10,
        rGood = rnorm,
        rOut = function(n) sqrt(rchisq(n, p - 1)) * sign(runif(n, -1, 1)),
        U1 = rep(1, p),
        scaleAfter = TRUE, scaleBefore = FALSE, spherize = FALSE,
        fullResult = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer, specifying the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer, specifying the dimension (aka number of variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p>numeric, the proportion of outliers.
The default, <code class="reqn">1/p</code>, corresponds to the (asymptotic) breakdown
point of M-estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig1</code></td>
<td>
<p>thickness of the “wheel”, (<code class="reqn">= \sigma</code>
<code>(good[,1])</code>), a non-negative numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>thickness of the “axis” (compared to 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rGood</code></td>
<td>
<p>function; the generator for “good” observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rOut</code></td>
<td>
<p>function, generating the outlier observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U1</code></td>
<td>
<p>p-vector to which <code class="reqn">(1,0,\dots,0)</code> is rotated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleAfter</code></td>
<td>
<p>logical indicating if the matrix is re-scaled <em>after</em>
rotation (via <code>scale()</code>)..  Default <code>TRUE</code>; note
that this used to be false by default in the first public version.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleBefore</code></td>
<td>
<p>logical indicating if the matrix is re-scaled before
rotation (via <code>scale()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spherize</code></td>
<td>
<p>logical indicating if the matrix is to be
“spherized”, i.e., rotated and scaled to have empirical
covariance <code class="reqn">I_p</code>.  This means that the principal components are
used (before rotation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullResult</code></td>
<td>
<p>logical indicating if in addition to the <code class="reqn">n
      \times p</code> matrix, some intermediate quantities are returned as
well.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>....  
</p>


<h3>Value</h3>

<p>By default (when <code>fullResult</code> is <code>FALSE</code>), an
<code class="reqn">n \times p</code> matrix of <code class="reqn">n</code> sample vectors of the
<code class="reqn">p</code> dimensional barrow wheel distribution, with an attribute,
<code>n1</code> specifying the exact number of “good” observations,
<code class="reqn">n1 \approx (1-f)\cdot n</code>,  <code class="reqn">f = </code><code>frac</code>.
</p>
<p>If <code>fullResult</code> is <code>TRUE</code>, a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the <code class="reqn">n \times p</code> matrix of above,
<code>X = X0 %*% A</code>, where <code>A &lt;- Qrot(p, u = U1)</code>, and
<code>X0</code> is the corresponding matrix before rotation, see below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X0</code></td>
<td>
<p>.........</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>the <code class="reqn">p \times p</code> rotation matrix, see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>the number of “good” observations, see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>the number of “outlying” observations, <code class="reqn">n2 = n - n1</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Werner Stahel and Martin Maechler</p>


<h3>References</h3>

<p><a href="http://stat.ethz.ch/people/maechler/robustness">http://stat.ethz.ch/people/maechler/robustness</a>

</p>
<p>Stahel, W.~A. and Mächler, M. (2009).
Comment on “invariant co-ordinate selection”,
<em>Journal of the Royal Statistical Society B</em> <b>71</b>, 584–586.
<a href="https://doi.org/10.1111/j.1467-9868.2009.00706.x">doi:10.1111/j.1467-9868.2009.00706.x</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(17)
rX8 &lt;- rbwheel(1000,8, fullResult = TRUE, scaleAfter=FALSE)
with(rX8, stopifnot(all.equal(X, X0 %*% A,    tol = 1e-15),
                    all.equal(X0, X %*% t(A), tol = 1e-15)))
##--&gt; here, don't need to keep X0 (nor A, since that is Qrot(p))

## for n = 100,  you  don't see "it", but may guess .. :
n &lt;- 100
pairs(r &lt;- rbwheel(n,6))
n1 &lt;- attr(r,"n1") ; pairs(r, col=1+((1:n) &gt; n1))

## for n = 500, you *do* see it :
n &lt;- 500
pairs(r &lt;- rbwheel(n,6))
## show explicitly
n1 &lt;- attr(r,"n1") ; pairs(r, col=1+((1:n) &gt; n1))

## but increasing sig2 does help:
pairs(r &lt;- rbwheel(n,6, sig2 = .2))

## show explicitly
n1 &lt;- attr(r,"n1") ; pairs(r, col=1+((1:n) &gt; n1))

set.seed(12)
pairs(X &lt;- rbwheel(n, 7, spherize=TRUE))
colSums(X) # already centered

if(require("ICS") &amp;&amp; require("robustbase")) {
  # ICS: Compare M-estimate [Max.Lik. of t_{df = 2}] with high-breakdown :
  stopifnot(require("MASS"))
  X.paM &lt;- ics(X, S1 = cov, S2 = function(.) cov.trob(., nu=2)$cov, stdKurt = FALSE)
  X.paM.&lt;- ics(X, S1 = cov, S2 = function(.) tM(., df=2)$V, stdKurt = FALSE)
  X.paR &lt;- ics(X, S1 = cov, S2 = function(.) covMcd(.)$cov, stdKurt = FALSE)
  plot(X.paM) # not at all clear
  plot(X.paM.)# ditto
  plot(X.paR)# very clear
}
## Similar such experiments ---&gt;  demo(rbwheel_d)  and   demo(rbwheel_ics)
##                                --------------         -----------------
</code></pre>


</div>