<div class="container">

<table style="width: 100%;"><tr>
<td>adf_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the Angular Dependence Function (ADF)</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>Estimation of the angular dependence function \(\lambda(\omega)\) introduced by Wadsworth and Tawn (2013).
</p>


<h3>Usage</h3>

<pre><code class="language-R">adf_est(
  margdata,
  w = NULL,
  method = c("hill", "cl"),
  q = 0.95,
  qalphas = rep(0.95, 2),
  k = 7,
  constrained = FALSE,
  tol = 1e-04,
  par_init = rep(0, k - 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>margdata</code></td>
<td>
<p>An S4 object of class <code>margtransf.class</code>. See <code>margtransf</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Sequence of rays between <code>0</code> and <code>1</code>. Default is <code>NULL</code>, where a pre-defined grid is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String that indicates which method is used for the estimation of the angular dependence function. Must either be <code>"hill"</code>, to use the Hill estimator (Hill 1975), or <code>"cl"</code> to use the smooth estimator based on Bernstein-Bezier polynomials estimated by composite maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Marginal quantile used to define the threshold \(u_\omega\) of the min-projection variable \(T^1\) at ray \(\omega\) \(\left(t^1_\omega = t_\omega - u_\omega | t_\omega &gt; u_\omega\right)\), and/or Hill estimator (Hill 1975). Default is <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qalphas</code></td>
<td>
<p>A vector containing the marginal quantile used for the Heffernan and Tawn conditional extremes model (Heffernan and Tawn 2004) for each variable, if <code>constrained = TRUE</code>. Default is <code>rep(0.95, 2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Polynomial degree for the Bernstein-Bezier polynomials used for the estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrained</code></td>
<td>
<p>Logical. If <code>FALSE</code> (default) no knowledge of the conditional extremes parameters is incorporated in the angular dependence function estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Convergence tolerance for the composite maximum likelihood procedure. Success is declared when the difference of log-likelihood values between iterations does not exceed this value. Default is <code>0.0001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_init</code></td>
<td>
<p>Initial values for the parameters \(\beta\) of the Bernstein-Bezier polynomials used for estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>rep(0, k-1)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The angular dependence function \(\lambda(\omega)\) can be estimated through a pointwise estimator, obtained with the Hill estimator, or via a smoother approach, obtained using Bernstein-Bezier polynomials and estimated via composite likelihood methods. 
</p>
<p>Knowledge of the conditional extremes framework introduced by Heffernan and Tawn (2004) can be incorporated by setting <code>constrained = TRUE</code>.
Let \(\alpha^1_{x\mid y}=\alpha_{x\mid y} / (1+\alpha_{x\mid y})\) and \(\alpha^1_{y\mid x}=1 /(1+\alpha_{y\mid x})\) with \(\alpha_{x\mid y}\) and \(\alpha_{y\mid x}\) 
being the conditional extremes parameters. After obtaining \(\hat{\alpha}_{x\mid y}\) and \(\hat{\alpha}_{y\mid x}\) via maximum likelihood estimation, 
\(\lambda(\omega)=\max\lbrace \omega, 1-\omega\rbrace\) for \(\omega \in [0, \hat{\alpha}^1_{x\mid y})\cup (\hat{\alpha}^1_{y\mid x}, 1]\) and    
is estimated as before for \(\omega \in [\hat{\alpha}^1_{x\mid y},\hat{\alpha}^1_{y\mid x}]\). For more details see Murphy-Barltrop et al. (2024).
</p>


<h3>Value</h3>

<p>An object of S4 class <code>adf_est.class</code>. This object returns the arguments of the function and two extra slots: 
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>interval</code>:</td>
<td>
<p>A vector containing the maximum likelihood estimates from the conditional extremes model, \(\hat{\alpha}^1_{x\mid y}\) and \(\hat{\alpha}^1_{y\mid x}\), if <code>constrained = TRUE</code>. If <code>constrained = FALSE</code>, then <code>c(0, 1)</code> is returned; we note that this has no meaningful interpretation as the estimation is performed in an unconstrained interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>adf</code>:</td>
<td>
<p>A vector containing the estimates of the angular dependence function.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Heffernan JE, Tawn JA (2004).
“A conditional approach for multivariate extreme values (with discussion).”
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>66</b>(3), 497-546.
doi: <a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x">10.1111/j.1467-9868.2004.02050.x</a>, https://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/j.1467-9868.2004.02050.x.<br><br> Hill BM (1975).
“A Simple General Approach to Inference About the Tail of a Distribution.”
<em>The Annals of Statistics</em>, <b>3</b>(5), 1163 – 1174.
doi: <a href="https://doi.org/10.1214/aos/1176343247">10.1214/aos/1176343247</a>.<br><br> Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2024).
“Improving estimation for asymptotically independent bivariate extremes via global estimators for the angular dependence function.”
2303.13237.<br><br> Wadsworth JL, Tawn JA (2013).
“A new representation for multivariate tail probabilities.”
<em>Bernoulli</em>, <b>19</b>(5B), 2689-2714.
ISSN 13507265, doi: <a href="https://doi.org/10.3150/12-BEJ471">10.3150/12-BEJ471</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

margdata &lt;- margtransf(airdata)

lambda &lt;- adf_est(margdata = margdata, method = "hill")

plot(lambda)

# To see the the S4 object's slots
str(lambda)

# To access the estimates of the ADF
lambda@adf

# If constrained = T, the MLE estimates for the conditional extremes model
# can be accessed as
lambda@interval

</code></pre>


</div>