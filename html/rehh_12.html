<div class="container">

<table style="width: 100%;"><tr>
<td>calc_sfs_tests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate site frequency spectrum test statistics</h2>

<h3>Description</h3>

<p>Calculate site frequency spectrum (SFS) tests Tajima's D, Fay &amp; Wu's H and Zeng's E.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_sfs_tests(
  haplohh,
  polarized = TRUE,
  window_size = NA,
  overlap = 0,
  right = TRUE,
  min_n_mrk = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>haplohh</code></td>
<td>
<p>an object of class <code>haplohh</code> (see <code>data2haplohh</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polarized</code></td>
<td>
<p>logical. <code>TRUE</code> by default. If <code>FALSE</code>, use major and minor allele instead of ancestral and derived. If there
are more than two alleles then the minor allele refers to the second-most frequent allele.
Note that Tajima's D remains unchanged, Fay &amp; Wu's H is always zero for folded spectra and Zeng's E becomes equal to Tajima's D.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_size</code></td>
<td>
<p>size of sliding windows. If <code>NA</code> (default), there will be only
one window covering the whole length of the chromosome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>size of window overlap (default 0, i.e. no overlap).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p>logical, indicating if the windows should be closed on the right and open on the left (default) or vice versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_n_mrk</code></td>
<td>
<p>minimum number of (polymorphic) markers per window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. <code>TRUE</code> by default; reports if multi-allelic sites are removed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Neutrality tests based on the site frequency spectrum (SFS) are
largely unrelated to EHH-based methods. The tests provided here are implemented
elsewhere, too (e.g. in package <a href="https://cran.r-project.org/package=PopGenome">PopGenome</a>).
</p>
<p>Each test compares two estimations of the <em>scaled mutation rate</em> theta,
which all have the same expected value under neutrality. Deviations from zero indicate
violations of the neutral null model, typically population size changes, population subdivision or selection.
Tajima's D and Fay &amp; Wu's H become negative in presence of an almost completed sweep, Zeng's E becomes
positive for some time after it. Significance can typically be assigned only by
simulations.
</p>
<p>The standard definition of the tests cannot cope with missing values and typically markers
with missing genotypes must be discarded. Ferretti (2012) provides an extension
that can handle missing values (without discarding any non-missing values). In this package, 
only the first moments (the theta-estimators themselves) are adapted accordingly, 
but not the second moments (their variances), because the latter is computationally demanding
and the resulting bias relatively small. It is recommended, though, to discard markers or haplotypes 
with more than 20% missing values.
</p>
<p>Multi-allelic markers are always removed since the tests rely on the "infinite sites model" which
implies that all polymorphic markers are bi-allelic. 
Monomorphic markers can be present, but are irrelevant for the tests.
</p>


<h3>Value</h3>

<p>A data frame with window coordinates, the number of contained (polymorphic) markers, Watterson's, Tajima's and Zeng's
estimators of theta and the test statistics of Tajima's D, Fay &amp; Wu's H and Zeng's E.
</p>


<h3>References</h3>

<p>Watterson, G.A. (1975). On the number of segregating sites in genetical models without recombination.
<em>Theoretical Population Biology</em> <strong>7</strong>(2) 256-276.
</p>
<p>Tajima, F. (1983). Evolutionary relationship of DNA sequences in finite populations.
<em>Genetics</em> <strong>105</strong>(2) 437-60.
</p>
<p>Tajima, F. (1989). Statistical method for testing the neutral mutation hypothesis by DNA polymorphism.
<em>Genetics</em> <strong>123</strong>(3) 585-95.
</p>
<p>Fay, J. and Wu, C. (2000). Hitchhiking under positive Darwinian selection. <em>Genetics</em>
<strong>155</strong>(3) 1405-13.
</p>
<p>Zeng, E. et al. (2006). Statistical tests for detecting positive selection by utilizing high-frequency variants.
<em>Genetics</em> <strong>174</strong>(3) 1431-9.
</p>
<p>Ferretti, L. and Raineri, E. and Ramos-Onsins, S. (2012). Neutrality tests for sequences with missing data.
<em>Genetics</em> <strong>191</strong>(4) 1397-401.
</p>


<h3>Examples</h3>

<pre><code class="language-R">make.example.files()
# neutral evolution
hh &lt;- data2haplohh("example_neutral.vcf", verbose = FALSE)
calc_sfs_tests(hh)
# strong selective sweep
hh &lt;- data2haplohh("example_sweep.vcf", verbose = FALSE)
calc_sfs_tests(hh)
remove.example.files()
</code></pre>


</div>