<div class="container">

<table style="width: 100%;"><tr>
<td>iprofile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produce Individual Time Profiles for Plotting</h2>

<h3>Description</h3>

<p><code>iprofile</code> is used for plotting individual profiles over time
for objects obtained from dynamic models. It produces output for
plotting recursive fitted values for individual time profiles from
such models.
</p>
<p>See <code>mprofile</code> for plotting marginal profiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'iprofile'
plot(x, nind=1, observed=TRUE, intensity=FALSE,
	add=FALSE, lty=NULL, pch=NULL, ylab=NULL, xlab=NULL,
	main=NULL, ylim=NULL, xlim=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>iprofile</code>, e.g. <code>x = iprofile(z, plotsd=FALSE)</code>,
where <code>z</code> is an object of class <code>recursive</code>, from
<code>carma</code>, <code>elliptic</code>,
<code>gar</code>, <code>kalcount</code>,
<code>kalseries</code>, <code>kalsurv</code>, or
<code>nbkal</code>.
If <code>plotsd</code> is If TRUE, plots standard deviations around profile
(<code>carma</code> and <code>elliptic</code> only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nind</code></td>
<td>
<p>Observation number(s) of individual(s) to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>If TRUE, plots observed responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intensity</code></td>
<td>
<p>If z has class, <code>kalsurv</code>, and this is TRUE, the
intensity is plotted instead of the time between events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>If TRUE, the graph is added to an existing plot.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>lty,pch,main,ylim,xlim,xlab,ylab</code></td>
<td>
<p> See base plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to other functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>iprofile</code> returns information ready for plotting by
<code>plot.iprofile</code>.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey</p>


<h3>See Also</h3>

<p><code>mprofile</code>
<code>plot.residuals</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## try this after you have repeated package installed
library(repeated)
times &lt;- rep(1:20,2)
dose &lt;- c(rep(2,20),rep(5,20))
mu &lt;- function(p) exp(p[1]-p[3])*(dose/(exp(p[1])-exp(p[2]))*
	(exp(-exp(p[2])*times)-exp(-exp(p[1])*times)))
shape &lt;- function(p) exp(p[1]-p[2])*times*dose*exp(-exp(p[1])*times)
conc &lt;- matrix(rgamma(40,1,scale=mu(log(c(1,0.3,0.2)))),ncol=20,byrow=TRUE)
conc[,2:20] &lt;- conc[,2:20]+0.5*(conc[,1:19]-matrix(mu(log(c(1,0.3,0.2))),
	ncol=20,byrow=TRUE)[,1:19])
conc &lt;- ifelse(conc&gt;0,conc,0.01)
z &lt;- gar(conc, dist="gamma", times=1:20, mu=mu, shape=shape,
	preg=log(c(1,0.4,0.1)), pdepend=0.5, pshape=log(c(1,0.2)))
# plot individual profiles and the average profile
plot(iprofile(z), nind=1:2, pch=c(1,20), lty=3:4)
plot(mprofile(z), nind=1:2, lty=1:2, add=TRUE)

## End(Not run)
</code></pre>


</div>