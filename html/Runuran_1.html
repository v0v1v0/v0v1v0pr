<div class="container">

<table style="width: 100%;"><tr>
<td>Runuran-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Runuran – R interface to Universal Non-Uniform RANdom variate
generators library</h2>

<h3>Description</h3>

<p>R interface to the UNU.RAN library for Universal Non-Uniform RANdom
variate generators</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
    Package: </td>
<td style="text-align: left;"> Runuran       </td>
</tr>
<tr>
<td style="text-align: left;">
    Type:    </td>
<td style="text-align: left;"> Package       </td>
</tr>
<tr>
<td style="text-align: left;">
    Version: </td>
<td style="text-align: left;"> 0.40          </td>
</tr>
<tr>
<td style="text-align: left;">
    Date:    </td>
<td style="text-align: left;"> 2024-10-03    </td>
</tr>
<tr>
<td style="text-align: left;">
    License: </td>
<td style="text-align: left;"> GPL 2 or later</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p><span class="pkg">Runuran</span> provides an interface to the UNU.RAN library for
universal non-uniform random number generators.
It provides a collection of so called automatic methods for
non-uniform random variate generation. Thus it is possible to draw
samples from uncommon distributions. Nevertheless, (some of) these
algorithms are also well suited for standard distribution like the
normal distribution. Moreover, sampling from distributions like the
generalized hyperbolic distribution is very fast. Such distributions
became recently popular in financial engineering.
</p>
<p><span class="pkg">Runuran</span> compiles four sets of functions of increasing power (and
thus complexity):
</p>

<ul>
<li>
<p><b>[Special Generator]</b> –
Generators for particular distributions. Their syntax is similar to
the corresponding <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> built-in functions.
</p>
</li>
<li>
<p><b>[Universal]</b> –
Functions that offer an interface to a carefully selected
collection of UNU.RAN methods with their most important
parameters.
</p>
</li>
<li>
<p><b>[Distribution]</b> –
Functions that create objects for important distributions.
These objects can then be used in combination with one of the
universal methods which is best suited for a particular
application.
</p>
</li>
<li>
<p><b>[Advanced]</b> –
Wrapper to the UNU.RAN string API. This gives access to all
UNU.RAN methods and their variants.
</p>
</li>
</ul>
<p>We have marked all functions in their corresponding help page by one
these four tags.
</p>
<p>An introduction to <span class="pkg">Runuran</span> with examples together with a very
short survey on non-uniform random variate generation can be found in
the package vignette (which can be displayed using
<code>vignette("Runuran")</code>). 
</p>


<h3>[Special Generator]</h3>

<p>These functions have similar syntax to the analogous <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> built-in
generating functions (if these exist) but have optional domain
arguments <code>lb</code> and <code>ub</code>, i.e., these calls also allow to
draw samples from truncated distributions:
</p>
<p><code>ur...(n, distribution parameters, lb , ub)</code>
</p>
<p>Compared to the corresponding <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> functions these <code>ur...</code>
functions have a different behavior:
</p>

<ul>
<li> <p><code>ur...</code> functions are often much faster for large
samples (e.g., a factor of about 5 for the <code class="reqn">t</code> distribution).
For small samples they are slow.
</p>
</li>
<li>
<p> All <code>ur...</code> functions allow to sample from truncated
versions of the original distributions. Therefore the arguments
<code>lb</code> (lower border) and <code>ub</code> (upper border) are
available for all these functions.
</p>
</li>
<li>
<p> Almost all <code>ur...</code> functions are based on fast numerical
inversion algorithms. This is important for example for generating
order statistics, quasi-Monte Carlo methods or random vectors from
copulas.
</p>
</li>
<li>
<p> All <code>ur...</code> functions do <strong>not</strong> allow vectors as
arguments (to be more precise: they only use the first element of
the vector).
</p>
</li>
</ul>
<p>However, we recommend to use the more flexible approach described in
the next sections below.
</p>
<p>A list of all available special generators can be found in
<code>Runuran.special.generators</code>.
</p>


<h3>[Universal]</h3>

<p>These functions allow access to a selected collection of UNU.RAN
methods. They require some data about the target distribution as
arguments and return an instance of a UNU.RAN generator object that is
implemented as an S4 class <code>unuran</code>. These can then
be used to draw samples from the desired distribution by means of 
function <code>ur</code>.
Methods that implement an <em>inversion</em> method can also be
used for quantile function <code>uq</code>.
</p>
<p>Currently the following methods are available by such functions.
</p>
<p>Continuous Univariate Distributions:
</p>

<table>
<tr>
<td style="text-align: left;"> 
    <em>Function</em>         </td>
<td style="text-align: center;">        </td>
<td style="text-align: left;"> <em>Method</em> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>arou.new</code>  </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Automatic Ratio-of-Uniforms method </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>ars.new</code>   </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Adaptive Rejection Sampling </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>itdr.new</code>  </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Inverse Transformed Density Rejection </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>pinv.new</code>  </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Polynomial interpolation of INVerse CDF </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>srou.new</code>  </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Simple Ratio-Of-Uniforms method </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>tabl.new</code>  </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> TABLe based rejection </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>tdr.new</code>   </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Transformed Density Rejection </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>Discrete Distributions:
</p>

<table>
<tr>
<td style="text-align: left;"> 
    <em>Function</em>         </td>
<td style="text-align: center;">        </td>
<td style="text-align: left;"> <em>Method</em> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>dari.new</code>  </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Discrete Automatic Rejection Inversion </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>dau.new</code>   </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Alias-Urn Method </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>dgt.new</code>   </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Guide-Table Method for discrete inversion </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>Multivariate Distributions:
</p>

<table>
<tr>
<td style="text-align: left;"> 
    <em>Function</em>         </td>
<td style="text-align: center;">        </td>
<td style="text-align: left;"> <em>Method</em> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>hitro.new</code> </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Hit-and-Run with Ratio-of-Uniforms method </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>vnrou.new</code> </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> Multivariate Naive Ratio-Of-Uniforms method </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>[Distribution]</h3>

<p>Coding the required functions for particular distributions can be
tedious. Thus we have compiled a set of functions that create UNU.RAN
distribution objects that can directly be used with the functions from
section [Universal].
</p>
<p>A list of all available distributions can be found in
<code>Runuran.distributions</code>.
</p>


<h3>[Advanced]</h3>

<p>This interface provides the most flexible access to UNU.RAN.
It requires three steps:
</p>

<ol>
<li>
<p>Create a <code>unuran.distr</code> object that contains
all required information about the <em>target distribution</em>.
We have three types of distributions:
</p>

<table>
<tr>
<td style="text-align: left;"> 
      <em>Function</em>                </td>
<td style="text-align: center;">        </td>
<td style="text-align: left;"> <em>Type of distribution</em> </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>unuran.cont.new</code>  </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> continuous distributions </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>unuran.discr.new</code> </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> discrete distributions </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>unuran.cmv.new</code>   </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> multivariate continuous distributions </td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
</tr>
</table>
<p>The functions from section [Distribution] creates such objects for
particular distributions.
</p>
</li>
<li>
<p>Choose a <em>generation method</em> and create a
<code>unuran</code> object using function
<code>unuran.new</code>.
This function takes two argument: the distribution object created
in Step 1, and a string that contains the chosen UNU.RAN method
and (optional) some parameters to adjust this method to the given
target distribution. We refer to the UNU.RAN for more details on
this “method string”.
</p>
</li>
<li>
<p>Use this object to <em>draw samples</em> from the target
distribution using <code>ur</code> or <code>uq</code>.
</p>

<table>
<tr>
<td style="text-align: left;"> 
      <em>Function</em>              </td>
<td style="text-align: center;">        </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>ur</code>             </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> draw sample </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>uq</code>             </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> compute quantile (inverse CDF) </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>unuran.details</code> </td>
<td style="text-align: center;"> ... </td>
<td style="text-align: left;"> show <code>unuran</code> object </td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
</tr>
</table>
</li>
</ol>
<h3>Density and distribution function</h3>

<p>UNU.RAN distribution objects and generator objects may also be used to
compute density and distribution function for a given distribution by
means of <code>ud</code> and <code>up</code>.
</p>


<h3>Uniform random numbers</h3>

<p>All UNU.RAN methods use the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> built-in random number generator as
source of (pseudo-) random numbers. Thus the generated samples depend
on the state <code>.Random.seed</code> and can be controlled by the
<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> functions <code>RNGkind</code> and <code>set.seed</code>.
</p>


<h3>Warning</h3>

<p><code>unuran</code> objects cannot be saved and restored in later <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>
sessions, nor is it possible to copy such objects to different nodes
in a computer cluster.
</p>
<p>However, <code>unuran</code> objects for <em>some</em> generation methods can be
“packed”, see <code>unuran.packed</code>.
Then these objects can be handled like any other <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object
(and thus saved and restored).
</p>
<p>All other objects <strong>must</strong> be <strong>newly created</strong> in a new <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>
session!
(Using a restored object does not work as the <code>"unuran"</code> object
is then broken.)
</p>


<h3>Note</h3>

<p>The interface has been changed compared to the DSC 2003 paper.
</p>


<h3>Author(s)</h3>

<p>Josef Leydold and Wolfgang H\"ormann
<a href="mailto:unuran@statmath.wu.ac.at">unuran@statmath.wu.ac.at</a>.
</p>


<h3>References</h3>

<p>J. Leydold and W. H\"ormann (2000-2008):
UNU.RAN User Manual, see
<a href="https://statmath.wu.ac.at/unuran/">https://statmath.wu.ac.at/unuran/</a>.
</p>
<p>W. H\"ormann, J. Leydold, and G. Derflinger (2004):
Automatic Nonuniform Random Variate Generation.
Springer-Verlag, Berlin Heidelberg
</p>
<p>G. Tirler and J. Leydold (2003):
Automatic Nonuniform Random Variate Generation in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.
In: K. Hornik and F. Leisch, 
Proceedings of the 3rd International Workshop on
Distributed Statistical Computing (DSC 2003),
March 20–22, Vienna, Austria.
</p>


<h3>See Also</h3>

<p>All objects are implemented as respective S4 classes
<code>unuran</code>,
<code>unuran.distr</code>,
<code>unuran.cont</code>,
<code>unuran.discr</code>,
<code>unuran</code>.
</p>
<p>See <code>Runuran.special.generators</code> for an overview of
special generators and 
<code>Runuran.distributions</code> for a list of ready-to-use
distributions suitable for the automatic methods.
</p>


</div>