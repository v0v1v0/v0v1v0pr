<div class="container">

<table style="width: 100%;"><tr>
<td>GBM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Gene Regulatory Network from Expression data using either LS-TreeBoost or LAD-TreeBoost
</h2>

<h3>Description</h3>

<p>This function calculates a Ntfs-by-Ntargets adjacency matrix A from N-by-p expression matrix E. E is expected to be given as input. E is assumed to have p columns corresponding to all the genes, Ntfs represents the number of transcription factors and Ntargets represents the number of target genes and N rows corresponding to different experiments. Additionally, GBM function takes matrix of initial perturbations of genes K of the same size as E, and other parameters including which loss function to use (LS = 1, LAD = 2). As a result, GBM returns a squared matrix A of edge confidences of size Ntfs-by-Ntargets. A subset of known transcription factors can be defined as a subset of all p genes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GBM(E = matrix(rnorm(100), 10, 10), K = matrix(0, nrow(E), ncol(E)), 
     tfs = paste0("G",c(1:10)), targets = paste0("G",c(1:10)), 
     s_s = 1, s_f = 0.3, lf = 1, 
     M = 5000,nu = 0.001, scale = TRUE,center = TRUE, optimization.stage = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>

<p>N-by-p expression matrix. Columns correspond to genes, rows correspond to experiments. E is expected to be already normalized using standard methods, for example RMA. Colnames of E is the set of all genes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>

<p>N-by-p initial perturbation matrix. It directly corresponds to E matrix, e.g. if K[i,j] is equal to 1, it means that gene j was knocked-out in experiment i. Single gene knock-out experiments are rows of K with only one value 1. Colnames of K is set to be the set of all genes. By default it's a matrix of zeros of the same size as E, e.g. unknown initial perturbation state of genes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tfs</code></td>
<td>

<p>List of names of transcription factors
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets</code></td>
<td>

<p>List of names of target genes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_s</code></td>
<td>

<p>Sampling rate of experiments, 0&lt;s_s&lt;=1. Fraction of rows of E, which will be sampled with replacement to calculate each extension in boosting model. By default it's 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_f</code></td>
<td>

<p>Sampling rate of transcription factors, 0&lt;s_f&lt;=1. Fraction of transcription factors from E, as indicated by <code>tfs</code> vector, which will be sampled without replacement to calculate each extesion in boosting model. By default it's 0.3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lf</code></td>
<td>

<p>Loss function: 1 -&gt; Least Squares, 2 -&gt; Least Absolute deviation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>Number of extensions in boosting model, e.g. number of iterations of the main loop of RGBM algorithm. By default it's 5000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>Shrinkage factor, learning rate, 0&lt;nu&lt;=1. Each extension to boosting model will be multiplied by the learning rate. By default it's 0.001.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>Logical flag indicating if each column of E should be scaled to be unit standard deviation. By default it's TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>Logical flag indicating if each column of E should be scaled to be zero mean. By default it's TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization.stage</code></td>
<td>

<p>Numerical flag indicating if re-evaluation of edge confidences should be applied after calculating initial V, optimization.stage={0,1,2}. If optimization.stage=0, no re-evaluation will be applied. If optimization.stage=1, variance-based optimization will be applied. If optimization.stage=2, variance-based and z-score based optimizations will be applied.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>A</code></td>
<td>

<p>Gene Regulatory Network in form of a Ntfs-by-Ntargets adjacency matrix.
</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Raghvendra Mall &lt;rmall@hbku.edu.qa&gt;
</p>


<h3>See Also</h3>


<p><code>GBM.train</code>, <code>GBM.test</code>, <code>v2l</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load RGBM library
library("RGBM")
# this step is optional, it helps speed up calculations, run in parallel on 2 processors
library(doParallel)
cl &lt;- makeCluster(2)
# run network inference on a 100-by-100 dummy expression data.
V = GBM()
stopCluster(cl)
</code></pre>


</div>