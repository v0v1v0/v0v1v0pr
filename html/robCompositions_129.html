<div class="container">

<table style="width: 100%;"><tr>
<td>daFisher</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Discriminant analysis by Fisher Rule.</h2>

<h3>Description</h3>

<p>Discriminant analysis by Fishers rule using the logratio approach to compositional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">daFisher(x, grp, coda = TRUE, method = "classical", plotScore = FALSE, ...)

## S3 method for class 'daFisher'
print(x, ...)

## S3 method for class 'daFisher'
predict(object, ..., newdata)

## S3 method for class 'daFisher'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame containing the explanatory variables
(training set)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p>grouping variable: a factor specifying the class for each
observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coda</code></td>
<td>
<p>TRUE, when the underlying data are compositions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>“classical” or “robust” estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotScore</code></td>
<td>
<p>TRUE, if the scores should be plotted automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the print method passed through</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class “daFisher”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>new data in the appropriate form (CoDa, etc)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Fisher rule leads only to linear boundaries. However, this method allows
for dimension reduction and thus for a better visualization of the
separation boundaries. For the Fisher discriminant rule (Fisher, 1938; Rao,
1948) the assumption of normal distribution of the groups is not explicitly
required, although the method looses its optimality in case of deviations
from normality.
</p>
<p>The classical Fisher discriminant rule is invariant to ilr coordinates and clr
coefficients. The robust rule is invariant to ilr transformations if
affine equivariant robust estimators of location and covariance are taken.
</p>
<p>Robustification is done (method “robust”) by estimating the
columnwise means and the covariance by the Minimum Covariance Estimator.
</p>


<h3>Value</h3>

<p>an object of class “daFisher” including the following
elements 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>B </code></td>
<td>
<p>Between variance of the groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W </code></td>
<td>
<p>Within variance
of the groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>fisher scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc</code></td>
<td>
<p>table indicating misclassifications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcrate</code></td>
<td>
<p>misclassification rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coda</code></td>
<td>
<p>coda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p>grouping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grppred</code></td>
<td>
<p>predicted groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xc</code></td>
<td>
<p>xc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanj</code></td>
<td>
<p>meanj</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>cv</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pj</code></td>
<td>
<p>pj</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanov</code></td>
<td>
<p>meanov</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdiscr</code></td>
<td>
<p>fdiscr</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Filzmoser, Matthias Templ.
</p>


<h3>References</h3>

<p>Filzmoser, P. and Hron, K. and Templ, M. (2012) 
Discriminant analysis for compositional data and robust parameter estimation. 
<em>Computational Statistics</em>, 27(4), 585-604.
</p>
<p>Fisher, R. A. (1938) The statistical utiliziation of multiple measurements.
<em>Annals of Eugenics</em>, 8, 376-386.
</p>
<p>Rao, C.R. (1948) The utilization of multiple measurements in problems of
biological classification. <em>Journal of the Royal Statistical Society</em>,
Series B, 10, 159-203.
</p>


<h3>See Also</h3>

<p><code>Linda</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## toy data (non-compositional)
require(MASS)
x1 &lt;- mvrnorm(20,c(0,0,0),diag(3))
x2 &lt;- mvrnorm(30,c(3,0,0),diag(3))
x3 &lt;- mvrnorm(40,c(0,3,0),diag(3))
X &lt;- rbind(x1,x2,x3)
grp=c(rep(1,20),rep(2,30),rep(3,40))

#par(mfrow=c(1,2))
d1 &lt;- daFisher(X,grp=grp,method="classical",coda=FALSE)
d2 &lt;- daFisher(X,grp=grp,method="robust",coda=FALSE)
d2
summary(d2)
predict(d2, newdata = X)

## example with olive data:
## Not run: 
data(olive, package = "RnavGraph")
# exclude zeros (alternatively impute them if 
# the detection limit is known using impRZilr())
ind &lt;- which(olive == 0, arr.ind = TRUE)[,1]
olives &lt;- olive[-ind, ]
x &lt;- olives[, 4:10]
grp &lt;- olives$Region # 3 groups
res &lt;- daFisher(x,grp)
res
summary(res)
res &lt;- daFisher(x, grp, plotScore = TRUE)
res &lt;- daFisher(x, grp, method = "robust")
res
summary(res)
predict(res, newdata = x)
res &lt;- daFisher(x,grp, plotScore = TRUE, method = "robust")

# 9 regions
grp &lt;- olives$Area
res &lt;- daFisher(x, grp, plotScore = TRUE)
res
summary(res)
predict(res, newdata = x)

## End(Not run)
</code></pre>


</div>