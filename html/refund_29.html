<div class="container">

<table style="width: 100%;"><tr>
<td>fosr.vs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function-on Scalar Regression with variable selection</h2>

<h3>Description</h3>

<p>Implements an iterative algorithm for function-on-scalar regression with variable selection
by alternatively updating the coefficients and covariance structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fosr.vs(
  formula,
  data,
  nbasis = 10,
  method = c("ls", "grLasso", "grMCP", "grSCAD"),
  epsilon = 1e-05,
  max.iter_num = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>{formula}</code>": an expression of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame that contains the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>number of B-spline basis functions used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>group variable selection method to be used ("grLasso", "grMCP", "grSCAD" refer to group Lasso, group MCP and group SCAD, respectively) or "<code>ls</code>" for least squares estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>the convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter_num</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A fitted fosr.vs-object, which is a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>{formula}</code>": an expression of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the estimated coefficient functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residual curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>the estimated variance-covariance matrix when convergence is achieved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>group variable selection method to be used or "<code>ls</code>" for least squares estimation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yakuan Chen <a href="mailto:yc2641@cumc.columbia.edu">yc2641@cumc.columbia.edu</a>
</p>


<h3>References</h3>

<p>Chen, Y., Goldsmith, J., and Ogden, T. (2016).
Variable selection in function-on-scalar regression. <em>Stat</em> 5 88-101
</p>


<h3>See Also</h3>

<p><code>{grpreg}</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(100)

I = 100
p = 20
D = 50
grid = seq(0, 1, length = D)

beta.true = matrix(0, p, D)
beta.true[1,] = sin(2*grid*pi)
beta.true[2,] = cos(2*grid*pi)
beta.true[3,] = 2

psi.true = matrix(NA, 2, D)
psi.true[1,] = sin(4*grid*pi)
psi.true[2,] = cos(4*grid*pi)
lambda = c(3,1)

set.seed(100)

X = matrix(rnorm(I*p), I, p)
C = cbind(rnorm(I, mean = 0, sd = lambda[1]), rnorm(I, mean = 0, sd = lambda[2]))

fixef = X%*%beta.true
pcaef = C %*% psi.true
error = matrix(rnorm(I*D), I, D)

Yi.true = fixef
Yi.pca = fixef + pcaef
Yi.obs = fixef + pcaef + error

data = as.data.frame(X)
data$Y = Yi.obs
fit.fosr.vs = fosr.vs(Y~., data = data, method="grMCP")
plot(fit.fosr.vs)

## End(Not run)


</code></pre>


</div>