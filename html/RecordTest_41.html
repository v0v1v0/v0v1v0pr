<div class="container">

<table style="width: 100%;"><tr>
<td>series_uncor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Subset of Uncorrelated Series</h2>

<h3>Description</h3>

<p>Given a matrix this function extracts a subset of uncorrelated
columns (see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">series_uncor(
  X,
  test.fun = stats::cor.test,
  return.value = c("series", "indexes"),
  type = c("adjacent", "all"),
  first.last = TRUE,
  m = 1,
  alpha = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric matrix (or data frame) where the uncorrelated vectors 
are extracted from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.fun</code></td>
<td>
<p>A function that tests the correlation (it could also
test dependence or other feature that is desired to test on the columns). 
It must take as arguments two numeric vectors of the same length to apply 
the test to. The alternative hypothesis between both vectors is that the 
true correlation is not equal to 0 (or that they are dependent, etc). The 
return value should be a list object with a component <code>p.value</code> with 
the p-value of the test. Default is <code>cor.test</code>. Other 
function to test tail dependence is found in the package <code>extRemes</code>
as <code>taildep.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.value</code></td>
<td>
<p>A character string indicating the return of the function,
<code>"series"</code> for a matrix with uncorrelated columns or <code>"indexes"</code>
for a vector with the position of the uncorrelated columns in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string indicating the type of uncorrelation wanted
between the extracted series (or columns), <code>"adjacent"</code> or 
<code>"all"</code> (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first.last</code></td>
<td>
<p>Logical. Indicates if the first and last columns have also
to be uncorrelated (when <code>type = "adjacent"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Integer value giving the starting column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value in <code class="reqn">(0,1)</code>. It gives the significance level. 
For <code>cor.test</code> the alternative hypothesis is that the 
true correlation is not equal to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>test.fun</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is used in the data preparation (or pre-processing) 
often required to apply the exploratory and inference tools based on 
theory of records within this package.
</p>
<p>Given a matrix <code>X</code> considered as a set of <code class="reqn">M^*</code> vectors, which
are the columns of <code>X</code>, this function extracts a subset 
of uncorrelated vectors (columns), using the following procedure: starting
from column <code>m</code>, the test <code>test.fun</code> is applied to
study the correlation between columns depending on argument <code>type</code>.
</p>
<p>If <code>type = "adjacent"</code>, the test is computed between <code>m</code>
and <code class="reqn">\code{m} + 1, \code{m} + 2, \ldots</code> and so on up to find a column 
<code class="reqn">\code{m} + k</code> which is not significantly correlated with column 
<code>m</code>. Then, the process is repeated starting at column 
<code class="reqn">\code{m} + k</code>. All columns are checked. 
</p>
<p>When the first and last columns may not have a significant correlation, 
where <code>m</code> is the first column, the parameter <code>first.last</code> should
be <code>FALSE</code>. When the first and last columns could be correlated, 
the function requires <code>first.last = TRUE</code>.
</p>
<p>If <code>type = "all"</code>, the procedure is similar as above but the new kept
column cannot be significantly correlated with any other column already 
kept, not only the previous one. So this option results in a fewer number
of columns.
</p>


<h3>Value</h3>

<p>A matrix or a vector as specified by <code>return.value</code>.
</p>


<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2), 313-330. 
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>


<h3>See Also</h3>

<p><code>series_double</code>, <code>series_record</code>,
<code>series_rev</code>, <code>series_split</code>,
<code>series_ties</code>, <code>series_untie</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Split Zaragoza series
TxZ &lt;- series_split(TX_Zaragoza$TX)

# Index of uncorrelated columns depending on the criteria
series_uncor(TxZ, return.value = "indexes", type = "adjacent")
series_uncor(TxZ, return.value = "indexes", type = "all")

# Return the set of uncorrelated vectors
ZaragozaSeries &lt;- series_uncor(TxZ)

</code></pre>


</div>