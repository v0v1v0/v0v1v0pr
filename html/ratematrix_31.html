<div class="container">

<table style="width: 100%;"><tr>
<td>testRatematrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for difference between evolutionary rate matrix estimates</h2>

<h3>Description</h3>

<p>Function uses summary statistics to test for differences between the posterior distribution of parameter estimates for the evolutionary rate matrix regimes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testRatematrix(
  chain,
  par = c("all", "correlation", "rates"),
  diff.test = FALSE,
  median.test = FALSE,
  regimes = NULL,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>the posterior distribution of parameter estimates as output of the function 'readMCMC'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>the attribute of the rate matrices that are checked by the test. One of 'all', 'correlation', or 'rates' (default is 'all'). Choose 'all' to compute the summary statistics for the overall matrix. Choose 'rates' to check the rates of evolution among the traits. Choose 'correlation' to compute the summary statistics for the evolutionary correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.test</code></td>
<td>
<p>whether to return the pairwise difference between the parameters computed from the joint posterior distribution. If set to FALSE (default), then the results will be based on the overlap percentage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median.test</code></td>
<td>
<p>whether to return a median of the summary statistics across all elements of the evolutionary rate matrices. The default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regimes</code></td>
<td>
<p>a numeric vector or character vector. This is the set of regimes to be compared. If numeric, then the regimes are in the same order as in the 'chain' argument. If character, than names need to match the names of the rate regimes fitted to the phylogenetic tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to plot the results of the summary statistics test applied to every element of the matrix. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This functions performs a test to check whether the posterior distribution of the fitted matrices are different. It returns the proportion of overlap between regimes. When this proportion is less than 0.05 this means that the posterior distribution of the elements of the evolutionary rate matrices does not overlap more than 5%. This test statistics is NOT a p value! This is not an estimate of the probability of deviance from a null distribution. It assumes that when the posterior distribution of two or more paramaters do not overlap, then there is a relevant difference between the parameters. <br><br>
The test can be performed using the median overlap of the posterior distribution across all elements of the ratematrix or by contrasting each element separatelly. Checking each element independently provides more information. Using the median overlap will result in a single value returned, but it can be insensitive to important changes in the evolutionary rate matrices between regimes. When a posterior distribution with more than two rate regimes is fitted to the data, the function performs tests for all pairwise combinations.
</p>


<h3>Value</h3>

<p>Return a matrix or a list with the value of the test statistics.
</p>


<h3>Author(s)</h3>

<p>Daniel S. Caetano and Luke J. Harmon
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data( centrarchidae )
handle &lt;- ratematrixMCMC(data=centrarchidae$data, phy=centrarchidae$phy.map
                         , gen=50000, dir=tempdir())
posterior &lt;- readMCMC(handle, burn = 0.2, thin = 1)
testRatematrix(posterior, par = "all")
testRatematrix(posterior, par = "correlation")
testRatematrix(posterior, par = "rates")
testRatematrix(posterior, par = "correlation", plot = TRUE)

</code></pre>


</div>