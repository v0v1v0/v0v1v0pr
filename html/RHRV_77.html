<div class="container">

<table style="width: 100%;"><tr>
<td>RQA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Recurrence Quantification Analysis (RQA)</h2>

<h3>Description</h3>

<p>The Recurrence Quantification Analysis (RQA) is an advanced technique for the nonlinear
analysis that allows to quantify the number and duration of the recurrences in the 
phase space. This function computes the RQA of the RR time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RQA(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  numberPoints = NULL,
  embeddingDim = NULL,
  timeLag = NULL,
  radius = 1,
  lmin = 2,
  vmin = 2,
  distanceToBorder = 2,
  doPlot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HRVData</code></td>
<td>
<p>Data structure that stores the beats register and information related to it</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexNonLinearAnalysis</code></td>
<td>
<p>Reference to the data structure that will contain the nonlinear analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numberPoints</code></td>
<td>
<p>Number of points from the RR time series to be used in the RQA computation. If the number of
points is not specified, the whole RR time series is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embeddingDim</code></td>
<td>
<p>Integer denoting the dimension in which we shall embed the RR time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeLag</code></td>
<td>
<p>Integer denoting the number of time steps that will be use to construct the 
Takens' vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Maximum distance between two phase-space points to be considered a recurrence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmin</code></td>
<td>
<p>Minimal length of a diagonal line to be considered in the RQA. Default <em>lmin</em> = 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vmin</code></td>
<td>
<p>Minimal length of a vertical line to be considered in the RQA. Default <em>vmin</em> = 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distanceToBorder</code></td>
<td>
<p>In order to avoid border effects, the <em>distanceToBorder</em> points near the 
border of the recurrence matrix are ignored when computing the RQA parameters. Default, <em>distanceToBorder</em> = 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>Logical. If TRUE, the recurrence plot is shown. However, plotting the recurrence matrix is computationally 
expensive. Use with caution.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A HRVData structure that stores an <em>rqa</em> field under the NonLinearAnalysis list.
The <em>rqa</em> field consist of a list with the most important RQA parameters:
</p>

<ul>
<li> <p><em>REC</em>: Recurrence. Percentage of recurrence points in a Recurrence Plot.
</p>
</li>
<li> <p><em>DET</em>: Determinism. Percentage of recurrence points that form diagonal lines.
</p>
</li>
<li> <p><em>LAM</em>: Percentage of recurrent points that form vertical lines.
</p>
</li>
<li> <p><em>RATIO</em>: Ratio between <em>DET</em> and <em>RR</em>.
</p>
</li>
<li> <p><em>Lmax</em>: Length of the longest diagonal line.
</p>
</li>
<li> <p><em>Lmean</em>: Mean length of the diagonal lines. The main diagonal is not taken into account.
</p>
</li>
<li> <p><em>DIV</em>: Inverse of <em>Lmax</em>.
</p>
</li>
<li> <p><em>Vmax</em>: Longest vertical line.
</p>
</li>
<li> <p><em>Vmean</em>: Average length of the vertical lines. This parameter is also referred to as the Trapping time.
</p>
</li>
<li> <p><em>ENTR</em>: Shannon entropy of the diagonal line lengths distribution
</p>
</li>
<li> <p><em>TREND</em>: Trend of the number of recurrent points depending on the distance to the main diagonal
</p>
</li>
<li> <p><em>diagonalHistogram</em>: Histogram of the length of the diagonals.
</p>
</li>
<li> <p><em>recurrenceRate</em>: Number of recurrent points depending on the distance to the main diagonal.
</p>
</li>
</ul>
<h3>Note</h3>

<p>This function is based on the <code>rqa</code> function from the 
nonlinearTseries package.
</p>


<h3>References</h3>

<p>Zbilut, J. P. and C. L. Webber. Recurrence quantification analysis. Wiley Encyclopedia of Biomedical Engineering  (2006).
</p>


<h3>See Also</h3>

<p><code>rqa</code>, <code>RecurrencePlot</code>
</p>


</div>