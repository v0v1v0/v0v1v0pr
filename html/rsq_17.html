<div class="container">

<table style="width: 100%;"><tr>
<td>vresidual</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance-Function-Based Residuals</h2>

<h3>Description</h3>

<p>Calculate the variance-function-based residuals for generalized linear models, which are used to calculate the variance-function-based R-squared.</p>


<h3>Usage</h3>

<pre><code class="language-R">vresidual(y,yfit,family=binomial(),variance=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> a vector of observed values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yfit</code></td>
<td>
<p> a vector of fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
 <p>family of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p> variance function (specified by family by default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The calcualted residual relies on the variance function, and is well-defined for quasi models. It reduces to the classical residual when the variance function is constant or linear. Note that only the variance function is required to specify, via either "family"" or "variance".
</p>


<h3>Value</h3>

<p>Variance-function-based residuals.</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>


<h3>See Also</h3>

<p><code>rsq.v, rsq</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family="binomial")
vresidual(y,bnfit$fitted.values,family="binomial")

# Effectiveness of Bycycle Safety Helmets in Thompson et al. (1989)
y &lt;- matrix(c(17,218,233,758),2,2)
x &lt;- factor(c("yes","no"))
tbn &lt;- glm(y~x,family="binomial")
yfit &lt;- cbind(tbn$fitted.values, 1-tbn$fitted.values)
vr0 &lt;- vresidual(matrix(0,2,1),yfit[,1],family="binomial")
vr1 &lt;- vresidual(matrix(1,2,1),yfit[,2],family="binomial")
y[,1]*vr0+y[,2]*vr1
</code></pre>


</div>