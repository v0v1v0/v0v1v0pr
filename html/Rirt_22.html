<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_3pl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the 3PL model</h2>

<h3>Description</h3>

<p>Estimate the 3PL model using the joint or marginal 
maximum likelihood estimation methods
</p>
<p><code>model_3pl_eap</code> scores response vectors using the EAP method
</p>
<p><code>model_3pl_map</code> scores response vectors using the MAP method
</p>
<p><code>model_3pl_jmle</code> estimates the item and ability parameters
using the joint maximum likelihood estimation (JMLE) method
</p>
<p><code>model_3pl_mmle</code> estimates the item parameters using the 
marginal maximum likelihood estimation (MMLE) method
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_3pl_eap(u, a, b, c, D = 1.702, priors = c(0, 1),
  bounds_t = c(-4, 4))

model_3pl_map(u, a, b, c, D = 1.702, priors = c(0, 1),
  bounds_t = c(-4, 4), iter = 30, conv = 0.001)

model_3pl_dv_Pt(t, a, b, c, D)

model_3pl_dv_Pa(t, a, b, c, D)

model_3pl_dv_Pb(t, a, b, c, D)

model_3pl_dv_Pc(t, a, b, c, D)

model_3pl_dv_jmle(pdv_fn, u, t, a, b, c, D)

model_3pl_jmle(u, t = NA, a = NA, b = NA, c = NA, D = 1.702,
  iter = 100, conv = 0.001, nr_iter = 10, scale = c(0, 1),
  bounds_t = c(-4, 4), bounds_a = c(0.01, 2.5), bounds_b = c(-4, 4),
  bounds_c = c(0, 0.4), priors = list(t = c(0, 1)), decay = 1,
  verbose = FALSE, true_params = NULL)

model_3pl_dv_mmle(pdv_fn, u, quad, a, b, c, D)

model_3pl_mmle(u, t = NA, a = NA, b = NA, c = NA, D = 1.702,
  iter = 100, conv = 0.001, nr_iter = 10, bounds_t = c(-4, 4),
  bounds_a = c(0.01, 2.5), bounds_b = c(-4, 4), bounds_c = c(0, 0.4),
  priors = list(t = c(0, 1)), decay = 1, quad = "11",
  score_fn = c("eap", "map"), verbose = FALSE, true_params = NULL)

model_3pl_fitplot(u, t, a, b, c, D = 1.702, index = NULL,
  intervals = seq(-3, 3, 0.5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>observed response matrix, 2d matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>discrimination parameters, 1d vector (fixed value) or NA (freely estimate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>difficulty parameters, 1d vector (fixed value) or NA (freely estimate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>pseudo-guessing parameters, 1d vector (fixed value) or NA (freely estimate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>the scaling constant, 1.702 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors</code></td>
<td>
<p>prior distributions, a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds_t</code></td>
<td>
<p>the bounds of ability parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the maximum iterations, default=100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>the convergence criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>ability parameters, 1d vector (fixed value) or NA (freely estimate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdv_fn</code></td>
<td>
<p>the function to compute derivatives of P w.r.t the estimating parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_iter</code></td>
<td>
<p>the maximum newton-raphson iterations, default=10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>the mean and SD of the theta scale, default=<code>c(0,1)</code> in JMLE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds_a</code></td>
<td>
<p>the bounds of discrimination parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds_b</code></td>
<td>
<p>the bounds of difficulty parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds_c</code></td>
<td>
<p>the bounds of guessing parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decay</code></td>
<td>
<p>decay rate, default=1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>TRUE to print details for debugging</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_params</code></td>
<td>
<p>a list of true parameters for evaluating the parameter recovery</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quad</code></td>
<td>
<p>the number of quadrature points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score_fn</code></td>
<td>
<p>the scoring function: 'eap' or 'map'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>the indices of items being plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals</code></td>
<td>
<p>intervals on the x-axis</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>model_3pl_eap</code> returns theta estimates and standard errors in a list
</p>
<p><code>model_3pl_map</code> returns theta estimates in a list
</p>
<p><code>model_3pl_jmle</code> returns estimated t, a, b, c parameters in a list
</p>
<p><code>model_3pl_mmle</code> returns estimated t, a, b, c parameters in a list
</p>
<p><code>model_3pl_fitplot</code> returns a <code>ggplot</code> object
</p>


<h3>Examples</h3>

<pre><code class="language-R">with(model_3pl_gendata(10, 40), 
    cbind(true=t, est=model_3pl_eap(u, a, b, c)$t))
with(model_3pl_gendata(10, 40), 
     cbind(true=t, est=model_3pl_map(u, a, b, c)$t))

# generate data
x &lt;- model_3pl_gendata(2000, 40)
# free estimation, 40 iterations
y &lt;- model_3pl_jmle(x$u, true_params=x, iter=40, verbose=TRUE)
# fix c-parameters, 40 iterations
y &lt;- model_3pl_jmle(x$u, c=0, true_params=x, iter=40)


# generate data
x &lt;- model_3pl_gendata(2000, 40)
# free estimation, 40 iterations
y &lt;- model_3pl_mmle(x$u, true_params=x, iter=40, verbose=TRUE)

with(model_3pl_gendata(1000, 20), 
     model_3pl_fitplot(u, t, a, b, c, index=c(1, 3, 5)))
</code></pre>


</div>