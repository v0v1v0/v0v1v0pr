<div class="container">

<table style="width: 100%;"><tr>
<td>boot2pvalue</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the p.value from the distribution under H1</h2>

<h3>Description</h3>

<p>Compute the p.value associated with the estimated statistic
using a bootstrap sample of its distribution under H1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">boot2pvalue(
  x,
  null,
  estimate = NULL,
  alternative = "two.sided",
  FUN.ci = quantileCI,
  tol = .Machine$double.eps^0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>[numeric vector] a vector of bootstrap estimates of the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>[numeric] value of the statistic under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>[numeric] the estimated statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>[character] a character string specifying the alternative hypothesis, must be one of "two.sided" (default), "greater" or "less".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN.ci</code></td>
<td>
<p>[function] the function used to compute the confidence interval.
Must take <code>x</code>, <code>alternative</code>, <code>conf.level</code> and <code>sign.estimate</code> as arguments
and only return the relevant limit (either upper or lower) of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>[numeric] the absolute convergence tolerance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For test statistic close to 0, this function returns 1. <br><br></p>
<p>For positive test statistic, this function search the quantile alpha such that:
</p>

<ul>
<li> <p><code>quantile(x, probs = alpha)=0</code> when the argument alternative is set to <code>"greater"</code>.
</p>
</li>
<li> <p><code>quantile(x, probs = 0.5*alpha)=0</code> when the argument alternative is set to <code>"two.sided"</code>.
</p>
</li>
</ul>
<p>If the argument alternative is set to <code>"less"</code>, it returns 1. <br><br></p>
<p>For negative test statistic, this function search the quantile alpha such that:
</p>

<ul>
<li> <p><code>quantile(x, probs = 1-alpha=0</code> when the argument alternative is set to <code>"less"</code>.
</p>
</li>
<li> <p><code>quantile(x, probs = 1-0.5*alpha=0</code> when the argument alternative is set to <code>"two.sided"</code>.
</p>
</li>
</ul>
<p>If the argument alternative is set to <code>"greater"</code>, it returns 1.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(10)

#### no effect ####
x &lt;- rnorm(1e3) 
boot2pvalue(x, null = 0, estimate = mean(x), alternative = "two.sided")
## expected value of 1
boot2pvalue(x, null = 0, estimate = mean(x), alternative = "greater")
## expected value of 0.5
boot2pvalue(x, null = 0, estimate = mean(x), alternative = "less")
## expected value of 0.5

#### positive effect ####
x &lt;- rnorm(1e3, mean = 1) 
boot2pvalue(x, null = 0, estimate = 1, alternative = "two.sided")
## expected value of 0.32 = 2*pnorm(q = 0, mean = -1) = 2*mean(x&lt;=0)
boot2pvalue(x, null = 0, estimate = 1, alternative = "greater")  
## expected value of 0.16 = pnorm(q = 0, mean = 1) = mean(x&lt;=0)
boot2pvalue(x, null = 0, estimate = 1, alternative = "less")
## expected value of 0.84 = 1-pnorm(q = 0, mean = 1) = mean(x&gt;=0)

#### negative effect ####
x &lt;- rnorm(1e3, mean = -1) 
boot2pvalue(x, null = 0, estimate = -1, alternative = "two.sided") 
## expected value of 0.32 = 2*(1-pnorm(q = 0, mean = -1)) = 2*mean(x&gt;=0)
boot2pvalue(x, null = 0, estimate = -1, alternative = "greater")
## expected value of 0.84 = pnorm(q = 0, mean = -1) = mean(x&lt;=0)
boot2pvalue(x, null = 0, estimate = -1, alternative = "less") # pnorm(q = 0, mean = -1)
## expected value of 0.16 = 1-pnorm(q = 0, mean = -1) = mean(x&gt;=0)
</code></pre>


</div>