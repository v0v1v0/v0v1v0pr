<div class="container">

<table style="width: 100%;"><tr>
<td>averageData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Average biological replicates over different slides.
</h2>

<h3>Description</h3>


<p>The function assumes that each signal originates from an underlying true value which is scaled by a scaling factor depending on the slide and replicate. The method optimizes the scaling and truth parameters such that the distance between predicted and actual signals is minimized. There are aguments to specify what factors the scaling factors and truth parameters depend on.
</p>


<h3>Usage</h3>

<pre><code class="language-R">averageData(subsample, scaling = c("slide", "replicate"), 
	distinguish = c("cellline", "treatment"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>subsample</code></td>
<td>

<p>data.frame with columns "slide" (factor, the slide names), "ab" (factor, the antibody/target names), "time" (numeric, the time points), "signal" (numeric, signal values), "var0" (numeric, error parameter for the constant error), "varR" (numeric, error parameter for the relative error). The data.frame may contain further columns that can then be used in the <code>scaling</code> and <code>distinguish</code> arguments. The data.frame is a standard output of <code>getErrorModel</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>

<p>character. One scaling parameter ist estimated for each occurring combination of the corresponding factors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distinguish</code></td>
<td>

<p>character. One truth parameter ist estimaed for each occuring combination of the factors "time", "ab" (antibody/target) and the factors in <code>distinguish</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>Averaging is based on the assumption that for each level of <code>scaling</code> there is an underlying "true" antibody time-course for each level of <code>distinguish</code>. The signals of different scaling levels are assumed to differ by a scaling factor. Both, antibody time-course values and scaling parameters are estimated simulatenously by generalized least squares estimation:
</p>
<p style="text-align: center;"><code class="reqn">GRSS = \sum_{i,j}(s_i S_{ij}- y_j/s_i)^2/(\sigma_{ij,0}^2 + (y_j/s_i)^2 \sigma_{ij,R}^2)</code>
</p>

<p>where <code class="reqn">i, j</code> correspond to the levels of <code>c("time", "ab", distinguish)</code> and the levels of <code>scaling</code>.
</p>


<h3>Value</h3>






<table><tr style="vertical-align: top;">
<td><code>data.frame</code></td>
<td>

<p>with columns "time", "ab", "signal" (the truth parameters returned by <code>nls</code>), "sigma" (the standard error of the truth parameter returned by <code>nls</code>), "connection" (integer, signals can only be compared on the same scale if they agree in "ab", and "connection") and one column for each entry of <code>distinguish</code>.
</p>
</td>
</tr></table>
<h3>Author(s)</h3>


<p>Daniel Kaschek, Physikalisches Institut, Uni Freiburg. Email: <code>daniel.kaschek@physik.uni-freiburg.de</code>
</p>


</div>