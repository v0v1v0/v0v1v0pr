<div class="container">

<table style="width: 100%;"><tr>
<td>weightedPivotCoord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted pivot coordinates</h2>

<h3>Description</h3>

<p>Weighted pivot coordinates as a special case of isometric logratio coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weightedPivotCoord(
  x,
  pivotvar = 1,
  option = "var",
  method = "classical",
  pow = 1,
  yvar = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class 'data.frame' or 'matrix'; positive values only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pivotvar</code></td>
<td>
<p>pivotal variable; if any other number than 1, the data are resorted in that sense that 
pivotvar is shifted to the first part</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>
<p>option for the choice of weights. If 'option = "var"' (default), weights are based on variation matrix elements: 
'(1/t_1j)^pow', if 'option = "cor"', weights are based on correlations between variable specified in yvar and logratios and its distribution:
'|integral_0^r_j f(x) dx|', 'f(x)...' Kernel density estimator for 's_j; s_j=0 if |r_j|&lt;cut' otherwise 's_j=r_j',
'cut = min(#r_j=&gt;0/#r_j, #r_j&lt;0/#r_j', with Gaussian Kernel function and bandwidth 'h=0.05'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method for estimation of variation/correlation,
if 'option = "classical"' (default), classical estimation is applied,
if 'option = "robust"', robust estimation is applied;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>
<p>if 'option = "var"', power 'pow' is applied on unnormalized weights; default is 1;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>
<p>if 'option = "cor"', weights are based on correlation between logratios and variable specified in 'yvar';</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Weighted pivot coordinates map D-part compositional data from the simplex into a (D-1)-dimensional real space isometrically.
The relevant relative information about one of parts is contained in the first coordinate.
Unlike in the (ordinary) pivot coordinates, the pairwise logratios aggregated into the first coordinate are weighted according to their relevance for the purpose of the analysis.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>WPC</code></td>
<td>
<p>weighted pivot coordinates (matrix with n rows and (D-1) columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>logcontrasts (matrix with D rows and (D-1) columns)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nikola Stefelova
</p>


<h3>References</h3>

<p>Hron K, Filzmoser P, de Caritat P, Fiserova E, Gardlo A (2017) 
Weighted 'pivot coordinates for compositional data and their application to geochemical mapping.
Mathematical Geosciences 49(6):797-814.
</p>
<p>Stefelova N, Palarea-Albaladejo J, and Hron K (2021)
Weighted pivot coordinates for PLS-based marker discovery in high-throughput compositional data.
Statistical Analysis and Data Mining: The ASA Data Science Journal 14(4):315-330.
</p>


<h3>See Also</h3>

<p><code>pivotCoord</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">###################
data(phd)
x &lt;- phd[, 7:ncol(phd)]
x[x == 0] &lt;- 0.1 # better: impute with one 
                 # of the zero imputation methods 
                 # from robCompositions

# first variable as pivotal, weights based on variation matrix
wpc_var &lt;- weightedPivotCoord(x)
coordinates &lt;- wpc_var$WPC
logcontrasts &lt;- wpc_var$w

# third variable as pivotal, weights based on variation matrix, 
# robust estimation of variance, effect of weighting enhanced
wpc_var &lt;- weightedPivotCoord(x, pivotvar = 3, method = "robust", pow = 2)
coordinates = wpc_var$WPC
logcontrasts = wpc_var$w

# first variable as pivotal, weights based on correlation between pairwise logratios and y
wpc_cor &lt;- weightedPivotCoord(x, option = "cor", yvar = phd$female)
coordinates &lt;- wpc_cor$WPC
logcontrasts &lt;- wpc_cor$w

# fifth variable as pivotal, weights based on correlation between pairwise logratios 
# and y, robust estimation of correlation
wpc_cor &lt;- weightedPivotCoord(x, pivotvar = 5, option = "cor", method = "robust", yvar = phd$female)
coordinates &lt;- wpc_cor$WPC
logcontrasts &lt;- wpc_cor$w

</code></pre>


</div>