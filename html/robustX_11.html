<div class="container">

<table style="width: 100%;"><tr>
<td>Qrot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rotation Matrix to Specific Direction</h2>

<h3>Description</h3>

<p>Construct the <code class="reqn">p \times p</code> rotation matrix that rotates the
unit vector (1,0,....0), i.e., the <code class="reqn">x_1</code>-axis,
onto (1,1,1,...1)/<code class="reqn">\sqrt{p}</code>, or more generally to
<code class="reqn">u/{\left\|u\right\|}</code>  (<code class="reqn">u :=</code><code>unit.image</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Qrot(p, transpose = FALSE, unit.image = rep(1, p))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer; the dimension (of the vectors involved).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transpose</code></td>
<td>
<p>logical indicating if the <em>transposed</em> matrix is
to returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit.image</code></td>
<td>
<p>numeric vector of length <code class="reqn">p</code> onto which the unit
vector should be rotated; defaults to <em>“the diagonal”</em>
<code class="reqn">\propto</code><code class="reqn">(1,1,1,...,1)</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>qr</code> decomposition is used for a Gram-Schmitt basis
orthogonalization.
</p>


<h3>Value</h3>

<p><code class="reqn">p \times p</code> orthogonal matrix which rotates
<code class="reqn">(1,0,...,0)</code> onto a vector proportional to <code>unit.image</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code>qr</code>, matrix (and vector) multiplication,
<code>%*%</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Q &lt;- Qrot(6)
zapsmall(crossprod(Q)) # 6 x 6 unity &lt;==&gt; Q'Q = I  &lt;==&gt; Q orthogonal

if(require("MASS")) {
  Qt &lt;- Qrot(6, transpose = TRUE)
  stopifnot(all.equal(Qt, t(Q)))
  fractions(Qt ^2) # --&gt; 1/6  1/30  etc, in an almost lower-triagonal matrix
}
</code></pre>


</div>