<div class="container">

<table style="width: 100%;"><tr>
<td>xenv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the predictor envelope model</h2>

<h3>Description</h3>

<p>Fit the predictor envelope model in linear regression with dimension u. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">xenv(X, Y, u, asy = TRUE, init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Predictors. An n by p matrix, p is the number of predictors and n is number of observations.  The predictors must be continuous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Responses. An n by r matrix, r is the number of responses. The response can be univariate or multivariate and must be continuous variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Dimension of the envelope. An integer between 0 and p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy</code></td>
<td>
<p>Flag for computing the asymptotic variance of the envelope estimator.  The default is <code>TRUE</code>. When p and r are large, computing the asymptotic variance can take much time and memory.  If only the envelope estimators are needed, the flag can be set to <code>asy = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>The user-specified value of Gamma for the envelope subspace in the predictor space. An p by u matrix. The default is the one generated by function envMU.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits the envelope model in the predictor space, </p>
<p style="text-align: center;"><code class="reqn">
 Y = \mu + \eta'\Omega^{-1}\Gamma' X +\varepsilon, \Sigma_{X}=\Gamma\Omega\Gamma'+\Gamma_{0}\Omega_{0}\Gamma'_{0}
</code>
</p>

<p>using the maximum likelihood estimation.  When the dimension of the envelope is between 1 and p-1, the starting value and blockwise coordinate descent algorithm in Cook et al. (2016) is implemented.  When the dimension is p, then the envelope model degenerates to the standard multivariate linear regression.  When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different.
</p>


<h3>Value</h3>

<p>The output is a list that contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The envelope estimator of the regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaX</code></td>
<td>
<p>The envelope estimator of the covariance matrix of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>An orthonormal basis of the envelope subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma0</code></td>
<td>
<p>An orthonormal basis of the complement of the envelope subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>The estimated eta.  According to the envelope parameterization, beta = Gamma * Omega^-1 * eta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>The coordinates of SigmaX with respect to Gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega0</code></td>
<td>
<p>The coordinates of SigmaX with respect to Gamma0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The estimated intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaYcX</code></td>
<td>
<p>The estimated conditional covariance matrix of Y given X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The maximized log likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMatrix</code></td>
<td>
<p>The asymptotic covariance of vec(beta). The covariance matrix returned are asymptotic.  For the actual standard errors, multiply by 1 / n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asySE</code></td>
<td>
<p>The asymptotic standard error for elements in beta under the envelope model.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1 / sqrt(n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>The asymptotic standard error ratio of the standard multivariate linear regression estimator over the envelope estimator, for each element in beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations in the data.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cook, R. D., Helland, I. S. and Su, Z. (2013). Envelopes and Partial Least Squares Re-
gression. Journal of the Royal Statistical Society: Series B 75, 851 - 877.
</p>
<p>Cook, R. D., Forzani, L. and Su, Z. (2016) A Note on Fast Envelope Estimation. Journal of Multivariate Analysis. 150, 42-54.
</p>


<h3>See Also</h3>

<p><code>simpls.fit</code> for partial least squares (PLS).	
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fit the envelope in the predictor space	
data(wheatprotein)
X &lt;- wheatprotein[, 1:6]
Y &lt;- wheatprotein[, 7]
u &lt;- u.xenv(X, Y)
u

m &lt;- xenv(X, Y, 4)
m
m$beta

## Fit the partial least squares
## Not run: m1 &lt;- pls::simpls.fit(X, Y, 4)
## Not run: m1$coefficients
</code></pre>


</div>