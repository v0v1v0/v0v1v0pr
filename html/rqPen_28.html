<div class="container">

<table style="width: 100%;"><tr>
<td>rq.gq.pen.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Title Cross validation for consistent variable selection across multiple quantiles.</h2>

<h3>Description</h3>

<p>Title Cross validation for consistent variable selection across multiple quantiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rq.gq.pen.cv(
  x = NULL,
  y = NULL,
  tau = NULL,
  lambda = NULL,
  nfolds = 10,
  cvFunc = c("rq", "se"),
  tauWeights = NULL,
  foldid = NULL,
  printProgress = FALSE,
  weights = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariate matrix. Not needed if <code>model_obj</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>univariate response. Not needed if <code>model_obj</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a sequence of tau to be modeled, must be at least of length 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Values of <code class="reqn">\lambda</code>. Default will automatically select the <code class="reqn">\lambda</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>number of folds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvFunc</code></td>
<td>
<p>loss function to be evaluated for cross-validation. Supported loss functions include quantile ("rq") and squared loss("se"). Default is the quantile loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauWeights</code></td>
<td>
<p>weights for different quantiles in calculating the cv error. Default is equal weight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>indices of pre-split testing obervations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printProgress</code></td>
<td>
<p>If set to TRUE prints which partition is being worked on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weights for the quantile loss objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments for <code>rq.gq.pen.cv</code> sent to <code>rq.gq.pen</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">y_{b,i}</code> and <code class="reqn">x_{b,i}</code> index the observations in 
fold b. Let <code class="reqn">\hat{\beta}_{\tau,a,\lambda}^{-b}</code> be the estimator for a given quantile and tuning parameters that did not use the bth fold. Let <code class="reqn">n_b</code> be the number of observations in fold
b. Then the cross validation error for fold b is 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{CV}(b,\tau) = \sum_{q=1}^Q \frac{1}{n_b} \sum_{i=1}^{n_b} m_{b,i}v_q \rho_\tau(y_{b,i}-x_{b,i}^\top\hat{\beta}_{\tau_q,a,\lambda}^{-b}).</code>
</p>

<p>Where, <code class="reqn">m_{b,i}</code> is the weight for the ith observation in fold b and <code class="reqn">v_q</code> is a quantile specific weight. Note that <code class="reqn">\rho_\tau()</code> can be replaced squared error loss. Provides results about how the average of the cross-validation error changes with <code class="reqn">\lambda</code>. Uses a
Huber approximation in the fitting of model, as presented in Sherwood and Li (2022).
</p>


<h3>Value</h3>

<p>An rq.pen.seq.cv object. 
</p>

<dl>
<dt>cverr:</dt>
<dd>
<p> Matrix of cvSummary function, default is average, cross-validation error for each model, tau and a combination, and lambda.</p>
</dd>
<dt>cvse:</dt>
<dd>
<p> Matrix of the standard error of cverr foreach model, tau and a combination, and lambda.</p>
</dd>
<dt>fit:</dt>
<dd>
<p> The rq.pen.seq object fit to the full data.</p>
</dd>
<dt>btr:</dt>
<dd>
<p> Let blank, unlike rq.pen.seq.cv() or rq.group.pen.cv(), because optmizes the quantiles individually does not make sense with this penalty.</p>
</dd>
<dt>gtr:</dt>
<dd>
<p> A data.table for the combination of a and lambda that minimize the cross validation error across all tau.</p>
</dd>
<dt>gcve:</dt>
<dd>
<p> Group, across all quantiles, cross-validation error results for each value of a and lambda.</p>
</dd>
<dt>call:</dt>
<dd>
<p> Original call to the function.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Shaobo Li and Ben Sherwood, <a href="mailto:ben.sherwood@ku.edu">ben.sherwood@ku.edu</a>
</p>


<h3>References</h3>

<p>Wang M, Kang X, Liang J, Wang K, Wu Y (2024).
“Heteroscedasticity identification and variable selection via multiple quantile regression.”
<em>Journal of Statistical Computation and Simulation</em>, <b>94</b>(2), 297-314.
</p>
<p>Sherwood B, Li S (2022).
“Quantile regression feature selection and estimation with grouped variables using Huber approximation.”
<em>Statistics and Computing</em>, <b>32</b>(5), 75.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  
n&lt;- 200
p&lt;- 10
X&lt;- matrix(rnorm(n*p),n,p)
y&lt;- -2+X[,1]+0.5*X[,2]-X[,3]-0.5*X[,7]+X[,8]-0.2*X[,9]+rt(n,2)
taus &lt;- seq(0.1, 0.9, 0.2)
cvfit&lt;- rq.gq.pen.cv(x=X, y=y, tau=taus)
cvCoefs &lt;- coefficients(cvfit)

## End(Not run)
</code></pre>


</div>