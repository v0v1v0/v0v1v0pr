<div class="container">

<table style="width: 100%;"><tr>
<td>subjectWeights</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of censoring probabilities at subject specific times</h2>

<h3>Description</h3>

<p>This function is used internally to contruct pseudo values by inverse of the
probability of censoring weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">subjectWeights(
  formula,
  data,
  method = c("cox", "marginal", "km", "nonpar", "forest", "none"),
  args,
  lag = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A survival formula like, Surv(time,status)~1 or
Hist(time,status)~1 where status=0 means censored. The status
variable is internally reversed for estimation of censoring rather
than survival probabilities. Some of the available models, see
argument <code>model</code>, will use predictors on the right hand side
of the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data used for fitting the censoring model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Censoring model used for estimation of the
(conditional) censoring distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>Arguments passed to the fitter of the method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>If equal to <code>1</code> then obtain <code>G(T_i-|X_i)</code>, if
equal to <code>0</code> estimate the conditional censoring distribution
at the subject.times, i.e. (<code>G(T_i|X_i)</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Inverse of the probability of censoring weights usually refer to the
probabilities of not being censored at certain time points. These
probabilities are also the values of the conditional survival function of
the censoring time given covariates. The function subjectWeights estimates
the conditional survival function of the censoring times and derives the
weights.
</p>
<p>IMPORTANT: the data set should be ordered, <code>order(time,-status)</code> in
order to get the <code>weights</code> in the right order for some choices of
<code>method</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>The times at which weights are estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Estimated weights at individual time values
<code>subject.times</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>The time lag.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The fitted
censoring model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for modelling the censoring
distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thomas A. Gerds <a href="mailto:tag@biostat.ku.dk">tag@biostat.ku.dk</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(prodlim)
library(survival)
dat=SimSurv(300)

dat &lt;- dat[order(dat$time,-dat$status),]

# using the marginal Kaplan-Meier for the censoring times

WKM=subjectWeights(Hist(time,status)~X2,data=dat,method="marginal")
plot(WKM$fit)
WKM$fit
WKM$weights

# using the Cox model for the censoring times given X2

WCox=subjectWeights(Surv(time,status)~X2,data=dat,method="cox")
WCox
plot(WCox$weights,WKM$weights)

# using the stratified Kaplan-Meier for the censoring times given X2

WKM2 &lt;- subjectWeights(Surv(time,status)~X2,data=dat,method="nonpar")
plot(WKM2$fit,add=FALSE)


</code></pre>


</div>