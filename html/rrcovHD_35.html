<div class="container">

<table style="width: 100%;"><tr>
<td>OutlierMahdist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Outlier identification using robust (mahalanobis) distances based on robust multivariate location and covariance matrix 
</h2>

<h3>Description</h3>

<p>This function uses the Mahalanobis distance as a basis for 
multivariate outlier detection. The standard method for multivariate 
outlier detection is robust estimation of the parameters in the 
Mahalanobis distance and the comparison with a critical value 
of the Chi2 distribution (Rousseeuw and Van Zomeren, 1990). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">    OutlierMahdist(x, ...)
    ## Default S3 method:
OutlierMahdist(x, grouping, control, trace=FALSE, ...)
    ## S3 method for class 'formula'
OutlierMahdist(formula, data, ..., subset, na.action)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula with no response variable, referring only to
numeric variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector used to select rows (observations) of the
data matrix <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is set by
the <code>na.action</code> setting of <code>options</code>, and is
<code>na.fail</code> if that is unset. The default is <code>na.omit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>grouping variable:  a factor specifying the class for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> a control object (S4) for one of the available control classes,
e.g. <code>CovControlMcd-class</code>, <code>CovControlOgk-class</code>,
<code>CovControlSest-class</code>, etc.,
containing estimation options. The class of this object defines
which estimator will be used. Alternatively a character string can be specified
which names the estimator - one of auto, sde, mcd, ogk, m, mve, sfast, surreal,
bisquare, rocke. If 'auto' is specified or the argument is missing, the
function will select the estimator (see below for details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>whether to print intermediate results. Default is <code>trace = FALSE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the data set consists of two or more classes 
(specified by the grouping variable <code>grouping</code>) the proposed method iterates
through the classes present in the data, separates each class from the rest and
identifies the outliers relative to this class, thus treating both types of outliers,
the mislabeled and the abnormal samples in a homogenous way.
</p>
<p>The estimation method is selected by the control object <code>control</code>. 
If a character string naming an estimator is specified, a
new control object will be created and used (with default estimation options).
If this argument is missing or a character string
'auto' is specified, the function will select the robust estimator
according to the size of the dataset - for details see <code>CovRobust</code>.
</p>


<h3>Value</h3>

<p>An S4 object of class <code>OutlierMahdist</code> which 
is a subclass of the virtual class <code>Outlier</code>.
</p>


<h3>Author(s)</h3>

<p> Valentin Todorov <a href="mailto:valentin.todorov@chello.at">valentin.todorov@chello.at</a> 
</p>


<h3>References</h3>

<p>P. J. Rousseeuw and B. C. Van Zomeren (1990). 
Unmasking multivariate outliers and leverage points. 
<em>Journal of the American Statistical Association</em>. 
Vol. 85(411), pp. 633-651.
</p>
<p>P. J. Rousseeuw and A. M. Leroy (1987).
<em>Robust Regression and Outlier Detection.</em> Wiley.
</p>
<p>P. J. Rousseeuw and K. van Driessen (1999)
A fast algorithm for the minimum covariance determinant estimator.
<em>Technometrics</em> <b>41</b>, 212–223.
</p>
<p>Todorov V &amp; Filzmoser P (2009).
An Object Oriented Framework for Robust Multivariate Analysis.
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1–47,
<a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>.   
</p>
<p>Filzmoser P &amp; Todorov V (2013).
Robust tools for the imperfect world,
<em>Information Sciences</em> <b>245</b>, 4–20.
<a href="https://doi.org/10.1016/j.ins.2012.10.017">doi:10.1016/j.ins.2012.10.017</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(hemophilia)
obj &lt;- OutlierMahdist(gr~.,data=hemophilia)
obj

getDistance(obj)            # returns an array of distances
getClassLabels(obj, 1)      # returns an array of indices for a given class
getCutoff(obj)              # returns an array of cutoff values (for each class, usually equal)
getFlag(obj)                #  returns an 0/1 array of flags
plot(obj, class=2)          # standard plot function
</code></pre>


</div>