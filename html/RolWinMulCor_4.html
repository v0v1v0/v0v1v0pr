<div class="container">

<table style="width: 100%;"><tr>
<td>rolwincor_1win</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Rolling Window Correlation for the bi-variate case to plot its outputs as a single one window 
</h2>

<h3>Description</h3>

<p>The <code>rolwincor_1win</code> function estimates (correlation coefficients and their respective p-values) the rolling (running) window correlation between TWO time series (bi-variate case) sampled on identical time points for ONLY ONE window-length (time-scale). To carry out the computational implementation we follow to Telford (2013), Polanco-Martínez (2019), and Polanco-Martínez (2020). The <code>rolwincor_1win</code> function is highly flexible since this contain several parameters to control the estimation of correlation. For example, <code>rolwincor_1win</code> function contain parameters to remove the (linear) trend contained in the time series under analysis or to choose different p-value correction methods (which are used to address the multiple comparison problem). A list of parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">rolwincor_1win(inputdata, varX="", varY="", CorMethod="pearson", widthwin=3,
               Align="center", pvalcorectmethod="BH", rmltrd=TRUE, Scale=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputdata</code></td>
<td>

<p>Matrix of 3 columns: time, first variable (e.g. <code class="reqn">X</code>), and second variable (e.g. <code class="reqn">Y</code>). Please note that time's resolution can be annual, seasonal, monthly, etc, but the format must be in the following form: e.g. for monthly data, year 1 must be repeated 12 times (thus, these times will correspond to 12 rows), year 2 must be also repeated 12 times, and so on. 'Times' must be regular (equally spaced in time and not missing data). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varX, varY</code></td>
<td>

<p>Names of the first (e.g. <code class="reqn">X</code>) and second (e.g. <code class="reqn">Y</code>) variable. Please note that the names of these variables MUST be defined.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorMethod</code></td>
<td>

<p>The method used to estimate the correlations, by default is “pearson,” but other options (“spearman” and “kendall”) are available (please look at: <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>&gt;?cor.test).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widthwin</code></td>
<td>

<p>Window size to compute the rolling window correlations. This value can be an even or odd number of at least three (the default value), and this parameter MUST be provided. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Align</code></td>
<td>

<p>To align the rolling object, RolWinMulCor ONLY uses the “center” option by default (please look at: <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>&gt;?running) to ensure that variations in the correlation are aligned with the variations in the relationship of the time series under study rather than being shifted (Polanco-Martínez 2019, 2020), but the “left” and “right” options can be used, but if <code>widthwin</code> is an even number it will not be possible to use the “center” option (please look at: <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>&gt;?running).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalcorectmethod</code></td>
<td>

<p>The p-value correction method to be used, by default the method of Benjamini and Hochberg (BH) (1995) is used since this is less conservative and performs much better than Bonferroni, but other five methods (Holm, Hochberg, Bonferroni, Hommel, and Benjamini and Yekutieli) are available (please look at: <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>&gt;?p.adjust). Moreover, <code>pvalcorectmethod</code> admits a pass-through option <br> 
named “none” (p-values will not be corrected).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmltrd</code></td>
<td>

<p>Remove (by default is “TRUE”; “FALSE” otherwise) the linear trend in the two time series under analysis. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scale</code></td>
<td>

<p>Scale (by default is “TRUE”; “FALSE” otherwise) is used to “normalize” or “standardize” the time series under analysis.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>rolwincor_1win</code> function estimates the rolling window correlation between TWO time series (bi-variate case) sampled on identical time points for ONLY ONE window-length (time-scale) and plots the rolling correlation coefficients and their respective p-values. <code>rolwincor_1win</code> uses the functions <em>running</em> (package:gtools), the native <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> functions <em>cor</em>, <em>cor.test</em>, and <em>p.adjust</em> (package:stats), and some pieces of code written specifically to our <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> RolWinMulCor package. 
</p>


<h3>Value</h3>

<p>Outputs:
</p>
<p>Numerical output: a list containing <em>Correlation_coefficients</em>, <em>P_values_corrected</em>, and <br><em>P_values_not_corrected</em>, which are self-explanatory, as well as <em>CorMethod</em>, <em>left_win</em>, <em>righ_win</em>, and <em>widthwin</em>, which indicate the method used to estimate the correlations, first and last time element of the rolling correlation matrix, and the window-length (time-scale).
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br>
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br>
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br>
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>, <a href="mailto:josue.polanco@bc3research.org">josue.polanco@bc3research.org</a>.
</p>


<h3>References</h3>

<p>Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57 (1), 289-300. &lt;URL: doi: <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">10.1111/j.2517-6161.1995.tb02031.x</a>&gt;. <br></p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br></p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor : an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br></p>
<p>Telford, R.: Running correlations – running into problems (2013). &lt;URL: <br><a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. <br></p>


<h3>Examples</h3>

<pre><code class="language-R"># Testing the function rolwincor_1win (bi-variate case)
# Window length = 21 and plot output in screen format 
# Estimation to generate the output for Fig. 3 in Polanco-Martínez (2020). 
test_rolwincor_1win &lt;- rolwincor_1win(syntDATA, varX="X", varY="Y", CorMethod="spearman", 
                                      widthwin=21, Align="center", pvalcorectmethod="BH")
</code></pre>


</div>