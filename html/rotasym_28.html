<div class="container">

<table style="width: 100%;"><tr>
<td>sunspots_births</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Recorded sunspots births during 1872–2018</h2>

<h3>Description</h3>

<p>Processed version of the
<a href="http://fenyi.solarobs.csfk.mta.hu/DPD/">
Debrecen Photoheliographic Data (DPD)</a> sunspot catalogue and the
revised version of the
<a href="http://fenyi.solarobs.csfk.mta.hu/GPR/">
Greenwich Photoheliographic Results (GPR)</a> sunspot catalogue. The two
sources contain the records of sunspots appeared during 1872–2018 (GPR for
1872–1976; DPD for 1974–2018).
</p>
<p>Sunspots appear in groups and have a variable lifetime. This dataset has
been processed to account only for the <em>births</em> or emergences
(first observations) of <em>groups</em> of sunspots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sunspots_births
</code></pre>


<h3>Format</h3>

<p>A data frame with 51303 rows and 6 variables:
</p>

<dl>
<dt>date</dt>
<dd>
<p>UTC date, as <code>POSIXct</code>, of
the first observation of a group of sunspots.</p>
</dd>
<dt>cycle</dt>
<dd>
<p><a href="https://en.wikipedia.org/wiki/List_of_solar_cycles">
solar cycle</a> in which the group of sunspots was observed.</p>
</dd>
<dt>total_area</dt>
<dd>
<p>total whole spot area of the group, measured in
millionths of the solar hemisphere.</p>
</dd>
<dt>dist_sun_disc</dt>
<dd>
<p>distance from the center of Sun's disc, measured in
units of the solar radius.</p>
</dd>
<dt>theta</dt>
<dd>
<p>mean longitude angle <code class="reqn">\theta \in [0, 2\pi)</code> of the
group position.</p>
</dd>
<dt>phi</dt>
<dd>
<p>mean latitude angle <code class="reqn">\phi \in [-\pi/2, \pi/2)</code> of the
group position.</p>
</dd>
</dl>
<h3>Details</h3>

<p>The mean position of the group of sunspots is obtained by a weighted average
of the positions of the single sunspots by the whole spot area of the
single spots. The areas are corrected to account for foreshortening.
</p>
<p>The <code class="reqn">(\theta, \phi)</code> angles are such their associated Cartesian
coordinates are:
</p>
<p style="text-align: center;"><code class="reqn">(\cos(\phi) \cos(\theta), \cos(\phi) \sin(\theta), \sin(\phi)),</code>
</p>

<p>with <code class="reqn">(0, 0, 1)</code> denoting the north pole.
</p>
<p>The DPD data has
<a href="http://fenyi.solarobs.csfk.mta.hu/ftp/pub/DPD/README.txt">
different states</a> of completeness and quality control. The
longest span of "final complete data" (no missing observation days and
the data has undergone a systematic quality control) is from 2005 to 2015.
</p>
<p>The data has been preprocessed using the following pipeline:
</p>

<ol>
<li>
<p> Retrieve data from the GPR and DPD sunspot catalogues.
</p>
</li>
<li>
<p> Omit observations with <code>NA</code>s in the sunspot positions.
</p>
</li>
<li>
<p> Filter for sunspot groups.
</p>
</li>
<li>
<p> Relabel the NOAA identifier for the sunspot group for records
before 1974, prefixing the "GPR" string. Otherwise, very different groups
of sunspots from the two catalogues may share the same identifier.
</p>
</li>
<li>
<p> Keep only the first row of each NOAA instance, the first-ever
observation of each sunspot group.
</p>
</li>
</ol>
<p>The script performing the preprocessing is available at
<a href="https://github.com/egarpor/rotasym/blob/master/data-raw/sunspots-births.R">
<code>sunspots-births.R</code></a>
</p>


<h3>Author(s)</h3>

<p>Data processed by Eduardo García-Portugués, Davy Paindaveine, and
Thomas Verdebout from the original sources.
</p>


<h3>Source</h3>

<p><a href="http://fenyi.solarobs.csfk.mta.hu">http://fenyi.solarobs.csfk.mta.hu</a>
</p>


<h3>References</h3>

<p>Baranyi, T., Győri, L., Ludmány, A. (2016) On-line tools for solar data
compiled at the Debrecen observatory and their extensions with the
Greenwich sunspot data. <em>Solar Physics</em>, 291(9–10):3081–3102.
<a href="https://doi.org/10.1007/s11207-016-0930-1">doi:10.1007/s11207-016-0930-1</a>
</p>
<p>Győri, L., Ludmány, A., Baranyi, T. (2019) Comparative analysis of Debrecen
sunspot catalogues. <em>Monthly Notices of the Royal Astronomical
Society</em>, 465(2):1259–1273. <a href="https://doi.org/10.1093/mnras/stw2667">doi:10.1093/mnras/stw2667</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data
data("sunspots_births")

# Transform to Cartesian coordinates
sunspots_births$X &lt;-
  cbind(cos(sunspots_births$phi) * cos(sunspots_births$theta),
        cos(sunspots_births$phi) * sin(sunspots_births$theta),
        sin(sunspots_births$phi))

# Plot data associated to the 23rd cycle
sunspots_23 &lt;- subset(sunspots_births, cycle == 23)
n &lt;- nrow(sunspots_23$X)
if (requireNamespace("rgl")) {
  rgl::plot3d(0, 0, 0, xlim = c(-1, 1), ylim = c(-1, 1), zlim = c(-1, 1),
              radius = 1, type = "s", col = "lightblue", alpha = 0.25,
              lit = FALSE)
}
n_cols &lt;- 100
cuts &lt;- cut(x = sunspots_23$date, include.lowest = TRUE,
            breaks = quantile(sunspots_23$date,
                             probs = seq(0, 1, l = n_cols + 1)))
if (requireNamespace("rgl")) {
  rgl::points3d(sunspots_23$X, col = viridisLite::viridis(n_cols)[cuts])
}
# Spörer's law: sunspots at the beginning of the solar cycle (dark blue
# color) tend to appear at higher latitutes, gradually decreasing to the
# equator as the solar cycle advances (yellow color)

# Estimation of the density of the cosines
V &lt;- cosines(X = sunspots_23$X, theta = c(0, 0, 1))
h &lt;- bw.SJ(x = V, method = "dpi")
plot(kde &lt;- density(x = V, bw = h, n = 2^13, from = -1, to = 1), col = 1,
     xlim = c(-1, 1), ylim = c(0, 3), axes = FALSE, main = "",
     xlab = "Cosines (latitude angles)", lwd = 2)
at &lt;- seq(-1, 1, by = 0.25)
axis(2); axis(1, at = at)
axis(1, at = at, line = 1, tick = FALSE,
     labels = paste0("(", 90 - round(acos(at) / pi * 180, 1), "º)"))
rug(V)
legend("topright", legend = c("Full cycle", "Initial 25% cycle",
                              "Final 25% cycle"),
       lwd = 2, col = c(1, viridisLite::viridis(12)[c(3, 8)]))

# Density for the observations within the initial 25% of the cycle
part1 &lt;- sunspots_23$date &lt; quantile(sunspots_23$date, 0.25)
V1 &lt;- cosines(X = sunspots_23$X[part1, ], theta = c(0, 0, 1))
h1 &lt;- bw.SJ(x = V1, method = "dpi")
lines(kde1 &lt;- density(x = V1, bw = h1, n = 2^13, from = -1, to = 1),
      col = viridisLite::viridis(12)[3], lwd = 2)

# Density for the observations within the final 25% of the cycle
part2 &lt;- sunspots_23$date &gt; quantile(sunspots_23$date, 0.75)
V2 &lt;- cosines(X = sunspots_23$X[part2, ], theta = c(0, 0, 1))
h2 &lt;- bw.SJ(x = V2, method = "dpi")
lines(kde2 &lt;- density(x = V2, bw = h2, n = 2^13, from = -1, to = 1),
      col = viridisLite::viridis(12)[8], lwd = 2)

# Computation the level set of a kernel density estimator that contains
# at least 1 - alpha of the probability (kde stands for an object
# containing the output of density(x = data))
kde_level_set &lt;- function(kde, data, alpha) {

  # Estimate c from alpha
  c &lt;- quantile(approx(x = kde$x, y = kde$y, xout = data)$y, probs = alpha)

  # Begin and end index for the potentially many intervals in the level sets
  kde_larger_c &lt;- kde$y &gt;= c
  run_length_kde &lt;- rle(kde_larger_c)
  begin &lt;- which(diff(kde_larger_c) &gt; 0) + 1
  end &lt;- begin + run_length_kde$lengths[run_length_kde$values] - 1

  # Return the [a_i, b_i], i = 1, ..., K in the K rows
  return(cbind(kde$x[begin], kde$x[end]))

}

# Level set containing the 90% of the probability, in latitude angles
90 - acos(kde_level_set(kde = kde, data = V, alpha = 0.10)) / pi * 180

# Modes (in cosines and latitude angles)
modes &lt;- c(kde$x[kde$x &lt; 0][which.max(kde$y[kde$x &lt; 0])],
           kde$x[kde$x &gt; 0][which.max(kde$y[kde$x &gt; 0])])
90 - acos(modes) / pi * 180
</code></pre>


</div>