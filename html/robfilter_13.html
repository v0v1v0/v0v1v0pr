<div class="container">

<table style="width: 100%;"><tr>
<td>lts.filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Least Trimmed Squares (LTS) filter
</h2>

<h3>Description</h3>

<p>This function extracts signals from time series by means of Least Trimmed Squares regression in a moving time window.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lts.filter(y, width, h = floor(width/2) + 1, online = FALSE, extrapolate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector or (univariate) time series object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a positive integer defining the window width used for fitting.<br>
If <code>online=FALSE</code> (see below) this needs to be an odd integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a positive integer defining the trimming quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>online</code></td>
<td>
<p>a logical indicating whether the current level estimate is 
evaluated at the most recent time within each time window 
(<code>TRUE</code>) or centred within each window (<code>FALSE</code>). 
Setting <code>online=FALSE</code> requires the <code>width</code> to be odd. 
Default is <code>online=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrapolate</code></td>
<td>
<p>a logical indicating whether the level 
estimations should be extrapolated to the edges of the time series. <br>
If <code>online=FALSE</code> the extrapolation consists of the 
fitted values within the first half of the first window and the 
last half of the last window; if <code>online=TRUE</code> the 
extrapolation consists of the fitted values within the first 
time window.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lts.filter</code> is suitable for extracting low 
frequency components (the <em>signal</em>) from a time series which 
may be contaminated with outliers and can contain level shifts. 
For this, robust Least Trimmed Squares regression is applied to a moving 
window, and the signal level is estimated by the fitted value 
either at the end of each time window for online signal 
extraction without time delay (<code>online=TRUE</code>) or in the 
centre of each time window (<code>online=FALSE</code>).
</p>


<h3>Value</h3>

<p><code>lts.filter</code> returns an object of class <code>robreg.filter</code>. 
An object of class <code>robreg.filter</code> is a list containing the 
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a data frame containing the extracted signal level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>a data frame containing the corresponding slope within each time window.</p>
</td>
</tr>
</table>
<p>In addition, the original input time series is returned as list 
member <code>y</code>, and the settings used for the analysis are 
returned as the list members <code>width</code>, <code>online</code> and <code>extrapolate</code>.
</p>
<p>Application of the function <code>plot</code> to an object of class
<code>robreg.filter</code> returns a plot showing the original time series 
with the filtered output.
</p>


<h3>Author(s)</h3>

<p>Roland Fried, Karen Schettlinger and Matthias Borowski
</p>


<h3>References</h3>

<p>Davies, P.L., Fried, R., Gather, U. (2004) 
Robust Signal Extraction for On-Line Monitoring Data, 
<em>Journal of Statistical Planning and Inference</em> <b>122</b>, 
65-78.<br></p>
<p>Gather, U., Schettlinger, K., Fried, R. (2006)
Online Signal Extraction by Robust Linear Regression,
<em>Computational Statistics</em> <b>21</b>(1), 
33-51. <br></p>
<p>Schettlinger, K., Fried, R., Gather, U. (2006) 
Robust Filters for Intensive Care Monitoring: Beyond the Running Median,
<em>Biomedizinische Technik</em> <b>51</b>(2), 
49-56.
</p>


<h3>See Also</h3>

<p><code>robreg.filter</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate random time series:
y &lt;- cumsum(runif(500)) - .5*(1:500)
# Add jumps:
y[200:500] &lt;- y[200:500] + 5
y[400:500] &lt;- y[400:500] - 7
# Add noise:
n &lt;- sample(1:500, 30)
y[n] &lt;- y[n] + rnorm(30)

# Online filtering with LTS filter:
y.rr &lt;- lts.filter(y,width=41,online=FALSE)
plot(y.rr)
</code></pre>


</div>