<div class="container">

<table style="width: 100%;"><tr>
<td>recluster.multi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multiscale bootstrap based on a consensus tree
</h2>

<h3>Description</h3>

<p>Given an initial tree and a data matrix, this function computes bootstrap for nodes as done by recluster.boot. Different levels of bootstrap can be computed by varying the proportions of species sampled from the original matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">recluster.multi(tree, mat, phylo = NULL, tr = 100, p = 0.5, 
dist = "simpson", method = "average", boot = 1000, levels = 2, step = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>A reference phylo tree for sites presumably constructed with recluster.cons function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>

<p>The matrix used to construct the tree.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>An ultrametric and rooted phylo tree for species having the same labels as in mat columns. Only required for phylogenetic beta-diversity indexes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>

<p>The number of trees to be included in the consensus.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>A numeric value between 0.5 and 1 giving the proportion for a clade to be represented in the consensus tree.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>

<p>One among the twelve beta-diversity indexes <code>"simpson" "sorensen" "nestedness" "beta3" "richness" "jaccard" "phylosor" "phylosort" "phylosorpd" "unifrac" "unifract" "unifractpd"</code>. Any custom binary dissimilarity can also be specified according to the syntax of designdist function of the vegan package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Any clustering method allowed by hclust.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>

<p>The number of trees used for bootstrap computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>

<p>The number of levels to be used in multiscale bootstrap.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>

<p>The increase in ratio between the first level (x1) and the next ones.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computation can be time consuming. It is suggested to assess the degree of row bias by recluster.hist and recluster.node.strength to optimize the number of consensus trees before starting the analysis.
</p>


<h3>Value</h3>

<p>A matrix indicating the percentage of bootstrap trees replicating each node for each level.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
"recluster: an unbiased clustering procedure for beta-diversity turnover"
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(datamod)
tree&lt;-recluster.cons(datamod,tr=10)
multiboot&lt;-recluster.multi(tree$cons,tr=10,boot=50,datamod,levels=2,step=1)
recluster.plot(tree$cons,multiboot,1,2,direction="downwards")
</code></pre>


</div>