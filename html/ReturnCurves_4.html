<div class="container">

<table style="width: 100%;"><tr>
<td>adf_gof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness of fit of the Angular Dependence function estimates</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>Assessment of the goodness of fit of the angular dependence function estimates \(\lambda(\omega)\) following the procedure of Murphy-Barltrop et al. (2024).
</p>


<h3>Usage</h3>

<pre><code class="language-R">adf_gof(adf, ray, blocksize = 1, nboot = 250, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>adf</code></td>
<td>
<p>An S4 object of class <code>adf_est.class</code>. See <code>adf_est</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ray</code></td>
<td>
<p>Ray \(\omega\) to be considered on the goodness of fit assessment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocksize</code></td>
<td>
<p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level to compute the \((1-\alpha)\)% tolerance intervals. Default is <code>0.05</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Define the min-projection variable as \(t^1_\omega = t_\omega - u_\omega | t_\omega &gt; u_\omega\), then
variable \(\lambda(\omega)T^1_\omega \sim Exp(1)\) as \(u_\omega \to \infty\) for all \(\omega \in [0,1]\). 
</p>
<p>Let \(F^{-1}_E\) denote the inverse of the cumulative distribution function of a standard exponential variable and \(T^1_{(i)}\) denote the \(i\)-th ordered increasing statistic, \(i = 1, \ldots, n\). 
Function <code>plot</code> shows a QQ plot between the model and empirical exponential quantiles, i.e. points \(\left(F^{-1}_E\left(\frac{i}{n+1}\right), T^1_{(i)}\right)\),
along with the line \(y=x\). Uncertainty is obtained via a (block) bootstrap procedure and shown by the grey region on the plot.
A good fit is shown by agreement of model and empirical quantiles, i.e. points should lie close to the line \(y=x\). 
In addition, line \(y = x\) should mainly lie within the \((1-\alpha)\)% tolerance intervals.
</p>
<p>We note that, if the grid for \(\omega\) used to estimate the Angular Dependence Function (ADF) does not contain <code>ray</code>, then the closest \(\omega\) in the grid is used to assess the goodness-of-fit of the ADF.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>adf_gof.class</code>. This object returns the arguments of the function and an extra slot <code>gof</code> which is a list containing: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A vector containing the model quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>A vector containing the empirical quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A vector containing the lower bound of the tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A vector containing the upper bound of the tolerance interval.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is recommended to assess the goodness-of-fit of \(\lambda(\omega)\) for a few values of \(\omega\).
</p>


<h3>References</h3>

<p>Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2024).
“Improving estimation for asymptotically independent bivariate extremes via global estimators for the angular dependence function.”
2303.13237.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

margdata &lt;- margtransf(airdata)

lambda &lt;- adf_est(margdata = margdata, method = "hill")

# blocksize to account for temporal dependence
gof &lt;- adf_gof(adf = lambda, ray = 0.4, blocksize = 10)

plot(gof)

# To see the the S4 object's slots
str(gof)

# To access the list of vectors
gof@gof

</code></pre>


</div>