<div class="container">

<table style="width: 100%;"><tr>
<td>rococo.test-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Gamma Rank Correlation Test</h2>

<h3>Description</h3>

<p>Methods performing a robust gamma rank correlation test
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'numeric,numeric'
rococo.test(x, y,
            similarity=c("linear", "exp", "gauss",
                         "epstol", "classical"),
            tnorm="min", r=0, numtests=1000, storeValues=FALSE,
            exact=FALSE, alternative=c("two.sided", "less", "greater"),
            noVarReturnZero=TRUE)
## S4 method for signature 'formula,data.frame'
rococo.test(x, y, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector or a formula; compulsory argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>compulsory argument; if <code>x</code> is a vector, <code>y</code>
must be vector of the same length as <code>x</code>. If <code>x</code> is
a formula, <code>y</code> must be a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>similarity</code></td>
<td>
<p>a character string or a character vector identifying
which type of similarity measure to use; see <code>rococo</code>
for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tnorm</code></td>
<td>
<p>t-norm used for aggregating results; see <code>rococo</code>
for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>numeric vector defining the tolerances to be used;
see <code>rococo</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numtests</code></td>
<td>
<p>number of random shuffles to perform; see details
below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>storeValues</code></td>
<td>
<p>logical indicating whether the vector of test
statistics should be stored in the output object (in slot
<code>perm.gamma</code>, see <code>RococoTestResults</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>logical indicating whether exact p-value should be
computed; see details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be one of
<code>"two.sided"</code>, <code>"greater"</code>, or
<code>"less"</code>. Abbreviations are allowed as long as they are
unique. <code>"greater"</code> corresponds to positive
association, <code>"less"</code> to negative association.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noVarReturnZero</code></td>
<td>
<p>if <code>TRUE</code> (default), a correlation of 0
and a p-value of 1 are returned if there is no variation in at least
one of the two observables. Otherwise, a correlation of <code>NA</code>
and a p-value of 1 are returned and a warning is issued.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NA</code>'s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>all parameters specified are forwarded internally to the
method <code>rococo.test</code> with signature <code>numeric,numeric</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If called for numeric vectors, <code>rococo.test</code> computes the
robust gamma rank correlation coefficient of <code>x</code> and <code>y</code>
according to the specified parameters (see <code>rococo</code>) and
then performs a permutation test to compute a p-value.
If <code>exact=TRUE</code>, <code>rococo.test</code> attempts to compute an exact
p-value and ignores the <code>numtests</code> argument. This is done by
considering all possible permutations and computing the ratio of
permutations for which the test statistic is at least as large/small
as the test statistic for unshuffled data. This works only for 10 or
less samples. Otherwise <code>exact=TRUE</code> is ignored, a warning is
issued and random shuffles are considered to estimate the p-value (as
follows next).
If <code>exact=FALSE</code>, <code>numtests</code> random shuffles of <code>y</code> are
performed and the empirical standard deviation of the robust gamma
correlation values for these shuffled data sets is computed.
Under the assumption that these values are normally distributed around
mean zero, the p-value is then computed from this distribution in the
usual way.
Note that a too small choice of the number of shuffles (parameter
<code>numtests</code>) leads to unreliable p-values.
</p>
<p>If <code>rococo.test</code> is called for a formula <code>x</code> and a data
frame <code>y</code>, then the method checks whether the formula <code>x</code> correctly
extracts two columns from <code>y</code> (see examples below). If so, the
two columns are extracted and the robust gamma rank correlation test
is applied to them according to the specified parameters.
</p>
<p>Note that <code>exact=TRUE</code> may result in long computation times for
user-defined t-norms.
</p>


<h3>Value</h3>

<p>Upon successful completion, the function returns an object of class
<code>RococoTestResults</code> containing the results.
</p>


<h3>Author(s)</h3>

<p>Martin Krone and Ulrich Bodenhofer</p>


<h3>References</h3>

<p><a href="https://github.com/UBod/rococo">https://github.com/UBod/rococo</a>
</p>
<p>U. Bodenhofer, M. Krone, and F. Klawonn (2013).
Testing noisy numerical data for monotonic association.
<em>Inform. Sci.</em> <b>245</b>:21-37.
DOI: <a href="https://doi.org/10.1016/j.ins.2012.11.026">doi:10.1016/j.ins.2012.11.026</a>.
</p>
<p>U. Bodenhofer and F. Klawonn (2008).
Robust rank correlation coefficients on the basis of fuzzy orderings:
initial steps. <em>Mathware Soft Comput.</em> <b>15</b>(1):5-20.</p>


<h3>See Also</h3>

<p><code>rococo</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## create data
f &lt;- function(x) ifelse(x &gt; 0.9, x - 0.9, ifelse(x &lt; -0.9, x + 0.9, 0))
x &lt;- rnorm(25)
y &lt;- f(x) + rnorm(25, sd=0.1)

## perform correlation tests
rococo.test(x, y, similarity="classical", alternative="greater")
rococo.test(x, y, similarity="linear", alternative="greater")
rococo.test(x, y, similarity=c("classical", "gauss"), r=c(0, 0.1),
            alternative="greater", numtests=10000)

## the formula variant
require(datasets)
data(iris)
rococo.test(~ Petal.Width + Petal.Length, iris, similarity="linear",
            alternative="two.sided")
</code></pre>


</div>