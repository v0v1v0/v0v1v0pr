<div class="container">

<table style="width: 100%;"><tr>
<td>sienaTimeTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions to assess and account for time heterogeneity of parameters</h2>

<h3>Description</h3>

<p>Takes a <code>sienaFit</code> object estimated by Method of Moments,  
and tests for time heterogeneity by the addition of interactions with  
time dummy variables at waves <code>m=2...(M-1)</code>.  
The test used is the score-type test of Schweinberger (2012).
</p>
<p>Tests for joint significance, parameter-wise significance,  
period-wise significance, individual significance, and one-step   
estimates of the unrestricted model parameters are returned in a list.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sienaTimeTest(sienaFit, effects=NULL, excludedEffects=NULL, condition=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sienaFit</code></td>
<td>
<p> A <code>sienaFit</code> object returned by <code>siena07</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>Optional vector of effect numbers to test. Use the
numbering on the print of the sienaFit object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excludedEffects</code></td>
<td>
<p>Optional vector of effect numbers
for which time heterogeneity is not to be tested. Use the
numbering on the print of the sienaFit object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condition</code></td>
<td>
<p> Whether to orthogonalize effect-wise score-type tests
and individual significance tests against estimated effects
and un-estimated dummy terms, or just against estimated effects.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This test follows the score type test of Schweinberger (2012) as
elaborated by Lospinoso et al. (2011) by using statistics already
calculated at each wave to obtain vectors of partitioned moment
functions corresponding to a restricted model (the model in the
<code>sienaFit</code> object; used as null hypothesis) and an
unrestricted model (which contains dummies for waves
<code>m=2...(M-1)</code>; used as alternative hypothesis).
</p>
<p><code>condition=TRUE</code> leads to a rough-and-easy approximation to
controlling the mentioned tests also for the unestimated effects.
</p>
<p>After assessing time heterogeneity, effects objects can be modified by
adding numbers of all or some periods to the <code>timeDummy</code> column.
This is facilitated by the <code>includeTimeDummy</code> function.
For an effects object in which the <code>timeDummy</code> column
of some of the included effects includes some or all period numbers,
interactions of those effects  with time dummies for the indicated
periods will also be estimated.
</p>
<p>An alternative to the use of <code>includeTimeDummy</code>
is to define time-dependent actor covariates (dummy variables or other
functions of wave number that are the same for all actors),
include these in the data set through <code>sienaAlgorithmCreate</code>,
and include interactions of other effects with ego effects of these
time-dependent actor covariates by <code>includeInteraction</code>.
This is illustrated in an example below.
Using <code>includeTimeDummy</code> is easier;
using self-defined interactions with time-dependent variables
gives more control.
</p>
<p>If you wish to use this function with <code>sienaFit</code> objects that use the
finite differences method of derivative estimation, or which use maximum
likelihood estimation, you must request the derivatives to be returned
by wave using the <code>byWave=TRUE</code> option for <code>siena07</code>.
</p>
<p>Effects leading to dummy interactions that are collinear with the
model originally fitted, after excluding the effects mentioned,
will be automatically excluded from the time heterogeneity testing.
</p>
<p>If <code>sienaTimeTest</code> gives errors that there are too
many collinear effects, run it with a smaller set of effects as specified
by the <code>effects</code> parameter.
For example, if the model has 40 effects of which the
first 8 are rate parameters and therefore uninteresting,
and there is such an error message, try <code>effects=9:30</code>;
if that still does not work, decrease the upper limit of 30, if it does work
increase it, to find the largest possible set of effects for which
heterogeneity assessment still is possible; then as a next step
try the remaining effects in a similar way.
</p>
<p>Also if the execution is time-consuming, e.g., for a multi-group
<code>sienaFit</code> object with many groups and many effects,
it can be helpful to carry out the function in smaller subsets of effects.
</p>


<h3>Value</h3>

<p><code>sienaTimeTest</code> returns a list containing many items,
including the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>JointTest </code></td>
<td>
<p>A chi-squared test for joint significance of the dummies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EffectTest </code></td>
<td>
<p>A chi-squared test for joint significance
across dummies for each separate effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GroupTest </code></td>
<td>
<p>A chi-squared test for joint significance
across dummies; if <code>sienaFit</code> is a fit for a multi-group object
then these refer to each group; else they refer to ecah period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IndividualTest </code></td>
<td>
<p>A matrix displaying initial estimates, one-step
estimates, and <code class="reqn">p</code>-values for the individual interactions.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Josh Lospinoso, Tom Snijders</p>


<h3>References</h3>

<p>J.A. Lospinoso, M. Schweinberger, T.A.B. Snijders, and R.M. Ripley
(2011), Assessing and Accounting for Time Heterogeneity in Stochastic
Actor Oriented Models. <em>Advances in Data Analysis and Computation</em>,
<b>5</b>, 147–176.
</p>
<p>M. Schweinberger (2012), Statistical modeling of network panel data:
Goodness-of-fit. <em>British Journal of Statistical
and Mathematical Psychology</em> <b>65</b>, 263–281.
</p>


<h3>See Also</h3>

<p><code>siena07</code>, <code>plot.sienaTimeTest</code>,
<code>includeTimeDummy</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Estimate a restricted model
myalgorithm &lt;- sienaAlgorithmCreate(nsub=1, n3=50, projname=NULL)
# Short estimation not for practice, just for having a quick demonstration
mynet1 &lt;- sienaDependent(array(c(s501, s502, s503), dim=c(50, 50, 3)))
mydata &lt;- sienaDataCreate(mynet1)
myeff &lt;- getEffects(mydata)
myeff &lt;- includeEffects(myeff, transTrip)
ans &lt;- siena07(myalgorithm, data=mydata, effects=myeff, batch=TRUE)

## Conduct the score-type test to assess whether heterogeneity is present.
tt &lt;- sienaTimeTest(ans)
summary(tt)

## Suppose that we wish to include time dummies.
## Add them in the following way:
myeff &lt;- includeTimeDummy(myeff, recip, transTrip, timeDummy="2")
ans2 &lt;- siena07(myalgorithm, data=mydata, effects=myeff, batch=TRUE)

## Re-assess the time heterogeneity
(tt2 &lt;- sienaTimeTest(ans2))

## And so on..

## A demonstration of the plotting facilities, on a larger dataset:
## (Of course pasting these identical sets of three waves after each other
##  in a sequence of six is not really meaningful. It's just a demonstration.)

myalgorithm &lt;- sienaAlgorithmCreate(nsub=1, n3=50, seed=654, projname=NULL)
mynet1 &lt;- sienaDependent(array(c(s501, s502, s503, s501, s503, s502),
                               dim=c(50, 50, 6)))
mydata &lt;- sienaDataCreate(mynet1)
myeff &lt;- getEffects(mydata)
myeff &lt;- includeEffects(myeff, transTrip, balance)
myeff &lt;- includeTimeDummy(myeff, density, timeDummy="all")
myeff &lt;- includeTimeDummy(myeff, recip, timeDummy="2,3,5")
myeff &lt;- includeTimeDummy(myeff, balance, timeDummy="4")
## Not run: 
(ansp &lt;- siena07(myalgorithm, data=mydata, effects=myeff))
ttp &lt;- sienaTimeTest(ansp, effects=1:4)

## Pairwise plots show
plot(ttp, pairwise=TRUE)

## Time test plots show
plot(ttp, effects=1:4, dims=c(2,2))

## End(Not run)

## Instead of working with includeTimeDummy,
## you can also define time dummies explicitly;
## this may give more control and more clarity:
dum2 &lt;- matrix(c(0,1,0,0,0), nrow=50, ncol=5, byrow=TRUE)
dum3 &lt;- matrix(c(0,0,1,0,0), nrow=50, ncol=5, byrow=TRUE)
dum4 &lt;- matrix(c(0,0,0,1,0), nrow=50, ncol=5, byrow=TRUE)
dum5 &lt;- matrix(c(0,0,0,0,1), nrow=50, ncol=5, byrow=TRUE)
time2 &lt;- varCovar(dum2)
time3 &lt;- varCovar(dum3)
time4 &lt;- varCovar(dum4)
time5 &lt;- varCovar(dum5)
mydata &lt;- sienaDataCreate(mynet1, time2, time3, time4, time5)
myeff &lt;- getEffects(mydata)
myeff &lt;- includeEffects(myeff, transTrip, balance)
## corresponding to includeTimeDummy(myeff, density, timeDummy="all"):
myeff &lt;- includeEffects(myeff, egoX, interaction1='time2')
myeff &lt;- includeEffects(myeff, egoX, interaction1='time3')
myeff &lt;- includeEffects(myeff, egoX, interaction1='time4')
myeff &lt;- includeEffects(myeff, egoX, interaction1='time5')
## corresponding to myeff &lt;- includeTimeDummy(myeff, recip, timeDummy="2,3,5"):
myeff &lt;- includeInteraction(myeff, egoX, recip, interaction1=c('time2', ''))
myeff &lt;- includeInteraction(myeff, egoX, recip, interaction1=c('time3', ''))
myeff &lt;- includeInteraction(myeff, egoX, recip, interaction1=c('time5', ''))
## corresponding to myeff &lt;- includeTimeDummy(myeff, balance, timeDummy="4"):
myeff &lt;- includeInteraction(myeff, egoX, balance, interaction1=c('time4', ''))
## Not run: 
(anspp &lt;- siena07(myalgorithm, data=mydata, effects=myeff))
## anspp contains identical results as ansp above.

## End(Not run)

## A demonstration of RateX heterogeneity.
## Not run: 
mynet1 &lt;- sienaDependent(array(c(s501, s502, s503), dim=c(50, 50, 3)))
myccov &lt;- coCovar(s50a[,1])
mydata &lt;- sienaDataCreate(mynet1, myccov)
myeff &lt;- getEffects(mydata)
myeff &lt;- includeEffects(myeff, transTrip, balance)
myeff &lt;- includeTimeDummy(myeff, RateX, type="rate", interaction1="myccov")
(ans &lt;- siena07(myalgorithm, data=mydata, effects=myeff))

## End(Not run)
</code></pre>


</div>