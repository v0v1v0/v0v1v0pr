<div class="container">

<table style="width: 100%;"><tr>
<td>findabsorptionfeatures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Absorption Features in a Spectrum</h2>

<h3>Description</h3>

<p>This function applies the Absorption Feature Finder algorithm (Algorithm 1 in
<a href="https://arxiv.org/abs/2005.14083">Holzer et. al 2020</a>) to find absorption 
features in a high signal-to-noise,
normalized, spectrum. For a spectrum that covers more than 100 Angstroms, it is
recommended to parallelize it by setting the <code>cores</code> argument to be greater
than 1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findabsorptionfeatures(
  wvl,
  flux,
  pix_range = 7,
  gamma = 0.01,
  alpha = 0.05,
  minlinedepth = 0,
  cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wvl</code></td>
<td>
<p>vector of wavelengths in the spectrum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flux</code></td>
<td>
<p>vector of normalized flux in the spectrum (must have the same length as <code>wvl</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pix_range</code></td>
<td>
<p>integer that specifies the window size in units of pixels to use in the moving linear regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>significance level used in finding local minima</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level used in estimating wavelength bounds of features (<strong>Note:</strong> this must be larger than <code>gamma</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minlinedepth</code></td>
<td>
<p>minimum depth required for found absorption features to be returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>number of cores to parallelize over (if set to 1, no parallelizing is done)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>wvbounds</code></td>
<td>
<p>a list of length 2 vectors that each give the lower and upper bounds of found absorption features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_wvl</code></td>
<td>
<p>a vector of the wavelengths at which the minimum flux is achieved for each found absorption feature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_flx</code></td>
<td>
<p>a vector of the minimum flux for each found absorption feature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_flx</code></td>
<td>
<p>a vector of the maximum flux for each found absorption feature</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(template)
ftrs = findabsorptionfeatures(template$Wavelength,
                              template$Flux,
                              pix_range = 8, gamma = 0.05,
                              alpha = 0.07, minlinedepth = 0.015)
plot(template$Wavelength, template$Flux,
     type='l', xlab = "Wavelength", ylab = "Flux")
for(i in 1:length(ftrs$wvbounds)){
  lines(ftrs$wvbounds[[i]],
        c(1,1) - 0.01*rep(i%%2,2), col=3)
}
</code></pre>


</div>