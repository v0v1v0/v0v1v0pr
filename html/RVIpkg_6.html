<div class="container">

<table style="width: 100%;"><tr>
<td>RVI_func</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regional Vulnerability Index</h2>

<h3>Description</h3>

<p>The Regional Vulnerability Index (RVI), a statistical measure of brain structural abnormality, quantifies an individualâ€™s similarity to the expected pattern
(effect size) of deficits seen in schizophrenia derived from large-scale meta-analyses by the ENIGMA consortium. This package outputs the inverse-normal
transformed (INT) residuals, z-normalized INT residuals, RVI and Alignment Vulnerability Index (AVI).
</p>


<h3>Usage</h3>

<pre><code class="language-R">RVI_func(
  ID,
  DXcontrol,
  covariates = NULL,
  resp.range,
  EP,
  sign = FALSE,
  fisherZ = FALSE,
  data
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>a column name of subject IDs in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DXcontrol</code></td>
<td>
<p>a character string specifying control subset(i.e. DXcontrol='DX==0'or DXcontrol='DX=="CN"'). Mean and standard deviation of z-normalization
should be calculated in healthy controls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>an optional character vector specifying column names of covariates (i.e. Age, Sex). If covariates=NULL (the default), residuals will not be
adjusted for any covariate. If covariates are specified (i.e. covariates=c('Age','Sex')), residuals will be adjusted for covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp.range</code></td>
<td>
<p>a numeric vector specifying column indices of regional neuroimaging traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EP</code></td>
<td>
<p>a numeric vector specifying an expected pattern of regional neuroimaging traits. The expected patterns(EP.WM, EP.GM and EP.Subcortical) for white matter
fractional anisotropy (FA), cortical matter thickness and subcortical volume are included in the package (Note: If you use an expected pattern, you need to make
sure the order of regional neuroimaging traits in your data match up the corresponding order of the expected pattern). The patterns can be extract in the package
(i.e. RVIpkg::EP.WM$SSD, RVIpkg::EP.WM$MDD, RVIpkg::EP.WM$AD, RVIpkg::EP.WM$BD ,RVIpkg::EP.WM$PD .etc.). They were developed using neuroimaging data of UK Biobank (UKBB).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign</code></td>
<td>
<p>a logical value indicating whether the AVI use signs from RVI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisherZ</code></td>
<td>
<p>a logical value indicating whether the result should generate fisher-z transformed RVI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame contains a column of subject IDs, a column of controls, columns of covariates, columns of responses.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The RVI is developed as a simple measure of agreement between an individual's pattern of regional neuroimaging traits and the expected pattern of schizophrenia.
First, all observations of each regional neuroimaging trait are regressed out optional covariates using linear regression, and then residuals are extracted from
the model after removing effects of the optional covariates. The optional covariates could be age, sex, intracranial brain volume and/or .etc in the data. After
that the residuals are inverse-normal transformed based on residuals' ranks, and then the INT residuals are z-normalized/standardized using mean and standard
deviation of healthy controls to get z-normalized INT residuals. For each subject, the RVI is then calculated as a Pearson correlation coefficient between the
z-normalized INT residuals of the traits and corresponding expected pattern of the traits and the AVI is the dot product of the z-normalized INT residuals of the
traits and corresponding expected pattern of the traits. These expected patterns include cortical thickness, subcortical volume, and white matter FA for mental
illnesses and metabolic diseases.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>i.norm.resid</code></td>
<td>
<p>INT residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.norm.resid</code></td>
<td>
<p>z-normalized/standardized INT residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RVI</code></td>
<td>
<p>RVI: the Pearson correlation coefficient between the z-normalized INT residuals and corresponding expected pattern;
AVI: the dot product of the z-normalized INT residuals and corresponding expected pattern;
RVI.fisherz: Fisher z-transformed RVI
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The RVI_func() function is developed at the Maryland Psychiatric Research Center, Department of Psychiatry,
University of Maryland School of Medicine. This project is supported by NIH R01 EB015611 grant. Please cite our funding if
you use this software.
</p>


<h3>References</h3>

<p>Kochunov P, Fan F, Ryan MC, et al. Translating ENIGMA schizophrenia findings using the regional vulnerability index: Association
with cognition, symptoms, and disease trajectory (2020). Hum Brain Mapp. 2020;10.1002/hbm.25045. <a href="https://doi.org/10.1002/hbm.25045">doi:10.1002/hbm.25045</a>
</p>
<p>R Core Team (2020). R: A language and environment for statistical computing. R
Foundation for Statistical Computing, Vienna, Austria. URL
https://www.R-project.org/.
</p>


<h3>Examples</h3>

<pre><code class="language-R">EP1 &lt;- c(-0.37,0.31,-0.02,-0.08,-0.21,0.46,0.31,0.25)
RVI1 &lt;- RVI_func(ID='ID', DXcontrol='DX==0', covariates=c('Age','Sex'), resp.range=c(5:12),
EP=EP1, data=RVIpkg::data)
RVI2 &lt;- RVI_func(ID='ID', DXcontrol='DX==0', covariates=NULL, resp.range=c(5:12),
EP=EP1, data=RVIpkg::data)
EP2 &lt;- RVIpkg::EP.Subcortical$SSD
RVI3 &lt;- RVI_func(ID='ID', DXcontrol='DX==0', covariates=c('Age','Sex'), resp.range=c(5:12),
EP=EP2, data=RVIpkg::data)
</code></pre>


</div>