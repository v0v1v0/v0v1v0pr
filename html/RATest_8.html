<div class="container">

<table style="width: 100%;"><tr>
<td>PT.Khmaladze.MultTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Martingale transformed Permutation Test: Multiple Testing procedures.</h2>

<h3>Description</h3>

<p>This function applies the martingale transformed Permutation test (Chung and Olivares (2020)) to test whether there exists within-group treatment effect heterogeneity. 
The method jointly tests the null hypotheses that treatment effects are constant within mutually exclusive subgroups while allowing them to be different across subgroups. More formally, 
assume the mutually exclusive subgroups are formed from observed covariates, and are taken as given. Denote <code class="reqn">\mathcal{J}</code> the total number of such subgroups. 
Let <code class="reqn">F_0^{j}(y)</code> and <code class="reqn">F_1^{j}(y)</code> be the CDFs of the control and treatment group for subgroup <code class="reqn">1\le j\le \mathcal{J}</code>. The null hypothesis of interest is given by the joint hypothesis
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{H}_{0}: F_1^{j}(y + \delta_{j}) = F_0^{j}(y)</code>
</p>

<p>for all mutually exclusive <code class="reqn">j\in\{1,\dots,\mathcal{J}\}</code>, for some <code class="reqn">\delta_j</code>. We are treating <code class="reqn">\mathbf{H}_0</code> as a multiple testing problem in which every individual hypothesis <code class="reqn">j\in\{1,\dots,\mathcal{J}\}</code>, given by
</p>
<p style="text-align: center;"><code class="reqn">H_{0,j}: F_1^{j}(y + \delta_{j}) = F_0^{j}(y)</code>
</p>

<p>for some <code class="reqn">\delta_j</code> specifies whether the treatment effect is heterogeneous for a particular subgroup.
</p>
<p>To achieve control of the family-wise error rate, the function considers several multiple testing procedures, such as Bonferroni, maxT and minP (Westfall and Young (1993)), and Holm (1979).
For further details, see Chung and Olivares (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PT.Khmaladze.MultTest(
  data,
  procedure = "maxT",
  alpha = 0.05,
  n.perm = 499,
  B = 499,
  na.action
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>List. Data are presented in the form of a list, where each sublist contains the treatment and control group observations for a specific subgroup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>procedure</code></td>
<td>
<p>multiple testing procedure. Several options are available, including maxT and minP (Westfall and Young (1993)), Bonferroni adjustment, and Holm (1979) procedure. The default is Bonferroni.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. See Remark 4 in Chung and Olivares (2020). The default is n.perm=499.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation in the Westfall-Young procedures. See Remark 11 in Chung and Olivares (2020). The default is B=499.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function to filter missing data. This is applied to the model.frame . The default is na.omit, which deletes observations that contain one or more missing values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "PT.Khmaladze.MultTest" is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>
<p>Type of multiple testing adjustment. It can be Westfall-Young's maxT, minP, Holm or Bonferroni.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.subgroups</code></td>
<td>
<p>Number of subgrups for a specific covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.obs</code></td>
<td>
<p>Vector. Observed test statistic for each subgroup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>Vector. P-value for each individual test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.pvalue</code></td>
<td>
<p>Vector. Adjusted p-values according to the user-chosen multiple testing procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of permutations used in the Westfall-Young procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.sizes</code></td>
<td>
<p>Subgroup sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>


<h3>References</h3>

<p>Chung, E. and Olivares, M. (2021). Permutation Test for Heterogeneous Treatment Effects with a Nuisance Parameter. Forthcoming in Journal of Econometrics.
Holm, S. (1979). A simple sequentially rejective multiple test procedure. Scandinavian Journal of Statistics, pages 65-70.
Westfall, P.H. and Young, S.S. (1993). Resampling-based multiple testing: Examples and methods for p-value adjustment, Volume 279, John &amp; Wiley Sons.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
subgroup1 &lt;- list()
subgroup1$Y0 &lt;- rnorm(11)
subgrpup1$Y1 &lt;- rnorm(8,1,1) 
subgroup2 &lt;- list()
subgroup2$Y0 &lt;- rnorm(9)
subgroup2$Y1 &lt;- rnorm(7,1,2)
data &lt;- list(subgroup1,subgroup2)
res.minP &lt;- PT.Khmaladze.MultTest(data,"minP",n.perm=100,B=100)
summary(res.minP)
adjusted.p.values &lt;- res.minP$adj.pvalues
adjusted.p.values

## End(Not run)
</code></pre>


</div>