<div class="container">

<table style="width: 100%;"><tr>
<td>mllRH1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Minus loglikelihood of a RHawkes model with parent probabilities
</h2>

<h3>Description</h3>

<p>Calculates the minus loglikelihood of a RHawkes model with given
immigration hazard function <code class="reqn">\mu</code>, offspring density function 
<code class="reqn">h</code> and branching ratio <code class="reqn">\eta</code> for event times <code>tms</code> 
on interval <code class="reqn">[0,cens]</code>. The same as <code>mllRH</code> although this
version also returns the parent probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mllRH1(tms, cens, par, 
      h.fn = function(x, p) dexp(x, rate = 1/p), 
      mu.fn = function(x, p) {
        exp(dweibull(x, shape = p[1], scale = p[2], log = TRUE) - 
        pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE))
        }, 
        H.fn = function(x, p) pexp(x, rate = 1/p), 
        Mu.fn = function(x, p) {
          -pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE)
        })
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tms</code></td>
<td>

<p>A numeric vector, with values sorted in ascending order. Event times
to fit the RHawkes point process model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>A numeric vector containing the parameters of the model, in order of the 
immigration parameters <code class="reqn">\mu(.)</code>, offspring parameters <code class="reqn">h(.)</code> and 
lastly the branching ratio <code class="reqn">\eta(.)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.fn</code></td>
<td>

<p>A (vectorized) function. The immigration hazard function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the offspring density function from 0 to <code>t</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the immigrant hazard function from 0 to <code>t</code>. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mll</code></td>
<td>
<p>minus log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>parent probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of events</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Feng Chen &lt;feng.chen@unsw.edu.au&gt;
Tom Stindl &lt;t.stindl@unsw.edu.au&gt;</p>


<h3>See Also</h3>

<p><code>mllRH</code></p>


<h3>Examples</h3>

<pre><code class="language-R">tmp &lt;- mllRH1(sort(runif(1000,0,1000)), 1001, c(2,1,0.5,1))
for(i in 1:tmp$n)
  cat(exp(tmp$log.p[i*(i - 1)/2 + 1:i]), "\n")    
</code></pre>


</div>