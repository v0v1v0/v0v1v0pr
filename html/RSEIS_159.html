<div class="container">

<table style="width: 100%;"><tr>
<td>makeDB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a seismic Waveform Database </h2>

<h3>Description</h3>

<p>Create a seismic Waveform Database</p>


<h3>Usage</h3>

<pre><code class="language-R">makeDB(path=".", pattern="R", dirs="", kind = 1,
Iendian=1, BIGLONG=FALSE)
FmakeDB(LF2, kind =1, Iendian=1, BIGLONG=FALSE)


</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>character, Path to directory where files and directories exist</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>character, pattern for listing of files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dirs</code></td>
<td>
<p>character, vector of directories to be scanned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kind</code></td>
<td>
<p>kind of data: RDS=-1, R(DAT)=0, segy=1; sac=2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Iendian</code></td>
<td>
<p>default=1, Endian-ness of the data: 1,2,3: "little", "big", "swap".
Default = 1 (little)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIGLONG</code></td>
<td>
<p> logical, TRUE means long=8 bytes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LF2</code></td>
<td>
<p> list of files
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The files are typically located in a directory structure
created by programs like ref2segy, a PASSCAL program for
downloading data in the field.  Each file contains one seismogram,
with a header.  makeDB reads in all the headers and
creates a list of meta-data for later use in RSEIS.
</p>
<p>"kind" can be numeric or character: options are
'RDS', 'RDATA', 'SEGY', 'SAC', corresponding to (-1, 0, 1, 2).
</p>
<p>Uses readBin to extract data in SAC format.
user must know what kind of machine the data
was created on for I/O purposes.
</p>
<p>If data was created on a little endian machine but
is being read on big endian machine, need to call
the endian "swap" for swapping.
</p>
<p>If data was created on a machine with LONG=4 bytes,
be sure to call the program with BIGLONG=FALSE.
</p>
<p>If the base directory, or the subdirectories,  contain files that are
not seismic data then care must be taken.  Perhaps use FmakeDB
to explicitly names the files for the DataBase.
</p>
<p>If using FmakeDB a simple vector of files
(full path names) should be provided.
</p>
<p>The origin year, used for getting the Epoch year,
is stored as attribute origyr.
</p>


<h3>Value</h3>

<p>list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>file name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yr</code></td>
<td>
<p>year</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jd</code></td>
<td>
<p>julian day</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hr</code></td>
<td>
<p>hour</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mi</code></td>
<td>
<p>minute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sec</code></td>
<td>
<p>second</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dur</code></td>
<td>
<p>duration, seconds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>time 1 in Epoch days</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> t2</code></td>
<td>
<p>time 2 in Epoch days</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sta</code></td>
<td>
<p>station name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>component name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>sample rate, seconds</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Epoch times are used to accomodate problems where
julian days cross year end boundaries, so that
day 366 comes before day 1 of the next year.
</p>
<p>The origyr, kind , Iendian, BIGLONG are stored as attributes
in the Database.
</p>


<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;</p>


<h3>See Also</h3>

<p>setupDB, Mine.seis , getseis24, plotseis24, EPOCHday, swig</p>


<h3>Examples</h3>

<pre><code class="language-R">

##########  to illustrate, we make a set of individual seismograms
data(GH)
L1 = length(GH$JSTR)
DD = data.frame(GH$info)

GIVE = vector(mode='list')

for(i in 1:L1)
{
AA = DD[i,]
GIVE[[i]] = list(fn = AA$fn, sta =GH$STNS[i] , comp = GH$COMP[i], 
            dt = AA$dt, DATTIM = AA, N = AA$n1, units = NA, 
            coords = NA, amp = GH$JSTR[[i]]  )
}

###########  save the seismic data in a temporary directory
####   each trace in a separate file
tdir = tempdir()
for(i in 1:length(GIVE) )
{
    sig = GIVE[[i]]
  d1 =  dateStamp(sig$DATTIM, sep='_')
   nam1 =  paste(d1,sig$sta, sig$comp, sep='_')
    nam2 = paste0(nam1, '.RDS')
    nam3 = paste(tdir, nam2, sep='/')
    saveRDS(file=nam3, sig) 
    }

########################  Now  read files and make the DataBase:
LF  = list.files(path=tdir,pattern='.RDS',  full.names=TRUE)
DB = FmakeDB(LF, kind=-1)


</code></pre>


</div>