<div class="container">

<table style="width: 100%;"><tr>
<td>simulx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of mixed effects models and longitudinal data</h2>

<h3>Description</h3>

<p>Compute predictions and sample data from <code>Mlxtran</code> and <code>R</code> models
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulx(
  model = NULL,
  parameter = NULL,
  covariate = NULL,
  output = NULL,
  treatment = NULL,
  regressor = NULL,
  occasion = NULL,
  varlevel = NULL,
  group = NULL,
  project = NULL,
  nrep = 1,
  npop = NULL,
  fim = NULL,
  saveSmlxProject = NULL,
  result.file = NULL,
  addlines = NULL,
  settings = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a <code>Mlxtran</code> model used for the simulation. It can be a text file or an outut of the inLine function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>One of
</p>

<ul>
<li>
<p> a vector of parameters with their names and values,
</p>
</li>
<li>
<p> a dataframe with parameters defined for each id or each pop
</p>
</li>
<li>
<p> a string, path to a data frame (csv or txt file)
</p>
</li>
<li>
<p> a string corresponding to the parameter elements automatically generated by monolix
(only when simulation is based on a Monolix project).
One of the following mlx parameter elements: "mlx_Pop", "mlx_PopUncertainSA",
"mlx_PopUncertainLin", "mlx_PopIndiv", "mlx_PopIndivCov","mlx_CondMean",
"mlx_EBEs","mlx_CondDistSample"
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>One of
</p>

<ul>
<li>
<p> a vector of covariates with their names and values.
</p>
</li>
<li>
<p> a dataframe with covariates defined for each id
</p>
</li>
<li>
<p> a string, path to a data frame (csv or txt file)
</p>
</li>
<li>
<p> a string corresponding to the covariate elements automatically generated by monolix
(only when simulation is based on a Monolix project).
One of the following mlx covariate elements: "mlx_Cov" and "mlx_CovDist"
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>output or list of outputs. An output can be defined by
</p>

<ul>
<li>
<p> a string corresponding to the output elements automatically generated by monolix
(only when simulation is based on a Monolix project) - the format is mlx_nameofoutput.
</p>
</li>
<li>
<p> a list with fields
</p>

<ul>
<li> <p><code>name</code>: a vector of output names
</p>
</li>
<li> <p><code>time</code>:
</p>

<ul>
<li>
<p> a vector of times
</p>
</li>
<li>
<p> a dataframe with columns id, time (columns lloq, uloq, limit are optional)
</p>
</li>
<li>
<p> a string, path to a data frame (csv or txt file)
</p>
</li>
</ul>
</li>
<li> <p><code>lloq</code>: lower limit of quantification (when time is a vector of times)
</p>
</li>
<li> <p><code>uloq</code>: upper limit of quantification (when time is a vector of times)
</p>
</li>
<li> <p><code>limit</code>: lower bound of the censoring interval (when time is a vector of times)
</p>
</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>treatment or list of treatments. A treatment can be defined by
</p>

<ul>
<li>
<p> A list with fields
</p>

<ul>
<li> <p><code>time</code> : a vector of input times,
</p>
</li>
<li> <p><code>amount</code> : a scalar or a vector of amounts,
</p>
</li>
<li> <p><code>rate</code> : a scalar or a vector of infusion rates (default=<code>Inf</code>),
</p>
</li>
<li> <p><code>tinf</code> : a scalar or a vector of infusion times (default=0),
</p>
</li>
<li> <p><code>washout</code> : a scalar or a vector of boolean (default=F),
</p>
</li>
<li> <p><code>adm</code> : (or type) the administration type (default=1),
</p>
</li>
<li> <p><code>repeats</code> : the treatment cycle (optional), a vector with fields
</p>

<ul>
<li> <p><code>cycleDuration</code> : the duration of a cycle,
</p>
</li>
<li> <p><code>NumberOfRepetitions</code> : the number of cycle repetition
</p>
</li>
</ul>
</li>
<li> <p><code>probaMissDose</code>: the probability to miss each dose (optional).
</p>
</li>
</ul>
</li>
<li>
<p> a dataframe with treatments defined for each id
</p>
</li>
<li>
<p> a string, path to a data frame (csv or txt file)
</p>
</li>
<li>
<p> a string corresponding to the treatment elements automatically generated by monolix
(only when simulation is based on a Monolix project) - for example mlx_Adm1.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regressor</code></td>
<td>
<p>treatment or list of treatments. A treatment can be defined by
</p>

<ul>
<li>
<p> A list with fields
</p>

<ul>
<li> <p><code>name</code> : a vector of regressor names,
</p>
</li>
<li> <p><code>time</code> : a vector of times,
</p>
</li>
<li> <p><code>value</code> : a vector of values.
</p>
</li>
</ul>
</li>
<li>
<p> A dataframe with columns id, time, and regressor values
</p>
</li>
<li>
<p> a string, path to a data frame (csv or txt file)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occasion</code></td>
<td>
<p>An occasion can be defined by
</p>

<ul>
<li>
<p> A list with fields
</p>

<ul>
<li> <p><code>name</code> : name of the variable which defines the occasions,
</p>
</li>
<li> <p><code>time</code> : a vector of times (beginnings of occasions)
</p>
</li>
</ul>
</li>
<li>
<p> A dataframe with columns id, time, occasion
</p>
</li>
<li>
<p> a string, path to a data frame (csv or txt file)
</p>
</li>
<li>
<p> "none", to delete an occasion structure
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varlevel</code></td>
<td>
<p>deprecated, use occasion instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>a list, or a list of lists, with fields:
</p>

<ul>
<li> <p><code>size</code> : size of the group (default=1),
</p>
</li>
<li> <p><code>parameter</code> : if different parameters per group are defined,
</p>
</li>
<li> <p><code>covariate</code> : if different covariates per group are defined,
</p>
</li>
<li> <p><code>output</code> : if different outputs per group are defined,
</p>
</li>
<li> <p><code>treatment</code> : if different treatments per group are defined,
</p>
</li>
<li> <p><code>regressor</code> : if different regression variables per group are defined.
</p>
</li>
</ul>
<p>"level" field is not supported anymore in RsSimulx.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>project</code></td>
<td>
<p>the name of a Monolix project</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>Samples with or without uncertainty depending which element is given as "parameter".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npop</code></td>
<td>
<p>deprecated, Set parameter = "mlx_popUncertainSA" or "mlx_popUncertainLin" instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fim</code></td>
<td>
<p>deprecated, Set parameter = "mlx_popUncertainSA" or "mlx_popUncertainLin" instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveSmlxProject</code></td>
<td>
<p>If specified, smlx project will be save in the path location
(by default smlx project is not saved)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result.file</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addlines</code></td>
<td>
<p>a list with fields:
</p>

<ul><li> <p><code>formula</code>: string, or vector of strings, to be inserted .
</p>
</li></ul>
<p>"section", "block" field are not supported anymore in RsSimulx.
You only need to specify a formula. The additional lines will be added in a new section EQUATION.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>settings</code></td>
<td>
<p>a list of optional settings
</p>

<ul>
<li> <p><code>seed</code>: initialization of the random number generator (integer) (by default a random seed will be generated)
</p>
</li>
<li> <p><code>id.out</code>: add (TRUE) / remove (FALSE) columns id and group when only one element (N = 1 or group = 1) (default=FALSE)
</p>
</li>
<li> <p><code>kw.max</code>: deprecated.
</p>
</li>
<li> <p><code>replacement</code> : deprecated, use samplingMethod instead
</p>
</li>
<li> <p><code>samplingMethod</code>: str, Sampling method used for the simulation. One of "keepOrder", "withReplacement", "withoutReplacement"
(default "keepOrder")
</p>
</li>
<li> <p><code>out.trt</code>: TRUE/FALSE (default = TRUE) output of simulx includes treatment
</p>
</li>
<li> <p><code>out.reg</code>: TRUE/FALSE (default = TRUE) output of simulx includes regressors
</p>
</li>
<li> <p><code>sharedIds</code>: Vector of Elements that share ids. Available types are "covariate", "output",
"treatment", "regressor", "population", "individual" (default c())
</p>
</li>
<li> <p><code>sameIndividualsAmongGroups</code>: boolean, if True same individuals will be simulated among all groups
(default False)
</p>
</li>
<li> <p><code>exportData</code>: boolean, if True and if a path to save the smlx project (saveSmlxProject) is specified,
export the simulated dataset (smlx project directory/Simulation/simulatedData.txt)
(default False)
</p>
</li>
<li> <p><code>regressorInterpolationMethod</code>: interpolation method for missing regressors. One of "lastCarriedForward" (default), "linearInterpolation"
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>simulx takes advantage of the modularity of hierarchical models for simulating
different components of a model: models for population parameters, individual
covariates, individual parameters and longitudinal data.
</p>
<p>Furthermore, <code>simulx</code> allows to draw different types of longitudinal data,
including continuous, count, categorical, and time-to-event data.
</p>
<p>The models are encoded using either the model coding language ‘<span class="samp">⁠Mlxtran⁠</span>’.
‘<span class="samp">⁠Mlxtran⁠</span>’ models are automatically converted into C++ codes,
compiled on the fly and linked to R using the ‘<span class="samp">⁠RJSONIO⁠</span>’ package.
That allows one to implement very easily complex models and to take advantage
of the numerical sovers used by the C++ ‘<span class="samp">⁠mlxLibrary⁠</span>’.
</p>
<p>See http://simulx.lixoft.com for more details.
</p>


<h3>Value</h3>

<p>A list of data frames. Each data frame is an output of simulx
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
myModel &lt;- inlineModel("
[LONGITUDINAL]
input = {A, k, c, a}
EQUATION:
t0    = 0
f_0   = A
ddt_f = -k*f/(c+f)
DEFINITION:
y = {distribution=normal, prediction=f, sd=a}
[INDIVIDUAL]
input = {k_pop, omega}
DEFINITION:
k = {distribution=lognormal, prediction=k_pop, sd=omega}
")

f &lt;- list(name='f', time=seq(0, 30, by=0.1))
y &lt;- list(name='y', time=seq(0, 30, by=2))
parameter &lt;- c(A=100, k_pop=6, omega=0.3, c=10, a=2)

res &lt;- simulx(model     = myModel,
              parameter = parameter,
              occasion  = data.frame(time=c(0, 0), occ=c(1, 2)),
              output    = list(f,y),
              group     = list(size=4),
              saveSmlxProject = "./project.smlx")

res &lt;- simulx(model     = myModel,
              parameter = parameter,
              occasion  = data.frame(time = c(0, 0, 0, 0),
                                     occ1 = c(1, 1, 2, 2),
                                     occ2 = c(1, 2, 3, 4)),
              output    = list(f,y),
              group     = list(size=4))
              
res &lt;- simulx(model     = myModel,
              parameter = parameter,
              output    = list(f,y),
              group     = list(size=4))

plot(ggplotmlx() + geom_line(data=res$f, aes(x=time, y=f, colour=id)) +
     geom_point(data=res$y, aes(x=time, y=y, colour=id)))
print(res$parameter)


## End(Not run)

</code></pre>


</div>