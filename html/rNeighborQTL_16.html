<div class="container">

<table style="width: 100%;"><tr>
<td>scan_neighbor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Genome scan for neighbor effects with a QTL model</h2>

<h3>Description</h3>

<p>Genome scan using a QTL model for self and neighbor effects, with possible allowance for additional covariates and non-normal traits. Theoretical background is described in Sato, Takeda &amp; Nagano (2021).
</p>


<h3>Usage</h3>

<pre><code class="language-R">scan_neighbor(
  genoprobs,
  pheno,
  smap,
  scale,
  addcovar = NULL,
  addQTL = NULL,
  grouping = rep(1, nrow(smap)),
  response = c("quantitative", "binary"),
  contrasts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genoprobs</code></td>
<td>
<p>Conditional genotype probabilities as taken from <code>qtl::calc.genoprob()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>A vector of individual phenotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smap</code></td>
<td>
<p>A matrix showing a spatial map for individuals. The first and second column include spatial positions along an x-axis and y-axis, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A numeric scalar indicating the maximum spatial distance between a focal individual and neighbors to define neighbor effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addcovar</code></td>
<td>
<p>An optional matrix including additional non-genetic covariates. It contains no. of individuals x no. of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addQTL</code></td>
<td>
<p>An optional vector containing marker names that are considered covariates. Namely, this option allows composite interval mapping (Jansen 1993).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>An optional integer vector assigning each individual to a group. This argument can be used when <code>smap</code> contains different experimental replicates. Default setting means that all individuals are belong to a single group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>An optional argument to select trait types. The <code>"quantitative"</code> or <code>"binary"</code> calls the <code>"gaussian"</code> or <code>"binomial"</code> family in <code>glm()</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>An optional vector composed of three TRUE/FALSE values, which represents the presence/absence of specific genotypes as c(TRUE/FALSE, TRUE/FALSE, TRUE/FALSE) = AA, AB, BB. If <code>NULL</code>, it is compiled from <code>genoprobs</code> automatically.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates LOD score after the additive and dominance deviation are estimated using <code>eff_neighbor()</code>.
As it adopts a stepwise testing from self to neighbor effects, <code>LOD_self</code> are the same as standard QTL mapping.
Note that the results return 0 LOD scores for covariate markers when using <code>addQTL</code> option.
</p>


<h3>Value</h3>

<p>A matrix of LOD scores for self and neighbor effects, with the chromosome numbers and positions. The row names correspond to marker names.
</p>

<ul>
<li>
<p><code>chr</code> Chromosome number
</p>
</li>
<li>
<p><code>pos</code> Marker position
</p>
</li>
<li>
<p><code>LOD_self</code> LOD score for self effects
</p>
</li>
<li>
<p><code>LOD_nei</code> LOD score for neighbor effects
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Yasuhiro Sato (<a href="mailto:sato.yasuhiro.36c@kyoto-u.jp">sato.yasuhiro.36c@kyoto-u.jp</a>)
</p>


<h3>References</h3>


<ul>
<li>
<p> Jansen RC (1993) Interval mapping of multiple quantitative trait loci. Genetics 135:205-211.
</p>
</li>
<li>
<p> Sato Y, Takeda K, Nagano AJ (2021) Neighbor QTL: an interval mapping method for quantitative trait loci underlying plant neighborhood effects. G3; Genes|Genomes|Genetics 11:jkab017.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>eff_neighbor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
test_map &lt;- qtl::sim.map(len=rep(20,5),n.mar=3,include.x=FALSE)
test_cross &lt;- qtl::sim.cross(test_map,n.ind=50)
test_smap &lt;- cbind(runif(50,1,100),runif(50,1,100))
test_genoprobs &lt;- qtl::calc.genoprob(test_cross,step=2)

test_scan &lt;- scan_neighbor(genoprobs=test_genoprobs,
                           pheno=test_cross$pheno$phenotype,
                           smap=test_smap, scale=20
                           )
plot_nei(test_scan)
</code></pre>


</div>