<div class="container">

<table style="width: 100%;"><tr>
<td>rrmultinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>rrmultinom</h2>

<h3>Description</h3>

<p>This function is used to fit the reduced rank multinomial logistic regression
for markov chain
</p>


<h3>Usage</h3>

<pre><code class="language-R">rrmultinom(I, z1 = NULL, z2 = NULL, T, R, eps = 1e-05, ref = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>a U by U incidence matrix with elements; U is number of states; I(i,j)=1
if state j can be accessed from state i in one step and 0 otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z1</code></td>
<td>
<p>a n by p matrix with covariates involved in the dimension reduction(DR),
n is the number of subjects, p is the number of covariates involved in DR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z2</code></td>
<td>
<p>a n by q matrix with study covariates (not in dimension reduction),
q is the number of study covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>a M by 3 state matrix,
</p>

<ul>
<li>
<p> the first column is a subject number between 1,..,n;
</p>
</li>
<li>
<p> the second column is time;
</p>
</li>
<li>
<p> the third column is the state occupied by subject in column 1 at time indicated
in column 2
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the rank</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>the tolerance for convergence; the default is 10^-5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>a vector of reference categories; the default is NULL and if NULL
is used, the function will use the first category as the reference category
for each row</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of outputs:
</p>

<ul>
<li>
<p> Alpha: the final A matrix
</p>
</li>
<li>
<p> Gamma: the final G matrix
</p>
</li>
<li>
<p> Beta: the coefficient matrix for variables involved in reduced rank
</p>
</li>
<li>
<p> Dcoe: the coefficient matrix for the fixed variables
</p>
</li>
<li>
<p> Dsderr: the standard error matrix for the fixed variables
</p>
</li>
<li>
<p> Dpval: the p-value matrix for the fixed variables
</p>
</li>
<li>
<p> coemat: the overall coefficient matrix
</p>
</li>
<li>
<p> niter: the iteration number to get converged
</p>
</li>
<li>
<p> df: the degrees of freedom
</p>
</li>
<li>
<p> loglik: the final loglikelihood
</p>
</li>
<li>
<p> converge: three possible values with 0 means fail to converge, 1 means
converges, and 2 means the maximum iteration is achieved
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># generate the Markov chain
U=7
I1=I2=I3=rep(1,7)
I4=c(0,0,0,1,1,1,1)
I5=I6=I7=rep(0,7)
I=rbind(I1,I2,I3,I4,I5,I6,I7)
# prepare the data
data=cogdat
n=length(unique(data[,1]))
M=nrow(data)+n
Mc=0
z=matrix(0,n,9)
colnames(z)=colnames(data)[5:13]
T=matrix(0,M,3)
for(i in 1:n){
 subdat=data[which(data[,1]==i),,drop=FALSE]
 z[i,]=subdat[1,5:13]
 mc=nrow(subdat)
 T[(Mc+1):(Mc+mc+1),1]=i
 T[(Mc+1):(Mc+mc+1),2]=0:mc
 T[(Mc+1):(Mc+mc+1),3]=c(subdat[1,3],subdat[,4])
 Mc=Mc+mc+1
}
#z1=z[,c(1:3),drop=FALSE]
z2=z[,4,drop=FALSE]
# fit the model with rank 1
rrmultinom(I,z1=NULL,z2,T,1,eps=9,ref=c(1,1,1,4))

</code></pre>


</div>