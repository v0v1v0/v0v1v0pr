<div class="container">

<table style="width: 100%;"><tr>
<td>tune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
tunning an RHMS model
</h2>

<h3>Description</h3>

<p>a function for tunning an RHMS model based on a set of observed time series, using <em>particle swarm optimization</em>
</p>


<h3>Usage</h3>

<pre><code class="language-R">
tune(object,targetObject,decisionObjects,
     observationTS,delay=0,
     transformBandWith=list(ct=c(1  , 2.5),
                            cp=c(0.1, 0.3),
                            cn=c(25 , 85 ),
                            k =c(0.1, 2 )),
     routingBandWith=list(manning = c(0.0001, 0.1),
                          x       = c(0.2   , 0.6), 
                          k       = c(1     , 5 )),
     maxiter=NA,update=FALSE,plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object from class of <code>createBasin</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetObject</code></td>
<td>
<p>an object from either of classes: <code>createDiversion</code>, <code>createReservoir</code>, <code>createSubbasin</code>, <code>createJunction</code>, <code>createReach</code> associated to the <code>observationTS</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decisionObjects</code></td>
<td>
<p>A list of objects, also, already existing in the <code>object</code> which their parameters needed to be optimized. They objects must be from either of classes: <code>createSubbasin</code>, <code>createReach</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observationTS</code></td>
<td>
<p>a vector: an observed flow time series  (cms)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>(optional) an integer presenting the number of time steps to delay <code>observationTS</code> time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformBandWith</code></td>
<td>
<p>an list: a list of vector(s), including upper and lower limit of parameters of tansformation methods. Each parameter search domain is set as a two-value vector, whose first element indicates lower limit and second elemnt is upper limit.
</p>

<ul>
<li> <p><code>Ct</code>=[1, 2.5] and <code>Cp</code>=[0.1, 0.3] are parameters for <code>"Snyder"</code> Unit Hydrograph (SUH)
</p>
</li>
<li> <p><code>cn</code>=[25, 85] curve number for <code>"SCS"</code> loss method
</p>
</li>
<li> <p><code>k</code> for <code>"horton"</code> loss method
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>routingBandWith</code></td>
<td>
<p>an list: a list of vector(s), including upper and lower limit of parameters of routing methods. Each parameter search domain is set as a two-value vector, whose first element indicates lower limit and second elemnt is upper limit.
</p>

<ul>
<li> <p><code>manning</code>=[0.0001, 0.1] is a parameter used <code>"muskingumcunge"</code> method
</p>
</li>
<li> <p><code>x</code> = [0.2, 0.6] and <code>k</code>=[1, 5] belong to <code>"muskingum"</code> channel routing method
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>(optional) an integer: maximum number of iterations. default to the square of dimension of decision variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>(optional) logical: plots the optimization results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update</code></td>
<td>
<p>(optional) logical: If FALSE, the optimized parameter(s) are returned,If TRUE, the calibrated object from class of <code>createBasin</code> is returned</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector of tunned parameters or an object from class of <code>createBasin</code>
</p>


<h3>Author(s)</h3>

<p>Rezgar Arabzadeh
</p>


<h3>References</h3>

<p>Kennedy, J. (1997). "The particle swarm: social adaptation of knowledge". Proceedings of IEEE International Conference on Evolutionary Computation. pp. 303-308
</p>


<h3>Examples</h3>

<pre><code class="language-R">
J1&lt;-createJunction (name="J1")
R1&lt;-createReach(name="R1",routingMethod="muskingum",
                routingParams=list(k=3,x=0.2),
                downstream=J1)
R2&lt;-createReach(name="R2",routingMethod="muskingumcunge",
                routingParams=list(bedWith=50,
                                   sideSlope=2,
                                   channelSlope=0.0005,
                                   manningRoughness=0.025,
                                   riverLength=100),
                downstream=J1)
S1&lt;-createSubbasin(name = "S1", 
                   precipitation=sin(seq(0,pi,length.out=20))*40,
                   Area=100,downstream=R1,
                   transformMethod="SCS",lossMethod="SCS",
                   transformParams=list(Tlag=4),lossParams=list(CN=60))
S2&lt;-createSubbasin(name = "S2", 
                   precipitation=sin(seq(0,pi,length.out=20))*30,
                   Area=300,downstream=R2,
                   transformMethod="snyder",lossMethod="horton",
                   transformParams=list(Cp=0.17,Ct=2,L=30,Lc=15),
                   lossParams=list(f0=10,f1=4,k=1))

basin1&lt;-createBasin(name = "Ghezil_Ozan",
                    simulation=list(start='2000-01-01',
                                    end  ='2000-01-05',
                                    by   =3600))
basin1&lt;-addObjectToBasin(S1, basin1)
basin1&lt;-addObjectToBasin(S2, basin1)
basin1&lt;-addObjectToBasin(R1, basin1)
basin1&lt;-addObjectToBasin(R2, basin1)
basin1&lt;-addObjectToBasin(J1, basin1)

## Not run: plot(basin1)

simulated&lt;-sim(basin1)
plot(simulated)
observationTS1&lt;-simulated$operation$junctions[[1]]$outflo[,1]
set.seed(1)
observationTS1&lt;-observationTS1+rnorm(length(observationTS1),0,25)
y&lt;-observationTS1; x&lt;-1:length(observationTS1)
observationTS1&lt;-predict(loess(y~x),x)
observationTS1[which(observationTS1&lt;0)]&lt;-0
observationTS&lt;-observationTS1
plot(simulated$operation$junctions[[1]]$outflow[,1],typ='o',ylab='flow rate (cms)',xlab='time step')
lines(observationTS,col=2)

transformBandWith=list(ct=c(1  ,2.5),
                       cp=c(0.1,0.3),
                       cn=c(25 ,85) ,
                       k =c(0.1,2))
routingBandWith=list(maning = c(0.0001,0.1), 
                     x      = c(0.2   ,0.6),
                     k      = c(1     ,5))
targetObject&lt;-J1
decisionObjects&lt;-list(R1,R2,S1,S2)
## Not run: 
tune(object=basin1, 
     targetObject=targetObject,
     decisionObjects=decisionObjects,
     observationTS=observationTS,
     routingBandWith=routingBandWith,
     transformBandWith=transformBandWith,
     plot=TRUE)

## End(Not run)
</code></pre>


</div>