<div class="container">

<table style="width: 100%;"><tr>
<td>archivedb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CRAN archive (CRAN-archive.html + archivedb)</h2>

<h3>Description</h3>

<p>The following functions deal with the packages archived in CRAN. The html file
downloaded from CRAN contains the regular packages that have been updated once and
the packages that have been removed from CRAN by CRAN administrators. It does not contain
the first version of the packages uploaded to CRAN and never updated. These files and
the files removed from CRAN index can be guessed through a comparison with <code>crandb</code>.
</p>
<p><code>archivedb_down</code> downloads from CRAN the html file of the archived packages, saves
it on the disk under the name <code>filename</code>, extracts from it and loads in .GlobalEnv
a data.frame named <code>archivedb</code>.
</p>
<p><code>archivedb_load</code> reads the html file <code>filename</code> saved on the disk, extracts
from it and loads in .GlobalEnv a data.frame named <code>archivedb</code>.
</p>
<p><code>archivedb_npkgs</code> returns the number of packages listed each category: number of
packages in <code>crandb</code>, in <code>archivedb</code>, at first version, at subsequent version
and removed from <code>crandb</code> (CRAN index).
</p>
<p><code>archivedb_pkgs</code> returns the packages listed in CRAN archive (= <code>archivedb</code>).
</p>
<p><code>archivedb_rempkgs</code> returns the packages removed from CRAN but available in CRAN
archive. The result can be combined with <code>p_check</code> to display the last
CRAN check performed (if available). See the example.
</p>
<p><code>archivedb_list</code> compares the data.frame <code>archivedb</code> and <code>crandb</code> and
returns a list with the following items:
</p>

<ul>
<li>
<p>pkgs_crandb: the packages listed in <code>crandb</code>.
</p>
</li>
<li>
<p>pkgs_archivedb: the packages listed in <code>archivedb</code>.
</p>
</li>
<li>
<p>pkgs_first: the packages in first version in <code>crandb</code>.
</p>
</li>
<li>
<p>pkgs_updated: the packages with more than one version in <code>crandb</code>.
</p>
</li>
<li>
<p>pkgs_removed: the archived packages removed from CRAN regular index,
i.e. not listed in <code>crandb</code>.
</p>
</li>
<li>
<p>dfr_crandb: data.frame pkgs_crandb + Published date.
</p>
</li>
<li>
<p>dfr_archivedb: data.frame pkgs_archivedb + Archived date.
</p>
</li>
<li>
<p>dfr_first: data.frame pkgs_first + Published date.
</p>
</li>
<li>
<p>dfr_updated: data.frame pkgs_updated + Published date.
</p>
</li>
<li>
<p>dfr_removed: data.frame pkgs_removed+ Archived date.
</p>
</li>
<li>
<p>npkgs: the number of packages in each category.
</p>
</li>
</ul>
<p>Use <code>p_archive_lst</code> to list the package versions stored in CRAN archive.
</p>
<p>Use <code>p_downarch</code> to download packages from CRAN archive, either the
latest version or a specific version number.
</p>


<h3>Usage</h3>

<pre><code class="language-R">archivedb_down(filename = "CRAN-archive.html", dir = ".",
  url = "https://cran.r-project.org/src/contrib/Archive")

archivedb_load(filename = "CRAN-archive.html")

archivedb_npkgs(archivedb = get("archivedb", envir = .GlobalEnv),
  crandb = get("crandb", envir = .GlobalEnv))

archivedb_pkgs(archivedb = get("archivedb", envir = .GlobalEnv))

archivedb_rempkgs(archivedb = get("archivedb", envir = .GlobalEnv),
  crandb = get("crandb", envir = .GlobalEnv))

archivedb_list(archivedb = get("archivedb", envir = .GlobalEnv),
  crandb = get("crandb", envir = .GlobalEnv))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>character. The path to file "CRAN-archive.html" (or equivalent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>character. The directory where <code>filename</code> or tar.gz files
are saved. Default value <code>"."</code> is the current directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>url</code></td>
<td>
<p>character. The url address of CRAN archive html file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>archivedb</code></td>
<td>
<p>data.frame <code>archivedb</code>. The archivedb data.frame format loaded
in memory by <code>archivedb_down</code> or <code>archivedb_load</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crandb</code></td>
<td>
<p>data.frame <code>crandb</code>. The data.frame of CRAN packages.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">### DOWNLOAD archivedb AND COMPARE IT WITH crandb.
## In real life, download archivedb and crandb from CRAN
## with the functions archivedb_down() and crandb_down().
## In this example, we load two small files made with 94 and 85 packages.

crandb_load(system.file("data", "zcrandb.rda", package = "RWsearch"))
archivedb_load(system.file("aabb", "zCRAN-archive.html", package = "RWsearch"))
archivedb_npkgs()
archivedb_pkgs()
archivedb_rempkgs()

lst &lt;- archivedb_list()
lapply(lst, head)
lapply(lst, tail)

xlim &lt;- as.Date(range(lst$dfr_archivedb$Archived)) ; xlim
op &lt;- par(mfrow = c(2,1))
hist(as.Date(lst$dfr_first$Published),
     breaks = 12, freq = TRUE, las = 1, xlim = xlim)
hist(as.Date(lst$dfr_archivedb$Archived),
     breaks = 12, freq = TRUE, las = 1, xlim = xlim)
par(op)

</code></pre>


</div>