<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.construct.pi.smooth.spec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric Interaction basis constructor</h2>

<h3>Description</h3>

<p>The <code>pi</code> basis is appropriate for smooths of multiple variables. Its
purpose is to parameterize the way in which the basis changes with one of
those variables. For example, suppose the smooth is over three variables,
<code class="reqn">x</code>, <code class="reqn">y</code>, and <code class="reqn">t</code>, and we want to parameterize the effect of
<code class="reqn">t</code>. Then the <code>pi</code> basis will assume <code class="reqn">f(x,y,t) = \sum_k
g_k(t)*f_k(x,y)</code>, where the <code class="reqn">g_k(t)</code> functions are pre-specified and the
<code class="reqn">f_k(x,y)</code> functions are estimated using a bivariate basis. An example of
a parametric interaction is a linear interaction, which would take the form
<code class="reqn">f(x,y,t) = f_1(x,y) + t*f_2(x,y)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pi.smooth.spec'
smooth.construct(object, data, knots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a smooth specification object, generated by, e.g.,
<code>s(x, y, t, bs="pi", xt=list(g=list(g1, g2, g3)))</code>. For
transformation functions <code>g1</code>, <code>g2</code>, and <code>g3</code>, see
Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list containing the variables of the smooth (<code>x</code>,
<code>y</code>, and <code>t</code> above), as well as any <code>by</code> variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>a list containing any knots supplied for basis setup - in same
order and with same names as <code>data</code>. Can be <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All functions <code class="reqn">f_k()</code> are defined using the same basis set.
Accordingly, they are penalized using a single block-diagonal penalty matrix
and one smoothing parameter. Future versions of this function may be able
to relax this assumption.
</p>
<p><code>object</code> should be defined (using <code>s()</code>) with an <code>xt</code>
argument. This argument is a list that could contain any of the following
elements:
</p>

<ol>
<li> <p><code>g</code>: the functions <code class="reqn">g_k(t)</code>, specified as described below.
</p>
</li>
<li> <p><code>bs</code>: the basis code used for the functions <code class="reqn">f_k()</code>; defaults
to thin-plate regression splines, which is mgcv's default. The same
basis will be used for all <code class="reqn">k</code>.
</p>
</li>
<li> <p><code>idx</code>: an integer index indicating which variable from
<code>object$term</code> is to be parameterized, i.e., the <code class="reqn">t</code> variable;
defaults to <code>length(object$term)</code>
</p>
</li>
<li> <p><code>mp</code>: flag to indicate whether multiple penalties should
be estimated, one for each <code class="reqn">f_k()</code>. Defaults to <code>TRUE</code>. If
<code>FALSE</code>, the penalties for each <code class="reqn">k</code> are combined into a single
block-diagonal penalty matrix (with one smoothing parameter).
</p>
</li>
<li> <p><code>...</code>: further <code>xt</code> options to be passed onto the basis for
<code class="reqn">f_k()</code>.
</p>
</li>
</ol>
<p><code>xt$g</code> can be entered in one of the following forms:
</p>

<ol>
<li>
<p> a list of functions of length <code class="reqn">k</code>, where each function is of
one argument (assumed to be <code class="reqn">t</code>)
</p>
</li>
<li>
<p> one of the following recognized character strings: <code>"linear"</code>,
indicating a linear interaction, i.e. <code class="reqn">f(x,t) = f_1(x)+t*f_2(x)</code>;
<code>"quadratic"</code>, indicating a quadratic interaction, i.e.
<code class="reqn">f(x,t) = f_1(x)+t*f_2(x) + t^2*f_3(x)</code>; or
<code>"none"</code>, indicating no interaction with <code class="reqn">t</code>, i.e.
<code class="reqn">f(x,t)=f_1(x)</code>.
</p>
</li>
</ol>
<p>The only one of the above elements that is required is <code>xt</code>.
If default values for <code>bs</code>, <code>idx</code>, and <code>mp</code> are desired,
<code>xt</code> may also be entered as the <code>g</code> element itself; i.e.
<code>xt=g</code>, where <code>g</code> is either the list of functions or an acceptable
character string.
</p>
<p>Additional arguments for the lower-dimensional basis over <code>f_k</code> may
be entered using the corresponding arguments of <code>s()</code>, e.g.
<code>k</code>, <code>m</code>, <code>sp</code>, etc. For example,
<code>s(x, t, bs="pi", k=15, xt=list(g="linear", bs="ps"))</code>
will define a linear interaction with <code>t</code> of a univariate p-spline
basis of dimension 15 over <code>x</code>.
</p>


<h3>Value</h3>

<p>An object of class "pi.smooth". See
<code>smooth.construct</code> for the elements it will contain.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl and Jonathan Gellar
</p>


</div>