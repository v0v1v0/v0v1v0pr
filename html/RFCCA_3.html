<div class="container">

<table style="width: 100%;"><tr>
<td>global.significance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global significance test</h2>

<h3>Description</h3>

<p>This function runs a permutation test to evaluates the global effect of
subject-related covariates (Z). Returns an estimated <em>p</em>-value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">global.significance(
  X,
  Y,
  Z,
  ntree = 200,
  mtry = NULL,
  nperm = 500,
  nodesize = NULL,
  nodedepth = NULL,
  nsplit = 10,
  Xcenter = TRUE,
  Ycenter = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The first multivariate data set which has <code class="reqn">n</code> observations and
<code class="reqn">px</code> variables. A data.frame of numeric values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The second multivariate data set which has <code class="reqn">n</code> observations and
<code class="reqn">py</code> variables. A data.frame of numeric values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>The set of subject-related covariates which has <code class="reqn">n</code> observations
and <code class="reqn">pz</code> variables. Used in random forest growing. A data.frame with
numeric values and factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntree</code></td>
<td>
<p>Number of trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtry</code></td>
<td>
<p>Number of z-variables randomly selected as candidates for
splitting a node. The default is <code class="reqn">pz/3</code> where <code class="reqn">pz</code> is the number of
z variables. Values are always rounded up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodesize</code></td>
<td>
<p>Forest average number of unique data points in a terminal
node. The default is the <code class="reqn">3 * (px+py)</code> where <code class="reqn">px</code> and <code class="reqn">py</code> are
the number of x and y variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodedepth</code></td>
<td>
<p>Maximum depth to which a tree should be grown. In the
default, this parameter is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsplit</code></td>
<td>
<p>Non-negative integer value for the number of random splits to
consider for each candidate splitting variable. When zero or <code>NULL</code>,
all possible splits considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xcenter</code></td>
<td>
<p>Should the columns of X be centered? The default is
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ycenter</code></td>
<td>
<p>Should the columns of Y be centered? The default is
<code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>(rfcca,globalsignificance)</code> which is a list
with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The original call to <code>global.significance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p><em>p</em>-value, see below for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size of the data (<code>NA</code>'s are omitted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntree</code></td>
<td>
<p>Number of trees grown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtry</code></td>
<td>
<p>Number of variables randomly selected for splitting at each
node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodesize</code></td>
<td>
<p>Minimum forest average number of unique data points in a
terminal node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodedepth</code></td>
<td>
<p>Maximum depth to which a tree is allowed to be grown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsplit</code></td>
<td>
<p>Number of randomly selected split points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>Data frame of x-variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar.names</code></td>
<td>
<p>A character vector of the x-variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>
<p>Data frame of y-variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar.names</code></td>
<td>
<p>A character vector of the y-variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zvar</code></td>
<td>
<p>Data frame of z-variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zvar.names</code></td>
<td>
<p>A character vector of the z-variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predicted.oob</code></td>
<td>
<p>OOB predicted canonical correlations for training
observations based on the selected final canonical correlation estimation
method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predicted.perm</code></td>
<td>
<p>Predicted canonical correlations for the permutations.
A matrix of predictions with observations on the rows and permutations on
the columns.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We perform a hypothesis test to evaluate the global effect of the
subject-related covariates on distinguishing between canonical correlations.
Define the unconditional canonical correlation between <code class="reqn">X</code> and
<code class="reqn">Y</code> as <code class="reqn">\rho_{CCA}(X,Y)</code> which is found by computing CCA with
all <code class="reqn">X</code> and <code class="reqn">Y</code>, and the conditional canonical correlation between
<code class="reqn">X</code> and <code class="reqn">Y</code> given <code class="reqn">Z</code> as <code class="reqn">\rho(X,Y | Z)</code> which is found by
<code>rfcca()</code>. If there is a global effect of <code class="reqn">Z</code> on correlations
between <code class="reqn">X</code> and <code class="reqn">Y</code>, <code class="reqn">\rho(X,Y | Z)</code> should be significantly
different from <code class="reqn">\rho_{CCA}(X,Y)</code>. We conduct a permutation test
for the null hypothesis </p>
<p style="text-align: center;"><code class="reqn">H_0 : \rho(X,Y | Z) = \rho_{CCA}(X,Y)</code>
</p>

<p>We estimate a <em>p</em>-value with the permutation test. If the <em>p</em>-value is
less than the pre-specified significance level <code class="reqn">\alpha</code>, we reject the
null hypothesis.
</p>


<h3>See Also</h3>

<p><code>rfcca</code>
<code>predict.rfcca</code>
<code>print.rfcca</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## load generated example data
data(data, package = "RFCCA")
set.seed(2345)

global.significance(X = data$X, Y = data$Y, Z = data$Z, ntree = 40,
  nperm = 5)


</code></pre>


</div>