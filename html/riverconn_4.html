<div class="container">

<table style="width: 100%;"><tr>
<td>d_index_calculation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Reach- and Catchment-scale index improvement for scenarios of barriers removal</h2>

<h3>Description</h3>

<p>Calculate Reach- and Catchment-scale index improvement for scenarios of barriers removal
</p>


<h3>Usage</h3>

<pre><code class="language-R">d_index_calculation(
  graph,
  ...,
  barriers_metadata,
  id_barrier = "id_barrier",
  pass_u_updated = "pass_u_updated",
  pass_d_updated = "pass_d_updated",
  mode = "leave_one_out",
  parallel = TRUE,
  ncores
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>an object of class 'igraph'. Can be both directed or undirected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to the function 'index_calculation'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barriers_metadata</code></td>
<td>
<p>data.frame that must contain a column having the same name as the 'id_barrier' attribute of the graph,
and two columns with the corresponding upstream and downstream improved passabilities
(see 'pass_u_updated' and 'pass_d_updated' parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_barrier</code></td>
<td>
<p>graph edges attribute used to label barriers. Default is <code>"id_barrier"</code>. Must be of type charachter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pass_u_updated</code></td>
<td>
<p>field in barrier_metadata where updated value for upstream passability is stored
(recommended values higher than the original passability).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pass_d_updated</code></td>
<td>
<p>field in barrier_metadata where updated value for downstream passability is stored
(recommended values higher than the original passability).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>currentlym only <code>"leave_one_out"</code> is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical value to flag if parallel option is to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>define how many cores are used in parallel processing. Active only when <code>parallel = TRUE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Setting <code>c_ij_flag = FALSE</code> (see index_calculation arguments) removes from the calculations the effect of barriers, i.e. the c_ij contribution
is not used in the calculation of the index.
Setting <code>B_ij_flag = FALSE</code> (see index_calculation arguments) removes from the calculations the effect of movement/dispersal,
i.e. the B_ij contribution is not used in the calculation of the index.
Note that it is not possible to set both <code>c_ij_flag = FALSE</code> and <code>B_ij_flag = FALSE</code>.
</p>
<p>The setting <code>dir_distance_type = "symmetric"</code> (see index_calculation arguments) is to be used when the directionality of the river network is not relevant.
The distance between reaches midpoints is calculated for each couple of reaches.
The setting <code>dir_distance_type = "asymmetric"</code> (see index_calculation arguments) is to be used when the directionality is relevant.
The distance between reaches midpoints is calculated for each couple of reaches and splitted
between 'upstream travelled' distance and 'downstream travelled' distance
</p>
<p>The 'param_u', 'param_d', and 'param' values are interpreted differently based on the formula used to relate distance and probability.
When <code>disp_type ="exponential"</code> (see index_calculation arguments), those values are used as the base of the exponential dispersal kernel: B_ij = param^d_ij.
When <code>disp_type ="threshold"</code> (see index_calculation arguments), those values are used to define the maximum dispersal length: B_ij = ifelse(d_ij &lt; param, 1, 0).
</p>


<h3>Value</h3>

<p>returns a data.frame containing the percent improvement of the index for
each barrier present in the 'barriers_metadata' variable.
If <code>index_type = "full"</code> (see index_calculation arguments), the data.frame is organized by 'id_barrier'.
If <code>index_type = "reach"</code> (see index_calculation arguments), the data.frame is organized by 'id_barrier' and 'name'.
In both cases, both numerator and denominator used in the index calculations are reported in the columns 'num' and 'den'.
The column 'd_index' contains the relative index improvement when each barrier is removed.
</p>


<h3>References</h3>

<p>Baldan, D., Cunillera-Montcusí, D., Funk, A., &amp; Hein, T. (2022). Introducing ‘riverconn’: an R package to assess river connectivity indices. Environmental Modelling &amp; Software, 156, 105470.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(igraph)
library(igraph)
g &lt;- igraph::graph_from_literal(1-+2, 2-+4, 3-+2, 4-+6, 6-+7, 5-+6, 7-+8, 9-+5, 10-+5 )
E(g)$id_dam &lt;- c(NA, NA, "1", NA, NA, "2", NA, NA, NA)
E(g)$type &lt;- ifelse(is.na(E(g)$id_dam), "joint", "dam")
V(g)$length &lt;- c(1, 1, 2, 3, 4, 1, 5, 1, 2, 1)
V(g)$Id &lt;- V(g)$name
E(g)$pass_u &lt;- E(g)$pass_d &lt;- ifelse(!is.na(E(g)$id_dam),0.1,NA)
dams_metadata &lt;- data.frame("id_dam" =  c("1", "2"),
"pass_u_updated" = c(1, 1), "pass_d_updated" = c(1, 1))
d_index &lt;- d_index_calculation(g, barriers_metadata = dams_metadata,
id_barrier = "id_dam", parallel = FALSE, param = 0.6)


</code></pre>


</div>