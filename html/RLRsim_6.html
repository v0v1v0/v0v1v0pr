<div class="container">

<table style="width: 100%;"><tr>
<td>LRTSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of the (Restricted) Likelihood Ratio Statistic</h2>

<h3>Description</h3>

<p>These functions simulate values from the (exact) finite sample distribution
of the (restricted) likelihood ratio statistic for testing the presence of
the variance component (and restrictions of the fixed effects) in a simple
linear mixed model with known correlation structure of the random effect and
i.i.d. errors. They are usually called by <code>exactLRT</code> or
<code>exactRLRT</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LRTSim(
  X,
  Z,
  q,
  sqrt.Sigma,
  seed = NA,
  nsim = 10000,
  log.grid.hi = 8,
  log.grid.lo = -10,
  gridlength = 200,
  parallel = c("no", "multicore", "snow"),
  ncpus = 1L,
  cl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The fixed effects design matrix of the model under the alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>The random effects design matrix of the model under the alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of parameters restrictions on the fixed effects (see
Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqrt.Sigma</code></td>
<td>
<p>The upper triangular Cholesky factor of the correlation
matrix of the random effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Specify a seed for <code>set.seed</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of values to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.grid.hi</code></td>
<td>
<p>Lower value of the grid on the log scale. See
<b>Details</b></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.grid.lo</code></td>
<td>
<p>Lower value of the grid on the log scale. See
<b>Details</b></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridlength</code></td>
<td>
<p>Length of the grid for the grid search over lambda. See
<b>Details</b></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>The type of parallel operation to be used (if any). If
missing, the default is "no parallelization").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>
<p>integer: number of processes to be used in parallel operation:
typically one would chose this to the number of available CPUs. Defaults to
1, i.e., no parallelization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>An optional parallel or snow cluster for use if parallel = "snow".
If not supplied, a cluster on the local machine is created for the duration
of the call.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model under the alternative must be a linear mixed model
<code class="reqn">y=X\beta+Zb+\varepsilon</code> with a single random
effect <code class="reqn">b</code> with known correlation structure <code class="reqn">Sigma</code> and i.i.d errors.
The simulated distribution of the likelihood ratio statistic was derived by
Crainiceanu &amp; Ruppert (2004). The simulation algorithm uses a grid search over
a log-regular grid of values of
<code class="reqn">\lambda=\frac{Var(b)}{Var(\varepsilon)}</code> to
maximize the likelihood under the alternative for <code>nsim</code> realizations of
<code class="reqn">y</code> drawn under the null hypothesis. <code>log.grid.hi</code> and
<code>log.grid.lo</code> are the lower and upper limits of this grid on the log
scale. <code>gridlength</code> is the number of points on the grid.\ These are just
wrapper functions for the underlying C code.
</p>


<h3>Value</h3>

<p>A vector containing the the simulated values of the (R)LRT under the
null, with attribute 'lambda' giving <code class="reqn">\arg\min(f(\lambda))</code> (see
Crainiceanu, Ruppert (2004)) for the simulations.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl; parallelization code adapted from <code>boot</code> package
</p>


<h3>References</h3>

<p>Crainiceanu, C. and Ruppert, D. (2004) Likelihood ratio tests in
linear mixed models with one variance component, <em>Journal of the Royal
Statistical Society: Series B</em>,<b>66</b>,165â€“185.
</p>
<p>Scheipl, F. (2007) Testing for nonparametric terms and random effects in
structured additive regression.  Diploma thesis (unpublished).
</p>
<p>Scheipl, F., Greven, S. and Kuechenhoff, H (2008) Size and power of tests
for a zero random effect variance or polynomial regression in additive and
linear mixed models, <em>Computational Statistics &amp; Data Analysis</em>,
<b>52</b>(7):3283-3299
</p>


<h3>See Also</h3>

<p><code>exactLRT</code>, <code>exactRLRT</code> for tests
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(lme4)
g &lt;- rep(1:10, e = 10)
x &lt;- rnorm(100)
y &lt;- 0.1 * x + rnorm(100)
m &lt;- lmer(y ~ x + (1|g), REML=FALSE)
m0 &lt;- lm(y ~ 1)

(obs.LRT &lt;- 2*(logLik(m)-logLik(m0)))
X &lt;- getME(m,"X")
Z &lt;- t(as.matrix(getME(m,"Zt")))
sim.LRT &lt;- LRTSim(X, Z, 1, diag(10))
(pval &lt;- mean(sim.LRT &gt; obs.LRT))

</code></pre>


</div>