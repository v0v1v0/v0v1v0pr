<div class="container">

<table style="width: 100%;"><tr>
<td>buildFromWorkbook</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build a model from the contents of a workbook</h2>

<h3>Description</h3>

<p>The function builds a <code>rodeo</code>-based model by importing
all declarations and equations from a workbook established with common
spreadsheet software.
</p>


<h3>Usage</h3>

<pre><code class="language-R">buildFromWorkbook(workbook, dim = 1, fortran = FALSE, sources = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>workbook</code></td>
<td>
<p>File path of the workbook. The file type is guessed from
the extension which must be '.xlsx' or '.ods'. See below for the mandatory
worksheets that must be present in the workbook.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>The number of spatial compartments, possibly in multiple
dimensions. For single-box models without spatial resolution, use
<code>dim=1</code> (default). For a one-dimensional model with 10 compartments
use, e.g., <code>dim=10</code>. See the <code>dim</code> argument of the method
<code>initialize</code> for further details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fortran</code></td>
<td>
<p>Controls the language of code generation. The default
(<code>FALSE</code>) produces R code. Use <code>TRUE</code> if you want to use
compiled Fortran code for better performance. In the latter case, you will
need a Fortran compiler which is accessible by R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sources</code></td>
<td>
<p>Only relevant if <code>fortran=TRUE</code>. The argument
allows the name(s) of additional source file(s) to be provided
for processing by the Fortran compiler. In any case, the Fortran code
in <code>sources</code> must implement a module with the fixed name 'functions'.
This module must contain all user-defined functions referenced in any
process rate expressions or any cell of the stoichiometry matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments passed to <code>read_excel</code>
or <code>read_ods</code>, respectively.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>rodeo</code>.
</p>


<h3>Note</h3>

<p>The file provided as <code>workbook</code> must contain at least the four
mandatory sheets:
</p>

<ul>
<li>
<p>'vars' Declares the state variables of the model. Mandatory columns
are 'name', 'unit', 'description'.
</p>
</li>
<li>
<p>'pars' Declares the parameters of the model. Mandatory columns
are the same as for sheet 'vars'.
</p>
</li>
<li>
<p>'funs' Declares user-defined functions appearing in any equations of
the model. Mandatory columns are the same as for sheet 'vars'. If
source code is generated for R (<code>fortran=FALSE</code>), the declared
functions must be accessible in the environment where the model is
run. If <code>fortran=TRUE</code>, the functions must be implemented in the
file(s) listed in <code>sources</code> to be included in compilation.
</p>
</li>
<li>
<p>'eqns' Specifies the model equations. Mandatory columns
are 'name', 'unit', 'description', 'expression' plus one column for
every state variable of the model. The 'expression' columns holds the
process rate expressions and columns named after state variables
contain the corresponding stoichiometric factors.
</p>
</li>
</ul>
<p>The best way to understand the contents of a suitable workbook is to study
the examples in the folder 'models' shipped with the package. Type
<code>system.file("models", package="rodeo")</code> at the R prompt to see
where this folder is installed on your system.
</p>


<h3>Author(s)</h3>

<p>David Kneis <a href="mailto:david.kneis@tu-dresden.de">david.kneis@tu-dresden.de</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Build a SEIR type epidemic model
m &lt;- buildFromWorkbook(
  system.file("models/SEIR.xlsx", package="rodeo")
)
m$setPars(setNames(m$getParsTable()$default,
  m$getParsTable()$name))
m$setVars(setNames(m$getVarsTable()$default,
  m$getVarsTable()$name))
x &lt;- m$dynamics(times=0:30, fortran=FALSE)
print(head(x))
</code></pre>


</div>