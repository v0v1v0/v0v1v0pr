<div class="container">

<table style="width: 100%;"><tr>
<td>ancestral</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of traits ancestral states.
</h2>

<h3>Description</h3>

<p>Reconstruct the ancestral states at the root (and possibly for each nodes) of a phylogenetic tree from models fit obtained using the <code>fit_t_XX</code> functions.</p>


<h3>Usage</h3>

<pre><code class="language-R">
ancestral(object, ...)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A model fit object obtained by the <code>fit_t_XX</code> class of functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed through (not used yet).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>ancestral</code> reconstructs the ancestral states at the root and possibly for each nodes of a phylogenetic tree from the models fit obtained by the <code>fit_t_XX</code> class of functions (e.g., <code>fit_t_pl</code>, <code>fit_t_comp</code> and <code>fit_t_env</code>). Ancestral states are estimated using generalized least squares (GLS; Martins &amp; Hansen 1997, Cunningham et al. 1998 ).</p>


<h3>Value</h3>

<p>a list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>the reconstructed ancestral states at the root</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>the reconstructed ancestral states at each nodes (not yet implemented for all the methods)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The function is used internally in <code>phyl.pca_pl</code> (Clavel et al. 2019).</p>


<h3>Author(s)</h3>

<p>J. Clavel</p>


<h3>References</h3>

<p>Clavel, J., Aristide, L., Morlon, H., 2019. A Penalized Likelihood framework for high-dimensional phylogenetic comparative methods and an application to new-world monkeys brain evolution. Syst. Biol. 68: 93-116.
</p>
<p>Cunningham C.W., Omland K.E., Oakley T.H. 1998. Reconstructing ancestral character states: a critical reappraisal. Trends Ecol. Evol. 13:361-366.
</p>
<p>Martins E.P., Hansen T.F. 1997. Phylogenies and the comparative method: a general approach to incorporating phylogenetic information into the analysis of interspecific data. Am. Nat. 149:646-667.
</p>


<h3>See Also</h3>

<p><code>fit_t_pl</code>,
<code>fit_t_env</code>,
<code>phyl.pca_pl</code>,
<code>GIC</code>, 
<code>gic_criterion</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require(mvMORPH)){
set.seed(1)
n &lt;- 32 # number of species
p &lt;- 31 # number of traits

tree &lt;- pbtree(n=n) # phylogenetic tree
R &lt;- Posdef(p)      # a random symmetric matrix (covariance)

# simulate a dataset
Y &lt;- mvSIM(tree, model="BM1", nsim=1, param=list(sigma=R))

# fit a multivariate BM with Penalized likelihood
fit &lt;- fit_t_pl(Y, tree, model="BM", method="RidgeAlt")

# Perform the ancestral states reconstruction
anc &lt;- ancestral(fit)

# retrieve the scores
head(anc$nodes)
}

</code></pre>


</div>