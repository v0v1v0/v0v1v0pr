<div class="container">

<table style="width: 100%;"><tr>
<td>checkVario</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Plot variogram fitted to data with support </h2>

<h3>Description</h3>

<p>The function will create diagnostic plots for analysis of the variograms fitted
to sample variograms of data with support
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'rtop'
checkVario(object, acor = 1, log = "xy", cloud = FALSE, 
           gDist = TRUE, acomp = NULL, curveSmooth = FALSE, params = list(), ...) 

## S3 method for class 'rtopVariogramModel'
checkVario(object, 
           sampleVariogram = NULL, observations = NULL, 
           areas = NULL, dists = NULL, acomp = NULL,  
           params = list(), compVars = list(), acor = 1, 
           log = "xy", legx = NULL, legy = NULL, 
           plotNugg = TRUE, curveSmooth = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>either: object of class <code>rtop</code> (see <code>rtop-package</code>), or an object of type <br><code>rtopVariogram</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acor</code></td>
<td>
<p>unit correction factor in the key, e.g. to see numbers more easily 
interpretable for large areas. As an example, ucor = 0.000001 when area
is given in square meters and should rather be shown as square kilometers.
Note that this parameter also changes the value of the nugget to the new unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>text variable for log-plots, default to log-log <code>"xy"</code>, can otherwise be set
to <code>"x"</code>, <code>"y"</code> or <code>""</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cloud</code></td>
<td>
<p>logical; whether to look at the cloud variogram instead of the binned variogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gDist</code></td>
<td>
<p>logical; whether to use ghosh-distance for semivariogram regularization instead of full integration of the semivariogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleVariogram</code></td>
<td>
<p>a sample variogram of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observations</code></td>
<td>
<p>a set of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>areas</code></td>
<td>
<p>either an array of areas that should be used as examples, or 
the number of areas per order of magnitude (similar to the parameter <code>amul</code>;
see <code>getRtopParams</code>. amul from <code>rtopObj</code>
or from the default parameter set will be used if not defined here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dists</code></td>
<td>
<p>either an array of distances that should be used as examples, or
the number of distances per order of magnitude(similar to the parameter <code>amul</code>;
see <code>getRtopParams</code>. amul from <code>rtopObj</code>
or from the default parameter set will be used if not defined here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acomp</code></td>
<td>
<p>either a matrix with the area bins that should be visualized, or a number 
giving the number of pairs to show. If a sample variogram is given, the <code>acomp</code>
pairs with highest number of pairs will be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curveSmooth</code></td>
<td>
<p>logical or numerical; describing whether the curves in the last plot should be smoothed or not. If numeric,
it gives the degrees of freedom (df) for the splines used for smoothing. See also <code>smooth.spline</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>list of parameters to modify the default parameters of rtopObj or 
the default parameters found from <code>getRtopParams</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compVars</code></td>
<td>
<p>a list of variograms of <code>gstat</code>-type for comparison, see 
<code>vgm</code>. The names of the variograms in the list will
be used in the key.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legx</code></td>
<td>
<p>x-coordinate of the legend for fine-tuning of position, see x-argument of <br><code>legend</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legy</code></td>
<td>
<p>y-coordinate of the legend for fine-tuning of position, see y-argument of <br><code>legend</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotNugg</code></td>
<td>
<p>logical; whether the nugget effect should be added to the plot or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to lower level functions</p>
</td>
</tr>
</table>
<h3>Value</h3>

 
<p>The function gives diagnostic plots for the fitted variograms, where the
regularized variograms are shown together with the sample variograms and 
possibly also user defined variograms. In addition, if an rtopObject
is submitted, the function will also give plots of the relationship between
variance and area size and a scatter plot of the fit of the observed and
regularized variogram values. The sizes of the dots are relative to the number
of pairs in each group.
</p>


<h3>Author(s)</h3>

<p> Jon Olav Skoien </p>


<h3>References</h3>

 
<p>Skoien J. O., R. Merz, and G. Bloschl. Top-kriging - geostatistics on stream networks.
Hydrology and Earth System Sciences, 10:277-287, 2006.
</p>
<p>Skoien, J. O., Bloschl, G., Laaha, G., Pebesma, E., Parajka, J., Viglione, A., 2014. Rtop: An R package for interpolation of data with a variable spatial support, with an example from river networks. Computers &amp; Geosciences, 67.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(gstat)
rpath = system.file("extdata",package="rtop")
library(sf)
observations = st_read(rpath, "observations")
predictionLocations = st_read(rpath,"predictionLocations")

# Create a column with the specific runoff:
observations$obs = observations$QSUMMER_OB/observations$AREASQKM
params = list(cloud = TRUE, gDist = TRUE)
rtopObj = createRtopObject(observations, predictionLocations, 
                           params = params)

# Fit a variogram (function also creates it)
rtopObj = rtopFitVariogram(rtopObj, maxn = 2000)
checkVario(rtopObj, 
    compVars = list(first = vgm(5e-6, "Sph", 30000,5e-8), 
                   second = vgm(2e-6, "Sph", 30000,5e-8)))

rtopObj = checkVario(rtopObj, acor = 0.000001, 
          acomp = data.frame(acl1 = c(2,2,2,2,3,3,3,4,4), 
          acl2 = c(2,3,4,5,3,4,5,4,5)))
rtopObj = checkVario(rtopObj, cloud = TRUE, identify = TRUE, 
          acor = 0.000001)

</code></pre>


</div>