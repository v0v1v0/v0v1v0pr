<div class="container">

<table style="width: 100%;"><tr>
<td>fit_coal_var</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit birth-death model using a coalescent approch
</h2>

<h3>Description</h3>

<p>Fits the expanding diversity model with potentially time-varying rates and potentially missing extant species to a phylogeny, by maximum likelihood. 
The implementation allows only exponential time variation of the speciation and extinction rates, although this could be modified using expressions in Morlon et al. PloSB 2010. Notations follow Morlon et al. PLoSB 2010.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_coal_var(phylo, lamb0 = 0.1, alpha = 1, mu0 = 0.01, beta = 0,
             meth = "Nelder-Mead", N0 = 0, cst.lamb = FALSE, cst.mu = FALSE,
             fix.eps = FALSE, mu.0 = FALSE, pos = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lamb0</code></td>
<td>

<p>initial value of the speciation rate at present (used by the optimization algorithm)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>initial value of the parameter controlling the exponential variation in speciation rate (used by the optimization algorithm)

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>

<p>initial value of the extinction rate at present (used by the optimization algorithm)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>initial value of the parameter controlling the exponential variation in extinction rate.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>

<p>optimization to use to maximize the likelihood function, see <em>optim</em> for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N0</code></td>
<td>

<p>Number of extant species.
With default value(0), N0 is set to the number of tips in the phylogeny. That is, the phylogeny is assumed to be 100% complete. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cst.lamb</code></td>
<td>

<p>logical: should be set to TRUE only if f.lamb is constant (i.e. does not depend on time, models 3, 4b &amp; 5 in Morlon et al. PloSB 2010) to use analytical instead of numerical computation in order to reduce computation time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cst.mu</code></td>
<td>

<p>logical: should be set to TRUE only if f.mu is constant (i.e. does not depend on time, models 3 &amp; 4a in Morlon et al. PloSB 2010) to use analytical instead of numerical computation in order to reduce computation time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.eps</code></td>
<td>

<p>logical: should be set to TRUE only if the extinction fraction is constant (i.e. does not depend on time, model 4c in Morlon et al. PloSB 2010)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.0</code></td>
<td>

<p>logical: should be set to TRUE to force the extinction rate to 0 (models 5 &amp; 6 in Morlon et al. PloSB 2010)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>

<p>logical: should be set to FALSE only to not enforce positive speciation and extinction rates
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function fits models 3 to 6 from the PloSB 2010 paper. Likelihoods arising from these models are computed using the coalescent approximation and are directly comparable to likelihoods from the fit_coal_cst function, thus allowing to test support for equilibrium versus expanding diversity scenarios.
</p>


<p>These models can be fitted using the options specified below:
</p>

<ul>
<li>
<p> model 3: 

with cst.lamb=TRUE &amp; cst.mu=TRUE
</p>
</li>
<li>
<p> model 4a: 

with cst.lamb=FALSE &amp; cst.mu=TRUE
</p>
</li>
<li>
<p> model 4b: 

with cst.lamb=TRUE &amp; cst.mu=FALSE
</p>
</li>
<li>
<p> model 4c: 

with cst.lamb=FALSE, cst.mu=FALSE &amp; fix.eps=TRUE
</p>
</li>
<li>
<p> model 4d: 

with cst.lamb=FALSE, cst.mu=FALSE &amp; fix.eps=FALSE
</p>
</li>
<li>
<p> model 5: 

with cst.lamb=TRUE &amp; mu.0=TRUE
</p>
</li>
<li>
<p> model 6: 

with cst.lamb=FALSE &amp; mu.0=TRUE
</p>
</li>
</ul>
<p>Time runs from the present to the past. Hence, if alpha is estimated to be positive (for example), this means that the speciation rate decreases from past to present. 
</p>


<h3>Value</h3>

<p>a list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the name of the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LH</code></td>
<td>
<p>the maximum log-likelihood value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aicc</code></td>
<td>
<p>the second order Akaike's Information Criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.parameters</code></td>
<td>
<p>the estimated parameters</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>H Morlon</p>


<h3>References</h3>

<p>Morlon, H., Potts, M.D., Plotkin, J.B. (2010) Inferring the dynamics of diversification: a coalescent approach, PLoS B 8(9): e1000493
</p>
<p>Morlon, H., Kemps, B., Plotkin, J.B., Brisson, D. (2012) Explosive radiation of a bacterial species group, Evolution, 66: 2577-2586
</p>
<p>Morlon, H. (2014) Phylogenetic approaches for studying diversification, Eco Lett, 17:508-525
</p>


<h3>See Also</h3>

<p><code>likelihood_coal_var</code>, <code>fit_coal_cst</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Cetacea)

if(test){
result &lt;- fit_coal_var(Cetacea, lamb0=0.01, alpha=-0.001, mu0=0.0, beta=0, N0=89)
print(result)
}
</code></pre>


</div>