<div class="container">

<table style="width: 100%;"><tr>
<td>bpcPca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principal component analysis based on backwards pivot coordinates</h2>

<h3>Description</h3>

<p>Performs classical or robust principal component analysis on system of backwards pivot coordinates and returns the result related to pairwise logratios as well as the clr representation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bpcPca(X, robust = FALSE, norm.cat = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>object of class data.frame. Positive values only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>if TRUE, the MCD estimate is used. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm.cat</code></td>
<td>
<p>the rationing category placed at the first position in the composition. If not defined, all pairwise logratios are considered. Given in quotation marks.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>bpcPca
</p>
<p>The compositional data set is repeatedly expressed in a set of backwards logratio coordinates, when each set highlights one pairwise logratio (or one pairwise logratio with the selected rationing category). 
For each set, robust or classical principal component analysis is performed and loadings respective to the first backwards pivot coordinate are stored. 
The procedure results in matrix of scores (invariant to the specific coordinate system), clr loading matrix and matrix with loadings respective to pairwise logratios.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>array of scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>loadings related to the pairwise logratios. The names of the rows indicate the type of the respective coordinate 
(bpc.1 - the first backwards pivot coordinate) and the logratio quantified thereby. 
E.g. bpc.1_C2.to.C1 would therefore correspond to the logratio between compositional parts C1 and C2, schematically written log(C2/C1). See Nesrstova et al. (2023) for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings.clr</code></td>
<td>
<p>loadings in the clr space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdev</code></td>
<td>
<p>standard deviations of the principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>means of the pairwise logratios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.clr</code></td>
<td>
<p>means of the clr coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.obs</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kamila Facevicova
</p>


<h3>References</h3>

<p>Hron, K., Coenders, G., Filzmoser, P., Palarea-Albaladejo, J., Famera, M., Matys Grygar, M. (2022). Analysing pairwise logratios revisited. Mathematical Geosciences 53, 1643 - 1666.
</p>
<p>Nesrstova, V., Jaskova, P., Pavlu, I., Hron, K., Palarea-Albaladejo, J., Gaba, A., Pelclova, J., Facevicova, K. (2023). Simple enough, but not simpler: Reconsidering additive logratio coordinates in compositional analysis. Submitted
</p>


<h3>See Also</h3>

<p><code>bpc</code> 
<code>bpcPcaTab</code>
<code>bpcReg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(arcticLake)

# classical estimation with all pairwise logratios:
res.cla &lt;- bpcPca(arcticLake)
summary(res.cla)
biplot(res.cla)
head(res.cla$scores)
res.cla$loadings
res.cla$loadings.clr

# similar output as from pca CoDa
res.cla2 &lt;- pcaCoDa(arcticLake, method="classical", solve = "eigen")
biplot(res.cla2)
head(res.cla2$scores)
res.cla2$loadings

# classical estimation focusing on pairwise logratios with clay:
res.cla.clay &lt;- bpcPca(arcticLake, norm.cat = "clay")
biplot(res.cla.clay)

# robust estimation with all pairwise logratios:
res.rob &lt;- bpcPca(arcticLake, robust = TRUE)
biplot(res.rob)

</code></pre>


</div>