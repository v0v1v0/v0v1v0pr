<div class="container">

<table style="width: 100%;"><tr>
<td>NBlevy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative Binomial Levy process</h2>

<h3>Description</h3>

<p>Negative Binomial Lévy process estimation from partial observations (counts)
</p>


<h3>Usage</h3>

<pre><code class="language-R">NBlevy(N,
       gamma = NA,
       prob = NA,
       w = rep(1, length(N)),
       sum.w = sum(w),
       interval = c(0.01, 1000),
       optim = TRUE,
       plot = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>Vector of counts, one count by time period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>The <code>gamma</code> parameter if known (NOT IMPLEMENTED YET).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>

<p>The <code>prob</code> parameter if known (NOT IMPLEMENTED YET).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>Vector of time length (durations).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum.w</code></td>
<td>

<p>NOT IMPLEMENTED YET. The effective duration. If <code>sum.w</code> is
strictly inferior to <code>sum(w)</code>, it is to be understood that
missing periods occur within the counts period. This can be taken
into account with a suitable algorithm (Expectation Maximisation,
etc.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>

<p>Interval giving min and max values for <code>gamma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>

<p>If <code>TRUE</code> a one-dimensional optimisation is used. Else the zero
of the derivative of the (concentrated) log-likelihood is searched
for.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Should a plot be drawn? <em>May be removed in the future</em>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The vector <code class="reqn">\mathbf{N}</code> contains counts for events occurring on
non-overlapping time periods with lengths given in
<code class="reqn">\mathbf{w}</code>.  Under the NB Lévy process
assumptions, the observed counts (i.e. elements of
<code class="reqn">\mathbf{N}</code>) are independent random variables, each following
a negative binomial distribution.  The size parameter <code class="reqn">r_k</code>
for <code class="reqn">N_k</code> is <code class="reqn">r_k = \gamma w_k</code> and
the probability parameter <code class="reqn">p</code> is <code>prob</code>.  The vector
<code class="reqn">\boldsymbol{\mu}</code> of the expected counts has elements
</p>
<p style="text-align: center;"><code class="reqn">\mu_k=\mathrm{E}(N_k)=\frac{1-p}{p} \,\gamma \,w_k.</code>
</p>

<p>The parameters <code class="reqn">\gamma</code> and <code class="reqn">p \:(\code{prob})</code>
are estimated by Maximum Likelihood using the likelihood concentrated
with respect to the <code>prob</code> parameter.
</p>


<h3>Value</h3>

<p>A list with the results
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>

<p>Parameter estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>

<p>Standard deviation for the estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>

<p>Score vector at the estimated parameter vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>

<p>Observed information matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>

<p>Covariance matrix (approx.).
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The Negative Binomial Lévy process is an alternative to
the Homogeneous Poisson Process when counts are subject to
overdispersion. In the NB process, all counts share the same index of
dispersion (variance/expectation ratio), namely <code>1/prob</code>. When
<code>prob</code> is close to 1, the counts are nearly Poisson-distributed.
</p>


<h3>Author(s)</h3>

<p>Yves Deville</p>


<h3>References</h3>

<p>Kozubowski T.J. and Podgórsky K. (2009)
"Distributional properties of the negative binomial Lévy process".
<em>Probability and Mathematical Statistics</em> <b>29</b>, pp. 43-71.
Lund University Publications.
</p>


<h3>See Also</h3>

<p><code>NegBinomial</code> for the negative binomial distribution,
<code>glm.nb</code> from the MASS package for fitting Generalised
Linear Model of the negative binomial family.</p>


<h3>Examples</h3>

<pre><code class="language-R">## known parameters
nint &lt;- 100
gam &lt;- 6; prob &lt;- 0.20

## draw random w, then the counts N
w &lt;- rgamma(nint, shape = 3, scale = 1/5)
N &lt;- rnbinom(nint, size = w * gam, prob = prob)
mu &lt;- w * gam * (1 - prob) / prob
Res &lt;- NBlevy(N = N, w = w)

## Use example data 'Brest'
## compute the number of event and duration of the non-skipped periods
gof1 &lt;- gof.date(date = Brest$OTdata$date,
                 skip = Brest$OTmissing,
                 start = Brest$OTinfo$start,
                 end = Brest$OTinfo$end,
                 plot.type = "omit")
ns1 &lt;- gof1$noskip
## fit the NBlevy
fit1 &lt;- NBlevy(N = ns1$nevt, w = ns1$duration)

## use a higher threshold
OT2 &lt;- subset(Brest$OTdata, Surge &gt; 50)
gof2 &lt;- gof.date(date = OT2$date,
                 skip = Brest$OTmissing,
                 start = Brest$OTinfo$start,
                 end = Brest$OTinfo$end,
                 plot.type = "omit")
ns2 &lt;- gof2$noskip
## the NBlevy prob is now closer to 1
fit2 &lt;- NBlevy(N = ns2$nevt, w = ns2$duration)

c(fit1$prob, fit2$prob)
</code></pre>


</div>