<div class="container">

<table style="width: 100%;"><tr>
<td>post_RA_fits</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Posterior reference analysis based on bayesmeta fits

</h2>

<h3>Description</h3>

<p>Computes a table of Hellinger distances between marginal posterior distributions
for different parameters in the NNHM
between the actual model fits in <code>fits.actual</code> and
the benchmark fits in <code>fits.bm</code>.
All fits should be based on the same data set.

</p>


<h3>Usage</h3>

<pre><code class="language-R">post_RA_fits(fits.actual, fits.bm,
             H.dist.method = "integral")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fits.actual</code></td>
<td>

<p>a list of model fits of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fits.bm</code></td>
<td>

<p>a list of model fits of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
To be used as benchmarks.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.dist.method</code></td>
<td>

<p>method for computation of Hellinger distances between marginal posterior densities. Either <code>"integral"</code> for integral-based computation or <code>"moment"</code> for approximate moment-based calculation using a normal approximation. Defaults to <code>"integral"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two alternative suggestions for posterior benchmarks are provided
in Ott et al. (2021, Section 3.4) and its Supplementary Material (Section 2.5) and they
can be computed using the functions <code>fit_models_RA</code> and <code>fit_models_RA_5bm</code>,
respectively.
</p>
<p>If integral-based computation (<code>H.dist.method = "integral"</code>) of Hellinger distances is selected (the default), numerical integration is applied to obtain the Hellinger distance between the two marginal posterior densities (by using the function <code>H</code>).
If moment-based computation (<code>H.dist.method = "moment"</code>) is selected, the marginal densities are first approximated by normal densities with the same means and standard deviations and then the Hellinger distance between these normal densities can be obtained by an analytical formula (implemented in the function <code>H_normal</code>).
</p>


<h3>Value</h3>

<p>A matrix of Hellinger distance estimates between marginal posteriors
with <code class="reqn">n.bm</code> columns and <code class="reqn">n.act*(k+3)</code> rows,
where <code class="reqn">n.bm</code>=length(<code>fits.bm</code>) is the number of benchmark fits specified,
<code class="reqn">n.act</code>=length(<code>fits.actual</code>) the number of actual fits specified
and
<code class="reqn">k</code> the number of studies in the meta-analysis data set
(so that there are <code class="reqn">k+3</code> parameters <code class="reqn">\Psi \in \{ \mu, \tau, \theta_1, ..., \theta_k, \theta_{new}  \}</code> of potential interest in the NNHM).
</p>
<p>The columns of the matrix give the following Hellinger distance estimates
between two marginal posteriors (for the parameter of interest <code class="reqn">\Psi</code> varying with rows)
induced by the following two heterogeneity priors
(from left to right):
</p>

<dl>
<dt>
<code>H(po_{bm_1}, po_act)</code>:</dt>
<dd>
<p> first benchmark prior bm_1 inducing the fit <code>fits.bm[[1]]</code> and actual prior</p>
</dd>
<dt>
<code>H(po_{bm_2}, po_act)</code>:</dt>
<dd>
<p> second benchmark prior bm_2 inducing the fit <code>fits.bm[[2]]</code> and actual prior</p>
</dd>
<dt>... </dt>
<dd>
<p> ... </p>
</dd>
<dt>
<code>H(po_{bm_{n.bm}}, po_act)</code>:</dt>
<dd>
<p> last benchmark prior bm_n.bm inducing the fit <code>fits.bm[[n.bm]]</code> and actual prior</p>
</dd>
</dl>
<p>The actual heterogenity prior and the parameter of interest <code class="reqn">\Psi</code> vary
with the rows in the following order:
</p>

<dl>
<dt>
<code>mu, pri_act_1</code>:</dt>
<dd> <p><code class="reqn">\Psi=\mu</code> and first actual prior in <code>tau.prior</code></p>
</dd>
<dt>
<code>mu, pri_act_2</code>:</dt>
<dd> <p><code class="reqn">\Psi=\mu</code> and second actual prior in <code>tau.prior</code></p>
</dd>
<dt>... </dt>
<dd>
<p> ...</p>
</dd>
<dt>
<code>mu, pri_act_n</code>:</dt>
<dd> <p><code class="reqn">\Psi=\mu</code> and nth actual prior in <code>tau.prior</code></p>
</dd>
<dt>
<code>tau, pri_act_1</code>:</dt>
<dd> <p><code class="reqn">\Psi=\tau</code> and first actual prior in <code>tau.prior</code></p>
</dd>
<dt>... </dt>
<dd>
<p> ...</p>
</dd>
<dt>
<code>tau, pri_act_n</code>:</dt>
<dd> <p><code class="reqn">\Psi=\tau</code> and nth actual prior</p>
</dd>
<dt>
<code>theta_1, pri_act_1</code>:</dt>
<dd> <p><code class="reqn">\Psi=\theta_1</code> and first actual prior</p>
</dd>
<dt>... </dt>
<dd>
<p> ...</p>
</dd>
<dt>
<code>theta_k, pri_act_n</code>:</dt>
<dd> <p><code class="reqn">\Psi=\theta_k</code> and nth actual prior</p>
</dd>
<dt>
<code>theta_new, pri_act_1</code>:</dt>
<dd> <p><code class="reqn">\Psi=\theta_{new}</code> and first actual prior</p>
</dd>
<dt>... </dt>
<dd>
<p> ...</p>
</dd>
<dt>
<code>theta_new, pri_act_n</code>:</dt>
<dd> <p><code class="reqn">\Psi=\theta_{new}</code> and nth actual prior</p>
</dd>
</dl>
<h3>Warning </h3>

<p>If the integral-based method is used to compute Hellinger distances (<code>H.dist.method = "integral"</code>),
numerical problems may occur in some cases, which may lead to implausible outputs.
Therefore, we generally recommend to double-check the results of the integral-based method using the moment-based method (<code>H.dist.method = "moment"</code>) - especially if the former results are implausibe. If large differences between the two methods are observed, we recommend to rely on the moment-based method unless a normal approximation of the involved densities is inappropriate.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505â€“4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code>bayesmeta</code> in the package bayesmeta,
<code>fit_models_RA</code>,
<code>post_RA</code>,
<code>pri_RA_fits</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># for aurigular acupuncture (AA) data set
data(aa)
 # compute the model fits  % this example takes &gt; 5 sec. to run
# actual standard half-normal and half-Cauchy heterogeneity priors
fits &lt;- fit_models_RA(df=aa, tau.prior=
                             list(function(t)dhalfnormal(t, scale=1),
                                  function(t)dhalfcauchy(t, scale=1)))
# benchmark fits under HN0 and J (Jeffreys) priors
fits.bm.post &lt;- fits[c(1,2)]
fits.actual &lt;- fits[c(3,4)]
post_RA_fits(fits.actual=fits.actual, fits.bm=fits.bm.post)

</code></pre>


</div>