<div class="container">

<table style="width: 100%;"><tr>
<td>labkey.insertRows</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Insert new rows of data into a LabKey Server</h2>

<h3>Description</h3>

<p>Insert new rows of data into the database.
</p>


<h3>Usage</h3>

<pre><code class="language-R">labkey.insertRows(baseUrl, folderPath,
    schemaName, queryName, toInsert, na,
    provenanceParams=NULL, options=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>baseUrl</code></td>
<td>
<p>a string specifying the <code>baseUrl</code>for the labkey server</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folderPath</code></td>
<td>
<p>a string specifying the <code>folderPath</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>schemaName</code></td>
<td>
<p>a string specifying the  <code>schemaName</code> for the query</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>queryName</code></td>
<td>
<p>a string specifying the  <code>queryName</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toInsert</code></td>
<td>
<p>a data frame containing rows of data to be inserted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na</code></td>
<td>
<p>(optional) the value to convert NA's to, defaults to NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>provenanceParams</code></td>
<td>
<p>the provenance parameter object which contains the options to include as part of a provenance recording.
This is a premium feature and requires the Provenance LabKey module to function correctly, if it is not present this parameter will be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>(optional) a list containing options specific to the insert action of the query</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A single row or multiple rows of data can be inserted.  The <code>toInsert</code> data frame must contain
values for each column in the dataset and must be created with the <code>stringsAsFactors</code> option
set to FALSE. The names of the data in the data frame must be the column names from the
LabKey Server.To insert a value of NULL, use an empty string ("") in the data frame (regardless of the database column type). 
Also, when inserting data into a study dataset, the sequence number must be specified.
<br><br>
The list of valid options for each query will vary, but some common examples include:
</p>

<ul>
<li> <p><code>auditBehavior (string)</code> : Can be used to override the audit behavior for the table the query is acting on.
The set of types include: NONE, SUMMARY, and DETAILED.
</p>
</li>
<li> <p><code>auditUserComment (string)</code> : Can be used to provide a comment from the user that will be attached to
certain detailed audit log records.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list is returned with named categories of <b>command</b>, <b>rowsAffected</b>, <b>rows</b>, <b>queryName</b>, <b>containerPath</b> and <b>schemaName</b>.
The <b>schemaName</b>, <b>queryName</b> and <b>containerPath</b> properties contain the same schema, query 
and folder path used in the request.  The
<b>rowsAffected</b> property indicates the number of rows affected by the API action. This will typically be the same
number as passed in the request. The <b>rows</b> property contains a list of row objects corresponding to the rows 
inserted.
</p>


<h3>Author(s)</h3>

<p>Valerie Obenchain</p>


<h3>See Also</h3>

<p><code>labkey.selectRows</code>, <code>labkey.executeSql</code>, <code>makeFilter</code>, 
<code>labkey.importRows</code>, <code>labkey.updateRows</code>, <br><code>labkey.deleteRows</code>, <code>labkey.moveRows</code>, <br><code>labkey.query.import</code>,
<code>labkey.provenance.createProvenanceParams</code>,
<code>labkey.provenance.startRecording</code>,
<code>labkey.provenance.addRecordingStep</code>,
<code>labkey.provenance.stopRecording</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

## Insert, update and delete
## Note that users must have the necessary permissions in the database
## to be able to modify data through the use of these functions
# library(Rlabkey)

newrow &lt;- data.frame(
	DisplayFld="Inserted from R"
	, TextFld="how its done"
	, IntFld= 98 
	, DoubleFld = 12.345
	, DateTimeFld = "03/01/2010"
	, BooleanFld= FALSE
	, LongTextFld = "Four score and seven years ago"
#	, AttachmentFld = NA    #attachment fields not supported 
	, RequiredText = "Veni, vidi, vici"
	, RequiredInt = 0
	, Category = "LOOKUP2"
	, stringsAsFactors=FALSE)

insertedRow &lt;- labkey.insertRows("http://localhost:8080/labkey",
    folderPath="/apisamples", schemaName="lists", queryName="AllTypes",
    toInsert=newrow, options=list(auditBehavior="DETAILED",
    auditUserComment="testing audit comment for insert"))
newRowId &lt;- insertedRow$rows[[1]]$RowId

selectedRow&lt;-labkey.selectRows("http://localhost:8080/labkey",
    folderPath="/apisamples", schemaName="lists", queryName="AllTypes",
    colFilter=makeFilter(c("RowId", "EQUALS", newRowId)))
updaterow=data.frame(
	RowId=newRowId
	, DisplayFld="Updated from R"
	, TextFld="how to update"
	, IntFld= 777 
	, stringsAsFactors=FALSE)

updatedRow &lt;- labkey.updateRows("http://localhost:8080/labkey",
    folderPath="/apisamples", schemaName="lists", queryName="AllTypes",
    toUpdate=updaterow, options=list(auditBehavior="DETAILED",
    auditUserComment="testing audit comment for update"))
selectedRow&lt;-labkey.selectRows("http://localhost:8080/labkey",
    folderPath="/apisamples", schemaName="lists", queryName="AllTypes",
    colFilter=makeFilter(c("RowId", "EQUALS", newRowId)))

deleterow &lt;- data.frame(RowId=newRowId, stringsAsFactors=FALSE)
result &lt;- labkey.deleteRows(baseUrl="http://localhost:8080/labkey",
    folderPath="/apisamples", schemaName="lists", queryName="AllTypes",
    toDelete=deleterow)

## Example of creating a provenance run with an initial step with material inputs, a second step
## with provenance mapping to link existing samples with newly inserted samples, and a final step
## with a data output
##
mi &lt;- data.frame(lsid=c("urn:lsid:labkey.com:Sample.251.MySamples:sample1",
        "urn:lsid:labkey.com:Sample.251.MySamples:sample2"))
p &lt;- labkey.provenance.createProvenanceParams(name="step1", description="initial step",
        materialInputs=mi)
ra &lt;- labkey.provenance.startRecording(baseUrl="https://labkey.org/labkey/",
        folderPath = "Provenance", provenanceParams=p)

rows &lt;- fromJSON(txt='[{
        "name" : "sample3",
        "protein" : "p3",
        "prov:objectInputs" : [
            "urn:lsid:labkey.com:Sample.251.MySamples:sample21",
            "urn:lsid:labkey.com:Sample.251.MySamples:sample22"
        ]
    },{
        "name" : "sample4",
        "protein" : "p4",
        "prov:objectInputs" : [
            "urn:lsid:labkey.com:Sample.251.MySamples:sample21",
            "urn:lsid:labkey.com:Sample.251.MySamples:sample22"
        ]
    }
]')

labkey.insertRows(baseUrl="https://labkey.org/labkey/", folderPath = "Provenance",
    schemaName="samples", queryName="MySamples", toInsert=rows,
    provenanceParams=labkey.provenance.createProvenanceParams(name="query step",
        recordingId=ra$recordingId))
labkey.provenance.stopRecording(baseUrl="https://labkey.org/labkey/", folderPath = "Provenance",
    provenanceParams=labkey.provenance.createProvenanceParams(name="final step",
    recordingId=ra$recordingId, dataOutputs=do))

## End(Not run)
</code></pre>


</div>