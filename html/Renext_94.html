<div class="container">

<table style="width: 100%;"><tr>
<td>RLplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return level plot</h2>

<h3>Description</h3>

<p>Return level plot for "Renouvellement" data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RLplot(data,
       x = NULL,
       duration = 1,
       lambda,
       conf.pct = 95,
       mono = TRUE,
       mark.rl = 100,
       mark.labels = mark.rl,
       mark.col = NULL,
       main = NULL,
       ylim = NULL,
          ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data.frame object with a column named <code>quant</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Optional vector of observed levels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>

<p>The (effective) duration corresponding to <code>x</code> if
this argument is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Rate, with unit inverse of that used for <code>duration</code>, e.g. in
inverse years when <code>duration</code> is in years.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.pct</code></td>
<td>

<p>Vector (character or integer) giving confidence levels. See
<b>Details</b> below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mono</code></td>
<td>

<p>If <code>TRUE</code> colours are replaced by black.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark.rl</code></td>
<td>

<p>Return levels to be marked on the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark.labels</code></td>
<td>

<p>Labels shown at positions in <code>mark.rl</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark.col</code></td>
<td>

<p>Colours for marked levels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Main title for the return level plot (defaults to empty title).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>Limits for the y axis (defaults to values computed from the data).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further args to be passed to <code>plot</code>. Should be removed in
future versions.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Percents should match column names in the data.frame as follows. The
upper and lower limits are expected to be <code>U.95</code> and <code>L.95</code>
respectively. For a <code>70%</code> confidence percentage, columns should
have names <code>"U.70"</code> and <code>"L.70"</code>.
</p>
<p>The plot is comparable to the return level described in Coles'book and
related packages, but the return level is here in log-scale while
Coles uses a loglog-scale. A line corresponds here to a one parameter
exponential distribution, while Coles'plot corresponds to Gumbel,
however the two plots differ only for small return periods.  This plot
is identical to an <code>expplot</code> but with x and y scales changed:
only axis tick-marks differ. The convexity of the scatter plot is
therefore opposed in the two plots.
</p>


<h3>Note</h3>

<p>Confidence limits correspond to <em>two-sided symmetrical
intervals</em>. This means that the (random) confidence interval may be
under or above the true unknown value with the same
probabilities. E.g. the probability that the unknown quantile falls
above <code>U.95</code> is <code>2.5%</code>. The two bounds are yet generally
not symmetrical with respect to <code>quant</code>; such a behaviour follows
from the use of "delta" method for approximate intervals.
</p>
<p>It is possible to add graphical material (points, lines) to this plot
using <code>log(returnlev)</code> and <code>quantile</code> coordinates. See
<b>Examples</b> section.
</p>


<h3>Author(s)</h3>

<p>Yves Deville</p>


<h3>References</h3>

<p>Coles S. (2001)  <em>Introduction to Statistical Modelling
of Extremes Values</em>, Springer.
</p>


<h3>See Also</h3>

<p>See <code>expplot</code> for a classical exponential plot.  See Also
as <code>Renouv</code> to fit "Renouvellement" models. The
<code>return.level</code> function in the <code>extRemes</code> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Typical probability vector
prob &lt;- c(0.0001,
  seq(from = 0.01, to = 0.09, by = 0.01),
  seq(from = 0.10, to = 0.80, by = 0.10),
  seq(from = 0.85, to = 0.99, by = 0.01),
  0.995, 0.996, 0.997, 0.998, 0.999, 0.9995)

## Model parameters rate = #evts by year, over nyear
lambda &lt;- 4
nyear &lt;- 30
theta.x &lt;- 4

## draw points
n.x &lt;- rpois(1, lambda = lambda*nyear)
x &lt;- rexp(n.x, rate = 1/theta.x)

## ML estimation (exponential)
lambda.hat &lt;- n.x / nyear
theta.x.hat &lt;- mean(x)
  
## Compute bounds (here exact)
alpha &lt;- 0.05

quant &lt;- qexp(p = prob, rate = 1/theta.x.hat) 

theta.L &lt;- 2*n.x*theta.x.hat / qchisq(1 - alpha/2, df = 2*n.x)
theta.U &lt;- 2*n.x*theta.x.hat / qchisq(alpha/2, df = 2*n.x)

L.95 &lt;- qexp(p = prob, rate = 1/theta.L) 
U.95 &lt;- qexp(p = prob, rate = 1/theta.U) 

## store in data.frame object
data &lt;- data.frame(prob = prob, quant = quant, L.95 = L.95, U.95 = U.95)

RLplot(data = data, x = x, lambda = lambda.hat,
       duration = nyear,
       main = "Poisson-exponential return levels")

RLplot(data = data, x = x, lambda = lambda.hat, duration = nyear,
       mark.rl = 10, mark.labels = "10 ans", mono = FALSE, mark.col = "SeaGreen",
       main = "Poisson-exponential return levels")

points(x = log(50), y = 25, pch = 18, cex = 1.4, col = "purple") 
text(x = log(50), y = 25, col ="purple", pos = 4, labels = "special event") 

</code></pre>


</div>