<div class="container">

<table style="width: 100%;"><tr>
<td>returnlevelplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Methods for Function returnlevelplot in Package ‘RobAStBase’</h2>

<h3>Description</h3>

<p>We generalize function <code>returnlevelplot</code> from package <span class="pkg">distrMod</span> to
be applicable to distribution and probability model objects. In this context,
<code>returnlevelplot</code> produces a rescaled QQ plot of data (argument <code>x</code>)
against a (model) distribution. For arguments <code>y</code> of class <code>RobModel</code>,
points at a high “distance” to the model
are plotted smaller. For arguments <code>y</code> of class <code>kStepEstimate</code>,
points at with low weight in the [p]IC are plotted bigger and their
color gets faded out slowly. This parallels the behaviour of the respective
<code>qqplot</code> methods.
Graphical parameters may be given as arguments to <code>returnlevelplot</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">returnlevelplot(x, y, ...)
## S4 method for signature 'ANY,RobModel'
returnlevelplot(x, y,
   n = length(x), withIdLine = TRUE, withConf = TRUE,
   withConf.pw  = withConf,  withConf.sim = withConf,
    plot.it = TRUE, xlab = deparse(substitute(x)),
    ylab = deparse(substitute(y)), ..., distance = NormType(),
    n.adj = TRUE)
## S4 method for signature 'ANY,InfRobModel'
returnlevelplot(x, y, n = length(x), withIdLine = TRUE,
withConf = TRUE, withConf.pw = withConf, withConf.sim = withConf,
  plot.it = TRUE, xlab = deparse(substitute(x)), ylab =
  deparse(substitute(y)), ..., cex.pts.fun = NULL, n.adj = TRUE)
## S4 method for signature 'ANY,kStepEstimate'
returnlevelplot(x, y,
   n = length(x), withIdLine = TRUE, withConf = TRUE,
   withConf.pw  = withConf,  withConf.sim = withConf,
    plot.it = TRUE, xlab = deparse(substitute(x)),
    ylab = deparse(substitute(y)), ...,
    exp.cex2.lbs = -.15,
    exp.cex2.pts = -.35,
    exp.fadcol.lbs = 1.85,
    exp.fadcol.pts = 1.85,
    bg = "white")
   </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data to be checked for compatibility with distribution/model <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>object of class <code>"RobModel"</code>, of class <code>"InfRobModel"</code> or of
class <code>"kStepEstimate"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric; number of quantiles at which to do the comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withIdLine</code></td>
<td>
<p>logical; shall line <code>y = x</code> be plotted in?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf</code></td>
<td>
<p>logical; shall confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf.pw</code></td>
<td>
<p>logical; shall pointwise confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf.sim</code></td>
<td>
<p>logical; shall simultaneous confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>logical; shall be plotted at all (inherited from
<code>returnlevelplot</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters for method <code>returnlevelplot</code> with signature
<code>ANY,ProbFamily</code> (see <code>returnlevelplot</code>) or with function
<code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pts.fun</code></td>
<td>
<p>rescaling function for the size of the points to be plotted;
either <code>NULL</code> (default), then <code>log(1+abs(x))</code> is used,
or a function which is then used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.adj</code></td>
<td>
<p>logical; shall sample size be adjusted for possible outliers according
to radius of the corresponding neighborhood?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>a function mapping observations <code>x</code> to the positive reals;
used to determine the size of the plotted points (the larger <code>distance(x)</code>,
the smaller the points are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp.cex2.lbs</code></td>
<td>
<p>for objects <code>kStepEstimate</code> based on a [p]IC of class <code>HampIC</code>:
exponent for the weights of this [p]IC used to magnify the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp.cex2.pts</code></td>
<td>
<p>for objects <code>kStepEstimate</code> based on a [p]IC of class <code>HampIC</code>:
exponent for the weights of this [p]IC used to magnify the symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp.fadcol.lbs</code></td>
<td>
<p>for objects <code>kStepEstimate</code> based on a [p]IC of class <code>HampIC</code>:
exponent for the weights of this [p]IC used to find out-fading colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp.fadcol.pts</code></td>
<td>
<p>for objects <code>kStepEstimate</code> based on a [p]IC of class <code>HampIC</code>:
exponent for the weights of this [p]IC used to find out-fading colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>background color to fade against</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>returnlevelplot</dt>
<dd>
<p><code>signature(x = "ANY", y = "RobModel")</code>:
produces a QQ plot of a dataset <code>x</code> against the theoretical
quantiles of distribution of robust model <code>y</code>.</p>
</dd>
<dt>returnlevelplot</dt>
<dd>
<p><code>signature(x = "ANY", y = "InfRobModel")</code>:
produces a QQ plot of a dataset <code>x</code> against the theoretical
quantiles of distribution of infinitesimally robust model <code>y</code>.</p>
</dd>
<dt>returnlevelplot</dt>
<dd>
<p><code>signature(x = "ANY", y = "kStepEstimate")</code>:
produces a QQ plot of a dataset <code>x</code> against the theoretical
quantiles of the model distribution of model at which
the corresponding <code>kStepEstimate</code> <code>y</code> had been calibrated at.
By default, if the [p]IC of the <code>kStepEstimate</code> is of class
<code>HampIC</code>, i.e.; has a corresponding weight function,
points (and, if <code>withLab==TRUE</code>, labels) are
scaled and faded according to this weight function. Corresponding
arguments <code>exp.cex2.pts</code> and <code>exp.fadcol.pts</code> control this
scaling and fading, respectively
(and analogously <code>exp.cex2.lbs</code> and <code>exp.fadcol.lbs</code> for the labels).
The choice of these arguments has to be done on a case-by-case basis.
Positive exponents induce fading, magnification with increasing weight,
for negative exponents the same is true for decreasing weight; higher
(absolute) values increase the speed of fading / magnification.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>As for function <code>returnlevelplot</code> from package <span class="pkg">stats</span>.
</p>


<h3>Note</h3>

<p>The confidence bands given in our version of the return level plot differ
from the ones given in package <span class="pkg">ismev</span>. We use non-parametric bands,
hence also allow for non-parametric deviances from the model, whereas in
in package <span class="pkg">ismev</span> they are based on profiling, hence only check for
variability within the parametric class.
</p>


<h3>Author(s)</h3>

<p>Peter Ruckdeschel <a href="mailto:peter.ruckdeschel@uni-oldenburg.de">peter.ruckdeschel@uni-oldenburg.de</a>
</p>


<h3>References</h3>

<p>ismev: An   Introduction to Statistical Modeling of Extreme Values. R package
version 1.39. https://CRAN.R-project.org/package=ismev; original S functions
written by Janet E. Heffernan with R port and R documentation provided by
Alec G. Stephenson. (2012).
</p>
<p>Coles, S. (2001). <em>An introduction
to statistical modeling of extreme values.</em> London: Springer.
</p>


<h3>See Also</h3>

<p><code>qqplot</code> from package <span class="pkg">stats</span> – the standard QQ plot
function,  <code>returnlevelplot</code> from package <span class="pkg">distrMod</span> (which
is called intermediately by this method), as well as
<code>qqbounds</code>, used by <code>returnlevelplot</code> to produce confidence
intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R">returnlevelplot(rnorm(40, mean = 15, sd = sqrt(30)), Chisq(df=15))
RobM &lt;- InfRobModel(center = NormLocationFamily(mean=13,sd=sqrt(28)),
                    neighbor = ContNeighborhood(radius = 0.4))

## \donttest to reduce check time
x &lt;- rnorm(20, mean = 15, sd = sqrt(30))
returnlevelplot(x, RobM)
returnlevelplot(x, RobM, alpha.CI=0.9, add.points.CI=FALSE)

## further examples for ANY,kStepEstimator-method
## in example to roptest() in package ROptEst
</code></pre>


</div>