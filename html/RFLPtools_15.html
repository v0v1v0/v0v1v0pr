<div class="container">

<table style="width: 100%;"><tr>
<td>RFLPdist2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute distances for RFLP data.
</h2>

<h3>Description</h3>

<p>If gel image quality is low, faint bands may be disregarded and 
may lead to wrong conclusions. This function computes the distance 
between the molecular weights of RFLP samples, including samples 
containing one or more additional bands. Thus, failures during 
band detection could be identified. Visualisation of band patterns 
using this method can be done by <code>RFLPplot</code> using the 
argument <code>nrMissing</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RFLPdist2(x, distfun = dist, nrBands, nrMissing, LOD = 0,
          diag = FALSE, upper = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data.frame with RFLP data; see <code>RFLPdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distfun</code></td>
<td>
<p> function computing the distance with default <code>dist</code>;
cf. <code>dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrBands</code></td>
<td>
<p> samples with number of bands equal to <code>nrBands</code> are to be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrMissing</code></td>
<td>
<p> number of bands that might be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LOD</code></td>
<td>
<p> threshold for low-bp bands. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p> see <code>dist</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p> see <code>dist</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a given number of bands the given distance between the molecular weights
is computed. It is assumed that a number of bands might be missing. Hence
all samples with number of bands in nrBands, nrBands+1, ..., nrBands+nrMissing
are compared. 
</p>
<p>If <code>LOD &gt; 0</code> is specified, it is assumed that missing bands can only occur for
molecular weights smaller than <code>LOD</code>. As a consequence only samples which 
have <code>nrBands</code> bands with molecular weight larger or equal to <code>LOD</code> are
selected.
</p>
<p>For computing the distance between the molecular weight of a sample S1 with x bands 
and a Sample S2 with x+y bands the distances between the molecular weight of sample S1
and the molecular weight of all possible subsets of S2 with x bands are computed.
The distance between S1 and S2 is then defined as the minimum of all these distances.
</p>
<p>If <code>LOD &gt; 0</code> is specified, only all combinations of values below <code>LOD</code> are 
considered.
</p>
<p>This option may be useful, if gel image quality is low, and the detection of bands 
is doubtful.
</p>


<h3>Value</h3>

<p>An object of class <code>"dist"</code> returned; cf. <code>dist</code>.
</p>


<h3>Author(s)</h3>

 
<p>Fabienne Flessa <a href="mailto:Fabienne.Flessa@uni-bayreuth.de">Fabienne.Flessa@uni-bayreuth.de</a>,<br>
Alexandra Kehl <a href="mailto:Alexandra.Kehl@uni-tuebingen.de">Alexandra.Kehl@uni-tuebingen.de</a>,<br>
Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a> 
</p>


<h3>References</h3>

<p>Flessa, F., Kehl, A., Kohl, M.
Analysing diversity and community structures using PCR-RFLP: a new software application.
Molecular Ecology Resources 2013 Jul; 13(4):726-33. 
</p>
<p>Ian A. Dickie, Peter G. Avis, David J. McLaughlin, Peter B. Reich. 
Good-Enough RFLP Matcher (GERM) program.
Mycorrhiza 2003, 13:171-172.
</p>


<h3>See Also</h3>

 <p><code>RFLPdata</code>, <code>nrBands</code>, <code>RFLPdist</code>, <code>dist</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Euclidean distance
data(RFLPdata)
nrBands(RFLPdata)
res0 &lt;- RFLPdist(RFLPdata, nrBands = 4)
res1 &lt;- RFLPdist2(RFLPdata, nrBands = 4, nrMissing = 1)
res2 &lt;- RFLPdist2(RFLPdata, nrBands = 4, nrMissing = 2)
res3 &lt;- RFLPdist2(RFLPdata, nrBands = 4, nrMissing = 3)

## assume missing bands only below LOD
res1.lod &lt;- RFLPdist2(RFLPdata, nrBands = 4, nrMissing = 1, LOD = 60)

## hierarchical clustering
par(mfrow = c(2,2))
plot(hclust(res0), main = "0 bands missing")
plot(hclust(res1), main = "1 band missing")
plot(hclust(res2), main = "2 bands missing")
plot(hclust(res3), main = "3 bands missing")

## missing bands only below LOD
par(mfrow = c(1,2))
plot(hclust(res0), main = "0 bands missing")
plot(hclust(res1.lod), main = "1 band missing below LOD")

## Similarity matrix
library(MKomics)
myCol &lt;- colorRampPalette(brewer.pal(8, "RdYlGn"))(128)
ord &lt;- order.dendrogram(as.dendrogram(hclust(res1)))
temp &lt;- as.matrix(res1)
simPlot(temp[ord,ord], col = rev(myCol), minVal = 0, 
        labels = colnames(temp), title = "(Dis-)Similarity Plot")

## missing bands only below LOD
ord &lt;- order.dendrogram(as.dendrogram(hclust(res1.lod)))
temp &lt;- as.matrix(res1.lod)
simPlot(temp[ord,ord], col = rev(myCol), minVal = 0, 
        labels = colnames(temp), title = "(Dis-)Similarity Plot\n1 band missing below LOD")


## or
library(lattice)
levelplot(temp[ord,ord], col.regions = rev(myCol),
          at = do.breaks(c(0, max(temp)), 128),
          xlab = "", ylab = "",
          ## Rotate label of x axis
          scales = list(x = list(rot = 90)),
          main = "(Dis-)Similarity Plot")


## Other distances
res11 &lt;- RFLPdist2(RFLPdata, distfun = function(x) dist(x, method = "manhattan"),
                 nrBands = 4, nrMissing = 1)
res12 &lt;- RFLPdist2(RFLPdata, distfun = corDist, nrBands = 4, nrMissing = 1)
res13 &lt;- RFLPdist2(RFLPdata, distfun = corDist, nrBands = 4, nrMissing = 1, LOD = 60)
par(mfrow = c(2,2))
plot(hclust(res1), main = "Euclidean distance\n1 band missing")
plot(hclust(res11), main = "Manhattan distance\n1 band missing")
plot(hclust(res12), main = "Pearson correlation distance\n1 band missing")
plot(hclust(res13), main = "Pearson correlation distance\n1 band missing below LOD")
</code></pre>


</div>