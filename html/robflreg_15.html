<div class="container">

<table style="width: 100%;"><tr>
<td>rob.sf.reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust scalar-on-function regression</h2>

<h3>Description</h3>

<p>This function is used to perform both classical and robust scalar-on-function regression model </p>
<p style="text-align: center;"><code class="reqn">
Y = \sum_{m=1}^M \int X_m(s) \beta_m(s) ds + X.scl \gamma + \epsilon,</code>
</p>
<p> where <code class="reqn">Y</code> denotes the scalar response, <code class="reqn">X_m(s)</code> denotes the <code class="reqn">m</code>-th functional predictor, <code class="reqn">\beta_m(s)</code> denotes the <code class="reqn">m</code>-th regression coefficient function, <code class="reqn">X.scl</code> denotes the matrix of scalar predictors, <code class="reqn">\gamma</code> denotes the vector of coefficients for the scalar predictors' matrix, and <code class="reqn">\epsilon</code> is the error function, which is assumed to follow standard normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rob.sf.reg(Y, X, X.scl = NULL, emodel = c("classical", "robust"),
fmodel = c("LTS", "MM", "S", "tau"), nbasis = NULL, gp = NULL, ncomp = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>An <code class="reqn">n \times 1</code>-dimensional matrix containing the observations of scalar response <code class="reqn">Y</code>, where <code class="reqn">n</code> denotes the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A list consisting of <code class="reqn">M</code> functional predictors <code class="reqn">X_m(s), 1\le m\le M</code>. Each element of <code>X</code> is an <code class="reqn">n \times p_m</code>-dimensional matrix containing the observations of <code class="reqn">m</code>-th functional predictor <code class="reqn">X_m(s)</code>, where <code class="reqn">n</code> is the sample size and <code class="reqn">p_m</code> denotes the number of grid points for <code class="reqn">X_m(s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.scl</code></td>
<td>
<p>An <code class="reqn">n \times R</code>-dimensional matrix consisting of scalar predictors <code class="reqn">X_r, 1\le r\le R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emodel</code></td>
<td>
<p>Method to be used for functional principal component decomposition. Possibilities are "classical"" and "robust".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmodel</code></td>
<td>
<p>Fitting model used to estimate the function-on-function regression model. Possibilities are "LTS", "MM", "S", and "tau".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>A vector with length <code class="reqn">M</code>. Its <code class="reqn">m</code>-th value denotes the number of B-spline basis expansion functions to be used to approximate the functional principal components for the <code class="reqn">m</code>-th functional predictor <code class="reqn">X_m(s)</code>. If <code>NULL</code>, then, <code class="reqn">min(20, p_m/4)</code> number of B-spline basis expansion functions are used for each functional predictor, where <code class="reqn">p_m</code> denotes the number of grid points for <code class="reqn">X_m(s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp</code></td>
<td>
<p>A list with length <code class="reqn">M</code>. The <code class="reqn">m</code>-th element of <code>gp</code> is a vector containing the grid points of the <code class="reqn">m</code>-th functional predictor <code class="reqn">X_m(s)</code>. If <code>NULL</code>, then, <code class="reqn">p_m</code> equally spaced time points in the interval [0, 1] are used for the <code class="reqn">m</code>-th functional predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>A vector with length <code class="reqn">M</code>. Its <code class="reqn">m</code>-th value denotes the number of functional principal components to be computed for the <code class="reqn">m</code>-th functional predictor <code class="reqn">X_m(s)</code>. If <code>NULL</code>, then, for each functional predictor, the number whose usage results in at least 95% explained variation is used as the number of principal components.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When performing a scalar-on-function regression model based on the functional principal component analysis, first, the functional predictors <code class="reqn">X_m(s), 1\le m\le M</code> are decomposed by the functional principal component analysis method: </p>
<p style="text-align: center;"><code class="reqn">X_m(s) = \bar{X}_m(s) + \sum_{l=1}^{K_m} \xi_{ml} \psi_{ml}(s),</code>
</p>
<p> where <code class="reqn">\bar{X}_m(s)</code> is the mean function, <code class="reqn">\psi_{ml}(s)</code> is the weight function, and <code class="reqn">\xi_{ml} = \int (X_m(s) - \bar{X}_m(s)) \psi_{ml}(s)</code> is the principal component score for the <code class="reqn">m</code>-th functional predictor. Assume that the <code class="reqn">m</code>-th regression coefficient function admits the expansion </p>
<p style="text-align: center;"><code class="reqn">\beta_m(s) = \sum_{l=1}^{K_m} b_{ml} \psi_{ml}(s),</code>
</p>
<p> where <code class="reqn">b_{ml} = \int \beta_m(s) \psi_{m}(s)  ds</code>. Then, the following multiple regression model is obtained for the scalar response: </p>
<p style="text-align: center;"><code class="reqn">\hat{Y} = \bar{Y} + \sum_{m=1}^M \sum_{l=1}^{K_m} b_{ml} \xi_{ml} + X.scl \gamma.</code>
</p>

<p>If <code>emodel = "classical"</code>, then, the least-squares method is used to estimate the scalar-on-function regression model.
</p>
<p>If <code>emodel = "robust"</code>, then, the robust functional principal component analysis of Bali et al. (2011) along with the method specified in <code>fmodel</code> is used to estimate the  scalar-on-function regression model.
</p>
<p>If <code>fmodel = "LTS"</code>, then, the least trimmed squares robust regression of Rousseeuw (1984) is used to estimate the scalar-on-function regression model.
</p>
<p>If <code>fmodel = "MM"</code>, then, the MM-type regression estimator described in Yohai (1987) and Koller and Stahel (2011) is used to estimate the scalar-on-function regression model.
</p>
<p>If <code>fmodel = "S"</code>, then, the S estimator is used to estimate the scalar-on-function regression model.
</p>
<p>If <code>fmodel = "tau"</code>, then, the tau estimator proposed by Salibian-Barrera et al. (2008) is used to estimate the scalar-on-function regression model.
</p>


<h3>Value</h3>

<p>A list object with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A list of matrices including the original scalar response and both the scalar and functional predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>An <code class="reqn">n \times 1</code>-dimensional matrix containing the fitted values of the scalar response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>An <code class="reqn">n \times 1</code>-dimensional matrix containing the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpca.results</code></td>
<td>
<p>A list object containing the functional principal component analysis results of the functional predictors variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.details</code></td>
<td>
<p>A list object containing model details, such as number of basis functions, number of principal components, and grid points used for each functional predictor variable.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ufuk Beyaztas and Han Lin Shang</p>


<h3>References</h3>

<p>J. L. Bali and G. Boente and D. E. Tyler and J. -L.Wang (2011), "Robust functional principal components: A projection-pursuit approach", <em>The Annals of Statistics</em>, <b>39</b>(6), 2852-2882.
</p>
<p>P. J. Rousseeuw (1984), "Least median of squares regression", <em>Journal of the American Statistical Association</em>, <b>79</b>(388), 871-881.
</p>
<p>P. J. Rousseeuw and K. van Driessen (1999) "A fast algorithm for the minimum covariance determinant estimator", <em>Technometrics</em>, <b>41</b>(3), 212-223.
</p>
<p>V. J. Yohai (1987), "High breakdown-point and high efficiency estimates for regression", <em>The Annals of Statistics</em>, <b>15</b>(2), 642-65.
</p>
<p>M. Koller and W. A. Stahel (2011), "Sharpening Wald-type inference in robust regression for small samples", <em>Computational Statistics &amp; Data Analysis</em>, <b>55</b>(8), 2504-2515.
</p>
<p>M. Salibian-Barrera and G. Willems and R. Zamar (2008), "The fast-tau estimator for regression", <em>Journal of Computational and Graphical Statistics</em>, <b>17</b>(3), 659-682
</p>


<h3>Examples</h3>

<pre><code class="language-R">sim.data &lt;- generate.sf.data(n = 400, n.pred = 5, n.gp = 101)
Y &lt;- sim.data$Y
X &lt;- sim.data$X
gp &lt;- rep(list(seq(0, 1, length.out = 101)), 5) # grid points of Xs
model.tau &lt;- rob.sf.reg(Y, X, emodel = "robust", fmodel = "tau", gp = gp)
</code></pre>


</div>