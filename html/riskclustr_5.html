<div class="container">

<table style="width: 100%;"><tr>
<td>optimal_kmeans_d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain optimal D solution based on k-means clustering of disease marker
data in a case-control study</h2>

<h3>Description</h3>

<p><code>optimal_kmeans_d</code> applies k-means clustering using the
<code>kmeans</code> function with many random starts. The D value is
then calculated for the cluster solution at each random start using the
<code>d</code> function, and the cluster solution that maximizes D is returned,
along with the corresponding value of D. In this way the optimally
etiologically heterogeneous subtype solution can be identified from possibly
high-dimensional disease marker data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optimal_kmeans_d(markers, M, factors, case, data, nstart = 100, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>a vector of the names of the disease markers. These markers
should be of a type that is suitable for use with
<code>kmeans</code> clustering. All markers will be missing
for control subjects. e.g. <code>markers = c("marker1", "marker2")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>is the number of clusters to identify using
<code>kmeans</code> clustering. For M&gt;=2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>a list of the names of the binary or continuous risk factors.
For binary risk factors the lowest level will be used as the reference level.
e.g. <code>factors = list("age", "sex", "race")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>denotes the variable that contains each subject's status as a
case or control. This value should be 1 for cases and 0 for controls.
Argument must be supplied in quotes, e.g. <code>case = "status"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the name of the dataframe that contains the relevant variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>the number of random starts to use with
<code>kmeans</code> clustering. Defaults to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer argument passed to <code>set.seed</code>.
Default is NULL. Recommended to set in order to obtain reproducible results.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list
</p>
<p><code>optimal_d</code> The D value for the optimal D solution
</p>
<p><code>optimal_d_data</code> The original data frame supplied through the
<code>data</code> argument, with a column called <code>optimal_d_label</code>
added for the optimal D subtype label.
This has the subtype assignment for cases, and is 0 for all controls.
</p>


<h3>References</h3>

<p>Begg, C. B., Zabor, E. C., Bernstein, J. L., Bernstein, L., Press, M. F., &amp;
Seshan, V. E. (2013). A conceptual and methodological framework for
investigating etiologic heterogeneity. Stat Med, 32(29), 5039-5052.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Cluster 30 disease markers to identify the optimally
# etiologically heterogeneous 3-subtype solution
res &lt;- optimal_kmeans_d(
  markers = c(paste0("y", seq(1:30))),
  M = 3,
  factors = list("x1", "x2", "x3"),
  case = "case",
  data = subtype_data,
  nstart = 100,
  seed = 81110224
)

# Look at the value of D for the optimal D solution
res[["optimal_d"]]

# Look at a table of the optimal D solution
table(res[["optimal_d_data"]]$optimal_d_label)


</code></pre>


</div>