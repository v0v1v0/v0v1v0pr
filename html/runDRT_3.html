<div class="container">

<table style="width: 100%;"><tr>
<td>run_drt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run Doubly Ranked Tests</h2>

<h3>Description</h3>

<p>Performs two (or more) sample doubly ranked tests on pre-processed functional data,
formatted as either a matrix (for functions) or an array (for surfaces).
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_drt(X, G, method = c("suff.rank", "avg.rank"), data.names = NULL)

## Default S3 method:
run_drt(X, G, method = c("suff.rank", "avg.rank"), data.names = NULL)

## S3 method for class 'formula'
run_drt(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an n by T matrix or an S by T by n array containing the functions (or surfaces) to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>a vector of length n containing the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>statistic for summarizing the ranks: 'suff.rank' for sufficient statistic (the default) or
'avg.rank' for arithmetic average.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.names</code></td>
<td>
<p>a vector of length two containing names that describe <code>X</code> and <code>G</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>X ~ G</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to pass to <code>run_drt.default()</code>, e.g. <code>method</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Doubly ranked tests are non-parametric tests that first rank functions (or surfaces) by time (or location). Next, the procedure
summarizes the observed ranks using a statistic. The summarized ranks are then analyzed using either a Wilcoxon rank sum
test or a Kruskal-Wallis test. To perform a doubly ranked test, realizations of functions must be stored in an n by T matrix where
n is the total number of observed functions and T is the number of realizations per function (commonly time points or locations). Surface
data in an S by T by n array can be analyzed as well, although currently this feature has under gone only limited testing.
</p>
<p>By default, <code>run_drt()</code> implements a sufficient statistic when summarizing the ranks of each observed function across T, i.e.
the argument <code>method</code> defaults to <code>method = suff.rank</code>. This statistic has the form
</p>
<p style="text-align: center;"><code class="reqn">t(z) = \frac{1}{T}\sum_{t=1}^T\log\left[ \left(\frac{z_t}{n}- \frac{1}{2n}\right)\bigg/\left(1-\frac{z_t}{n} + \frac{1}{2n}\right) \right],</code>
</p>

<p>where <code class="reqn">z_t</code> is the observed rank at time <code class="reqn">t</code>. See Meyer (2024) for additional details. The average rank may also be
used by setting <code>method = 'avg.rank'</code>, although this summary has not undergone testing in the doubly ranked context.
</p>
<p>Regardless of the statistic used, the summarized ranks are the analyzed using either <code>wilcox.test()</code> or <code>kruskal.test()</code>,
depending on the number of groups in <code>G</code>.
</p>
<p>For functional data, Meyer (2024) suggests using <code>refund::fpca.face()</code> for pre-processing the data, but <code>X</code> can be pre-processed using any functional
data approach or it can just be the raw data. <code>run_drt()</code> itself performs no pre-processing and takes <code>X</code> as inputted.
</p>


<h3>Value</h3>

<p>A list with class "<code>htest</code>" containing the following components:</p>

<table>
<tr>
<td style="text-align: left;">
<code>statistic</code> </td>
<td style="text-align: left;"> the value of the test statistic with a name describing it. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>parameter</code> </td>
<td style="text-align: left;">  the parameter(s) for the exact distribution of the test statistic. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>p.value</code> </td>
<td style="text-align: left;"> the p-value for the test. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>null.value</code> </td>
<td style="text-align: left;"> the location parameter. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>alternative</code> </td>
<td style="text-align: left;"> a character string describing the alternative hypothesis. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>data.name</code> </td>
<td style="text-align: left;"> a character string giving the names of the data. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>test_details</code> </td>
<td style="text-align: left;"> the output from the internally run Wilcoxon rank sum or Kruskal-Wallis test. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>method</code> </td>
<td style="text-align: left;"> character string giving the type of doubly ranked test performed. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ranks</code> </td>
<td style="text-align: left;"> a list containing the ranks by column (if <code>X</code> is a matrix) and the summarized ranks. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>data</code> </td>
<td style="text-align: left;"> a list containing <code>X</code> and <code>G</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Meyer, MJ (2024). Doubly ranked tests for grouped functional data. <em>Available on arXiv</em> at <a href="https://arxiv.org/abs/2306.14761">https://arxiv.org/abs/2306.14761</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### Two Sample Problem: Resin Viscosity ####
library(FDboost)
data("viscosity")

Xv    &lt;- matrix(viscosity$visAll, nrow = nrow(viscosity$visAll), ncol = ncol(viscosity$visAll))
fXv   &lt;- refund::fpca.face(Xv)
Yvis  &lt;- fXv$Yhat
TR  &lt;- viscosity$T_A

run_drt(Yvis ~ TR)

#### Four Sample Problem: Canadian Weather ####
R     &lt;- fda::CanadianWeather$region
XT    &lt;- t(fda::CanadianWeather$dailyAv[,,'Temperature.C'])
fXT   &lt;- refund::fpca.face(XT)
YT    &lt;- fXT$Yhat

run_drt(YT ~ R)

</code></pre>


</div>