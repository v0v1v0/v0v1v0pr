<div class="container">

<table style="width: 100%;"><tr>
<td>SpliceLL_TB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
LL-plot with fitted and Turnbull survival function
</h2>

<h3>Description</h3>

<p>This function plots the logarithm of the Turnbull survival function (which is suitable for interval censored data) versus the logarithm of the data.
Moreover, the logarithm of the fitted survival function of the spliced distribution is added.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SpliceLL_TB(x = sort(L), L, U = L, censored, splicefit, plot = TRUE,
            main = "Splicing LL-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Vector of points to plot the fitted survival function at. By default we plot it at the points <code>L</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals. By default, they are equal to <code>L</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splicefit</code></td>
<td>

<p>A <code>SpliceFit</code> object, e.g. output from <code>SpliceFiticPareto</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Logical indicating if the splicing LL-plot should be made, default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Title for the plot, default is <code>"Splicing LL-plot"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code>plot</code> for more details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The LL-plot consists of the points
</p>
<p style="text-align: center;"><code class="reqn">(\log(L_{i,n}), \log(1-\hat{F}^{TB}(L_{i,n})))</code>
</p>

<p>for <code class="reqn">i=1,\ldots,n</code> with <code class="reqn">n</code> the length of the data, <code class="reqn">x_{i,n}</code> the <code class="reqn">i</code>-th smallest observation
and <code class="reqn">\hat{F}^{TB}</code> the Turnbull estimator for the distribution function.
Then, the line 
</p>
<p style="text-align: center;"><code class="reqn">(\log(x), \log(1-\hat{F}_{spliced}(x))),</code>
</p>

<p>with <code class="reqn">\hat{F}_{spliced}</code> the fitted spliced distribution function, is added.
</p>
<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. The limits <code>trunclower</code> and <code>truncupper</code> are obtained from the <code>SpliceFit</code> object.
</p>
<p>If the <span class="pkg">interval</span> package is installed, the <code>icfit</code> function is used to compute the Turnbull estimator. Otherwise, <code>survfit.formula</code> from <span class="pkg">survival</span> is used.
</p>
<p>Use <code>SpliceLL</code> for non-censored data. 
</p>
<p>See Reynkens et al. (2017) and Section 4.3.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>logX</code></td>
<td>
<p>Vector of the logarithms of the sorted left boundaries of the intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sll.the</code></td>
<td>
<p>Vector of the theoretical log-probabilities <code class="reqn">\log(1-\hat{F}_{spliced}(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logx</code></td>
<td>
<p>Vector of the logarithms of the points to plot the fitted survival function at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sll.emp</code></td>
<td>
<p>Vector of the empirical log-probabilities <code class="reqn">\log(1-\hat{F}^{TB}(x_{i,n}))</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). "Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions". <em>Insurance: Mathematics and Economics</em>, 77, 65–77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). "Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm." <em>Astin Bulletin</em>, 45, 729–758
</p>


<h3>See Also</h3>

<p><code>SpliceLL</code>, <code>pSplice</code>, <code>Turnbull</code>, <code>icfit</code>, <code>SpliceFiticPareto</code>, <code>SpliceTB</code>, <code>SplicePP_TB</code>, <code>SpliceQQ_TB</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X,Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Splice ME and Pareto
splicefit &lt;- SpliceFiticPareto(L=Z, U=U, censored=censored, tsplice=quantile(Z,0.9))



x &lt;- seq(0,20,0.1)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")


# Fitted survival function and Turnbull survival function 
SpliceTB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# Log-log plot with Turnbull survival function and fitted survival function
SpliceLL_TB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# PP-plot of Turnbull survival function and fitted survival function
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

# PP-plot of Turnbull survival function and 
# fitted survival function with log-scales
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit, log=TRUE)

# QQ-plot using Turnbull survival function and fitted survival function
SpliceQQ_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

## End(Not run)
</code></pre>


</div>