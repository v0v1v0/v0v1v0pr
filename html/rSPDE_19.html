<div class="container">

<table style="width: 100%;"><tr>
<td>intrinsic.matern.operators</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance-based approximations of intrinsic fields</h2>

<h3>Description</h3>

<p><code>intrinsic.matern.operators</code> is used for computing a
covariance-based rational SPDE approximation of intrinsic
fields on <code class="reqn">R^d</code> defined through the SPDE
</p>
<p style="text-align: center;"><code class="reqn">(-\Delta)^{\beta/2}(\kappa^2-\Delta)^{\alpha/2} (\tau u) = \mathcal{W}</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">intrinsic.matern.operators(
  kappa,
  tau,
  alpha,
  beta = 1,
  G = NULL,
  C = NULL,
  d = NULL,
  mesh = NULL,
  graph = NULL,
  loc_mesh = NULL,
  m_alpha = 2,
  m_beta = 2,
  compute_higher_order = FALSE,
  return_block_list = FALSE,
  type_rational_approximation = c("chebfun", "brasil", "chebfunLB"),
  fem_mesh_matrices = NULL,
  scaling = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>range parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>precision parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Smoothness parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Smoothness parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>The stiffness matrix of a finite element discretization
of the domain of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>The mass matrix of a finite element discretization of
the domain of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>The dimension of the domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mesh</code></td>
<td>
<p>An inla mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>An optional <code>metric_graph</code> object. Replaces <code>d</code>, <code>C</code> and <code>G</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc_mesh</code></td>
<td>
<p>locations for the mesh for <code>d=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_alpha</code></td>
<td>
<p>The order of the rational approximation for the Matérn part,
which needs to be a positive integer. The default value is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_beta</code></td>
<td>
<p>The order of the rational approximation for the intrinsic part,
which needs to be a positive integer. The default value is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_higher_order</code></td>
<td>
<p>Logical. Should the higher order finite
element matrices be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_block_list</code></td>
<td>
<p>Logical. For <code>type = "covariance"</code>,
should the block parts of the precision matrix be returned
separately as a list?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_rational_approximation</code></td>
<td>
<p>Which type of rational
approximation should be used? The current types are
"chebfun", "brasil" or "chebfunLB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fem_mesh_matrices</code></td>
<td>
<p>A list containing FEM-related matrices.
The list should contain elements c0, g1, g2, g3, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>second lowest eigenvalue of g1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The covariance operator
</p>
<p style="text-align: center;"><code class="reqn">\tau^{-2}(-\Delta)^{\beta}(\kappa^2-\Delta)^{\alpha}</code>
</p>

<p>is approximated based on rational approximations of the two fractional
components. The Laplacians are equipped with homogeneous Neumann boundary
conditions and a zero-mean constraint is additionally imposed to obtained
a non-intrinsic model.
</p>


<h3>Value</h3>

<p><code>intrinsic.matern.operators</code> returns an object of
class "intrinsicCBrSPDEobj". This object is a list containing the
following quantities:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>The mass lumped mass matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ci</code></td>
<td>
<p>The inverse of <code>C</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GCi</code></td>
<td>
<p>The stiffness matrix G times <code>Ci</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gk</code></td>
<td>
<p>The stiffness matrix G along with the higher-order
FEM-related matrices G2, G3, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fem_mesh_matrices</code></td>
<td>
<p>A list containing the mass lumped mass
matrix, the stiffness matrix and
the higher-order FEM-related matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_alpha</code></td>
<td>
<p>The order of the rational approximation for the Matérn part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_beta</code></td>
<td>
<p>The order of the rational approximation for the intrinsic part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The fractional power of the Matérn part of the operator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The fractional power of the intrinsic part of the operator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String indicating the type of approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>The dimension of the domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Matrix that sums the components in the approximation to the mesh nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Range parameter of the covariance function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Scale parameter of the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String indicating the type of approximation.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("RSpectra", quietly = TRUE)){
 x &lt;- seq(from = 0, to = 10, length.out = 201)
 beta &lt;- 1
 alpha &lt;- 1
 kappa &lt;- 1
 op &lt;- intrinsic.matern.operators(kappa = kappa, tau = 1, alpha = alpha, 
                                 beta = beta, loc_mesh = x, d=1) 
 # Compute and plot the variogram of the model
 Sigma &lt;- op$A %*% solve(op$Q,t(op$A))
 One &lt;- rep(1, times = ncol(Sigma))
 D &lt;- diag(Sigma)
 Gamma &lt;- 0.5*(One %*% t(D) + D %*% t(One) - 2 * Sigma)
 k &lt;- 100
 plot(x, Gamma[k, ], type = "l")
 lines(x, 
      variogram.intrinsic.spde(x[k], x, kappa, alpha, beta, L = 10, d = 1),
      col=2, lty = 2)
}
</code></pre>


</div>