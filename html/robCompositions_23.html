<div class="container">

<table style="width: 100%;"><tr>
<td>bpcTab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Backwards pivot coordinates and their inverse</h2>

<h3>Description</h3>

<p>Backwards pivot coordinate representation of a compositional table as a special case of isometric logratio coordinates and their inverse mapping.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bpcTab(x, row.factor = NULL, col.factor = NULL, value = NULL, base = exp(1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class data.frame with columns corresponding to row and column factors of the respective compositional table and a variable with the values of the composition (positive values only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.factor</code></td>
<td>
<p>name of the variable representing the row factor. Needs to be given with the quotation marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.factor</code></td>
<td>
<p>name of the variable representing the column factor. Needs to be given with the quotation marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>name of the variable representing the values of the composition. Needs to be given with the quotation marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>a positive number: the base with respect to which logarithms are computed. Defaults to exp(1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>bpcTab
</p>
<p>Backwards pivot coordinates map IxJ-part compositional table from the simplex into a (IJ-1)-dimensional real space isometrically. 
Particularly the first coordinate from each group (rbpb.1, cbpb.1, tbpc.1) preserves the elemental information on the two-factorial structure. 
The first row and column backwards pivot balances rbpb.1 and cbpb.1 represent two-factorial counterparts to the pairwise logratios. 
More specifically, the first two levels of the considered factor are compared in the ratio, while the first level plays the role of the rationing category (denominator of the ratio) and the second level is treated as the normalized category (numerator of the ratio). All categories of the complementary factor are aggregated with the geometric mean.
The first table backwards pivot coordinate, has form of a four-part log odds-ratio (again related to the first two levels of the row and column factors) and quantifies the relations between factors.
All coordinates are structured as detailed in Nesrstova et al. (2023).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Coordinates</code></td>
<td>
<p>array of orthonormal coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Coordinates.ortg</code></td>
<td>
<p>array of orthogonal coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Contrast.matrix</code></td>
<td>
<p>contrast matrix corresponding to the orthonormal coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Base</code></td>
<td>
<p>the base with respect to which logarithms are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Row.levels</code></td>
<td>
<p>order of the row factor levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Col.levels</code></td>
<td>
<p>order of the column factor levels.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kamila Facevicova
</p>


<h3>References</h3>

<p>Nesrstova, V., Jaskova, P., Pavlu, I., Hron, K., Palarea-Albaladejo, J., Gaba, A., Pelclova, J., Facevicova, K. (2023). Simple enough, but not simpler: Reconsidering additive logratio coordinates in compositional analysis. Submitted
</p>


<h3>See Also</h3>

<p><code>bpc</code> 
<code>bpcTabWrapper</code> 
<code>bpcPcaTab</code>
<code>bpcRegTab</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(manu_abs)
manu_USA &lt;- manu_abs[which(manu_abs$country=='USA'),]
manu_USA$output &lt;- as.factor(manu_USA$output)
manu_USA$isic &lt;- as.factor(manu_USA$isic)

# default setting with ln()
bpcTab(manu_USA, row.factor = "output", col.factor = "isic", value = "value")

# logarithm of base 2
bpcTab(manu_USA, row.factor = "output", col.factor = "isic", value = "value",
base = 2)

# for base exp(1) is the result similar to tabCoord():
r &lt;- rbind(c(-1,1,0), c(-1,-1,1))
c &lt;- rbind(c(-1,1,0,0,0), c(-1,-1,1,0,0), c(-1,-1,-1,1,0), c(-1,-1,-1,-1,1))
tabCoord(manu_USA, row.factor = "output", col.factor = "isic", value = "value",
SBPr = r, SBPc = c)
</code></pre>


</div>