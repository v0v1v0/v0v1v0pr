<div class="container">

<table style="width: 100%;"><tr>
<td>conf2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bivariate (Two-Dimensional) Confidence Region</h2>

<h3>Description</h3>

<p>Calculate an empirical confidence region for two variables, and
optionally overlay the smooth polygon on a scatterplot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">conf2d(x, ...)

## S3 method for class 'formula'
conf2d(formula, data, subset, ...)

## Default S3 method:
conf2d(x, y, level=0.95, n=200, method="wand", shape=1, smooth=50,
       plot=TRUE, add=FALSE, xlab=NULL, ylab=NULL, col.points="gray",
       col="black", lwd=2, ...)

conf2d_int(x, y, surf, level, n)  # internal function
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of x values, or a data frame whose first two columns
contain the x and y values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of y values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>formula</code>, such as <code>y~x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code>, <code>matrix</code>, or <code>list</code> from
which the variables in <code>formula</code> should be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the proportion of points that should be inside the
region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of regions to evaluate, before choosing the region
that matches <code>level</code> best.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>kernel smoothing function to use: <code>"wand"</code> or
<code>"mass"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>a bandwidth scaling factor, affecting the polygon shape.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>the number of bins (scalar or vector of length 2),
affecting the polygon smoothness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to plot a scatterplot and overlay the region as a
polygon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>whether to add a polygon to an existing plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a label for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a label for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.points</code></td>
<td>
<p>color of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color of polygon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width of polygon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>plot</code> and
<code>polygon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surf</code></td>
<td>
<p>a list whose first three elements are x coordinates, y
coordinates, and a surface matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function constructs a large number (<code>n</code>) of smooth polygons,
and then chooses the polygon that comes closest to containing a given
proportion (<code>level</code>) of the total points.
</p>
<p>The default <code>method="wand"</code> calls the
<code>bkde2D</code> kernel smoother from the
<span class="pkg">KernSmooth</span> package, while <code>method="mass"</code> calls
<code>kde2d</code> from the <span class="pkg">MASS</span> package.
</p>
<p>The <code>conf2d</code> function calls <code>bkde2D</code> or <code>kde2d</code> to
compute a smooth surface from <code>x</code> and y. If users already have
a smoothed surface to work from, the internal <code>conf2d_int</code> can be
used directly to find the empirical confidence region that matches
<code>level</code> best.
</p>


<h3>Value</h3>

<p>List containing five elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x coordinates defining the region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>y coordinates defining the region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inside</code></td>
<td>
<p>logical vector indicating which of the original data
coordinates are inside the region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>area inside the region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>actual proportion of points inside the region.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>area</code> of a bivariate region is analogous to the range of a
univariate interval. This allows a quantitative comparison of
different confidence regions.
</p>
<p>Ellipses are a more restrictive approach to calculate an empirical
bivariate confidence region. Smooth polygons make fewer assumptions
about how x and y covary.
</p>
<p>The <code>conf2d</code> and <code>freq2d</code> functions are closely related. The
advantage of <code>conf2d</code> is that it returns a region as a smooth
polygon. The advantage of <code>freq2d</code> is that it returns a set that
is guaranteed to contain the correct proportion of points, even for
spatially complex datasets.
</p>


<h3>Author(s)</h3>

<p>Arni Magnusson and Julian Burgos, based on an earlier function by
Gregory R. Warnes.
</p>


<h3>See Also</h3>

<p><code>quantile</code> is the corresponding univariate equivalent.
</p>
<p>The <span class="pkg">distfree.cr</span> package uses a different smoothing algorithm to
calculate bivariate empirical confidence regions.
</p>
<p><code>ci2d</code> in the <span class="pkg">gplots</span> package is a
predecessor of <code>conf2d</code>.
</p>
<p><code>freq2d</code> calculates a discrete frequency distribution for
two continuous variables.
</p>
<p><code>r2d2-package</code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">conf2d(Ushape)$prop
conf2d(saithe, pch=16, cex=1.2, col.points=rgb(0,0,0,0.1), lwd=3)

# First surface, then region
plot(saithe, col="gray")
surf &lt;- MASS::kde2d(saithe$Bio, saithe$HR, h=0.25, n=100)
region &lt;- conf2d_int(saithe$Bio, saithe$HR, surf, level=0.95, n=200)
polygon(region, lwd=2)
</code></pre>


</div>