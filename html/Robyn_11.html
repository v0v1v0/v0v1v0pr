<div class="container">

<table style="width: 100%;"><tr>
<td>robyn_allocator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Budget Allocator</h2>

<h3>Description</h3>

<p><code>robyn_allocator()</code> function returns a new split of media
variable spends that maximizes the total media response.
</p>


<h3>Usage</h3>

<pre><code class="language-R">robyn_allocator(
  robyn_object = NULL,
  select_build = 0,
  InputCollect = NULL,
  OutputCollect = NULL,
  select_model = NULL,
  json_file = NULL,
  scenario = "max_response",
  total_budget = NULL,
  target_value = NULL,
  date_range = "all",
  channel_constr_low = NULL,
  channel_constr_up = NULL,
  channel_constr_multiplier = 3,
  optim_algo = "SLSQP_AUGLAG",
  maxeval = 1e+05,
  constr_mode = "eq",
  plots = TRUE,
  plot_folder = NULL,
  plot_folder_sub = NULL,
  export = TRUE,
  quiet = FALSE,
  ui = FALSE,
  ...
)

## S3 method for class 'robyn_allocator'
print(x, ...)

## S3 method for class 'robyn_allocator'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>robyn_object</code></td>
<td>
<p>Character or List. Path of the <code>Robyn.RDS</code> object
that contains all previous modeling information or the imported list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_build</code></td>
<td>
<p>Integer. Default to the latest model build. <code>select_build = 0</code>
selects the initial model. <code>select_build = 1</code> selects the first refresh model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InputCollect</code></td>
<td>
<p>List. Contains all input parameters for the model.
Required when <code>robyn_object</code> is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OutputCollect</code></td>
<td>
<p>List. Containing all model result.
Required when <code>robyn_object</code> is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_model</code></td>
<td>
<p>Character. A model <code>SolID</code>. When <code>robyn_object</code>
is provided, <code>select_model</code> defaults to the already selected <code>SolID</code>. When
<code>robyn_object</code> is not provided, <code>select_model</code> must be provided with
<code>InputCollect</code> and <code>OutputCollect</code>, and must be one of
<code>OutputCollect$allSolutions</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>json_file</code></td>
<td>
<p>Character. JSON file to import previously exported inputs or
recreate a model. To generate this file, use <code>robyn_write()</code>.
If you didn't export your data in the json file as "raw_data",
<code>dt_input</code> must be provided; <code>dt_holidays</code> input is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scenario</code></td>
<td>
<p>Character. Accepted options are: <code>"max_response"</code>, <code>"target_efficiency"</code>.
Scenario <code>"max_response"</code> answers the question:
"What's the potential revenue/conversions lift with the same (or custom) spend level
in <code>date_range</code> and what is the allocation and expected response mix?"
Scenario <code>"target_efficiency"</code> optimizes ROAS or CPA and answers the question:
"What's the potential revenue/conversions lift and spend levels based on a
<code>target_value</code> for CPA/ROAS and what is the allocation and expected response mix?"
Deprecated scenario: <code>"max_response_expected_spend"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_budget</code></td>
<td>
<p>Numeric. Total marketing budget for all paid channels for the
period in <code>date_range</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_value</code></td>
<td>
<p>Numeric. When using the scenario <code>"target_efficiency"</code>,
target_value is the desired ROAS or CPA with no upper spend limit. Default is set to 80% of
initial ROAS or 120% of initial CPA, when <code>"target_value = NULL"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date_range</code></td>
<td>
<p>Character. Date(s) to apply adstocked transformations and pick mean spends
per channel. Set one of: "all", "last", or "last_n" (where
n is the last N dates available), date (i.e. "2022-03-27"), or date range
(i.e. <code>c("2022-01-01", "2022-12-31")</code>). Default to "all".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel_constr_low, channel_constr_up</code></td>
<td>
<p>Numeric vectors. The lower and upper bounds
for each paid media variable when maximizing total media response. For example,
<code>channel_constr_low = 0.7</code> means minimum spend of the variable is 70
average, using non-zero spend values, within <code>date_min</code> and <code>date_max</code> date range.
Both constrains must be length 1 (same for all values) OR same length and order as
<code>paid_media_spends</code>. It's not recommended to 'exaggerate' upper bounds, especially
if the new level is way higher than historical level. Lower bound must be &gt;=0.01,
and upper bound should be &lt; 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel_constr_multiplier</code></td>
<td>
<p>Numeric. Default to 3. For example, if
<code>channel_constr_low</code> and <code>channel_constr_up</code> are 0.8 to 1.2, the range is 0.4.
The allocator will also show the optimum solution for a larger constraint range of
0.4 x 3 = 1.2, or 0.4 to 1.6, to show the optimization potential to support allocation
interpretation and decision.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_algo</code></td>
<td>
<p>Character. Default to <code>"SLSQP_AUGLAG"</code>, short for "Sequential Least-Squares
Quadratic Programming" and "Augmented Lagrangian". Alternatively, "<code>"MMA_AUGLAG"</code>,
short for "Methods of Moving Asymptotes". More details see the documentation of
NLopt <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/">here</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxeval</code></td>
<td>
<p>Integer. The maximum iteration of the global optimization algorithm.
Defaults to 100000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constr_mode</code></td>
<td>
<p>Character. Options are <code>"eq"</code> or <code>"ineq"</code>,
indicating constraints with equality or inequality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>Boolean. Generate plots?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_folder</code></td>
<td>
<p>Character. Path for saving plots and files. Default
to <code>robyn_object</code> and saves plot in the same directory as <code>robyn_object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_folder_sub</code></td>
<td>
<p>Character. Sub path for saving plots. Will overwrite the
default path with timestamp or, for refresh and allocator, simply overwrite files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export</code></td>
<td>
<p>Boolean. Export outcomes into local files?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Boolean. Keep messages off?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ui</code></td>
<td>
<p>Boolean. Save additional outputs for UI usage. List outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters passed to <code>robyn_outputs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>robyn_allocator()</code> output.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list object containing allocator result.
</p>
<p>List. Contains optimized allocation results and plots.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Having InputCollect and OutputCollect results
AllocatorCollect &lt;- robyn_allocator(
  InputCollect = InputCollect,
  OutputCollect = OutputCollect,
  select_model = "1_2_3",
  scenario = "max_response",
  channel_constr_low = 0.7,
  channel_constr_up = c(1.2, 1.5, 1.5, 1.5, 1.5),
  channel_constr_multiplier = 4,
  date_range = "last_26",
  export = FALSE
)
# Print a summary
print(AllocatorCollect)
# Plot the allocator one-pager
plot(AllocatorCollect)

## End(Not run)
</code></pre>


</div>