<div class="container">

<table style="width: 100%;"><tr>
<td>gDist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>calculate geostatistical distances between areas</h2>

<h3>Description</h3>

<p>Calculate geostatistical distances (Ghosh-distances) between
areas
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'rtop'
gDist(object, params = list(), ...) 
## S3 method for class 'SpatialPolygonsDataFrame'
gDist(object, object2 = NULL, ...) 
## S3 method for class 'SpatialPolygons'
gDist(object, object2 = NULL, ...) 
## S3 method for class 'list'
gDist(object, object2 = NULL, diag = FALSE, debug.level = 0, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>SpatialPolygons</code> or 
<code>SpatialPolygonsDataFrame</code> with boundaries of areas;
or list of discretized areas, typically from a call to <br><code>rtopDisc</code>; or
object of class <code>rtop</code> with such boundaries and/or discretized
elements (the individual areas)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a set of parameters, used to modify the default parameters for 
the <code>rtop</code> package, set in <code>getRtopParams</code>. The argument params can also be used
for the other methods, through the ...-argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object2</code></td>
<td>
<p>an object of same type as <code>object</code>, except for <code>rtop</code>;
for calculation of geostatistical
distances also between the elements in the two different objects </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>logical; if TRUE only calculate the geostatistical distances between
each element and itself, only when the objects are lists of discretized
areas and object2 = object or object2 = NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug.level</code></td>
<td>
<p>debug.level = 0 will suppress output from the call to 
varMat, done for calculation of the geostatistical distances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters, for <code>gDist.list</code> when calling one of the 
other methods, or for <code>varMat</code>, in which the calculations take place</p>
</td>
</tr>
</table>
<h3>Value</h3>

 
<p>If called with one list of discretized elements, a matrix with the geostatistical distances 
between the elements within the list. If called with two lists of discretized elements, 
a matrix with the geostatistical distances between the elements in the two lists.
If called with <code>diag = TRUE</code>, the function returns an array of the geostatistical 
distance within each of the elements in the list.
</p>
<p>If called with one <code>SpatialPolygons</code> or <code>SpatialPolygonsDataFrame</code>
or the function returns a list with one matrix with geostatistical distances between 
the elements of the object. If called with two objects, the list will also containt 
a matrix of the geostatistical distances between the elements of the two objects, and an array
of the geostatistical distances within the elements of the second object. 
</p>
<p>If called with an rtop-object, the function will return the object, amended with the 
list above.
</p>


<h3>Note</h3>

<p>The geostatistical distance can be seen as the average distance between 
points in two elements, or the average distance within points in a single element.
The distance measure is also sometimes referred to as Ghosh-distance, from
Ghosh (1951) who found analytical expressions for these distances between 
blocks with regular geometry.
</p>
<p>The use of geostatistical distances within <code>rtop</code> is based on an idea 
from Gottschalk (1993), who suggested
to replace the traditional regularization of variograms within block-kriging
(as done in the original top-kriging application of Skoien et al (2006))
with covariances of the geostatistical distance. The covariance between two
areas can then be found as <code>C(a1,a2) = cov(gd)</code> where <code>gd</code> is the geostatistical
distance between the two areas <code>a1</code> and <code>a2</code>, instead of an integration 
of the covariance function between the two areas. 
</p>
<p><code>rtop</code> is based on semivariograms
instead of covariances, and the semivariogram value between the two areas
can be found as <code>gamma(a1,a2) = g(gd) - 0.5 (g(gd1) + g(gd2))</code> where
<code>g</code> is a semivariogram valid for point support, <code>gd1)</code> and <code>gd2</code>
are the geostatistical distances within each of the two areas.
</p>


<h3>Author(s)</h3>

<p> Jon Olav Skoien </p>


<h3>References</h3>

 
<p>Ghosh, B. 1951. Random distances within a rectangle and between two rectangles. Bull. Calcutta Math. Soc., 43, 17-24.
</p>
<p>Gottschalk, L. 1993. Correlation and covariance of runoff. Stochastic Hydrology and Hydraulics, 7, 85-101.
</p>
<p>Skoien, J. O., R. Merz, and G. Bloschl. 2006. Top-kriging - geostatistics on stream networks. Hydrology and Earth System Sciences, 10, 277-287.
</p>
<p>Skoien, J. O., Bloschl, G., Laaha, G., Pebesma, E., Parajka, J., Viglione, A., 2014. Rtop: An R package for interpolation of data with a variable spatial support, with an example from river networks. Computers &amp; Geosciences, 67.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
rpath = system.file("extdata",package="rtop")
library(sf)
observations = st_read(rpath, "observations")
gDist = gDist(observations)


</code></pre>


</div>