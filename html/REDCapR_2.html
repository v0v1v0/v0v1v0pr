<div class="container">

<table style="width: 100%;"><tr>
<td>metadata_utilities</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Manipulate and interpret the metadata of a REDCap project</h2>

<h3>Description</h3>

<p>A collection of functions that assists handling REDCap
project metadata.
</p>


<h3>Usage</h3>

<pre><code class="language-R">regex_named_captures(pattern, text, perl = TRUE)

checkbox_choices(select_choices)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>The regular expression pattern.  Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>The text to apply the regex against.  Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perl</code></td>
<td>
<p>Indicates if perl-compatible regexps should be used.
Default is <code>TRUE</code>. Optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_choices</code></td>
<td>
<p>The text containing the choices that should be parsed
to determine the <code>id</code> and <code>label</code> values.  Required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>regex_named_captures()</code> function is general, and not specific to
REDCap; it accepts any arbitrary regular expression.
It returns a <code>tibble::tibble()</code> with as many columns as named matches.
</p>
<p>The <code>checkbox_choices()</code> function is specialized, and accommodates the
"select choices" for a <em>single</em> REDCap checkbox group (where multiple boxes
can be selected).  It returns a <code>tibble::tibble()</code> with two columns, one
for the numeric id and one for the text label.
</p>
<p>The parse will probably fail if a label contains a pipe (<em>i.e.</em>, <code>|</code>),
since that the delimiter REDCap uses to separate choices
presented to the user.
</p>


<h3>Value</h3>

<p>Currently, a <code>tibble::tibble()</code> is returned a row for each match,
and a column for each <em>named</em> group within a match.  For the
<code>retrieve_checkbox_choices()</code> function, the columns will be.
</p>

<ul>
<li> <p><code>id</code>: The numeric value assigned to each choice (in the data dictionary).
</p>
</li>
<li> <p><code>label</code>: The label assigned to each choice (in the data dictionary).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>See the official documentation for permissible characters in a
checkbox label.
<em>I'm bluffing here, because I don't know where this is located.
If you know, please tell me.</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The weird ranges are to avoid the pipe character;
#   PCRE doesn't support character negation.
pattern_boxes &lt;- "(?&lt;=\\A| \\| )(?&lt;id&gt;\\d{1,}), (?&lt;label&gt;[\x20-\x7B\x7D-\x7E]{1,})(?= \\| |\\Z)"

choices_1 &lt;- paste0(
  "1, American Indian/Alaska Native | ",
  "2, Asian | ",
  "3, Native Hawaiian or Other Pacific Islander | ",
  "4, Black or African American | ",
  "5, White | ",
  "6, Unknown / Not Reported"
)

# This calls the general function, and requires the correct regex pattern.
REDCapR::regex_named_captures(pattern=pattern_boxes, text=choices_1)

# This function is designed specifically for the checkbox values.
REDCapR::checkbox_choices(select_choices=choices_1)

## Not run: 
uri         &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token       &lt;- "9A81268476645C4E5F03428B8AC3AA7B"

ds_metadata &lt;- redcap_metadata_read(uri, token)$data
choices_2   &lt;- ds_metadata[ds_metadata$field_name == "race", ]$select_choices_or_calculations

REDCapR::regex_named_captures(pattern = pattern_boxes, text = choices_2)

## End(Not run)

path_3     &lt;- system.file(package = "REDCapR", "test-data/project-simple/metadata.csv")
ds_metadata_3  &lt;- read.csv(path_3)
choices_3  &lt;- ds_metadata_3[ds_metadata_3$field_name=="race", "select_choices_or_calculations"]
REDCapR::regex_named_captures(pattern = pattern_boxes, text = choices_3)
</code></pre>


</div>