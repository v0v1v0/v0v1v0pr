<div class="container">

<table style="width: 100%;"><tr>
<td>export_as_docx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Export as word document</h2>

<h3>Description</h3>

<p>From a table, produce a self-contained word document or attach it to a template word
file (<code>template_file</code>). This function is based on the <code>tt_to_flextable()</code> transformer and
the <code>officer</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">export_as_docx(
  tt,
  file,
  doc_metadata = NULL,
  titles_as_header = FALSE,
  footers_as_text = TRUE,
  template_file = NULL,
  section_properties = section_properties_default(),
  ...
)

section_properties_default(
  page_size = c("letter", "A4"),
  orientation = c("portrait", "landscape")
)

margins_potrait()

margins_landscape()
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>(<code>TableTree</code> or related class)<br> a <code>TableTree</code> object representing a populated table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>(<code>string</code>)<br> string that indicates the final file output. Must have <code>.docx</code> extension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doc_metadata</code></td>
<td>
<p>(<code>list</code> of <code>string</code>s)<br> any value that can be used as metadata by
<code>?officer::set_doc_properties</code>. Important text values are <code>title</code>, <code>subject</code>, <code>creator</code>, and <code>description</code>,
while <code>created</code> is a date object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titles_as_header</code></td>
<td>
<p>(<code>flag</code>)<br> defaults to <code>TRUE</code> for <code>tt_to_flextable()</code>, so the table is self-contained
as it makes additional header rows for <code>formatters::main_title()</code> string and <code>formatters::subtitles()</code> character
vector (one per element). <code>FALSE</code> is suggested for <code>export_as_docx()</code>. This adds titles and subtitles as a text
paragraph above the table. The same style is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footers_as_text</code></td>
<td>
<p>(<code>flag</code>)<br> defaults to <code>FALSE</code> for <code>tt_to_flextable()</code>, so the table is self-contained with
the <code>flextable</code> definition of footnotes. <code>TRUE</code> is used for <code>export_as_docx()</code> to add the footers as a new
paragraph after the table. The same style is applied, but with a smaller font.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template_file</code></td>
<td>
<p>(<code>string</code>)<br> template file that <code>officer</code> will use as a starting point for the final
document. Document attaches the table and uses the defaults defined in the template file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>section_properties</code></td>
<td>
<p>(<code>officer::prop_section</code>)<br> an <code>officer::prop_section()</code> object which sets margins and
page size. Defaults to <code>section_properties_default()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(<code>any</code>)<br> additional arguments passed to <code>tt_to_flextable()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>page_size</code></td>
<td>
<p>(<code>character(1)</code>) page size. Can be <code>"letter"</code> or <code>"A4"</code>. Defaults to <code>"letter"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orientation</code></td>
<td>
<p>(<code>character(1)</code>) page orientation. Can be <code>"portrait"</code> or <code>"landscape"</code>. Defaults to
<code>"portrait"</code>.</p>
</td>
</tr>
</table>
<h3>Functions</h3>


<ul>
<li> <p><code>section_properties_default()</code>: Helper function that defines standard portrait properties for tables.
</p>
</li>
<li> <p><code>margins_potrait()</code>: Helper function that defines standard portrait margins for tables.
</p>
</li>
<li> <p><code>margins_landscape()</code>: Helper function that defines standard landscape margins for tables.
</p>
</li>
</ul>
<h3>Note</h3>

<p><code>export_as_docx()</code> has few customization options available. If you require specific formats and details,
we suggest that you use <code>tt_to_flextable()</code> prior to <code>export_as_docx</code>. Only the <code>title_as_header</code> and
<code>footer_as_text</code> parameters must be re-specified if the table is changed first using <code>tt_to_flextable()</code>.
</p>


<h3>See Also</h3>

<p><code>tt_to_flextable()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(flextable)
lyt &lt;- basic_table() %&gt;%
  split_cols_by("ARM") %&gt;%
  analyze(c("AGE", "BMRKR2", "COUNTRY"))

tbl &lt;- build_table(lyt, ex_adsl)

# See how section_properties_portrait function is built for custom
tf &lt;- tempfile(fileext = ".docx")
export_as_docx(tbl,
  file = tf,
  section_properties = section_properties_default(orientation = "landscape")
)

</code></pre>


</div>