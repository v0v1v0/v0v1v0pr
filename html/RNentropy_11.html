<div class="container">

<table style="width: 100%;"><tr>
<td>RN_select</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Select transcripts/genes with significant p-values.
</h2>

<h3>Description</h3>


<p>Select transcripts with global p-value lower than an user defined threshold and provide a summary of over- or under-expression according to local p-values. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">RN_select(Results, gpv_t = 0.01, lpv_t = 0.01, method = "BH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Results</code></td>
<td>


<p>The output of RNentropy or RN_calc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpv_t</code></td>
<td>


<p>Threshold for global p-value. (Default: 0.01)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpv_t</code></td>
<td>


<p>Threshold for local p-value. (Default: 0.01)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>


<p>Multiple test correction method. Available methods are the ones of p.adjust. Type p.adjust.methods to see the list. Default: BH (Benjamini &amp; Hochberg)
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The original input containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>gpv</code></td>
<td>
<p>-log10 of the global p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpv</code></td>
<td>
<p>-log10 of the local p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_like</code></td>
<td>
<p>results formatted as in the output of the C++ implementation of RNentropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>The results data.frame containing the original expression values together with the -log10 of global and local p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>The experimental design matrix.</p>
</td>
</tr>
</table>
<p>and a new dataframe
</p>
<table><tr style="vertical-align: top;">
<td><code>selected</code></td>
<td>
<p>Transcripts/genes with a corrected global p-value lower than gpv_t. For each condition it will contain a column where values can be -1,0,1 or NA. 1 means that all the replicates of this condition have expression value higher than the average and local p-value &lt;= lpv_t (thus the corresponding gene will be over-expressed in this condition).  -1 means that all the replicates of this condition  have expression value lower than the average and local p-value &lt;= lpv_t (thus the corresponding gene will be under-expressed in this condition). 0 means that at least one of the replicates has a local p-value &gt; lpv_t. NA means that the local p-values of the replicates are not consistent for this condition, that is, at least one replicate results to be over-expressed and at least one results to be under-expressed.</p>
</td>
</tr></table>
<h3>Author(s)</h3>


<p>Giulio Pavesi - Dep. of Biosciences, University of Milan
</p>
<p>Federico Zambelli - Dep. of Biosciences, University of Milan
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("RN_Brain_Example_tpm", "RN_Brain_Example_design")
#compute statistics and p-values (considering only a subset of genes due to
#examples running time limit of CRAN)
Results &lt;- RN_calc(RN_Brain_Example_tpm[1:10000,], RN_Brain_Example_design)
Results &lt;- RN_select(Results)

## The function is currently defined as
function (Results, gpv_t = 0.01, lpv_t = 0.01, method = "BH") 
{
    lpv_t &lt;- -log10(lpv_t)
    gpv_t &lt;- -log10(gpv_t)
    Results$gpv_bh &lt;- -log10(p.adjust(10^-Results$gpv, method = method))
    true_rows &lt;- (Results$gpv_bh &gt;= gpv_t)
    design_b &lt;- t(Results$design &gt; 0)
    Results$lpv_sel &lt;- data.frame(row.names = rownames(Results$lpv)[true_rows])
    for (d in seq_along(design_b[, 1])) {
        col &lt;- apply(Results$lpv[true_rows, ], 1, ".RN_select_lpv_row", 
            design_b[d, ], lpv_t)
        Results$lpv_sel &lt;- cbind(Results$lpv_sel, col)
        colnames(Results$lpv_sel)[length(Results$lpv_sel)] &lt;- paste("condition", 
            d, sep = "_")
    }
    lbl &lt;- Results$res[, !sapply(Results$res, is.numeric)]
    Results$selected &lt;- cbind(lbl[true_rows], Results$gpv[true_rows], 
	Results$gpv_bh[true_rows], Results$lpv_sel)
    colnames(Results$selected) &lt;- c(names(which(!sapply(Results$res, 
	is.numeric))), "GL_LPV", "Corr. GL_LPV", colnames(Results$lpv_sel))
    Results$selected &lt;- Results$selected[order(Results$selected[,3], decreasing=TRUE),]
    Results$lpv_sel &lt;- NULL
    return(Results)
  }
</code></pre>


</div>