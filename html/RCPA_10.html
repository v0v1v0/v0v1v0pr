<div class="container">

<table style="width: 100%;"><tr>
<td>plotBarChart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a bar chart of the pathway analysis results</h2>

<h3>Description</h3>

<p>This function plots a bar chart of the pathway analysis results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotBarChart(
  results,
  limit = Inf,
  label = "name",
  by = c("normalizedScore", "score", "pFDR", "p.value"),
  maxNegLog10PValue = 5,
  pThreshold = 0.05,
  useFDR = TRUE,
  selectedPathways = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>A named list of data frame with pathway analysis results.
The columns are ID, name, p.value, pFDR, size, nDE, score and normalizedScore.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>The maximum number of pathways to plot.
The pathway will be sorted by the average absolute value of the -log10(p-value) or -log10(pFDR) if the 'by' parameter is 'p.value' or 'pFDR'.
Otherwise, the pathway will be sorted by the average value of the 'by' parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>The column to use for the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>The column to use for the bar heights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxNegLog10PValue</code></td>
<td>
<p>The maximum -log10(p-value) to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pThreshold</code></td>
<td>
<p>The p-value threshold to use for significance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useFDR</code></td>
<td>
<p>If TRUE, use FDR adjusted p-values for the significance threshold. Otherwise, use raw p-values.
This parameter is used to mark the color of the bars and is independent of the 'by' parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectedPathways</code></td>
<td>
<p>A vector of pathways ID, which is in the same format as ID column in the pathway analysis result, to be included in the plot.
If it is NULL, all pathways will be included.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(RCPA)

affyFgseaResult &lt;- loadData("affyFgseaResult")
agilFgseaResult &lt;- loadData("agilFgseaResult")
RNASeqFgseaResult &lt;- loadData("RNASeqFgseaResult")
metaPAResult &lt;- loadData("metaPAResult")

PAResults &lt;- list(
    "Affymetrix - GSE5281" = affyFgseaResult,
    "Agilent - GSE61196" = agilFgseaResult,
    "RNASeq - GSE153873" = RNASeqFgseaResult,
    "Meta-analysis" = metaPAResult
)

selectedPathways &lt;- c("path:hsa05010", "path:hsa05012", "path:hsa05014", 
                       "path:hsa05016", "path:hsa05017", "path:hsa05020", 
                       "path:hsa05022", "path:hsa04724", "path:hsa04727", 
                       "path:hsa04725", "path:hsa04728", "path:hsa04726",
                      "path:hsa04720", "path:hsa04730", "path:hsa04723", 
                      "path:hsa04721", "path:hsa04722")
resultsToPlot &lt;- lapply(PAResults, 
                    function(df) df[df$ID %in% selectedPathways,])

plotObj &lt;- RCPA::plotBarChart(resultsToPlot) + 
            ggplot2::ggtitle("FGSEA Analysis Results")


</code></pre>


</div>