<div class="container">

<table style="width: 100%;"><tr>
<td>binnest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binary Random Effects Models with Two Levels of Nesting</h2>

<h3>Description</h3>

<p><code>binnest</code> is designed to handle binary and binomial data with two
levels of nesting. The first level is the individual and the second will
consist of clusters within individuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binnest(
  response,
  totals = NULL,
  nest = NULL,
  ccov = NULL,
  tvcov = NULL,
  mu = ~1,
  re1 = ~1,
  re2 = ~1,
  preg = NULL,
  pre1 = NULL,
  pre2 = NULL,
  binom.mix = c(10, 10),
  binom.prob = c(0.5, 0.5),
  fcalls = 900,
  eps = 0.01,
  print.level = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A list of three column matrices with counts, corresponding
totals (not necessary if the response is binary), and (second-level)
nesting indicator for each individual, one matrix or dataframe of such
counts, or an object of class, response (created by
<code>restovec</code>) or repeated (created by
<code>rmna</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totals</code></td>
<td>
<p>If <code>response</code> is a matrix or dataframe, a corresponding
matrix or dataframe of totals (not necessary if the response is binary).
Ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nest</code></td>
<td>
<p>If <code>response</code> is a matrix or dataframe, a corresponding
matrix or dataframe of nesting indicators. Ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccov</code></td>
<td>
<p>If <code>response</code> is a matrix, dataframe, list, or object of
class, <code>response</code>, a matrix of time-constant covariates or an object
of class, <code>tccov</code> (created by <code>tcctomat</code>). All of
these covariates are used in the fixed effects part of the model. Ignored
if response has class, <code>repeated</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tvcov</code></td>
<td>
<p>If <code>response</code> is a matrix, dataframe, list, or object of
class, <code>response</code>, an object of class, <code>tvcov</code> (created by
<code>tvctomat</code>). All of these covariates are used in the
fixed effects part of the model. Ignored if response has class,
<code>repeated</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>If <code>response</code> has class, <code>repeated</code>, a formula
beginning with ~, specifying a linear regression function for the fixed
effects, in the Wilkinson and Rogers notation, containing selected
covariates in the response object. (A logit link is assumed.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re1</code></td>
<td>
<p>If <code>response</code> has class, <code>repeated</code>, a formula
beginning with ~, specifying a linear regression function for the variance
of the first level of nesting, in the Wilkinson and Rogers notation,
containing selected covariates in the response object. If NULL, a random
effect is not fitted at this level. (A log link is assumed.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re2</code></td>
<td>
<p>If <code>response</code> has class, <code>repeated</code>, a formula
beginning with ~, specifying a linear regression function for the variance
of the second level of nesting, in the Wilkinson and Rogers notation,
containing selected covariates in the response object. If NULL, a random
effect is not fitted at this level. (A log link is assumed.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preg</code></td>
<td>
<p>Initial parameter estimates for the fixed effect regression
model: either the model specified by <code>mu</code> or else the intercept plus
one for each covariate in <code>ccov</code> and <code>tvcov</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre1</code></td>
<td>
<p>Initial parameter estimates for the first level of nesting
variance model: either the model specified by <code>re1</code> or just the
intercept. If NULL, a random effect is not fitted at this level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre2</code></td>
<td>
<p>Initial parameter estimates for the second level of nesting
variance model: either the model specified by <code>re1</code> or just the
intercept. If NULL, a random effect is not fitted at this level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binom.mix</code></td>
<td>
<p>A vector of two values giving the totals for the binomial
distributions used as the mixing distributions at the two levels of
nesting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binom.prob</code></td>
<td>
<p>A vector of two values giving the probabilities in the
binomial distributions used as the mixing distributions at the two levels
of nesting. If they are 0.5, the mixing distributions approximate normal
mixing distributions; otherwise, they are skewed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fcalls</code></td>
<td>
<p>Number of function calls allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>If 1, the iterations are printed out.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variance components at the two levels can only depend on the covariates
if <code>response</code> has class, <code>repeated</code>.
</p>


<h3>Value</h3>

<p>A list of classes <code>binnest</code> is returned.
</p>


<h3>Author(s)</h3>

<p>T.R. Ten Have and J.K. Lindsey
</p>


<h3>References</h3>

<p>Ten Have, T.R., Kunselman, A.R., and Tran, L. (1999) Statistics
in Medicine 18, 947-960.
</p>


<h3>See Also</h3>

<p><code>gar</code>, <code>read.list</code>,
<code>restovec</code>, <code>rmna</code>,
<code>tcctomat</code>, <code>tvctomat</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#y &lt;- rbind(matrix(rbinom(20,1,0.6), ncol=4),
#	matrix(rbinom(20,1,0.4), ncol=4))
y &lt;- matrix(c(1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,0,1,0,1,1,0,1,0,
              1,1,1,1,1,1,1,1,0,1,1,0),nrow=10,ncol=4,byrow=TRUE)
resp &lt;- restovec(y, nest=1:4, times=FALSE)
ccov &lt;- tcctomat(c(rep(0,5),rep(1,5)), name="treatment")
reps &lt;- rmna(resp, ccov=ccov)

# two random effects
binnest(reps, mu=~treatment, preg=c(1,1), pre1=2, pre2=2)

# first level random effect only
binnest(reps, mu=~treatment, preg=c(1,-1), pre1=1)

# second level random effect only
binnest(reps, mu=~treatment, preg=c(1,-1), pre2=1)

</code></pre>


</div>