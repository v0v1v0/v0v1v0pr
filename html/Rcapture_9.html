<div class="container">

<table style="width: 100%;"><tr>
<td>closedp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Loglinear Models for Closed Population Capture-Recapture Experiments </h2>

<h3>Description</h3>

<p>The functions <code>closedp.t</code> and <code>closedp.0</code> fit various loglinear models for closed populations in 
capture-recapture experiments. For back compatibility, <code>closedp.t</code> is also named <code>closedp</code>.
</p>
<p><code>closedp.t</code> fits more models than <code>closedp.0</code> but for data set with more than 20 capture occasions, the function might fail. However, <code>closedp.0</code> works with fairly large data sets (see <b>Details</b>).     
</p>


<h3>Usage</h3>

<pre><code class="language-R">closedp(X, dfreq=FALSE, neg=TRUE, ...)
closedp.t(X, dfreq=FALSE, neg=TRUE, ...)

closedp.0(X, dfreq=FALSE, dtype=c("hist","nbcap"), t=NULL, t0=NULL, 
          neg=TRUE, ...)

## S3 method for class 'closedp'
print(x, ...)

## S3 method for class 'closedp'
boxplot(x, main="Boxplots of Pearson Residuals", ...)

## S3 method for class 'closedp'
plot(x, main="Residual plots for some heterogeneity models", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> The matrix of the observed capture histories (see <code>Rcapture-package</code> 
for a description of the accepted formats).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfreq</code></td>
<td>
<p> A logical. By default <code>FALSE</code>, which means that <code>X</code> has one row per unit. 
If <code>TRUE</code>, it indicates that the matrix <code>X</code> contains frequencies in its last column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtype</code></td>
<td>
<p> A characters string, either <code>"hist"</code> or <code>"nbcap"</code>, to specify the type of data. 
<code>"hist"</code>, the default, means that <code>X</code> contains complete observed capture histories. 
<code>"nbcap"</code> means that <code>X</code> contains numbers of captures (see <code>Rcapture-package</code> 
for details on data formats). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p> Requested only if <code>dtype="nbcap"</code>. A numeric specifying the total number of 
capture occasions in the experiment. For <code>closedp.0</code>, the value <code>t=Inf</code>
is accepted. It indicates that captures occur in continuous time 
(see <code>Rcapture-package</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p> A numeric. Models are fitted considering only the frequencies of units captured 1 to <code>t0</code> times. 
By default, if <code>t</code> is not equal to <code>Inf</code>, <code>t0=t</code>. When <code>t=Inf</code>, the default value
of <code>t0</code> is the larger number of captures observed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg</code></td>
<td>
<p> If this option is set to TRUE, negative eta parameters in Chao's lower 
bound models are set to zero (see <b>Details</b>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Further arguments to be passed to <code>glm</code>, <code>print.default</code>,
<code>boxplot.default</code> or <code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> An object, produced by a <code>closedp</code> function, to print or to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p> A main title for the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>closedp.t</code> fits models M0, Mt, Mh Chao (LB), Mh Poisson2, Mh Darroch, Mh Gamma3.5, 
Mth Chao (LB), Mth Poisson2, Mth Darroch, Mth Gamma3.5, Mb and Mbh. <code>closedp.0</code> fits 
only models M0, Mh Chao (LB), Mh Poisson2, Mh Darroch and Mh Gamma3.5. However, 
<code>closedp.0</code> can be used with larger data sets than <code>closedp.t</code>. 
This is explained by the fact that <code>closedp.t</code> fits models using the frequencies of 
the observable capture histories (vector of size <code class="reqn">2^t-1</code>), whereas <code>closedp.0</code> 
uses the numbers of units captured i times, for <code class="reqn">i=1,\ldots,t</code> (vector of size <code class="reqn">t</code>). 
See <code>Rcapture-package</code> for more details about the distinction between <code>.t</code>
and <code>.0</code> functions.
</p>
<p>Multinomial profile confidence intervals for the abundance are constructed by <code>closedpCI.t</code> 
and <code>closedpCI.0</code>.
</p>
<p>To calculate bias corrected abundance estimates, use the <code>closedp.bc</code> function.<br></p>
<p>CHAO'S LOWER BOUND MODEL
</p>
<p>Chao's (or LB) models estimate a lower bound for the abundance, both with a time 
effect (Mth Chao) and without one (Mh Chao). The estimate obtained under Mh Chao is Chao's (1987) 
moment estimator. Rivest and Baillargeon (2007) exhibit a loglinear model underlying this 
estimator and provide a generalization to Mth. For these two models, a small deviance means 
that there is an heterogeneity in capture probabilities; it does not mean that the lower 
bound estimate is unbiased. To test whether a certain model for heterogeneity is adequate,
one can conduct a likelihood ratio test by subtracting the deviance of Chao's model
to the deviance of the heterogeneous model under study. If this heterogeneous model
includes a time effect, it must be compared to model Mth Chao. If it does not include a time
effect, it must be compared to model Mh Chao. 
Under the null hypothesis of equivalence between the two models, the difference of deviances 
follows a chi-square distribution with degrees of freedom equal to the difference between 
the models' degrees of freedom.
</p>
<p>Chao's lower bound models contain <code class="reqn">t-2</code> parameters, called
eta parameters, for the heterogeneity. These parameters should theoretically be greater 
or equal to zero (see Rivest and Baillargeon (2007)). When the argument <code>neg</code> is set 
to <code>TRUE</code> (the default), negative eta parameters are set to zero (to do so, columns are
removed from the design matrix of the model). Degrees of freedom of Chao's model increase 
when eta parameters are set to zero.<br></p>
<p>OTHER MODELS FOR HETEROGENEITY
</p>
<p>Other models for heterogeneity are defined as follows :
</p>

<table>
<tr>
<td style="text-align: left;">
  Model </td>
<td style="text-align: left;"> Column for heterogeneity in the design matrix </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  Poisson2 </td>
<td style="text-align: left;"> <code class="reqn">2^k-1</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  Darroch  </td>
<td style="text-align: left;"> <code class="reqn">k^2/2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  Gamma3.5 </td>
<td style="text-align: left;"> <code class="reqn">-\log(3.5 + k) + \log(3.5)</code>
  </td>
</tr>
</table>
<p>where <code class="reqn">k</code> is the number of captures. Poisson and Gamma models with alternative to the 
parameter defaults values 2 and 3.5 can be fitted with the <code>closedpCI.t</code> and 
<code>closedpCI.0</code> functions.
</p>
<p>Darroch's models for Mh and Mth are considered by Darroch et al. (1993) and Agresti (1994). 
Poisson and Gamma models are discussed in Rivest and Baillargeon (2007). Poisson models 
typically yield smaller corrections for heterogeneity than Darroch's model since the capture 
probabilities are bounded from below under these models. On the other hand, Gamma models 
can lead to very large estimators of abundance. We suggest considering this estimator only in 
experiments where very small capture probabilities are likely.<br></p>
<p>PLOT METHODS AND FUNCTIONS
</p>
<p>The <code>boxplot.closedp</code> function produces boxplots of the Pearson residuals of the fitted loglinear models that converged.
</p>
<p>The <code>plot.closedp</code> function produces scatterplots of the Pearson residuals in terms of <code class="reqn">f_i</code> 
(number of units captured i times) for the heterogeneous models Mh Poisson2, Mh Darroch and Mh Gamma3.5 if they converged.  
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The number of captured units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p> The total number of capture occasions in the data matrix <code>X</code>.
When captures occur in continuous time (input argument <code>t=Inf</code>),
this output value is the larger number of captures observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p> For <code>closedp.0</code> only: the value of the argument <code>t0</code> used in the computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p> A table containing, for every fitted model:
</p>

<dl>
<dt>
<code>abundance</code>:</dt>
<dd>
<p>  the estimated population size,</p>
</dd>
<dt>
<code>stderr</code>:</dt>
<dd>
<p>  the standard error of the estimated population size,</p>
</dd>
<dt>
<code>deviance</code>:</dt>
<dd>
<p>  the model's deviance,</p>
</dd>
<dt>
<code>df</code>:</dt>
<dd>
<p>  the number of degrees of freedom,</p>
</dd>
<dt>
<code>AIC</code>:</dt>
<dd>
<p>  the Akaike's information criterion,</p>
</dd>
<dt>
<code>BIC</code>:</dt>
<dd>
<p>  the bayesian information criterion,</p>
</dd>
<dt>
<code>infoFit</code>:</dt>
<dd>
<p>  a numerical code giving information about error or warnings 
encountered when fitting the model (see <code>Rcapture-package</code> for details).</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias</code></td>
<td>
<p> A vector, the asymptotic bias of the estimated population size for every fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm</code></td>
<td>
<p> A list of the 'glm' objects obtained from fitting models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm.err</code></td>
<td>
<p> A list of character string vectors. If the <code>glm</code> function generates
an error when fitting a model, a copy of the error message is
stored in <code>glm.err$mname</code> where <code>mname</code> is a short name to identify
the model. A <code>NULL</code> list element means that no error occured for the considered model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm.warn</code></td>
<td>
<p> A list of character string vectors. If the <code>glm</code> function generates
one or more warnings when fitting a model, a copy of these warnings are
stored in <code>glm.warn$mname</code> where <code>mname</code> is a short name to identify
the model. A <code>NULL</code> list element means that <code>glm</code> did not 
produce any warnings for the considered model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p> Capture-recapture parameters estimates. It contains N, the estimated population size, 
and p or <code class="reqn">p_1</code> to <code class="reqn">p_t</code> defined as follows for the different models :
</p>

<dl>
<dt>M0:</dt>
<dd>
<p> the capture probability at any capture occasion,</p>
</dd>
<dt>Mt:</dt>
<dd>
<p> the capture probabilities for each capture occasion,</p>
</dd>
<dt>Mh models:</dt>
<dd>
<p> the average probability of capture,</p>
</dd> 
<dt>Mth models:</dt>
<dd>
<p> the average probabilities of capture for each occasion,</p>
</dd>
<dt>Mb and Mbh:</dt>
<dd>
<p> the probability of first capture at any capture occasion.</p>
</dd> 
</dl>
<p>For models Mb and Mbh, it also contains c, the recapture probability at any capture occasion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg.eta</code></td>
<td>
<p> The position of the eta parameters set to zero in the loglinear parameter 
vector of models MhC and MthC. <code>NULL</code> if no parameters are set to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> A copy of the data given as input in the function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfreq</code></td>
<td>
<p> A copy of the <code>dfreq</code> argument given in the function call.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> This function uses the <code>glm</code> function of the <span class="pkg">stats</span> package. </p>


<h3>Author(s)</h3>

<p> Louis-Paul Rivest <a href="mailto:Louis-Paul.Rivest@mat.ulaval.ca">Louis-Paul.Rivest@mat.ulaval.ca</a> and Sophie Baillargeon </p>


<h3>References</h3>

 
<p>Agresti, A. (1994) Simple capture-recapture models permitting unequal catchability and variable sampling effort. <em>Biometrics</em>, <b>50</b>, 494–500.
</p>
<p>Baillargeon, S. and Rivest, L.P. (2007) Rcapture: Loglinear models for capture-recapture in R.  <em>Journal of Statistical Software</em>, <b>19</b>(5), <a href="https://doi.org/10.18637/jss.v019.i05">doi:10.18637/jss.v019.i05</a>.
</p>
<p>Chao, A. (1987) Estimating the population size for capture-recapture data with unequal catchabililty.  <em> Biometrics</em>, <b>45</b>, 427–438.
</p>
<p>Darroch, S.E.,  Fienberg, G.,  Glonek, B. and Junker, B. (1993) A three sample multiple capture-recapture approach to the census population estimation with heterogeneous catchability. <em>Journal of the American Statistical Association</em>, <b>88</b>, 1137–1148.
</p>
<p>Rivest, L.P. and Levesque, T. (2001) Improved loglinear model estimators of abundance in capture-recapture experiments. <em>Canadian Journal of Statistics</em>, 29, 555–572.
</p>
<p>Rivest, L.P. and Baillargeon, S. (2007) Applications and extensions of Chao's moment estimator for the size of a closed population. <em>Biometrics</em>, <b>63</b>(4), 999–1006.
</p>
<p>Seber, G.A.F. (1982) The Estimation of Animal Abundance and Related Parameters, 2nd edition, New York: Macmillan.
</p>


<h3>See Also</h3>

<p><code>closedpCI.t</code>, <code>closedpCI.0</code>, <code>closedp.bc</code>, <code>closedp.Mtb</code>, <code>closedpMS.t</code>, <code>uifit</code>. </p>


<h3>Examples</h3>

<pre><code class="language-R"># hare data set
hare.closedp &lt;- closedp.t(hare)
hare.closedp
boxplot(hare.closedp)

# Third primary period of mvole data set
period3 &lt;- mvole[, 11:15]
closedp.t(period3)

# BBS2001 data set
BBS.closedp &lt;- closedp.0(BBS2001, dfreq = TRUE, dtype = "nbcap", t = 50, t0 = 20)
BBS.closedp
plot(BBS.closedp)

### Seber (1982) p.107
# When there is 2 capture occasions, the heterogeneity models cannot be fitted
X &lt;- matrix(c(1,1,167,1,0,781,0,1,254), byrow = TRUE, ncol = 3)
closedp.t(X, dfreq = TRUE)

### Example of captures in continuous time
# Illegal immigrants data set
closedp.0(ill, dtype = "nbcap", dfreq = TRUE, t = Inf)
</code></pre>


</div>