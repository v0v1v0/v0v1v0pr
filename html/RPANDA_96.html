<div class="container">

<table style="width: 100%;"><tr>
<td>paleodiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Paleodiversity through time
</h2>

<h3>Description</h3>

<p>Calculates paleodiversity through time from shift.estimates output with the deterministic approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  paleodiv(phylo, data, sampling.fractions, shift.res,
           backbone.option = "crown.shift", combi = 1,
           time.interval = 1, split.div = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data.frame containing a database of monophyletic groups for which potential shifts can be investigated. This database should be based on taxonomy, ecology or traits and contain a column named "Species" with species name as in phylo.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling.fractions</code></td>
<td>

<p>the output resulting from get.sampling.fractions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift.res</code></td>
<td>

<p>the output resulting from shift.estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backbone.option</code></td>
<td>

<p>type of the backbone analysis:
</p>
 
<ul>
<li>
<p>"stem.shift": paleodiversity dynamics are calculated from the stem age for subclades.
</p>
</li>
<li>
<p>"crown.shift": paleodiversity dynamics are calculated from the crown age for subclades.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combi</code></td>
<td>

<p>numeric. The combination of shifts defined by its rank in the global comparison.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.interval</code></td>
<td>

<p>numeric. Define the time interval (in million years) at which paleodiversity values are calculated. Default is 1 for a value at each million year.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.div</code></td>
<td>

<p>bolean. Specifies if paleodiversity should be plitted by parts of the selected combination (TRUE) or not. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If split.div = FALSE, paleodiversity dynamics are returned in a matrix with as many rows as parts in the selected combination and as many column as million years from the root to the present. If spit.div = TRUE, global paleodiversity dynamic is returned as a vector with a value per million year.
</p>


<h3>Author(s)</h3>

<p>Nathan Mazet</p>


<h3>References</h3>

<p>Mazet, N., Morlon, H., Fabre, P., Condamine, F.L., (2023). Estimating clade‐specific diversification rates and palaeodiversity dynamics from reconstructed phylogenies. <em>Methods in Ecology and in Evolution</em> 14, 2575–2591. https://doi.org/10.1111/2041-210X.14195
</p>


<h3>See Also</h3>

<p><code>shift.estimates, apply_prob_dtt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># loading data
data("Cetacea")
data("taxo_cetacea")
data("shifts_cetacea")

# no shifts tested at genus level
taxo_cetacea_no_genus &lt;- taxo_cetacea[names(taxo_cetacea) != "Genus"]
f_cetacea &lt;- get.sampling.fractions(phylo = Cetacea, lad = FALSE,
                                    data = taxo_cetacea_no_genus,
                                    plot = TRUE, cex = 0.3)
# use of paleodiv
paleodiversity &lt;- paleodiv(phylo = Cetacea,
                           data = taxo_cetacea_no_genus,
                           sampling.fractions = f_cetacea,
                           shift.res = shifts_cetacea,
                           combi = 1, split.div = FALSE)
</code></pre>


</div>