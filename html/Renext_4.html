<div class="container">

<table style="width: 100%;"><tr>
<td>barplotRenouv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Barplot for Renouv "Over Threshold" counts</h2>

<h3>Description</h3>

<p>Barplot for "Over Threshold" counts in time blocks (usually years)
</p>


<h3>Usage</h3>

<pre><code class="language-R"> barplotRenouv(data,
               blockname = colnames(data)[1],
               varname = colnames(data)[2],
               threshold = quantile(data[, varname], 0.2),
               na.block = NULL,
               plot = TRUE,
               main = NULL, xlab = NULL, ylab = NULL,
               mono = FALSE,
               prob.theo = 0.999,
               ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A dataframe object containing the variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockname</code></td>
<td>

<p>Name of the "block" variable (column in <code>data</code>). This variable
should contain integers, or be of class "factor", but with integer
values such as year numbers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varname</code></td>
<td>

<p>Name of the variable (e.g. <code>"Surge"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>

<p>Only obs for which the variable exceeds <code>threshold</code> will be
taken into account.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.block</code></td>
<td>

<p>Values of blocks containing missing values. See the Details section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>If <code>FALSE</code> tests are computed without producing any plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Character for main title or <code>NULL</code> in which case a default main
title is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>Character for x axis label or <code>NULL</code> in which case a default
lab is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>Character for y axis or <code>NULL</code> in which case a default lab is
used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mono</code></td>
<td>

<p>If <code>FALSE</code> barplot will have colors, else greyscale will be
used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.theo</code></td>
<td>

<p>The total theoretical probability corresponding to the plotted
(theoretical) bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further args to be passed to
<code>barplot</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Blocks described in the <code>na.block</code> are omitted in the
determination of counts. The object given in the <code>na.block</code> is
coerced to character and the same is done for values of <code>block</code>
before comparing them to the <code>na.block</code> values.  If <code>block</code>
variable is of class factor with levels representing years
(e.g. 1980, 1981, etc.) missing blocks can be specified either as
<code>c("1980", "1981")</code> or as numeric <code>c(1980, 1981)</code>.
</p>
<p>For the chi-square test, counts for neighbouring frequency classes are
grouped in order to reach a minimum frequency of <code>5</code> in each
group. E.g. if we expect respectively <code>1.0</code>, <code>3.8</code> and
<code>7.0</code> blocks with frequency <code>0</code>, <code>1</code> and <code>2</code> for
events, the three counts are grouped in one group with frequency
<code>1.0+3.8+7.0=11.8</code>. Note that this strategy of grouping is not
unique and is likely to weaken the power of the test. Before
grouping, the higher class theoretical probability is computed as the
probability to obtain a count equal to or greater than the max value.
</p>


<h3>Value</h3>

<p>A list with the following objects.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>

<p>frequency table (matrix) giving observed and theoretical (Poisson)
frequencies as well as a group number for the chi-square test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overdispersion</code></td>
<td>

<p>the overdispersion coefficient (variance/mean ratio).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.test</code></td>
<td>

<p>a list giving results of the (over)dispersion
test. See the reference Yagouti and al. in the <b>References</b>
section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq.test</code></td>
<td>

<p>a list giving results for the chis-square test of goodness-of-fit to
the Poisson distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tests</code></td>
<td>
<p>a matrix with the two tests displayed in two rows.</p>
</td>
</tr>
</table>
<p>For both tests, the statistic follows a chi-square distribution under the
null hypothesis . The list of results contains the statistic
<code>statistic</code>, the number of degrees of freedom <code>df</code> and 
the <code class="reqn">p</code>-value <code>p.value</code>.
</p>


<h3>Note</h3>

<p>The two tests: (over-)dispersion and chi-square have <em>one-sided</em> (upper
tail) <code class="reqn">p</code>-value. In other words, we do not intend to reject when
statistics take "abnormally small" values, but only when abnormally
large values are met.
</p>





<h3>Author(s)</h3>

<p>Yves Deville</p>


<h3>References</h3>

<p>See Yagouti A., Abi-Zeid I., Ouarda, T.B.M.J. and
B. Bobée (2001), Revue de processus ponctuels et
synthèse de tests statistiques pour le choix d'un type
de processus <em>Revue des Sciences de l'Eau</em>, <b>1</b>,
pp. 323-361.
</p>


<h3>See Also</h3>

<p><code>plot.Rendata</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## na.block influence for Brest data
opar &lt;- par(mfrow = c(2, 2))

bp1 &lt;- barplotRenouv(data = Brest.years, threshold = 30,
         main = "missing periods ignored")
bp2 &lt;- barplotRenouv(data = Brest.years, threshold = 30,
         na.block = 1992, main = "1992 missing")
bp3 &lt;- barplotRenouv(data = Brest.years, threshold = 30,
         na.block = 1991:1993, main ="1991:1993 missing")
bp4 &lt;- barplotRenouv(data = Brest.years, threshold = 30,
         na.block = Brest.years.missing, main = "all missing periods")

par(opar)

## threshold influence
opar &lt;- par(mfrow = c(2,2))

thresh &lt;- c(30, 35, 40, 50)

for (i in 1:length(thresh)) {
  bp  &lt;- barplotRenouv(data = Brest.years, threshold = thresh[i],
                   na.block = Brest.years.missing,
                   main = paste("threshold =", thresh[i], "cm at Brest"))
}
par(opar)
</code></pre>


</div>