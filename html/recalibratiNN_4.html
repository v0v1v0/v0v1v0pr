<div class="container">

<table style="width: 100%;"><tr>
<td>gg_PIT_local</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots Density Distributions of PIT-values for Global Calibration Diagnostics</h2>

<h3>Description</h3>

<p>A function based on ggplot2 to observe the density of PIT-values locally. It is recommended
to use PIT-values obtained via the <code>PIT_local</code> function from this package or an object of
equivalent format. For advanced customization of the plot layers, refer to the ggplot2 User Guide.This function also tests the PIT-values
for uniformity using the Kolmogorov-Smirnov test (<code>ks.test</code>). The p-value from the test is printed on the plot if <code>facet</code> is set to <code>TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gg_PIT_local(
  pit_local,
  alpha = 0.4,
  linewidth = 1,
  pal = "Set2",
  facet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pit_local</code></td>
<td>
<p>A tibble with five columns: "part", "y_cal", "y_hat", "pit", and "n",
representing the partitions, calibration data, predicted values, PIT-values,
and the count of observations, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value between 0 and 1 indicating the transparency of the plot fill.
Default is set to 0.4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linewidth</code></td>
<td>
<p>Integer specifying the linewidth of the density line. Default is set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pal</code></td>
<td>
<p>A character string specifying the RColorBrewer palette to be used for coloring
the plot. Default is "Set2".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet</code></td>
<td>
<p>Logical indicating whether to use <code>facet_wrap()</code> to separate different covariate regions
in the visualization. If TRUE, the p-value from the Kolmogorov-Smirnov test is printed on the plot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>ggplot</code> object representing the local density distributions of PIT-values,
which can be further customized through ggplot2 functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> n &lt;- 10000
 mu &lt;- function(x1){
  10 + 5*x1^2
  }

sigma_v &lt;- function(x1){
 30*x1
}

x &lt;- runif(n, 2, 20)
y &lt;- rnorm(n, mu(x), sigma_v(x))

x_train &lt;- x[1:(n*0.8)]
y_train &lt;- y[1:(n*0.8)]

x_cal &lt;- x[(n*0.8+1):n]
y_cal &lt;- y[(n*0.8+1):n]

model &lt;- lm(y_train ~ x_train)

y_hat &lt;- predict(model, newdata=data.frame(x_train=x_cal))

MSE_cal &lt;- mean((y_hat - y_cal)^2)

pit_local &lt;- PIT_local(xcal = x_cal, ycal=y_cal, yhat=y_hat, mse=MSE_cal)

gg_PIT_local(pit_local)
gg_PIT_local(pit_local, facet=TRUE)
</code></pre>


</div>