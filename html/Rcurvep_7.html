<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_dataset_bmr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate benchmark response (BMR) for each dataset</h2>

<h3>Description</h3>

<p>Currently two methods have been implemented to get the "keen-point" from the variance(y) - threshold(x) curve.
One is to use the original y values to draw a straight line between the lowest x value (p1) to highest x value (p2).
The knee-point is the x that has the longest distance to the line.
The other one is to fit the data first then use the fitted responses to do the same analysis.
Currently the first method is preferred.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_dataset_bmr(d, p1 = NULL, p2 = NULL, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>The rcurvep object with multiple samples and TRSHs. See <code>combi_run_rcurvep()</code> for an example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>Default = NULL, or an integer value to manually set the first index of line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>Default = NULL, or an integer value to manually set the last index of line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Default = TRUE, plot the diagnostic plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimated BMR can be used in the calculation of POD.
For example, if bmr = 25.
For Curvep, <code>combi_run_rcurvep(zfishbeh, TRSH = 25)</code>.<br>
For Hill fit, <code>summarize_fit_output(run_fit(zfishbeh, modls = "hill"), thr_resp = 25, extract_only = TRUE)</code>.
</p>


<h3>Value</h3>

<p>A list with two components: stats and outcome.
</p>

<ul>
<li>
<p> stats: a tibble, including pooled variance (pvar),
fitted responses (y_exp_fit, y_lm_fit), distance to the line (dist2l)
</p>
</li>
<li>
<p> outcome: a tibble, including estimated BMRs (bmr)
</p>
</li>
</ul>
<p>;
Suffix in the <strong>stats</strong> and <strong>outcome</strong> tibble: "ori" (original values), "exp"(exponential fit).
prefix in the <strong>outcome</strong> tibble, "cor" (correlation between the fitted responses and the original responses),
"bmr" (benchmark response), "qc" (quality control).
</p>


<h3>See Also</h3>

<p><code>cal_knee_point()</code>, <code>combi_run_rcurvep()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# no extra cleaning
data(zfishdev_act)
bmr_out &lt;- estimate_dataset_bmr(zfishdev_act, plot = FALSE)
plot(bmr_out)

# if want to do extra cleaning...
actm &lt;- summarize_rcurvep_output(zfishdev_act, clean_only = TRUE, inactivate = "CARRY_OVER")

bmr_out &lt;- estimate_dataset_bmr(actm, plot = FALSE)


</code></pre>


</div>