<div class="container">

<table style="width: 100%;"><tr>
<td>n_gram_merge</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Value merging based on ngram fingerprints</h2>

<h3>Description</h3>

<p>This function takes a character vector and makes edits and merges values
that are approximately equivalent yet not identical. It uses a two step
process, the first is clustering values based on their ngram fingerprint (described here
<a href="https://openrefine.org/docs/technical-reference/clustering-in-depth">https://openrefine.org/docs/technical-reference/clustering-in-depth</a>).
The second step is merging values based on approximate string matching of
the ngram fingerprints, using the [sd_lower_tri()] C function from the
package <code>stringdist</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">n_gram_merge(
  vect,
  numgram = 2,
  ignore_strings = NULL,
  bus_suffix = TRUE,
  edit_threshold = 1,
  weight = c(d = 0.33, i = 0.33, s = 1, t = 0.5),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vect</code></td>
<td>
<p>Character vector, items to be potentially clustered and merged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numgram</code></td>
<td>
<p>Numeric value, indicating the number of characters that
will occupy each ngram token. Default value is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_strings</code></td>
<td>
<p>Character vector, these strings will be ignored during
the merging of values within <code>vect</code>. Default value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bus_suffix</code></td>
<td>
<p>Logical, indicating whether the merging of records should
be insensitive to common business suffixes or not. Default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edit_threshold</code></td>
<td>
<p>Numeric value, indicating the threshold at which a
merge is performed, based on the sum of the edit values derived from
param <code>weight</code>. Default value is 1. If this parameter is
set to 0 or NA, then no approximate string matching will be done, and all
merging will be based on strings that have identical ngram fingerprints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Numeric vector, indicating the weights to assign to
the four edit operations (see details below), for the purpose of
approximate string matching. Default values are
c(d = 0.33, i = 0.33, s = 1, t = 0.5). This parameter gets passed along
to the <code>stringdist</code> function. Must be either
a numeric vector of length four, or NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional args to be passed along to the <code>stringdist</code>
function. The acceptable args are identical to those of
[stringdistmatrix()].</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The values of arg <code>weight</code> are edit distance values that
get passed to the <code>stringdist</code> edit distance function. The
param takes four arguments, each one is a specific type of edit, with
default penalty value.
</p>

<ul>
<li>
<p> d: deletion, default value is 0.33
</p>
</li>
<li>
<p> i: insertion, default value is 0.33
</p>
</li>
<li>
<p> s: substitution, default value is 1
</p>
</li>
<li>
<p> t: transposition, default value is 0.5
</p>
</li>
</ul>
<h3>Value</h3>

<p>Character vector with similar values merged.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- c("Acme Pizza, Inc.", "ACME PIZA COMPANY", "Acme Pizzazza LLC")

n_gram_merge(vect = x)

# The performance of the approximate string matching can be ajusted using
# parameters 'weight' or 'edit_threshold'
n_gram_merge(vect = x,
             weight = c(d = 0.4, i = 1, s = 1, t = 1))

# Use parameter 'ignore_strings' to ignore specific strings during merging
# of values.
x &lt;- c("Bakersfield Highschool", "BAKERSFIELD high",
       "high school, bakersfield")
n_gram_merge(vect = x, ignore_strings = c("high", "school", "highschool"))

</code></pre>


</div>