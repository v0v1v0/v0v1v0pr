<div class="container">

<table style="width: 100%;"><tr>
<td>RRlog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Logistic randomized response regression</h2>

<h3>Description</h3>

<p>A dichotomous variable, measured once or more per person by a randomized
response method, serves as dependent variable using one or more continuous
and/or categorical predictors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RRlog(
  formula,
  data,
  model,
  p,
  group,
  n.response = 1,
  LR.test = TRUE,
  fit.n = 3,
  EM.max = 1000,
  optim.max = 500,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>specifying the regression model, see <code>formula</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>data.frame</code>, in which variables can be found (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Available RR models: <code>"Warner"</code>, <code>"UQTknown"</code>,
<code>"UQTunknown"</code>, <code>"Mangat"</code>, <code>"Kuk"</code>, <code>"FR"</code>,
<code>"Crosswise"</code>, <code>"Triangular"</code>, <code>"CDM"</code>, <code>"CDMsym"</code>,
<code>"SLD"</code>, <code>"custom"</code>. See <code>vignette("RRreg")</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>randomization probability/probabilities (depending on model, see
<code>RRuni</code> for details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>vector specifying group membership. Can be omitted for
single-group RR designs (e.g., Warner). For two-group RR designs (e.g.,
<code>CDM</code> or <code>SLD</code>), use 1 and 2 to indicate the group membership,
matching the respective randomization probabilities <code>p[1], p[2]</code>. If
an RR design and a direct question (DQ) were both used in the study, the
group indices are set to 0 (DQ) and 1 (RR; 1 or 2 for two-group RR
designs). This can be used to test, whether the RR design leads to a
different prevalence estimate by including a dummy variable for the
question format (RR vs. DQ) as predictor. If the corresponding regression
coefficient is significant, the prevalence estimates differ between RR and
DQ. Similarly, interaction hypotheses can be tested (e.g., the correlation
between a sensitive attribute and a predictor is only found using the RR
but not the DQ design). Hypotheses like this can be tested by including the
interaction of the DQ-RR-dummy variable and the predictor in <code>formula</code>
(e.g., <code>RR ~ dummy*predictor</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.response</code></td>
<td>
<p>number of responses per participant, e.g., if a participant
responds to 5 RR questions with the same randomization probability <code>p</code>
(either a single number if all participants give the same number of
responses or a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LR.test</code></td>
<td>
<p>test regression coefficients by a likelihood ratio test, i.e.,
fitting the model repeatedly while excluding one parameter at a time (each
nested model is fitted only once, which can result in local maxima). The
likelihood-ratio test statistic <code class="reqn">G^2(df=1)</code> is reported in the table of
coefficiencts as <code>deltaG2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.n</code></td>
<td>
<p>Number of fitting replications using random starting values to
avoid local maxima</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM.max</code></td>
<td>
<p>maximum number of iterations of the EM algorithm. If
<code>EM.max=0</code>, the EM algorithm is skipped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.max</code></td>
<td>
<p>Maximum number of iterations within each run of <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The logistic regression model is fitted first by an EM algorithm, in
which the dependend RR variable is treated as a misclassified binary
variable (Magder &amp; Hughes, 1997). The results are used as starting values
for a Newton-Raphson based optimization by <code>optim</code>.
</p>


<h3>Value</h3>

<p>Returns an object <code>RRlog</code> which can be analysed by the generic
method <code>summary</code>. In the table of coefficients, the column
<code>Wald</code> refers to the Chi^2 test statistic which is computed as Chi^2 =
z^2 = Estimate^2/StdErr^2. If <code>LR.test = TRUE</code>, the test statistic
<code>deltaG2</code> is the likelihood-ratio-test statistic, which is computed by
fitting a nested logistic model without the corresponding predictor.
</p>


<h3>Author(s)</h3>

<p>Daniel W. Heck
</p>


<h3>References</h3>

<p>van den Hout, A., van der Heijden, P. G., &amp; Gilchrist, R. (2007).
The logistic regression model with response variables subject to randomized 
response. <em>Computational Statistics &amp; Data Analysis, 51</em>, 6060-6069.
</p>


<h3>See Also</h3>

<p><code>anova.RRlog</code> for model comparisons, <code>plot.RRlog</code> 
for plotting predicted regression curves, and <code>vignette('RRreg')</code> or
<a href="https://www.dwheck.de/vignettes/RRreg.html">https://www.dwheck.de/vignettes/RRreg.html</a> for a
detailed description of the RR models and the appropriate definition of
<code>p</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate data set without biases
dat &lt;- RRgen(1000, pi = .3, "Warner", p = .9)
dat$covariate &lt;- rnorm(1000)
dat$covariate[dat$true == 1] &lt;- rnorm(sum(dat$true == 1), .4, 1)
# analyse
ana &lt;- RRlog(response ~ covariate, dat, "Warner", p = .9, fit.n = 1)
summary(ana)
# check with true, latent states:
glm(true ~ covariate, dat, family = binomial(link = "logit"))
</code></pre>


</div>