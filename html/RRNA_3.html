<div class="container">

<table style="width: 100%;"><tr>
<td>aptPlotCT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
RNA secondary structure plotting from CT files
</h2>

<h3>Description</h3>

<p>Generates and RNA secondary structure plot from a CT file. Removes pseudoKnots automatically and allows them to be drawn back in with pseudoTF=TRUE.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aptPlotCT(file, ranges = 0, add = FALSE, hl = NULL, seqcols = NULL,
          seqTF = FALSE, labTF = FALSE, nt = FALSE, dp = 0.5, 
          modspec = FALSE, modp = NULL, mod = NULL, modcol = NULL, 
          tsize = 0.5, main = "", pseudoTF = FALSE, pseudo_nums = NULL, 
          ticks = NULL, ticksTF = FALSE
         )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>CT file name
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranges</code></td>
<td>

<p>A data frame containing the ranges of sequence positions that should be highlighted with given colors.
<code>
ranges=data.frame(min=c(69,1,7),max=c(74,5,17),col=c(2,3,4),desc=c("Region 1","Region 2","Region 3"))
</code>
The above will highlight the nucleotides at positions 69-74, 1-5, and 7-17 respectively 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>Should the new plot be added to an existing plot TRUE/FALSE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hl</code></td>
<td>

<p>Takes an array of sequences and highlights them with seqcol
<code>hl=c("GGGAAAA","GGGCCCC")</code>
The above hl will highlight the nucleotides in the secondary structure that have the given sequences with the colors provided in the seqcols option.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqcols</code></td>
<td>

<p>Colors that should be used to highlight the sequences given in hl
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqTF</code></td>
<td>

<p>If sequence is a vector set as TRUE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labTF</code></td>
<td>

<p>TRUE/FALSE plot the legend
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nt</code></td>
<td>

<p>TRUE/FALSE plot the nucleotide sequence on the secondary structure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>

<p>Floating point value to determine how far from the coordinates the nucleotide sequence should be plotted. Values between 0 and 5 usually work best. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modspec</code></td>
<td>

<p>TRUE/FALSE modify specific positions in the secondary structure. Used in combination with modp,mod,and modcol. This allows you to change the shape and color of nucleotide in the secondary structure. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modp</code></td>
<td>

<p>Array defining the specific positions to be modified in the plot
<code>
modp=c(1:10)
</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>

<p>Array defining the pch values to be plotted at the positions given by modp. 
<code>
mod=c(rep(15,5),rep(16,5))
</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modcol</code></td>
<td>

<p>Array of color values to be used for plotting at the positions defined by modp in the secondary structure. 
<code>
modcol=rep(4,10)
</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsize</code></td>
<td>

<p>Text size used for plotting the nucleotide sequence in the secondary structure. Only applicable when nt=TRUE. Values between 0.1 and 4 work well. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Title used for the plot when labTF is set to TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pseudoTF</code></td>
<td>

<p>Plot pseudo knot sequences
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pseudo_nums</code></td>
<td>

<p>indices of the nucleotides included in pseudoknots
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticksTF</code></td>
<td>

<p>TRUE/FALSE include ticks 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticks</code></td>
<td>

<p>Positions where the ticks should be drawn. These are sequence positions in the RNA molecule
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns and R plot object
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code>RNAPlot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### PseudoKnots ###
pk= makeCt("((((...(((((((.........)))))))...((((.........))))...))))",
          "AAAAAAAACCCCCCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC"
         )
pk$bound[pk$pos==20]=42
pk$bound[pk$pos==19]=43
pk$bound[pk$pos==43]=19
pk$bound[pk$pos==42]=20
f = tempfile()
### Create a CT file for testing ###
write.table(pk[,c(1,4,2,3,6,5)],file=f,row.names=FALSE,col.names=TRUE)

aptPlotCT(f,ticksTF=TRUE,ticks=seq(1,60,by=5),pseudoTF=TRUE,pseudo_nums=c(19,20,43,42))

</code></pre>


</div>