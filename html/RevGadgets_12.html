<div class="container">

<table style="width: 100%;"><tr>
<td>plotDiversityOBDP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Diversity Distribution from OBDP Analysis</h2>

<h3>Description</h3>

<p>Plots the probability distribution of the number of lineages through time inferred with the 
Occurrence Birth Death Process
#'
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotDiversityOBDP(
  Kt_mean,
  xlab = "Time",
  ylab = "Number of lineages",
  xticks_n_breaks = 5,
  col_Hidden = "dodgerblue3",
  col_LTT = "gray25",
  col_Total = "forestgreen",
  col_Hidden_interval = "dodgerblue2",
  col_Total_interval = "darkolivegreen4",
  palette_Hidden = c("transparent", "dodgerblue2", "dodgerblue3", "dodgerblue4", "black"),
  palette_Total = c("transparent", "green4", "forestgreen", "black"),
  line_size = 0.7,
  interval_line_size = 0.5,
  show_Hidden = TRUE,
  show_LTT = TRUE,
  show_Total = TRUE,
  show_intervals = TRUE,
  show_densities = TRUE,
  show_expectations = TRUE,
  use_interpolate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Kt_mean</code></td>
<td>
<p>(data.frame; no default) The processed data.frame (output of readOBDP()).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>(character; "Time") The label of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>(character; "Number of lineages") The label of the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xticks_n_breaks</code></td>
<td>
<p>(numeric; 5) An integer guiding the number of major breaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_Hidden</code></td>
<td>
<p>(character; "dodgerblue3") The color of the hidden lineages plot line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_LTT</code></td>
<td>
<p>(character; "gray25") The color of the LTT plot line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_Total</code></td>
<td>
<p>(character; "forestgreen") The color of the total lineages plot line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_Hidden_interval</code></td>
<td>
<p>(character; "dodgerblue2") The color of the credible interval lines around the hidden lineages plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_Total_interval</code></td>
<td>
<p>(character; "darkolivegreen4") The color of the credible interval lines around the total lineages plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette_Hidden</code></td>
<td>
<p>(character; c("transparent", "dodgerblue2", "dodgerblue3", "dodgerblue4", "black")) The palette of the hidden lineages plot distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette_Total</code></td>
<td>
<p>(character; c("transparent", "green4", "forestgreen", "black")) The palette of the total lineages plot distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line_size</code></td>
<td>
<p>(numeric; 0.7) The width of the lineage plot line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval_line_size</code></td>
<td>
<p>(numeric; 0.5) The width of the credible interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_Hidden</code></td>
<td>
<p>(boolean; TRUE) Whether to show the plot for hidden lineages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_LTT</code></td>
<td>
<p>(boolean; TRUE) Whether to show the plot for observed lineages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_Total</code></td>
<td>
<p>(boolean; TRUE) Whether to show the plot for total lineages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_intervals</code></td>
<td>
<p>(boolean; TRUE) Whether to show the credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_densities</code></td>
<td>
<p>(boolean; TRUE) Whether to show the diversity densities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_expectations</code></td>
<td>
<p>(boolean; TRUE) Whether to show the diversity expectations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_interpolate</code></td>
<td>
<p>(boolean; TRUE) Whether to interpolate densities.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# first run readOBDP()
start_time_trace_file &lt;- 
     system.file("extdata", "obdp/start_time_trace.p", package="RevGadgets")
popSize_distribution_matrices_file &lt;- 
     system.file("extdata", "obdp/Kt_trace.p", package="RevGadgets")
trees_trace_file &lt;- 
     system.file("extdata", "obdp/mcmc_OBDP_trees.p", package="RevGadgets")
    
Kt_mean &lt;- readOBDP( start_time_trace_file=start_time_trace_file, 
                     popSize_distribution_matrices_file=popSize_distribution_matrices_file, 
                     trees_trace_file=trees_trace_file )

# then get the customized ggplot object with plotDiversityOBDP()
p &lt;- plotDiversityOBDP( Kt_mean,
                        xlab="Time (My)",
                        ylab="Number of lineages",
                        xticks_n_breaks=21,
                        col_Hidden="dodgerblue3",
                        col_LTT="gray25",
                        col_Total="forestgreen",
                        col_Hidden_interval="dodgerblue2",
                        col_Total_interval="darkolivegreen4",
                        palette_Hidden=c("transparent", "dodgerblue2", "dodgerblue3", 
                                         "dodgerblue4", "black"),
                        palette_Total=c("transparent", "green4", "forestgreen", "black"),
                        line_size=0.7,
                        interval_line_size=0.5,
                        show_Hidden=TRUE,
                        show_LTT=TRUE,
                        show_Total=TRUE,
                        show_intervals=TRUE,
                        show_densities=TRUE,
                        show_expectations=TRUE,
                        use_interpolate=TRUE )

# basic plot
p

# option: add a stratigraphic scale
library(deeptime)
library(ggplot2)
q &lt;- gggeo_scale(p, dat="periods", height=unit(1.3, "line"), abbrv=F, size=4.5, neg=T)
r &lt;- gggeo_scale(q, dat="epochs", height=unit(1.1, "line"), abbrv=F, size=3.5, neg=T, 
                    skip=c("Paleocene", "Pliocene", "Pleistocene", "Holocene"))
s &lt;- gggeo_scale(r, dat="stages", height=unit(1, "line"), abbrv=T, size=2.5, neg=T)
s

## End(Not run)

</code></pre>


</div>