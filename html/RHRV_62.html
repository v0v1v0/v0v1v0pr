<div class="container">

<table style="width: 100%;"><tr>
<td>CalculateInfDim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Information dimension of the RR time series</h2>

<h3>Description</h3>

<p>Information dimension of the RR time series
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalculateInfDim(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  minEmbeddingDim = NULL,
  maxEmbeddingDim = NULL,
  timeLag = NULL,
  minFixedMass = 1e-04,
  maxFixedMass = 0.005,
  numberFixedMassPoints = 50,
  radius = 1,
  increasingRadiusFactor = 1.05,
  numberPoints = 500,
  theilerWindow = 100,
  doPlot = TRUE
)

EstimateInfDim(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  regressionRange = NULL,
  useEmbeddings = NULL,
  doPlot = TRUE
)

PlotInfDim(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HRVData</code></td>
<td>
<p>Data structure that stores the beats register and information related to it</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexNonLinearAnalysis</code></td>
<td>
<p>Reference to the data structure that will contain the nonlinear analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minEmbeddingDim</code></td>
<td>
<p>Integer denoting the minimum dimension in which we shall embed the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxEmbeddingDim</code></td>
<td>
<p>Integer denoting the maximum dimension in which we shall embed the time series.
Thus, we shall estimate the correlation dimension between <em>minEmbeddingDim</em> and <em>maxEmbeddingDim</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeLag</code></td>
<td>
<p>Integer denoting the number of time steps that will be use to construct the 
Takens' vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minFixedMass</code></td>
<td>
<p>Minimum percentage of the total points that the algorithm shall use for the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxFixedMass</code></td>
<td>
<p>Maximum percentage of the total points that the algorithm shall use for the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numberFixedMassPoints</code></td>
<td>
<p>The number of different <em>fixed mass</em> fractions between <em>minFixedMass</em>
and <em>maxFixedMass</em> that the algorithm will use for estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Initial radius for searching neighbour points in the phase space. Ideally, it should be small
enough so that the fixed mass contained in this radius is slightly greater than the <em>minFixedMass</em>. However,
whereas the radius is not too large (so that the performance decreases) the choice is not critical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>increasingRadiusFactor</code></td>
<td>
<p>Numeric value. If no enough neighbours are found within <em>radius</em>, the radius
is increased by a factor <em>increasingRadiusFactor</em> until succesful. Default: 1.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numberPoints</code></td>
<td>
<p>Number of reference points that the routine will try to use, saving computation time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theilerWindow</code></td>
<td>
<p>Integer denoting the Theiler window:  Two Takens' vectors must be separated by more than
theilerWindow time steps in order to be considered neighbours. By using a Theiler window, we exclude temporally correlated 
vectors from our estimations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>Logical value. If TRUE (default), a plot of the correlation sum with q=1 is shown</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regressionRange</code></td>
<td>
<p>Vector with 2 components denoting the range where the function will perform linear regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useEmbeddings</code></td>
<td>
<p>A numeric vector specifying which embedding dimensions should the algorithm
use to compute the information dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional plot parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The information dimension is a particular case of the generalized correlation dimension
when setting the order q = 1. It is possible to demonstrate that the information dimension
<code class="reqn">D_1</code> may be defined as:
<code class="reqn">D_1=lim_{r \rightarrow 0} &lt;\log p(r)&gt;/\log(r)</code>.
Here, <code class="reqn">p(r)</code> is the probability of finding a neighbour in a neighbourhood of size <code class="reqn">r</code> and 
&lt;&gt; is the mean value. Thus, the information dimension specifies how the average
Shannon information scales with the radius <code class="reqn">r</code>.
</p>
<p>In order to estimate <code class="reqn">D_1</code>, the algorithm looks for the scaling behaviour of the average
radius that contains a given portion (a "fixed-mass") of the total points in the phase space. By performing
a linear regression of <code class="reqn">\log(p)\;Vs.\;\log(&lt;r&gt;)</code> (being <code class="reqn">p</code> the fixed-mass of the total points), an estimate
of <code class="reqn">D_1</code> is obtained. The user should run
the method for different embedding dimensions for checking if <code class="reqn">D_1</code> saturates.
</p>
<p>The calculations for the information dimension are heavier than
those needed for the correlation dimension.
</p>


<h3>Value</h3>

<p>The <em>CalculateCorrDim</em> returns the <em>HRVData</em> structure containing a <em>infDim</em> object storing the results
of the correlation sum (see <code>infDim</code>) of the RR time series.
</p>
<p>The <em>EstimateInfDim</em> function estimates the information dimension of the 
RR time series by averaging the slopes of the correlation sums with q=1.
The slopes are determined by performing a linear regression
over the radius' range specified in <em>regressionRange</em>.If <em>doPlot</em> is TRUE,
a graphic of the regression over the data is shown. The 
results are returned into the <em>HRVData</em> structure, under the <em>NonLinearAnalysis</em> list.
</p>
<p><em>PlotInfDim</em> shows a graphics of the correlation sum with q=1.
</p>


<h3>Note</h3>

<p>In order to run <em>EstimateInfDim</em>, it
is necessary to have performed the correlation sum before with <em>ComputeInfDim</em>.
</p>


<h3>References</h3>

<p>H. Kantz  and T. Schreiber: Nonlinear Time series Analysis (Cambridge university press)
</p>


<h3>See Also</h3>

<p><code>CalculateCorrDim</code>.
</p>


</div>