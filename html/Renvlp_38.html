<div class="container">

<table style="width: 100%;"><tr>
<td>env.tcond</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the envelope model with t-distributed errors</h2>

<h3>Description</h3>

<p>For fixed envelope dimension u, fit the envelope model in multivariate linear regression, where the errors follow a multivariate t-distribution. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">env.tcond(X, Y, u, df, asy = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Dimension of the envelope. An integer between 0 and r.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom of the t-distribution. A positive number that is greater than 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy</code></td>
<td>
<p>Flag for computing the asymptotic variance of the envelope estimator.  The default is <code>TRUE</code>. When p and r are large, computing the asymptotic variance can take much time and memory.  If only the envelope estimators are needed, the flag can be set to <code>asy = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits the envelope model to the responses and predictors, </p>
<p style="text-align: center;"><code class="reqn">
 Y_{i} = \alpha + \Gamma\eta X_{i}+\varepsilon_{i}, \Sigma=\Gamma\Omega\Gamma'+\Gamma_{0}\Omega_{0}\Gamma'_{0}, i=1, ..., n,
 </code>
</p>

<p>using the maximum likelihood estimation.  The errors <code class="reqn">\varepsilon_{i}</code> follow a multivariate t-distribution with scale matrix <code class="reqn">\Sigma</code> and degrees of freedom <code>df</code>.   When the dimension of the envelope is between 1 and r-1, the alternating algorithm in Forzani and Su (2021) is implemented.  When the dimension is r, then the envelope model degenerates to the standard multivariate linear regression.  When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different.
</p>


<h3>Value</h3>

<p>The output is a list that contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The envelope estimator of the regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>The envelope estimator of the error covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>An orthogonal basis of the envelope subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma0</code></td>
<td>
<p>An orthogonal basis of the complement of the envelope subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>The coordinates of beta with respect to Gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>The coordinates of Sigma with respect to Gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega0</code></td>
<td>
<p>The coordinates of Sigma with respect to Gamma0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The estimated intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The maximized log likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMatrix</code></td>
<td>
<p>The asymptotic covariance of vec(beta). The covariance matrix returned are asymptotic.  For the actual standard errors, multiply by 1 / n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asySE</code></td>
<td>
<p>The asymptotic standard error for elements in beta under the envelope model.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1 / sqrt(n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>The asymptotic standard error ratio of the standard multivariate linear regression estimator (with consideration of nonconstant variance) over the envelope estimator, for each element in beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations in the data.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Forzani, L. and Su, Z. (2021). Envelopes for elliptical multivariate linear regression. Statist. Sinica 31, 301-332.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(concrete)
X &lt;- concrete[1:78, 1:7]  # The first 78 observations are training data
Y &lt;- concrete[1:78, 8:10]
## Not run: u &lt;- u.env.tcond(X, Y, 6)
## Not run: u

m &lt;- env.tcond(X, Y, 2, 6)
m
m$beta
</code></pre>


</div>