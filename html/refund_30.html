<div class="container">

<table style="width: 100%;"><tr>
<td>fosr2s</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-step function-on-scalar regression</h2>

<h3>Description</h3>

<p>This function performs linear regression with functional responses and
scalar predictors by (1) fitting a separate linear model at each point
along the function, and then (2) smoothing the resulting coefficients to
obtain coefficient functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fosr2s(
  Y,
  X,
  argvals = seq(0, 1, , ncol(Y)),
  nbasis = 15,
  norder = 4,
  pen.order = norder - 2,
  basistype = "bspline"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the functional responses, given as an <code class="reqn">n\times d</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code class="reqn">n\times p</code> model matrix, whose columns represent scalar
predictors. Should ordinarily include a column of 1s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argvals</code></td>
<td>
<p>the <code class="reqn">d</code> argument values at which the functional
responses are evaluated, and at which the coefficient functions will be
evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>number of basis functions used to represent the coefficient
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norder</code></td>
<td>
<p>norder of the spline basis, when <code>basistype="bspline"</code>
(the default, 4, gives cubic splines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.order</code></td>
<td>
<p>order of derivative penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basistype</code></td>
<td>
<p>type of basis used. The basis is created by an appropriate
constructor function from the <span class="pkg">fda</span> package; see basisfd. Only <code>"bspline"</code> and <code>"fourier"</code> are
supported.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Unlike <code>{fosr}</code> and <code>{pffr}</code>, which obtain smooth
coefficient functions by minimizing a penalized criterion, this function
introduces smoothing only as a second step. The idea was proposed by Fan
and Zhang (2000), who employed local polynomials rather than roughness
penalization for the smoothing step.
</p>


<h3>Value</h3>

<p>An object of class <code>fosr</code>, which is a list with the following
elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>fd</code></td>
<td>
<p>object of class <code>"{fd}"</code> representing the
estimated coefficient functions. Its main components are a basis and a
matrix of coefficients with respect to that basis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.coef</code></td>
<td>
<p><code class="reqn">d\times p</code> matrix of coefficient estimates from
regressing on <code>X</code> separately at each point along the function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.se</code></td>
<td>
<p><code class="reqn">d\times p</code> matrix of standard errors of the raw
coefficient estimates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat</code></td>
<td>
<p><code class="reqn">n\times d</code> matrix of fitted
values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.func</code></td>
<td>
<p><code class="reqn">d\times p</code> matrix of coefficient function
estimates, obtained by smoothing the columns of <code>raw.coef</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.func</code></td>
<td>
<p><code class="reqn">d\times p</code> matrix of coefficient function standard
errors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argvals</code></td>
<td>
<p>points at which the coefficient functions are
evaluated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>smoothing parameters (chosen by REML) used to
smooth the <code class="reqn">p</code> coefficient functions with respect to the supplied
basis. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Philip Reiss <a href="mailto:phil.reiss@nyumc.org">phil.reiss@nyumc.org</a> and Lan Huo
</p>


<h3>References</h3>

<p>Fan, J., and Zhang, J.-T. (2000). Two-step estimation of
functional linear models with applications to longitudinal data.
<em>Journal of the Royal Statistical Society, Series B</em>, 62(2), 303â€“322.
</p>


<h3>See Also</h3>

<p><code>{fosr}</code>, <code>{pffr}</code>
</p>


</div>