<div class="container">

<table style="width: 100%;"><tr>
<td>IORKF_huber</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A huberisation based innovative outlier robust Kalman filter</h2>

<h3>Description</h3>

<p>An innovative outlier robust Kalman filter, based on the work by Ruckdeschel et al. (2014).
This function assumes that the innovations are potentially polluted by a heavy tailed process.
The update equations are made robust to these via huberisation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IORKF_huber(
  Y,
  mu_0,
  Sigma_0 = NULL,
  A,
  C,
  Sigma_Add,
  Sigma_Inn,
  h = 2,
  epsilon = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A list of matrices containing the observations to be filtered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_0</code></td>
<td>
<p>A matrix indicating the mean of the prior for the hidden states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_0</code></td>
<td>
<p>A matrix indicating the variance of the prior for the hidden states. It defaults to the limit of the variance of the Kalman filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A matrix giving the updates for the hidden states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>A matrix mapping the hidden states to the observed states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_Add</code></td>
<td>
<p>A positive definite matrix giving the additive noise covariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_Inn</code></td>
<td>
<p>A positive definite matrix giving the innovative noise covariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>A numeric giving the huber threshold. It defaults to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>A positive numeric giving the precision to which the limit of the covariance is to be computed. It defaults to 0.000001.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An rkf S3 class.
</p>


<h3>References</h3>

<p>Ruckdeschel P, Spangl B, Pupashenko D (2014).
“Robust Kalman tracking and smoothing with propagating and non-propagating outliers.”
<em>Statistical Papers</em>, <b>55</b>(1), 93–123.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(RobKF)

set.seed(2019)

A = matrix(c(1), nrow = 1, ncol = 1)
C = matrix(c(1), nrow = 1, ncol = 1)

Sigma_Inn = diag(1,1)*0.01
Sigma_Add = diag(1,1)

mu_0 = matrix(0,nrow=1,ncol=1)

Y_list = Generate_Data(1000,A,C,Sigma_Add,Sigma_Inn,mu_0,anomaly_loc = c(100,400,700),
                       anomaly_type = c("Inn","Inn","Inn"),anomaly_comp = c(1,1,1),
                       anomaly_strength = c(50,80,-100))

Output = IORKF_huber(Y_list,mu_0,Sigma_0=NULL,A,C,Sigma_Add,Sigma_Inn,h=2)

plot(Output,conf_level = 0.9999)

</code></pre>


</div>