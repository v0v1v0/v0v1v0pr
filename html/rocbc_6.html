<div class="container">

<table style="width: 100%;"><tr>
<td>comparebcSpec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Performs inference to compare the specificities of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given sensitivity and a given nominal level
</h2>

<h3>Description</h3>

<p>This function provides a comparison of two correlated markers in terms of their specificity at a given sensitivity (for Box-Cox based ROC curves). Marker measurements are assumed to be taken on the same individuals for both markers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">comparebcSpec(marker1, marker2, D, atSens, alpha, plots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>marker1</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the first marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker2</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the second marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual, where 0 denotes a healthy/control individual, and 1 denotes a diseased individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Nominal level used to calculate the confidence intervals. A common choice is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atSens</code></td>
<td>
<p>The value of sensitivity at which the comparison of specificities will take place.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>Valid inputs are "on" and "off". When set to "on" it returns the Box-Cox based ROC along with informative information about the two AUCs in the legend of the plot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>resultstable</code></td>
<td>
<p>A summary table of the comparison that contains the FPR of each marker at the given sensitivity, the p-value of the difference using the probit transformation, the p-value of the difference, and the confidence interval of the difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Spec1</code></td>
<td>
<p>The specificity at the selected sensitivity for the first marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Spec2</code></td>
<td>
<p>The specificity at the selected sensitivity for the second marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue_probit_difference</code></td>
<td>
<p>The p-value for the comparison of the specificities. It employs the probit transformation that has greater power than when not using it (as in pvalue_difference).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue_difference</code></td>
<td>
<p>The p-value for the comparisons of the specificities (without the probit transformation). Simulations have shown that this is inferior to the ‘pvalue_probit_difference’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_difference</code></td>
<td>
<p>The confidence interval for the difference of the specificities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roc1</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roc2</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transx1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the healthy group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transy1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the diseased group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation.parameter.1</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transx2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the healthy group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transy2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the diseased group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation.parameter.2</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 2.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Feng Z. (2016). Comparison of two correlated ROC curves at a given specificity or sensitivity level. Statistics in Medicine, 35(24):4352-4367. https://doi.org/10.1002/sim.7008
</p>


<h3>Examples</h3>

<pre><code class="language-R">#GENERATE SOME BIVARIATE DATA===

set.seed(123)

nx &lt;- 100
Sx &lt;- matrix(c(1,   0.5,
               0.5,  1),
             nrow = 2, ncol = 2)

mux &lt;- c(X = 10, Y = 12)
X=mvtnorm::rmvnorm(nx, mean = mux, sigma = Sx)

ny &lt;- 100
Sy &lt;- matrix(c(1.1,   0.6,
               0.6,  1.1),
             nrow = 2, ncol = 2)

muy &lt;- c(X = 11, Y = 13.7)
Y=mvtnorm::rmvnorm(ny, mean = muy, sigma = Sy)

dx=pracma::zeros(nx,1)
dy=pracma::ones(ny,1)

markers=rbind(X,Y);
marker1=markers[,1]
marker2=markers[,2]
D=c(rbind(dx,dy))

#===COMPARE THE Specificities of Marker 1 vs Marker 2

out=comparebcSpec(marker1=marker1, marker2=marker2, D=D, alpha =0.05, atSens=0.8, plots="on")
summary(out)
</code></pre>


</div>