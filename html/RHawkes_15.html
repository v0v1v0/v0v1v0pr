<div class="container">

<table style="width: 100%;"><tr>
<td>simRHawkes1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate a renewal Hawkes (RHawkes) process
</h2>

<h3>Description</h3>

<p>Simulate a renewal Hawkes (RHawkes) process with given renewal immigration 
distribution function, offspring density function and branching ratio. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">simRHawkes1(re.dist = rweibull, par.redist = list(shape = 1, scale = 1), 
            of.dis = "exp", par.ofdis = list(rate=1),
            branching.ratio = 0.5, cens = 1, B = 10, B0 = 50, 
            flatten=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>re.dist</code></td>
<td>

<p>A (vectorized) function. The immigrant renewal distribution function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.redist</code></td>
<td>

<p>A numeric vector. The parameters of the immigrant renewal distribution.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>of.dis</code></td>
<td>

<p>A character string indicating the distribution for the offspring
birth times, which has to be the
'distname' part of the <code>rdistname</code> functions for simulating
postive random variables implemented in R, such as "exp", "weibull",
"gamma", "lnorm", etc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.ofdis</code></td>
<td>

<p>A list with named elements, giving the list of parameters of the
offspring distribution, such as list(rate=1), list(shape=1,scale=1),
etc. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branching.ratio</code></td>
<td>

<p>A scalar between 0 and 1, the branching ratio parameter. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>A scalar. Tuning parameter for simulation of further immigrants.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0</code></td>
<td>

<p>A scalar. Tuning parameter for simulation of initial immigrants.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flatten</code></td>
<td>

<p>A boolean scalar, which indicates whether the output events times
should be flattened into an increasing sequence of times, or not (in
which case the output is the immigrant arrival times, and the
offspring birth times for different immigrants).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function works by simulating the arrival times of immigrants
according to the renewal immigration distribution. The birth times of 
offspring from each immigrant are then simulated according to an 
inhomogeneous Poisson processes with appropriate intensity functions.
</p>


<h3>Value</h3>

<p>A numeric vector of pooled event (immigration/offspring birth) times of
all generations 0, 1, ..., if <code>flatten=TRUE</code>; A list with two
components: <code>immitimes</code> for immigrant arrival times, and
<code>offspringtimes</code> for birth times of offspring due to different
immigrants. 
</p>


<h3>Author(s)</h3>

<p>Feng Chen &lt;feng.chen@unsw.edu.au&gt;
Tom Stindl &lt;t.stindl@unsw.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
tms &lt;- simRHawkes1(par.redist = list(shape = 3, scale = 1),
                   par.ofdis = list(rate=0.5), branching.ratio = 0.5,
                   cens = 50)
plot(stepfun(tms,0:length(tms)),do.points=FALSE,vertical=FALSE,xlim=c(0,50))

tms.clust &lt;- simRHawkes1(par.redist = list(shape = 3, scale = 1),
                         par.ofdis = list(rate=0.5), branching.ratio = 0.5,
                         cens = 50,flatten=FALSE)
plot(c(0,50),c(0, 1+(nt &lt;-length(it &lt;- tms.clust$immitimes))),
     type="n",xlab="time",ylab="cluster")
segments(x0 = it,y0=-0.2,y1=0.2)
for(i in 1:nt)
    segments(x0 = c(it[i],it[i]+tms.clust$offspringtimes[[i]]),
             y0=i-0.2,y1=i+0.2)
abline(h=0:(nt+1),col="light gray",lty=2)
segments(x0=unlist(lapply(1:nt,function(i)c(it[i],it[i]+tms.clust$offspringtimes[[i]]))),
         y0=nt+1-0.2,y1=nt+1+0.2)
</code></pre>


</div>