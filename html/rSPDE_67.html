<div class="container">

<table style="width: 100%;"><tr>
<td>rspde_lme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>rSPDE linear mixed effects models</h2>

<h3>Description</h3>

<p>Fitting linear mixed effects model with latent Whittle-Matern models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rspde_lme(
  formula,
  loc,
  data,
  model = NULL,
  repl = NULL,
  which_repl = NULL,
  optim_method = "L-BFGS-B",
  use_data_from_graph = TRUE,
  starting_values_latent = NULL,
  start_sigma_e = NULL,
  start_alpha = NULL,
  alpha = NULL,
  start_nu = NULL,
  nu = NULL,
  nu_upper_bound = 4,
  rspde_order = NULL,
  parallel = FALSE,
  n_cores = parallel::detectCores() - 1,
  optim_controls = list(),
  improve_hessian = FALSE,
  hessian_args = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula object describing the relation between the response variables and the fixed effects. If the response variable is a matrix, each column of the matrix will be treated as a replicate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>A vector with the names of the columns in <code>data</code> that contain the observation locations, or a <code>matrix</code> or a <code>data.frame</code> containing the observation locations. If the model is of class <code>metric_graph</code>, the locations must be either a <code>matrix</code> or a <code>data.frame</code> with two columns, or a character vector with the names of the two columns. The first column being the number of the edge, and the second column being the normalized position on the edge. If the model is a 2d model, <code>loc</code> must be either a <code>matrix</code> or <code>data.frame</code> with two columns or a character vector with the name of the two columns that contain the location, the first entry corresponding to the <code>x</code> entry and the second corresponding to the <code>y</code> entry.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> containing the data to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Either an object generated by <code>matern.operators()</code> or <code>spde.matern.operators()</code>. If <code>NULL</code>, a simple linear regression will be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repl</code></td>
<td>
<p>Vector indicating the replicate of each observation. If <code>NULL</code> it will assume there is only one replicate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_repl</code></td>
<td>
<p>Which replicates to use? If <code>NULL</code> all replicates will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_method</code></td>
<td>
<p>The method to be used with <code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_data_from_graph</code></td>
<td>
<p>Logical. Only for models generated from graphs from <code>metric_graph</code> class. In this case, should the data, the locations and the replicates be obtained from the graph object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting_values_latent</code></td>
<td>
<p>A vector containing the starting values for the latent model. If the latent model was generated by <code>matern.operators()</code>, then the starting values should be provided as a vector of the form c(tau,kappa). If the model was generated by <code>spde.matern.operators()</code>, then the starting values should be provided as a vector containing the nonstationary parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_sigma_e</code></td>
<td>
<p>Starting value for the standard deviation of the measurament error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_alpha</code></td>
<td>
<p>Starting value for the smoothness parameter. Will be used if <code>start_nu</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>If <code>NULL</code>, the smoothness parameter will be estimated, otherwise the smoothness parameter will be kept fixed at the provided value. Will be used if <code>nu</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_nu</code></td>
<td>
<p>Starting value for the smoothness parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>If <code>NULL</code>, the smoothness parameter will be estimated, otherwise the smoothness parameter will be kept fixed at the provided value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu_upper_bound</code></td>
<td>
<p>A parameter that limits the maximum value that nu can assume.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rspde_order</code></td>
<td>
<p>The order of the rational approximation to be used while fitting the model. If not given, the order from the model object will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. Indicating whether to use optimParallel or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>Number of cores to be used if parallel is true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_controls</code></td>
<td>
<p>Additional controls to be passed to <code>optim</code> or <code>optimParallel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>improve_hessian</code></td>
<td>
<p>Should a more precise estimate of the hessian be obtained? Turning on might increase the overall time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian_args</code></td>
<td>
<p>List of controls to be used if <code>improve_hessian</code> is <code>TRUE</code>. The list can contain the arguments to be passed to the <code>method.args</code> argument in the <code>numDeriv::hessian</code> function. See the help of the <code>hessian</code> function in <code>numDeriv</code> package for details. Observe that it only accepts the "Richardson" method for now, the method "complex" is not supported.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the fitted model.
</p>


</div>