<div class="container">

<table style="width: 100%;"><tr>
<td>tdr.new</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>UNU.RAN generator based on Transformed Density Rejection (TDR)</h2>

<h3>Description</h3>

<p>UNU.RAN random variate generator for continuous distributions with
given probability density function (PDF).
It is based on the Transformed Density Rejection method (‘TDR’).
</p>
<p>[Universal] – Rejection Method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tdr.new(pdf, dpdf=NULL, lb, ub, islog=FALSE, ...)
tdrd.new(distr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdf</code></td>
<td>
<p>probability density function. (<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dpdf</code></td>
<td>
<p>derivative of <code>pdf</code>. (<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>lower bound of domain;
use <code>-Inf</code> if unbounded from left. (numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>upper bound of domain;
use <code>Inf</code> if unbounded from right. (numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>islog</code></td>
<td>
<p>whether <code>pdf</code> is given as log-density (the
<code>dpdf</code> must then be the derivative of the log-density). (boolean)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(optional) arguments for <code>pdf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>distribution object. (S4 object of class <code>"unuran.cont"</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates an <code>unuran</code> object based on ‘TDR’
(Transformed Density Rejection). It can be used to draw samples of a
continuous random variate with given probability density function
using <code>ur</code>.
</p>
<p>The density <code>pdf</code> must be positive but need not be normalized
(i.e., it can be any multiple of a density function).
The derivative <code>dpdf</code> of the (log-) density is optional. If
omitted, numerical differentiation is used. Notice, however, that this
might cause some round-off errors such that the algorithm fails.
This is in particular the case when the density function is
provided instead of the log-density.
</p>
<p>The given <code>pdf</code> must be <code class="reqn">T_{-0.5}</code>-concave
(with implies unimodal densities with tails not higher than
<code class="reqn">(1/x^2)</code>; this includes all log-concave distributions).
</p>
<p>It is recommended to use the log-density (instead of the density
function) as this is numerically more stable.
</p>
<p>Alternatively, one can use function <code>tdrd.new</code> where the object
<code>distr</code> of class <code>"unuran.cont"</code> must contain all required
information about the distribution.
</p>
<p>The setup time of this method depends on the given PDF, whereas its
marginal generation times are almost independent of the target
distribution.
</p>
<p>There exists a variant of ‘TDR’ which is numerically more
stable (albeit a bit slower and less flexible) which is avaible
via the <code>ars.new</code> function.
</p>


<h3>Value</h3>

<p>An object of class <code>"unuran"</code>.
</p>


<h3>Author(s)</h3>

<p>Josef Leydold and Wolfgang H\"ormann
<a href="mailto:unuran@statmath.wu.ac.at">unuran@statmath.wu.ac.at</a>.
</p>


<h3>References</h3>

<p>W. H\"ormann, J. Leydold, and G. Derflinger (2004):
Automatic Nonuniform Random Variate Generation.
Springer-Verlag, Berlin Heidelberg.
See Chapter 4 (Tranformed Density Rejection).
</p>


<h3>See Also</h3>

<p><code>ur</code>,
<code>ars.new</code>,
<code>unuran.cont</code>,
<code>unuran.new</code>,
<code>unuran</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create a sample of size 100 for a Gaussian distribution
pdf &lt;- function (x) { exp(-0.5*x^2) }
gen &lt;- tdr.new(pdf=pdf, lb=-Inf, ub=Inf)
x &lt;- ur(gen,100)

## Create a sample of size 100 for a 
## Gaussian distribution (use logPDF)
logpdf &lt;- function (x) { -0.5*x^2 }
gen &lt;- tdr.new(pdf=logpdf, islog=TRUE, lb=-Inf, ub=Inf)
x &lt;- ur(gen,100)

## Same example but additionally provide derivative of log-density
## to prevent possible round-off errors
logpdf &lt;- function (x) { -0.5*x^2 }
dlogpdf &lt;- function (x) { -x }
gen &lt;- tdr.new(pdf=logpdf, dpdf=dlogpdf, islog=TRUE, lb=-Inf, ub=Inf)
x &lt;- ur(gen,100)

## Draw sample from Gaussian distribution with mean 1 and
## standard deviation 2. Use 'dnorm'.
gen &lt;- tdr.new(pdf=dnorm, lb=-Inf, ub=Inf, mean=1, sd=2)
x &lt;- ur(gen,100)

## Draw a sample from a truncated Gaussian distribution
## on domain [5,Inf)
logpdf &lt;- function (x) { -0.5*x^2 }
gen &lt;- tdr.new(pdf=logpdf, lb=5, ub=Inf, islog=TRUE)
x &lt;- ur(gen,100)

## Alternative approach
distr &lt;- udnorm()
gen &lt;- tdrd.new(distr)
x &lt;- ur(gen,100)

</code></pre>


</div>