<div class="container">

<table style="width: 100%;"><tr>
<td>rlme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank-based Estimates for Mixed-Effects Nested Models</h2>

<h3>Description</h3>

<p>This function estimates fixed effects and predicts random effects in two-
and three-level random effects nested models using three rank-based fittings
(GR, GEER, JR) via the prediction method algorithm RPP.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rlme(f, data, method = "gr", print = FALSE, na.omit = TRUE,
  weight = "wil", rprpair = "hl-disp", verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>An object of class formula describing the mixed effects model. The
syntax is same as in the lme4 package. Example: y ~ 1 + sex + age + (1 |
region) + (1 | region:school) - sex and age are the fixed effects, region
and school are the nested random effects, school is nested within region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The dataframe to analyze. Data should be cleaned prior to
analysis: cluster and subcluster columns are expected to be integers and in
order (e.g. all clusters and subclusters )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string indicating the method to use (one of "gr", "jr",
"reml", and "geer"). defaults to "gr".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>Whether or not to print a summary of results. Defaults to
false.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.omit</code></td>
<td>
<p>Whether or not to omit rows containing NA values. Defaults to
true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>When weight="hbr", it uses hbr weights in GEE weights. By
default, ="wil", it uses Wilcoxon weights. See the theory in the references.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rprpair</code></td>
<td>
<p>By default, it uses "hl-disp" in the random prediction
procedure (RPP). Also, "med-mad" would be an alternative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean indicating whether to print out diagnostic messages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The iterative methods GR and GEER can be quite slow for large datasets; try
JR for faster analysis. If you want to use the GR method, try using
rprpair='med-mad'. This method avoids building a NxN covariance matrix which
can quickly become unwieldly with large data.
</p>


<h3>Value</h3>

<p>The function returns a list of class "rlme". Use summary.rlme to see
a summary of the fit.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> The model formula. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> The method used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.effects</code></td>
<td>
<p> Estimate of fixed effects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.effects</code></td>
<td>
<p>Estimate of random effects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard.residual</code></td>
<td>
<p> Residuals. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intra.class.correlations</code></td>
<td>
<p> Intra/inter-class correlationa estimates obtained from RPP. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.value</code></td>
<td>
<p> t-values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p> p-values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p> Location.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p> Scale.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> The response variable y.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.obs</code></td>
<td>
<p> Number of observations in provided dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.clusters</code></td>
<td>
<p> The number of clusters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.subclusters</code></td>
<td>
<p> The number of subclusters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.err</code></td>
<td>
<p> Effect from error. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.cluster</code></td>
<td>
<p> Effect from cluster. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.subcluster</code></td>
<td>
<p>Effect from subcluster. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.b</code></td>
<td>
<p> Variances of fixed effects estimate (Beta estimates). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xstar</code></td>
<td>
<p> Weighted design matrix with error covariance matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ystar</code></td>
<td>
<p> Weighted response vector with its covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ehat</code></td>
<td>
<p> The raw residual.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ehats</code></td>
<td>
<p> The raw residual after weighted step. Scaled residual. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yusuf Bilgic <a href="mailto:yekabe@hotmail.com">yekabe@hotmail.com</a> and Herb Susmann <a href="mailto:hps1@geneseo.edu">hps1@geneseo.edu</a>
</p>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>
<p>T. P. Hettmansperger and J. W. McKean. Robust Nonparametric Statistical
Methods. Chapman Hall, 2012.
</p>


<h3>See Also</h3>

<p>summary.rlme, plot.rlme, compare.fits
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(schools)

rlme.fit = rlme(y ~ 1 + sex + age + (1 | region) + (1 | region:school), schools, method="gr")
summary(rlme.fit)

# Try method="geer", "reml", "ml" and "jr" along with 
# rprpair="hl-disp" (not robust), and "med-mad" (robust),
# weight="hbr" is for the gee method.

</code></pre>


</div>