<div class="container">

<table style="width: 100%;"><tr>
<td>Moment and maximum likelihood estimation of variance components</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Moment and maximum likelihood estimation of variance components
</h2>

<h3>Description</h3>

<p>Moment and maximum likelihood estimation of variance components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rint.mle(x, ina, ranef = FALSE, tol = 1e-09, maxiters = 100)
varcomps.mom(x, ina)
varcomps.mle(x, ina, tol = 1e-09)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A numerical vector with the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranef</code></td>
<td>

<p>Should the random effects be returned as well? The default value is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ina</code></td>
<td>

<p>A numerical vector with 1s, 2s, 3s and so one indicating the two groups. Be careful, the function is desinged to 
accept numbers greater than zero. Alternatively it can be a factor variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>The tolerance level to terminate the golden ratio search. the default value is 10^(-9).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiters</code></td>
<td>

<p>The maximum number of iterations Newton-Raphson will implement.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the "varcomps.mle" and "varcomp.mom" work for <b>balanced designs only</b>, i.e. for each subject the same number of
measurements have been taken. The "rint.mle" works for both the balanced and unbalanced designs.
</p>
<p>The variance components, the variance of the between measurements and the 
variance of the within are estimated using moment estimators. The "colvarcomsp.mom" 
is the moment analogue of a random effects model which uses likelihood estimation ("colvarcomps.mle"). 
It is much faster, but can give negative variance of the random effects, in which case it becomes zero.
</p>
<p>The maximum likelihood version is a bit slower (try youselves to see the difference), but statistically 
speaking is to be preferred when small samples are available. The reason why it is only a little bit slower 
and not a lot slower as one would imagine is because we are using a closed formula to calculate the two variance
components (Demidenko, 2013, pg. 67-69). Yes, there are closed formulas for linear mixed models.     
</p>


<h3>Value</h3>

<p>For the "varcomps.mom":
A vector with 5 elemets, The MSE, the estimate of the between variance, 
the variance components ratio and a 95% confidence for the ratio.
</p>
<p>For the "varcomps.mle":
a list with a single component called "info". That is a matrix with 3 columns, The MSE, the estimate of 
the between variance and the log-likelihood value. <b>If ranef = TRUE</b> a list including "info" 
and an extra component called "ranef" containing the random effects. It is a matrix with the same number of columns as the data. 
Each column contains the randome effects of each variable. 
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris and Manos Papadakis.
</p>
<p>R implementation and documentation: Michail Tsagris &lt;mtsagris@uoc.gr&gt; and Manos Papadakis &lt;papadakm95@gmail.com&gt;.
</p>


<h3>References</h3>

<p>Montgomery D.C. (2001). Design and analysis of experiments (5th Edition). New York: John Wiley &amp; Sons. 
</p>
<p>Davis C.S. (2002). Statistical methods for the analysis of repeated measures. New York: Springer-Verlag.
</p>
<p>Demidenko E. (2013). Mixed Models: Theory and Applications with R 2nd Edition). New Jersey: John Wiley &amp; Sons (Excellent book).
</p>


<h3>See Also</h3>

<p><code>colvarcomps.mle, rint.reg, rint.regbx
</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example from Montgomery, pages 514-517
x &lt;- c(98,97,99,96,91,90,93,92,96,95,97,95,95,96,99,98)
ina &lt;- rep(1:4, each = 4)
res&lt;-varcomps.mom(x, ina)
res&lt;-varcomps.mle(x, ina)
</code></pre>


</div>