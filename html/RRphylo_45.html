<div class="container">

<table style="width: 100%;"><tr>
<td>setBM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Producing simulated phenotypes with trends</h2>

<h3>Description</h3>

<p>The function <code>setBM</code> is wrapper around <span class="pkg">phytools</span>
<code>fastBM</code> function, which generates BM simulated phenotypes with or
without a trend.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setBM(tree, nY = 1, s2 = 1, a = 0, type = c("", "brown","trend",
  "drift"), trend.type = c("linear", "stepwise"),tr = 10, t.shift = 0.5,
  es=2, ds=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nY</code></td>
<td>
<p>the number of phenotypes to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>value of the Brownian rate to use in the simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the phenotype at the tree root.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of phenotype to simulate. With the option <code>"brown"</code>
the phenotype will have no trend in the phenotypic mean or in the rate of
evolution. A variation in the phenotypic mean over time (a phenotypic
trend) is obtained by selecting the option <code>"drift"</code>. A trend in the
rate of evolution produces an increased variance in the residuals over
time. This is obtained by specifying the option <code>"trend"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend.type</code></td>
<td>
<p>two kinds of heteroscedastic residuals are generated under
the <code>"trend"</code> type. The option <code>"linear"</code> produces an exponential
linear increase (or decrease) in heteroscedasticity, whereas the
<code>"stepwise"</code> option produces an increase (or decrease) after a
specified point in time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>the intensity of the trend with the <code>"stepwise"</code> option is
controlled by the <code>tr</code> argument. The scalar <code>tr</code> is the
multiplier of the branches extending after the shift point as indicated by
<code>t.shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.shift</code></td>
<td>
<p>the relative time distance from the tree root where the
stepwise change in the rate of evolution is indicated to apply.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>es</code></td>
<td>
<p>when <code>trend.type="linear"</code>, <code>es</code> is a scalar representing
the exponent at which the evolutionary time (i.e. distance from the root)
scales to change to phenotypic variance. With <code>es</code> = 1 the phenotypic
rate will be trendless, with <code>es</code> &lt; 1 the variance of the phenotypes
will decrease exponentially towards the present and the other way around
with <code>es</code> &gt; 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ds</code></td>
<td>
<p>a scalar indicating the change in phenotypic mean in the unit time,
in <code>type="drift"</code> case. With <code>ds</code> = 0 the phenotype will be
trendless, with <code>ds</code> &lt; 0 the phenotypic mean will decrease
exponentially towards the present and the other way around with <code>ds</code> &gt;
0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that <code>setBM</code> differs from <code>fastBM</code> in that the
produced phenotypes are checked for the existence of a temporal trend in
the phenotype. The user may specify whether she wants trendless data
(option <code>"brown"</code>), phenotypes trending in time (option
<code>"drift"</code>), or phenotypes whose variance increases/decreases
exponentially over time, consistently with the existence of a trend in the
rate of evolution (option <code>"trend"</code>). In the latter case, the user may
indicate the intensity of the trend (by applying different values of
<code>es</code>), and whether it should occur after a given proportion of the
tree height (hence a given point back in time, specified by the argument
<code>t.shift</code>). Trees in <code>setBM</code> are treated as non ultrametric. If
an ultrametric tree is fed to the function, <code>setBM</code> alters slightly
the leaf lengths multiplying randomly half of the leaves by 1 * 10e-3,in
order to make it non-ultrametric.
</p>


<h3>Value</h3>

<p>Either an object of class <code>'array'</code> containing a single
phenotype or an object of class <code>'matrix'</code> of <em>n</em> phenotypes as
columns, where <em>n</em> is indicated as <code>nY</code> = <em>n</em>.
</p>


<h3>Author(s)</h3>

<p>Pasquale Raia, Silvia Castiglione, Carmela Serio, Alessandro
Mondanaro, Marina Melchionna, Mirko Di Febbraro, Antonio Profico, Francesco
Carotenuto
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
data("DataOrnithodirans")
DataOrnithodirans$treedino-&gt;treedino

setBM(tree=treedino, nY= 1, type="brown")
setBM(tree=treedino, nY= 1, type="drift", ds=2)
setBM(tree=treedino, nY= 1, type="trend", trend.type="linear", es=2)
</code></pre>


</div>