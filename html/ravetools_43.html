<div class="container">

<table style="width: 100%;"><tr>
<td>fast_cov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate massive covariance matrix in parallel</h2>

<h3>Description</h3>

<p>Speed up covariance calculation for large matrices. The
default behavior is the same as <code>cov</code> (<code>'pearson'</code>,
no <code>NA</code> handling).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fast_cov(x, y = NULL, col_x = NULL, col_y = NULL, df = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, matrix or data frame; a matrix is highly
recommended to maximize the performance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>NULL (default) or a vector, matrix or data frame with compatible
dimensions to x; the default is equivalent to <code>y = x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_x</code></td>
<td>
<p>integers indicating the subset indices (columns) of <code>x</code> to
calculate the covariance, or <code>NULL</code> to include all the columns; default
is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_y</code></td>
<td>
<p>integers indicating the subset indices (columns) of <code>y</code> to
calculate the covariance, or <code>NULL</code> to include all the columns; default
is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a scalar indicating the degrees of freedom; default is
<code>nrow(x)-1</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A covariance matrix of <code>x</code> and <code>y</code>. Note that there is no
<code>NA</code> handling. Any missing values will lead to <code>NA</code> in the
resulting covariance matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Set ncores = 2 to comply to CRAN policy. Please don't run this line
ravetools_threads(n_threads = 2L)

x &lt;- matrix(rnorm(400), nrow = 100)

# Call `cov(x)` to compare
fast_cov(x)

# Calculate covariance of subsets
fast_cov(x, col_x = 1, col_y = 1:2)



# Speed comparison, better to use multiple cores (4, 8, or more)
# to show the differences.

ravetools_threads(n_threads = -1)
x &lt;- matrix(rnorm(100000), nrow = 1000)
microbenchmark::microbenchmark(
  fast_cov = {
    fast_cov(x, col_x = 1:50, col_y = 51:100)
  },
  cov = {
    cov(x[,1:50], x[,51:100])
  },
  unit = 'ms', times = 10
)




</code></pre>


</div>