<div class="container">

<table style="width: 100%;"><tr>
<td>KWDual</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dual optimization for Kiefer-Wolfowitz problems</h2>

<h3>Description</h3>

<p>Interface function for calls to optimizer from various REBayes functions
There is currently only one option for the optimization that based on  Mosek. 
It relies on the <span class="pkg">Rmosek</span> interface to R see installation instructions in
the Readme file in the inst directory of this package.  This version of the function
is intended to work with versions of Mosek after 7.0.  A more experimental option
employing the <span class="pkg">pogs</span> package available from <a href="https://github.com/foges/pogs">https://github.com/foges/pogs</a>
and employing an ADMM (Alternating Direction Method of Multipliers) approach has
been deprecated, those interested could try installing version 1.4 of REBayes, and
following the instructions provided there.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KWDual(A, d, w, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Linear constraint matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>constraint vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>weights for <code>x</code> should sum to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed to control optimization:  These may
include <code>rtol</code> the relative tolerance for dual gap convergence criterion,
<code>verb</code> to control verbosity desired from mosek, <code>verb = 0</code> is quiet,
<code>verb = 5</code> produces a fairly detailed iteration log,
<code>control</code> is a control list consisting of sublists <code>iparam</code>,
<code>dparam</code>, and <code>sparam</code>, containing elements of various mosek
control parameters.  See the Rmosek and Mosek manuals for further details.
A prime example is <code>rtol</code> which should eventually be deprecated and
folded into <code>control</code>, but will persist for a while for compatibility
reasons.  The default for <code>rtol</code> is 1e-6, but in some cases it is
desirable to tighten this, say to 1e-10.  Another example that motivated the introduction of
<code>control</code> would be <code>control = list(iparam = list(num_threads =
1))</code>, which forces Mosek to use a single threaded process.  The default
allows Mosek to uses multiple threads (cores) if available, which is
generally desirable, but may have unintended (undesirable) consequences when running
simulations on clusters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>dual solution vector, the
mixing density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>primal solution vector, the mixture density
evaluated at the data points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>log likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>return status from Mosek</p>
</td>
</tr>
</table>
<p>.  Mosek termination messages are
treated as warnings from an R perspective since solutions producing, for example,
MSK_RES_TRM_STALL: The optimizer is terminated due to slow progress, may still
provide a satisfactory solution, especially when the return status variable is
"optimal".
</p>


<h3>Author(s)</h3>

<p>R. Koenker
</p>


<h3>References</h3>

<p>Koenker, R and I. Mizera, (2013) “Convex Optimization, Shape Constraints,
Compound Decisions, and Empirical Bayes Rules,” <em>JASA</em>, 109, 674–685.
</p>
<p>Mosek Aps (2015) Users Guide to the R-to-Mosek Optimization Interface, 
<a href="https://docs.mosek.com/8.1/rmosek/index.html">https://docs.mosek.com/8.1/rmosek/index.html</a>.  
</p>
<p>Koenker, R. and J. Gu, (2017) REBayes: An R Package for Empirical Bayes Mixture Methods,
<em>Journal of Statistical Software</em>, 82, 1–26.
</p>


</div>