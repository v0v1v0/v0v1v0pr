<div class="container">

<table style="width: 100%;"><tr>
<td>anc.recon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Ultra-fast maximum likelihood ancestral state reconstruction
</h2>

<h3>Description</h3>

<p>This function performs ancestral state reconstruction using a fast algorithm based on Ho and Ane (2014).
</p>


<h3>Usage</h3>

<pre><code class="language-R">anc.recon(trait_data, tree, vars = FALSE, CI = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trait_data</code></td>
<td>

<p>A vector or matrix of trait values. Names or row names correspond to species names. Data cannot have any missing data or within-species variation (this type of data can be handled by the phylopars function).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>An object of class <code>phylo</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>

<p>Whether to return the variances of the restricted maximum likelihood estimates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>

<p>Whether to return 95% confidence intervals of the restricted maximum likelihood estimates
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named vector of maximum likelihood ancestral states (with names corresponding to node names if available or node numbers from the tree rearranged in postorder, as obtained by the command <code>reorder(tree,"postorder")</code>). If vars or CI is set to TRUE, a list is returned with these values included.
</p>


<h3>Author(s)</h3>

<p>Felsenstein, J. (1985) Phylogenies and the comparative method. American Naturalist, 125, 1-15.
</p>
<p>Ho L.S.T., Ane C. 2014. A linear-time algorithm for Gaussian and non-Gaussian trait evolution models. Syst. Biol. 63:397-408.
</p>
<p>Revell, L. J. (2012) phytools: An R package for phylogenetic comparative biology (and other things). Methods Ecol. Evol., 3, 217-223.
</p>


<h3>See Also</h3>

<p>fastAnc, ace, pic
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(ape)
tree &lt;- rtree(10000) # random tree with 10,000 taxa
x &lt;- setNames(rnorm(1e4),tree$tip.label) # random trait data
recon &lt;- anc.recon(trait_data=x,tree=tree)
</code></pre>


</div>