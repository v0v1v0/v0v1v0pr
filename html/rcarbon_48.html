<div class="container">

<table style="width: 100%;"><tr>
<td>spkde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Map the spatial intensity of a set of radiocarbon dates for a given focal year.</h2>

<h3>Description</h3>

<p>Function for mapping the spatial intensity of radiocarbon dates for a given geographical region and focal year.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spkde(
  x,
  coords,
  sbw,
  focalyear,
  tbw,
  win,
  cellres,
  bins = NA,
  backsight = NA,
  nsim = NULL,
  maskthresh = 0,
  changexpr = expression((t1 - t0)/tk),
  raw = FALSE,
  spjitter = TRUE,
  amount = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class CalDates with calibrated radiocarbon ages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>A two column matrix of geographical coordinates from a a projected coordinate system (no checks are made for this) and with the same number of rows as length(x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sbw</code></td>
<td>
<p>A single numeric value for the spatial bandwidth to be applied around each raster cell, expressed as the standard deviation of a continuous Gaussian kernel (passed as the sigma argument to density.ppp()).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focalyear</code></td>
<td>
<p>A single numeric value for the focal year for the intensity map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tbw</code></td>
<td>
<p>A single numeric value for the temporal bandwidth to be applied around each focal year, expressed as the standard deviation of a continuous Gaussian kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>The bounding polygon for the mapping (must be an object of class 'owin', see the spatstat package)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellres</code></td>
<td>
<p>The cell or pixel resolution of the output raster maps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>A vector of labels corresponding to site names, ids, bins or phases (same length as x)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backsight</code></td>
<td>
<p>A single numeric value (which will be coerced to be positive) that specifies a comparison timestep in the past for a mapping of temporal change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>How many bootstrap simulations to run (default is none).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maskthresh</code></td>
<td>
<p>A single numeric value for a lower-bound cut-off for all maps, based on a minimum required spatial intensity of all dates in x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changexpr</code></td>
<td>
<p>An expression for calculating the change in spatial intensity between the focal year and a backsight year (as defined via the backsight argument). Available input options are t1 (the spatial intensity for the focal year), t0 (the spatial intensity for the backsight year) and tk (the overall spatial intensity for all dates irrespective of year), plus any other standard constants and mathematical operators. A sensible default is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>
<p>Whether to output the raw simulations (if nsim is set) or just the summaries (the latter is default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spjitter</code></td>
<td>
<p>Whether noise is applied to the spatial coordinates or not. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amount</code></td>
<td>
<p>Amount of jitter applied to the spatial coordinates when <code>spjitter=TRUE</code>. Default is d/5, where d is difference between the closest coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical variable indicating whether extra information on progress should be reported. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored or passed to internal functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is not really intended for general use, but rather as an internal function for stkde(). Most applications should use the latter, but spkde has been exported and made externally available, both because this function retains the result in memory (in contrast to stkde) and with a view to possible addition of bootstrap methods in the future. Some function arguments therefore remain experimental. The function computes timeslice maps of the spatio-temporal kernel intensity of radiocarbon dates across a geographic region for a specific focal year. The user specifies the arbitrary size of both the spatial and the temporal Gaussian kernels that will be used to summarise radiocarbon date intensity per grid cell.
</p>


<h3>Value</h3>

<p>A list object of class spKde with the following elements:
</p>

<ul>
<li> <p>A series of list items storing some of the input parameters such as the focal year, sbw, tbw, backsight, maskthresh. 
</p>
</li>
<li>
<p><code>nonfocal</code> An im object mapping the basic spatial intensity of all dates, without reference to a focal year. 
</p>
</li>
<li>
<p><code>focal</code> An im object mapping the spatial intensity of dates for the focal year (i.e. weighted by how much each dates probability distribution overlaps with a Gaussian kernel centred on the focal year with a standard deviation of tbw).
</p>
</li>
<li>
<p><code>proportion</code> An im object mapping the proportional intensity of dates for the focal year (i.e. the focal surface divided by the nonfocal surface).
</p>
</li>
<li>
<p><code>change</code> An im object mapping the amount of change between the intensity of dates for the focal year and a chosen backsight year (i.e. as defined by changexpr).
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Example for the focal year 5600 calBP (also with site binning), 
## using a subset of English and Welsh dates from the Euroevol dataset
data(ewdates)
data(ewowin)
x &lt;- calibrate(x=ewdates$C14Age, errors=ewdates$C14SD, normalised=FALSE)
bins1 &lt;- binPrep(sites=ewdates$SiteID, ages=ewdates$C14Age, h=50)
spkde1 &lt;- spkde(x=x, coords=ewdates[,c("Eastings", "Northings")], win=ewowin, 
sbw=40000, cellres=2000, focalyear=5600, tbw=50, bins=bins1, backsight=200,amount=1)
plot(spkde1$focal)
plot(spkde1$proportion)

## End(Not run)

</code></pre>


</div>