<div class="container">

<table style="width: 100%;"><tr>
<td>plot.evpost</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot diagnostics for an evpost object</h2>

<h3>Description</h3>

<p><code>plot</code> method for class "evpost".  For <code>d = 1</code> a histogram of the
simulated values is plotted with a the density function superimposed.
The density is normalized crudely using the trapezium rule.  For
<code>d = 2</code> a scatter plot of the simulated values is produced with
density contours superimposed.  For <code>d &gt; 2</code> pairwise plots of the
simulated values are produced.
An interface is also provided to the functions in the <strong>bayesplot</strong>
package that produce plots of Markov chain Monte Carlo (MCMC)
simulations.  See MCMC-overview for details of these
functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'evpost'
plot(
  x,
  y,
  ...,
  n = ifelse(x$d == 1, 1001, 101),
  prob = c(0.5, 0.1, 0.25, 0.75, 0.95, 0.99),
  ru_scale = FALSE,
  rows = NULL,
  xlabs = NULL,
  ylabs = NULL,
  points_par = list(col = 8),
  pu_only = FALSE,
  add_pu = FALSE,
  use_bayesplot = FALSE,
  fun_name = c("areas", "intervals", "dens", "hist", "scatter")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class "evpost", a result of a call to
<code>rpost</code> or <code>rpost_rcpp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to <code>hist</code>, <code>lines</code>,
<code>contour</code>, <code>points</code> or functions from the <strong>bayesplot</strong>
package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric scalar.  Only relevant if <code>x$d = 1</code> or
<code>x$d = 2</code>. The meaning depends on the value of x$d.
</p>

<ul>
<li>
<p> For d = 1 : n + 1 is the number of abscissae in the trapezium
method used to normalize the density.
</p>
</li>
<li>
<p> For d = 2 : an n by n regular grid is used to contour the density.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Numeric vector. Only relevant for d = 2.  The contour lines are
drawn such that the respective probabilities that the variable lies
within the contour are approximately prob.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ru_scale</code></td>
<td>
<p>A logical scalar.  Should we plot data and density on the
scale used in the ratio-of-uniforms algorithm (TRUE) or on the original
scale (FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows</code></td>
<td>
<p>A numeric scalar.  When <code>d</code> &gt; 2 this sets the number of
rows of plots.  If the user doesn't provide this then it is set
internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabs, ylabs</code></td>
<td>
<p>Numeric vectors.  When <code>d</code> &gt; 2 these set the labels
on the x and y axes respectively.  If the user doesn't provide these then
the column names of the simulated data matrix to be plotted are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points_par</code></td>
<td>
<p>A list of arguments to pass to
<code>points</code> to control the appearance of points
depicting the simulated values. Only relevant when <code>d = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pu_only</code></td>
<td>
<p>Only produce a plot relating to the posterior distribution
for the threshold exceedance probability <code class="reqn">p</code>. Only relevant when
<code>model == "bingp"</code> was used in the call to <code>rpost</code> or
<code>rpost_rcpp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_pu</code></td>
<td>
<p>Before producing the plots add the threshold exceedance
probability <code class="reqn">p</code> to the parameters of the extreme value model. Only
relevant when <code>model == "bingp"</code> was used in the call to
<code>rpost</code> or <code>rpost_rcpp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_bayesplot</code></td>
<td>
<p>A logical scalar. If <code>TRUE</code> the bayesplot
function indicated by <code>fun_name</code> is called.  In principle <em>any</em>
bayesplot function (that starts with <code>mcmc_</code>) can be called but
this may not always be successful because, for example, some of the
bayesplot functions work only with multiple MCMC simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun_name</code></td>
<td>
<p>A character scalar.  The name of the bayesplot function,
with the initial <code>mcmc_</code> part removed.  See
MCMC-overview and links therein for the names of these
functions. Some examples are given below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For details of the <strong>bayesplot</strong> functions available when
<code>use_bayesplot = TRUE</code> see MCMC-overview and
the <strong>bayesplot</strong> vignette
<a href="https://CRAN.R-project.org/package=bayesplot">Plotting MCMC draws</a>.
</p>


<h3>Value</h3>

<p>Nothing is returned unless <code>use_bayesplot = TRUE</code> when a
ggplot object, which can be further customized using the
<strong>ggplot2</strong> package, is returned.
</p>


<h3>References</h3>

<p>Jonah Gabry (2016). bayesplot: Plotting for Bayesian
Models. R package version 1.1.0.
<a href="https://CRAN.R-project.org/package=bayesplot">https://CRAN.R-project.org/package=bayesplot</a>
</p>


<h3>See Also</h3>

<p><code>summary.evpost</code> for summaries of the simulated values
and properties of the ratio-of-uniforms algorithm.
</p>
<p><code>MCMC-overview</code>,
<code>MCMC-intervals</code>,
<code>MCMC-distributions</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## GP posterior
u &lt;- stats::quantile(gom, probs = 0.65)
fp &lt;- set_prior(prior = "flat", model = "gp", min_xi = -1)
gpg &lt;- rpost(n = 1000, model = "gp", prior = fp, thresh = u, data = gom)
plot(gpg)


# Using the bayesplot package
plot(gpg, use_bayesplot = TRUE)
plot(gpg, use_bayesplot = TRUE, pars = "xi", prob = 0.95)
plot(gpg, use_bayesplot = TRUE, fun_name = "intervals", pars = "xi")
plot(gpg, use_bayesplot = TRUE, fun_name = "hist")
plot(gpg, use_bayesplot = TRUE, fun_name = "dens")
plot(gpg, use_bayesplot = TRUE, fun_name = "scatter")


## bin-GP posterior
u &lt;- quantile(gom, probs = 0.65)
fp &lt;- set_prior(prior = "flat", model = "gp", min_xi = -1)
bp &lt;- set_bin_prior(prior = "jeffreys")
npy_gom &lt;- length(gom)/105
bgpg &lt;- rpost(n = 1000, model = "bingp", prior = fp, thresh = u,
              data = gom, bin_prior = bp, npy = npy_gom)
plot(bgpg)
plot(bgpg, pu_only = TRUE)
plot(bgpg, add_pu = TRUE)


# Using the bayesplot package
dimnames(bgpg$bin_sim_vals)
plot(bgpg, use_bayesplot = TRUE)
plot(bgpg, use_bayesplot = TRUE, fun_name = "hist")
plot(bgpg, use_bayesplot = TRUE, pars = "p[u]")

</code></pre>


</div>