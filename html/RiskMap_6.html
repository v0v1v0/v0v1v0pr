<div class="container">

<table style="width: 100%;"><tr>
<td>glgpm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of Generalized Linear Gaussian Process Models</h2>

<h3>Description</h3>

<p>Fits generalized linear Gaussian process models to spatial data, incorporating spatial Gaussian processes with a Matern correlation function. Supports Gaussian, binomial, and Poisson response families.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glgpm(
  formula,
  data,
  family,
  distr_offset = NULL,
  cov_offset = NULL,
  crs = NULL,
  convert_to_crs = NULL,
  scale_to_km = TRUE,
  control_mcmc = set_control_sim(),
  par0 = NULL,
  S_samples = NULL,
  return_samples = TRUE,
  messages = TRUE,
  fix_var_me = NULL,
  start_pars = list(beta = NULL, sigma2 = NULL, tau2 = NULL, phi = NULL, sigma2_me =
    NULL, sigma2_re = NULL)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object specifying the model to be fitted. The formula should include fixed effects, random effects (specified using <code>re()</code>), and spatial effects (specified using <code>gp()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or sf object containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A character string specifying the distribution of the response variable. Must be one of "gaussian", "binomial", or "poisson".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr_offset</code></td>
<td>
<p>Optional offset for binomial or Poisson distributions. If not provided, defaults to 1 for binomial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_offset</code></td>
<td>
<p>Optional numeric vector for covariate offset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>Optional integer specifying the Coordinate Reference System (CRS) if data is not an sf object. Defaults to 4326 (long/lat).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convert_to_crs</code></td>
<td>
<p>Optional integer specifying a CRS to convert the spatial coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_to_km</code></td>
<td>
<p>Logical indicating whether to scale coordinates to kilometers. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_mcmc</code></td>
<td>
<p>Control parameters for MCMC sampling. Must be an object of class "mcmc.RiskMap" as returned by <code>set_control_sim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par0</code></td>
<td>
<p>Optional list of initial parameter values for the MCMC algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_samples</code></td>
<td>
<p>Optional matrix of pre-specified sample paths for the spatial random effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_samples</code></td>
<td>
<p>Logical indicating whether to return MCMC samples when fitting a Binomial or Poisson model. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>Logical indicating whether to print progress messages. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_var_me</code></td>
<td>
<p>Optional fixed value for the measurement error variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_pars</code></td>
<td>
<p>Optional list of starting values for model parameters: beta (regression coefficients), sigma2 (spatial process variance), tau2 (nugget effect variance), phi (spatial correlation scale), sigma2_me (measurement error variance), and sigma2_re (random effects variances).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generalized linear Gaussian process models extend generalized linear models (GLMs) by incorporating spatial Gaussian processes to account for spatial correlation in the data. This function fits GLGPMs using maximum likelihood methods, allowing for Gaussian, binomial, and Poisson response families.
In the case of the Binomial and Poisson families, a Monte Carlo maximum likelihood algorithm is used.
</p>
<p>The spatial Gaussian process is modeled with a Matern correlation function, which is flexible and commonly used in geostatistical modeling. The function supports both spatial covariates and unstructured random effects, providing a comprehensive framework to analyze spatially correlated data across different response distributions.
</p>
<p>Additionally, the function allows for the inclusion of unstructured random effects, specified through the <code>re()</code> term in the model formula. These random effects can capture unexplained variability at specific locations beyond the fixed and spatial covariate effects, enhancing the model's flexibility in capturing complex spatial patterns.
</p>
<p>The <code>convert_to_crs</code> argument can be used to reproject the spatial coordinates to a different CRS. The <code>scale_to_km</code> argument scales the coordinates to kilometers if set to TRUE.
</p>
<p>The <code>control_mcmc</code> argument specifies the control parameters for MCMC sampling. This argument must be an object returned by <code>set_control_sim</code>.
</p>
<p>The <code>start_pars</code> argument allows for specifying starting values for the model parameters. If not provided, default starting values are used.
</p>


<h3>Value</h3>

<p>An object of class "RiskMap" containing the fitted model and relevant information:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Covariate matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>Unique spatial coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_coords</code></td>
<td>
<p>Index of coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re</code></td>
<td>
<p>Random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_re</code></td>
<td>
<p>Index of random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_tau2</code></td>
<td>
<p>Fixed nugget effect variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_var_me</code></td>
<td>
<p>Fixed measurement error variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Response family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>Coordinate Reference System.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_to_km</code></td>
<td>
<p>Indicator if coordinates are scaled to kilometers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_sf</code></td>
<td>
<p>Original data as an sf object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Spatial correlation parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units_m</code></td>
<td>
<p>Distribution offset for binomial/Poisson.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_offset</code></td>
<td>
<p>Covariate offset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Matched call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>set_control_sim</code>, <code>summary.RiskMap</code>, <code>to_table</code>
</p>


</div>