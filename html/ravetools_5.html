<div class="container">

<table style="width: 100%;"><tr>
<td>band_pass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Band-pass signals</h2>

<h3>Description</h3>

<p>Band-pass signals
</p>


<h3>Usage</h3>

<pre><code class="language-R">band_pass1(x, sample_rate, lb, ub, domain = 1, ...)

band_pass2(
  x,
  sample_rate,
  lb,
  ub,
  order,
  method = c("fir", "butter"),
  direction = c("both", "forward", "backward"),
  window = "hamming",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input signals, numeric vector or matrix. <code>x</code> must be
row-major if input is a matrix: each row is a channel, and each column is
a time-point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_rate</code></td>
<td>
<p>sampling frequency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>lower frequency bound of the band-passing filter, must be positive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>upper frequency bound of the band-passing filter, must be greater
than the lower bound and smaller than the half of sampling frequency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p>1 if <code>x</code> is in time-domain, or 0 if <code>x</code> is in
frequency domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>the order of the filter, must be positive integer and be
less than one-third of the sample rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>filter type, choices are <code>'fir'</code> and <code>'butter'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>filter direction, choices are <code>'forward'</code>,
<code>'backward'</code>, and <code>'both'</code> directions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>window type, can be a character, a function, or a vector.
For character, <code>window</code> is a function name in the
<code>signal</code> package, for example, <code>'hanning'</code>; for a function,
<code>window</code> takes one integer argument and returns a numeric vector
with length of that input; for vectors, <code>window</code> is a numeric vector
o length <code>order+1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Filtered signals, vector if <code>x</code> is a vector, or matrix of
the same dimension as <code>x</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

t &lt;- seq(0, 1, by = 0.0005)
x &lt;- sin(t * 0.4 * pi) + sin(t * 4 * pi) + 2 * sin(t * 120 * pi)

oldpar &lt;- par(mfrow = c(2, 2), mar = c(3.1, 2.1, 3.1, 0.1))
# ---- Using band_pass1 ------------------------------------------------

y1 &lt;- band_pass1(x, 2000, 0.1, 1)
y2 &lt;- band_pass1(x, 2000, 1, 5)
y3 &lt;- band_pass1(x, 2000, 10, 80)

plot(t, x, type = 'l', xlab = "Time", ylab = "",
     main = "Mixture of 0.2, 2, and 60Hz")
lines(t, y1, col = 'red')
lines(t, y2, col = 'blue')
lines(t, y3, col = 'green')
legend(
  "topleft", c("Input", "Pass: 0.1-1Hz", "Pass 1-5Hz", "Pass 10-80Hz"),
  col = c(par("fg"), "red", "blue", "green"), lty = 1,
  cex = 0.6
)

# plot pwelch
pwelch(x, fs = 2000, window = 4000, noverlap = 2000, plot = 1)
pwelch(y1, fs = 2000, window = 4000, noverlap = 2000,
       plot = 2, col = "red")
pwelch(y2, fs = 2000, window = 4000, noverlap = 2000,
       plot = 2, col = "blue")
pwelch(y3, fs = 2000, window = 4000, noverlap = 2000,
       plot = 2, col = "green")


# ---- Using band_pass2 with FIR filters --------------------------------

order &lt;- floor(2000 / 3)
z1 &lt;- band_pass2(x, 2000, 0.1, 1, method = "fir", order = order)
z2 &lt;- band_pass2(x, 2000, 1, 5, method = "fir", order = order)
z3 &lt;- band_pass2(x, 2000, 10, 80, method = "fir", order = order)

plot(t, x, type = 'l', xlab = "Time", ylab = "",
     main = "Mixture of 0.2, 2, and 60Hz")
lines(t, z1, col = 'red')
lines(t, z2, col = 'blue')
lines(t, z3, col = 'green')
legend(
  "topleft", c("Input", "Pass: 0.1-1Hz", "Pass 1-5Hz", "Pass 10-80Hz"),
  col = c(par("fg"), "red", "blue", "green"), lty = 1,
  cex = 0.6
)

# plot pwelch
pwelch(x, fs = 2000, window = 4000, noverlap = 2000, plot = 1)
pwelch(z1, fs = 2000, window = 4000, noverlap = 2000,
       plot = 2, col = "red")
pwelch(z2, fs = 2000, window = 4000, noverlap = 2000,
       plot = 2, col = "blue")
pwelch(z3, fs = 2000, window = 4000, noverlap = 2000,
       plot = 2, col = "green")

# ---- Clean this demo --------------------------------------------------
par(oldpar)

</code></pre>


</div>