<div class="container">

<table style="width: 100%;"><tr>
<td>cnv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find CNVs from deviants</h2>

<h3>Description</h3>

<p>Categorize deviant and non-deviant into "singlets" and "duplicates" based on the statistical approaches specified by the user.
The intersection of all the stats provided will be used in the categorization. If one would like to use the intersection of at least two stats, this can be specified in the <code>n.ints</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">cnv(
  data,
  test = c("z.het", "z.05", "z.all", "chi.het", "chi.05", "chi.all"),
  filter = c("intersection", "kmeans"),
  WGS = TRUE,
  ft.threshold = 0.05,
  plot = TRUE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame of allele information generated with the function
<code>allele.info</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>vector of characters. Type of test to be used for significance.
See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>character. Type of filter to be used for filtering CNVs.
default <code>kmeans</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WGS</code></td>
<td>
<p>logical. test parameter. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ft.threshold</code></td>
<td>
<p>confidence interval for filtering <code>default = 0.05</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. Plot the detection of duplicates. default <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. show progress</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to be passed to <code>plot</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>SNP deviants are detected with both excess of heterozygosity
according to HWE and deviant SNPs where depth values fall outside of the
normal distribution are detected using the
following methods:
</p>

<ul>
<li>
<p>Z-score test <code class="reqn">Z_{x} = \sum_{i=1}^{n} Z_{i}</code>;
<code class="reqn">Z_{i} = \frac{\left ( (N_{i}\times p)- N_{Ai} \right )}{\sqrt{N_{i}\times p(1-p)}}</code>
</p>
</li>
<li>
<p>chi-square test <code class="reqn">X_{x}^{2} = \sum_{i-1}^{n} X_{i}^{2}</code>;
<code class="reqn">X_{i}^{2} = (\frac{(N_{i}\times p - N_{Ai})^2}{N_{i}\times p} + \frac{(N_{i}\times (1 - p)- (N_{i} - N_{Ai}))^2}{N_{i}\times (1-p)})</code>
</p>
</li>
</ul>
<p>See references for more details on the methods
</p>
<p>Users can pick among Z-score for heterozygotes (<code>z.het, chi.het</code>),
all allele combinations (<code>z.all, chi.all</code>) and the assumption of no
probe bias p=0.5 (<code>z.05, chi.05</code>)
</p>
<p><code>filter</code> will determine whether the <code>intersection</code> or <code>kmeans</code>
clustering of the provided <code>test</code>s should be used in filtering CNVs.
The intersection uses threshold values for filtering and kmeans use
unsupervised clustering. Kmeans clustering is recommended if one is uncertain
about the threshold values.
</p>
<p><code>WGS</code> is a test parameter to include or exclude coefficient of variance
(cv) in kmeans. For data sets with more homogeneous depth distribution,
excluding cv improves CNV detection. If you're not certain about this, use
<code>TRUE</code> which is the default.
</p>


<h3>Value</h3>

<p>Returns a data frame of SNPs with their detected duplication status
</p>


<h3>Author(s)</h3>

<p>Piyal Karunarathne Qiujie Zhou
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: data(alleleINF)
DD&lt;-cnv(alleleINF)
## End(Not run)

</code></pre>


</div>