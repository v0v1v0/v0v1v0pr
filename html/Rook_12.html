<div class="container">

<table style="width: 100%;"><tr>
<td>Middleware-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class <code>Middleware</code>
</h2>

<h3>Description</h3>

<p>An abstract class for building Rook Middleware applications. <code>Middleware</code> applications either handle the incoming web request or hand off the request to the Rook app defined in the field of the same name.
</p>


<h3>Methods</h3>


<dl>
<dt>
<code>set_app(app)</code>:</dt>
<dd> <p><code>app</code> is a <code>Rook</code> application that will handle the request if this Middleware app does not. </p>
</dd>
</dl>
<h3>See Also</h3>

<p>The following classes implement Middleware: 
<code>Brewery</code> and <code>Static</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Middleware applications are typically instantiated in the argument list of
# Builder$new(), but here is stand-alone example.
# 
# Once your browser loads the app, you will see something like this in
# your location bar: http://127.0.0.1:28649/custom/middle. Add '/foo'
# onto the end of that and reload.

setRefClass(
    'FooBar',
    contains = 'Middleware',
    methods = list(
        initialize = function(...){
            # app to defer to.
            callSuper(app=App$new(function(env){
                res &lt;- Response$new()
                res$write("&lt;h1&gt;I'm the deferred app.&lt;/h1&gt;")
                res$finish()
            }))
        },
        call = function(env){
            req &lt;- Request$new(env)
            res &lt;- Response$new()
            if (length(grep('foo',req$path_info()))){
                res$write("&lt;h1&gt;I'm the middleware app.&lt;/h1&gt;")        
                return(res$finish())
            } else {
                app$call(env)
            }
        }
    )
)
s &lt;- Rhttpd$new()
## Not run: 
s$start(quiet=TRUE)

## End(Not run)
s$add(name="middle",app=getRefClass('FooBar')$new())
## Not run: 
s$browse('middle') # Opens a browser window to the app.

## End(Not run)
s$remove(all=TRUE)
rm(s)
</code></pre>


</div>