<div class="container">

<table style="width: 100%;"><tr>
<td>ECV.nSmooth.lowrank</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
selecting tuning parameter for neighborhood smoothing estimation of
graphon model
</h2>

<h3>Description</h3>

<p>selecting tuning parameter for neighborhood smoothing estimation of
graphon model where the tuning parameter is to control estimation smoothness.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ECV.nSmooth.lowrank(A, h.seq, K, cv = NULL, B = 3, holdout.p = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>

<p>adjacency matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.seq</code></td>
<td>

<p>a sequence of h values to tune. It is suggested h should be in the order
of sqrt(log(n)/n).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>

<p>the optimal rank for approximation. Can be obtained by rank selection of ECV.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>

<p>cross-validation fold. Recomend to use replication number B instead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>independent replication number of random splitting
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>holdout.p</code></td>
<td>

<p>proportion of test sample
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The neighborhood smoothing estimation can be slow, so the ECV may take
long even for moderately large networks.
</p>


<h3>Value</h3>

<p>a list object with
</p>
<table>
<tr style="vertical-align: top;">
<td><code>err </code></td>
<td>
<p>average validation error for h.seq</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.index </code></td>
<td>
<p>index of the minimum error</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tianxi Li, Elizaveta Levina, Ji Zhu<br>
Maintainer: Tianxi Li  <a href="mailto:tianxili@virginia.edu">tianxili@virginia.edu</a>
</p>


<h3>References</h3>

<p>T. Li, E. Levina, and J. Zhu. Network cross-validation by edge sampling. Biometrika, 107(2), pp.257-276, 2020.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(500)
N &lt;- 300

U = matrix(1:N,nrow=1) / (N+1)
V = matrix(1:N,nrow=1) / (N+1)

W = (t(U))^2
W = W/3*cos(1/(W + 1e-7)) + 0.15



upper.index &lt;- which(upper.tri(W))

A &lt;- matrix(0,N,N)


rand.ind &lt;- runif(length(upper.index))

edge.index &lt;- upper.index[rand.ind &lt; W[upper.index]]

A[edge.index] &lt;- 1

A &lt;- A + t(A)
diag(A) &lt;- 0


h.seq &lt;- sqrt(log(N)/N)*seq(0.5,5,by=0.5)


ecv.nsmooth &lt;- ECV.nSmooth.lowrank(A,h.seq,K=2,B=3) 

h &lt;- h.seq[ecv.nsmooth$min.index]


</code></pre>


</div>