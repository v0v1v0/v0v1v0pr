<div class="container">

<table style="width: 100%;"><tr>
<td>beat.1st</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute one stage multivariate optimal allocation.
</h2>

<h3>Description</h3>

<p>Compute multivariate optimal allocation for different domains in one stage stratified sample design
</p>


<h3>Usage</h3>

<pre><code class="language-R">     beat.1st(stratif, errors, minnumstrat=2, maxiter=200, maxiter1=25, epsilon=10^(-11))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stratif</code></td>
<td>
<p>Data frame of survey strata, for more details see, e.g.,strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>Data frame of expected coefficients of variation (CV) for each domain, for more details see, e.g.,errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minnumstrat</code></td>
<td>
<p>Minimum number of elementary units per strata (default=2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p> Maximum number of iterations (default=200) of the general procedure. This kind of iteration may be required by the fact that when in a stratum the number of allocated units is greater or equal to its population, that stratum is set as "census stratum", and the whole procedure is re-initialised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter1</code></td>
<td>
<p>Maximum number of iterations in Chromy algorithm (default=25).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Tollerance for the maximum absolute differences between the expected CV and the realised CV with the allocation obtained in the last iteraction for all domains. The default is 10^(-11).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The methodology is a generalization of Bethel multivariate allocation (1989) that extended the Neyman (1959) - Tchuprov (1923) allocation for multi-purpose and multi-domains surveys.
The generalized Bethelâ€™s algorithm allows to determine the optimal sample size for each stratum in a stratified sample design. The overall sample size and the allocation among the different strata is determined starting from the accuracy constraints imposed in the survey on interest estimates.</p>


<h3>Value</h3>

<p>Object of class <code>list</code>. The list contains 4 objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Vector with the optimal sample size for each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file_strata</code></td>
<td>
<p>Data frame corresponding to the input data.frame <code>stratif</code> with the <code>n</code> optimal sample size column added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alloc</code></td>
<td>
<p>Data frame with optimal (<code>ALLOC</code>), proportional (<code>PROP</code>), equal (<code>EQUAL</code>) sample size allocation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensitivity</code></td>
<td>
<p>Data frame with a summary of expected coefficients of variation (<code>Planned CV</code>), realized coefficients of variation with the given optimal allocation (<code>Actual CV</code>) and the sensitivity at 10% for each domain and each variable. Sensitivity can be a useful tool to help in finding the best allocation, because it provides a hint of the expected sample size variation for a 10% change in planned CVs.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Developed by Stefano Falorsi, Andrea Fasulo, Alessio Guandalini, Daniela Pagliuca, Marco D. Terribili.</p>


<h3>References</h3>

<p>Bethel, J. (1989)
<em>Sample allocation in multivariate surveys.</em>
Survey methodology, 15.1: 47-57.
</p>
<p>Cochran, W. (1977) 
<em>Sampling Techniques.</em> 
John Wiley &amp; Sons, Inc., New York
</p>
<p>Neyman, J. (1934). 
On the two different aspects of the representative method: the method of stratified sampling and the method of purposive selection. 
<em>Journal of the Royal Statistical Society</em>, 97(4): 558-625.
</p>
<p>Tschuprow, A. A. (1923). On the mathematical expectation of the moments of frequency distributions in the case of correlated observation. 
(Chapters 4-6). <em>Metron</em>, 2: 646-683.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load example data
data(beat.example)

## Example 1
# Allocate the sample
allocation_1 &lt;- beat.1st(stratif=strata, errors=errors)

# The total sample size is
sum(allocation_1$n)

## Example 2
# Assume 5700 units is the maximum sample size to stick to our budget.
# Looking at allocation_1$sensitivity we can see that most of the 
# sensitivity is in DOM1 for REG1 and REG2 due to V1.
allocation_1$sensitivity
# We can relax the constraints increasing the expected coefficients of variation for X1 by 10%
errors1 &lt;- errors 
errors1[1,2] &lt;- errors[1,2]+errors[1,2]*0.1

# Try the new allocation 
allocation_2 &lt;- beat.1st(stratif=strata, errors=errors1)
sum(allocation_2$n)

## Example 3
# On the contrary, if we tighten the constraints decreasing the expected coefficients of variation 
# for X1 by 10%
errors2 &lt;- errors 
errors2[1,2] &lt;- errors[1,2]-errors[1,2]*0.1

# The new allocation leads to a larger sample than the first example 
allocation_3 &lt;- beat.1st(stratif=strata, errors=errors2)
sum(allocation_3$n)
</code></pre>


</div>