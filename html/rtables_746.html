<div class="container">

<table style="width: 100%;"><tr>
<td>tt_to_flextable</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a <code>flextable</code> from an <code>rtables</code> table</h2>

<h3>Description</h3>

<p>Principally used for export (<code>export_as_docx()</code>), this function produces a <code>flextable</code>
from an <code>rtables</code> table. If <code>theme = NULL</code>, <code>rtables</code>-like style will be used. Otherwise,
<code>theme_docx_default()</code> will produce a <code>.docx</code>-friendly table.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tt_to_flextable(
  tt,
  theme = theme_docx_default(),
  border = flextable::fp_border_default(width = 0.5),
  indent_size = NULL,
  titles_as_header = TRUE,
  bold_titles = TRUE,
  footers_as_text = FALSE,
  counts_in_newline = FALSE,
  paginate = FALSE,
  fontspec = NULL,
  lpp = NULL,
  cpp = NULL,
  ...,
  colwidths = NULL,
  tf_wrap = !is.null(cpp),
  max_width = cpp,
  total_width = 10
)

theme_docx_default(
  font = "Arial",
  font_size = 9,
  cell_margins = c(word_mm_to_pt(1.9), word_mm_to_pt(1.9), 0, 0),
  bold = c("header", "content_rows", "label_rows", "top_left"),
  bold_manual = NULL,
  border = flextable::fp_border_default(width = 0.5)
)

theme_html_default(
  font = "Courier",
  font_size = 9,
  cell_margins = 0.2,
  remove_internal_borders = "label_rows",
  border = flextable::fp_border_default(width = 1, color = "black")
)

word_mm_to_pt(mm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>(<code>TableTree</code> or related class)<br> a <code>TableTree</code> object representing a populated table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme</code></td>
<td>
<p>(<code>function</code> or <code>NULL</code>)<br> A theme function that is designed internally as a function of a <code>flextable</code>
object to change its layout and style. If <code>NULL</code>, it will produce a table similar to <code>rtables</code> default. Defaults
to <code>theme_docx_default()</code> that is a classic Word output. See details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>(<code>flextable::fp_border()</code>)<br> border style. Defaults to <code>flextable::fp_border_default(width = 0.5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indent_size</code></td>
<td>
<p>(<code>numeric(1)</code>)<br> if <code>NULL</code>, the default indent size of the table (see <code>formatters::matrix_form()</code>
<code>indent_size</code>, default is 2) is used. To work with <code>docx</code>, any size is multiplied by 1 mm (2.83 pt) by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titles_as_header</code></td>
<td>
<p>(<code>flag</code>)<br> defaults to <code>TRUE</code> for <code>tt_to_flextable()</code>, so the table is self-contained
as it makes additional header rows for <code>formatters::main_title()</code> string and <code>formatters::subtitles()</code> character
vector (one per element). <code>FALSE</code> is suggested for <code>export_as_docx()</code>. This adds titles and subtitles as a text
paragraph above the table. The same style is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bold_titles</code></td>
<td>
<p>(<code>flag</code> or <code>integer</code>)<br> defaults to <code>TRUE</code> for <code>tt_to_flextable()</code>, so the titles are bold. If
it is one or more integers, those lines will be bold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footers_as_text</code></td>
<td>
<p>(<code>flag</code>)<br> defaults to <code>FALSE</code> for <code>tt_to_flextable()</code>, so the table is self-contained with
the <code>flextable</code> definition of footnotes. <code>TRUE</code> is used for <code>export_as_docx()</code> to add the footers as a new
paragraph after the table. The same style is applied, but with a smaller font.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts_in_newline</code></td>
<td>
<p>(<code>flag</code>)<br> defaults to <code>FALSE</code>. In <code>rtables</code> text printing (<code>formatters::toString()</code>),
the column counts, i.e. <code>(N=xx)</code>, are always on a new line. For <code>docx</code> exports it could be necessary to print it
on the same line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paginate</code></td>
<td>
<p>(<code>flag</code>)<br> when exporting <code>.docx</code> documents using <code>export_as_docx</code>, we suggest relying on the
Microsoft Word pagination system. If <code>TRUE</code>, this option splits <code>tt</code> into different "pages" as multiple
<code>flextables</code>. Cooperation between the two mechanisms is not guaranteed. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontspec</code></td>
<td>
<p>(<code>font_spec</code>)<br> a font_spec object specifying the font information to use for
calculating string widths and heights, as returned by <code>font_spec()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpp</code></td>
<td>
<p>(<code>numeric(1)</code>)<br> maximum lines per page including (re)printed header and context rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpp</code></td>
<td>
<p>(<code>numeric(1)</code> or <code>NULL</code>)<br> width (in characters) of the pages for horizontal pagination.
<code>NA</code> (the default) indicates <code>cpp</code> should be inferred from the page size; <code>NULL</code> indicates no horizontal
pagination should be done regardless of page size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to methods or tabulation functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colwidths</code></td>
<td>
<p>(<code>numeric</code>)<br> a vector of column widths for use in vertical pagination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tf_wrap</code></td>
<td>
<p>(<code>flag</code>)<br> whether the text for title, subtitles, and footnotes should be wrapped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_width</code></td>
<td>
<p>(<code>integer(1)</code>, <code>string</code> or <code>NULL</code>)<br> width that title and footer (including
footnotes) materials should be word-wrapped to. If <code>NULL</code>, it is set to the current print width of the
session (<code>getOption("width")</code>). If set to <code>"auto"</code>, the width of the table (plus any table inset) is
used. Parameter is ignored if <code>tf_wrap = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_width</code></td>
<td>
<p>(<code>numeric(1)</code>)<br> total width (in inches) for the resulting flextable(s). Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font</code></td>
<td>
<p>(<code>string</code>)<br> defaults to <code>"Arial"</code>. If the font is not available, <code>flextable</code> default is used.
Please consider consulting the family column from <code>systemfonts::system_fonts()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_size</code></td>
<td>
<p>(<code>integer(1)</code>)<br> font size. Defaults to 9.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_margins</code></td>
<td>
<p>(<code>numeric(1)</code> or <code>numeric(4)</code>)<br> a numeric or a vector of four numbers indicating
<code>c("left", "right", "top", "bottom")</code>. It defaults to 0 for top and bottom, and to 0.19 <code>mm</code> in word <code>pt</code>
for left and right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bold</code></td>
<td>
<p>(<code>character</code>)<br> parts of the table text that should be in bold. Can be any combination of
<code>c("header", "content_rows", "label_rows", "top_left")</code>. The first one renders all column names bold
(not <code>topleft</code> content). The second and third option use <code>formatters::make_row_df()</code> to render content or/and
label rows as bold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bold_manual</code></td>
<td>
<p>(named <code>list</code> or <code>NULL</code>)<br> list of index lists. See example for needed structure. Accepted
groupings/names are <code>c("header", "body")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_internal_borders</code></td>
<td>
<p>(<code>character</code>)<br> defaults to <code>"label_rows"</code>. Remove internal borders between rows.
Currently there are no other options and can be turned off by providing any character value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mm</code></td>
<td>
<p>(<code>numeric(1)</code>)<br> the value in mm to transform to pt.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Themes can also be extended when you need only a minor change from a default style. You can either
add your own theme to the theme call (e.g. <code>c(theme_docx_default(), my_theme)</code>) or create a new
theme like shown in the examples. Please pay attention to the parameters' inputs as they are relevant
for this to work properly.
Indeed, it is possible to use some hidden values for building your own theme (hence the need of <code>...</code>).
In particular, <code>tt_to_flextable</code> sends in the following variable: <code>tbl_row_class = make_row_df(tt)$node_class</code>.
This is ignored if not used in the theme. See <code>theme_docx_default</code> for an example on own to retrieve
these values and how to use them.
</p>


<h3>Value</h3>

<p>A <code>flextable</code> object.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>theme_docx_default()</code>: Main theme function for <code>export_as_docx()</code>.
</p>
</li>
<li> <p><code>theme_html_default()</code>: Theme function for html outputs.
</p>
</li>
<li> <p><code>word_mm_to_pt()</code>: Padding helper functions to transform mm to pt.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>export_as_docx()</code>
</p>
<p><code>export_as_docx()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">analysisfun &lt;- function(x, ...) {
  in_rows(
    row1 = 5,
    row2 = c(1, 2),
    .row_footnotes = list(row1 = "row 1 - row footnote"),
    .cell_footnotes = list(row2 = "row 2 - cell footnote")
  )
}

lyt &lt;- basic_table(
  title = "Title says Whaaaat", subtitles = "Oh, ok.",
  main_footer = "ha HA! Footer!"
) %&gt;%
  split_cols_by("ARM") %&gt;%
  analyze("AGE", afun = analysisfun)

tbl &lt;- build_table(lyt, ex_adsl)


library(flextable)
# example code

# rtables style
tt_to_flextable(tbl, theme = NULL)

tt_to_flextable(tbl, theme = theme_docx_default(font_size = 6))

# Example with multiple themes (only extending the docx default!)
my_theme &lt;- function(x, ...) {
  border_inner(x, part = "body", border = flextable::fp_border_default(width = 0.5))
}
flx &lt;- tt_to_flextable(tbl, theme = c(theme_docx_default(), my_theme))


library(flextable)
# Custom theme
special_bold &lt;- list(
  "header" = list("i" = 1, "j" = c(1, 3)),
  "body" = list("i" = c(1, 2), "j" = 1)
)
custom_theme &lt;- theme_docx_default(
  font_size = 10,
  font = "Brush Script MT",
  border = flextable::fp_border_default(color = "pink", width = 2),
  bold = NULL,
  bold_manual = special_bold
)
tt_to_flextable(tbl,
  border = flextable::fp_border_default(color = "pink", width = 2),
  theme = custom_theme
)

# Extending themes
my_theme &lt;- function(font_size = 6) { # here can pass additional arguments for default theme
  function(flx, ...) {
    # First apply theme_docx_default
    flx &lt;- theme_docx_default(font_size = font_size)(flx, ...)

    # Then apply additional styling
    flx &lt;- border_inner(flx, part = "body", border = flextable::fp_border_default(width = 0.5))

    return(flx)
  }
}
flx &lt;- tt_to_flextable(tbl, theme = my_theme())

</code></pre>


</div>