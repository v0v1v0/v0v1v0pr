<div class="container">

<table style="width: 100%;"><tr>
<td>eppls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit the Envelope-based Partial Partial Least Squares model 
</h2>

<h3>Description</h3>

<p>Fit the Envelope-based Partial Partial Least Squares model for multivariate linear regression with dimension u.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eppls(X1, X2, Y, u, asy = TRUE, init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>

<p>An <code class="reqn">n</code> by <code class="reqn">p1</code> matrix of continuous predictors, where <code class="reqn">p1</code> is the  number of continuous predictors with <code class="reqn">p1 &lt; n</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>

<p>An <code class="reqn">n</code> by <code class="reqn">p2</code> matrix of categorical predictors, where <code class="reqn">p2</code> is the  number of categorical predictors with <code class="reqn">p2 &lt; n</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>An <code class="reqn">n</code> by <code class="reqn">r</code> matrix of multivariate responses, where <code class="reqn">r</code> is the number of responses.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>A given dimension of the Envelope-based Partial Partial Least Squares.  It should be an interger between <code class="reqn">0</code> and <code class="reqn">p1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy</code></td>
<td>

<p>Flag for computing the asymptotic variance of the envelope estimator.  The default is <code>TRUE</code>. When p and r are large, computing the asymptotic variance can take much time and memory.  If only the envelope estimators are needed, the flag can be set to <code>asy = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>The user-specified value of Gamma for the envelope subspace. An <code class="reqn">r</code> by <code class="reqn">u</code> matrix. The default is the one generated by function envMU.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function the Envelope-based Partial Partial Least Squares model for multivariate linear regression with dimension <code class="reqn">u</code>, </p>
<p style="text-align: center;"><code class="reqn">
 Y = \mu + \Gamma\eta X + \varepsilon, \Sigma=\Gamma\Omega\Gamma' + \Gamma_{0}\Omega_{0}\Gamma'_{0}
 </code>
</p>

<p>using the maximum likelihood estimation.  When the dimension of the envelope is between 1 and <code class="reqn">p1</code>-1, the starting value and blockwise coordinate descent algorithm in Cook et al. (2016) is implemented.  When the dimension is <code class="reqn">p1</code>, then the envelope model degenerates to the standard multivariate linear regression.  When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different.
</p>


<h3>Value</h3>

<p>The output is a list that contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>muY</code></td>
<td>

<p>The estimator of mean of <code>Y</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu1</code></td>
<td>

<p>The estimator of mean of <code>X1</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu2</code></td>
<td>

<p>The estimator of mean of <code>X2</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta1</code></td>
<td>

<p>A <code class="reqn">p1</code> by <code class="reqn">r</code> matrix for the estimator of regression coefficients for continuous predictors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta2</code></td>
<td>

<p>A <code class="reqn">p2</code> by <code class="reqn">r</code> matrix for the estimator of regression coefficients for categorical predictors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>

<p>An <code class="reqn">p1</code> by <code class="reqn">d</code> matrix for the orthogonal basis of the Envelope-based Partial Partial Least Squares.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma0</code></td>
<td>

<p>An <code class="reqn">p1</code> by <code class="reqn">(p1-d)</code> matrix for the orthogonal basis of the complement of the Envelope-based Partial Partial Least Squares.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>A <code class="reqn">p2</code> by <code class="reqn">p1</code> matrix for the estimator of regression coefficients based on the regression of <code>X1</code> on <code>X2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>

<p>A <code class="reqn">d</code> by <code class="reqn">p1</code> matrix for the coordinates of <code>beta1</code> with respect to <code>Gamma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>

<p>A <code class="reqn">d</code> by <code class="reqn">d</code> matrix for the coordinates of <code>SigmaX1</code> with respect to <code>Gamma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega0</code></td>
<td>

<p>A <code class="reqn">(p1-d)</code> by <code class="reqn">(p1-d)</code> matrix for the coordinates of <code>SigmaX1</code> with respect to <code>Gamma0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaX1</code></td>
<td>

<p>The estimator of error covariance matrix <code>Sigma</code>[1|2]. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaYcX</code></td>
<td>

<p>The estimator of error covariance matrix <code>Sigma</code>[<code>Y</code>|<code>X</code>]. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>

<p>The maximized log likelihood function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>The number of observations in the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMatrix1</code></td>
<td>

<p>The asymptotic covariance of vec(beta1). The covariance matrix returned are asymptotic.  For the actual standard errors, multiply by 1 / n.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMatrix2</code></td>
<td>

<p>The asymptotic covariance of vec(beta2). The covariance matrix returned are asymptotic.  For the actual standard errors, multiply by 1 / n.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asySE1</code></td>
<td>

<p>The asymptotic standard error matrix for elements in <code>beta1</code>. The multiplication by the reciprocal of square root of <code class="reqn">n</code> returns actual standard errors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asySE2</code></td>
<td>

<p>The asymptotic standard error matrix for elements in <code>beta2</code>. The multiplication by the reciprocal of square root of <code class="reqn">n</code> returns actual standard errors.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Park, Y., Su, Z. and Chung, D. (2022+)  Envelope-based Partial Partial Least Squares with Application to Cytokine-based Biomarker Analysis for COVID-19.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(amitriptyline)
  
  Y &lt;- amitriptyline[ , 1:2]
  X1 &lt;- amitriptyline[ , 4:7]
  X2 &lt;- amitriptyline[ , 3]
  u &lt;- u.eppls(X1, X2, Y)
  
  u
  
  m &lt;- eppls(X1, X2, Y, 2)
  m
</code></pre>


</div>