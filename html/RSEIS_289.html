<div class="container">

<table style="width: 100%;"><tr>
<td>sigconvGR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>convolve for Ground roll
</h2>

<h3>Description</h3>

<p>convolve a set of spikes
for extended ground roll.  This is a special case of sigconv.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sigconvGR(wigmat, wavepulse, dt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wigmat</code></td>
<td>
<p>matrix of traces with spikes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wavepulse</code></td>
<td>
<p>wavelet
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>sampling interval
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is similar to the sigconv program but it
assumes that the ground roll is extrened in time and space as the wave
expands.
</p>


<h3>Value</h3>

<p>Matrix, waveforms
</p>


<h3>Note</h3>

<p>the program spreads the sinusoidal wavelet along a band to
simulate ground-roll
head wave noise.
</p>


<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;
</p>


<h3>See Also</h3>

<p>wiggleimage, symshot1, genrick, sigconv
</p>


<h3>Examples</h3>

<pre><code class="language-R">
S1 &lt;- symshot1()
dt &lt;- S1$dt
###########    these are the reflections S1$GRrec

d &lt;- dim(S1$smograms)
G1 &lt;- matrix( rep(0, length=d[1]*d[2]), ncol=d[2], nrow=d[1])

###   these are the refractions S1$THEORY$trefrac
p &lt;- round( S1$THEORY$trefrac[1,]/S1$dt );
G1[cbind(p , 1:d[2])  ] &lt;- 1


#### plot the spikes
wiggleimage(0.1*G1, dt = -S1$dt, dx = S1$x, col = "black")

grlen &lt;- floor(.6/dt)
fgr &lt;- 10
tape &lt;- applytaper( rep(1, grlen), p = 0.2)
tgr &lt;- seq(from=0, by=dt, length=grlen)
siggr &lt;- tape*sin(2*pi*fgr*tgr)

##############  convolve the wavelet with the set of spikes
H1 &lt;- sigconvGR(G1, siggr, dt)

############  plot
wiggleimage(0.1*H1, dt = -S1$dt, dx = S1$x, col = "black")

</code></pre>


</div>