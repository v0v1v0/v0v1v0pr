<div class="container">

<table style="width: 100%;"><tr>
<td>SearchForPolygon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use kd-trees to search the nearest neighbour polygons for a given set of points</h2>

<h3>Description</h3>

<p>This function uses the nn2() function from the RANN package to come up
with a shorter list of candidates on which point.in.polygon() from the 
sp package can be applied.</p>


<h3>Usage</h3>

<pre><code class="language-R">SearchForPolygon(poly.list, XY, k, poly.id, poly.id.colname, 
    verbose = 0)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>poly.list</code></td>
<td>
<p>polygon list with 3-4 elements: poly.centers, data, polys and possibly ranges</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XY</code></td>
<td>
<p>data frame containing X-Y columns to assign polygons to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>maximum number of nearest neighbours to compute. The default value is set to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly.id</code></td>
<td>
<p>column name in 'poly.list$data' containing the polygon identifier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly.id.colname</code></td>
<td>
<p>desired column name in the output data frame containing the polygon identifier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>level of verbosity</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns data frame with identified polygon and nearest neighbour rank</p>


<h3>Author(s)</h3>

<p>Markus Loecher &lt;markus.loecher@gmail.com&gt; and Madhav Kumar &lt;madhavkumar2005@gmail.com&gt;</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sf.crime.2012, envir = environment())
data(sf.polys, envir = environment())
XY.polys &lt;- SearchForPolygon(poly.list= sf.polys, XY= sf.crime.2012[1:1000,], k= 10,
                             poly.id= "fips", poly.id.colname= "census.block",
                             verbose= TRUE)

</code></pre>


</div>