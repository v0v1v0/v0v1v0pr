<div class="container">

<table style="width: 100%;"><tr>
<td>readOBDP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read OBDP Outputs</h2>

<h3>Description</h3>

<p>Reads and formats the outputs of an analysis with the Occurrence Birth Death Process (MCMC parameter 
inference + diversity estimation)
</p>


<h3>Usage</h3>

<pre><code class="language-R">readOBDP(
  start_time_trace_file,
  popSize_distribution_matrices_file,
  trees_trace_file
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>start_time_trace_file</code></td>
<td>
<p>(character; no default)  Trace of the starting times along the MCMC chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popSize_distribution_matrices_file</code></td>
<td>
<p>(character; no default)  Kt matrices computed with 'fnInferAncestralPopSize' in RevBayes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trees_trace_file</code></td>
<td>
<p>(character; no default)  Trace of the trees.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# first run readOBDP()
start_time_trace_file &lt;- 
     system.file("extdata", "obdp/start_time_trace.p", package="RevGadgets")
popSize_distribution_matrices_file &lt;- 
     system.file("extdata", "obdp/Kt_trace.p", package="RevGadgets")
trees_trace_file &lt;- 
     system.file("extdata", "obdp/mcmc_OBDP_trees.p", package="RevGadgets")
    
Kt_mean &lt;- readOBDP( start_time_trace_file=start_time_trace_file, 
                     popSize_distribution_matrices_file=popSize_distribution_matrices_file, 
                     trees_trace_file=trees_trace_file )

# then get the customized ggplot object with plotDiversityOBDP()
p &lt;- plotDiversityOBDP( Kt_mean,
                        xlab="Time (My)",
                        ylab="Number of lineages",
                        xticks_n_breaks=21,
                        col_Hidden="dodgerblue3",
                        col_LTT="gray25",
                        col_Total="forestgreen",
                        col_Hidden_interval="dodgerblue2",
                        col_Total_interval="darkolivegreen4",
                        palette_Hidden=c("transparent", "dodgerblue2", "dodgerblue3", 
                                         "dodgerblue4", "black"),
                        palette_Total=c("transparent", "green4", "forestgreen", "black"),
                        line_size=0.7,
                        interval_line_size=0.5,
                        show_Hidden=TRUE,
                        show_LTT=TRUE,
                        show_Total=TRUE,
                        show_intervals=TRUE,
                        show_densities=TRUE,
                        show_expectations=TRUE,
                        use_interpolate=TRUE )

# basic plot
p

# option: add a stratigraphic scale
library(deeptime)
library(ggplot2)
q &lt;- gggeo_scale(p, dat="periods", height=unit(1.3, "line"), abbrv=F, size=4.5, neg=T)
r &lt;- gggeo_scale(q, dat="epochs", height=unit(1.1, "line"), abbrv=F, size=3.5, neg=T, 
                    skip=c("Paleocene", "Pliocene", "Pleistocene", "Holocene"))
s &lt;- gggeo_scale(r, dat="stages", height=unit(1, "line"), abbrv=T, size=2.5, neg=T)
s

## End(Not run)

</code></pre>


</div>