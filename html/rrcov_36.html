<div class="container">

<table style="width: 100%;"><tr>
<td>CovMest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constrained M-Estimates of Location and Scatter</h2>

<h3>Description</h3>

<p>Computes constrained M-Estimates of multivariate location and scatter
based on the translated biweight function (‘t-biweight’) using
a High breakdown point initial estimate as defined by Rocke (1996).
The default initial estimate is the Minimum Volume Ellipsoid computed
with <code>CovMve</code>. The raw (not reweighted) estimates are taken
and the covariance matrix is standardized to determinant 1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">    CovMest(x, r = 0.45, arp = 0.05, eps=1e-3,
        maxiter=120, control, t0, S0, initcontrol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p> required breakdown point.  Allowed values are between
<code>(n - p)/(2 * n)</code> and 1 and the default is 0.45</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arp</code></td>
<td>
<p> asympthotic rejection point, i.e. the fraction of points
receiving zero weight (see Rocke (1996)).  Default is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p> a numeric value specifying the relative precision of the solution of
the M-estimate. Defaults to <code>1e-3</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p> maximum number of iterations allowed in the computation of
the M-estimate. Defaults to 120</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> a control object (S4) of class <code>CovControlMest-class</code>
containing estimation options - same as these provided in the fucntion
specification. If the control object is supplied, the parameters from it
will be used. If parameters are passed also in the invocation statement, they will
override the corresponding elements of the control object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p> optional initial high breakdown point estimates of the location.
If not supplied MVE will be used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p> optional initial high breakdown point estimates of the
scatter. If not supplied MVE will be used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initcontrol</code></td>
<td>
<p> optional control object - of class CovControl - specifing the
initial high breakdown point estimates of location and scatter. If not supplied
MVE will be used. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rocke (1996) has shown that the S-estimates of multivariate location and scatter
in high dimensions can be sensitive to outliers even if the breakdown point
is set to be near 0.5. To mitigate this problem he proposed to utilize
the translated  biweight (or t-biweight) method with a
standardization step consisting of equating the median of <code>rho(d)</code>
with the median under normality. This is then not an S-estimate, but is
instead a constrained M-estimate. In order to make the smooth estimators
to work, a reasonable starting point is necessary, which will lead reliably to a
good solution of the estimator. In <code>CovMest</code> the MVE computed by
<code>CovMve</code> is used, but the user has the possibility to give her own
initial estimates.
</p>


<h3>Value</h3>

<p>An object of class <code>CovMest-class</code> which is a subclass of the virtual class <code>CovRobust-class</code>.
</p>


<h3>Note</h3>

<p>The psi, rho and weight functions for the M estimation are encapsulated in a
virtual S4 class <code>PsiFun</code> from which a <code>PsiBwt</code> class, implementing
the translated biweight (t-biweight), is dervied. The base class  <code>PsiFun</code>
contains also the M-iteration itself. Although not documented and not
accessibale directly by the user these classes will form the bases for adding
other functions (biweight, LWS, etc.) as well as S-estimates.
</p>


<h3>Author(s)</h3>

<p>Valentin Todorov <a href="mailto:valentin.todorov@chello.at">valentin.todorov@chello.at</a>,
</p>
<p>(some code from C. Becker -
http://www.sfb475.uni-dortmund.de/dienst/de/content/struk-d/bereicha-d/tpa1softw-d.html)
</p>


<h3>References</h3>

<p>D.L.Woodruff and D.M.Rocke (1994) Computable robust estimation of multivariate location
and shape on high dimension using compound estimators, <em>Journal of the American
Statistical Association</em>, <b>89</b>, 888–896.
</p>
<p>D.M.Rocke (1996) Robustness properties of S-estimates of multivariate location and
shape in high dimension, <em>Annals of Statistics</em>, <b>24</b>, 1327-1345.
</p>
<p>D.M.Rocke and D.L.Woodruff (1996) Identification of outliers in multivariate data <em>Journal
of the American Statistical Association</em>, <b>91</b>, 1047–1061.
</p>
<p>Todorov V &amp; Filzmoser P (2009), An Object Oriented Framework for Robust Multivariate Analysis. 
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1–47.
<a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>.
</p>


<h3>See Also</h3>

<p><code>covMcd</code>, <code>Cov-class</code>,
<code>CovMve</code>,
<code>CovRobust-class</code>, <code>CovMest-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(rrcov)
data(hbk)
hbk.x &lt;- data.matrix(hbk[, 1:3])
CovMest(hbk.x)

## the following four statements are equivalent
c0 &lt;- CovMest(hbk.x)
c1 &lt;- CovMest(hbk.x, r = 0.45)
c2 &lt;- CovMest(hbk.x, control = CovControlMest(r = 0.45))
c3 &lt;- CovMest(hbk.x, control = new("CovControlMest", r = 0.45))

## direct specification overrides control one:
c4 &lt;- CovMest(hbk.x, r = 0.40,
             control = CovControlMest(r = 0.25))
c1
summary(c1)
plot(c1)
</code></pre>


</div>