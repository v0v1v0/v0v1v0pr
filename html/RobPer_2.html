<div class="container">

<table style="width: 100%;"><tr>
<td>betaCvMfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust fit of a Beta distribution using CvM distance minimization
</h2>

<h3>Description</h3>

<p>Robustly fits a Beta distribution to <code>data</code> using Cramér-von-Mises (CvM) distance minimization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">betaCvMfit(data, CvM = TRUE, rob = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>numeric vector: The sample, a Beta distribution is fitted to. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CvM</code></td>
<td>

<p>logical: If <code>FALSE</code> the Cramér-von-Mises-distance is not minimized, but only moment estimates for the parameters of the Beta distribution are returned (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rob</code></td>
<td>

<p>logical: If <code>TRUE</code>, mean and standard deviation are replaced by median and MAD when calculating moment estimates for the parameters of the Beta distribution (see Details). 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>betaCvMfit</code> fits a Beta distribution to <code>data</code> by minimizing the Cramér-von-Mises distance.
Moment estimates of the parameters of the Beta distribution, clipped to positive values, are used as 
starting values for the optimization process. They are calculated using
</p>
<p style="text-align: center;"><code class="reqn">\hat a=-\frac{\bar x \cdot (-\bar x + \bar x^2 + \hat s^2)}{\hat s^2},</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat b= \frac{\hat a - \hat a \bar x}{\bar x}.</code>
</p>
                                                                         
<p>These clipped moment estimates can be returned instead
of CvM-fitted parameters setting <code>CvM = FALSE</code>.
</p>
<p>The Cramér-von-Mises distance is defined as (see Clarke, McKinnon and Riley 2012)   
</p>
<p style="text-align: center;"><code class="reqn">\frac 1n \sum_{i=1}^n \left(F(u_{(i)}) - 
  \frac{i-0.5}{n}\right)^2+ \frac{1}{12n^2},</code>
</p>
<p> where 
<code class="reqn">u_{(1)},\ldots,u_{(n)}</code> is the ordered sample and <code class="reqn">F</code> the 
distribution function of Beta<code class="reqn">(a,b)</code>. 
</p>


<h3>Value</h3>

<p>numeric vector: Estimates for the Parameters <code class="reqn">a,b</code> of a Beta<code class="reqn">(a,b)</code> distribution with mean <code class="reqn">a/(a+b)</code>.
</p>


<h3>Note</h3>

<p>Adapted from R-Code from Brenton R. Clarke to fit a Gamma distribution (see Clarke, McKinnon and Riley 2012) using Cramér-von-Mises distance minimization. 
Used in Thieler et al. (2013). See also Thieler, Fried and Rathjens (2016).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler, with contributions from Brenton R. Clarke.
</p>


<h3>References</h3>

<p>Clarke, B. R., McKinnon, P. L. and Riley, G. (2012): A Fast Robust Method for Fitting Gamma Distributions. Statistical Papers, 53 (4), 1001-1014
</p>
<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>See <code>RobPer-package</code> for an example applying <code>betaCvMfit</code> to detect valid periods in a periodogram.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data:
set.seed(12)
PP &lt;- c(rbeta(45, shape1=4, shape2=15), runif(5, min=0.8, max=1))
hist(PP, freq=FALSE, breaks=30, ylim=c(0,7), xlab="Periodogram bar")

# true parameters:
myf.true &lt;- function(x) dbeta(x, shape1=4, shape2=15)
curve(myf.true, add=TRUE, lwd=2)

# method of moments:
par.mom &lt;- betaCvMfit(PP, rob=FALSE, CvM=FALSE)
myf.mom &lt;- function(x) dbeta(x, shape1=par.mom[1], shape2=par.mom[2])
curve(myf.mom, add=TRUE, lwd=2, col="red")

# robust method of moments
par.rob &lt;- betaCvMfit(PP, rob=TRUE, CvM=FALSE)
myf.rob &lt;- function(x) dbeta(x, shape1=par.rob[1], shape2=par.rob[2])
curve(myf.rob, add=TRUE, lwd=2, col="blue")

# CvM distance minimization
par.CvM &lt;- betaCvMfit(PP, rob=TRUE, CvM=TRUE)
myf.CvM &lt;- function(x) dbeta(x, shape1=par.CvM[1], shape2=par.CvM[2])
curve(myf.CvM, add=TRUE, lwd=2, col="green")

# Searching for outliers...
abline(v=qbeta((0.95)^(1/50), shape1=par.CvM[1], shape2=par.CvM[2]), col="green")

legend("topright", fill=c("black", "green","blue", "red"),
    legend=c("true", "CvM", "robust moments", "moments"))
box()
</code></pre>


</div>