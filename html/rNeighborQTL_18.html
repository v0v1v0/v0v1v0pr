<div class="container">

<table style="width: 100%;"><tr>
<td>sim_nei_qtl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phenotype simulation for neighbor QTL effects</h2>

<h3>Description</h3>

<p>A function to simulate neighbor effects with given QTL effects, distance scale, and causal markers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_nei_qtl(
  genoprobs,
  a2,
  d2,
  smap,
  scale,
  grouping = rep(1, nrow(smap)),
  n_QTL = 1,
  contrasts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genoprobs</code></td>
<td>
<p>Conditional genotype probabilities as taken from <code>qtl::calc.genoprob()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2</code></td>
<td>
<p>A numeric scalar indicating additive deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d2</code></td>
<td>
<p>A numeric scalar indicating dominance deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smap</code></td>
<td>
<p>A matrix showing a spatial map for individuals. The first and second column include spatial positions along an x-axis and y-axis, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A numeric scalar indicating the maximum spatial distance between a focal individual and neighbors to define neighbor effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>An integer vector assigning each individual to a group. This argument can be used when <code>smap</code> contains different experimental replicates. Default setting means that all individuals are belong to a single group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_QTL</code></td>
<td>
<p>A positive integer indicating the number of causal markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>An optional vector composed of three TRUE/FALSE values, which represents the presence/absence of specific genotypes as c(TRUE/FALSE, TRUE/FALSE, TRUE/FALSE) = AA, AB, BB. If <code>NULL</code>, it is compiled from <code>genoprobs</code> automatically.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Major genetic effects, <code>a2</code> and <code>d2</code>, are allocated to causal loci randomly selected by <code>n_QTL</code>, while minor polygenic effects (i.e., 1% of <code>a2</code>) are allocated to the other loci.
</p>


<h3>Value</h3>

<p>A numeric matrix containing individuals x marker elements for neighbor QTL effects.
</p>

<ul>
<li>
<p><code>true_scale</code> True distance scale of simulated neighbor effects
</p>
</li>
<li>
<p><code>true_marker</code> The name(s) of causal markers
</p>
</li>
<li>
<p><code>nei_y</code> Simulated neighbor effects standardized to have zero mean and one variance
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Yasuhiro Sato (<a href="mailto:sato.yasuhiro.36c@kyoto-u.jp">sato.yasuhiro.36c@kyoto-u.jp</a>)
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
test_map &lt;- qtl::sim.map(len=rep(20,5),n.mar=3,include.x=FALSE)
test_cross &lt;- qtl::sim.cross(test_map,n.ind=50)
test_smap &lt;- cbind(runif(50,1,100),runif(50,1,100))
test_genoprobs &lt;- qtl::calc.genoprob(test_cross,step=2)

nei_eff &lt;- sim_nei_qtl(genoprobs=test_genoprobs, a2=0.5, d2=0.5,
                       smap=test_smap,
                       scale=20, n_QTL=1)

test_scan &lt;- scan_neighbor(genoprobs=test_genoprobs,
                           pheno=nei_eff$nei_y,
                           smap=test_smap, scale=20
                           )
plot_nei(test_scan)
</code></pre>


</div>