<div class="container">

<table style="width: 100%;"><tr>
<td>rust_source</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compile Rust code and call from R</h2>

<h3>Description</h3>

<p><code>rust_source()</code> compiles and loads a single Rust file for use in R. <code>rust_function()</code>
compiles and loads a single Rust function for use in R.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rust_source(
  file,
  code = NULL,
  module_name = "rextendr",
  dependencies = NULL,
  patch.crates_io = getOption("rextendr.patch.crates_io"),
  profile = c("dev", "release", "perf"),
  toolchain = getOption("rextendr.toolchain"),
  extendr_deps = NULL,
  features = NULL,
  env = parent.frame(),
  use_extendr_api = TRUE,
  generate_module_macro = TRUE,
  cache_build = TRUE,
  quiet = FALSE,
  use_rtools = TRUE,
  use_dev_extendr = FALSE
)

rust_function(
  code,
  extendr_fn_options = NULL,
  env = parent.frame(),
  quiet = FALSE,
  use_dev_extendr = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Input rust file to source.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>Input rust code, to be used instead of <code>file</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>module_name</code></td>
<td>
<p>Name of the module defined in the Rust source via
<code style="white-space: pre;">⁠extendr_module!⁠</code>. Default is <code>"rextendr"</code>. If <code>generate_module_macro</code> is <code>FALSE</code>
or if <code>file</code> is specified, should <em>match exactly</em> the name of the module defined in the source.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dependencies</code></td>
<td>
<p>Character vector of dependencies lines to be added to the
<code>Cargo.toml</code> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patch.crates_io</code></td>
<td>
<p>Character vector of patch statements for crates.io to
be added to the <code>Cargo.toml</code> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profile</code></td>
<td>
<p>Rust profile. Can be either <code>"dev"</code>, <code>"release"</code> or <code>"perf"</code>.
The default, <code>"dev"</code>, compiles faster but produces slower code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toolchain</code></td>
<td>
<p>Rust toolchain. The default, <code>NULL</code>, compiles with the
system default toolchain. Accepts valid Rust toolchain qualifiers,
such as <code>"nightly"</code>, or (on Windows) <code>"stable-msvc"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extendr_deps</code></td>
<td>
<p>Versions of <code style="white-space: pre;">⁠extendr-*⁠</code> crates. Defaults to <code>rextendr.extendr_deps</code> option
(<code>list(`extendr-api` = "*")</code>) if <code>use_dev_extendr</code> is not <code>TRUE</code>,
otherwise, uses <code>rextendr.extendr_dev_deps</code> option
(<code>list(`extendr-api` = list(git = "https://github.com/extendr/extendr")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>A vector of <code>extendr-api</code> features that should be enabled.
Supported values are <code>"ndarray"</code>, <code>"num-complex"</code>, <code>"serde"</code>, and <code>"graphics"</code>.
Unknown features will produce a warning if <code>quiet</code> is not <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>The R environment in which the wrapping functions will be defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_extendr_api</code></td>
<td>
<p>Logical indicating whether
<code style="white-space: pre;">⁠use extendr_api::prelude::*;⁠</code> should be added at the top of the Rust source
provided via <code>code</code>. Default is <code>TRUE</code>. Ignored for Rust source provided
via <code>file</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generate_module_macro</code></td>
<td>
<p>Logical indicating whether the Rust module
macro should be automatically generated from the code. Default is <code>TRUE</code>.
Ignored for Rust source provided via <code>file</code>. The macro generation is done
with <code>make_module_macro()</code> and it may fail in complex cases. If something
doesn't work, try calling <code>make_module_macro()</code> on your code to see whether
the generated macro code has issues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache_build</code></td>
<td>
<p>Logical indicating whether builds should be cached between
calls to <code>rust_source()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Logical indicating whether compile output should be generated or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_rtools</code></td>
<td>
<p>Logical indicating whether to append the path to Rtools
to the <code>PATH</code> variable on Windows using the <code>RTOOLS40_HOME</code> environment
variable (if it is set). The appended path depends on the process
architecture. Does nothing on other platforms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_dev_extendr</code></td>
<td>
<p>Logical indicating whether to use development version of
<code>extendr</code>. Has no effect if <code>extendr_deps</code> are set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extendr_fn_options</code></td>
<td>
<p>A list of extendr function options that are inserted into
<code style="white-space: pre;">⁠#[extendr(...)]⁠</code> attribute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters handed off to <code>rust_source()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The result from <code>dyn.load()</code>, which is an object of class <code>DLLInfo</code>.
See <code>getLoadedDLLs()</code> for more details.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# creating a single rust function
rust_function("fn add(a:f64, b:f64) -&gt; f64 { a + b }")
add(2.5, 4.7)

# creating multiple rust functions at once
code &lt;- r"(
#[extendr]
fn hello() -&gt; &amp;'static str {
    "Hello, world!"
}

#[extendr]
fn test( a: &amp;str, b: i64) {
    rprintln!("Data sent to Rust: {}, {}", a, b);
}
)"

rust_source(code = code)
hello()
test("a string", 42)


# use case with an external dependency: a function that converts
# markdown text to html, using the `pulldown_cmark` crate.
code &lt;- r"(
  use pulldown_cmark::{Parser, Options, html};

  #[extendr]
  fn md_to_html(input: &amp;str) -&gt; String {
    let mut options = Options::empty();
    options.insert(Options::ENABLE_TABLES);
    let parser = Parser::new_ext(input, options);
    let mut output = String::new();
    html::push_html(&amp;mut output, parser);
    output
  }
)"
rust_source(
  code = code,
  dependencies = list(`pulldown-cmark` = "0.8")
)

md_text &lt;- "# The story of the fox
The quick brown fox **jumps over** the lazy dog.
The quick *brown fox* jumps over the lazy dog."

md_to_html(md_text)

## End(Not run)
</code></pre>


</div>