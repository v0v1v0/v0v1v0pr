<div class="container">

<table style="width: 100%;"><tr>
<td>update_s</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update class weight vector</h2>

<h3>Description</h3>

<p>This function updates the class weight vector by drawing from its posterior distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">update_s(delta, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>A numeric for the concentration parameter vector <code>rep(delta,C)</code> of the
Dirichlet prior for <code>s</code>.
Per default, <code>delta = 1</code>. In case of Dirichlet process-based updates of the
latent classes, <code>delta = 0.1</code> per default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The vector of current class frequencies.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">m=(m_1,\dots,m_C)</code> be the frequencies of <code class="reqn">C</code> classes.
Given the class weight (probability) vector <code class="reqn">s=(s_1,\dots,s_C)</code>, the distribution
of <code class="reqn">m</code> is multinomial and its likelihood is </p>
<p style="text-align: center;"><code class="reqn">L(m\mid s) \propto \prod_{i=1}^C s_i^{m_i}.</code>
</p>

<p>The conjugate prior <code class="reqn">p(s)</code> for <code class="reqn">s</code> is a Dirichlet distribution, which has a density function
proportional to </p>
<p style="text-align: center;"><code class="reqn">\prod_{i=1}^C s_i^{\delta_i-1},</code>
</p>
<p> where <code class="reqn">\delta = (\delta_1,\dots,\delta_C)</code>
is the concentration parameter vector.
Note that in <code>{RprobitB}</code>, <code class="reqn">\delta_1=\dots=\delta_C</code>. This restriction is necessary because the class number <code class="reqn">C</code> can change.
The posterior distribution of <code class="reqn">s</code> is proportional to </p>
<p style="text-align: center;"><code class="reqn">p(s) L(m\mid s) \propto \prod_{i=1}^C s_i^{\delta_i + m_i - 1},</code>
</p>

<p>which in turn is proportional to a Dirichlet distribution with parameters <code class="reqn">\delta+m</code>.
</p>


<h3>Value</h3>

<p>A vector, a draw from the Dirichlet posterior distribution for <code>s</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### number of classes
C &lt;- 4
### current class sizes
m &lt;- sample.int(C)
### concentration parameter for Dirichlet prior (single-valued)
delta &lt;- 1
### updated class weight vector
update_s(delta = 1, m = m)
</code></pre>


</div>