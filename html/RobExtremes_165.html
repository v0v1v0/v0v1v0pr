<div class="container">

<table style="width: 100%;"><tr>
<td>LDEstimator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Function to compute LD (location-dispersion) estimates </h2>

<h3>Description</h3>

<p>Function <code>LDEstimator</code> provides a general way to compute
estimates for a given parametric family of probability measures
(with a scale and shape parameter) which
can be obtained by matching location and dispersion functionals
against empirical counterparts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LDEstimator(x, loc.est, disp.est, loc.fctal, disp.fctal, ParamFamily,
            loc.est.ctrl = NULL, loc.fctal.ctrl=NULL,
            disp.est.ctrl = NULL, disp.fctal.ctrl=NULL,
            q.lo =1e-3, q.up=15, log.q =TRUE,
            name, Infos, asvar = NULL, nuis.idx = NULL,
            trafo = NULL, fixed = NULL, asvar.fct  = NULL, na.rm = TRUE,
            ..., .withEvalAsVar = FALSE, vdbg = FALSE)
medkMAD(x, ParamFamily, k=1, q.lo =1e-3, q.up=15, nuis.idx = NULL,
        trafo = NULL, fixed = NULL, asvar.fct = NULL, na.rm = TRUE,
        ..., .withEvalAsVar = FALSE, vdbg = FALSE)
medkMADhybr(x, ParamFamily, k=1, q.lo =1e-3, q.up=15, KK = 20, nuis.idx = NULL,
        trafo = NULL, fixed = NULL,  asvar.fct = NULL, na.rm = TRUE,
        ..., .withEvalAsVar = FALSE)
medSn(x, ParamFamily, q.lo =1e-3, q.up=10, nuis.idx = NULL,
      trafo = NULL, fixed = NULL, asvar.fct = NULL, na.rm = TRUE,
      accuracy = 100, ..., .withEvalAsVar = FALSE)
medQn(x, ParamFamily, q.lo =1e-3, q.up=15, nuis.idx = NULL,
      trafo = NULL, fixed = NULL, asvar.fct = NULL, na.rm = TRUE,
      ..., .withEvalAsVar = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> (empirical) data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParamFamily</code></td>
<td>
<p>an object of class <code>"ParamFamily"</code>. The parametric
family at which to evaluate the LDEstimator; the respective
(main) parameter must contain <code>"scale"</code>
and <code>"shape"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.est</code></td>
<td>
<p>a function expecting <code>x</code> (a numeric vector)
as first argument; location estimator. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.est</code></td>
<td>
<p>a function expecting <code>x</code> (a numeric vector)
as first argument; dispersion estimator; may only take
non-negative values.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.fctal</code></td>
<td>
<p>a function expecting a distribution object as first
argument; location functional. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.fctal</code></td>
<td>
<p>a function expecting a distribution object as first
argument; dispersion functional; may only take
non-negative values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.est.ctrl</code></td>
<td>
<p>a list (or <code>NULL</code>); optional additional arguments
for the location estimator. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.est.ctrl</code></td>
<td>
<p>a list (or <code>NULL</code>); optional additional arguments
for the dispersion estimator.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.fctal.ctrl</code></td>
<td>
<p>a list (or <code>NULL</code>); optional additional arguments
for the location functional. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.fctal.ctrl</code></td>
<td>
<p>a list (or <code>NULL</code>); optional additional arguments
for the dispersion functional.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>numeric; additional parameter for <code>kMAD</code>; must be positive
and of length 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KK</code></td>
<td>
<p>numeric; Maximal number of trials with different <code>k</code> in
<code>medkMADhybr</code> . </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.lo</code></td>
<td>
<p>numeric; lower bound for search intervall in shape parameter. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.up</code></td>
<td>
<p>numeric; upper bound for search intervall in shape parameter.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.q</code></td>
<td>
<p>logical; shall the zero search be done on log-scale? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p> optional name for estimator. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Infos</code></td>
<td>
<p> character: optional informations about estimator </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asvar</code></td>
<td>
<p> optionally the asymptotic (co)variance of the estimator </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuis.idx</code></td>
<td>
<p> optionally the indices of the estimate belonging
to nuisance parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p> optionally (numeric) the fixed part of the parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trafo</code></td>
<td>
<p> an object of class <code>MatrixorFunction</code> – a transformation
for the main parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asvar.fct</code></td>
<td>
<p>optionally: a function to determine the corresponding
asymptotic variance; if given, <code>asvar.fct</code> takes arguments
<code>L2Fam</code>((the parametric model as object of class <code>L2ParamFamily</code>)) 
and <code>param</code> (the parameter value as object of class 
<code>ParamFamParameter</code>); arguments are called by name; <code>asvar.fct</code>
may also process further arguments passed through the <code>...</code> argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical: if  <code>TRUE</code>, the estimator is evaluated at <code>complete.cases(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accuracy</code></td>
<td>
<p>numeric: argument to be passed on to <code>Sn</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to location estimator and functional
and dispersion estimator and functional. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vdbg</code></td>
<td>
<p>logical; if <code>TRUE</code>, debugging information is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.withEvalAsVar</code></td>
<td>
<p>logical: shall slot <code>asVar</code> be evaluated
(if <code>asvar.fct</code> is given) or
just the call be returned?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The arguments <code>loc.est</code>, <code>disp.est</code> (location and dispersion estimators)
have to be functions with first argument <code>x</code> (a numeric vector with the
empirical data) and additional, optional individual arguments to be passed on
in the respective calls as lists <code>loc.est.ctrl</code>, <code>disp.est.ctrl</code>,
and global additional arguments through the <code>...</code> argument.
Similarly, arguments <code>loc.fctal</code>, <code>disp.fctal</code> (location and
dispersion functionals) have to be functions with first argument an
object of class <code>UnivariateDistribution</code>, and additional, optional
individual arguments to be passed on
in the respective calls as lists <code>loc.fctal.ctrl</code>, <code>disp.fctal.ctrl</code>,
and global additional arguments again through the <code>...</code> argument.
Uses <code>.LDMatch</code> internally.
</p>


<h3>Value</h3>

<p>An object of S4-class <code>"Estimate"</code>.
</p>


<h3>Note</h3>

<p>The values for <code>q.lo</code> and <code>q.up</code> are a bit delicate and
have to be found, model by model, by try and error.
As a rule, <code>medSn</code> is rather slow, as the evaluation of the <code>Sn</code>
functional is quite expensive. So if <code>medSn</code> is the estimator of choice,
it pays off, for a given shape-scale family, to evaluate <code>medSn</code> on a
grid of shape-values (with scale 1) and then to use an interpolation techniques
in a particular method to replace the default one for this shape-scale family.
As an example, we have done so for the GPD family.</p>


<h3>Author(s)</h3>

<p>Nataliya Horbenko <a href="mailto:nhorbenko@gmail.com">nhorbenko@gmail.com</a>,<br>
Peter Ruckdeschel <a href="mailto:peter.ruckdeschel@uni-oldenburg.de">peter.ruckdeschel@uni-oldenburg.de</a></p>


<h3>References</h3>

<p>Marazzi, A. and Ruffieux, C. (1999): The truncated mean of asymmetric distribution.
<em>Computational Statistics and Data Analysis</em> <b>32</b>, 79-100.
</p>
<p>Ruckdeschel, P. and Horbenko, N. (2013): Optimally-Robust Estimators in Generalized
Pareto Models. <em>Statistics</em>. <b>47</b>(4), 762-791.
<a href="https://doi.org/10.1080/02331888.2011.628022">doi:10.1080/02331888.2011.628022</a>.<br></p>
<p>Ruckdeschel, P. and Horbenko, N. (2012): Yet another breakdown point notion:
EFSBP –illustrated at scale-shape models. <em>Metrika</em>, <b>75</b>(8),
1025-1047. <a href="https://doi.org/10.1007/s00184-011-0366-4">doi:10.1007/s00184-011-0366-4</a>.<br></p>


<h3>See Also</h3>

<p><code>ParamFamily-class</code>, <code>ParamFamily</code>, 
<code>Estimate-class</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## (empirical) Data
set.seed(123)
x &lt;- rgamma(50, scale = 0.5, shape = 3)

## parametric family of probability measures
G &lt;- GammaFamily(scale = 1, shape = 2)

medQn(x = x, ParamFamily = G)
medSn(x = x, ParamFamily = G, q.lo = 0.5, q.up = 4)


## not tested on CRAN because it takes time...
## without speedup for Sn:
LDEstimator(x, loc.est = median, disp.est = Sn, loc.fctal = median,
            disp.fctal = getMethod("Sn","UnivariateDistribution"),
            ParamFamily = G, disp.est.ctrl = list(constant=1))

medkMAD(x = x, ParamFamily = G)
medkMADhybr(x = x, ParamFamily = G)

medkMAD(x = x, k=10, ParamFamily = G)

##not at all robust:
LDEstimator(x, loc.est = mean, disp.est = sd,
               loc.fctal = E, disp.fctal = sd,
            ParamFamily = G)
</code></pre>


</div>