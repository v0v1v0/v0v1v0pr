<div class="container">

<table style="width: 100%;"><tr>
<td>FileMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class representing a persistent matrix stored in a file</h2>

<h3>Description</h3>

<p>Package:  R.huge <br><b>Class FileMatrix</b><br></p>
<p><code>Object</code><br><code>~~|</code><br><code>~~+--</code><code>AbstractFileArray</code><br><code>~~~~~~~|</code><br><code>~~~~~~~+--</code><code>FileMatrix</code><br></p>
<p><b>Directly known subclasses:</b><br>
FileByteMatrix, FileDoubleMatrix, FileFloatMatrix, FileIntegerMatrix, FileShortMatrix<br></p>
<p>public static class <b>FileMatrix</b><br>
extends AbstractFileArray<br></p>


<h3>Usage</h3>

<pre><code class="language-R">FileMatrix(..., nrow=NULL, ncol=NULL, rownames=NULL, colnames=NULL, byrow=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>AbstractFileArray</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow, ncol</code></td>
<td>
<p>The number of rows and columns of the matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rownames, colnames</code></td>
<td>
<p>Optional row and column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byrow</code></td>
<td>
<p>If <code>TRUE</code>, data are stored row by row, otherwise column
by column.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The purpose of this class is to be able to work with large matrices
in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> without being limited by the amount of memory available.
Matrices are kept on the file system and elements are read and written
whenever queried.  The purpose of the class is <em>not</em> to provide
methods for full matrix operations, but instead to be able to work
with subsets of the matrix at each time.
</p>
<p>For more details, <code>AbstractFileArray</code>.
</p>


<h3>Fields and Methods</h3>

<p><b>Methods:</b><br></p>

<table>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>[</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>[&lt;-</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>as.character</code> </td>
<td style="text-align: left;"> Returns a short string describing the file matrix.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>as.matrix</code> </td>
<td style="text-align: left;"> Returns the elements of a file matrix as an R matrix.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>colnames</code> </td>
<td style="text-align: left;"> Gets the column names of a file matrix.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getByRow</code> </td>
<td style="text-align: left;"> Checks if elements are stored row by row or not.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getColumnOffset</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getMatrixIndicies</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getOffset</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>getRowOffset</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>ncol</code> </td>
<td style="text-align: left;"> Gets the number of columns of the matrix.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>nrow</code> </td>
<td style="text-align: left;"> Gets the number of rows of the matrix.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>readFullMatrix</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>readValues</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>rowMeans</code> </td>
<td style="text-align: left;"> Calculates the means for each row.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>rowSums</code> </td>
<td style="text-align: left;"> Calculates the sum for each row.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>rownames</code> </td>
<td style="text-align: left;"> Gets the row names of a file matrix.</td>
</tr>
<tr>
<td style="text-align: right;">
 </td>
<td style="text-align: left;"> <code>writeValues</code> </td>
<td style="text-align: left;">  -</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p><b>Methods inherited from AbstractFileArray</b>:<br>
as.character, as.vector, clone, close, delete, dim, dimnames, finalize, flush, getBasename, getBytesPerCell, getCloneNumber, getComments, getDataOffset, getDimensionOrder, getExtension, getFileSize, getName, getPath, getPathname, getSizeOfComments, getSizeOfData, getStorageMode, isOpen, length, open, readAllValues, readContiguousValues, readHeader, readValues, setComments, writeAllValues, writeEmptyData, writeHeader, writeHeaderComments, writeValues
</p>
<p><b>Methods inherited from Object</b>:<br>
$, $&lt;-, [[, [[&lt;-, as.character, attach, attachLocally, clearCache, clearLookupCache, clone, detach, equals, extend, finalize, getEnvironment, getFieldModifier, getFieldModifiers, getFields, getInstantiationTime, getStaticInstance, hasField, hashCode, ll, load, names, objectSize, print, save
</p>


<h3>Column by column or row by row?</h3>

<p>If the matrix elements are to be accessed more often along rows,
store data row by row, otherwise column by column.
</p>


<h3>Supported data types</h3>

<p>The following subclasses implement support for various data types:
</p>

<ul>
<li> <p><code>FileByteMatrix</code> (1 byte per element),
</p>
</li>
<li> <p><code>FileShortMatrix</code> (2 bytes per element),
</p>
</li>
<li> <p><code>FileIntegerMatrix</code> (4 bytes per element),
</p>
</li>
<li> <p><code>FileFloatMatrix</code> (4 bytes per element), and
</p>
</li>
<li> <p><code>FileDoubleMatrix</code> (8 bytes per element).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Henrik Bengtsson</p>


<h3>Examples</h3>

<pre><code class="language-R">library("R.utils")
verbose &lt;- Arguments$getVerbose(TRUE)

pathname &lt;- "example.Rmatrix"
if (isFile(pathname)) {
  file.remove(pathname)
  if (isFile(pathname)) {
    stop("File not deleted: ", pathname)
  }
}

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Create a new file matrix
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
verbose &amp;&amp; enter(verbose, "Creating new matrix")
# The dimensions of the matrix
nrow &lt;- 20
ncol &lt;- 5
X &lt;- FileByteMatrix(pathname, nrow=nrow, ncol=ncol, byrow=TRUE)
verbose &amp;&amp; exit(verbose)

verbose &amp;&amp; enter(verbose, "Filling it with data")
rows &lt;- c(1:4,7:10)
cols &lt;- c(1)
x &lt;- 1:length(rows)
writeValues(X, rows=rows, cols=cols, values=x)
verbose &amp;&amp; exit(verbose)

verbose &amp;&amp; enter(verbose, "Getting data again")
y &lt;- readValues(X, rows=rows, cols=cols)
verbose &amp;&amp; exit(verbose)
stopifnot(all.equal(x,y))

verbose &amp;&amp; enter(verbose, "Setting data using [i,j]")
i &lt;- c(20:18, 13:15)
j &lt;- c(3:2, 4:5)
n &lt;- length(i) * length(j)
values &lt;- 1:n
X[i,j] &lt;- values
verbose &amp;&amp; enter(verbose, "Validating")
print(X)
print(X[])
print(X[i,j])
stopifnot(all.equal(as.vector(X[i,j]), values))
verbose &amp;&amp; exit(verbose)
verbose &amp;&amp; exit(verbose)


# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Open an already existing file matrix
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
verbose &amp;&amp; enter(verbose, "Getting existing matrix")
Y &lt;- FileByteMatrix(pathname)
verbose &amp;&amp; exit(verbose)

print(Y[])
Y[5,1] &lt;- 55
print(Y[])
print(X[])  # Note, X and Y refers to the same instance


# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Clone a matrix
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Z &lt;- clone(X)
Z[5,1] &lt;- 66
print(Z[])
print(Y[])

# Remove clone again
delete(Z)

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Close all matrices
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
close(X)
close(Y)

# Remove original matrix too
delete(X)
</code></pre>


</div>