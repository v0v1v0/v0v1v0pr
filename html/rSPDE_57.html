<div class="container">

<table style="width: 100%;"><tr>
<td>rspde.matern.precision.integer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Precision matrix of stationary Gaussian Matern
random fields with integer covariance exponent</h2>

<h3>Description</h3>

<p><code>rspde.matern.precision.integer.opt</code> is
used for computing the precision matrix of stationary
Gaussian random fields on <code class="reqn">R^d</code> with a Matern
covariance function
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\sigma^2}{2^(\nu-1)\Gamma(\nu)}
(\kappa h)^\nu K_\nu(\kappa h)</code>
</p>
<p>,
where <code class="reqn">\alpha = \nu + d/2</code> is a natural number.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rspde.matern.precision.integer(
  kappa,
  nu,
  tau = NULL,
  sigma = NULL,
  dim,
  fem_mesh_matrices
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Range parameter of the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Shape parameter of the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Scale parameter of the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Standard deviation of the covariance function.
If tau is not provided, sigma should be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>The dimension of the domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fem_mesh_matrices</code></td>
<td>
<p>A list containing the FEM-related
matrices. The list should contain elements c0, g1, g2, g3, etc.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The precision matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
nobs &lt;- 101
x &lt;- seq(from = 0, to = 1, length.out = nobs)
fem &lt;- rSPDE.fem1d(x)
kappa &lt;- 40
sigma &lt;- 1
d &lt;- 1
nu &lt;- 0.5
tau &lt;- sqrt(gamma(nu) / (kappa^(2 * nu) *
(4 * pi)^(d / 2) * gamma(nu + d / 2)))
range &lt;- sqrt(8*nu)/kappa
op_cov &lt;- matern.operators(
  loc_mesh = x, nu = nu, range = range, sigma = sigma,
  d = 1, m = 2, parameterization = "matern"
)
v &lt;- t(rSPDE.A1d(x, 0.5))
c.true &lt;- matern.covariance(abs(x - 0.5), kappa, nu, sigma)
Q &lt;- rspde.matern.precision.integer(
  kappa = kappa, nu = nu, tau = tau, d = 1,
  fem_mesh_matrices = op_cov$fem_mesh_matrices
)
A &lt;- Diagonal(nobs)
c.approx_cov &lt;- A %*% solve(Q, v)

# plot the result and compare with the true Matern covariance
plot(x, matern.covariance(abs(x - 0.5), kappa, nu, sigma),
  type = "l", ylab = "C(h)",
  xlab = "h", main = "Matern covariance and rational approximations"
)
lines(x, c.approx_cov, col = 2)
</code></pre>


</div>