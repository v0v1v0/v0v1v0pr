<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_virtual_factor_and_lambda_group</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helpfunction used in update_g()</h2>

<h3>Description</h3>

<p>This function calculates FgLg (the groupfactorstructure) for all possible groups where individual i can be placed. For each group were
the groupfactors (Fg) estimated earlier. Now the grouploadings are needed for each group as well. In the classical case these are calculated by Fg*Y/T. In the robust case
these are robust.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_virtual_factor_and_lambda_group(
  group,
  solve_FG_FG_times_FG,
  robust,
  NN_local,
  method_estimate_factors_local,
  g,
  vars_est,
  number_of_group_factors_local,
  number_of_common_factors_local,
  method_estimate_beta,
  factor_group,
  lambda,
  comfactor,
  Y,
  X,
  beta_est,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>number of groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solve_FG_FG_times_FG</code></td>
<td>
<p>This is the same as groupfactor / T. It is only used in the Classical approach</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>robust or classical estimation of group membership</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NN_local</code></td>
<td>
<p>number of time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_estimate_factors_local</code></td>
<td>
<p>specifies the robust algorithm to estimate factors: default is "macro"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>vector with estimated group membership for all individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars_est</code></td>
<td>
<p>number of variables that are included in the algorithm and have their coefficient estimated. This is usually equal to vars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_of_group_factors_local</code></td>
<td>
<p>number of group factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_of_common_factors_local</code></td>
<td>
<p>number of common factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_estimate_beta</code></td>
<td>
<p>defines how beta is estimated. Default case is an estimated beta for each individual. Default value is "individual." Possible values are "homogeneous", "group" or "individual".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_group</code></td>
<td>
<p>estimated group specific factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>loadings of the estimated common factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comfactor</code></td>
<td>
<p>estimated common factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Y: NxT dataframe with the panel data of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>X: NxTxp array containing the observable variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_est</code></td>
<td>
<p>estimated values of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>when TRUE, it prints messages</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>NxT matrix containing the product of virtual groupfactors and virtual loadings
</p>


</div>