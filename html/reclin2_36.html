<div class="container">

<table style="width: 100%;"><tr>
<td>problink_em</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate EM-estimates of m- and u-probabilities</h2>

<h3>Description</h3>

<p>Calculate EM-estimates of m- and u-probabilities
</p>


<h3>Usage</h3>

<pre><code class="language-R">problink_em(
  formula,
  data,
  patterns,
  mprobs0 = list(0.95),
  uprobs0 = list(0.02),
  p0 = 0.05,
  tol = 1e-05,
  mprob_max = 0.999,
  uprob_min = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object with the variables for which to calculate the
m-  and u-probabilities. Should be of the form <code>~ var1 + var2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data set with pairs on which to estimate the model. Alternatively
one can use the <code>patterns</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patterns</code></td>
<td>
<p>table of patterns (as output by 
<code>tabulate_patterns</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mprobs0, uprobs0</code></td>
<td>
<p>initial values of the m- and u-probabilities. These
should be lists with numeric values. The names of the elements in the list
should correspond to the names in <code>by_x</code> in <code>compare_pairs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>the initial estimate of the probability that a pair is a match.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>when the change in the m and u-probabilities is smaller than <code>tol</code>
the algorithm is stopped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mprob_max</code></td>
<td>
<p>maximum values of the estimated m-probabilities. Values equal to
one can lead to numerical instabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uprob_min</code></td>
<td>
<p>maximum values of the estimated m-probabilities. Values equal to
zero can lead to numerical instabilities.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of type <code>problink_em</code>. This is a list containing the
estimated <code>mprobs</code>, <code>uprobs</code> and overall linkage probability 
<code>p</code>. It also contains the table of comparison <code>patterns</code>.
</p>


<h3>References</h3>

<p>Fellegi, I. and A. Sunter (1969). "A Theory for Record Linkage", 
<em>Journal of the American Statistical Association</em>. 64 (328): 
pp. 1183-1210. <a href="https://doi.org/10.2307/2286061">doi:10.2307/2286061</a>.
</p>
<p>Herzog, T.N., F.J. Scheuren and W.E. Winkler (2007). 
<em>Data Quality and Record Linkage Techniques</em>, Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("linkexample1", "linkexample2")
pairs &lt;- pair_blocking(linkexample1, linkexample2, "postcode")
pairs &lt;- compare_pairs(pairs, c("lastname", "firstname", "address", "sex"))
model &lt;- problink_em(~ lastname + firstname + address + sex, data = pairs)
summary(model)

</code></pre>


</div>