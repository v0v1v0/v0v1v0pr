<div class="container">

<table style="width: 100%;"><tr>
<td>tol_mrca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MRCA of taxa from the synthetic tree</h2>

<h3>Description</h3>

<p>Most Recent Common Ancestor for a set of nodes
</p>


<h3>Usage</h3>

<pre><code class="language-R">tol_mrca(ott_ids = NULL, node_ids = NULL, ...)

## S3 method for class 'tol_mrca'
tax_sources(tax, ...)

## S3 method for class 'tol_mrca'
unique_name(tax, ...)

## S3 method for class 'tol_mrca'
tax_name(tax, ...)

## S3 method for class 'tol_mrca'
tax_rank(tax, ...)

## S3 method for class 'tol_mrca'
ott_id(tax, ...)

## S3 method for class 'tol_mrca'
source_list(tax, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ott_ids</code></td>
<td>
<p>Numeric vector. The ott ids for which the MRCA is desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node_ids</code></td>
<td>
<p>Character vector. The node ids for which the MRCA is desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to customize the API call (see
<code>rotl</code> for more information).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax</code></td>
<td>
<p>an object returned by <code>tol_mrca()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Get the MRCA of a set of nodes on the current synthetic
tree. Accepts any combination of node ids and ott ids as
input. Returns information about the most recent common
ancestor (MRCA) node as well as the most recent taxonomic
ancestor (MRTA) node (the closest taxonomic node to the MRCA
node in the synthetic tree; the MRCA and MRTA may be the same
node). If they are the same, the taxonomic information will be
in the <code>mrca</code> slot, otherwise they will be in the
<code>nearest_taxon</code> slot of the list. If any of the specified
nodes is not in the synthetic tree an error will be returned.
</p>
<p>Taxonomic methods (<code>tax_sources()</code>, <code>ott_id()</code>,
<code>unique_name()</code>, ...) are available on the objects
returned by <code>tol_mrca()</code>. If the MRCA node is MRTA, the
name of the object returned by these methods will start with
‘ott’, otherwise it will start with ‘mrca’.
</p>


<h3>Value</h3>

<p>An invisible list of the MRCA node properties:
</p>

<ul>
<li> <p>mrca List of node properties.
</p>

<ul>
<li> <p>node_id String. The canonical identifier of the node.
</p>
</li>
<li> <p>num_tips Numeric. The number of descendant tips.
</p>
</li>
<li> <p>taxon A list of taxonomic properties. Only returned if
the queried node is a taxon. (If the node is not a taxon, a
<code>nearest_taxon</code> list is returned (see below)).
</p>

<ul>
<li> <p>ott_id Numeric. The OpenTree Taxonomy ID (ottID).
</p>
</li>
<li> <p>name String. The taxonomic name of the queried node.
</p>
</li>
<li> <p>unique_name String. The string that uniquely
identifies the taxon in OTT.
</p>
</li>
<li> <p>rank String. The taxonomic rank of the taxon in OTT.
</p>
</li>
<li> <p>tax_sources List. A list of identifiers for taxonomic
sources, such as other taxonomies, that define taxa judged
equivalent to this taxon.
</p>
</li>
</ul>
<p>The following properties list support/conflict for the node across
synthesis source trees. All properties involve sourceid keys and
nodeid values (see <code>source_id_map</code> below) Not all properties are
are present for every node.
</p>
</li>
<li> <p>partial_path_of List. The edge below this synthetic tree node
is compatible with the edge below each of these input tree nodes (one
per tree). Each returned element is reported as sourceid:nodeid.
</p>
</li>
<li> <p>supported_by List. Input tree nodes (one per tree) that support
this synthetic tree node. Each returned element is reported as
sourceid:nodeid.
</p>
</li>
<li> <p>terminal List. Input tree nodes (one per tree) that are equivalent
to this synthetic tree node (via an exact mapping, or the input tree
terminal may be the only terminal descended from this synthetic tree node.
Each returned element is reported as sourceid:nodeid.
</p>
</li>
<li> <p>conflicts_with Named list of lists. Names correspond to
sourceid keys. Each list contains input tree node ids (one or more per tree)
that conflict with this synthetic node.
</p>
</li>
</ul>
</li>
<li> <p>nearest_taxon A list of taxonomic properties of the nearest rootward
taxon node to the MRCA node. Only returned if the MRCA node is a not taxon
(otherwise the <code>taxon</code> list above is returned).
</p>

<ul>
<li> <p>ott_id Numeric. The OpenTree Taxonomy ID (ottID).
</p>
</li>
<li> <p>name String. The taxonomic name of the queried node.
</p>
</li>
<li> <p>unique_name String. The string that uniquely
identifies the taxon in OTT.
</p>
</li>
<li> <p>rank String. The taxonomic rank of the taxon in OTT.
</p>
</li>
<li> <p>tax_sources List. A list of identifiers for taxonomic
sources, such as other taxonomies, that define taxa judged
equivalent to this taxon.
</p>
</li>
</ul>
</li>
<li> <p>source_id_map Named list of lists. Names correspond to the
sourceid keys used in the support/conflict properties of the <code>mrca</code>
list above. Source trees will have the following properties:
</p>

<ul>
<li> <p>git_sha The git SHA identifying a particular source
version.
</p>
</li>
<li> <p>tree_id The tree id associated with the study id used.
</p>
</li>
<li> <p>study_id The study identifier. Will typically include
a prefix ("pg_" or "ot_").
</p>
</li>
</ul>
<p>The only sourceid that does not correspond to a source tree is the taxonomy,
which will have the name "ott"+'taxonomy_version', and the value is the
ott_id of the taxon in that taxonomy version. "Taxonomy" will only ever
appear in <code>supported_by</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
birds_mrca &lt;- tol_mrca(ott_ids=c(412129, 119214))
ott_id(birds_mrca)
tax_sources(birds_mrca)

## End(Not run)
</code></pre>


</div>