<div class="container">

<table style="width: 100%;"><tr>
<td>robslope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust slope estimator
</h2>

<h3>Description</h3>

<p>Computes the Theil-Sen median slope, Siegel's repeated median slope or te equivariant Passing-Bablok slope. The algorithms run in an expected linearithmic time while requiring <code class="reqn">O(n)</code> storage. They are based on Dillencourt et. al (1992), Matousek et. al (1998) and Raymaekers and Dufey (2022).
</p>


<h3>Usage</h3>

<pre><code class="language-R">robslope(formula, data, subset, weights, na.action,
         type = c("TheilSen", "RepeatedMedian","PassingBablok"),
        alpha = NULL, beta = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>"formula"</code> (or one that
can be coerced to that class): a symbolic description of the
model to be fitted.  The details of model specification are given
under ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame) containing
the variables in the model.  If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>robslope</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Currently not supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s. The default <code>na.exclude</code> is applied and an informative message is given in case NAs were removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of robust slope estimator. Should be one of <code>"TheilSen"</code> (default), <code>"RepeatedMedian"</code> or <code>"PassingBablok"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Determines the order statistic of the target slope. Defaults to the upper median. See below for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Determines the inner order statistic. Only used when <code>type = "RepeatedMedian"</code>. See below for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Whether or not to print out the progress of the algorithm. Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides a wrapper around <code>robslope.fit</code>, which in turn calls the individual functions <code>TheilSen</code>, <code>RepeatedMedian</code> or <code>PassingBablok</code>. The details on changing the parameters <code>alpha</code> and <code>beta</code> can be found in the documentation of those respective functions.
</p>


<h3>Value</h3>

<p><code>robslope</code> returns an object of <code>class</code> <code>"lm"</code>.
</p>
<p>The generic accessor functions <code>coefficients</code>,
<code>fitted.values</code> and <code>residuals</code> extract
various useful features of the value returned by <code>lm</code>.
</p>


<h3>Author(s)</h3>

<p>Jakob Raymaekers
</p>


<h3>References</h3>

<p>Theil, H. (1950), A rank-invariant method of linear and polynomial regression
analysis (Parts 1-3),  <em>Ned. Akad. Wetensch. Proc. Ser. A</em>, <b>53</b>, 386-392,
521-525, 1397-1412.
</p>
<p>Sen, P. K. (1968). Estimates of the regression coefficient based on Kendall's tau.  <em>Journal of the American statistical association</em>, <b>63</b>(324), 1379-1389.
</p>
<p>Dillencourt, M. B., Mount, D. M., &amp; Netanyahu, N. S. (1992). A randomized algorithm for slope selection. <em>International Journal of Computational Geometry &amp; Applications</em>, <b>2</b>(01), 1-27.
</p>
<p>Siegel, A. F. (1982). Robust regression using repeated medians. <em>Biometrika</em>, <b>69</b>(1), 242-244.  
</p>
<p>Matousek, J., Mount, D. M., &amp; Netanyahu, N. S. (1998). Efficient randomized algorithms for the repeated median line estimator. <em>Algorithmica</em>, <b>20</b>(2), 136-150.
</p>
<p>Passing, H., Bablok, W. (1983). A new biometrical procedure for testing the equality of measurements from two different analytical methods. Application of linear regression procedures for method comparison studies in clinical chemistry, Part I,  <em>Journal of clinical chemistry and clinical biochemistry</em>, <b>21</b>,709-720.
</p>
<p>Bablok, W., Passing, H., Bender, R., Schneider, B. (1988). A general regression procedure for method transformation. Application of linear
regression procedures for method comparison studies in clinical chemistry, Part III.  <em>Journal of clinical chemistry and clinical biochemistry</em>, <b>26</b>,783-790.
</p>
<p>Raymaekers J., Dufey F. (2022). Equivariant Passing-Bablok regression in quasilinear time. <a href="https://arxiv.org/abs/2202.08060">(link to open access pdf)</a>
</p>
<p>Raymaekers (2023). "The R Journal: robslopes: Efficient Computation of the (Repeated) Median Slope", The R Journal. <a href="https://journal.r-project.org/articles/RJ-2023-012/">(link to open access pdf)</a>
</p>


<h3>See Also</h3>

<p><code>robslope.fit</code>
<code>TheilSen</code>
<code>RepeatedMedian</code>
<code>PassingBablok</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
df &lt;- data.frame(cbind(rnorm(20), rnorm(20)))
colnames(df) &lt;- c("x", "y")

robslope.out &lt;- robslope(y~x, data = df,
type = "RepeatedMedian", verbose = TRUE)

coef(robslope.out)
plot(fitted.values(robslope.out))

robslope.out &lt;- robslope(y~x, data = df,
type = "TheilSen", verbose = TRUE)

plot(residuals(robslope.out))
</code></pre>


</div>