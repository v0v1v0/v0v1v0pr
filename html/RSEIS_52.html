<div class="container">

<table style="width: 100%;"><tr>
<td>doGABOR.MTM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evolutive MTM Spectrum
</h2>

<h3>Description</h3>

<p> Time varying Auto-Regressive Spectrum (Gabor Transform)
using MTM.  This is a driver for MTMgabor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">doGABOR.MTM(Xamp, DT = 0.008, ppoint=95 , multi = 1,
 scale.def = 0, TWIN = 2, TSKIP = 0.2, PCTTAP = 0.05,  PLOT=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xamp</code></td>
<td>
<p>signal
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DT</code></td>
<td>
<p>sample rate interval (s)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppoint</code></td>
<td>
<p>percent confidence for F-test (default=95) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi</code></td>
<td>
<p>Multiples of time window estimate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.def</code></td>
<td>
<p>scaling flag for plotting (0=raw, 1=log, 2=sqrt)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TWIN</code></td>
<td>
<p>time for window
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TSKIP</code></td>
<td>
<p>time for skip
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCTTAP</code></td>
<td>
<p>percent of taper to apply to individual windows
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PLOT</code></td>
<td>
<p> logical, TRUE=plot to device </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a spectrogram function similar to the Gabor Transform
but uses the MTM (multi-taper method) for spectrum estimation.
This is a non-interactive version of MTM.drive.
</p>


<h3>Value</h3>

<p>list output of MTMgabor:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>input signal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>deltat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numfreqs</code></td>
<td>
<p>Number of frequencies output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wpars</code></td>
<td>
<p>input parameters list(Nfft=numfreqs,
Ns=Ns, Nov=Nov, fl=fl, fh=fh)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DSPEC</code></td>
<td>
<p>spectrum image</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HIMAT</code></td>
<td>
<p>matrix with high values of F-test at 90 percent confidence
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DOFMAT</code></td>
<td>
<p>Matrix image of degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FVMAT</code></td>
<td>
<p>Matrix image of F-test values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kdof</code></td>
<td>
<p>test degrees of freedom=2*nwin-2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppoint</code></td>
<td>
<p>percentage point for confidence bounds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>output frequencies (y axis)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tims</code></td>
<td>
<p>output times (x-axis) </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The main difference between this and other similar calls is the
way the windows are determined.
</p>


<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;
</p>


<h3>References</h3>

<p>Lees, J. M. and Park, J., 1995: Multiple-taper spectral analysis: A
stand-alone C-subroutine, <em>Computers and Geology</em>, 21(2), 199-236.
</p>
<p>Percival, Donald B.,Walden, Andrew T. (1993):Spectral Analysis for
Physical Applications,Cambridge University Press, Cambridge,  583p.
</p>


<h3>See Also</h3>

<p>MTMgabor, evolfft, evolMTM, MTM.drive, GETARAIC, doGABOR.AR, DOsgram</p>


<h3>Examples</h3>

<pre><code class="language-R">


data(KH)
###   swig(KH)

Xamp = KH$JSTR[[1]]
Xamp = Xamp[57914:64914]

EV = doGABOR.MTM(Xamp, DT = KH$dt[1], multi = 1, scale.def = 0,
TWIN = 1, TSKIP = .1, PCTTAP = 0.05)

</code></pre>


</div>