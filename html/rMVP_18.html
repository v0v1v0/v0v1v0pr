<div class="container">

<table style="width: 100%;"><tr>
<td>MVP.EMMA.Vg.Ve</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate variance components using EMMA</h2>

<h3>Description</h3>

<p>Build date: August 30, 2016
Last update: January 27, 2017
</p>


<h3>Usage</h3>

<pre><code class="language-R">MVP.EMMA.Vg.Ve(y, X, K, ngrids = 100, llim = -10, ulim = 10, esp = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>phenotype, n * 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>covariate matrix, the first column is 1s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Kinship matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrids</code></td>
<td>
<p>parameters for estimating vg and ve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llim</code></td>
<td>
<p>parameters for estimating vg and ve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ulim</code></td>
<td>
<p>parameters for estimating vg and ve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>esp</code></td>
<td>
<p>parameters for estimating vg and ve</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Output: REML - maximum log likelihood
Output: delta - exp(root)
Output: ve - residual variance
Output: vg - genetic variance
</p>


<h3>Author(s)</h3>

<p>EMMA (Kang et. al. Genetics, 2008), Modified only for speed up by Xiaolei Liu and Lilin Yin
</p>


<h3>Examples</h3>

<pre><code class="language-R">
phePath &lt;- system.file("extdata", "07_other", "mvp.phe", package = "rMVP")
phenotype &lt;- read.table(phePath, header=TRUE)
print(dim(phenotype))
genoPath &lt;- system.file("extdata", "06_mvp-impute", "mvp.imp.geno.desc", package = "rMVP")
genotype &lt;- attach.big.matrix(genoPath)
print(dim(genotype))

K &lt;- MVP.K.VanRaden(genotype, cpu=1)
vc &lt;- MVP.EMMA.Vg.Ve(y=phenotype[,2], X=matrix(1, nrow(phenotype)), K=K)
print(vc)


</code></pre>


</div>