<div class="container">

<table style="width: 100%;"><tr>
<td>stkde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Map the spatio-temporal intensity of a set of radiocarbon dates</h2>

<h3>Description</h3>

<p>Function for mapping the spatio-temporal intensity of radiocarbon dates for a given geographical region in one or more tim.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stkde(
  x,
  coords,
  sbw,
  focalyears,
  tbw,
  win,
  cellres,
  outdir = ".",
  bins = NA,
  backsight = NA,
  maskthresh = 0,
  changexpr = expression((t1 - t0)/tk),
  spjitter = TRUE,
  amount = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class CalDates with calibrated radiocarbon ages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>A two column matrix of geographical coordinates from a a projected coordinate system (no checks are made for this) and with the same number of rows as length(x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sbw</code></td>
<td>
<p>A single numeric value for the spatial bandwidth to be applied around each raster cell, expressed as the standard deviation of a continuous Gaussian kernel (passed as the sigma argument to density.ppp()).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focalyears</code></td>
<td>
<p>A vector of numeric values for focal years, in calBP, that will be timesteps at which date intensity maps will be produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tbw</code></td>
<td>
<p>A single numeric value for the temporal bandwidth to be applied around each focal year, expressed as the standard deviation of a continuous Gaussian kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>The bounding polygon for the mapping (must be an object of class 'owin', see the spatstat package)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellres</code></td>
<td>
<p>The cell or pixel resolution of the output raster maps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outdir</code></td>
<td>
<p>The output directory for timeslice maps and data that are saved to file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>A vector of labels corresponding to site names, ids, bins or phases (same length as x)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backsight</code></td>
<td>
<p>A single numeric value (which will be coerced to be positive) that specifies a comparison timestep in the past for a mapping of temporal change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maskthresh</code></td>
<td>
<p>A single numeric value for a lower-bound cut-off for all maps, based on a minimum required spatial intensity of all dates in x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changexpr</code></td>
<td>
<p>An expression for calculating the change in spatial intensity between the focal year and a backsight year (as defined via the backsight argument). Available input options are t1 (the spatial intensity for the focal year), t0 (the spatial intensity for the backsight year) and tk (the overall spatial intensity for all dates irrespective of year), plus any other standard constants and mathematical operators. A sensible default is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spjitter</code></td>
<td>
<p>Whether noise is applied to the spatial coordinates or not. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amount</code></td>
<td>
<p>Amount of jitter applied to the spatial coordinates when <code>spjitter=TRUE</code>. Default is d/5, where d is difference between the closest coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical variable indicating whether extra information on progress should be reported. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored or passed to internal functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes one or more timeslice maps of the spatio-temporal kernel intensity of radiocarbon dates across a geographic region and for a specific focal year. The user specifies the arbitrary sizes of both the spatial and the temporal Gaussian kernels that will be used to summarise radiocarbon date intensity per grid cell per timestep. The results allow standardisation of colour ramps, etc. across timesteps and are amenable to plotting individually via plot.stKde and/or for output to png for animation.
</p>


<h3>Value</h3>

<p>A list object of class stKde with the following elements:
</p>

<ul>
<li> <p>A series of list items storing some of the input parameters such as the focalyears, sbw, tbw, backsight, maskthresh 
</p>
</li>
<li>
<p><code>nonfocal</code> An im object mapping the basic spatial intensity of all dates, without reference to a focal year. 
</p>
</li>
<li>
<p><code>impaths</code> A character vector of the paths to the individual timeslices stored on file. Maps are not stored in memory (see spkde() for further details of what is stored).
</p>
</li>
<li>
<p><code>stats</code> A list of data.frames offering summary statistics on each of the different types of output surface across all timeslices. Used primarily to allow consistent colour ramps across time-slices.
</p>
</li>
<li>
<p><code>ppp</code> The ppp object for all dates and the observation window.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Example with a subset of English and Welsh dates from the Euroevol dataset
data(ewdates)
data(ewowin)
x &lt;- calibrate(x=ewdates$C14Age, errors=ewdates$C14SD, normalised=FALSE)
## Create centennial timeslices (also with site binning)
bins1 &lt;- binPrep(sites=ewdates$SiteID, ages=ewdates$C14Age, h=50)
stkde1 &lt;- stkde(x=x, coords=ewdates[,c("Eastings", "Northings")], win=ewowin, 
sbw=40000, cellres=2000, focalyears=seq(6500, 5000, -100), tbw=50, bins=bins1, 
backsight=200, outdir="im",amount=1)
## Plot an example of all four basic outputs for 5900 calBP
dev.new(height=2.5, width=8)
par(mar=c(0.5, 0.5, 2.5, 2))
plot(stkde1, 5900, type="all")

## End(Not run)

</code></pre>


</div>