<div class="container">

<table style="width: 100%;"><tr>
<td>wcor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the W-correlation matrix</h2>

<h3>Description</h3>

<p>Function calculates the W-correlation matrix for the series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ssa'
wcor(x, groups, Fs, ..., cache = TRUE)
## S3 method for class 'ossa'
wcor(x, groups, Fs, ..., cache = TRUE)
## Default S3 method:
wcor(x, L = (N + 1) %/% 2, ..., weights = NULL)
## S3 method for class 'wcor.matrix'
plot(x,
     grid = c(),
     ...,
     col = grey(c(1, 0)),
     cuts = 20,
     zlim = range(abs(x), 0, 1),
     at)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the input object. This might be ssa object for <em>ssa</em>
method, or just a matrix with elementary series in columns for
<em>default</em> implementation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>window length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>additional weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>list of numeric vectors, indices of elementary components
used for reconstruction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fs</code></td>
<td>
<p>list of series (e.g. 'ssa.reconstruction' object) for W-cor computation.
If missing, reconstructed series from the input 'ssa' object <code>x</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>reconstruct</code> routine
for <code>wcor</code> or to <code>plot</code> for <code>plot.wcor.matrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache</code></td>
<td>
<p>logical, if 'TRUE' then intermediate results will be
cached in 'ssa' object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>numeric vector, indices of matrix blocks (groups)
which will be separated by grid line.
Lines will be drawn on the left of and under noted blocks.
Also this argument can be list of two numeric vectors
with names 'x' and 'y', for control vertical and horizontal
grid lines separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color vector for colorscale,
given by two or more colors,
the first color corresponds to the minimal value,
while the last one corresponds to the maximal value (will be interpolated by <code>colorRamp</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuts</code></td>
<td>
<p>integer, the number of levels the range of W-cor
values will be divided into.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>range of displayed W-cor values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>A numeric vector giving breakpoints along the range of the image.
if missing, will be evaluated automatically (see description of the <code>cuts</code> argument).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>W-correlation matrix is a standard way of checking for weak
separability between the elementary components. In particular, the
strongly correlated elementary components should be placed into the
same group. The function calculates such a matrix either directly from
'ssa' object or from the matrix of elementary series.
</p>
<p>For plotting additional (non-standard) graphical parameters which can be passed via ...:
</p>

<dl>
<dt>useRaster</dt>
<dd>
<p>logical, indicates whether raster plot should be used. 'FALSE' by default</p>
</dd>
</dl>
<p>For class ‘ossa’, checking of Frobenius orthogonality is performed.
If there are reconstructed matrices, which are not F-orthogonal (it is
a usual case for Oblique SSA), the warning about possible irrelevancy
will be shown, since then weighted correlations do not indicate weak
separability properly.  In such a case, the use of
<code>owcor</code> is preferred.
</p>


<h3>Value</h3>

<p>Object of type 'wcor.matrix'.
</p>


<h3>References</h3>

<p>Golyandina, N., Nekrutkin, V. and Zhigljavsky, A. (2001): <em>Analysis of
Time Series Structure: SSA and related techniques.</em> Chapman and
Hall/CRC. ISBN 1584881941
</p>


<h3>See Also</h3>

<p><code>reconstruct</code>
<code>owcor.</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Decompose co2 series with default parameters
s &lt;- ssa(co2)
# Calculate the w-correlation matrix between first 20 series
# for a guess for grouping
w &lt;- wcor(s, groups = 1:20)
plot(w, grid = c(2,4, 5,7))
# Calculate the w-correlation matrix for the chosen groups
# to check separability
w &lt;- wcor(s, groups = list(c(1,4), c(2,3), c(5,6)))


# Artificial image for 2D SSA
mx &lt;- outer(1:50, 1:50,
            function(i, j) sin(2*pi * i/17) * cos(2*pi * j/7) + exp(i/25 - j/20)) +
      rnorm(50^2, sd = 0.1)
# Decompose 'mx' with default parameters
s &lt;- ssa(mx, kind = "2d-ssa")
# Plot wcor for first 12 components
plot(wcor(s, groups = 1:12), grid = c(2, 6))

# Real example: Mars photo
data(Mars)
# Decompose only Mars image (without backgroud)
s &lt;- ssa(Mars, mask = Mars != 0, wmask = circle(50), kind = "2d-ssa")
# Plot wcor for the first 25 components
plot(wcor(s, groups = 1:25), grid = c(13, 15, 17,19))

</code></pre>


</div>