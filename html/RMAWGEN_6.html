<div class="container">

<table style="width: 100%;"><tr>
<td>ComprehensivePrecipitationGenerator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The comprehensive Precipitation Generator</h2>

<h3>Description</h3>

<p>The comprehensive Precipitation Generator
</p>


<h3>Usage</h3>

<pre><code class="language-R">ComprehensivePrecipitationGenerator(station = c("T0001", "T0010",
  "T0099"), prec_all, mean_climate_prec = NULL, year_max = 1990,
  year_min = 1961, leap = TRUE, nmonth = 12, cpf = NULL,
  verbose = TRUE, p = 1, type = "none", lag.max = NULL,
  ic = "AIC", activateVARselect = FALSE, exogen = NULL,
  exogen_sim = NULL, is_exogen_gaussian = FALSE,
  year_max_sim = year_max, year_min_sim = year_min,
  mean_climate_prec_sim = NULL, onlygeneration = FALSE,
  varmodel = NULL, type_quantile = 3, qnull = NULL, valmin = 0.5,
  step = 0, n_GPCA_iteration = 0,
  n_GPCA_iteration_residuals = n_GPCA_iteration, sample = NULL,
  extremes = TRUE, exogen_all = NULL, exogen_all_col = station,
  no_spline = FALSE, nscenario = 1, seed = NULL, noise = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>station</code></td>
<td>
<p>character vector of the IDs of the considered meteorological stations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec_all</code></td>
<td>
<p>data frame containing daily precipitation of all meteorological stations. See <code>PRECIPITATION</code> defined in the <code>trentino</code> dataset for formatting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_climate_prec</code></td>
<td>
<p>a matrix containing monthly mean daily precipitation for the considered station. If it is <code>NULL</code>, it is calculated. See input of <code>is.monthly.climate</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_max</code></td>
<td>
<p>start year of the recorded (calibration) period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_min</code></td>
<td>
<p>end year of the recorded (calibration) period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leap</code></td>
<td>
<p>logical variables. If it is <code>TRUE</code> (default)(recommended), leap years are considered, otherwise all years have 365 days</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmonth</code></td>
<td>
<p>number of months in one year (default is 12)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpf</code></td>
<td>
<p>see <code>normalizeGaussian_severalstations</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p, type, lag.max, ic, activateVARselect</code></td>
<td>
<p>see respective input parameter on <code>getVARmodel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen</code></td>
<td>
<p>data frame or matrix containing the (normalized or not) exogenous variables (predictors) for the recorded (calibration) period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen_sim</code></td>
<td>
<p>data frame or matrix containing the (normalized or not) exogenous variables (predictors) for the simulation period. Default is <code>NULL</code>. If it is <code>NULL</code>, it is replaced with <code>exogen</code> within the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is_exogen_gaussian</code></td>
<td>
<p>logical value. If <code>TRUE</code>, <code>exogen_sim</code> and <code>exogen</code> are given as already normalized variables, otherwhise they are not normalized. Default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_max_sim</code></td>
<td>
<p>last year of the simulation period. Default is equal to <code>year_max</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_min_sim</code></td>
<td>
<p>first year of the simulation period. Default is equal to <code>year_min</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_climate_prec_sim</code></td>
<td>
<p>a matrix containing monthly mean daily precipitation for the simulation period. If is <code>NULL</code> (Default), it is set equal to <code>mean_climate_prec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlygeneration</code></td>
<td>
<p>logical value. If <code>TRUE</code> the VAR model <code>varmodel</code> is given as input and only random generation is done, otherwise (default) is calculated from measured data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varmodel</code></td>
<td>
<p>the comprehensinve VAR model as a <code>varest2</code> S4 object or a <code>NULL</code> object. If <code>NULL</code> (default), the comprehensinve VAR is estimated from measured data within the function, otherwise it is given as input and only random generation is done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_quantile</code></td>
<td>
<p>see <code>type</code> on <code>quantile</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>see <code>normalizeGaussian_severalstations</code>. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_GPCA_iteration</code></td>
<td>
<p>number of iterations of Gaussianization process for data. Default is 0 (no Gaussianization)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_GPCA_iteration_residuals</code></td>
<td>
<p>number of iterations of Gaussianization process for VAR residuals. Default is 0 (no Gaussianization)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample, extremes, qnull, valmin</code></td>
<td>
<p>see <code>normalizeGaussian_severalstations</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen_all</code></td>
<td>
<p>data frame containing exogenous variable formatted like <code>prec_all</code>. Default is <code>NULL</code>. 
It is alternative to <code>exogen</code> and if it not <code>NULL</code>,<code>is_exogen_gaussian</code> is automatically set <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen_all_col</code></td>
<td>
<p>vector of considered  columns of <code>exogen_all</code>. Default is <code>station</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_spline</code></td>
<td>
<p>logical value. See <code>splineInterpolateMonthlytoDailyforSeveralYears</code>. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nscenario</code></td>
<td>
<p>number of generated scenarios for daily maximum and minimum temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed for stochastic random generation see <code>set.seed</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>stochastic noise to add for variabile generation. Default is <code>NULL</code>. See <code>newVARmultieventRealization</code>. Not used in case that <code>nscenario&gt;1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of the following variables: 
</p>
<p><code>prec_mes</code>        matrix containing measured daily precipitation (the data is copied by the measured data given as input for the period and the station considered for <code>varmodel</code> estimation)
</p>
<p><code>prec_spline</code>      matrix containing climatic "spline-interpolated" daily preciptation from <code>mean_climate_prec</code>
</p>
<p><code>data_prec</code>        matrix containing normalized measured precipitation variable
</p>
<p><code>prec_gen</code>          matrix containing generated daily precipitation [mm]
</p>
<p><code>prec_spline_sim</code>   matrix containing climatic "spline-interpolated" daily preciptation from <code>mean_climate_prec_sim</code>
</p>
<p><code>data_prec_gen</code>            matrix containing normalized generated precipitation variable
</p>
<p><code>mean_climate_prec</code>        matrix containing monthly means of daily precipitation (historical scenario)
</p>
<p><code>mean_climate_prec_sim</code>    matrix containing monthly means of daily precipitation (predicted/simulated scenario)
</p>
<p><code>var</code>                 a varest object containing the used VAR model
</p>


<h3>Note</h3>

<p>It pre-processes and generates a multi-site precipitation fields. It uses <code>getVARmodel</code>. Detailed examples can be viewed of this function in <a href="https://docs.google.com/file/d/0B8xDtMCnW3dJU2JIemVqMnpKTHc/edit">this presentation</a>.
Unfortunately, using this approach, the spatial correlations are underestimated. This is due to the persinstence of zeros in the precipitation records.
This problem is known in literature and can be solved in the future versions of RMAWGEN.
See the R code for further details
</p>


<h3>Author(s)</h3>

<p>Emanuele Cordano, Emanuele Eccel
</p>


<h3>See Also</h3>

<p><code>splineInterpolateMonthlytoDailyforSeveralYears</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(trentino)
set.seed(1222) # set the seed for random generations!
year_max &lt;- 1990
year_min &lt;- 1961
year_max_sim &lt;- 1982
year_min_sim &lt;- 1981

n_GPCA_iter &lt;- 2
p &lt;- 1
nscenario=1
station &lt;- c("T0090","T0083")  
## Not Run: the call to ComprehensivePrecipitationGenerator may elapse too 
## long time (more than 5 eseconds) and is not executed  by CRAN check.  
## Please uncomment the following line to run the example on your own PC. 
# generation00 &lt;- ComprehensivePrecipitationGenerator(station=station,
# prec_all=PRECIPITATION,year_min=year_min,year_max=year_max,
# year_min_sim=year_min_sim,year_max_sim=year_max_sim,p=p,
# n_GPCA_iteration=n_GPCA_iter,n_GPCA_iteration_residuals=0,
# sample="monthly",nscenario=nscenario,no_spline=TRUE)

#

</code></pre>


</div>