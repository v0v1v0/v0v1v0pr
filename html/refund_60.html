<div class="container">

<table style="width: 100%;"><tr>
<td>pco_predict_preprocess</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make predictions using pco basis terms</h2>

<h3>Description</h3>

<p>This function performs the necessary preprocessing for making predictions
with <code>[mgcv]{gam}</code> models that include <code>{pco}</code> basis
terms. The function <code>pco_predict_preprocess</code> builds a <code>data.frame</code>
(or augments an existing one) to be used with the usual <code>predict</code>
function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pco_predict_preprocess(model, newdata = NULL, dist_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a fitted <code>[mgcv]{gam}</code> model with at least one term of
class "<code>pco.smooth</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>data frame including the new values for any
non-<code>{pco}</code> terms in the original fit. If there were none, this
can be left as <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist_list</code></td>
<td>
<p>a list of <code>n</code> <code class="reqn">\times</code> <code>n*</code> matrices, one per
<code>{pco}</code> term in the model, giving the distances from the
<code>n*</code> prediction points to the <code>n</code> design points (original
observations). List entry names should correspond to the names of the terms
in the model (e.g., if the model includes a <code>s(x)</code> term,
<code>dist_list</code> must include an element named "<code>x</code>").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Models with <code>{pco}</code> basis terms are fitted by inputting distances
among the observations and then regressing (with a ridge penalty) on leading
principal coordinates arising from these distances. To perform prediction, we
must input the distances from the new data points to the original points, and
then "insert" the former into the principal coordinate space by the
interpolation method of Gower (1968) (see also Miller, 2012).
</p>
<p>An example of how to use this function in practice is shown in
<code>{smooth.construct.pco.smooth.spec}</code>.
</p>


<h3>Value</h3>

<p>a <code>{data.frame}</code> with the coordinates for the new data
inserted into principal coordinate space, in addition to the supplied
<code>newdata</code> if this was non-<code>NULL</code>. This can be used as the
<code>newdata</code> argument in a call to <code>[mgcv]{predict.gam}</code>.
</p>


<h3>Author(s)</h3>

<p>David L Miller
</p>


<h3>References</h3>

<p>Gower, J. C. (1968). Adding a point to vector diagrams in
multivariate analysis. Biometrika, 55(3), 582-585.
</p>
<p>Miller, D. L. (2012). On smooth models for complex domains and distances. PhD
dissertation, Department of Mathematical Sciences, University of Bath.
</p>


<h3>See Also</h3>

<p><code>{smooth.construct.pco.smooth.spec}</code>
</p>


</div>