<div class="container">

<table style="width: 100%;"><tr>
<td>densityplot-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density plots for Raster objects.</h2>

<h3>Description</h3>

<p>Draw kernel density plots (with <code>lattice</code>) of Raster objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Raster,missing'
densityplot(x, data=NULL, layers, FUN,
            maxpixels = 1e+05,
            xlab='', ylab='', main='',
            par.settings=rasterTheme(),
            draw.labels = TRUE,
            auto.key = list(space = "right"),
            att = 1,
            ...)

## S4 method for signature 'formula,Raster'
densityplot(x, data, dirXY,
            maxpixels = 1e+05,
            xscale.components=xscale.raster,
            yscale.components=yscale.raster,
            auto.key = list(space = 'right'), 
            par.settings=rasterTheme(),...)


## S4 method for signature 'SpatRaster,missing'
densityplot(x, data=NULL, layers, FUN,
            maxpixels = 1e+05,
            xlab='', ylab='', main='',
            par.settings=rasterTheme(),
            draw.labels = TRUE,
            auto.key = list(space = "right"),
            att = 1,
            ...)

## S4 method for signature 'formula,SpatRaster'
densityplot(x, data, dirXY,
            maxpixels = 1e+05,
            xscale.components=xscale.raster,
            yscale.components=yscale.raster,
            auto.key = list(space = 'right'), 
            par.settings=rasterTheme(),...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>Raster*</code> object, a <code>SpatRaster</code> object, or a <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>NULL</code>, a <code>Raster</code> object, or a
<code>SpatRaster</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layers</code></td>
<td>
<p>A numeric or character which should indicate the layers
to be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code>xyLayer</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>A function to applied to the <code>z</code> slot of a
<code>RasterStackBrick</code> object or to the time index of a
<code>SpatRaster</code> object. The result of this function
is used as the grouping variable of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpixels</code></td>
<td>
<p>A numeric, for <code>sampleRandom</code> or <code>spatSample</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw.labels</code></td>
<td>
<p>Logical. If TRUE (default), labels are displayed
over the maximum value of each layer. If FALSE, a key is displayed
according to the <code>auto.key</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, main, xscale.components, yscale.components,
par.settings, auto.key</code></td>
<td>
<p>Arguments for <code>densityplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>att</code></td>
<td>
<p>Integer or character to choose which variable (column) in
the RAT table should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for <code>densityplot</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p><code>lattice:densityplot()</code>,<code>xscale.raster</code>,
<code>yscale.raster</code>, <code>rasterTheme</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(raster)
library(terra)

f &lt;- system.file("external/test.grd", package="raster")
r &lt;- raster(f)
densityplot(r)
s &lt;- stack(r, r+500, r-500)
## With labels
densityplot(s)
## With a key
densityplot(s, draw.labels = FALSE)

## Not run: 
library(zoo)

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

densityplot(SISmm)
##FUN applies to z if not NULL
densityplot(SISmm, FUN=as.yearqtr)

## End(Not run)
## Not run: 
##http://neo.sci.gsfc.nasa.gov/Search.html?group=64
pop &lt;- raster('875430rgb-167772161.0.FLOAT.TIFF')
pop[pop==99999] &lt;- NA
levelplot(pop, zscaleLog=10, par.settings=BTCTheme,
          panel=panel.levelplot.raster, interpolate=TRUE)

##http://neo.sci.gsfc.nasa.gov/Search.html?group=20
landClass &lt;- raster('241243rgb-167772161.0.TIFF')
landClass[landClass==254] &lt;- NA


s &lt;- stack(pop, landClass)
names(s) &lt;- c('pop', 'landClass')

densityplot(~asinh(pop)|landClass, data=s,
            scales=list(relation='free'),
            strip=strip.custom(strip.levels=TRUE))

## End(Not run)
</code></pre>


</div>