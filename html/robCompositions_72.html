<div class="container">

<table style="width: 100%;"><tr>
<td>impCoda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputation of missing values in compositional data</h2>

<h3>Description</h3>

<p>This function offers different methods for the imputation of missing values
in compositional data. Missing values are initialized with proper values.
Then iterative algorithms try to find better estimations for the former
missing values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impCoda(
  x,
  maxit = 10,
  eps = 0.5,
  method = "ltsReg",
  closed = FALSE,
  init = "KNN",
  k = 5,
  dl = rep(0.05, ncol(x)),
  noise = 0.1,
  bruteforce = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data frame or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergence criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>imputation method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>closed</code></td>
<td>
<p>imputation of transformed data (using ilr transformation) or
in the original space (<code>closed</code> equals TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>method for initializing missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of nearest neighbors (if init $==$ “KNN”)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dl</code></td>
<td>
<p>detection limit(s), only important for the imputation of rounded
zeros</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>amount of adding random noise to predictors after convergency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bruteforce</code></td>
<td>
<p>if TRUE, imputations over dl are set to dl. If FALSE,
truncated (Tobit) regression is applied.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>eps: The algorithm is finished as soon as the imputed values stabilize, i.e.
until the sum of Aitchison distances from the present and previous iteration
changes only marginally (eps).\
</p>
<p>method: Several different methods can be chosen, such as ‘ltsReg’:
least trimmed squares regression is used within the iterative procedure.
‘lm’: least squares regression is used within the iterative
procedure.  ‘classical’: principal component analysis is used within
the iterative procedure.  ‘ltsReg2’: least trimmed squares regression
is used within the iterative procedure.  The imputated values are perturbed
in the direction of the predictor by values drawn form a normal distribution
with mean and standard deviation related to the corresponding residuals and
multiplied by <code>noise</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xOrig </code></td>
<td>
<p>Original data frame or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xImp </code></td>
<td>
<p>Imputed
data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria </code></td>
<td>
<p>Sum of the Aitchison distances from the present and
previous iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter </code></td>
<td>
<p>Number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit </code></td>
<td>
<p>Maximum
number of iterations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w </code></td>
<td>
<p>Amount of imputed values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind
</code></td>
<td>
<p>Index of the missing values in the data</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matthias Templ, Karel Hron
</p>


<h3>References</h3>

<p>Hron, K., Templ, M., Filzmoser, P. (2010) Imputation of
missing values for compositional data using classical and robust methods
<em>Computational Statistics and Data Analysis</em>, 54 (12),
3095-3107.
</p>


<h3>See Also</h3>

<p><code>impKNNa</code>, <code>pivotCoord</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(expenditures)
x &lt;- expenditures
x[1,3]
x[1,3] &lt;- NA
xi &lt;- impCoda(x)$xImp
xi[1,3]
s1 &lt;- sum(x[1,-3])
impS &lt;- sum(xi[1,-3])
xi[,3] * s1/impS

# other methods
impCoda(x, method = "lm")
impCoda(x, method = "ltsReg")

</code></pre>


</div>