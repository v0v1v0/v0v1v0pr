<div class="container">

<table style="width: 100%;"><tr>
<td>calc_rate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate rate of change in oxygen over time</h2>

<h3>Description</h3>

<p>Calculates rate of oxygen uptake or production from respirometry data. A rate
can be determined over the whole dataset, or on subsets of the data using the
<code>from</code> and <code>to</code> inputs to specify data regions in terms of <code>oxygen</code> or <code>time</code>
units or <code>row</code> numbers of the input data. Multiple rates can be extracted
from the same dataset by using these inputs to enter vectors of paired values
in the appropriate metric. See Examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_rate(x, from = NULL, to = NULL, by = "time", plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>inspect</code> or <code>data.frame</code>. This is the timeseries of
paired values of oxygen against time from which to calculate rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>numeric value or vector. Defaults to <code>NULL</code>. The start of the
region(s) over which you want to calculate the rate in the units specified
in <code>by</code>. If a vector, each value must have a paired value in <code>to</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>numeric value or vector. Defaults to <code>NULL</code>. The end of the
region(s) over which you want to calculate the rate in the units specified
in <code>by</code>. If a vector, each value must have a paired value in <code>from</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>string. <code>"time"</code>, <code>"row"</code>, or <code>"oxygen"</code>. Defaults to <code>"time"</code>.
This is the method used to subset the data region between <code>from</code> and <code>to</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. Defaults to <code>TRUE</code>. Plot the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Allows additional plotting controls to be passed, such as <code>pos</code>,
<code>panel</code>, and <code>quiet = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function calculates rates by fitting a linear model of oxygen against
time, with the slope of this regression being the rate. There are no units
involved in <code>calc_rate</code>. This is a deliberate decision. The units of oxygen
concentration and time will be specified later in <code>convert_rate()</code> when
rates are converted to specific output units.
</p>
<p>For continuous data recordings, it is recommended a <code>data.frame</code> containing
the data be prepared via <code>inspect()</code>, and entered as the <code>x</code> input. For
data not prepared like this, <code>x</code> can be a 2-column <code>data.frame</code> containing
numeric values of time (col 1) and oxygen (col 2). If multiple columns are
found in either an <code>inspect</code> or data frame input, only the first two columns
are used.
</p>


<h4>Specifying regions</h4>

<p>For calculating rates over specific regions of the data, the <code>from</code> and <code>to</code>
inputs in the <code>by</code> units of <code>"time"</code> (the default), "<code>oxygen</code>", or <code>"row"</code>.
The <code>from</code> and <code>to</code> inputs do not need to be precise; the function will use
the closest values found.
</p>
<p>Multiple regions can be examined within the same dataset by entering <code>from</code>
and <code>to</code> as vectors of paired values to specify different regions. In this
case, <code style="white-space: pre;">⁠$rate⁠</code> in the output will be a vector of multiple rates with each
result corresponding to the position of the paired <code>from</code> and <code>to</code> inputs. If
<code>from</code> and <code>to</code> are <code>NULL</code> (the default), the rate is determined over the
entire dataset.
</p>



<h4>Plot</h4>

<p>A plot is produced (provided <code>plot = TRUE</code>) showing the original data
timeseries of oxygen against time (bottom blue axis) and row index (top red
axis), with the region specified via the <code>from</code> and <code>to</code> inputs highlighted.
Second panel is a close-up of the rate region with linear model coefficients.
Third and fourth panels are summary plots of fit and residuals.
</p>



<h4>Additional plotting options</h4>

<p>If multiple rates have been calculated, by default the first (<code>pos = 1</code>) is
plotted. Others can be plotted by changing the <code>pos</code> input either in the main
function call, or by plotting the output, e.g. <code>plot(object, pos = 2)</code>. In
addition, each sub-panel can be examined individually by using the <code>panel</code>
input, e.g. <code>plot(object, panel = 2)</code>.
</p>
<p>Console output messages can be suppressed using <code>quiet = TRUE</code>. If axis
labels (particularly y-axis) are difficult to read, <code>las = 2</code> can be passed
to make axis labels horizontal, and <code>oma</code> (outer margins, default <code>oma = c(0.4, 1, 1.5, 0.4)</code>), and <code>mai</code> (inner margins, default <code>mai = c(0.3, 0.15, 0.35, 0.15)</code>) used to adjust plot margins.
</p>



<h4>S3 Generic Functions</h4>

<p>Saved output objects can be used in the generic S3 functions <code>print()</code>,
<code>summary()</code>, and <code>mean()</code>.
</p>

<ul>
<li> <p><code>print()</code>: prints a single result, by default the first rate. Others can be
printed by passing the <code>pos</code> input. e.g. <code>print(x, pos = 2)</code>
</p>
</li>
<li> <p><code>summary()</code>: prints summary table of all results and metadata, or those
specified by the <code>pos</code> input. e.g. <code>summary(x, pos = 1:5)</code>. The summary can
be exported as a separate dataframe by passing <code>export = TRUE</code>.
</p>
</li>
<li> <p><code>mean()</code>: calculates the mean of all rates, or those specified by the <code>pos</code>
input. e.g. <code>mean(x, pos = 1:5)</code> The mean can be exported as a separate value
by passing <code>export = TRUE</code>.
</p>
</li>
</ul>
<h4>More</h4>

<p>For additional help, documentation, vignettes, and more visit the <code>respR</code>
website at <a href="https://januarharianto.github.io/respR/">https://januarharianto.github.io/respR/</a>
</p>



<h3>Value</h3>

<p>Output is a <code>list</code> object of class <code>calc_rate</code> containing input
parameters and data, various summary data, metadata, linear models, and the
primary output of interest <code style="white-space: pre;">⁠$rate⁠</code>, which can be background adjusted in
<code>adjust_rate</code> or converted to units in <code>convert_rate</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Subset by 'time' (the default)
inspect(sardine.rd, time = 1, oxygen = 2, plot = FALSE) %&gt;%
  calc_rate(from = 200, to = 1800)

# Subset by oxygen
inspect(sardine.rd, time = 1, oxygen = 2, plot = FALSE) %&gt;%
  calc_rate(94, 91, by = "oxygen")

# Subset by row
inspect(sardine.rd, time = 1, oxygen = 2, plot = FALSE) %&gt;%
  calc_rate(1000, 2000, by = "row")

# Use a data frame input, and calculate rate from multiple regions by
# using a vector in the 'from' and 'to' inputs
x &lt;- calc_rate(intermittent.rd,
               from = c(200,2300,4100),
               to = c(1800,3200,4600),
               by = 'time',
               plot = FALSE)
# Print and summary of results
print(x)
summary(x)
# Plot the third of these results
plot(x, pos = 3)
# Plot only the timeseries plot and hide the legend
plot(x, pos = 3, panel = 1, legend = FALSE)
</code></pre>


</div>