<div class="container">

<table style="width: 100%;"><tr>
<td>setup_ellipse_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set up a diagnostic plot with a tolerance ellipse</h2>

<h3>Description</h3>

<p>Extract the relevant information for a diagnostic plot with a tolerance
ellipse from results of (robust) mediation analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setup_ellipse_plot(object, ...)

## S3 method for class 'test_mediation'
setup_ellipse_plot(object, ...)

## S3 method for class 'reg_fit_mediation'
setup_ellipse_plot(
  object,
  horizontal = NULL,
  vertical = NULL,
  partial = FALSE,
  level = 0.975,
  npoints = 100,
  ...
)

## S3 method for class 'cov_fit_mediation'
setup_ellipse_plot(
  object,
  horizontal = NULL,
  vertical = NULL,
  partial = FALSE,
  level = 0.975,
  npoints = 100,
  ...
)

## S3 method for class 'list'
setup_ellipse_plot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"fit_mediation"</code>
or <code>"test_mediation"</code> containing results from (robust) mediation
analysis, or a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed down.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p>a character string specifying the variable to be
plotted on the horizontal axis.  If the dependent variable is chosen for
the vertical axis, a hypothsized mediator or an independent variable must
be selected for the horizontal axis.  If a hypothesized mediator is chosen
for the vertical axis, an independent variable must be selected for the
horizontal axis (in case of a serial multiple mediator model, a hypothesized
mediator occurring earlier in the sequence is also allowed).  The default is
to plot the first independent variable on the horizontal axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical</code></td>
<td>
<p>a character string specifying the variable to be
plotted on the vertical axis: the dependent variable or a hypothesized
mediator.  The default is to plot the first hypothesized mediator on the
vertical axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>a logical indicating whether to extract the observed values
of the selected variable for the vertical axis (<code>FALSE</code>), or the
partial residuals with respect to the variable on the horizontal axis
(<code>TRUE</code>).  The latter allows to display the corresponding regression
coefficient by a line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>numeric; the confidence level of the tolerance ellipse.  It
gives the percentage of observations that are expected to lie within the
ellipse under the assumption of a normal distribution, and therefore it
controls the size of the ellipse.  The default is such that the ellipse is
expected to contain 97.5% of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>the number of grid points used to evaluate the ellipse.  The
default is to use 100 grid points.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is used internally by <code>ellipse_plot()</code>.  It may
also be useful for users who want to produce a similar plot, but who want
more control over what information to display or how to display that
information.
</p>


<h3>Value</h3>

<p>An object of class <code>"setup_ellipse_plot"</code> with the following
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the coordinates of the data points to
be plotted on the horizontal axis (column <code>x</code>) and the coordinates
on the vertical axis (column <code>y</code>).  For robust methods that assign
outlyingness weights to each data point, those weights are given in column
<code>Weight</code>.  If a list of objects has been supplied and there are
multiple objects from such robust methods, or if partial residuals are to be
plotted on the vertical axis, there is also a column <code>Method</code>, which
takes the names or indices of the list elements to indicate the different
methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>a data frame containing the coordinates of the tolerance
ellipse on the horizontal axis (column <code>x</code>) and on the vertical axis
(column <code>y</code>).  If a list of objects has been supplied, there is also a
column <code>Method</code>, which takes the names or indices of the list elements
to indicate the different methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p>a data frame with columns <code>intercept</code> and <code>slope</code>
containing the intercept and slope, respectively, of the regression line to
be plotted.  If  a list of objects has been supplied, there is also a column
<code>Method</code>, which takes the names or indices of the list elements to
indicate the different methods. This is only returned if
<code>partial = TRUE</code>, or in case of a simple mediation model (without
control variables) when the hypothesized mediator is plotted on the vertical
axis and the independent variable is plotted on the horizontal axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p>a character string giving the variable to be plotted on
the horizontal axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical</code></td>
<td>
<p>a character string giving the variable to be plotted on the
vertical axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>a logical indicating whether the values to be plotted on the
vertical axis correspond to the observed values of the selected variable
(<code>FALSE</code>), or the partial residuals with respect to the variable on the
horizontal axis (<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>a logical indicating whether the object contains results from
a robust method, or a vector of such logicals if a list of objects has been
supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>have_methods</code></td>
<td>
<p>a logical indicating whether a list of objects has been
supplied.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andreas Alfons
</p>


<h3>References</h3>

<p>Alfons, A., Ates, N.Y. and Groenen, P.J.F. (2022) Robust Mediation Analysis:
The <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package <span class="pkg">robmed</span>.  <em>Journal of Statistical Software</em>,
<b>103</b>(13), 1â€“45.  doi:10.18637/jss.v103.i13.
</p>


<h3>See Also</h3>

<p><code>fit_mediation()</code>, <code>test_mediation()</code>,
<code>ellipse_plot()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("BSG2014")

# run fast-and-robust bootstrap test
boot &lt;- test_mediation(BSG2014,
                       x = "ValueDiversity",
                       y = "TeamCommitment",
                       m = "TaskConflict")

# set up information for plot
setup &lt;- setup_ellipse_plot(boot)

# plot only data and tolerance ellipse
ggplot() +
  geom_path(aes(x = x, y = y), data = setup$ellipse,
            color = "#00BFC4") +
  geom_point(aes(x = x, y = y, fill = Weight),
             data = setup$data, shape = 21) +
  scale_fill_gradient(limits = 0:1, low = "white",
                      high = "black") +
  labs(x = setup$horizontal, y = setup$vertical)

</code></pre>


</div>