<div class="container">

<table style="width: 100%;"><tr>
<td>CalculatePowerBand</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Calculates power per band </h2>

<h3>Description</h3>

<p>Calculates  power of the heart rate signal at ULF, VLF, LF and HF bands
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalculatePowerBand(HRVData,
                   indexFreqAnalysis = length(HRVData$FreqAnalysis),
                   size, shift, sizesp = NULL, scale = "linear",
                   ULFmin = 0, ULFmax = 0.03,
                   VLFmin = 0.03, VLFmax = 0.05,
                   LFmin = 0.05, LFmax = 0.15,
                   HFmin = 0.15, HFmax = 0.4,
                   type = c("fourier", "wavelet"), wavelet = "d4",
                   bandtolerance = 0.01, relative = FALSE,
                   verbose = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HRVData</code></td>
<td>
<p> Data structure that stores the beats register and information 
related to it </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexFreqAnalysis</code></td>
<td>
<p> Reference to the data structure that will contain
the variability analysis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p> Size of window for calculations (seconds) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p> Displacement of window for calculations (seconds) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizesp</code></td>
<td>
<p> Points for calculation (zero padding). If the user does not 
specify it, the function estimates a propper value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ULFmin</code></td>
<td>
<p> Lower limit ULF band </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ULFmax</code></td>
<td>
<p> Upper limit ULF band </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VLFmin</code></td>
<td>
<p> Lower limit VLF band </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VLFmax</code></td>
<td>
<p> Upper limit VLF band </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LFmin</code></td>
<td>
<p> Lower limit LF band </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LFmax</code></td>
<td>
<p> Upper limit LF band </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HFmin</code></td>
<td>
<p> Lower limit HF band </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HFmax</code></td>
<td>
<p> Upper limit HF band </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p> Deprecated argument </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> Deprecated argument maintained for compatibility,
use SetVerbose() instead </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> Type of analysis used to calculate the spectrogram. 
Possible options are "fourier" or "wavelet"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wavelet</code></td>
<td>
<p> Mother wavelet used to calculate the spectrogram when
a wavelet-based analysis is performed. The available wavelets are: 
"haar" wavelet; least asymmetric Daubechies wavelets of width 8 ("la8"),
16 ("la16") and 20 ("la20") samples; extremal phase Daubechies of width 4
("d4"), 6 ("d6"), 8 ("d8") and 16 ("d16") samples; best localized wavelets
of width 14 ("bl14") and 20 (" bl20") samples; Fejer-Korovkin wavelets of 
width 4 ("fk4"), 6 ("fk6"), 8 ("fk8"), 14("fk14") and 22 ("fk22") samples; 
minimum bandwidth wavelets of width 4 ("mb4"), 8 ("mb8"), 16 ("mb16") and 24 
("mb24"); and the biorthogonal wavelet "bs3.1"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandtolerance</code></td>
<td>
<p> Maximum error allowed when a wavelet-based analysis is 
performed. It can be specified as a absolute or a relative error depending on
the "relative" parameter value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>
<p> Logic value specifying which kind of bandtolerance shall be
used (relative or absolute). The relative tolerance takes into account the 
width of each of the intervals of interest.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns HRVData, the structure that contains beat positions register, 
associated heart rate instantaneous values, filtered heart rate signal
equally spaced, and the analysis structure including spectral power at 
different bands of the heart rate signal
</p>


<h3>Note</h3>

<p>An example including all the necessary steps to obtain the power<br> 
bands of a wfdb register is giving below:<br></p>
<p>##Reading a wfdb register and storing into a data structure:<br>
md = CreateHRVData(Verbose = TRUE)<br>
md = LoadBeatWFDB(md, RecordName = "register_name",<br> 
RecordPath = "register_path")<br></p>
<p>##Calculating heart rate signal:<br>
md = BuildNIHR(md)<br></p>
<p>##Filtering heart rate signal:<br>
md = FilterNIHR(md)<br></p>
<p>##Interpolating heart rate signal:<br>
md = InterpolateNIHR(md)<br></p>
<p>##Calculating spectrogram and power per band using fourier <br>
analysis:<br>
md = CreateFreqAnalysis(md)<br>
md = CalculatePowerBand(md, indexFreqAnalysis = 1, size = 120, <br>
shift = 10, sizesp = 1024)<br></p>
<p>##Calculating spectrogram and power per band using wavelet analysis:<br>
md = CreateFreqAnalysis(md)<br>
md = CalculatePowerBand(md, indexFreqAnalysis = 2, type="wavelet",<br> 
wavelet="la8",bandtolerance=0.0025)<br></p>


<h3>Author(s)</h3>

<p>M. Lado, A. Mendez, D. Olivieri, L. Rodriguez, X. Vila
</p>


<h3>References</h3>

<p>L. Rodriguez-Linares, L., A.J. Mendez, M.J. Lado, D.N. Olivieri, X.A. Vila, 
and I. Gomez-Conde, "An open source tool for heart rate variability spectral 
analysis", Computer Methods and Programs in Biomedicine 103(1):39-50, july 2011.
</p>


</div>