<div class="container">

<table style="width: 100%;"><tr>
<td>compdist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing a distance matrix for cell type inference</h2>

<h3>Description</h3>

<p>This functions computes the distance matrix used for cell type inference by RaceID3.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compdist(
  object,
  metric = "pearson",
  FSelect = TRUE,
  knn = NULL,
  alpha = 1,
  no_cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>SCseq</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>Distances are computed from the filtered expression matrix after optional feature selection, dimensional reduction, and/or transformation (batch correction).
Possible values for <code>metric</code> are <code> spearman, pearson, logpearson, euclidean, kendall</code>.  Default is <code>"pearson"</code>. In case of the correlation based methods,
the distance is computed as 1 â€“ correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FSelect</code></td>
<td>
<p>Logical parameter. If <code>TRUE</code>, then feature selection is performed prior to RaceID3 analysis. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn</code></td>
<td>
<p>Positive integer number of nearest neighbours used for imputing gene expression values. Default is <code>NULL</code> and no imputing is done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Positive real number. Relative weight of a cell versus its k nearest neigbour applied for imputing gene expression. A cell receives a weight of <code>alpha</code> while the weight of its k nearest neighbours is determined by quadratic programming. The sum across all weights is normalized to one, and the wieghted mean expression is used for computing the joint probability of a cell and each of its k nearest neighbours. These probabilities are applied for the derivation of the imputed gene expression for each cell. Default is 1. Larger values give more weight to the gene expression observed in a cell versus its neighbourhood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_cores</code></td>
<td>
<p>Positive integer number. Number of cores for multithreading during imputation. If set to <code>NULL</code> then the number of available cores minus two is used. Default is 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>SCseq</code> object with the distance matrix in slot <code>distances</code>. If <code>FSelect=TRUE</code>, the genes used for computing the distance object are stored in
slot <code>cluster$features</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sc &lt;- SCseq(intestinalDataSmall)
sc &lt;- filterdata(sc)
sc &lt;- compdist(sc)
</code></pre>


</div>