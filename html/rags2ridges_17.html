<div class="container">

<table style="width: 100%;"><tr>
<td>default.penalty</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct commonly used penalty matrices</h2>

<h3>Description</h3>

<p>Function that constructs default or commonly use penalty matrices according
to a (factorial) study design.  The constructed penalty matrix can be used
directly in <code>optPenalty.fused.auto</code> or serve as basis for
modification.
</p>


<h3>Usage</h3>

<pre><code class="language-R">default.penalty(
  G,
  df,
  type = c("Complete", "CartesianEqual", "CartesianUnequal", "TensorProd")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>A <code>numeric</code> giving the number of classes. Can also be a
<code>list</code> of length <code>G</code> such as the usual argument <code>Slist</code> from
other <span class="pkg">rags2ridges</span> functions.  Can be omitted if <code>df</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>A <code>data.frame</code> with <code>G</code> rows and factors in the columns.
Note, the columns has to be of type <code>factor</code>.  Can be omitted when
<code>G</code> is given and <code>type == "Complete"</code>.  The factors can be
ordered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character giving the type of fused penalty graph to construct.
Should be <code>'Complete'</code> (default), <code>'CartesianEqual'</code>, or
<code>'CartesianUnequal'</code> or <code>'TensorProd'</code> or an unique abbreviation
hereof. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>type</code> gives a number of common choices for the penalty matrix:
</p>
 <ul>
<li> <p><code>'Complete'</code> is the complete penalty graph with equal
penalties.  </p>
</li>
<li> <p><code>'CartesianEqual'</code> corresponds to a penalizing along
each "direction" of factors with a common penalty. The choice is named
Cartesian as it is the Cartesian graph product of the complete penalty
graphs for the individual factors.  </p>
</li>
<li> <p><code>'CartesianUnequal'</code>
corresponds to a penalizing each direction of factors with individual
penalties.  </p>
</li>
<li> <p><code>'TensorProd'</code> correspond to penalizing the
"diagonals" only.  It is equivalent to the graph tensor products of the
complete graphs for each individual factor.  </p>
</li>
</ul>
<h3>Value</h3>

<p>Returns a <code>G</code> by <code>G</code> character matrix which specify the
class of penalty graphs to be used.  The output is suitable as input for
the penalty matrix used in <code>optPenalty.fused.auto</code>.
</p>


<h3>Author(s)</h3>

<p>Anders E. Bilgrau, Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;, Wessel
N. van Wieringen
</p>


<h3>References</h3>

<p>Bilgrau, A.E., Peeters, C.F.W., Eriksen, P.S., Boegsted, M., and
van Wieringen, W.N. (2020).  Targeted Fused Ridge Estimation of Inverse
Covariance Matrices from Multiple High-Dimensional Data Classes.  Journal
of Machine Learning Research, 21(26): 1-52.
</p>


<h3>See Also</h3>

<p><code>ridgeP.fused</code>, <code>optPenalty.fused</code>,
<code>default.target</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Handling one-way designs
  default.penalty(2)
  default.penalty(4)
  Slist &lt;- vector("list", 6)
  default.penalty(Slist)   # The function uses only the length of the list
  df0 &lt;- expand.grid(Factor = c("lvl1", "lvl2"))
  default.penalty(df0)

  # A more elaborate example
  df1 &lt;- expand.grid(DS = c("DS1", "DS2", "DS3"), ER = c("ER+", "ER-"))

  # Usage (various interface demonstrations)
  default.penalty(6, df1, type = "Complete")
  default.penalty(6, type = "CartesianEqual")  # GIVES WARNING
  default.penalty(6, df1, type = "CartesianEqual")
  default.penalty(Slist, df1, type = "CartesianEqual")
  default.penalty(6, df1, type = "CartesianUnequal")
  default.penalty(df1)

  # A 2 by 2 by 2 design
  df2 &lt;- expand.grid(A = c("A1", "A2"), B = c("B1", "B2"), C = c("C1", "C3"))
  default.penalty(df2)
  default.penalty(df2, type = "CartesianEqual")
  default.penalty(df2, type = "CartesianUnequal")

</code></pre>


</div>