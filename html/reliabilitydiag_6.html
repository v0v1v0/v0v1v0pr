<div class="container">

<table style="width: 100%;"><tr>
<td>plot.reliabilitydiag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting reliability diagram objects</h2>

<h3>Description</h3>

<p>Using the <span class="pkg">ggplot2</span> package to visually diagnose the reliability of
prediction methods that issue probability forecasts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'reliabilitydiag'
plot(x, ...)

## S3 method for class 'reliabilitydiag'
autoplot(
  object,
  ...,
  type = c("miscalibration", "discrimination"),
  colour = "red",
  params_histogram = NULL,
  params_ggMarginal = NULL,
  params_ribbon = NULL,
  params_diagonal = NULL,
  params_vsegment = NULL,
  params_hsegment = NULL,
  params_CEPline = NULL,
  params_CEPsegment = NULL,
  params_CEPpoint = NULL
)

## S3 method for class 'reliabilitydiag'
autolayer(
  object,
  ...,
  type = c("miscalibration", "discrimination"),
  colour = "red",
  params_histogram = NA,
  params_ggMarginal = NA,
  params_ribbon = NA,
  params_diagonal = NA,
  params_vsegment = NA,
  params_hsegment = NA,
  params_CEPline = NA,
  params_CEPsegment = NA,
  params_CEPpoint = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from the class <code>'reliabilitydiag'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from the class <code>'reliabilitydiag'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>one of <code>"miscalibration"</code>, <code>"discrimination"</code>;
determines which
layers are added by default, including default parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colour</code></td>
<td>
<p>a colour to be used to draw focus;
used for the CEP layers when <code>type</code> is <code>"miscalibration"</code>,
and for the horizontal segment layer and CEP margin histogram
when <code>type</code> is <code>"discrimination"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_histogram</code></td>
<td>
<p>a list of arguments for
<code>ggplot2::geom_histogram</code>;
this layer shows a histogram of the forecast values in the main plotting
region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_ggMarginal</code></td>
<td>
<p>a list of arguments for <code>ggExtra::ggMarginal</code>;
used to show the marginal distributions of the forecast values and
estimated CEP values by adding plots to the top and right of the main
plotting region. If this is anything other than <code>NA</code>, the <code>autoplot</code>
output cannot be customized by with additional layers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_ribbon</code></td>
<td>
<p>a list of arguments for <code>ggplot2::geom_ribbon</code>;
this layer shows the uncertainty quantification results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_diagonal</code></td>
<td>
<p>a list of arguments for <code>ggplot2::geom_line</code>;
this background layer illustrates perfect reliability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_vsegment</code></td>
<td>
<p>a list of arguments for <code>ggplot2::geom_segment</code>;
this layer shows a vertical segment illustrating the average forecast value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_hsegment</code></td>
<td>
<p>a list of arguments for <code>ggplot2::geom_segment</code>;
this layer shows a horizontal segment illustrating the average event frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_CEPline</code></td>
<td>
<p>a list of arguments for <code>ggplot2::geom_line</code>;
this layer shows a linear interpolation of the CEP estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_CEPsegment</code></td>
<td>
<p>a list of arguments for
<code>ggplot2::geom_segment</code>;
this layer highlights the pieces where the CEP estimate remains constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_CEPpoint</code></td>
<td>
<p>a list of arguments for <code>ggplot2::geom_point</code>;
this layer highlights the CEP estimate only for actually observed forecast values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plot</code> always sends a plot to a graphics device, wheres <code>autoplot</code>
behaves as any <code>ggplot() + layer()</code> combination. That means, customized
plots should be created using <code>autoplot</code> and <code>autolayer</code>.
</p>
<p>Three sets of default parameter values are used:
</p>

<ul>
<li>
<p> If multiple predictions
methods are compared, then only the most necessary information to determine
reliability are displayed.
</p>
</li>
<li>
<p> For a single prediction method and <code>type = "miscalibration"</code>, the
focus lies on the deviation from the diagonal including uncertainty
quantification.
</p>
</li>
<li>
<p> For a single prediction method and <code>type = "discrimination"</code>, the
focus lies on the PAV transformation and the resulting marginal distribution.
A concentration of CEP values near 0 or 1 suggest a high potential predictive
ability of a prediction method.
</p>
</li>
</ul>
<p>Setting any of the <code>params_*</code> arguments to <code>NA</code> disables that layer.
</p>
<p>Default parameter values if <code>length(object) &gt; 1</code>,
where the internal variable <code>forecast</code> is used as grouping variable:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>params_histogram</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_ggMarginal</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_ribbon</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_diagonal</code> </td>
<td style="text-align: left;"> <code>list(size = 0.3, colour = "black")</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_vsegment</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_hsegment</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPline</code> </td>
<td style="text-align: left;"> <code>list(size = 0.2)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPsegment</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPpoint</code> </td>
<td style="text-align: left;"> <code>NA</code>
</td>
</tr>
</table>
<p>Default parameter values for <code>type = "miscalibration"</code> if <code>length(object) == 1</code>:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>params_histogram</code> </td>
<td style="text-align: left;"> <code>list(yscale = 0.2, colour = "black", fill = NA)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_ggMarginal</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_ribbon</code> </td>
<td style="text-align: left;"> <code>list(fill = "blue", alpha = 0.15)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_diagonal</code> </td>
<td style="text-align: left;"> <code>list(size = 0.3, colour = "black")</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_vsegment</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_hsegment</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPline</code> </td>
<td style="text-align: left;"> <code>list(size = 0.2, colour = colour)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPsegment</code> </td>
<td style="text-align: left;"> <code>list(size = 2, colour = colour)</code> if <code>xtype == "continuous"</code>; <code>NA</code> otherwise. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPpoint</code> </td>
<td style="text-align: left;"> <code>list(size = 2, colour = colour)</code> if <code>xtype == "discrete"</code>; <code>NA</code> otherwise.
</td>
</tr>
</table>
<p>Default parameter values for <code>type = "discrimination"</code> if <code>length(object) == 1</code>:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>params_histogram</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_ggMarginal</code> </td>
<td style="text-align: left;"> <code>list(type = "histogram", xparams = list(bins = 100, fill = "grey"), yparams = list(bins = 100, fill = colour))</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_ribbon</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_diagonal</code> </td>
<td style="text-align: left;"> <code>list(size = 0.3, colour = "lightgrey")</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_vsegment</code> </td>
<td style="text-align: left;"> <code>list(size = 1.5, colour = "grey")</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_hsegment</code> </td>
<td style="text-align: left;"> <code>list(size = 1.5, colour = colour)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPline</code> </td>
<td style="text-align: left;"> <code>list(size = 0.2, colour = "black")</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPsegment</code> </td>
<td style="text-align: left;"> <code>NA</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>params_CEPpoint</code> </td>
<td style="text-align: left;"> <code>list(colour = "black")</code>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object inheriting from class <code>'ggplot'</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("precip_Niamey_2016", package = "reliabilitydiag")
r &lt;- reliabilitydiag(
  precip_Niamey_2016[c("Logistic", "EMOS", "ENS", "EPC")],
  y = precip_Niamey_2016$obs,
  region.level = NA
)

# simple plotting
plot(r)

# faceting using the internal grouping variable 'forecast'
autoplot(r, params_histogram = list(colour = "black", fill = NA)) +
  ggplot2::facet_wrap("forecast")

# custom color scale for multiple prediction methods
cols &lt;- c(Logistic = "red", EMOS = "blue", ENS = "darkgreen", EPC = "orange")
autoplot(r) +
  ggplot2::scale_color_manual(values = cols)

# default reliability diagram type with a title
rr &lt;- reliabilitydiag(
  EMOS = precip_Niamey_2016$EMOS,
  r = r,
  region.level = 0.9
)
autoplot(rr) +
  ggplot2::ggtitle("Reliability diagram for EMOS method")

# using defaults for discrimination diagrams
p &lt;- autoplot(r["EMOS"], type = "discrimination")
print(p, newpage = TRUE)

# ggMarginal needs to be called after adding all custom layers
p &lt;- autoplot(r["EMOS"], type = "discrimination", params_ggMarginal = NA) +
  ggplot2::ggtitle("Discrimination diagram for EMOS method")
p &lt;- ggExtra::ggMarginal(p, type = "histogram")
print(p, newpage = TRUE)

# the order of the layers can be changed
autoplot(rr, colour = "black", params_ribbon = NA) +
  autolayer(rr, params_ribbon = list(fill = "red", alpha = .5))

</code></pre>


</div>