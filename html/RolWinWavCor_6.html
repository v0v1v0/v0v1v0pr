<div class="container">

<table style="width: 100%;"><tr>
<td>plot_estim_RWWC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the rolling window wavelet correlation coefficients 
</h2>

<h3>Description</h3>

<p>The <code>plot_estim_RWWC</code> function plots the rolling window wavelet correlation (RWWC) coefficients that are statistically significant between two regular time series as a heat map and also plots the time series under study. The function is based on the work of Polanco-Martínez et al. (2018). <code>plot_estim_RWWC</code> is fed by the function <code>estim_RWWC</code> that is contained in our <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package 'RolWinWavCor'. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_estim_RWWC(inputdata, DATES="null", wavcorinput, Wname, J, W, 
  Align="center", vartsX="X", vartsY="Y", coltsX="black", 
  coltsY="blue", CEXAXIS=1, CEXLAB=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputdata</code></td>
<td>
 
<p>A matrix of three columns: the first one is the time (regular or evenly spaced) and the other two columns are the variables under study. This data set is the same used in the function <code>estim_RWWC</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DATES</code></td>
<td>

<p>This optional parameter contains the times of the time series under study. If this parameter is not provided it is computed using the <code>inputdata</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wavcorinput</code></td>
<td>

<p>This parameter contains the output of the function <code>estim_RWWC</code> and consists of a multidimensional matrix with three columns: the first one contains the correlation coefficients and the second and third columns are the left and right bound of the 95% confidence interval. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wname</code></td>
<td>

<p>Name of the wavelet filter used in the wavelet transform (MODWT) decomposition and must be the same that was used with the function <code>estim_RWWC</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>

<p>The maximum level of the MODWT decomposition and must be the same used with the function <code>estim_RWWC</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>The window-length or size of the window used when the rolling window wavelet correlation coefficients are estimated and this must have the same value that was used in <code>estim_RWWC</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Align</code></td>
<td>

<p>This is used to align the rolling object and must be the same as used in the function <code>estim_RWWC</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vartsX, vartsY</code></td>
<td>

<p>Names of the first (e.g. “X”) and the second (e.g. “Y”) variable under study.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coltsX, coltsY</code></td>
<td>
 
<p>The colors used to plot the first and second variable. By default the colors are black and blue for the first and second variable, respectively. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CEXAXIS</code></td>
<td>
 
<p>This parameter is used to plot the size of the X and Y axes. Its default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CEXLAB</code></td>
<td>

<p>This parameter is used to plot the size of the X-axis and Y-axis labels. Its default value is 1.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>plot_estim_RWWC</code> function plots the time series under analysis and the rolling window wavelet correlation coefficients that are statistically significant (within the 95% CI) as a heat map. This function is also based on the work of Polanco-Martínez et al. (2018).
</p>


<h3>Value</h3>

<p>Output: a multi-plot displayed via screen containing the time series under scrutiny and a heat map of the rolling window wavelet correlation coefficients that are statistically significant. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br>
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br>
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br>
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br>
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> <br>
Acknowledgement:<br> 
We acknowledge to the Excellence Unit GECOS (grant reference number CLU-2019-03), Universidad de Salamanca for its funding support. 
</p>


<h3>References</h3>

<p>Polanco-Martínez, J. M., Fernández-Macho, J., Neumann, M. B., &amp; Faria, S. H. (2018). A pre-crisis vs. crisis analysis of peripheral EU stock markets by means of wavelet transform and a nonlinear causality test. Physica A: Statistical Mechanics and its Applications, 490, 1211-1227. &lt;URL: doi: <a href="https://doi.org/10.1016/j.physa.2017.08.065">10.1016/j.physa.2017.08.065</a>&gt;.  
</p>


<h3>Examples</h3>

<pre><code class="language-R"># We reproduce Figure 2 presented in Polanco-Martínez et al. (2018). 
datPIGS     &lt;- EU_stock_markets 
sindatePIGS &lt;- datPIGS[-1]    
sindatePIGS &lt;- sindatePIGS[c(1:5, 8)]
lrdatPIGS   &lt;- apply(log(sindatePIGS), 2, diff)
lrDATES     &lt;- as.Date(datPIGS[,1][-1])
tsdatPIGS   &lt;- ts(lrdatPIGS, start=1, freq=1)
Nnam        &lt;- dim(tsdatPIGS)[2]
lrdatPIGS   &lt;- lrdatPIGS[,1:Nnam]
inputdata   &lt;- tsdatPIGS[,c(2,5)]

Wname &lt;- "la8"  
J     &lt;- 4    
W     &lt;- 241 
Align &lt;- "center"

rwwc &lt;- estim_RWWC(inputdata, Wname, J, W, Align=Align)
wavcor.output &lt;- rwwc 
DATES         &lt;- lrDATES
plot_estim_RWWC(inputdata, DATES=DATES, wavcor.output, Wname, J, W, 
                  Align=Align, CEXAXIS=1.2)
</code></pre>


</div>