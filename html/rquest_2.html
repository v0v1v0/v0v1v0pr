<div class="container">

<table style="width: 100%;"><tr>
<td>q.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>q.test</h2>

<h3>Description</h3>

<p>carry out hypothesis tests and obtain associated confidence intervals for linear combinations of quantiles,
and ratios of such linear combinations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">q.test(
  x,
  y = NULL,
  measure = "median",
  u = NULL,
  coef = NULL,
  u2 = NULL,
  coef2 = NULL,
  quantile.type = 8,
  var.method = "qor",
  alternative = c("two.sided", "less", "greater"),
  conf.level = 0.95,
  true.q = 0,
  log.transf = FALSE,
  back.transf = FALSE,
  min.q = -Inf,
  p = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an optional second vector of data values for two-sample testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>a character string specifying the quantile measure to be estimated (See details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>a numeric vector of probability values in [0, 1] indicating all quantiles to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>a vector or matrix with two rows specifying the coefficients that define the linear combinations (coefficients must match the corresponding probability values in u). If coef is a vector then a single linear combination (LC) is computed. If it is a matrix, then first row defines the numerator LS and the second the denominator LC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u2</code></td>
<td>
<p>a numeric vector of probability values in [0, 1] indicating all quantiles to be estimated for the denominator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef2</code></td>
<td>
<p>a vector specifying the coefficients that define the linear combination for the denominator.  This is can be used as an alternative to defining coef as matrix for ratios of linear combinations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile.type</code></td>
<td>
<p>argument for the quantile function.  Default is set to 8 so that output is consistent with default quantile function use and other functions such as IQR (see help file for <code>quantile()</code>
for more details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.method</code></td>
<td>
<p>approach use to estimate the quantile density function.  Either "qor"(default) or "density" (See details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string for alternative hypothesis equal to one of "two.sided", "greater" or "less".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>coverage for the estimated confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true.q</code></td>
<td>
<p>a numeric value for the true value under the null hypothesis test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.transf</code></td>
<td>
<p>boolean indicating whether the a log transformation of the measure is to be used (i.e., estimates of the log of the measure are computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>back.transf</code></td>
<td>
<p>boolean indicating whether the measure and estimates should be back-transformed  to the original scale using exp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.q</code></td>
<td>
<p>the lower bound for a one-sided confidence interval when alternative  argument if "less".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>optional value in (0, 1) for Bowley's generalized skewness coefficient.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function <code>q.test</code> performs hypothesis tests and calculates confidence intervals for linear combinations of quantiles.
The quantile measures that can be estimated are specified in the <code>measure</code> argument and are listed below.
</p>

<ul>
<li> <p><code>median</code>: The default choice.
</p>
</li>
<li> <p><code>iqr</code>: The interquartile range.
</p>
</li>
<li> <p><code>rCViqr</code>: The robust Coefficient of Variation measure (Arachchige et al.,2022)
</p>
</li>
<li> <p><code>bowley</code>, <code>groenR</code> and <code>groenL</code>: These choices are for Bowley's skew coefficient,
for the generalized measure, and the right and left skew measures by Groeneveld and Meeden (Groeneveld &amp; Meeden, 1984, 2009). For each of these measures, the user may specify the choice of p using argument <code>p</code>.  If this is not used, then the default is <code>p=0.25</code>.
</p>
</li>
<li> <p><code>moors</code>: This Moors kurtosis measure (Moors, 1988).
</p>
</li>
<li> <p><code>lqw</code> and <code>rqw</code>: These are for the robust left and right tail weights (Brys et al., 2006).
</p>
</li>
<li> <p><code>qrxxyy</code>: A character string consisting of the first two characters "qr" and followed by four numbers will request a ratio of dependents quantiles (i.e. different quantiles from the same sample).The first two number digits (in place of "xx") will indicate the quantile for the numerator, and the second two numerical digits "yy" for the denominator.  For example, <code>qr9010</code> will estimate and test the ratio Q(0.9)/Q(0.1).
</p>
</li>
</ul>
<p>The default <code>var.method="qor"</code> is to estimate the probability density function directly using the lognormal Quantile Optimality Ratio (QOR)
for choosing a suitable bandwidth (Prendergast &amp; Staudte,2016). Alternatively, the variances can be
estimated by inverting a density estimator evaluated at the quantiles and this can be done using <code>var.method = "density"</code>.
</p>
<p>Additional to using a text string with argument measure to indicate which quantile-based measure is to be used (of those included for the <code>q.test</code> function),
users can also define and request their own.  For example, while the median is the default for a single quantile, other quantiles can also be requested
(e.g., <code>u = 0.25</code> will request the first quartile).  This option is also included for linear combinations of quantiles and ratios of linear combinations,
which can be done in two ways.  For a single linear combination, argument <code>u</code> is the vector of probability values defining the quantiles to be used,
and argument <code>coef</code> is a vector of coefficients for the linear combination.  If a ratio is needed, then <code>u</code> and <code>coef</code> are used for the numerator and <code>u2</code> and <code>coef2</code>
for the denominator linear combination.  Alternatively, a single <code>u</code> can be used to identify all quantiles for the ratio, and then <code>coef</code> can be a matrix (2 rows)
whose first row specifies the coefficients for the numerator and the second row for the denominator. For more information and further examples,
see Prendergast, Dedduwakumara &amp; Staudte (2024), and the example code below shows how to obtain results for
the robust CVs using all three approaches (to achieve identical results).
</p>
<p>Further details on confidence intervals, including coverage properties of, can be found for ratios of dependent quantiles (Prendergast &amp; Staudte, 2017),
ratios of independent quantiles and IQRs (Arachchige et al., 2021) and for robust CVs (Arachchige et al., 2022).
</p>


<h3>Value</h3>

<p>hypothesis test results and associated confidence interval (a list with class "htest")
</p>


<h3>References</h3>

<p>Arachchige, C. N., Cairns, M., &amp; Prendergast, L. A. (2021). Interval estimators for ratios of independent quantiles and interquantile ranges.
Communications in Statistics-Simulation and Computation, 50(12), 3914-3930.
</p>
<p>Arachchige, C.N.P.G., Prendergast, L.A., &amp; Staudte, R.G. (2022). Robust Analogs to the Coefficient of
Variation. Journal of Applied Statistics, 49(2), 268–290.
</p>
<p>Brys, G., Hubert, M., &amp; Struyf, A. (2006). Robust measures of tail weight. Computational Statistics &amp; Data
Analysis, 50(3), 733–759.
</p>
<p>Groeneveld, R. A., &amp; Meeden, G. (1984). Measuring skewness and kurtosis. Journal of the Royal Statistical
Society Series D: The Statistician, 33(4), 391–399.
</p>
<p>Groeneveld, R. A., &amp; Meeden, G. (2009). An improved skewness measure. Metron, 67(3), 325.
</p>
<p>Hyndman, R.J., &amp; Fan, Y. (1996). Sample quantiles in statistical packages. The American Statistician, 50(4),
361–365.
</p>
<p>Moors, J. J. A. (1988). A quantile alternative for kurtosis. Journal of the Royal Statistical Society:
Series D (The Statistician), 37(1), 25–32.
</p>
<p>Prendergast, L. A., &amp; Staudte, R. G. (2016). Exploiting the quantile optimality ratio in finding confidence intervals for quantiles. Stat, 5(1), 70-81
</p>
<p>Prendergast, L. A., &amp; Staudte, R. G. (2017). When large n is not enough–distribution-free interval estimators for ratios of quantiles.
The Journal of Economic Inequality, 15, 277-293.
</p>
<p>Prendergast, L. A., Dedduwakumara, D.S. &amp; Staudte, R.G. (2024) rquest: An R package for hypothesis tests and confidence intervals
for quantiles and summary measures based on quantiles, preprint, pages 1-13
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#  Create some data
x &lt;- c(8.43,7.08,8.79,8.88,7.87,5.94,8.79,5.46,8.11,7.08)
y &lt;- c(13.44,13.65,14.77,9.51,14.07,10.92,11.59,13.42,8.93,10.88)

# One sample hypothesis test for the IQR
q.test(x, measure = "iqr")

# Two samples hypothesis test for robust coefficient variations (0.75*IQR/median)
# with log transformation and back-transformation to the ratio scale,.
q.test(x, y, measure = "rCViqr", log.transf = TRUE, back.transf = TRUE)

# The same two samples hypothesis test for robust coefficient variations (0.75*IQR/median)
# by using 'u',''u2','coef' and 'coef2' arguments.
u&lt;-c(0.25,0.75)
coef&lt;-0.75*c(-1,1)
u2&lt;-0.5
coef2&lt;-1
q.test(x,y,u=u,u2=u2,coef=coef,coef2=coef2,log.transf=TRUE,back.transf=TRUE)

# The same two samples hypothesis test for robust coefficient variations (0.75*IQR/median)
# by using only 'u' and 'coef' arguments.
u&lt;-c(0.25,0.5,0.75)
num &lt;- 0.75*c(-1,0,1)
den &lt;- c(0,1,0)
coef &lt;- rbind(num, den)
q.test(x,y,u=u,coef=coef,log.transf=TRUE,back.transf=TRUE)
</code></pre>


</div>