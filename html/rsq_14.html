<div class="container">

<table style="width: 100%;"><tr>
<td>simglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Data from Generalized Linear Models</h2>

<h3>Description</h3>

<p>Simulate data from linear and generalized linear models. Only the first covariate truely affects the response variable with coefficient equal to <code>lambda</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">simglm(family=c("binomial", "gaussian", "poisson","Gamma"),lambda=3,n=50,p=3)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p> the family of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p> size of the coefficient of the first covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> the number of covarites.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The first covariate takes 1 in half of the observations, and 0 or -1 in the other half. When <code>lambda</code> gets larger, it is supposed to easier to predict the response variable.
</p>


<h3>Value</h3>

<p>Returned values include <code>yx</code> and <code>beta</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>yx</code></td>
<td>
<p> a data frame including the response <code>y</code> and covariates <code>x.1</code>, <code>x.2</code>, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p> true values of the regression coefficients.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>


<h3>See Also</h3>

<p><code>rsq, rsq.partial, pcor</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Poisson Models
sdata &lt;- simglm(family="poisson",lambda=4)
fitf &lt;- glm(y~x.1+x.2+x.3,family=poisson,data=sdata$yx)
rsq(fitf)  # type='v'

fitr &lt;- glm(y~x.2+x.3,family=poisson,data=sdata$yx)
rsq(fitr)  # type='v'
rsq(fitr,type='kl')
rsq(fitr,type='lr')
rsq(fitr,type='n')

pcor(fitr)  # type='v'
pcor(fitr,type='kl')
pcor(fitr,type='lr')
pcor(fitr,type='n')

# Gamma models with shape=100
n &lt;- 50
sdata &lt;- simglm(family="Gamma",lambda=4,n=n)
fitf &lt;- glm(y~x.1+x.2+x.3,family=Gamma,data=sdata$yx)
rsq(fitf)  # type='v'
rsq.partial(fitf)  # type='v'

fitr &lt;- glm(y~x.2,family=Gamma,data=sdata$yx)
rsq(fitr)  # type='v'
rsq(fitr,type='kl')
rsq(fitr,type='lr')
rsq(fitr,type='n')

# Likelihood-ratio-based R-squared
y &lt;- sdata$yx$y
yhatr &lt;- fitr$fitted.values
fit0 &lt;- update(fitr,.~1)
yhat0 &lt;- fit0$fitted.values
llr &lt;- sum(log(dgamma(y,shape=100,scale=yhatr/100)))
ll0 &lt;- sum(log(dgamma(y,shape=100,scale=yhat0/100)))

# Likelihood-ratio-based R-squared
1-exp(-2*(llr-ll0)/n)

# Corrected likelihood-ratio-based R-squared
(1-exp(-2*(llr-ll0)/n))/(1-exp(2*ll0/n))
</code></pre>


</div>