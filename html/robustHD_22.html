<div class="container">

<table style="width: 100%;"><tr>
<td>corHuber</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust correlation based on winsorization</h2>

<h3>Description</h3>

<p>Compute a robust correlation estimate based on winsorization, i.e., by
shrinking outlying observations to the border of the main part of the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">corHuber(
  x,
  y,
  type = c("bivariate", "adjusted", "univariate"),
  standardized = FALSE,
  centerFun = median,
  scaleFun = mad,
  const = 2,
  prob = 0.95,
  tol = .Machine$double.eps^0.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string specifying the type of winsorization to be
used.  Possible values are <code>"univariate"</code> for univariate winsorization,
<code>"adjusted"</code> for adjusted univariate winsorization, or
<code>"bivariate"</code> for bivariate winsorization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardized</code></td>
<td>
<p>a logical indicating whether the data are already
robustly standardized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerFun</code></td>
<td>
<p>a function to compute a robust estimate for the center to
be used for robust standardization (defaults to
<code>median</code>).  Ignored if <code>standardized</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleFun</code></td>
<td>
<p>a function to compute a robust estimate for the scale to
be used for robust standardization (defaults to <code>mad</code>).
Ignored if <code>standardized</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>
<p>numeric; tuning constant to be used in univariate or adjusted
univariate winsorization (defaults to 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>numeric; probability for the quantile of the
<code class="reqn">\chi^{2}</code> distribution to be used in bivariate
winsorization (defaults to 0.95).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a small positive numeric value.  This is used in bivariate
winsorization to determine whether the initial estimate from adjusted
univariate winsorization is close to 1 in absolute value.  In this case,
bivariate winsorization would fail since the points form almost a straight
line, and the initial estimate is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to
<code>robStandardize</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The borders of the main part of the data are defined on the scale of the
robustly standardized data.  In univariate winsorization, the borders for
each variable are given by <code class="reqn">+/-</code><code>const</code>, thus a symmetric
distribution is assumed.  In adjusted univariate winsorization, the borders
for the two diagonally opposing quadrants containing the minority of the
data are shrunken by a factor that depends on the ratio between the number of
observations in the major and minor quadrants.  It is thus possible to
better account for the bivariate structure of the data while maintaining
fast computation.  In bivariate winsorization, a bivariate normal
distribution is assumed and the data are shrunken towards the boundary of a
tolerance ellipse with coverage probability <code>prob</code>.  The boundary of
this ellipse is thereby given by all points that have a squared Mahalanobis
distance equal to the quantile of the <code class="reqn">\chi^{2}</code>
distribution given by <code>prob</code>.  Furthermore, the initial correlation
matrix required for the Mahalanobis distances is computed based on adjusted
univariate winsorization.
</p>


<h3>Value</h3>

<p>The robust correlation estimate.
</p>


<h3>Author(s)</h3>

<p>Andreas Alfons, based on code by Jafar A. Khan, Stefan Van Aelst and
Ruben H. Zamar
</p>


<h3>References</h3>

<p>Khan, J.A., Van Aelst, S. and Zamar, R.H. (2007) Robust linear model
selection based on least angle regression. <em>Journal of the American
Statistical Association</em>, <b>102</b>(480), 1289â€“1299.
<a href="https://doi.org/10.1198/016214507000000950">doi:10.1198/016214507000000950</a>
</p>


<h3>See Also</h3>

<p><code>winsorize</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate data
library("mvtnorm")
set.seed(1234)  # for reproducibility
Sigma &lt;- matrix(c(1, 0.6, 0.6, 1), 2, 2)
xy &lt;- rmvnorm(100, sigma=Sigma)
x &lt;- xy[, 1]
y &lt;- xy[, 2]

## introduce outlier
x[1] &lt;- x[1] * 10
y[1] &lt;- y[1] * (-5)

## compute correlation
cor(x, y)
corHuber(x, y)

</code></pre>


</div>