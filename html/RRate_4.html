<div class="container">

<table style="width: 100%;"><tr>
<td>RRate-functions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimating Replication Rate for primary associations
</h2>

<h3>Description</h3>

<p><code>repRateEst</code> implements a replication rate estimation method. Two-component mixture prior is used in the estimation. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">repRateEst(MUhat, SE, SE2, zalpha2, zalphaR2, boot = 100, output = TRUE, 
idx = TRUE, dir = "output", info = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MUhat</code></td>
<td>

<p>The observed effect size (log-odds ratio) in the primary study.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>

<p>The standard error of the observed log-odds ratio in the primary study.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE2</code></td>
<td>

<p>The standard error of the observed log-odds ratio in the replication study.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zalpha2</code></td>
<td>

<p>The critical value of z-values in the primary study, i.e. z_alpha/2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zalphaR2</code></td>
<td>

<p>The critical value of z-values in the replication study, i.e. z_alphaR/2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>

<p>The resampling number of bootstrop used for estimating the credible interval of
the RR.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>

<p>Bool value.  To determine whether to output the estimated results in the
dir or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>

<p>The indexes of the SNPs having been further inverstigated in the replication study. We only calculate RR for primary associations with indexes in <code>idx</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>

<p>The directory to save the estimated results. It has effect when <code>output=T</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>

<p>Bool value. To determine whether to show the parematers inference results in the terminal or not.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The RR estimation is based on the following two-component mixture model:
mu=pi_0 delta_0+(1-pi_0) N(0, sigma_0^2).
</p>
<p>Details can be seen the following reference paper.
</p>


<h3>Value</h3>

<p><code>repRateEst</code> returns the RR, lfdr, prediction power and infered parameters. The returened value is a LIST:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>

<p>The index of the SNPs which RR are estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>

<p>The proportion of nonassociated SNPs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma02</code></td>
<td>

<p>The variance of the associated SNPs' effect sizes 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>

<p>Estimated replication rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RRlow</code></td>
<td>

<p>The lower limit of the 95% CI for RR. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RRhigh</code></td>
<td>

<p>The upper limit of the 95% CI for RR.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfdr</code></td>
<td>

<p>Estimated local false discovery rate of the primary study
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfdrLow</code></td>
<td>

<p>The lower limit of the 95% CI for lfdr. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfdrHigh</code></td>
<td>

<p>The upper limit of the 95% CI for lfdr. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predPower</code></td>
<td>

<p>The Bayesian predictive power of the replication study.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predPowerLow</code></td>
<td>

<p>The lower limit of the 95% CI for predPower. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perdPowerHigh</code></td>
<td>

<p>The upper limit of the 95% CI for predPower. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GRR</code></td>
<td>

<p>The Global Replication Rate (Mean value of RR)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GRRlow</code></td>
<td>

<p>The lower limit of the 95% CI for GRR. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GRRhigh</code></td>
<td>

<p>The upper limit of the 95% CI for GRR. 
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wei Jiang, Jing-Hao Xue and Weichuan Yu
</p>
<p>Maintainer: Wei Jiang &lt;wjiangaa@connect.ust.hk&gt;
</p>


<h3>References</h3>

<p>Jiang, W., Xue, J-H, and Yu, W.  What is the probability of replicating a statistically significant association in genome-wide association studies?. <em>Submitted</em>.
</p>


<h3>See Also</h3>

<p><code>RRate</code>, 
<code>SEest</code>,
<code>repSampleSizeRR</code>,
<code>repSampleSizeRR2</code>,
<code>HLtest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">alpha&lt;-5e-6               #Significance level in the primary study
alphaR&lt;-5e-3              #Significance level in the replication study
zalpha2&lt;-qnorm(1-alpha/2)
zalphaR2&lt;-qnorm(1-alphaR/2)

##Load data
data('smryStats1')        #Example of summary statistics in 1st study
n2.0&lt;-2000                #Number of individuals in control group
n2.1&lt;-2000                #Number of individuals in case group

SE2&lt;-SEest(n2.0, n2.1, smryStats1$F_U, smryStats1$F_A) #SE in replication study
######  RR estimation  ######
RRresult&lt;-repRateEst(log(smryStats1$OR),smryStats1$SE, SE2,zalpha2,zalphaR2, output=TRUE,dir='.')
RR&lt;-RRresult$RR           #Estimated RR
</code></pre>


</div>