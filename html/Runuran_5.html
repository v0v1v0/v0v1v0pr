<div class="container">

<table style="width: 100%;"><tr>
<td>ars.new</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>UNU.RAN generator based on Adaptive Rejection Sampling (ARS)</h2>

<h3>Description</h3>

<p>UNU.RAN random variate generator for continuous distributions with
given probability density function (PDF).
It is based on Adaptive Rejection Sampling (‘ARS’).
</p>
<p>[Universal] – Rejection Method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ars.new(logpdf, dlogpdf=NULL, lb, ub, ...)
arsd.new(distr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>logpdf</code></td>
<td>
<p>log-density function. (<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dlogpdf</code></td>
<td>
<p>derivative of <code>logpdf</code>. (<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>lower bound of domain;
use <code>-Inf</code> if unbounded from left. (numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>upper bound of domain;
use <code>Inf</code> if unbounded from right. (numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(optional) arguments for <code>logpdf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>distribution object. (S4 object of class <code>"unuran.cont"</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates a <code>unuran</code> object based on ‘ARS’
(Adaptive Rejection Sampling). It can be used to draw samples from
continuous distributions with given probability density function
using <code>ur</code>.
</p>
<p>Function <code>logpdf</code> is the logarithm the density function of the
target distribution. It must be a concave function (i.e., the
distribution must be log-concave).
However, it need not be normalized (i.e., it can be a log-density plus
some arbitrary constant).
</p>
<p>The derivative <code>dlogpdf</code> of the log-density is optional. If
omitted, numerical differentiation is used. Notice, however, that this
might cause some round-off errors such that the algorithm fails.
</p>
<p>Alternatively, one can use function <code>arsd.new</code> where the object
<code>distr</code> of class <code>"unuran.cont"</code> must contain all required
information about the distribution.
</p>
<p>The setup time of this method depends on the given PDF, whereas its
marginal generation times are almost independent of the target
distribution.
</p>
<p>‘ARS’ is a special case of method ‘TDR’
(see <code>tdr.new</code>). It is a bit slower and less
flexible but numerically more stable. In particular, it is useful if
one wants to sample from truncated distributions with extreme
truncation points; or when the integral of the given “density”
function is only known to be extremely large or small.
However, this assumes that the log-density is computed
analytically and not by just using <code>log(pdf(x))</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"unuran"</code>.
</p>


<h3>Author(s)</h3>

<p>Josef Leydold and Wolfgang H\"ormann
<a href="mailto:unuran@statmath.wu.ac.at">unuran@statmath.wu.ac.at</a>.
</p>


<h3>References</h3>

<p>W. H\"ormann, J. Leydold, and G. Derflinger (2004):
Automatic Nonuniform Random Variate Generation.
Springer-Verlag, Berlin Heidelberg.
See Chapter 4 (Tranformed Density Rejection).
</p>
<p>W. R. Gilks and P. Wild (1992):
Adaptive rejection sampling for Gibbs sampling.
Applied Statistics 41(2), pp. 337–348.
</p>


<h3>See Also</h3>

<p><code>ur</code>,
<code>tdr.new</code>, 
<code>unuran.cont</code>,
<code>unuran.new</code>,
<code>unuran</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create a sample of size 100 for a 
## Gaussian distribution (use logPDF)
lpdf &lt;- function (x) { -0.5*x^2 }
gen &lt;- ars.new(logpdf=lpdf, lb=-Inf, ub=Inf)
x &lt;- ur(gen,100)

## Same example but additionally provide derivative of log-density
## to prevent possible round-off errors
lpdf &lt;- function (x) { -0.5*x^2 }
dlpdf &lt;- function (x) { -x }
gen &lt;- ars.new(logpdf=lpdf, dlogpdf=dlpdf, lb=-Inf, ub=Inf)
x &lt;- ur(gen,100)

## Draw a sample from a truncated Gaussian distribution
## on domain [100,Inf)
lpdf &lt;- function (x) { -0.5*x^2 }
gen &lt;- ars.new(logpdf=lpdf, lb=50, ub=Inf)
x &lt;- ur(gen,100)

## Alternative approach
distr &lt;- udnorm()
gen &lt;- arsd.new(distr)
x &lt;- ur(gen,100)

</code></pre>


</div>