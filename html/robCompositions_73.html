<div class="container">

<table style="width: 100%;"><tr>
<td>impKNNa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputation of missing values in compositional data using knn methods</h2>

<h3>Description</h3>

<p>This function offers several k-nearest neighbor methods for the imputation
of missing values in compositional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impKNNa(
  x,
  method = "knn",
  k = 3,
  metric = "Aitchison",
  agg = "median",
  primitive = FALSE,
  normknn = TRUE,
  das = FALSE,
  adj = "median"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data frame or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method (at the moment, only “knn” can be used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of nearest neighbors chosen for imputation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>“Aichison” or “Euclidean”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg</code></td>
<td>
<p>“median” or “mean”, for the aggregation of the
nearest neighbors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>primitive</code></td>
<td>
<p>if TRUE, a more enhanced search for the $k$-nearest
neighbors is obtained (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normknn</code></td>
<td>
<p>An adjustment of the imputed values is performed if TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>das</code></td>
<td>
<p>depricated. if TRUE, the definition of the Aitchison distance,
based on simple logratios of the compositional part, is used (Aitchison,
2000) to calculate distances between observations.  if FALSE, a version
using the clr transformation is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>either ‘median’ (default) or ‘sum’ can be chosen
for the adjustment of the nearest neighbors, see Hron et al., 2010.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Aitchison <code>metric</code> should be chosen when dealing with compositional
data, the Euclidean <code>metric</code> otherwise.
</p>
<p>If <code>primitive</code> <code class="reqn">==</code> FALSE, a sequential search for the
<code class="reqn">k</code>-nearest neighbors is applied for every missing value where all
information corresponding to the non-missing cells plus the information in
the variable to be imputed plus some additional information is available. If
<code>primitive</code> <code class="reqn">==</code> TRUE, a search of the <code class="reqn">k</code>-nearest neighbors
among observations is applied where in addition to the variable to be
imputed any further cells are non-missing.
</p>
<p>If <code>normknn</code> is TRUE (prefered option) the imputed cells from a nearest
neighbor method are adjusted with special adjustment factors (more details
can be found online (see the references)).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xOrig </code></td>
<td>
<p>Original data frame or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xImp </code></td>
<td>
<p>Imputed
data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w </code></td>
<td>
<p>Amount of imputed values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind </code></td>
<td>
<p>Index of the missing
values in the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric </code></td>
<td>
<p>Metric used</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matthias Templ
</p>


<h3>References</h3>

<p>Aitchison, J., Barcelo-Vidal, C., Martin-Fernandez, J.A.,
Pawlowsky-Glahn, V. (2000) Logratio analysis and compositional distance,
<em>Mathematical Geology</em>, 32(3), 271-275.
</p>
<p>Hron, K., Templ, M., Filzmoser, P. (2010) Imputation of missing values
for compositional data using classical and robust methods
<em>Computational Statistics and Data Analysis</em>, 54 (12),
3095-3107.
</p>


<h3>See Also</h3>

<p><code>impCoda</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(expenditures)
x &lt;- expenditures
x[1,3]
x[1,3] &lt;- NA
xi &lt;- impKNNa(x)$xImp
xi[1,3]

</code></pre>


</div>