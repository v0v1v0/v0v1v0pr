<div class="container">

<table style="width: 100%;"><tr>
<td>plotClusterFactorDot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make dot plot of factor loading in cell groups</h2>

<h3>Description</h3>

<p>This function produces dot plots. Each column represent a group
of cells specified by <code>groupBy</code>, each row is a factor specified by
<code>useDims</code>. The color of dots reflects mean of factor loading of
specified factors in each cell group and sizes reflects the percentage of
cells that have loadings of a factor in a group. We utilize
<a href="https://jokergoo.github.io/ComplexHeatmap-reference/book/index.html">ComplexHeatmap</a>
for simplified management of adding annotation and slicing subplots. This was
inspired by the implementation in
<a href="https://samuel-marsh.github.io/scCustomize/reference/Clustered_DotPlot.html">scCustomize</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotClusterFactorDot(
  object,
  groupBy = NULL,
  useDims = NULL,
  useRaw = FALSE,
  splitBy = NULL,
  factorScaleFunc = NULL,
  cellIdx = NULL,
  legendColorTitle = "Mean Factor\nLoading",
  legendSizeTitle = "Percent\nLoaded",
  viridisOption = "viridis",
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A liger object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupBy</code></td>
<td>
<p>The names of the columns in <code>cellMeta</code> slot storing
categorical variables. Loading data would be aggregated basing on these,
together with <code>splitBy</code>. Default uses default clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useDims</code></td>
<td>
<p>A Numeric vector to specify exact factors of interests.
Default <code>NULL</code> uses all available factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useRaw</code></td>
<td>
<p>Whether to use un-aligned cell factor loadings (<code class="reqn">H</code>
matrices). Default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitBy</code></td>
<td>
<p>The names of the columns in <code>cellMeta</code> slot storing
categorical variables. Dotplot panel splitting would be based on these.
Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factorScaleFunc</code></td>
<td>
<p>A function object applied to factor loading matrix for
scaling the value for better visualization. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellIdx</code></td>
<td>
<p>Valid cell subscription. See <code>subsetLiger</code>.
Default <code>NULL</code> for using all cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendColorTitle</code></td>
<td>
<p>Title for colorbar legend. Default
<code>"Mean Factor\nLoading"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendSizeTitle</code></td>
<td>
<p>Title for size legend. Default
<code>"Percent\nLoaded"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridisOption</code></td>
<td>
<p>Name of available viridis palette. See
<code>viridis</code>. Default <code>"viridis"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Whether to show progress information. Mainly when
subsetting data. Default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional theme setting arguments passed to
<code>.complexHeatmapDotPlot</code> and heatmap setting arguments passed to
<code>Heatmap</code>. See Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>...</code>, please notice that arguments <code>colorMat</code>,
<code>sizeMat</code>, <code>featureAnnDF</code>, <code>cellSplitVar</code>, <code>cellLabels</code>
and <code>viridisOption</code> from <code>.complexHeatmapDotPlot</code> are
already occupied by this function internally. A lot of arguments from
<code>Heatmap</code> have also been occupied: <code>matrix,
name, heatmap_legend_param, rect_gp, col, layer_fun, km, border, border_gp,
column_gap, row_gap, cluster_row_slices, cluster_rows, row_title_gp,
row_names_gp, row_split, row_labels, cluster_column_slices, cluster_columns,
column_split, column_title_gp, column_title, column_labels, column_names_gp,
top_annotation</code>.
</p>


<h3>Value</h3>

<p><code>HeatmapList</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">plotClusterFactorDot(pbmcPlot)
</code></pre>


</div>