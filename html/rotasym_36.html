<div class="container">

<table style="width: 100%;"><tr>
<td>vMF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>von Mises–Fisher distribution</h2>

<h3>Description</h3>

<p>Density and simulation of the von Mises–Fisher (vMF)
distribution on
<code class="reqn">S^{p-1}:=\{\mathbf{x}\in R^p:||\mathbf{x}||=1\}</code>, <code class="reqn">p\ge 1</code>. The density at
<code class="reqn">\mathbf{x} \in S^{p-1}</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">c^{\mathrm{vMF}}_{p,\kappa}
e^{\kappa\mathbf{x}' \boldsymbol{\mu}}
\quad\mathrm{with}\quad c^{\mathrm{vMF}}_{p,\kappa}:=
\kappa^{(p-2)/2}/((2\pi)^{p/2} I_{(p-2)/2}(\kappa))</code>
</p>

<p>where <code class="reqn">\boldsymbol{\mu}\in S^{p-1}</code> is the directional
mean, <code class="reqn">\kappa\ge 0</code> is the concentration parameter about
<code class="reqn">\boldsymbol{\mu}</code>, and <code class="reqn">I_\nu</code> is the order-<code class="reqn">\nu</code>
modified Bessel function of the first kind.
</p>
<p>The angular function of the vMF is <code class="reqn">g(t) := e^{\kappa t}</code>. The
associated <em>cosines</em> density is
<code class="reqn">\tilde g(v):= \omega_{p-1} c^{\mathrm{vMF}}_{p,\kappa}
g(v) (1 - v^2)^{(p-3)/2}</code>,
where <code class="reqn">\omega_{p-1}</code> is the surface area of <code class="reqn">S^{p-2}</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d_vMF(x, mu, kappa, log = FALSE)

c_vMF(p, kappa, log = FALSE)

r_vMF(n, mu, kappa)

g_vMF(t, p, kappa, scaled = TRUE, log = FALSE)

r_g_vMF(n, p, kappa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>locations in <code class="reqn">S^{p-1}</code> to evaluate the density. Either a
matrix of size <code>c(nx, p)</code> or a vector of length <code>p</code>. Normalized
internally if required (with a <code>warning</code> message).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>the directional mean <code class="reqn">\boldsymbol{\mu}</code> of the vMF.
A unit-norm vector of length <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>concentration parameter <code class="reqn">\kappa</code> of the vMF.
A nonnegative scalar. Can be a vector for <code>c_vMF</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>flag to indicate if the logarithm of the density (or the
normalizing constant) is to be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>dimension of the ambient space <code class="reqn">R^p</code> that contains
<code class="reqn">S^{p-1}</code>. A positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size, a positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a vector with values in <code class="reqn">[-1, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p>whether to scale the angular function by the von Mises–Fisher
normalizing constant. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>r_g_vMF</code> implements algorithm VM in Wood (1994). <code>c_vMF</code> is
vectorized on <code>p</code> and <code>kappa</code>.
</p>


<h3>Value</h3>

<p>Depending on the function:
</p>

<ul>
<li> <p><code>d_vMF</code>: a vector of length <code>nx</code> or <code>1</code> with the
evaluated density at <code>x</code>.
</p>
</li>
<li> <p><code>r_vMF</code>: a matrix of size <code>c(n, p)</code> with the random sample.
</p>
</li>
<li> <p><code>c_vMF</code>: the normalizing constant.
</p>
</li>
<li> <p><code>g_vMF</code>: a vector of size <code>length(t)</code> with the evaluated
angular function.
</p>
</li>
<li> <p><code>r_g_vMF</code>: a vector of length <code>n</code> containing simulated
values from the cosines density associated to the angular function.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Eduardo García-Portugués, Davy Paindaveine, and Thomas Verdebout.
</p>


<h3>References</h3>

<p>Wood, A. T. A. (1994) Simulation of the von Mises Fisher distribution.
<em>Commun. Stat. Simulat.</em>, 23(1):157–164.
<a href="https://doi.org/10.1080/03610919408813161">doi:10.1080/03610919408813161</a>
</p>


<h3>See Also</h3>

<p><code>tangent-vMF</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulation and density evaluation for p = 2
mu &lt;- c(0, 1)
kappa &lt;- 2
n &lt;- 1e3
x &lt;- r_vMF(n = n, mu = mu, kappa = kappa)
col &lt;- viridisLite::viridis(n)
r &lt;- runif(n, 0.95, 1.05) # Radius perturbation to improve visualization
plot(r * x, pch = 16, col = col[rank(d_vMF(x = x, mu = mu, kappa = kappa))])

# Simulation and density evaluation for p = 3
mu &lt;- c(0, 0, 1)
kappa &lt;- 2
x &lt;- r_vMF(n = n, mu = mu, kappa = kappa)
if (requireNamespace("rgl")) {
  rgl::plot3d(x, col = col[rank(d_vMF(x = x, mu = mu, kappa = kappa))],
              size = 5)
}

# Cosines density
g_tilde &lt;- function(t, p, kappa) {
  exp(w_p(p = p - 1, log = TRUE) +
        g_vMF(t = t, p = p, kappa = kappa, scaled = TRUE, log = TRUE) +
        ((p - 3) / 2) * log(1 - t^2))
}

# Simulated data from the cosines density
n &lt;- 1e3
p &lt;- 3
kappa &lt;- 2
hist(r_g_vMF(n = n, p = p, kappa = kappa), breaks = seq(-1, 1, l = 20),
     probability = TRUE, main = "Simulated data from g_vMF", xlab = "t")
t &lt;- seq(-1, 1, by = 0.01)
lines(t, g_tilde(t = t, p = p, kappa = kappa))

# Cosine density as a function of the dimension
M &lt;- 100
col &lt;- viridisLite::viridis(M)
plot(t, g_tilde(t = t, p = 2, kappa = kappa), col = col[2], type = "l",
     ylab = "Density")
for (p in 3:M) {
  lines(t, g_tilde(t = t, p = p, kappa = kappa), col = col[p])
}
</code></pre>


</div>