<div class="container">

<table style="width: 100%;"><tr>
<td>lsa.bench</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute percentages of respondents reaching or surpassing certain ability cut-off scores</h2>

<h3>Description</h3>

<p><code>lsa.bench</code> computes percentages of respondents reaching or surpassing certain ability cut-off scores (benchmarks/performance levels). The cut-off scores are points in the distributions of PVs defined differently in different studies and, sometimes, in different study cycles. The percentages can also be computed as cumulative percentages. There is an option to compute an average of continuous contextual/background variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lsa.bench(
  data.file,
  data.object,
  split.vars,
  PV.root.bench,
  bench.vals,
  bench.type,
  pcts.within = FALSE,
  bckg.var,
  weight.var,
  include.missing = FALSE,
  shortcut = FALSE,
  graphs = FALSE,
  perc.x.label = NULL,
  perc.y.label = NULL,
  mean.x.label = NULL,
  mean.y.label = NULL,
  save.output = TRUE,
  output.file,
  open.output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.file</code></td>
<td>
<p>The file containing <code>lsa.data</code> object. Either this or <code>data.object</code>
shall be specified, but not both. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.object</code></td>
<td>
<p>The object in the memory containing <code>lsa.data</code> object. Either this
or <code>data.file</code> shall be specified, but not both. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.vars</code></td>
<td>
<p>Categorical variable(s) to split the results by. If no split variables are
provided, the results will be for the overall countries' populations. If
one or more variables are provided, the results will be split by all but
the last variable and the percentages of respondents will be computed by
the unique values of the last splitting variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PV.root.bench</code></td>
<td>
<p>The root name(s) for the set(s) of plausible values which will be used
to compute the percentages of respondents reaching or surpassing certain
cut-off score. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bench.vals</code></td>
<td>
<p>A vector of integers representing the cut-off scores. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bench.type</code></td>
<td>
<p>A character string representing how the percentages of respondents shall
be computed. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcts.within</code></td>
<td>
<p>Logical value specifying if the percentages shall be computed within the
groups defined by the <code>split.vars</code> (<code>TRUE</code>) or not (<code>FALSE</code>,
default). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bckg.var</code></td>
<td>
<p>Name of a continuous background or contextual variable to compute the
mean for. The results will be computed by all groups specified by the
splitting variables and per performance group. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight.var</code></td>
<td>
<p>The name of the variable containing the weights. If no name of a weight
variable is provide, the function will automatically select the default
weight variable for the provided data, depending on the respondent type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.missing</code></td>
<td>
<p>Logical, shall the missing values of the splitting variables be included
as categories to split by and all statistics produced for them? The
default (<code>FALSE</code>) takes all cases on the splitting variables
without missing values before computing any statistics. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shortcut</code></td>
<td>
<p>Logical, shall the "shortcut" method for IEA TIMSS, TIMSS Advanced,
TIMSS Numeracy, eTIMSS PSI, PIRLS, ePIRLS, PIRLS Literacy and RLII be
applied? The default (<code>FALSE</code>) applies the "full" design when
computing the variance components and the standard errors of the
estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graphs</code></td>
<td>
<p>Logical, shall graphs be produced? Default is <code>FALSE</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc.x.label</code></td>
<td>
<p>String, custom label for the horizontal axis in percentage graphs.
Ignored if <code>graphs = FALSE</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc.y.label</code></td>
<td>
<p>String, custom label for the vertical axis in percentage graphs.
Ignored if <code>graphs = FALSE</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.x.label</code></td>
<td>
<p>List of strings, custom labels for the horizontal axis in means' graphs.
Ignored if <code>bckg.var</code> is omitted and/or <code>graphs = FALSE</code>.
See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.y.label</code></td>
<td>
<p>List of strings, custom labels for the vertical axis in means' graphs.
Ignored if <code>bckg.var</code> is omitted and/or <code>graphs = FALSE</code>.
See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.output</code></td>
<td>
<p>Logical, shall the output be saved in MS Excel file (default) or not
(printed to the console or assigned to an object).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.file</code></td>
<td>
<p>If <code>save.output = TRUE</code> (default), full path to the output file
including the file name. If omitted, a file with a default file name
"Analysis.xlsx" will be written to the working directory (<code>getwd()</code>).
Ignored if <code>save.output = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>open.output</code></td>
<td>
<p>Logical, shall the output be open after it has been written? The default
(<code>TRUE</code>) opens the output in the default spreadsheet program installed
on the computer. Ignored if <code>save.output = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Either <code>data.file</code> or <code>data.object</code> shall be provided as source of data. If both of them are provided, the function will stop with an error message.
</p>
<p>The function computes percentages of respondents which reach or surpass certain cut-off scores (benchmarks/performance levels). These percentages are computed using a set of PVs, specified in the <code>PV.root.bench</code>. Only one set of PVs can be added to <code>PV.root.bench</code> at a time. All studies (except CivED, TEDS-M, SITES, TALIS and TALIS Starting Strong Survey) have a set of PVs per content domain (e.g. in TIMSS five for overall mathematics, five for algebra, five for geometry, etc.) and cognitive domain (i.e. knowing, applying and reasoning). In some studies (say TIMSS and PIRLS) the names of the PVs in a set always start with character string and end with sequential number of the PV. For example, the names of the set of PVs for overall mathematics in TIMSS are BSMMAT01, BSMMAT02, BSMMAT03, BSMMAT04 and BSMMAT05. The root of the PVs for this set to be added to <code>PV.root.avg</code> will be "BSMMAT". The function will automatically find all the variables in this set of PVs and include them in the analysis. In other studies like OECD PISA and IEA ICCS and ICILS the sequential number of each PV is included in the middle of the name. For example, in ICCS the names of the set of PVs are PV1CIV, PV2CIV, PV3CIV, PV4CIV and PV5CIV. The root PV name has to be specified in <code>PV.root.bench</code> as "PV#CIV".
</p>
<p>Multiple splitting variables can be added to the <code>split.vars</code>, the function will compute the percentages of respondents reaching or surpassing the cut-off scores for all formed groups and their means on the continuous variables. If no splitting variables are added, the results will be only by country.
</p>
<p>If a continuous contextual/background variable is provided to the <code>bckg.var</code>, the average for that variable will be computed for each group formed by the splitting variables and the performance groups. Only one contextual/background variable can be added in the analysis. This argument is ignored when <code>bench.type = "cumulative"</code>.
</p>
<p>The cut-off scores are provided as vector of integers (e.g. <code>c(475, 500)</code>) to the <code>bench.vals</code>. If no cut-off scores are provided, the function will automatically choose all benchmark values for the corresponding study and, in some cases for the data from the specific cycle. The latter applies to ICCS and PISA where the proficiency levels differ from one cycle to another.
</p>
<p>The <code>bench.type</code> argument has two different options: <code>"discrete"</code> (default) and <code>"cumulative"</code>. Using the former will compute the percentages of respondents within the boundaries specified by the cut-off scores in <code>bench.vals</code>. Using the latter, the function will compute the percentages of respondents at or above the cut-off points in the <code>bench.vals</code>.
</p>
<p>If the <code>pcts.within</code> if <code>FALSE</code> (default), the function will compute the percentages of respondents reaching or surpassing each of the cut-off scores defined by <code>bench.vals</code>. In this case the percentages of all respondents across the performance levels will add to 100 in each group defined by the splitting variables. On the contrary, if <code>pcts.within = TRUE</code>, the function will compute the percentages of respondents at each of the performance levels across groups defined by the splitting variables. Then the sum of percentages within a specific performance level will sum up to 100 across the groups defined by the splitting variables. For example, we can compute what is the ratio (i.e. percentages) of female and male students performing between 475 and 550 points in PIRLS – say 55 of all students performing at this level are female and 45 are male. If no split variables are provided, the percentages will be 100 for each performance level within a country. The argument is ignored if <code>bench.type = "cumulative"</code>.
</p>
<p>If no variables are specified for <code>bckg.var</code>, the output will contain only percentages of cases in groups specified by the splitting variables and the cut-off scores.
</p>
<p>If <code>include.missing = FALSE</code> (default), all cases with missing values on the splitting variables will be removed and only cases with valid values will be retained in the statistics. Note that the data from the studies can be exported in two different ways: (1) setting all user-defined missing values to <code>NA</code>; and (2) importing all user-defined missing values as valid ones and adding their codes in an additional attribute to each variable. If the <code>include.missing</code> is set to <code>FALSE</code> (default) and the data used is exported using option (2), the output will remove all values from the variable matching the values in its <code>missings</code> attribute. Otherwise, it will include them as valid values and compute statistics for them.
</p>
<p>The <code>shortcut</code> argument is valid only for TIMSS, eTIMSS PSI, TIMSS Numeracy, TIMSS Advanced, PIRLS, ePIRLS, PIRLS Literacy and RLII. Previously, in computing the standard errors, these studies were using 75 replicates because one of the schools in the 75 JK zones had its weights doubled and the other one has been taken out. Since TIMSS 2015 and PIRLS 2016 the studies use 150 replicates and in each JK zone once a school has its weights doubled and once taken out, i.e. the computations are done twice for each zone. For more details see Foy &amp; LaRoche (2016) and Foy &amp; LaRoche (2017). If replication of the tables and figures is needed, the <code>shortcut</code> argument has to be changed to <code>TRUE</code>.
</p>
<p>If <code>graphs = TRUE</code>, the function will produce graphs. If <code>split.vars</code> are specified, bar plots of percentages of respondents (population estimates) reaching or surpassing each benchmark level specified in <code>bench.vals</code> per group specified by <code>split.vars</code> will be produced with error bars (95% confidence) for these percentages. If <code>bckg.var</code> is specified, plots with 95% confidence intervals of the average for this variable will be produced. All plots are produced per country. By default the percentage graphs horizontal axis is labeled as "Performance Group", and the vertical is labeled as "Percentages XXXXX" where XXXXX is the root name of the set of PVs percentages within performance group are computed for. If <code>bckg.var</code> is provide to compute means for, the means plots' horizontal axis is labeled as "Performance Group", and the vertical axis is labeled as "Mean XXXXX" where XXXXX is the name of the variable for which means are computed for each performance group. These defaults can be overriden by supplying values to <code>perc.x.label</code>, <code>perc.y.label</code>, <code>mean.x.label</code> and <code>mean.y.label</code>. The <code>perc.x.label</code>, <code>perc.y.label</code>, <code>mean.x.label</code> and <code>mean.y.label</code> arguments accept vectors of length 1, and if longer vectors are supplied, error is thrown. See the examples.
</p>


<h3>Value</h3>

<p>If <code>save.output = FALSE</code>, a list containing the estimates and analysis information. If <code>graphs = TRUE</code>, the plots will be added to the list of estimates.
</p>
<p>If <code>save.output = TRUE</code> (default), an MS Excel (<code>.xlsx</code>) file (which can be opened in any spreadsheet program), as specified with the full path in the <code>output.file</code>. If the argument is missing, an Excel file with the generic file name "Analysis.xlsx" will be saved in the working directory (<code>getwd()</code>). The workbook contains three spreadsheets. The first one ("Estimates") contains a table with the results by country and the final part of the table contains averaged results from all countries' statistics. The following columns can be found in the table, depending on the specification of the analysis:
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠&lt;⁠</code>Country ID<code style="white-space: pre;">⁠&gt;⁠</code> - a column containing the names of the countries in the file for which statistics are computed. The exact column header will depend on the country identifier used in the particular study.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠&lt;⁠</code>Split variable 1<code style="white-space: pre;">⁠&gt;⁠</code>, <code style="white-space: pre;">⁠&lt;⁠</code>Split variable 2<code style="white-space: pre;">⁠&gt;⁠</code>... - columns containing the categories by which the statistics were split by. The exact names will depend on the variables in <code>split.vars</code>.
</p>
</li>
<li>
<p> n_Cases - the number of cases reaching or surpassing each of the benchmarks using a set of PVs. Please note that these may not be whole numbers because they are computed using each PV and then averaged.
</p>
</li>
<li>
<p> Sum_<code style="white-space: pre;">⁠&lt;⁠</code>Weight variable<code style="white-space: pre;">⁠&gt;⁠</code> - the estimated population number of elements per group after applying the weights. The actual name of the weight variable will depend on the weight variable used in the analysis.
</p>
</li>
<li>
<p> Sum_<code style="white-space: pre;">⁠&lt;⁠</code>Weight variable<code style="white-space: pre;">⁠&gt;⁠</code><code style="white-space: pre;">⁠_⁠</code>SE - the standard error of the the estimated population number of elements per group. The actual name of the weight variable will depend on the weight variable used in the analysis.
</p>
</li>
<li>
<p> Performance_Group - the labels for the performance groups defined by the <code>bench.vals</code>.
</p>
</li>
<li>
<p> Percentages_<code style="white-space: pre;">⁠&lt;⁠</code>PVs' root name<code style="white-space: pre;">⁠&gt;⁠</code> - the percentages of respondents (population estimates) reaching or surpassing each cut-off score (in case of <code>bench.type = "discrete"</code>) or the the percentages of respondents (population estimates) at or above each cut-off value (in case of <code>bench.type = "cumulative"</code>) per groups defined by the splitting variables in <code>split.vars</code>.
</p>
</li>
<li>
<p> Percentages_<code style="white-space: pre;">⁠&lt;⁠</code>PVs' root name<code style="white-space: pre;">⁠&gt;⁠</code><code style="white-space: pre;">⁠_⁠</code>SE - the standard errors of the percentages from above.
</p>
</li>
<li>
<p> Mean_<code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> - the average of the continuous <code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> specified in <code>bckg.var</code>.
</p>
</li>
<li>
<p> Mean_<code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code><code style="white-space: pre;">⁠_⁠</code>SE - the standard error of the average of the continuous <code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> specified in <code>bckg.var</code>.
</p>
</li>
<li>
<p> Variance_<code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> - the variance for the continuous <code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> specified in <code>bckg.var</code>.
</p>
</li>
<li>
<p> Variance_<code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code><code style="white-space: pre;">⁠_⁠</code>SE - the error of the variance for the continuous <code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> specified in <code>bckg.var</code>.
</p>
</li>
<li>
<p> SD_<code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> - the standard deviation for the continuous <code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> specified in <code>bckg.var</code>.
</p>
</li>
<li>
<p> SD_<code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code><code style="white-space: pre;">⁠_⁠</code>SE - the error of the standard deviation for the continuous <code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> specified in <code>bckg.avg.var</code>.
</p>
</li>
<li>
<p> Percent_Missings_<code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> - the percentage of missing values for the <code style="white-space: pre;">⁠&lt;⁠</code>Background variable<code style="white-space: pre;">⁠&gt;⁠</code> specified in <code>bckg.var</code>.
</p>
</li>
</ul>
<p>The second sheet contains some additional information related to the analysis per country in columns:
</p>

<ul>
<li>
<p> DATA - used <code>data.file</code> or <code>data.object</code>.
</p>
</li>
<li>
<p> STUDY - which study the data comes from.
</p>
</li>
<li>
<p> CYCLE - which cycle of the study the data comes from.
</p>
</li>
<li>
<p> WEIGHT - which weight variable was used.
</p>
</li>
<li>
<p> DESIGN - which resampling technique was used (JRR or BRR).
</p>
</li>
<li>
<p> SHORTCUT - logical, whether the shortcut method was used.
</p>
</li>
<li>
<p> NREPS - how many replication weights were used.
</p>
</li>
<li>
<p> ANALYSIS_DATE - on which date the analysis was performed.
</p>
</li>
<li>
<p> START_TIME - at what time the analysis started.
</p>
</li>
<li>
<p> END_TIME - at what time the analysis finished.
</p>
</li>
<li>
<p> DURATION - how long the analysis took in hours, minutes, seconds and milliseconds.
</p>
</li>
</ul>
<p>The third sheet contains the call to the function with values for all parameters as it was executed. This is useful if the analysis needs to be replicated later.
</p>
<p>If <code>graphs = TRUE</code> there will be an additional "Graphs" sheet containing all plots.
</p>
<p>If any warnings resulting from the computations are issued, these will be included in an additional "Warnings" sheet in the workbook as well.
</p>


<h3>References</h3>

<p>LaRoche, S., Joncas, M., &amp; Foy, P. (2016). Sample Design in TIMSS 2015. In M. O. Martin, I. V. S. Mullis, &amp; M. Hooper (Eds.), <em>Methods and Procedures in TIMSS 2015</em> (pp. 3.1-3.37). Chestnut Hill, MA: TIMSS &amp; PIRLS International Study Center.
</p>
<p>LaRoche, S., Joncas, M., &amp; Foy, P. (2017). Sample Design in PIRLS 2016. In M. O. Martin, I. V. S. Mullis, &amp; M. Hooper (Eds.), <em>Methods and Procedures in PIRLS 2016</em> (pp. 3.1-3.34). Chestnut Hill, MA: Lynch School of Education, Boston College.
</p>


<h3>See Also</h3>

<p><code>lsa.convert.data</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compute percentages of female and male students reaching or surpassing the "Intermediate"
# and "High" benchamrks in TIMSS 2015 grade 8 mathematics using data file, omit missing from
# the splitting variable (female and male as answered by the students), without shortcut, and
# open the output after the computations are done
## Not run: 
lsa.bench(data.file = "C:/Data/TIMSS_2015_G8_Student_Miss_to_NA.RData", split.vars = "BSBG01",
include.missing = FALSE, PV.root.bench = "BSMMAT", bench.vals = c(475, 550),
output.file = "C:/temp/test.xlsx", open.output = TRUE)

## End(Not run)

# Repeat the analysis from above, using an object loaded in the memory, the student senate
# weight and compute the cumulative percentage, adding student feeling safe at school as a
# second splitting variable, using the shortcut method and including the missing values of
# the splitting variables
## Not run: 
lsa.bench(data.object = T15_G8_student_data, split.vars = c("BSBG01", "BSBG15B"),
PV.root.bench = "BSMMAT", bench.vals = c(475, 550), weight.var = "SENWGT",
include.missing = TRUE, shortcut = TRUE, output.file = "C:/temp/test.xlsx",
open.output = TRUE)

## End(Not run)

# Compute the percentage of students reaching or surpassing the "Level 2" and "Level 3"
# in computer and information lteracy and the average of the complex background scale
# "Use of specialist applications for activities" by student sex and expected further
# level of education using ICILS 2018 data loaded in memory, include the missing values
# in the splitting variables
## Not run: 
lsa.bench(data.object = ICILS_2018_student_data, split.vars = c("S_SEX", "IS2G03"),
PV.root.bench = "PV#CIL", bckg.var = "S_SPECACT", include.missing = TRUE,
output.file = "C:/temp/test.xlsx", open.output = TRUE)

## End(Not run)

# Same as above, this time adding graphs with custom x-axis and y-axis labels
## Not run: 
lsa.bench(data.object = ICILS_2018_student_data, split.vars = c("S_SEX", "IS2G03"),
PV.root.bench = "PV#CIL", bckg.var = "S_SPECACT",
graphs = TRUE, perc.x.label = "Percentages of students", perc.y.label = "Benchmark groups",
mean.x.label = "Performance groups", mean.y.label = "Average of using specialist apps scale",
include.missing = TRUE,
output.file = "C:/temp/test.xlsx", open.output = TRUE)

## End(Not run)

# Compute the cumulative percentage of students at or above each of the (default) benchmarks
# of student overall reading achievement scores using PIRLS 2016 student data file, split the
# output by student sex, use the full design, include the missing values of the splitting
# variable (i.e. student sex), and do not open the output after the computations are finished
## Not run: 
lsa.bench(data.file = "C:/Data/PIRLS_2016_Student_Miss_to_NA.RData", split.vars = "ASBG01",
PV.root.bench = "ASRREA", bench.type = "cumulative", include.missing = TRUE,
output.file = "C:/temp/test.xlsx", open.output = FALSE)

## End(Not run)

</code></pre>


</div>