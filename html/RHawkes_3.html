<div class="container">

<table style="width: 100%;"><tr>
<td>EM1partial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Partial EM algorithm for the RHawkes process, version 1
</h2>

<h3>Description</h3>

<p>Calculates the RHawkes model parameters via a partial Expectation-Maximization 
(EM1) algorithm of Wheatley, Filimonov and Sornette (2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">EM1partial(tms, cens, pars, maxiter = 1000, tol = 1e-8,
         h.fn = function(x, p) dexp(x, rate = 1 / p),
         mu.fn = function(x, p){
              exp(dweibull(x, shape = p[1], scale = p[2], log = TRUE) -
              pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE))
         },
         H.fn = function(x, p) pexp(x, rate = 1 / p),
         logg.fn = function(x, p){
              dweibull(x, shape = p[1], scale = p[2], log = TRUE) -
              pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE) 
              - (x / p[2])^p[1]},
         Mu.fn = function(x, p){
              - pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE)
         })
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tms</code></td>
<td>

<p>A numeric vector, with values sorted in ascending order. Event times
to fit the RHawkes point process model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>

<p>A numeric vector containing the parameters of the model, in order of the 
immigration parameters <code class="reqn">\mu(.)</code>, offspring parameters <code class="reqn">h(.)</code> and 
lastly the branching ratio <code class="reqn">\eta(.)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>The maximum number of iterations to perform.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>The algorithm stops when the difference between the previous iteration and 
current iteration parameters sum is less than <code>tol</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.fn</code></td>
<td>

<p>A (vectorized) function. The immigration hazard function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the offspring density function from 0 to <code>t</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the immigrant hazard function from 0 to <code>t</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logg.fn</code></td>
<td>

<p>A (vectorized) function. The log of the immigrant distribution function.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>The number of iterations until convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>The absolute sum of the difference between the final two 
parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>The parameter estimates from the EM algorithm</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Feng Chen &lt;feng.chen@unsw.edu.au&gt;
Tom Stindl &lt;t.stindl@unsw.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## simulated data
tms &lt;- sort(runif(100,0,100))
## the slower version of the EM algorithms on simulated data with default 
## immigrant hazard function
## and offspring density
system.time( est1 &lt;- EM1partial(tms, 101, c(2,1,0.5,1)) )

## End(Not run)
</code></pre>


</div>