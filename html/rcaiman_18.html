<div class="container">

<table style="width: 100%;"><tr>
<td>extract_dn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract digital numbers</h2>

<h3>Description</h3>

<p>Wrapper function around <code>terra::extract()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extract_dn(r, img_points, use_window = TRUE, fun = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>SpatRaster. A fish-eye image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>img_points</code></td>
<td>
<p>The result of a call to <code>extract_sky_points()</code>,
or an object of the same class and structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_window</code></td>
<td>
<p>Logical vector of length one. If <code>TRUE</code>, a <code class="reqn">3
 \times 3</code> window will be used to extract the digital number from
<code>r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>A <code>function</code> that takes a vector as input and returns a
one-length numeric or logical vector as output (e.g. mean).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of the class <em>data.frame</em>. It is the argument
<code>img_points</code> with an added column per each layer from <code>r</code>. The
layer names are used to name the new columns. If a function is provided as
the <code>fun</code> argument, the result will be summarized per column using the
provided function, and the <em>row</em> and <em>col</em> information will be
omitted. Moreover, if <code>r</code> is an RGB image, a color will
be returned instead of a <em>data.frame</em>. The latter feature is useful
for obtaining  the <code>sky_blue</code> argument for <code>enhance_caim()</code>.
</p>


<h3>Note</h3>

<p>The <a href="https://imagej.net/ij/docs/guide/146-19.html#sec:Multi-point-Tool">point selection tool of ‘ImageJ’ software</a>
can be used to manually digitize points and create a CSV file from which to read
coordinates (see Examples). After digitizing the points on the image, use the
dropdown menu Analyze&gt;Measure to open the Results window. To obtain the CSV
file, use File&gt;Save As...
</p>


<h3>See Also</h3>

<p>Other Tool Functions: 
<code>colorfulness()</code>,
<code>correct_vignetting()</code>,
<code>defuzzify()</code>,
<code>extract_feature()</code>,
<code>extract_rl()</code>,
<code>extract_sky_points_simple()</code>,
<code>extract_sky_points()</code>,
<code>extract_sun_coord()</code>,
<code>find_sky_pixels_nonnull()</code>,
<code>find_sky_pixels()</code>,
<code>masking()</code>,
<code>optim_normalize()</code>,
<code>percentage_of_clipped_highlights()</code>,
<code>read_bin()</code>,
<code>read_caim_raw()</code>,
<code>read_caim()</code>,
<code>write_bin()</code>,
<code>write_caim()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
caim &lt;- read_caim()
r &lt;- caim$Blue
bin &lt;- apply_thr(r, thr_isodata(r[]))
z &lt;- zenith_image(ncol(caim), lens())
a &lt;- azimuth_image(z)
g &lt;- sky_grid_segmentation(z, a, 10)
sky_points &lt;- extract_sky_points(r, bin, g)
sky_points &lt;- extract_dn(caim, sky_points)
head(sky_points)

# ImageJ can be used to digitize points
path &lt;- system.file("external/sky_points.csv",
                    package = "rcaiman")
sky_points &lt;- read.csv(path)
sky_points &lt;- sky_points[c("Y", "X")]
colnames(sky_points) &lt;- c("row", "col")
head(sky_points)
plot(bin)
points(sky_points$col, nrow(caim) - sky_points$row, col = 2, pch = 10)
extract_dn(caim, sky_points, fun = median)

## End(Not run)
</code></pre>


</div>