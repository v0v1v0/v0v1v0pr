<div class="container">

<table style="width: 100%;"><tr>
<td>gof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate goodness-of-fit statistics for Revealed Preference Matchings Model based on observed data</h2>

<h3>Description</h3>

<p><code>gof.rpm</code> ...
It is typically based on the estimate from a <code>rpm()</code> call.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gof(object, ...)

## S3 method for class 'rpm'
gof(
  object,
  ...,
  empirical_p = TRUE,
  compare_sim = "sim-est",
  control = object$control,
  reboot = FALSE,
  verbose = FALSE
)

## S3 method for class 'gofrpm'
plot(x, ..., cex.axis = 0.7, main = "Goodness-of-fit diagnostics")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>list; an object of class<code>rpm</code> that is typically the result of a call to <code>rpm()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments, to be passed to lower-level functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical_p</code></td>
<td>
<p>logical; (Optional) If TRUE the function returns the empirical p-value of the sample
statistic based on <code>nsim</code> simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compare_sim</code></td>
<td>
<p>string; describes which two objects are compared to compute simulated goodness-of-fit
statistics; valid values are <code>"sim-est"</code>: compares the marginal distribution of pairings in a
simulated sample to the <code>rpm</code> model estimate of the marginal distribution based on that same simulated sample;
<code>mod-est</code>: compares the marginal distribution of pairings in a
simulated sample to the <code>rpm</code> model estimate used to generate the sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control parameters for algorithm tuning. Constructed using
<code>control.rpm</code>, which should be consulted for specifics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reboot</code></td>
<td>
<p>logical; if this is <code>TRUE</code>, the program will rerun the bootstrap at the coefficient values, rather than 
expect the object to contain a <code>bs.results</code> component with the bootstrap results run at the solution values.
The latter is the default for <code>rpm</code> fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if this is <code>TRUE</code>, the program will print out
additional information, including data summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list, usually an object of class gofrpm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>the magnification of the text used in axis notation;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Title for the goodness-of-fit plots.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>rpm</code> is used to fit a revealed preference model
for men and women of certain
characteristics (or shared characteristics) of people of the opposite sex.
The model assumes a one-to-one stable matching using an observed set of
matchings and a set of (possibly dyadic) covariates to 
estimate the parameters for
linear equations of utilities.
It does this using an large-population likelihood based on ideas from Dagsvik (2000), Menzel (2015) and Goyal et al (2023).
</p>
<p>The model represents the dyadic utility functions as deterministic linear utility functions of
dyadic variables. These utility functions are functions of observed characteristics of the women
and men.
These functions are entered as terms in the function call
to <code>rpm</code>. This function simulates from such a model.
</p>


<h3>Value</h3>

<p><code>gof.rpm</code> returns a list consisting of the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>observed_pmf</code></td>
<td>
<p>numeric matrix giving observed probability mass distribution over different household types</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_pmf</code></td>
<td>
<p>numeric matrix giving expected probability mass distribution from <code>rpm</code> model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_chi_sq</code></td>
<td>
<p>the count-based observed chi-square statistic comparing marginal distributions of the population
the data and the model estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_chi_sq_cell</code></td>
<td>
<p>the contribution to the observed chi-squared statistic by household type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_kl</code></td>
<td>
<p>the Kullback-Leibler (KL) divergence computed by comparing the observed marginal distributions to the
expected marginal distribution based on the <code>rpm</code> model estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_kl_cell</code></td>
<td>
<p>the contribution to the observed KL divergence by household type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical_p_chi_sq</code></td>
<td>
<p>the proportion of simulated chi-square statistics that are greater than
or equal to the observed chi-square statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical_p_kl</code></td>
<td>
<p>the proportion of simulated KL divergences that are greater than
or equal to the observed KL divergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi_sq_simulated</code></td>
<td>
<p>vector of size <code>nsim</code> storing all simulated chi-square statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kl_simulated</code></td>
<td>
<p>vector of size <code>nsim</code> storing all simulated KL divergences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi_sq_cell_mean</code></td>
<td>
<p>Mean contributions of each household type to the simulated chi_sq statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi_sq_cell_sd</code></td>
<td>
<p>Standard deviation of the contributions of each household type to the simulated chi_sq statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi_sq_cell_median</code></td>
<td>
<p>Median contributions of each household type to the simulated chi_sq statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi_sq_cell_iqr</code></td>
<td>
<p>Interquartile range of the contributions of each household type to the simulated chi_sq statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kl_cell_mean</code></td>
<td>
<p>Mean contributions of each household type to the simulated KL divergences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kl_cell_sd</code></td>
<td>
<p>Standard deviation of the contributions of each household type to the simulated KL divergencesc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kl_cell_median</code></td>
<td>
<p>Median contributions of each household type to the simulated KL divergences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kl_cell_iqr</code></td>
<td>
<p>Interquartile range of the contributions of each household type to the simulated KL divergences</p>
</td>
</tr>
</table>
<h3>Methods (by class)</h3>


<ul><li> <p><code>gof(rpm)</code>: Calculate goodness-of-fit statistics for Revealed Preference Matchings Model based on observed data
</p>
</li></ul>
<h3>Functions</h3>


<ul><li> <p><code>plot(gofrpm)</code>: <code>plot.gofrpm</code> plots diagnostics such empirical p-value
based on chi-square statistics and KL divergences.
See <code>rpm</code> for more information on these models.
</p>
</li></ul>
<h3>References</h3>

<p>Goyal, Shuchi; Handcock, Mark S.; Jackson, Heide M.; Rendall, Michael S. and Yeung, Fiona C. (2023).
<em>A Practical Revealed Preference Model for Separating Preferences and Availability Effects in Marriage Formation</em>,
<em>Journal of the Royal Statistical Society</em>, A. <a href="https://doi.org/10.1093/jrsssa/qnad031">doi:10.1093/jrsssa/qnad031</a> 
</p>
<p>Dagsvik, John K. (2000) <em>Aggregation in Matching Markets</em> <em>International Economic Review</em>,, Vol. 41, 27-57.
JSTOR: https://www.jstor.org/stable/2648822, <a href="https://doi.org/10.1111/1468-2354.00054">doi:10.1111/1468-2354.00054</a>
</p>
<p>Menzel, Konrad (2015).
<em>Large Matching Markets as Two-Sided Demand Systems</em>
Econometrica, Vol. 83, No. 3 (May, 2015), 897-941. <a href="https://doi.org/10.3982/ECTA12299">doi:10.3982/ECTA12299</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(rpm)

data(fauxmatching)
fit &lt;- rpm(~match("edu") + WtoM_diff("edu",3),
          Xdata=fauxmatching$Xdata, Zdata=fauxmatching$Zdata,
          X_w="X_w", Z_w="Z_w",
          pair_w="pair_w", pair_id="pair_id", Xid="pid", Zid="pid",
          sampled="sampled")
a &lt;- gof(fit)

</code></pre>


</div>