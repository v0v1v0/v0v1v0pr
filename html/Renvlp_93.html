<div class="container">

<table style="width: 100%;"><tr>
<td>u.felmKL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the envelope dimensions in the functional envelope linear model</h2>

<h3>Description</h3>

<p>Fit the dimensions of the response and predictor envelopes in function-on-function linear regression, under Karhunen-Loeve expansion based estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  u.felmKL(X, Y, t1, t2, knots = c(0, 0.25, 0.5, 0.75, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Predictor function. An n by T1 matrix, T1 is number of observed time points, which is the length of t1.  Here we assume that each function is observed at the same time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response function. An n by T2 matrix, T2 is number of observed time points, which is the length of t2.  Here we assume that each function is observed at the same time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>The observed time points for the predictor functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>
<p>The observed time points for the response functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>The location of knots of the cubic splines used for estimation.  Locations should be positive. The default location of the knots are 0, 0.25, 0.5, 0.75, 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function finds the dimension of the predictor and response envelope model by Bayesian information criterion (BIC) performed on the Karhunen-Lo'eve expansion based estimation.  To be more specific, consider the envelope model to the function-on-function linear regression, </p>
<p style="text-align: center;"><code class="reqn">
 Y = \alpha + B X + \epsilon, 
 </code>
</p>

<p>where X and Y are random functions in Hilbert spaces <code class="reqn">H_X</code> and <code class="reqn">H_Y</code>, <code class="reqn">\alpha</code> is a fixed member in <code class="reqn">H_Y</code>, <code class="reqn">\epsilon</code> is a random member of <code class="reqn">H_Y</code>, and B: <code class="reqn">H_X -&gt; H_Y</code> is a linear operator.  We use cubic splines as the basis for both <code class="reqn">H_X</code> and <code class="reqn">H_Y</code> in the estimation of the eigenfunctions of <code class="reqn">Sigma_X</code> and <code class="reqn">Sigma_\epsilon</code>. The coefficients <code class="reqn">[X]</code> and <code class="reqn">[Y]</code> with respect to the estimated eigenfunctions are computed.  The predictor and response envelope model is fitted on the linear regression model of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>, and the dimensions of the predictor and response envelopes are calculated using BIC. The details are included in Section 7 of Su et al. (2022).  
</p>


<h3>Value</h3>

<p>The output is a list that contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ux</code></td>
<td>
<p>The estimated dimension of the predictor envelope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uy</code></td>
<td>
<p>The estimated dimension of the response envelope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The envelope estimator of the regression coefficients in the regression of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>, when the dimensions of envelopes are taken at their estimated values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betafull</code></td>
<td>
<p>The standard estimator, i.e., the OLS estimator of the regression coefficients in the regression of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The envelope estimator of the intercept in the regression of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>, when the dimensions of envelopes are taken at their estimated values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphafull</code></td>
<td>
<p>The standard estimator of the intercept in the regression of <code class="reqn">[Y]</code> on <code class="reqn">[X]</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Su, Z., Li, B. and Cook, R. D. (2022+) Envelope model for function-on-function linear regression.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(NJdata)
  dataX &lt;- matrix(NJdata[,6], nrow = 21)
  X &lt;- as.matrix(dataX[, 32:61])
  dataY &lt;- matrix(NJdata[,3], nrow = 21)
  Y &lt;- as.matrix(dataY[, 32:61])
  t1 &lt;- 0:29
  t2 &lt;- t1
  
  ## Not run: m &lt;- u.felmKL(X, Y, t1, t2)
  ## Not run: m$ux
  ## Not run: m$uy
</code></pre>


</div>