<div class="container">

<table style="width: 100%;"><tr>
<td>get.comb.shift</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Combinations of shifts of diversification.
</h2>

<h3>Description</h3>

<p>Provides all the combinations of nodes of a phylogeny where shifts of diversification can be tested.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  get.comb.shift(phylo, data, sampling.fractions,
                 clade.size = 5, Ncores = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data.frame containing a database of monophyletic groups for which potential shifts can be tested. This database should be based on taxonomy, ecology or traits and must contain a column named "Species" with species names as in phylo.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling.fractions</code></td>
<td>

<p>the output resulting from get.sampling.fractions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clade.size</code></td>
<td>

<p>numeric. Define the minimum number of species in a subgroup. Default is 5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ncores</code></td>
<td>

<p>numeric. Define the number of CPU cores to use for parallelizing the computation of combinations.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>clade.size argument should be the same value for the whole procedure (same that for get.sampling.fraction and shift.estimates).
</p>


<h3>Value</h3>

<p>a vector of character summaryzing the combination of shifts as a concatenation of node IDs separated by "." or "/". Node IDs at the left of "/" correspond to shifts at the origin of subclades (monophyletic and ultrametric subtrees) while node IDs at the right of "/" correspond to shifts at the origin of backbone(s) (pruned trees).
</p>


<h3>Author(s)</h3>

<p>Nathan Mazet</p>


<h3>References</h3>

<p>Mazet, N., Morlon, H., Fabre, P., Condamine, F.L., (2023). Estimating clade‐specific diversification rates and palaeodiversity dynamics from reconstructed phylogenies. <em>Methods in Ecology and in Evolution</em> 14, 2575–2591. https://doi.org/10.1111/2041-210X.14195
</p>


<h3>See Also</h3>

<p><code>get.sampling.fractions</code>, <code>shift.estimates</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# loading data
data("Cetacea")
data("taxo_cetacea")

# no shifts tested at genus level
taxo_cetacea_no_genus &lt;- taxo_cetacea[names(taxo_cetacea) != "Genus"]

f_cetacea &lt;- get.sampling.fractions(phylo = Cetacea,
                                    data = taxo_cetacea_no_genus)

comb.shift_cetacea &lt;- get.comb.shift(phylo = Cetacea,
                                     data = taxo_cetacea_no_genus,
                                     sampling.fractions = f_cetacea,
                                     Ncores = 4)
  
</code></pre>


</div>