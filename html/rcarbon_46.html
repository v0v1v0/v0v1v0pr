<div class="container">

<table style="width: 100%;"><tr>
<td>spd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Summed probability distributions (SPD) of radiocarbon dates.</h2>

<h3>Description</h3>

<p>The function generates Summed probability distributions (SPD) of radiocarbon dates, with optional binning routine for controlling inter-site or inter-phase variation in sampling intensity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spd(
  x,
  timeRange,
  bins = NA,
  datenormalised = FALSE,
  spdnormalised = FALSE,
  runm = NA,
  verbose = TRUE,
  edgeSize = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>CalDates</code> class object containing the calibrated radiocarbon dates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeRange</code></td>
<td>
<p>A vector of length 2 indicating the start and end date of the analysis in cal BP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>A vector containing the bin names associated with each radiocarbon date. If set to NA, binning is not carried out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datenormalised</code></td>
<td>
<p>Controls for calibrated dates with probability mass outside the timerange of analysis. If set to TRUE the total probability mass within the time-span of analysis is normalised to sum to unity. Should be set to FALSE when the parameter <code>normalised</code> in <code>calibrate</code> is set to FALSE. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spdnormalised</code></td>
<td>
<p>A logical variable indicating whether the total probability mass of the SPD is normalised to sum to unity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runm</code></td>
<td>
<p>A number indicating the window size of the moving average to smooth the SPD. If set to <code>NA</code> no moving average is applied. Default is NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical variable indicating whether extra information on progress should be reported. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgeSize</code></td>
<td>
<p>Extra margin in C14 Age time to handle edge effect when <code>datenormalise</code> is set to TRUE. Default is 500.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The binning routine consists of computing summed probability distribution of all dates associated to a given bin, divided by the number of contributing dates. This controls for any striking differences in sampling intensity, and ensures that each site phase is equally contributing to the final SPD (see Timpson et al 2014 for details). Bins can be generated using the <code>binPrep</code>, whilst the sensitivity to parameter choice can be explored with the <code>binsense</code> function.
</p>


<h3>Value</h3>

<p>An object of class <code>CalSPD</code> with the following elements
</p>

<ul>
<li>
<p><code>metadata</code> A data.frame containing relevant information regarding the parameters used to create the SPD as well as sample size and number of bins
</p>
</li>
<li>
<p><code>grid</code> A <code>CalGrid</code> class object containing the summed probability associated to each calendar year between <code>timeRange[1]</code> and <code>timeRange[2]</code>
</p>
</li>
</ul>
<h3>References</h3>

<p>Timpson, A., et al, (2014). Reconstructing regional population fluctuations in the European Neolithic using radiocarbon dates: a new case-study using an improved method. Journal of Archaeological Science 52: 549-557. DOI:10.1016/j.jas.2014.08.011
</p>


<h3>See Also</h3>

<p><code>calibrate</code> for calibrating radiocarbon dates; <code>binPrep</code> for preparing bins.
</p>


</div>