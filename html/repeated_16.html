<div class="container">

<table style="width: 100%;"><tr>
<td>kalcount</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Repeated Measurements Models for Counts with Frailty or Serial Dependence</h2>

<h3>Description</h3>

<p><code>kalcount</code> is designed to handle repeated measurements models with
time-varying covariates. The distributions have two extra parameters as
compared to the functions specified by <code>intensity</code> and are generally
longer tailed than those distributions. Dependence among observations on a
unit can be through gamma or power variance family frailties (a type of
random effect), with or without autoregression, or serial dependence over
time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kalcount(
  response = NULL,
  times = NULL,
  origin = 0,
  intensity = "exponential",
  depend = "independence",
  update = "Markov",
  mu = NULL,
  shape = NULL,
  density = FALSE,
  ccov = NULL,
  tvcov = NULL,
  preg = NULL,
  ptvc = NULL,
  pbirth = NULL,
  pintercept = NULL,
  pshape = NULL,
  pinitial = 1,
  pdepend = NULL,
  pfamily = NULL,
  envir = parent.frame(),
  print.level = 0,
  ndigit = 10,
  gradtol = 1e-05,
  steptol = 1e-05,
  fscale = 1,
  iterlim = 100,
  typsize = abs(p),
  stepmax = 10 * sqrt(p %*% p)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A list of two column matrices with counts and corresponding
times for each individual, one matrix or dataframe of counts, or an object
of class, <code>response</code> (created by <code>restovec</code>) or
<code>repeated</code> (created by <code>rmna</code> or
<code>lvna</code>). If the <code>repeated</code> data object contains
more than one response variable, give that object in <code>envir</code> and give
the name of the response variable to be used here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>When response is a matrix, a vector of possibly unequally
spaced times when they are the same for all individuals or a matrix of
times. Not necessary if equally spaced. Ignored if response has class,
<code>response</code> or <code>repeated</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>If the time origin is to be before the start of observations,
a positive constant to be added to all times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intensity</code></td>
<td>
<p>The form of function to be put in the Pareto distribution.
Choices are exponential, Weibull, gamma, log normal, log logistic, log
Cauchy, log Student, and gen(eralized) logistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depend</code></td>
<td>
<p>Type of dependence. Choices are <code>independence</code>,
<code>frailty</code>, and <code>serial</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update</code></td>
<td>
<p>Type of for serial dependence. Choices are <code>Markov</code>,
<code>serial</code>, <code>event</code>, <code>cumulated</code>, <code>count</code>, and
<code>kalman</code>. With <code>frailty</code> dependence, weighting by length of
observation time may be specified by setting update to <code>time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A regression function for the location parameter or a formula
beginning with ~, specifying either a linear regression function in the
Wilkinson and Rogers notation (a log link is assumed) or a general function
with named unknown parameters. Give the initial estimates in <code>preg</code> if
there are no time-varying covariates and in <code>ptvc</code> if there are.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>A regression function for the shape parameter or a formula
beginning with ~, specifying either a linear regression function in the
Wilkinson and Rogers notation or a general function with named unknown
parameters. It must yield one value per observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>If TRUE, the density of the function specified in
<code>intensity</code> is used instead of the intensity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccov</code></td>
<td>
<p>A vector or matrix containing time-constant baseline covariates
with one row per individual, a model formula using vectors of the same
size, or an object of class, <code>tccov</code> (created by
<code>tcctomat</code>). If response has class, <code>repeated</code>,
the covariates must be supplied as a Wilkinson and Rogers formula unless
none are to be used or <code>mu</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tvcov</code></td>
<td>
<p>A list of matrices with time-varying covariate values,
observed in the time periods in <code>response</code>, for each individual (one
column per variable), one matrix or dataframe of such covariate values, or
an object of class, <code>tvcov</code> (created by
<code>tvctomat</code>). If response has class, <code>repeated</code>,
the covariates must be supplied as a Wilkinson and Rogers formula unless
none are to be used or <code>mu</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preg</code></td>
<td>
<p>Initial parameter estimates for the regression model: intercept
plus one for each covariate in <code>ccov</code>. If <code>mu</code> is a formula or
function, the parameter estimates must be given here only if there are no
time-varying covariates. If <code>mu</code> is a formula with unknown parameters,
their estimates must be supplied either in their order of appearance in the
expression or in a named list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptvc</code></td>
<td>
<p>Initial parameter estimates for the coefficients of the
time-varying covariates, as many as in <code>tvcov</code>. If <code>mu</code> is a
formula or function, the parameter estimates must be given here if there
are time-varying covariates present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pbirth</code></td>
<td>
<p>If supplied, this is the initial estimate for the coefficient
of the birth model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pintercept</code></td>
<td>
<p>The initial estimate of the intercept for the generalized
logistic intensity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pshape</code></td>
<td>
<p>An initial estimate for the shape parameter of the intensity
function (except exponential intensity). If <code>shape</code> is a function or
formula, the corresponding initial estimates. If <code>shape</code> is a formula
with unknown parameters, their estimates must be supplied either in their
order of appearance in the expression or in a named list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pinitial</code></td>
<td>
<p>An initial estimate for the initial parameter. With
<code>frailty</code> dependence, this is the frailty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdepend</code></td>
<td>
<p>An initial estimate for the serial dependence parameter. For
<code>frailty</code> dependence, if a value is given here, an autoregression is
fitted as well as the frailty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfamily</code></td>
<td>
<p>An optional initial estimate for the second parameter of a
two-parameter power variance family mixture instead of the default gamma
mixture. This yields a gamma mixture as <code>family -&gt; 0</code>, an inverse
Gauss mixture for <code>family = 0.5</code>, and a compound distribution of a
Poisson-distributed number of gamma distributions for <code>-1 &lt; family &lt;
0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>response</code>. If
<code>response</code> has class <code>repeated</code>, it is used as the environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndigit</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fscale</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typsize</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepmax</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, a gamma mixture of the distribution specified in
<code>intensity</code> is used, as the conditional distribution in the
<code>serial</code> dependence models, and as a symmetric multivariate (random
effect) model for <code>frailty</code> dependence.
</p>
<p>Unless specified otherwise, the time origin is taken to be zero. The given
times are the ends of the periods in which the counts occurred.
</p>
<p>Here, the variance, with exponential intensity, is a quadratic function of
the mean, whereas, for <code>nbkal</code>, it is proportional to
the mean function.
</p>
<p>If the counts on a unit are clustered, not longitudinal, use the failty
dependence with the default exponential intensity, yielding a multivariate
negative binomial distribution.
</p>
<p>Nonlinear regression models can be supplied as formulae where parameters
are unknowns in which case factor variables cannot be used and parameters
must be scalars. (See <code>finterp</code>.)
</p>
<p>Marginal and individual profiles can be plotted using
<code>mprofile</code> and <code>iprofile</code> and
residuals with <code>plot.residuals</code>.
</p>


<h3>Value</h3>

<p>A list of classes <code>kalcount</code> and <code>recursive</code> is returned.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>Examples</h3>

<pre><code class="language-R">
treat &lt;- c(0,0,1,1)
tr &lt;- tcctomat(treat)
dose &lt;- 
  matrix(c(9,13,16,7,12,6,9,10,11,9,10,10,7,9,9,9,8,10,15,4),
         ncol=5,byrow=TRUE)
dd &lt;- tvctomat(dose)
y &lt;- restovec(structure(c(6, 4, 0, 0, 3, 6, 1, 1, 1, 5, 0, 0, 0, 4, 0, 1, 0, 
                          13, 0, 3), dim = 4:5))
reps &lt;- rmna(y, ccov=tr, tvcov=dd)
kalcount(y, intensity="log normal", dep="independence", 
        preg=0.3, pshape=0.1)
kalcount(y, intensity="log normal", dep="frailty", pinitial=0.1,
         preg=1, psh=0.1)
kalcount(y, intensity="log normal", dep="serial", pinitial=0.1,
         preg=1, pdep=0.75, psh=0.1)
# random effect and autoregression (commented out: AR difficult to estimate)
#kalcount(y, intensity="log normal", dep="frailty", pinitial=0.1,
#         pdep=0.5, preg=1, psh=0.1)
# add time-constant variable
kalcount(y, intensity="log normal", pinitial=1, psh=1,
         preg=c(0.8,0.11), ccov=treat)
# or
kalcount(y, intensity="log normal", mu=~b0+b1*treat,
         pinitial=1, psh=.1, preg=c(0.4,-0.04), envir=reps)
# add time-varying variable
kalcount(y, intensity="log normal", pinitial=1, psh=1,
         preg=c(-1,2), ccov=treat, ptvc=0, tvc=dose)
# or equivalently, from the environment
dosev &lt;- as.vector(t(dose))
kalcount(y, intensity="log normal", mu=~b0+b1*rep(treat,rep(5,4))+b2*dosev,
         pinitial=1, psh=1, ptvc=c(-1,2,0))
# or from the reps data object
kalcount(y, intensity="log normal", mu=~b0+b1*treat+b2*dose,
        pinitial=1, psh=1, ptvc=c(-1,2,0), envir=reps)
# try power variance family
kalcount(y, intensity="log normal", mu=~b0+b1*treat+b2*dose,
         pinitial=1, psh=1, ptvc=c(-1,2,0.1), envir=reps,
         pfamily=0.8)

</code></pre>


</div>