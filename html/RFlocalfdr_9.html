<div class="container">

<table style="width: 100%;"><tr>
<td>local.fdr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>local fdr</h2>

<h3>Description</h3>

<p>calculate the local
</p>


<h3>Usage</h3>

<pre><code class="language-R">local.fdr(
  f,
  x,
  FUN = my.dsn,
  p0 = 1,
  debug.flag = 0,
  plot.string = "",
  temp.dir = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>object retuned by call to f.fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>f_fit$midpoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>my.dsn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>estimated proportion of null importances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug.flag</code></td>
<td>
<p>either 0 (no debugging information), 1 or 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.string, </code></td>
<td>
<p>file name for a debugging plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.dir, </code></td>
<td>
<p>directory for debugging output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to FUN</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>returns an estimate of the local false discovery rate.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(imp20000)                                      
imp&lt;-log(imp20000$importances)                               
t2&lt;-imp20000$counts
temp&lt;-imp[t2 &gt; 1]   #see                          
temp&lt;-temp[temp != -Inf]                         
temp &lt;- temp - min(temp) + .Machine$double.eps   
f_fit &lt;- f.fit(temp)                             
y &lt;- f_fit$zh$density                            
x &lt;- f_fit$midpoints                             
df &lt;- data.frame(x, y)                           
fitted_parameters &lt;- fit.to.data.set(df, temp, try.counter = 3)           
fitted_parameters

aa &lt;- local.fdr(f_fit, df$x, FUN = my.dsn, xi = fitted_parameters$Estimate[1],
                omega = fitted_parameters$Estimate[2], lambda = fitted_parameters$Estimate[3],
                debug.flag = 0, plot.string = "initial")

plot(x,y,axes=FALSE,type="l",col="blue",main = "local fdr",
      xlab="importances",ylab="")                                                                                       
axis(2, pretty( c(0,max(y)+0.5*max(y)),10))                                                                            
                                                                                                                        
oldpar &lt;- par(new = TRUE)
plot(x, aa, type="l",col="green",main = "",xlab="",ylab="",axes=FALSE)                                                 
abline(h = 0.2)                                                                                                        
axis(4, pretty( aa,10))                                                                                                
                                                                                                                        
axis(1,pretty(x,10))                                                                                                   
box() #- to make it look "as usual                                                                                     
legend("topright",c("density importances","local fdr"),col=c("blue","green"),lty=1)
par(oldpar)


library(RFlocalfdr.data)
data(ch22)                                                                                                             
imp&lt;-log(ch22$imp)
t2&lt;-ch22$C                                                                                                             
imp&lt;-imp[t2 &gt; 30]                                                                                                      
imp &lt;- imp - min(imp) + .Machine$double.eps                                                                            
debug.flag &lt;- 0                                                                                                        
f_fit &lt;- f.fit(imp, debug.flag = debug.flag)                                                                           
y &lt;- f_fit$zh$density                                                                                                  
x &lt;- f_fit$midpoints                                                                                                   
df &lt;- data.frame(x, y)                                                                                                 
initial.estimates &lt;- fit.to.data.set.wrapper(df, imp, debug.flag = debug.flag,
return.all = FALSE)

aa &lt;- local.fdr(f_fit, df$x, FUN = my.dsn, xi = initial.estimates$Estimate[1],
    omega = initial.estimates$Estimate[2], lambda = initial.estimates$Estimate[3],  debug.flag = 0,
                    plot.string = "initial")

plot(x,y,axes=FALSE,type="l",col="blue",main = "local fdr",                                                            
     xlab="importances",ylab="")                                                                                       
axis(2, pretty( c(0,max(y)+0.5*max(y)),10))                                                                            
                                                                                                                       
oldpar &lt;- par(new = TRUE)
plot(x, aa, type="l",col="green",main = "",xlab="",ylab="",axes=FALSE)                                                 
abline(h = 0.2)                                                                                                        
axis(4, pretty( aa,10))                                                                                                
                                                                                                                       
axis(1,pretty(x,10))                                                                                                   
box() #- to make it look "as usual                                                                                     
legend("topright",c("density importances","local fdr"),col=c("blue","green"),lty=1)
par(oldpar)

</code></pre>


</div>