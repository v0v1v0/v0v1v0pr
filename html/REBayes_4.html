<div class="container">

<table style="width: 100%;"><tr>
<td>Bmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binomial mixture estimation via Kiefer Wolfowitz MLE</h2>

<h3>Description</h3>

<p>Interior point solution of Kiefer-Wolfowitz NPMLE for mixture of binomials
</p>


<h3>Usage</h3>

<pre><code class="language-R">Bmix(x, k, v = 300, collapse = TRUE, weights = NULL, unique = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Count of "successes" for binomial observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of trials for binomial observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Grid Values for the mixing distribution defaults to equal
spacing of length v on [eps, 1- eps], if v is scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>Collapse observations into cell counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>replicate weights for x obervations, should sum to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unique</code></td>
<td>
<p>option to check unique of reported solution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to KWDual to control optimization</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The predict method for <code>Bmix</code> objects will compute means, medians or
modes of the posterior according to whether the <code>Loss</code> argument is 2, 1
or 0, or posterior quantiles if <code>Loss</code> is in (0,1).
When the number of trials is small the NPMLE may be non-unique.  This happens
when there exists a vector <code class="reqn">v</code> in the unit simplex of <code class="reqn">R^m</code>  
such that <code class="reqn">Av = f</code> where <code class="reqn">f = (n_0/n , ... , n_k/n)</code> the observed frequencies, 
and A is the k by m matrix with typical element </p>
<p style="text-align: center;"><code class="reqn">C(k,x) p_j^x (1-p_j)^{k - x}.</code>
</p>

<p>If there exists such a solution, it follows that the maximal likelihood value is attained by any Ghat
such that </p>
<p style="text-align: center;"><code class="reqn">p_j = \int C(k,j) p^j (1-p)^{k-j} dGhat (p) = n_j/n,</code>
</p>
<p> for j = 0, ... , k.
There will be many such solutions, but by the Caratheodory theorem any one of them can be expressed
as a linear combination of no more than k extreme points of the constraint set.
In contrast, when there are no solutions
inside the simplex satisfying the equation, then the NPMLE is the unique projection onto the boundary
of that set.  To facilitate checking this condition if the <code>check</code> parameter is <code>TRUE</code>, the 
linear program is feasible and the <code>unique</code> component is returned as <code>TRUE</code> if
the program is infeasible, and <code>FALSE</code> is returned otherwise.  This check is restricted to
settings in which k is fixed, and <code>collapse</code> is <code>TRUE</code>.  See Robbins (1956, p 161) for
some further discussion of the binomial mixture model and a very clever alternative approach to
prediction.
</p>


<h3>Value</h3>

<p>An object of class density with components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>grid midpoints of evaluation of the mixing density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>function values of the mixing density at x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>estimates of the mixture density at the distinct data values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>Log Likelihood value at the estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dy</code></td>
<td>
<p>Bayes rule estimates of binomial probabilities for distinct data values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unique</code></td>
<td>
<p>Flag indicating whether the solution is unique</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>exit code from the optimizer</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>R. Koenker
</p>


<h3>References</h3>

<p>Kiefer, J. and J. Wolfowitz Consistency of the Maximum
Likelihood Estimator in the Presence of Infinitely Many Incidental
Parameters <em>Ann. Math. Statist</em>. 27, (1956), 887-906.
</p>
<p>Koenker, R and I. Mizera, (2013) “Convex Optimization, Shape Constraints,
Compound Decisions, and Empirical Bayes Rules,” <em>JASA</em>, 109, 674–685.
</p>
<p>Robbins, H. (1956) An Empirical Bayes Approach to Statistics, 3rd Berkeley
Symposium.
</p>
<p>Koenker, R. and J. Gu, (2017) REBayes: An R Package for Empirical Bayes Mixture Methods,
<em>Journal of Statistical Software</em>, 82, 1–26.
</p>


</div>