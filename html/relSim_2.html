<div class="container">

<table style="width: 100%;"><tr>
<td>allPairsLR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the likehood ratio for all pairs of profiles in a database</h2>

<h3>Description</h3>

<p>This function takes every pair of profiles in a database of profiles and computes
the likelihood ratio (LR) for a specific relationship given by <code>nCode</code>. That means
there will be <code class="reqn">N(N-1)/2</code> LRs computed for N profiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">allPairsLR(Profiles, listFreqs, nCode)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Profiles</code></td>
<td>
<p>an integer vector of stacked profiles representing the database. This vector has <code class="reqn">2NL</code> entries, where N is the number of
profiles and <code class="reqn">L</code> is the number of loci.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listFreqs</code></td>
<td>
<p>is a set of allele frequencies representing a particular multiplex. The function assumes that that loci in the profiles
are in the same order as the loci in this list. The data structure is a <code>List</code> of <code>NumericVector</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCode</code></td>
<td>
<p>if <code>1</code> then compute the LR for siblings, otherwise computer the LR for parent/child.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>NumericVector</code> containing the LRs. They are stored in sequential order so if for example there were three
profiles, then there are 3 possible LRs, and the result vector would contain the LRs for the profile pairs (1, 2),
(1, 3), and (2, 3).
</p>


<h3>Author(s)</h3>

<p>James Curran
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("USCaucs")
N = 600
profs = relSim:::.randomProfiles(USCaucs$freqs, N)
system.time({lr = relSim:::allPairsLR(profs, USCaucs$freqs, 1)})
plot(density(log10(lr)))
mean(lr &gt; 1) ## estimate the probability that the LR is incorrectly above 1

</code></pre>


</div>