<div class="container">

<table style="width: 100%;"><tr>
<td>pred.felmdir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation or prediction for felmdir</h2>

<h3>Description</h3>

<p>Perform estimation or prediction under the functional envelope linear model, using the direct estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pred.felmdir(X, Y, ux, uy, t1, t2, Xnew, knots = c(0, 0.25, 0.5, 0.75, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Predictor function. An n by T1 matrix, T1 is number of observed time points, which is the length of t1.  Here we assume that each function is observed at the same time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response function. An n by T2 matrix, T2 is number of observed time points, which is the length of t2.  Here we assume that each function is observed at the same time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ux</code></td>
<td>
<p>Dimension of the predictor envelope. An integer between 0 and number of knots +2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uy</code></td>
<td>
<p>Dimension of the response envelope. An integer between 0 and number of knots +2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>The observed time points for the predictor functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>
<p>The observed time points for the response functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xnew</code></td>
<td>
<p>The value of X with which to estimate or predict Y.  A T1 dimensional vector. The observed time points should be the same as those of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>The location of knots of the cubic splines used for estimation.  Locations should be positive. The default location of the knots are 0, 0.25, 0.5, 0.75, 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function evaluates the functional envelope linear model at new value Xnew.  It can perform estimation: find the fitted value when X = Xnew, or prediction: predict Y when X = Xnew.  The covariance matrix and the standard errors are also provided.  The estimation method uses the direct estimation in Su et al. (2022) with cubic splines.
</p>


<h3>Value</h3>

<p>The output is a list that contains following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>The fitted value or the predicted value evaluated at Xnew.  The fitted or predicted values are at the same observation points as Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMatrix.estm</code></td>
<td>
<p>The covariance matrix of the fitted value at Xnew.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE.estm</code></td>
<td>
<p>The standard error of the fitted value at Xnew.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMatrix.pred</code></td>
<td>
<p>The covariance matrix of the predicted value at Xnew.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE.pred</code></td>
<td>
<p>The standard error of the predicted value at Xnew.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Su, Z., Li, B. and Cook, R. D. (2022+) Envelope model for function-on-function linear regression.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(NJdata)
dataX &lt;- matrix(NJdata[,6], nrow = 21)
X &lt;- as.matrix(dataX[, 32:61])
dataY &lt;- matrix(NJdata[,3], nrow = 21)
Y &lt;- as.matrix(dataY[, 32:61])
t1 &lt;- 0:29
t2 &lt;- t1

m &lt;- pred.felmdir(X, Y, 3, 1, t1, t2, X[1,])
m$value
m$SE.estm
m$SE.pred
</code></pre>


</div>