<div class="container">

<table style="width: 100%;"><tr>
<td>notch_filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply 'Notch' filter</h2>

<h3>Description</h3>

<p>Apply 'Notch' filter
</p>


<h3>Usage</h3>

<pre><code class="language-R">notch_filter(
  s,
  sample_rate,
  lb = c(59, 118, 178),
  ub = c(61, 122, 182),
  domain = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>numerical vector if <code>domain=1</code> (voltage
signals), or complex vector if <code>domain=0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_rate</code></td>
<td>
<p>sample rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>filter lower bound of the frequencies to remove</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>filter upper bound of the frequencies to remove;
shares the same length as <code>lb</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p><code>1</code> if the input signal is in the
time domain, <code>0</code> if it is in the frequency domain</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mainly used to remove electrical line frequencies
at 60, 120, and 180 <code>Hz</code>.
</p>


<h3>Value</h3>

<p>filtered signal in time domain (real numerical
vector)
</p>


<h3>Examples</h3>

<pre><code class="language-R">

time &lt;- seq(0, 3, 0.005)
s &lt;- sin(120 * pi * time) + rnorm(length(time))

# Welch periodogram shows a peak at 60Hz
pwelch(s, 200, plot = 1, log = "y")

# notch filter to remove 60Hz
s1 &lt;- notch_filter(s, 200, lb = 59, ub = 61)
pwelch(s1, 200, plot = 2, log = "y", col = "red")


</code></pre>


</div>