<div class="container">

<table style="width: 100%;"><tr>
<td>margint.rob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust marginal integration procedures for additive models</h2>

<h3>Description</h3>

<p>This function computes robust marginal integration procedures for additive models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">margint.rob(
  formula,
  data,
  subset,
  point = NULL,
  windows,
  prob = NULL,
  sigma.hat = NULL,
  win.sigma = NULL,
  epsilon = 1e-06,
  type = "0",
  degree = NULL,
  typePhi = "Huber",
  k.h = 1.345,
  k.t = 4.685,
  max.it = 20,
  qderivate = FALSE,
  orderkernel = 2,
  Qmeasure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>, typically the environment from which the function was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point</code></td>
<td>
<p>a matrix of points where predictions will be computed and returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windows</code></td>
<td>
<p>a vector or a squared matrix of bandwidths for the smoothing estimation procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>a vector of probabilities of observing each response (n). Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.hat</code></td>
<td>
<p>estimate of the residual standard error. If <code>NULL</code> we use the mad of the residuals obtained with local medians.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win.sigma</code></td>
<td>
<p>a vector of bandwidths for estimating sigma.hat. If <code>NULL</code> it uses the argument windows if it is a vector or its diagonal if it is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>three different type of estimators can be selected: type <code>'0'</code> (local constant on all the covariates), type <code>'1'</code> (local linear smoother on all the covariates), type <code>'alpha'</code> (local polynomial smoother only on the direction of interest).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>degree of the local polynomial smoother in the direction of interest when using the estimator of type <code>'alpha'</code>. Defaults to <code>NULL</code> for the case when using estimators of type <code>'0'</code> or <code>'1'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typePhi</code></td>
<td>
<p>one of either <code>'Tukey'</code> or <code>'Huber'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.h</code></td>
<td>
<p>tuning constant for a Huber-type loss function. Defaults to <code>1.345</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.t</code></td>
<td>
<p>tuning constant for a Tukey-type loss function. Defaults to <code>4.685</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.it</code></td>
<td>
<p>maximum number of iterations for the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qderivate</code></td>
<td>
<p>if TRUE, it calculates <code>g^(q+1)/(q+1)!</code> for each component only for the type <code>'alpha'</code> method. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orderkernel</code></td>
<td>
<p>order of the kernel used in the nuisance directions when using the estimator of type <code>'alpha'</code>. Defaults to <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qmeasure</code></td>
<td>
<p>a matrix of points where the integration procedure ocurrs. Defaults to <code>NULL</code> for calcuting the integrals over the sample.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes three types of robust marginal integration procedures for additive models.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu </code></td>
<td>
<p>Estimate for the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.matrix </code></td>
<td>
<p>Matrix of estimated additive components (n by p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.hat </code></td>
<td>
<p>Estimate of the residual standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prediction </code></td>
<td>
<p>Matrix of estimated additive components for the points listed in the argument point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mul </code></td>
<td>
<p>A vector of size p showing in each component the estimated intercept that considers only that direction of interest when using the type <code>'alpha'</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.derivative </code></td>
<td>
<p>Matrix of estimated derivatives of the additive components (only when qderivate is <code>TRUE</code>) (n by p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prediction.derivate </code></td>
<td>
<p>Matrix of estimated derivatives of the additive components for the points listed in the argument point (only when qderivate is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xp</code></td>
<td>
<p>Matrix of explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yp</code></td>
<td>
<p>Vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Model formula</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alejandra Martinez, <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>, Matias Salibian-Barrera
</p>


<h3>References</h3>

<p>Boente G. and Martinez A. (2017). Marginal integration M-estimators for additive models. TEST, 26(2), 231-260. https://doi.org/10.1007/s11749-016-0508-0
</p>


<h3>Examples</h3>

<pre><code class="language-R">function.g1 &lt;- function(x1) 24*(x1-1/2)^2-2
function.g2 &lt;- function(x2) 2*pi*sin(pi*x2)-4
set.seed(140)
n &lt;- 150
x1 &lt;- runif(n)
x2 &lt;- runif(n)
X &lt;- cbind(x1, x2)
eps &lt;- rnorm(n,0,sd=0.15)
regresion &lt;- function.g1(x1) + function.g2(x2)
y &lt;- regresion + eps
bandw &lt;- matrix(0.25,2,2)
set.seed(8090)
nQ &lt;- 80 
Qmeasure &lt;- matrix(runif(nQ*2), nQ, 2)
fit.rob &lt;- margint.rob(y ~ X, windows=bandw, type='alpha', degree=1, Qmeasure=Qmeasure) 

</code></pre>


</div>