<div class="container">

<table style="width: 100%;"><tr>
<td>imputeUDLs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputation of values above an upper detection limit in compositional data</h2>

<h3>Description</h3>

<p>Parametric replacement of values above upper detection limit for compositional data using
classical and robust methods (possibly also the pls method) based on ilr-transformations with special
choice of balances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">imputeUDLs(
  x,
  maxit = 10,
  eps = 0.1,
  method = "lm",
  dl = NULL,
  variation = TRUE,
  nPred = NULL,
  nComp = "boot",
  bruteforce = FALSE,
  noisemethod = "residuals",
  noise = FALSE,
  R = 10,
  correction = "normal",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data.frame or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergency criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either "lm", "lmrob" or "pls"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dl</code></td>
<td>
<p>Detection limit for each variable. zero for variables with
variables that have no detection limit problems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variation, </code></td>
<td>
<p>if TRUE those predictors are chosen in each step, who's variation is lowest to the predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPred, </code></td>
<td>
<p>if determined and variation equals TRUE, it fixes the number of predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nComp</code></td>
<td>
<p>if determined, it fixes the number of pls components. If
“boot”, the number of pls components are estimated using a
bootstraped cross validation approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bruteforce</code></td>
<td>
<p>sets imputed values above the detection limit to the
detection limit. Replacement above the detection limit are only exeptionally
occur due to numerical instabilities. The default is FALSE!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noisemethod</code></td>
<td>
<p>adding noise to imputed values. Experimental</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>TRUE to activate noise (experimental)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of bootstrap samples for the determination of pls
components. Only important for method “pls”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>normal or density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>additional print output during calculations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>imputeUDLs
</p>
<p>An imputation method for right-censored compositional data. 
Statistical analysis is not possible with values reported in data, 
for example as "&gt;10000". These values are replaced using tobit regression.
</p>
<p>The algorithm iteratively imputes parts with values above upper detection limit
whereas in each step (1) compositional data are expressed in pivot coordinates (2) tobit regression is
applied (3) the values above upper detection limit are replaced by the expected values (4) the
corresponding inverse ilr mapping is applied. After all parts are
imputed, the algorithm starts again until the imputations only change marginally.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>imputed data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria </code></td>
<td>
<p>change between last and
second last iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter </code></td>
<td>
<p>number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit
</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind</code></td>
<td>
<p>index of values above upper detection limit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nComp</code></td>
<td>
<p>number of components for method pls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>chosen
method</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Filzmoser, Dominika Miksova based on function imputeBDLs code from Matthias Templ
</p>


<h3>References</h3>

<p>Martin-Fernandez, J.A.,  Hron K.,  Templ, M., Filzmoser, P.  and Palarea-Albaladejo, J. (2012).
Model-based replacement of rounded zeros in compositional data:  Classical and robust approaches.
<em>Computational Statistics and Data Analysis</em>, 56, 2688-2704.
</p>
<p>Templ, M. and Hron, K. and Filzmoser and Gardlo, A. (2016). 
Imputation of rounded zeros for high-dimensional compositional data. 
<em>Chemometrics and Intelligent Laboratory Systems</em>, 155, 183-190.
</p>


<h3>See Also</h3>

<p><code>imputeBDLs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gemas)  # read data
dat &lt;- gemas[gemas$COUNTRY=="HEL",c(12:29)]
UDL &lt;- apply(dat,2,max)
names(UDL) &lt;- names(dat)
UDL["Mn"] &lt;- quantile(dat[,"Mn"], probs = 0.8)  # UDL present only in one variable
whichudl &lt;- dat[,"Mn"] &gt; UDL["Mn"] 
# classical method
imp.lm &lt;- dat
imp.lm[whichudl,"Mn"] &lt;- Inf
res.lm &lt;- imputeUDLs(imp.lm, dl=UDL, method="lm", variation=TRUE)
imp.lm &lt;- res.lm$x


</code></pre>


</div>