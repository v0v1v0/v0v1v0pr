<div class="container">

<table style="width: 100%;"><tr>
<td>ppgasp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Setting up the parallel partial GaSP model

</h2>

<h3>Description</h3>


<p>Setting up the parallel partial GaSP model for estimating the parameters (if the parameters are not given). 

</p>


<h3>Usage</h3>

<pre><code class="language-R">   ppgasp(design,response,trend=matrix(1,dim(response)[1],1),zero.mean="No",nugget=0,
    nugget.est=F,range.par=NA,method='post_mode',prior_choice='ref_approx',a=0.2,
    b=1/(length(response))^{1/dim(as.matrix(design))[2]}*(a+dim(as.matrix(design))[2]),
    kernel_type='matern_5_2',isotropic=F,R0=NA,
    optimization='lbfgs',
    alpha=rep(1.9,dim(as.matrix(design))[2]),lower_bound=T,
    max_eval=max(30,20+5*dim(design)[2]),initial_values=NA,num_initial_values=2)
 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p> a matrix of inputs.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p> a matrix of outputs where each row is one runs of the computer model  output.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p> the mean/trend matrix of inputs. The default value is a  vector of ones. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.mean</code></td>
<td>
<p> it has zero mean or not. The default value is FALSE meaning the mean is not zero. TRUE means the mean is zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p> numerical value of the nugget variance ratio. If nugget is equal to 0, it means there is either no nugget or the nugget is estimated. If the nugget is not equal to 0, it means a fixed nugget. The default value is 0. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget.est</code></td>
<td>
<p> boolean value. <code>T</code> means nugget should be estimated and <code>F</code> means nugget is fixed
or not estimated. The default value is <code>F</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.par</code></td>
<td>
<p> either <code>NA</code> or a <code>vector</code>. If it is <code>NA</code>, it means range parameters are estimated; otherwise range parameters are given. The default value is <code>NA</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>  method of parameter estimation. <code>post_mode</code> means the marginal posterior mode is used for estimation. <code>mle</code> means the maximum likelihood estimation is used. <code>mmle</code> means the maximum marginal likelihood estimation is used. The <code>post_mode</code>  is the default method. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_choice</code></td>
<td>
<p> the choice of prior for range parameters and noise-variance parameters. <code>ref_xi</code> and <code>ref_gamma</code> means the reference prior with reference prior with the log of inverse range parameterization ξ or range parameterization γ. <code>ref_approx</code> uses the jointly robust prior to approximate the reference prior. The default choice is <code>ref_approx</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>


<p>prior parameters in the jointly robust prior. The default value is 0.2. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>


<p>prior parameters in the jointly robust prior. The default value is <code>n^{-1/p}(a+p)</code> where n is the number of runs and p is the dimension of the input vector. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_type</code></td>
<td>


<p>A vector specifying the type of kernels of each coordinate of the input. <code>matern_3_2</code> and <code>matern_5_2</code> are <code>Matern correlation</code> with roughness parameter 3/2 and 5/2 respectively. <code>pow_exp</code> is power exponential correlation with roughness parameter alpha. If <code>pow_exp</code> is to be used, one needs to specify its roughness parameter alpha. The default choice is <code>matern_5_2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isotropic</code></td>
<td>

<p>a boolean value. <code>T</code> means the isotropic kernel will be used and <code>F</code> means the separable kernel will be used. The default choice is  the separable kernel. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0</code></td>
<td>

<p>the distance between inputs. If the value is <code>NA</code>, it will be calculated later. It can also be specified by the user. If specified by user, it is either a <code>matrix</code> or <code>list</code>. The default value is <code>NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization</code></td>
<td>

<p>the method for numerically optimization of the kernel parameters.  Currently three methods are implemented. <code>lbfgs</code> is the low-storage version of the Broyden-Fletcher-Goldfarb-Shanno method. <code>nelder-mead</code> is the  Nelder and Mead method.  <code>brent</code> is the Brent method for one-dimensional problems. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>


<p>roughness parameters in the <code>pow_exp</code> correlation functions. The default choice is a vector with each entry being 1.9. 
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>lower_bound</code></td>
<td>

<p>boolean value.  <code>T</code> means the default lower bounds of the inverse range parameters are used to constrained the optimization and <code>F</code> means the optimization is unconstrained. The default value is <code>T</code> and we also suggest to use <code>F</code> in various scenarios. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_eval</code></td>
<td>

<p>the maximum number of steps to estimate the range and nugget parameters.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_values</code></td>
<td>

<p>a matrix of initial values of the kernel parameters to be optimized numerically, where each row of the matrix contains a set of the log inverse range parameters and the log nugget parameter. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_initial_values</code></td>
<td>

<p>the number of initial values of the kernel parameters in optimization.
</p>
</td>
</tr>
</table>
<h3>Value</h3>






<p><code>ppgasp</code> returns a S4 object of class <code>ppgasp</code> (see <code>ppgasp-class</code>).
</p>


<h3>Author(s)</h3>

<p>Mengyang Gu [aut, cre],
  Jesus Palomo [aut],
  James Berger [aut]
</p>
<p>Maintainer: Mengyang Gu &lt;mengyang@pstat.ucsb.edu&gt;
</p>


<h3>References</h3>


<p>M. Gu. and J.O. Berger (2016). Parallel partial Gaussian process emulation for computer models with massive output. <em>Annals of Applied Statistics</em>, 10(3), 1317-1347.
</p>
<p>M. Gu, X. Wang and J.O. Berger (2018), <em>Robust Gaussian stochastic process emulation</em>, <em>Annals of Statistics</em>, 46(6A), 3038-3066.
</p>
<p>M. Gu (2018), <em>Jointly robust prior for Gaussian stochastic process in emulation, calibration and variable selection</em>, arXiv:1804.09329.
</p>
<p>J. Nocedal (1980), Updating quasi-Newton matrices with limited storage, <em>Math. Comput.</em>, 35, 773-782.
</p>
<p>D. C. Liu and J. Nocedal (1989), On the limited memory BFGS method for large scale optimization, <em>Math. Programming</em>, 45, p. 503-528.
</p>
<p>Brent, R. (1973), Algorithms for Minimization without Derivatives. Englewood Cliffs N.J.: Prentice-Hall.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  library(RobustGaSP)
  
  ###parallel partial Gaussian stochastic process (PP GaSP) model 
  ##for the humanity model
  data(humanity_model)
  ##120 runs. The input has 13 variables and output is 5 dimensional.
  ##PP GaSP Emulator
  m.ppgasp=ppgasp(design=humanity.X,response=humanity.Y,nugget.est= TRUE)
  show(m.ppgasp)

  ##make predictions
  m_pred=predict(m.ppgasp,humanity.Xt)
  sqrt(mean((m_pred$mean-humanity.Yt)^2))
  mean(m_pred$upper95&gt;humanity.Yt &amp; humanity.Yt&gt;m_pred$lower95)
  mean(m_pred$upper95-m_pred$lower95)
  sqrt( mean( (mean(humanity.Y)-humanity.Yt)^2 ))

  ##with a linear trend on the selected input performs better
  ## Not run: 
    ###PP GaSP Emulation with a linear trend for the humanity model
    data(humanity_model)
    ##pp gasp with trend
    n&lt;-dim(humanity.Y)[1]
    n_testing=dim(humanity.Yt)[1]
    H=cbind(matrix(1,n,1),humanity.X$foodC)
    H_testing=cbind(matrix(1,n_testing,1),humanity.Xt$foodC)
    m.ppgasp_trend=ppgasp(design=humanity.X,response=humanity.Y,trend=H, 
    nugget.est= TRUE)
    
    show(m.ppgasp_trend)
    
    ##make predictions
    m_pred_trend=predict(m.ppgasp_trend,humanity.Xt,testing_trend=H_testing)
    sqrt(mean((m_pred_trend$mean-humanity.Yt)^2))
    mean(m_pred_trend$upper95&gt;humanity.Yt &amp; humanity.Yt&gt;m_pred_trend$lower95)
    mean(m_pred_trend$upper95-m_pred_trend$lower95)
  
## End(Not run)

</code></pre>


</div>