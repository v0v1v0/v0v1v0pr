<div class="container">

<table style="width: 100%;"><tr>
<td>CalculateSampleEntropy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Entropy (also known as Kolgomorov-Sinai Entropy)</h2>

<h3>Description</h3>

<p>These functions measure the complexity of the RR time series. Large values of 
the Sample Entropy indicate high complexity whereas that smaller values characterize
more regular signals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalculateSampleEntropy(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  doPlot = TRUE
)

EstimateSampleEntropy(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  regressionRange = NULL,
  useEmbeddings = NULL,
  doPlot = TRUE
)

PlotSampleEntropy(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HRVData</code></td>
<td>
<p>Data structure that stores the beats register and information related to it</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexNonLinearAnalysis</code></td>
<td>
<p>Reference to the data structure that will contain the nonlinear analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>Logical value. If TRUE (default), a plot of the correlation sum is shown</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regressionRange</code></td>
<td>
<p>Vector with 2 components denoting the range where the function will perform linear regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useEmbeddings</code></td>
<td>
<p>A numeric vector specifying which embedding dimensions should the algorithm use to compute
the sample entropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional plot parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample entropy is computed using:
</p>
<p style="text-align: center;"><code class="reqn">h_q(m,r) = log(C_q(m,r)/C_{q}(m+1,r))</code>
</p>

<p>where <em>m</em> is the embedding dimension and <em>r</em> is the radius of the neighbourhood. When 
computing the correlation dimensions we use the linear regions from the correlation
sums in order to do the estimates. Similarly, the sample entropy <code class="reqn">h_q(m,r)</code> 
should not change for both various <em>m</em> and <em>r</em>.
</p>


<h3>Value</h3>

<p>The <em>CalculateSampleEntropy</em> returns a HRVData structure containing the sample entropy computations of the 
RR time series under the <em>NonLinearAnalysis</em> list.
</p>
<p>The <em>EstimateSampleEntropy</em> function estimates the sample entropy of the 
RR time series  by performing a linear regression
over the radius' range specified in <em>regressionRange</em>. If <em>doPlot</em> is TRUE,
a graphic of the regression over the data is shown. In order to run <em>EstimateSampleEntropy</em>, it
is necessary to have performed the sample entropy computations before with <em>ComputeSampleEntropy</em>. The 
results are returned into the <em>HRVData</em> structure, under the <em>NonLinearAnalysis</em> list.
</p>
<p><em>PlotSampleEntropy</em> shows a graphic of the sample entropy computations.
</p>


<h3>Note</h3>

<p>In order to run this functions, it is necessary to have used the <em>CalculateCorrDim</em> function.
</p>
<p>This function is based on the <code>sampleEntropy</code> function from the 
nonlinearTseries package.
</p>


<h3>References</h3>

<p>H. Kantz  and T. Schreiber: Nonlinear Time series Analysis (Cambridge university press)
</p>


<h3>See Also</h3>

<p><code>sampleEntropy</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# ...
hrv.data = CreateNonLinearAnalysis(hrv.data)
hrv.data = CalculateCorrDim(hrv.data,indexNonLinearAnalysis=1,minEmbeddingDim=2,
                            maxEmbeddingDim=8,timeLag=1,minRadius=1,maxRadius=15,
                            pointsRadius=20,theilerWindow=10,corrOrder=2,doPlot=FALSE)
hrv.data = CalculateSampleEntropy(hrv.data,indexNonLinearAnalysis=1,doPlot=FALSE)
PlotSampleEntropy(hrv.data,indexNonLinearAnalysis=1)
hrv.data = EstimateSampleEntropy(hrv.data,indexNonLinearAnalysis=1,regressionRange=c(6,10))

## End(Not run)
</code></pre>


</div>