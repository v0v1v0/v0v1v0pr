<div class="container">

<table style="width: 100%;"><tr>
<td>convert_rate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a unitless oxygen rate value to absolute, mass-specific or
area-specific rate</h2>

<h3>Description</h3>

<p>Converts a unitless rate derived from <code>calc_rate()</code>, <code>calc_rate.int()</code>,
<code>auto_rate()</code>, <code>auto_rate.int()</code>, <code>adjust_rate()</code>, or
<code>calc_rate.bg()</code> into an absolute rate (i.e. whole chamber or whole
specimen), or mass-specific rate (i.e. normalised by specimen mass), or
area-specific rate (i.e. normalised by specimen surface area) in any common
unit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">convert_rate(
  x,
  oxy.unit = NULL,
  time.unit = NULL,
  output.unit = NULL,
  volume = NULL,
  mass = NULL,
  area = NULL,
  S = NULL,
  t = NULL,
  P = NULL,
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric value or vector, or object of class <code>calc_rate</code>,
<code>calc_rate.int</code>, <code>auto_rate</code>, <code>auto_rate.int</code>, <code>adjust_rate</code>, or
<code>calc_rate.bg.</code> Contains the rate(s) to be converted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oxy.unit</code></td>
<td>
<p>string. The dissolved oxygen unit of the original raw data
used to determine the rates in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.unit</code></td>
<td>
<p>string. The time unit of the original raw data used to
determine the rates in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.unit</code></td>
<td>
<p>string. The output units to convert the input rates to.
Should be in the correct order: "Oxygen/Time" or "Oxygen/Time/Mass" or
"Oxygen/Time/Area".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>volume</code></td>
<td>
<p>numeric. Volume of water in <em><strong>litres</strong></em> in the respirometer or
respirometer loop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass</code></td>
<td>
<p>numeric. Mass/weight in <em><strong>kg</strong></em>. This is the mass of the
specimen if you wish to calculate mass-specific rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>numeric. Surface area in <em><strong>m^2</strong></em>. This is the surface area of
the specimen if you wish to calculate surface area-specific rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>numeric. Salinity (ppt). Defaults to NULL. Used in conversion of
some oxygen units. Freshwater should be entered as <code>S = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>numeric. Temperature(°C). Defaults to NULL. Used in conversion of
some oxygen units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>numeric. Pressure (bar). Used in conversion of some oxygen units.
Defaults to a standard value of 1.013253 bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. Default is <code>FALSE</code>. Controls if a plot is produced. See
Plot section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Allows additional plotting controls to be passed. See Plot
section.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, <code>convert_rate</code> converts the primary <code style="white-space: pre;">⁠$rate⁠</code> element from
<code>calc_rate</code>, <code>calc_rate.int</code>, <code>auto_rate</code> and , <code>auto_rate.int</code> objects, the
<code style="white-space: pre;">⁠$rate.adjusted⁠</code> from <code>adjust_rate</code> objects, and the <code style="white-space: pre;">⁠$rate.bg⁠</code> from
<code>calc_rate.bg</code> objects. Additionally, any numeric value or vector of rates
can be input as <code>x</code>.
</p>


<h4>Respirometer volume</h4>

<p>The <code>volume</code> of the respirometer is required and should be in litres (<code>L</code>).
Note, the <code>volume</code> represents the <em>effective volume</em> of the respirometer,
that is <em>volume of water</em> in the respirometry chamber. This is not
necessarily the same as the volume of the respirometer. Typically, it is the
volume of the respirometer <em>minus</em> the volume of the specimen.
<a href="https://github.com/nicholascarey/respfun#eff_vol">See here</a> for help
with calculating effective volumes. It also does not refer to the specimen
volume.
</p>



<h4>Units</h4>

<p>The <code>oxy.unit</code> of the original raw data used to calculate the rate is
required. Concentration units should use only SI units (<code>L</code> or <code>kg</code>) for the
denominator, e.g. <code>"mg/L"</code>, <code>"mmol/kg"</code>. Percentage saturation of air
(<code style="white-space: pre;">⁠%Air⁠</code>) or oxygen (<code style="white-space: pre;">⁠%Oxy⁠</code>) is supported, as are oxygen pressure units. See
<code>unit_args()</code> for details.
</p>
<p>The <code>time.unit</code> of the original raw data used to calculate the rate is also
required (seconds, minutes, hours, or days).
</p>
<p>An <code>output.unit</code> is also required and must be in the sequence <em>Oxygen-Time</em>
(e.g. <code>"mg/h"</code>) for absolute rates, <em>Oxygen-Time-Mass</em> (e.g. <code>"mg/h/kg"</code>) for
mass-specific rates, and <em>Oxygen-Time-Area</em> (e.g. <code>"mg/h/cm2"</code>) for surface
area-specific rates. If left <code>NULL</code>, the default of <code>"mgO2/h"</code> is used, or
<code>"mgO2/h/kg"</code> or <code>"mgO2/h/m2"</code> if a <code>mass</code> or <code>area</code> respectively has been
entered.
</p>
<p>Note, some oxygen input or output units require temperature (<code>t</code>) and
salinity (<code>S</code>) to perform conversions. For freshwater experiments, salinity
should be entered as zero (i.e. <code>S = 0</code>).
</p>
<p>Strictly speaking, the atmospheric pressure (<code>P</code>) should also be entered. If
not, the default value of 1.013253 bar (standard pressure at sea level) is
used. In most locations which have a normal range of around 20 millibars
(outside of extreme weather events), any variability in pressure will have a
relatively minor effect on dissolved oxygen, and even less on calculated
rates. However, we would encourage users to enter the actual value if they
know it, or use historical weather data to find out what it was on the day.
See <code>unit_args()</code> for details.
</p>
<p>The function uses an internal database and a fuzzy string matching algorithm
to accept various unit formatting styles. For example, <code>"mg/l"</code>, <code>"mg/L"</code>,
<code>"mgL-1"</code>, <code>"mg l-1"</code>, <code>"mg.l-1"</code> are all parsed the same. See
<code>unit_args()</code> for details of accepted units and their formatting. See also
<code>convert_val()</code> for simple conversion between non-oxygen units.
</p>



<h4>Plot</h4>

<p>Plotting provides three ways of visualising the rates (or a selection of them
using <code>pos</code>), chosen using <code>type</code>. The default is <code>plot = FALSE</code> to prevent
plots being produced for every single conversion.
</p>
<p><code>type = "full"</code> (the default) plots a grid of up to 20 plots with each rate
highlighted on the full dataset, with the rate value in the title. Values on
the axes - time (bottom), row (top), and oxygen (left) - are in the units of
the original raw data. Rates are plotted in order of how they appear in the
summary table up to the first 20 rows, unless different rows have been
specified via <code>pos</code>.
</p>
<p><code>type = "rate"</code> plots the entire data timeseries on the upper plot, and on
the lower plot the output rate values in the chosen output units. Each rate
is plotted against the middle of the region used to determine it. <code>pos</code> can
be used to select a range of rates (i.e. summary table rows) to show in the
lower plot (default is all).
</p>
<p><code>type = "overlap"</code> visualises where regression results in the summary table
occur in relation to the original dataset to help understand how they are
distributed or may overlap, and is particularly useful for results from the
<code>auto_rate</code> <code>linear</code> method. The top plot is the entire data timeseries, the
bottom plot the region of the data each rate regression has been fit over.
The y-axis represents the position (i.e. row) of each in the summary table
descending from top to bottom. If no reordering or selection has been
performed, this will usually be equivalent to the <code style="white-space: pre;">⁠$rank⁠</code> column, but note as
reordering or selection is performed rank and summary table position will not
necessarily be equivalent. One result (summary table row) can be highlighted,
the default being <code>highlight = 1</code>. <code>pos</code> can be used to select a range of
summary rows to plot in the lower overlap plot.
</p>
<p>Other options:
</p>
<p><code>legend = FALSE</code> will suppress plot labels, <code>pos</code> selects summary rates to
plot, <code>quiet</code> suppresses console messages.
</p>



<h4>S3 Generic Functions</h4>

<p>Saved output objects can be used in the generic S3 functions <code>print()</code>,
<code>summary()</code>, and <code>mean()</code>.
</p>

<ul>
<li> <p><code>print()</code>: prints a single result, by default the first converted rate.
Others can be printed by passing the <code>pos</code> input. e.g. <code>print(x, pos = 2)</code>
</p>
</li>
<li> <p><code>summary()</code>: prints the output <code style="white-space: pre;">⁠$summary⁠</code> table of converted rates and
metadata. Specific rows can be specified with the <code>pos</code> input. e.g.
<code>summary(x, pos = 1:5)</code>. This can be exported as a separate data frame by
passing <code>export = TRUE</code> and includes all rate regression parameters, and data
locations, adjustments if applied, units, and more. The <code style="white-space: pre;">⁠$rep⁠</code> and <code style="white-space: pre;">⁠$rank⁠</code>
columns requires special notice depending on the type of experiment you have
analysed or the function you used to determine the rates. For the <code style="white-space: pre;">⁠$rank⁠</code>
column if <code>calc_rate</code> was used, it is the order of rates as entered using
<code>from</code> and <code>to</code> (if multiple rates were determined). For <code>auto_rate</code> it
relates to the <code>method</code> input, for example it indicates kernel density
ranking if the <code>linear</code> method was used, or ordering by rate value if
<code>lowest</code> or <code>highest</code> were used. For intermittent-flow experiments analysed
via <code>calc_rate.int</code> or <code>auto_rate.int</code> it indicates the ranking <em>within</em> each
replicate as seen in the <code style="white-space: pre;">⁠$rep⁠</code> column. Note that if <code>select_rate</code> has been
used the rows in the summary table may have been reordered, including the
<code style="white-space: pre;">⁠$rep⁠</code> and <code style="white-space: pre;">⁠$rank⁠</code> columns. The <em>original</em> rep and rank for each row is
retained if reordering occurred.
</p>
</li>
<li> <p><code>mean()</code>: calculates the mean of all converted rates, or those specified by
the <code>pos</code> input. e.g. <code>mean(x, pos = 1:5)</code> The mean can be exported as a
separate value by passing <code>export = TRUE</code>.
</p>
</li>
</ul>
<h4>More</h4>

<p>For additional help, documentation, vignettes, and more visit the <code>respR</code>
website at <a href="https://januarharianto.github.io/respR/">https://januarharianto.github.io/respR/</a>
</p>



<h3>Value</h3>

<p>Output is a <code>list</code> object of class <code>convert_rate</code> containing the
<code style="white-space: pre;">⁠$rate.input⁠</code>, and converted rate(s) in <code style="white-space: pre;">⁠$rate.output⁠</code> in the
<code style="white-space: pre;">⁠$output.unit⁠</code>, as well as inputs and summary elements. Note, <code style="white-space: pre;">⁠$rate.abs⁠</code>
is the <em>absolute</em> rate in the output unit minus the mass- or area-specific
component. The <code style="white-space: pre;">⁠$summary⁠</code> table element contains all rate regression
parameters and data locations (depending on what class of object was
entered), adjustments (if applied), units, and more. The <code style="white-space: pre;">⁠$rep⁠</code> and <code style="white-space: pre;">⁠$rank⁠</code>
columns require special notice depending on the type of experiment you have
analysed or the function you used to determine the rates. See the summary
table description in <strong>S3 Generic Functions</strong> section above.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Convert a single numeric rate to an absolute rate
convert_rate(0.09, oxy.unit = 'mg/l', time.unit = 's',
  output.unit = 'mg/min', volume = 1.2)

# Convert a single numeric rate to a mass-specific rate
convert_rate(0.09, oxy.unit = 'mg/l', time.unit = 's',
  output.unit = 'mg/min/kg', volume = 1.2, mass = 0.5)

# Convert a single numeric rate to an area-specific rate
convert_rate(0.09, oxy.unit = 'mg/l', time.unit = 's',
  output.unit = 'mg/min/cm2', volume = 1.2, area = 0.0002)

# Convert a single rate derived via calc_rate to mass-specific
x &lt;- calc_rate(sardine.rd, from = 200, to = 1800, by = "time")
convert_rate(x, oxy.unit = '%Air', time.unit = 's',
  output.unit = 'mg/h/g', volume = 12.3, mass = 0.05,
  S =35, t = 15, P = 1.013)

# Convert multiple rates derived via auto_rate to area-specific
x &lt;- auto_rate(sardine.rd)
rates &lt;- convert_rate(x, oxy.unit = '%Air', time.unit = 's',
  output.unit = 'mg/h/cm2', volume = 12.3, area = 0.00005,
  S =35, t = 15, P = 1.013)
summary(rates)

</code></pre>


</div>