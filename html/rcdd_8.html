<div class="container">

<table style="width: 100%;"><tr>
<td>allfaces</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>All Faces of a Convex Polyhedron</h2>

<h3>Description</h3>

<p>List all the nonempty faces of a convex polyhedron, giving for each
the dimension, the active set of constraints, and a relative interior point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">allfaces(hrep)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>hrep</code></td>
<td>
<p>H-representation of convex polyhedron (see details).</p>
</td>
</tr></table>
<h3>Details</h3>

<p>See <code>cddlibman.pdf</code> in the <code>doc</code> directory of this package,
especially Sections 1 and 2.
</p>
<p>This function lists all nonempty faces of a convex polyhedron
given by the H-representation given by the matrix <code>hrep</code>.
Let
</p>
<pre>
      l &lt;- hrep[ , 1]
      b &lt;- hrep[ , 2]
      v &lt;- hrep[ , - c(1, 2)]
      a &lt;- (- v)
  </pre>
<p>Then the convex polyhedron in question is the set of
points <code>x</code> satisfying
</p>
<pre>
      axb &lt;- a %*% x - b
      all(axb &lt;= 0)
      all(l * axb == 0)
  </pre>
<p>A nonempty <em>face</em> of a convex polyhedron <code class="reqn">P</code> is the subset
of <code class="reqn">P</code> that is the set of points over which some linear function
achieves its
maximum over <code class="reqn">P</code>.  Note that <code class="reqn">P</code> is a face of <code class="reqn">P</code> and appears
in the list of faces.  By definition the empty set is also a face, but
is not listed.   These two faces are said to be <em>improper</em>, the
other faces are <em>proper</em>.
</p>
<p>A face in the listing is characterized by the set of constraints that
are <em>active</em>, i. e., satisfied with equality, on the face.
</p>
<p>The <em>relative interior</em> of a convex set its its interior considered
as a subset of its affine hull.  The relative interior of
a one-point set is that point.  The relative interior of a multi-point
convex set is the union of open line segments <code class="reqn">(x, y)</code> with endpoints
<code class="reqn">x</code> and <code class="reqn">y</code> in the set.
</p>


<h3>Value</h3>

<p>a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>list of integers giving the dimensions of the faces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>active.set</code></td>
<td>
<p>list of integer vectors giving for each face the
set of constraints that are active (satisfied with equality) on
the face, the integers referring to row numbers of <code>hrep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative.interior.point</code></td>
<td>
<p>list of double or character vectors
(same type as <code>hrep</code>)
giving a point in the relative interior of each face.</p>
</td>
</tr>
</table>
<h3>Rational Arithmetic</h3>

<p>The argument <code>hrep</code> may
have type <code>"character"</code> in which case its elements are interpreted
as unlimited precision rational numbers.  They consist of an optional
minus sign, a string of digits of any length (the numerator),
a slash, and another string of digits of any length (the denominator).
The denominator must be positive.  If the denominator is one, the
slash and the denominator may be omitted.  This package
provides several functions (see ConvertGMP and ArithmeticGMP)
for conversion back and forth between R floating point numbers and rationals
and for arithmetic on GMP rationals.
</p>


<h3>Warning</h3>

<p>If you want correct answers, use rational arithmetic.  If you do not,
this function may (1) produce approximately correct answers, (2) fail with
an error, (3) give answers that are nowhere near correct with no error or
warning, or (4) crash R losing all work done to that point.  In large
simulations (1) is most frequent, (2) occurs roughly one time in a thousand,
(3) occurs roughly one time in ten thousand, and (4) has only occurred once
and only with the <code>redundant</code> function.  So the R floating point
arithmetic version does mostly work, but you cannot trust its results unless
you can check them independently.
</p>


<h3>See Also</h3>

<p><code>scdd</code>, <code>ArithmeticGMP</code>,
<code>ConvertGMP</code></p>


<h3>Examples</h3>

<pre><code class="language-R">hrep &lt;- rbind(c(0, 1,  1,  1, -1),
              c(0, 1,  1, -1, -1),
              c(0, 1, -1, -1, -1),
              c(0, 1, -1,  1, -1),
              c(0, 0,  0,  0,  1))

allfaces(d2q(hrep))
</code></pre>


</div>