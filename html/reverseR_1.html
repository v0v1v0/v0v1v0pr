<div class="container">

<table style="width: 100%;"><tr>
<td>bootLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric/Parametric bootstrap linear model</h2>

<h3>Description</h3>

<p>Nonparametric and parametric bootstrap (sampling cases, residuals or distributions with replacement) method for parameter estimation and confidence interval of a linear model. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootLM(model, type = c("cases", "residuals", "residuals2", "parametric"), 
       R = 10000, alpha = 0.05, ret.models = FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an <code>lm</code> model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>what to bootstrap. See "Details".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the <code class="reqn">\alpha</code>-level to use as the threshold border.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.models</code></td>
<td>
<p>logical. If <code>TRUE</code>, the <code>R</code> models are returned as a list.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>type = "cases"</code>, for all (<code class="reqn">x_i, y_i</code>) datapoints, linear models are created by sampling <code>R</code> times - with replacement - from <code class="reqn">n \in \{1 \ldots N\}</code> and building models <code class="reqn">Y_n = X_n\beta + \varepsilon</code>. This is also known as the .632-bootstrap, because the samples will, on average, contain <code class="reqn">1 - e^{-1} = 0.632</code> unique elements.
If <code>type = "residuals"</code>, for all residuals (<code class="reqn">r_i = y_i - \hat{y}_i</code>), linear models are created by sampling <code>R</code> times - with replacement - from <code class="reqn">n \in (1 \ldots N)</code> and building models <code class="reqn">\hat{Y}_i + r_n = X_i\beta + \varepsilon</code>. If <code>type = "residuals2"</code> is selected, scaled and centered residuals <code class="reqn">r_n = \frac{r_i}{\sqrt{1 - h_{ii}}} - \bar{r}</code> according to Davison &amp; Hinkley are used. In the <code>"parametric"</code> bootstrap, <code class="reqn">n</code> values drawn from a normal distribution <code class="reqn">j_n \in \mathcal{N}(0, \sigma)</code>, where <code class="reqn">\sigma = \sqrt{\frac{\sum(r_i)^2}{n - p}}</code>, are added to the fitted values, and linear models are created <code class="reqn">\hat{Y}_i + j_n = X_i\beta + \varepsilon</code>.
Parameter estimates are obtained from each sampling, from which the average <code class="reqn">\overline{P_{n}}</code> and standard error <code class="reqn">\hat{\sigma}</code> is calculated as well as a quantile based confidence interval. <em>p</em>-values are calculated through inversion of the confidence interval. 
</p>


<h3>Value</h3>

<p>A dataframe containing the estimated coefficients, their standard error, lower an upper confidence values and <em>p</em>-values. If <code>ret.models = TRUE</code> a list with all <code>R</code> models is returned.
</p>


<h3>Author(s)</h3>

<p>Andrej-Nikolai Spiess
</p>


<h3>References</h3>

<p>An Introduction to the Bootstrap.<br>
Efron B, Tibshirani R.<br>
Chapman &amp; Hall (1993).
</p>
<p>The Bootstrap and Edgeworth Expansion.<br>
Hall P.<br> 
Springer, New York (1992).
</p>
<p>Modern Statistics with R.<br>
Thulin M.<br>
Eos Chasma Press, Uppsala (2021).
</p>
<p>Bootstrap methods and their application.<br>
Davison AC, Hinkley DV.<br>
Cambridge University Press (1997).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example with single influencer (#18) and insignificant model (p = 0.115),
## using case bootstrap.
set.seed(123)
a &lt;- 1:20
b &lt;- 5 + 0.08 * a + rnorm(20, 0, 1)
LM &lt;- lm(b ~ a)
bootLM(LM, R = 100)

## using residuals bootstrap.
bootLM(LM, R = 100, type = "residuals")
</code></pre>


</div>