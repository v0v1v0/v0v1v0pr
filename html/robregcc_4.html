<div class="container">

<table style="width: 100%;"><tr>
<td>cpsc_sp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principal sensitivity component analysis with compositional covariates in sparse setting.</h2>

<h3>Description</h3>

<p>Produce model and its residual estimate based on PCS analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpsc_sp(
  X0,
  y0,
  alp = 0.4,
  cfac = 2,
  b1 = 0.25,
  cc1 = 2.937,
  C = NULL,
  we,
  type,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X0</code></td>
<td>
<p>CLR transformed predictor matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>model response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alp</code></td>
<td>
<p>(0,0.5) fraction of data sample to be removed to generate subsample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfac</code></td>
<td>
<p>initial value of shift parameter for weight construction/initialization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1</code></td>
<td>
<p>tukey bisquare function parameter producing desired breakdown point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc1</code></td>
<td>
<p>tukey bisquare function parameter producing desired breakdown point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>sub-compositional matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>we</code></td>
<td>
<p>penalization index for model parameters beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>1/2 for l1 / l2 loss in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of internal parameters controlling the model fitting</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>betaf</code></td>
<td>
<p>TModel parameter estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>residual estimate</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Mishra, A., Mueller, C.,(2019) <em>Robust regression with compositional covariates. In prepration</em>. arXiv:1909.04990.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 

library(robregcc)
library(magrittr)

data(simulate_robregcc)
X &lt;- simulate_robregcc$X;
y &lt;- simulate_robregcc$y
C &lt;- simulate_robregcc$C
n &lt;- nrow(X); p &lt;- ncol(X); k &lt;-  nrow(C)

Xt &lt;- cbind(1,X)  # include intercept in predictor
C &lt;- cbind(0,C)    # include intercept in constraint
bw &lt;- c(0,rep(1,p)) # weights not penalize intercept 

example_seed &lt;- 2*p+1               
set.seed(example_seed) 

# Breakdown point for tukey Bisquare loss function 
b1 = 0.5                    # 50% breakdown point
cc1 =  1.567                # corresponding model parameter
b1 = 0.25; cc1 =  2.937   

# Initialization [PSC analysis for compositional data]
control &lt;- robregcc_option(maxiter = 1000,
 tol = 1e-4,lminfac = 1e-7)
fit.init &lt;- cpsc_sp(Xt, y,alp = 0.4, cfac = 2, b1 = b1,
cc1 = cc1,C,bw,1,control) 

</code></pre>


</div>