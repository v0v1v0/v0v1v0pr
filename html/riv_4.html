<div class="container">

<table style="width: 100%;"><tr>
<td>riv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust instrumental variables estimator</h2>

<h3>Description</h3>

<p>Finds robust instrumental variables estimator using high breakdown
point multivariate location and scatter matrix S-estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">riv(Y, Xend, Xex=NULL, Zinst, dummies=NULL,
    method = c('S-est', 'SD-est', 'MCD-est', 'classical'))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xend</code></td>
<td>
<p>matrix of the endogenous variables, i.e. covariates that
are correlated with the regression's error term.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xex</code></td>
<td>
<p>matrix of the exogenous variables, i.e. covariates that are
uncorrelated with the regression's error term. Default =
<code>NULL</code>, i.e. no exogenous variables are present in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zinst</code></td>
<td>
<p>matrix of instruments, variables correlated with the
endogenous covariates, but uncorrelated with the error term. The
number of instrumental variables needs to be larger than or equal to
the number of endogenous covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dummies</code></td>
<td>
<p>matrix of exogenous dummy covariates, i.e.,
where each <code class="reqn">D_i</code> are 0â€“1 vectors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used. The "<code>S-est</code>" method
(default) is based on the S-estimator of multivariate location and
covariance, and "<code>classical</code>" method is based on the sample
mean and covariance and the resulting estimator is equivalent to the
two-stage least squares estimator (2SLS). See <code>Details</code>
section.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For method "<code>S-est</code>", RIV is constructed using the
robust multivariate location and scatter S-estimator based on
the Tukey's biweight function (see <code>CovSest</code>).
</p>
<p>If RIV is computed using the S-estimator, its variance-covariance
matrix is estimated based on the empirical influence function. See
references for more details.
</p>
<p>For method "<code>SD-est</code>", RIV is constructed using the
Stahel-Donoho's robust multivariate location and scatter estimator (see
<code>CovSde</code>).
</p>
<p>For method "<code>MCD-est</code>", RIV is constructed using the
Minimum Covariance Determinant (MCD) robust multivariate
location and scatter estimator (see <code>CovMcd</code>).
</p>
<p>For method "<code>classical</code>", the estimator is the classical
instrumental variables estimator based on the sample mean and sample
variance-covariance matrix (also known as the two-stage least squares estimator, 2SLS).
</p>
<p>If the model contains dummy variables (i.e., <code>dummies != NULL</code>),
RIV is computed using an iterative algorithm called "<code class="reqn">L_1</code>-RIV".
Briefly, <code class="reqn">L_1</code>-RIV estimates the coefficients of the dummies using
an <code class="reqn">L_1</code>-estimator and the coefficients of the continuous
covariates using the original RIV. See Cohen Freue et al. for more
details.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Summary.Table</code></td>
<td>
<p>Matrix of information available about the
estimator. It contains regression coefficients, and, for
<code>method</code> = "<code>S-est</code>" and "<code>classical</code>" only, columns
for the standard error, t-statistic, and p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VC</code></td>
<td>
<p>estimated variance-covariance matrix, computed only if
<code>method</code> = "<code>S-est</code>" or "<code>classical</code>"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MD</code></td>
<td>
<p>Squared Mahalanobis distances of each observation to the
multivariate location S-estimator with respect to the scatter
S-estimator (only computed if <code>method</code> = "<code>S-est</code>").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSE</code></td>
<td>
<p>vector of three components, computed only if <code>method</code>
= "<code>S-est</code>" or "<code>classical</code>":
</p>

<ul>
<li> <p><code>sigma.hat1</code>: the mean square error estimation;
</p>
</li>
<li> <p><code>sigma.hat2</code>: the mean square error estimation taking into
account the weights associated to each observation (only
computed if <code>method</code> = "<code>S-est</code>" and coefficents of
endogenous variables are exactly identified, i.e., the number of
instruments is equal to the number of endogenous variables);
</p>
</li>
<li> <p><code>sigma.hat3</code>: the squared median absolute deviation (only
computed if <code>method</code> = "<code>S-est</code>").
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>the weights assigned by RIV to each observation (only
computed if <code>method</code> = "<code>S-est</code>" and the number of
instruments is equal to the number of endogenous variables.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>LOPUHAA H.P. (1989). <em>On the Relation between S-estimators and M-estimators of Multivariate Location and Covariance. Ann. Statist.</em> <b>17</b> 1662-1683. 
</p>
<p>COHEN-FREUE, G.V., ORTIZ-MOLINA, H., and ZAMAR, R.H. (2012) <em>A
Natural Robustification of the Ordinary Instrumental Variables
Estimator.</em> Submitted to <em>Biometrics</em>.
</p>


<h3>See Also</h3>

<p><code>CovSest</code>, <code>CovSde</code>, <code>CovMcd</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## load data earthquake: the first column contains the response (Y), the
## second the endogenous variable (X) and the third column is the
## instrument (W).
data(earthquake) 
riv.eq &lt;- riv(earthquake$Y,earthquake$X,NULL,earthquake$W)

## plot of the RIV estimates and the outlying observations are
## identified by filled points
plot(earthquake$X,earthquake$Y,xlab="X",ylab="Y",cex=1.5)
abline(riv.eq$Summary.Table[,1])
outliers &lt;- which(sqrt(riv.eq$MD)&gt;sqrt(qchisq(0.99, 3)))
text(earthquake[outliers,2],
     earthquake[outliers,1],
     outliers,
     pos=c(4,4,4,2))
     
points(earthquake[outliers,2],
       earthquake[outliers,1],
       cex=1.5,pch=19)

## Weights given by RIV to each observation as a function of the square
## root of the Mahalanobis distances (d) of each observation to the
## multivariate location and covariance S-estimator (computed with
## CovSest in rrcov)
plot(sqrt(riv.eq$MD),riv.eq$weight,xlab="d",ylab="RIV's Weights",cex = 1.5)
abline(h=sqrt(qchisq(0.99, 3)))
text(sqrt(riv.eq$MD)[outliers],
     riv.eq$weight[outliers],
     outliers,
     pos=c(2, 1, 1, 4))
points(sqrt(riv.eq$MD)[outliers],
       riv.eq$weight[outliers],
       cex=1.5, pch=19)


## load data mortality
data(mortality) 
Y &lt;- as.matrix(mortality[,1])            ## M070
Xex &lt;- as.matrix(mortality[,c(2,3,5,6)]) ## MAGE,CI68,DENS,NONW 
Xend &lt;- as.matrix(mortality[,4])         ## MDOC  
colnames(Xend) &lt;- colnames(mortality)[4] 
Zinst &lt;- as.matrix(mortality[,7:8])      ## EDUC,IN69

## Classical instrumental variables estimator
riv(Y, Xend, Xex, Zinst, method="classical")
</code></pre>


</div>