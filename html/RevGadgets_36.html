<div class="container">

<table style="width: 100%;"><tr>
<td>setMRFGlobalScaleHyperpriorNShifts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sets a global scale parameter for a GMRF or HSMRF model given a prior
mean number of effective shifts.</h2>

<h3>Description</h3>

<p>This function finds the global scale parameter value that produces the
desired prior mean number of "effective" rate shifts. Given a specified
magnitude for an effective shift, shift_size, an effective shift occurs
when two adjacent values are more than shift_size-fold apart from each other.
That is, an effective shift is the event that rate[i+1]/rate[i] &gt; shift_size
or rate[i+1]/rate[i] &lt; 1/shift_size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setMRFGlobalScaleHyperpriorNShifts(
  n_episodes,
  model,
  prior_n_shifts = log(2),
  shift_size = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_episodes</code></td>
<td>
<p>(numeric; no default) The number of episodes in the random
field (the parameter vector will be this long).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>(character; no default) What model should the global scale
parameter be set for? Options are "GMRF" and "HSMRF" for first-order models
(also allowable: "GMRF1" and "HSMRF1") and "GMRF2" and HSMRF2" for
second-order models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_n_shifts</code></td>
<td>
<p>(numeric; log(2)) The desired prior mean number of
shifts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift_size</code></td>
<td>
<p>(numeric; 2) The magnitude of change that defines an
effective shift (measured as a fold-change).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Finding these values for a HSMRF model can take several seconds for large
values of n_episodes because of the required numerical integration.
</p>


<h3>Value</h3>

<p>The hyperprior.
</p>


<h3>References</h3>

<p>Magee et al. (2019) Locally adaptive Bayesian birth-death model
successfully detects slow and rapid rate shifts.
doi: https://doi.org/10.1101/853960
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Get global scale for a HSMRF model with 100 episodes.
gs &lt;- setMRFGlobalScaleHyperpriorNShifts(100, "HSMRF")

# Plot a draw from this HSMRF distribution

trajectory &lt;- simulateMRF(n_episodes = 100,
                          model = "HSMRF",
                          global_scale_hyperprior = gs)

plot(1:100,
     rev(trajectory),
     type = "l",
     xlab = "time",
     ylab = "speciation rate")

</code></pre>


</div>