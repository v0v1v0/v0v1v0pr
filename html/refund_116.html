<div class="container">

<table style="width: 100%;"><tr>
<td>vb_mult_wish</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multilevel FoSR using Variational Bayes and Wishart prior</h2>

<h3>Description</h3>

<p>Fitting function for function-on-scalar regression for cross-sectional data.
This function estimates model parameters using VB and estimates
the residual covariance surface using a Wishart prior. If prior hyperparameters
are <code>NULL</code> they are estimated using the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vb_mult_wish(
  formula,
  data = NULL,
  verbose = TRUE,
  Kt = 5,
  alpha = 0.1,
  min.iter = 10,
  max.iter = 50,
  Az = NULL,
  Bz = NULL,
  Aw = NULL,
  Bw = NULL,
  v = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula indicating the structure of the proposed model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment containing the 
variables in the model. If not found in data, the variables are taken from 
environment(formula), typically the environment from which the function is 
called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical defaulting to <code>TRUE</code> â€“ should updates on progress be printed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kt</code></td>
<td>
<p>number of spline basis functions used to estimate coefficient functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>tuning parameter balancing second-derivative penalty and
zeroth-derivative penalty (alpha = 0 is all second-derivative penalty)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.iter</code></td>
<td>
<p>minimum number of iterations of VB algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>maximum number of iterations of VB algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Az</code></td>
<td>
<p>hyperparameter for inverse gamma controlling variance of spline terms
for subject-level effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bz</code></td>
<td>
<p>hyperparameter for inverse gamma controlling variance of spline terms
for subject-level effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Aw</code></td>
<td>
<p>hyperparameter for inverse gamma controlling variance of spline terms
for population-level effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bw</code></td>
<td>
<p>hyperparameter for inverse gamma controlling variance of spline terms
for population-level effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>hyperparameter for inverse Wishart prior on residual covariance</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jeff Goldsmith <a href="mailto:ajg2202@cumc.columbia.edu">ajg2202@cumc.columbia.edu</a>
</p>


<h3>References</h3>

<p>Goldsmith, J., Kitago, T. (2016).
Assessing Systematic Effects of Stroke on Motor Control using Hierarchical 
Function-on-Scalar Regression. <em>Journal of the Royal Statistical Society:
Series C</em>, 65 215-236.
</p>


</div>