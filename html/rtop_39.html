<div class="container">

<table style="width: 100%;"><tr>
<td>rtopVariogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> create variogram for data with spatial support </h2>

<h3>Description</h3>

<p>rtopVariogram will create binned variogram or cloud variogram of data
with an areal support.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'rtop'
rtopVariogram(object, params = list(), ...) 
## S3 method for class 'SpatialPolygonsDataFrame'
rtopVariogram(object, ...) 
## S3 method for class 'SpatialPointsDataFrame'
rtopVariogram(object, formulaString, params=list(), cloud, 
                       abins, dbins, ...) 
## S3 method for class 'STSDF'
rtopVariogram(object, formulaString, params=list(), cloud, 
                       abins, dbins, data.table = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> object of class <code>rtop</code> (see rtop-package) or a <br><code>SpatialPolygonsDataFrame</code>
or <code>SpatialPointsDataFrame</code>
with information about observations. If <br><code>object</code> is a <br><code>SpatialPointsDataFrame</code>,
it must have a column with name <code>area</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulaString</code></td>
<td>
<p>formula that defines the dependent variable as a linear model 
of independent variables; suppose the dependent variable has name <code>z</code>, 
for ordinary and simple kriging use the formula <code>z~1</code>; 
for universal kriging, suppose <code>z</code> is linearly dependent on 
<code>x</code> and <code>y</code>, use the formula <code>z~x+y</code>. The formulaString defaults
to <code>"value~1"</code> if <code>value</code> is a part of the data set. 
If not, the first column of the data set is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a set of parameters, used to modify the default parameters for 
the <code>rtop</code> package, set in <code>getRtopParams</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cloud</code></td>
<td>
<p>logical; if TRUE, calculate the semivariogram cloud, can be used
to overrule the cloud parameter in params. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abins</code></td>
<td>
<p>possibility to set areal bins (not yet implemented)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbins</code></td>
<td>
<p>possibility to set distance bins (not yet implemented)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.table</code></td>
<td>
<p>an option to use data.table internally for the variogram computation for 
<code>STSDF</code>-objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>parameters to other functions called, e.g. gstat's 
<code>variogram</code>-function and to <code>rtopVariogram.SpatialPointsDataFrame</code>
when the method is called with an object of a different class</p>
</td>
</tr>
</table>
<h3>Value</h3>

 
<p>The function creates a variogram, either of type <code>rtopVariogram</code> or 
<code>rtopVariogramCloud</code>. This variogram is based on the <code>variogram</code>
function from gstat, but has additional information about the spatial size or
length of the observations. An rtop-object with the variogram added is 
returned if the function is called with an rtop-object as argument.
</p>
<p>For spatio-temporal objects (<code>STSDF</code>), the variogram is the spatially variogram, averaged for all time steps. There is a possibility to use data.table internally in this function, which can improve computation time for some cases.
</p>


<h3>Note</h3>

<p>The variogram cloud is similar to the variogram cloud from <code>gstat</code>,
with the area/length added to the resulting data.frame. The binned variogram is 
also based on the area or length, in addition to the distance between observations.
The bins equally distanced in the log10-space of the distances and areas (lengths).
The size of the bins is decided from the parameters <code>amul</code> and <code>dmul</code>, 
defining the number of bins per order of magnitude (1:10, 10:100, and so on).
</p>
<p>The distances between areas are in this function based on the centre of gravity.
</p>


<h3>Author(s)</h3>

<p> Jon Olav Skoien </p>


<h3>References</h3>

 
<p>Skoien J. O., R. Merz, and G. Bloschl. Top-kriging - geostatistics on stream networks.
Hydrology and Earth System Sciences, 10:277-287, 2006.
</p>
<p>Skoien, J. O., Bloschl, G., Laaha, G., Pebesma, E., Parajka, J., Viglione, A., 2014. Rtop: An R package for interpolation of data with a variable spatial support, with an example from river networks. Computers &amp; Geosciences, 67.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(sf)
rpath = system.file("extdata",package="rtop")
observations = st_read(rpath,"observations")
# Create a column with the specific runoff:
observations$obs = observations$QSUMMER_OB/observations$AREASQKM

vario = rtopVariogram(observations, cloud = TRUE)

## End(Not run)
</code></pre>


</div>