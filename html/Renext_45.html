<div class="container">

<table style="width: 100%;"><tr>
<td>LRExp.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood Ratio test of exponentiality vs. GPD</h2>

<h3>Description</h3>

<p>Likelihood Ratio test of exponentiality vs. GPD.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   LRExp.test(x,
              alternative = c("lomax", "GPD", "gpd", "maxlo"),
              method = c("num", "sim", "asymp"),
              nSamp = 15000,
              simW = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Numeric vector of positive sample values. For the POT context this
should be the vector of excesses over the threshold.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>Character string describing the alternative distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Method used to compute the <code class="reqn">p</code>-value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSamp</code></td>
<td>

<p>Number of samples for a simulation, if <code>method</code> is
<code>"sim"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simW</code></td>
<td>

<p>Logical. If this is set to <code>TRUE</code> and <code>method</code>
is <code>"sim"</code>, the simulated values are returned as
an element <code>W</code> in the list.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Lomax and maxlo alternatives correspond to a GPD alternative with
positive shape parameter <code class="reqn">\xi &gt; 0</code> (Lomax) and GPD with
<code class="reqn">\xi &lt; 0</code> (maxlo).
</p>
<p>The <em>asymptotic</em> distribution of the Likelihood-ratio statistic
is known. For the GPD alternative, this is a chi-square distribution
with one df.  For the Lomax alternative, this is the distribution of a
product <code class="reqn">BC</code> where <code class="reqn">B</code> and <code class="reqn">C</code> are two independent random
variables following a Bernoulli distribution with probability
parameter <code class="reqn">p = 0.5</code> and a chi-square distribution with one df.
</p>

<ul>
<li>
<p> When <code>method</code> is <code>"num"</code>, a numerical
approximation of the distribution is used. This method
is not unlike that used by Kozubowski et al., but a different
approximation is used. However, if <code>x</code> has a length
<code class="reqn">n &gt; 500</code>, the method is turned to <code>"asymp"</code>.
</p>
</li>
<li>
<p> When <code>method</code> is <code>"sim"</code>, <code>nSamp</code> samples of the
exponential distribution with the same size as <code>x</code> are drawn
and the LR statistic is computed for each sample. The <code class="reqn">p</code>-value
is simply the estimated probability that a simulated LR is greater
than the observed LR.
</p>
</li>
<li>
<p> Finally when <code>method</code> is <code>"asymp"</code>, the asymptotic
distribution is used.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list of results with elements <code>statistic</code>, <code>p.value</code>
and <code>method</code>. Other elements are
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>Character describing the alternative hypothesis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>If <code>simW</code> is <code>TRUE</code> and <code>method</code> is <code>"sim"</code>
only.  A vector of <code>nSamp</code> simulated values of the statistic
<code class="reqn">W := -2 \log \textrm{LR}</code>.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>For the Lomax alternative, the distribution of the test
statistic has <em>mixed type</em>: it can take any positive value as
well as the value <code class="reqn">0</code> with a positive probability mass. The
probability mass is the probability that the ML estimate of the GPD
shape parameter is negative, and a good approximation of it is
provided by the <code>pGreenwood1</code> function. Note that this
probability converges to its limit <code class="reqn">0.5</code> <em>very slowly</em>, which
suggests that the asymptotic distribution provides poor results for
medium sample sizes, say <code class="reqn">&lt; 100</code>.
</p>
<p>Similarly for a maxlo alternative, the distribution of the test
statistic has mixed type: it can take any positive value as
well as the value <code class="reqn">0</code> with a positive probability mass
approximately given by <code>1 -pGreenwood1(n)</code> where <code class="reqn">n</code>
is the sample size.
</p>


<h3>Author(s)</h3>

<p>Yves Deville
</p>


<h3>References</h3>

<p>T.J. Kozubowski, A. K. Panorska, F. Qeadan, A. Gershunov and
D. Rominger (2009)
"Testing Exponentiality Versus Pareto Distribution via Likelihood Ratio"
<em>Comm. Statist. Simulation Comput.</em> 38(1),
pp. 118-139.
</p>
<p>The approximation method used is described in the <em>Renext
Computing Details</em> report.
</p>


<h3>See Also</h3>

<p><code>Lomax</code>, <code>Maxlo</code>, <code>GPD</code> for the
alternatives used here.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
x &lt;- rGPD(n = 50, loc = 0, scale = 1, shape = 0.1)
LRExp.test(x, method = "num")$p.value
LRExp.test(x, method = "asymp")$p.value
## Not run: 
## requires much time
LRExp.test(x, method = "sim")$p.value

## End(Not run)
</code></pre>


</div>