<div class="container">

<table style="width: 100%;"><tr>
<td>ref_and_mix_pipeline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate mixing proportions from reference and mixture datasets</h2>

<h3>Description</h3>

<p>Takes a mixture and reference dataframe of two-column genetic data, and a
desired method of estimation for the population mixture proportions (MCMC, PB, or BH MCMC)
Returns the output of the chosen estimation method
</p>


<h3>Usage</h3>

<pre><code class="language-R">ref_and_mix_pipeline(
  reference,
  mixture,
  gen_start_col,
  method = "MCMC",
  reps = 2000,
  burn_in = 100,
  sample_int_Pi = 0,
  sample_int_PofZ = 0,
  sample_int_omega = 0,
  sample_int_rho = 0,
  sample_int_PofR = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>a dataframe of two-column genetic format data, proceeded by "repunit", "collection",
and "indiv" columns. Does not need "sample_type" column, and will be overwritten if provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixture</code></td>
<td>
<p>a dataframe of two-column genetic format data. Must have the same structure as
<code>reference</code> dataframe, but "collection" and "repunit" columns are ignored.
Does not need "sample_type" column, and will be overwritten if provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen_start_col</code></td>
<td>
<p>the first column of genetic data in both data frames</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>this must be "MCMC".   "PB" and "BH" are no longer supported in this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>the number of iterations to be performed in MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>how many reps to discard in the beginning of MCMC when doing the mean calculation.
They will still be returned in the traces if desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_int_Pi</code></td>
<td>
<p>the number of reps between samples being taken for pi traces. If 0
no traces are taken. Only used in methods "MCMC" and "PB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_int_PofZ</code></td>
<td>
<p>the number of reps between samples being taken for the posterior
traces of each individual's collection of origin. If 0 no trace samples are taken.
Used in all methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_int_omega</code></td>
<td>
<p>the number of reps between samples being taken for
collection proportion traces. If 0 no traces are taken. Only used in method "BH"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_int_rho</code></td>
<td>
<p>the number of reps between samples being taken for
reporting unit proportion  traces. If 0 no traces are taken. Only used in method "BH"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_int_PofR</code></td>
<td>
<p>the number of reps between samples being taken for the posterior
traces of each individual's reporting unit of origin. If 0 no trace samples are taken.
Only used in method "BH".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>"MCMC" estimates mixing proportions and individual posterior
probabilities of assignment through Markov-chain Monte Carlo,
while "PB" does the same with a parametric bootstrapping correction,
and "BH" uses the misassignment-scaled, hierarchical MCMC.
All methods use a uniform 1/(# collections or RUs) prior for pi/omega and rho.
</p>


<h3>Value</h3>

<p><code>mix_proportion_pipeline</code> returns the standard output of the chosen
mixing proportion estimation method (always a list). For method "PB",
returns the standard MCMC results, as well as the bootstrap-corrected
collection proportions under <code>$mean$bootstrap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">reference &lt;- small_chinook_ref
mixture &lt;- small_chinook_mix
gen_start_col &lt;- 5

# this function expects things as factors.  This function is old and needs
# to be replaced and deprecated.

reference$repunit &lt;- factor(reference$repunit, levels = unique(reference$repunit))
reference$collection &lt;- factor(reference$collection, levels = unique(reference$collection))
mixture$repunit &lt;- factor(mixture$repunit, levels = unique(mixture$repunit))
mixture$collection &lt;- factor(mixture$collection, levels = unique(mixture$collection))

mcmc &lt;- ref_and_mix_pipeline(reference, mixture, gen_start_col, method = "MCMC")

</code></pre>


</div>