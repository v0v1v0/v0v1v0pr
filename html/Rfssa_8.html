<div class="container">

<table style="width: 100%;"><tr>
<td>fforecast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional Singular Spectrum Analysis Recurrent and Vector Forecasting</h2>

<h3>Description</h3>

<p>Perform functional singular spectrum analysis (FSSA) recurrent forecasting
(FSSA R-forecasting) or vector forecasting (FSSA V-forecasting) on univariate
or multivariate functional time series (<code>funts</code>) observed over a
one-dimensional domain.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fforecast(
  U,
  groups = as.list(1L:10L),
  len = 1,
  method = "recurrent",
  only.new = TRUE,
  tol = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>an object of class <code>fssa</code> holding the decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a list of numeric vectors where each vector includes indices
of elementary components of a group used for reconstruction and
forecasting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len</code></td>
<td>
<p>integer, the desired length of the forecasted FTS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the type of forecasting to perform:
- "recurrent" for FSSA R-forecasting.
- "vector" for FSSA V-forecasting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.new</code></td>
<td>
<p>logical, if 'TRUE' then only forecasted FTS are returned, whole FTS otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a double specifying the tolerated error in the approximation of
the matrix used in forecasting algorithms.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class 'fforecast' which is a list of objects of class
<code>funts</code>, where each one corresponds to a forecasted group.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("Callcenter")
U &lt;- fssa(Callcenter, L = 28)
groups &lt;- list(1, 1:7)

## Perform FSSA R-forecast
pr_R &lt;- fforecast(
  U = U, groups = groups, only.new = FALSE,
  len = 30, method = "recurrent"
)

plot(pr_R,  group_index = 1 )


plotly_funts(pr_R[[2]], main = "group = '1:7'")

## Perform FSSA V-forecast
pr_V &lt;- fforecast(U = U, groups = groups, len= 30, method = "vector")

plot(pr_V, group_index = 1)

plotly_funts(pr_V[[2]], type = "3Dline" , main = "group = '1:7'")

# Multivariate forecasting example:
data("Montana")
time &lt;- Montana$time
grid &lt;- list(0:23, list(1:33, 1:33))
montana &lt;- eval.funts(Montana, argvals = grid)
montana[[2]] &lt;- array(
  scale(montana[[2]][, , ],
    center = min(montana[[2]][, , ]),
    scale = max(montana[[2]][, , ]) - min(montana[[2]][, , ])
  ),
  dim = c(33, 33, 133)
)
## Kernel density estimation of pixel intensity
NDVI &lt;- matrix(NA, nrow = 512, ncol = 133)
for (i in 1:133) NDVI[, i] &lt;- (density(montana[[2]][, , i], from = 0, to = 1)$y)

## Define functional objects
bs1 &lt;- Montana$basis[[1]]

require(fda)
bs2 &lt;- create.bspline.basis(nbasis = 15)
Y &lt;- funts(X = list(montana[[1]], NDVI), basisobj = list(bs1, bs2),
            vnames = c("Temperature", "NDVI Density"),
            dnames = c("Time", "NDVI"),
            tname = "Date")

plotly_funts(Y,
  main = c("Temperature", "NDVI"),
  xticklocs = list(c(0, 6, 12, 18, 23), seq(1, 512, len = 9)),
  xticklabels = list(c(0, 6, 12, 18, 23), seq(0, 1, len = 9))
)

U &lt;- fssa(Y = Y, L = 45)
plotly_funts(U$Lsingf[[1]])
plot(U$Lsingf[[2]])

groups &lt;- list(1, 1:3)
pr_R &lt;- fforecast(U = U, groups = groups,
                   only.new = FALSE, len = 10, method = "recurrent")
plot(pr_R)
plotly_funts(pr_R[[2]], main = "Recurrent method, group = '1:3'")

pr_V &lt;- fforecast(U = U, groups = groups, len = 10, method = "vector")
plot(pr_V, group_index = 1)
plotly_funts(pr_V[[2]], main = "Vector method, group = '1:3'")

## End(Not run)

</code></pre>


</div>