<div class="container">

<table style="width: 100%;"><tr>
<td>score.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Score Test for the Likelihood of the Record Indicators</h2>

<h3>Description</h3>

<p>This function performs score (or Lagrange multiplier) tests
for the likelihood of the record indicators <code class="reqn">I_t</code> to study the 
hypothesis of the classical record model (i.e., of IID continuous RVs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">score.test(
  X,
  record = c("upper", "lower"),
  alternative = c("two.sided", "greater", "less"),
  probabilities = c("different", "equal"),
  simulate.p.value = FALSE,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>record</code></td>
<td>
<p>A character string indicating the type of record, 
"upper" or "lower".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character indicating the alternative hypothesis 
(<code>"two.sided"</code>, <code>"greater"</code> or <code>"less"</code>). 
Different statistics are used in the one-sided and two-sided alternatives
(see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probabilities</code></td>
<td>
<p>A character indicating if the alternative hypothesis 
assume all series with <code>"equal"</code> or <code>"different"</code> probabilities
of record.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate.p.value</code></td>
<td>
<p>Logical. Indicates whether to compute p-values by
Monte Carlo simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An integer specifying the number of replicates used in the Monte 
Carlo estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null hypothesis of the score tests is that in every vector 
(columns of the matrix <code>X</code>), the probability of record at 
time <code class="reqn">t</code> is <code class="reqn">1/t</code> as in the classical record model, and 
the alternative depends on the <code>alternative</code> and <code>probabilities</code>
arguments. The probability at time <code class="reqn">t</code> is any value, but equal in the
<code class="reqn">M</code> series if <code>probabilities = "equal"</code>  or different in the 
<code class="reqn">M</code> series if <code>probabilities = "different"</code>. The alternative 
hypothesis is more specific in the first case than in the second one.
Furthermore, the <code>"two.sided"</code> <code>alternative</code> is tested with 
the usual Lagrange multiplier statistic, while the one-sided 
<code>alternatives</code> use specific statistics based on scores. 
(See Cebrián, Castillo-Mateo and Asín (2022) for details on these tests.)
</p>
<p>If <code>alternative = "two.sided" &amp; probabilities = "equal"</code>, under the
null, the Lagrange multiplier statistic has an asymptotic <code class="reqn">\chi^2</code> 
distribution with <code class="reqn">T-1</code> degrees of freedom. It has been seen that for
the approximation to be adequate <code class="reqn">M</code> should be greater than <code class="reqn">T</code>. 
Otherwise, a <code>simulate.p.value</code> can be computed.
</p>
<p>If <code>alternative = "two.sided" &amp; probabilities = "different"</code>, the 
asymptotic behaviour of the Lagrange multiplier statistic is not 
fulfilled, but the Monte Carlo approach to simulate the p-value is 
applied.
</p>
<p>If <code>alternative</code> is one-sided and <code>probabilities = "equal"</code>,
the statistic of the test is
</p>
<p style="text-align: center;"><code class="reqn">\mathcal{T} = \sum_{t=2}^T \frac{(t S_t-M)^2}{M(t-1)} I_{\{S_t &gt; M/t\}}.</code>
</p>

<p>The p-value of this test is estimated with Monte Carlo simulations,
since the compute the exact distribution of <code class="reqn">\mathcal{T}</code> is very 
expensive.   
</p>
<p>If <code>alternative</code> is one-sided and <code>probabilities = "different"</code>,
the statistic of the test is
</p>
<p style="text-align: center;"><code class="reqn">\mathcal{S} = \frac{\sum_{t=2}^T t (t S_t - M) / (t - 1)}{\sqrt{M \sum_{t=2}^T t^2 / (t - 1)}},</code>
</p>

<p>which is asymptotically standard normal distributed in <code class="reqn">M</code>. It is 
equivalent to the statistic of the weighted number of records 
<code>N.test</code> with weights <code class="reqn">\omega_t = t^2 / (t-1)</code>  
<code class="reqn">(t=2,\ldots,T)</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>"htest"</code>  with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Value of the  statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>Degrees of freedom of the approximate <code class="reqn">\chi^2</code> 
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the type of test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string indicating the alternative
hypothesis.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2), 313-330. 
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>


<h3>See Also</h3>

<p><code>lr.test</code>, <code>global.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(23)
# two-sided and different probabilities of record, always simulated the p-value
score.test(ZaragozaSeries, probabilities = "different")
# equal probabilities
score.test(ZaragozaSeries, probabilities = "equal")
# equal probabilities with simulated p-value
score.test(ZaragozaSeries, probabilities = "equal", simulate.p.value = TRUE)

# one-sided and different probabilities of record
score.test(ZaragozaSeries, alternative = "greater", probabilities = "different")
# different probabilities with simulated p-value
score.test(ZaragozaSeries, alternative = "greater", probabilities = "different", 
  simulate.p.value = TRUE)
# equal probabilities, always simulated the p-value
score.test(ZaragozaSeries, alternative = "greater", probabilities = "equal")
</code></pre>


</div>