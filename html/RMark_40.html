<div class="container">

<table style="width: 100%;"><tr>
<td>fill.covariates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fill covariate entries in MARK design matrix with values</h2>

<h3>Description</h3>

<p>Replaces covariate names in design matrix with specific values to compute
estimates of real parameters at those values using the dataframe from
<code>find.covariates</code> after any value replacement.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fill.covariates(model, values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>MARK model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>a dataframe matching structure of output from find.covariates
with the user-defined values entered</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The design matrix for a MARK model with individual covariates contains the
covariate names used in the model.  In computing the real parameters for the
encounter history of an individual it replaces instances of covariate names
with the individual covariate values.  This function replaces the cells in
the design matrix that contain individidual covariates with user-specified
values which is an edited version (if needed) of the dataframe returned by
<code>find.covariates</code>.
</p>


<h3>Value</h3>

<p>New design matrix with user-defined covariate values entered in
place of covariate names
</p>


<h3>Author(s)</h3>

<p>Jeff Laake
</p>


<h3>See Also</h3>

<p><code>find.covariates</code>, <code>compute.real</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(dipper)
dipper$nsex=as.numeric(dipper$sex)-1
dipper$weight=rnorm(294)   
#NOTE:  This generates random valules for the weights so the answers using 
# ~weight will vary each time it is run
mod=mark(dipper,model.parameters=list(Phi=list(formula=~nsex+weight)),delete=TRUE)
# Show approach using individual calls to find.covariates, fill.covariates 
# and compute.real
fc=find.covariates(mod,dipper)
fc$value[fc$var=="nsex"]=0 # assign sex value to Female
design=fill.covariates(mod,fc) # fill design matrix with values
# compute and output survivals for females at average weight
female.survival=compute.real(mod,design=design)[1,] 
female.survival
# Next show same thing with a call to compute.real and a data frame for 
# females and then males
# compute and output survivals for females at average weight
female.survival=compute.real(mod,data=
      data.frame(nsex=0,weight=mean(dipper$weight)))[1,] 
female.survival
male.survival=compute.real(mod,data=data.frame(nsex=1,
         weight=mean(dipper$weight)))[1,] 
male.survival
# Fit model using sex as a group/factor variable and 
# compute v-c matrix for estimates
mod=mark(dipper,groups="sex",
     model.parameters=list(Phi=list(formula=~sex+weight)),delete=TRUE)
survival.by.sex=compute.real(mod,data=dipper,vcv=TRUE)
survival.by.sex$real[1:2]  # estimates
survival.by.sex$se.real[1:2] # std errors
survival.by.sex$vcv.real[1:2,1:2] # v-c matrix
survival.by.sex$vcv.real[1,2]/prod(survival.by.sex$se.real[1:2]) 
# sampling correlation of the estimates

</code></pre>


</div>