<div class="container">

<table style="width: 100%;"><tr>
<td>twoLocusKinship</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-locus kinship coefficients</h2>

<h3>Description</h3>

<p>Computes the two-locus kinship coefficient of a pair of pedigree members, at
a given recombination rate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">twoLocusKinship(
  x,
  ids,
  rho,
  recombinants = NULL,
  verbose = FALSE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A pedigree in the form of a <code>pedtools::ped</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>A character (or coercible to character) containing ID labels of
two or more pedigree members.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A numeric vector of recombination rates; all entries must be in
the interval <code class="reqn">[0, 0.5]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recombinants</code></td>
<td>
<p>A logical of length 2, applicable only when <code>ids</code> has
length 2. When given, it indicates whether each of the two gametes is a
recombinant or non-recombinant. This parameter is mainly used by
<code>twoLocusIBD()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>A logical. If TRUE, detailed messages are printed during the
recursion process.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let A, B be two pedigree members, and L1, L2 two loci with a given
recombination rate rho. The two-locus kinship coefficient
<code class="reqn">\phi_{AB}(rho)</code> is defined as the probability that random gametes
segregating from A and B has IBD alleles at both L1 and L2 simultaneously.
</p>
<p>The implementation is based on the recursive algorithm described by Thompson
(1988).
</p>


<h3>References</h3>

<p>E. A. Thompson (1988). <em>Two-locus and Three-locus Gene Identity
by Descent in Pedigrees</em>. IMA Journal of Mathematics Applied in Medicine &amp;
Biology, vol. 5.
</p>


<h3>Examples</h3>

<pre><code class="language-R">######################
# Example 1: Full sibs
######################
x = nuclearPed(2)

k_0 = twoLocusKinship(x, ids = 3:4, rho = 0)
k_0.5 = twoLocusKinship(x, ids = 3:4, rho = 0.5)

stopifnot(k_0 == 1/4, k_0.5 == 1/16)


##################################################
# Example 2: Reproducing Fig. 3 in Thompson (1988)
# Note that in the article, curve (a) is wrong.
# See Erratum: https://doi.org/10.1093/imammb/6.1.1
##################################################

# Pedigrees (a) - (d)
ped.a = linearPed(3)
ped.b = avuncularPed(half = TRUE)
ped.c = cousinPed(1)
ped.d = doubleCousins(1, 1, half1 = TRUE, half2 = TRUE)

peds = list(
  a = list(ped = ped.a, ids = c(1,7)),
  b = list(ped = ped.b, ids = leaves(ped.b)),
  c = list(ped = ped.c, ids = leaves(ped.c)),
  d = list(ped = ped.d, ids = leaves(ped.d))
)

twoLocusPlot(peds, coeff = "kinship", lty = 1:4)

</code></pre>


</div>