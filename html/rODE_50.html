<div class="container">

<table style="width: 100%;"><tr>
<td>getStepSize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>getStepSize</h2>

<h3>Description</h3>

<p>Get the current value of the step size
</p>


<h3>Usage</h3>

<pre><code class="language-R">getStepSize(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a class object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># +++++++++++++++++++++++++++++++++++++++++ Example:      ComparisonRK45ODEApp.R
# Updates the ODE state instead of using the internal state in the ODE solver
# Also plots the solver solution versus the analytical solution at a
# tolerance of 1e-6
# Example file: ComparisonRK45ODEApp.R
# ODE Solver:   Runge-Kutta 45
# ODE class :   RK45
# Base class:   ODETest

library(ggplot2)
library(dplyr)
library(tidyr)

importFromExamples("ODETest.R")

ComparisonRK45ODEApp &lt;- function(verbose = FALSE) {
    ode &lt;- new("ODETest")                         # new ODE instance
    ode_solver &lt;- RK45(ode)                       # select ODE solver
    ode_solver &lt;- setStepSize(ode_solver, 1)      # set the step

    # two ways to set tolerance
      # ode_solver &lt;- setTolerance(ode_solver, 1e-6)
    setTolerance(ode_solver) &lt;-  1e-6

    time &lt;-  0
    rowVector &lt;- vector("list")                   # row vector
    i &lt;- 1    # counter
    while (time &lt; 50) {
        # add solution objects to a row vector
        rowVector[[i]] &lt;- list(t     = getState(ode)[2],
                               ODE   = getState(ode)[1],
                               s2    = getState(ode)[2],
                               exact = getExactSolution(ode, time),
                               rate.counts = getRateCounts(ode),
                               time = time )
        ode_solver &lt;- step(ode_solver)            # advance solver one step
        stepSize &lt;-  getStepSize(ode_solver)      # get the current step size
        time  &lt;- time + stepSize
        ode   &lt;- getODE(ode_solver)               # get updated ODE object
        state &lt;- getState(ode)                    # get the `state` vector
        i &lt;- i + 1                                # add a row vector
    }
    DT &lt;- data.table::rbindlist(rowVector)        # create data table
    return(DT)
}

solution &lt;- ComparisonRK45ODEApp()
plot(solution)


# aditional plot for analytics solution vs. RK45 solver
solution.multi &lt;- solution %&gt;%
    select(t, ODE, exact)
plot(solution.multi)             # 3x3 plot

# plot comparative curves analytical vs ODE solver
solution.2x1 &lt;- solution.multi %&gt;%
    gather(key, value, -t)         # make a table of 3 variables. key: ODE/exact

g &lt;- ggplot(solution.2x1, mapping = aes(x = t, y = value, color = key))
g &lt;-  g + geom_line(size = 1) +
    labs(title = "ODE vs Exact solution",
         subtitle = "tolerance = 1E-6")
print(g)




</code></pre>


</div>