<div class="container">

<table style="width: 100%;"><tr>
<td>ts.buoyancy.freq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the buoyancy (Brunt-Vaisala) frequency for a temperature profile.</h2>

<h3>Description</h3>

<p>Function for simplifying the calculation of buoyancy frequency. Can usually
be called directly on data loaded directly using <code>load.ts</code> and
<code>load.bathy</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ts.buoyancy.freq(wtr, at.thermo = TRUE, na.rm = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wtr</code></td>
<td>
<p>A data frame of water temperatures (in Celsius). Loaded using
<code>load.ts</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.thermo</code></td>
<td>
<p>Boolean indicating if only buoyancy frequency at the
thermocline should be returned. If false, full profile is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Boolean indicated if step-by-step removal of NA's should be
tried. If false, a timestep with any NA values will likely return an NA
value. If true, best effort will be made to calculate indices despite NA
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters will be passed on to <code>thermo.depth</code>
function when extracting buoyancy frequency at only the thermocline.  Common
parameters to supply would be <code>seasonal</code> and <code>slope</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a data frame with the timeseries of buoyancy frequency in
units <code>sec^-2</code>. Includes a ‘datetime’ column.
</p>


<h3>References</h3>

<p>Imberger, J., Patterson, J.C., 1990. <em>Physical limnology</em>.
Advances in Applied Mechanics 27, 353-370.
</p>


<h3>See Also</h3>

<p><code>buoyancy.freq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

	#Get the path for the package example file included
	wtr.path &lt;- system.file('extdata', 'Sparkling.daily.wtr', package="rLakeAnalyzer")
	
	#Load data for example lake, Sparkilng Lake, Wisconsin.
	sp.wtr = load.ts(wtr.path)
	
	N2 = ts.buoyancy.freq(sp.wtr, seasonal=FALSE)
	SN2 = ts.buoyancy.freq(sp.wtr, seasonal=TRUE)
	
	plot(N2, type='l', ylab='Buoyancy Frequency', xlab='Date')
	lines(SN2, col='red')
	
</code></pre>


</div>