<div class="container">

<table style="width: 100%;"><tr>
<td>fitAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>AR regressions by REML</h2>

<h3>Description</h3>

<p><code>fitAR</code> is used to fit AR(1) time series regression
analysis using restricted maximum likelihood
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitAR(formula, data = NULL)

AR_fun(par, y, X, logLik.only = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a model formula, as used by <code>stats::lm()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data environment to search for variables in <code>formula</code>.
As used by <code>lm()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>AR parameter value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of time series (response)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>model matrix (predictors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik.only</code></td>
<td>
<p>logical: should only the partial log-likelihood be computed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function finds the restricted maximum likelihood (REML) to estimate
parameters for the regression model with AR(1) random error terms
</p>
<p style="text-align: center;"><code class="reqn">y(t) =  X(t) \beta + \varepsilon(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">\varepsilon(t) =  \rho \varepsilon(t-1) + \delta(t)</code>
</p>

<p>where <code class="reqn">y(t)</code> is the response at time <code class="reqn">t</code>;
</p>
<p><code class="reqn">X(t)</code> is a model matrix containing covariates;
</p>
<p><code class="reqn">\beta</code> is a vector of effects of <code class="reqn">X(t)</code>;
<code class="reqn">\varepsilon(t)</code> is the autocorrelated random error;
</p>
<p><code class="reqn">\delta \sim N(0, \sigma)</code> is a temporally independent
Gaussian random variable with mean zero and standard deviation
<code class="reqn">\sigma</code>;
</p>
<p>and <code class="reqn">\rho</code> is the AR(1) autoregression parameter
</p>
<p><code>fitAR</code> estimates the parameter via mathematical optimization
of the restricted log-likelihood function.
</p>
<p><code>AR_fun</code> is the work horse behind <code>fitAR</code> that is called
by <code>optim</code> to estimate the autoregression parameter <code class="reqn">\rho</code>.
</p>


<h3>Value</h3>

<p><code>fitAR</code> returns a list object of class "remoteTS", which contains
the following elements.
</p>

<dl>
<dt>call</dt>
<dd>
<p>the function call</p>
</dd>
<dt>coefficients</dt>
<dd>
<p>a named vector of coefficients</p>
</dd>
<dt>SE</dt>
<dd>
<p>the standard errors of parameter estimates</p>
</dd>
<dt>tstat</dt>
<dd>
<p>the t-statistics for coefficients</p>
</dd>
<dt>pval</dt>
<dd>
<p>the p-values corresponding to t-tests of coefficients</p>
</dd>
<dt>MSE</dt>
<dd>
<p>the model mean squared error</p>
</dd>
<dt>logLik</dt>
<dd>
<p>the log-likelihood of the model fit</p>
</dd>
<dt>residuals</dt>
<dd>
<p>the residuals: response minus fitted values</p>
</dd>
<dt>fitted.values</dt>
<dd>
<p>the fitted mean values</p>
</dd>
<dt>rho</dt>
<dd>
<p>The AR parameter, determined via REML</p>
</dd>
<dt>rank</dt>
<dd>
<p>the numeric rank of the fitted model</p>
</dd>
<dt>df.residual</dt>
<dd>
<p>the residual degrees of freedom</p>
</dd>
<dt>terms</dt>
<dd>
<p>the <code>stats::terms</code> object used</p>
</dd>
</dl>
<p>Output is structured similarly to an "lm" object.
</p>
<p>When <code>logLik.only == F</code>, <code>AR_fun</code> returns the output described in
<code>?fitAR</code>. When <code>logLik.only == T</code>, it returns a quantity that is
linearly and negatively related to the restricted log likelihood
(i.e., partial log-likelihood).
</p>


<h3>References</h3>

<p>Ives, A. R., K. C. Abbott, and N. L. Ziebarth. 2010. Analysis of ecological
</p>
<p>time series with ARMA(p,q) models. Ecology 91:858-871.
</p>


<h3>See Also</h3>

<p><code>fitAR_map</code> to easily apply <code>fit_AR</code> to many pixels;
<code>fitCLS</code> and <code>fitCLS_map</code> for conditional least squares
time series analyses.
</p>
<p>Other remoteTS: 
<code>fitAR_map()</code>,
<code>fitCLS_map()</code>,
<code>fitCLS()</code>
</p>
<p>Other remoteTS: 
<code>fitAR_map()</code>,
<code>fitCLS_map()</code>,
<code>fitCLS()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# simulate dummy data
t = 1:30 # times series
Z = rnorm(30) # random independent variable
x = .2*Z + (.05*t) # generate dependent effects
x[2:30] = x[2:30] + .2*x[1:29] # add autocorrelation

# fit the AR model, using Z as a covariate
(AR = fitAR(x ~ Z))

# get specific components
AR$residuals
AR$coefficients
AR$pval

# now using time as a covariate
(AR.time &lt;- fitAR(x ~ t))

# source variable from a dataframe
df = data.frame(y = x, t.scaled = t/30, Z = Z)
fitAR(y ~ t.scaled + Z, data = df)

## Methods
summary(AR)
residuals(AR)
coefficients(AR)

</code></pre>


</div>