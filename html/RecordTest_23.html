<div class="container">

<table style="width: 100%;"><tr>
<td>p.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probabilities of Record Plots</h2>

<h3>Description</h3>

<p>This function builds a ggplot object to display different 
functions of the record probabilities at time <code class="reqn">t</code>, <code class="reqn">p_t</code>.
A graphical tool to study the hypothesis of the classical record model 
(i.e., of IID continuous RVs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.plot(
  X,
  plot = c("1", "2", "3"),
  record = c(FU = 1, FL = 1, BU = 1, BL = 1),
  point.col = c(FU = "red", FL = "blue", BU = "red", BL = "blue"),
  point.shape = c(FU = 19, FL = 19, BU = 4, BL = 4),
  conf.int = TRUE,
  conf.level = 0.9,
  conf.aes = c("ribbon", "errorbar"),
  conf.col = "grey69",
  smooth = TRUE,
  smooth.formula = y ~ x,
  smooth.method = stats::lm,
  smooth.weight = TRUE,
  smooth.linetype = c(FU = 1, FL = 1, BU = 2, BL = 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>One of the values "1", "2" or "3" (character or numeric class 
are both allowed). It determines the type of plot to be displayed (see 
Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>record</code></td>
<td>
<p>Logical vector. Vector with four elements indicating if 
forward upper, forward lower, backward upper and backward lower are going
to be shown, respectively. Logical values or 0,1 values are accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.col, point.shape</code></td>
<td>
<p>Vector with four elements indicating the colour
and shape of the points. Every one of the four elements represents forward
upper, forward lower, backward upper and backward lower, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>Logical. Indicates if the RIs are also shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>(If <code>conf.int == TRUE</code>) Confidence level of the RIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.aes</code></td>
<td>
<p>(If <code>conf.int == TRUE</code>) A character string indicating 
the aesthetic to display for the RIs, <code>"ribbon"</code> (grey area) or 
<code>"errorbar"</code> (vertical lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.col</code></td>
<td>
<p>Colour used to plot the expected value and (if 
<code>conf.int == TRUE</code>) RIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>(If <code>plot = 1</code> or <code>3</code>) Logical. If <code>TRUE</code>, a
smoothing in the probabilities is also plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.formula</code></td>
<td>
<p>(<code>smooth = TRUE</code>) <code>formula</code> to use 
in the smooth function, e.g., <code>y ~ x</code>, 
<code>y ~ poly(x, 2, raw = TRUE)</code>, <code>y ~ log(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.method</code></td>
<td>
<p>(If <code>smooth = TRUE</code>) Smoothing method (function) 
to use, e.g., <code>lm</code> or <code>loess</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.weight</code></td>
<td>
<p>(If <code>smooth = TRUE</code>) Logical. If <code>TRUE</code> 
(the default) the smoothing is estimated with weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.linetype</code></td>
<td>
<p>(If <code>smooth = TRUE</code>) Vector with four elements 
indicating the line type of the smoothing. Every one of the four elements
represents forward upper, forward lower, backward upper and backward
lower, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to pass through the smooth 
(see <code>ggplot2::geom_smooth</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Three different types of plots which aim to analyse the hypothesis
of the classical record model using the record probabilities are 
implemented. Estimations of the record probabilities <code class="reqn">\hat p_t</code> used
in the plots are obtained as the proportion of records at time <code class="reqn">t</code>
in <code class="reqn">M</code> vectors (columns of matrix <code>X</code>) (see 
<code>p.record</code>).
</p>
<p>Type 1 is the plot of the observed values <code class="reqn">t \hat p_t</code> versus time 
<code class="reqn">t</code> (see <code>p.regression.test</code> for its associated test and
details). 
The expected values under the classical record model are <code class="reqn">1</code> for any
value <code class="reqn">t</code>, so that a cloud of points around <code class="reqn">1</code> and with no trend
should be expected. The estimated values are plotted, together with 
binomial reference intervals (RIs). In addition, a smoothing function
can be fitted to the cloud of points.
</p>
<p>Type 2 is the plot of the estimated record probabilities <code class="reqn">p_t</code> versus
time <code class="reqn">t</code>. The expected probabilities under the classical record model, 
<code class="reqn">p_t=1/t</code>, are also plotted, together with binomial RIs. 
</p>
<p>Type 3 is the same plot but on a logarithmic scale, so that the
expected value is <code class="reqn">-\log(t)</code>. In this case, another smoothing 
function can be fitted to the cloud of points.
</p>
<p>Type 1 plot was proposed by Cebrián, Castillo-Mateo, Asín (2022), while 
type 2 and 3 appear in Benestad (2003, Figures 8 and 9, 2004, Figure 4).
</p>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Benestad RE (2003). 
“How Often Can We Expect a Record Event?” 
<em>Climate Research</em>, <strong>25</strong>(1), 3-13.
<a href="https://doi.org/10.3354/cr025003">doi:10.3354/cr025003</a>.
</p>
<p>Benestad RE (2004). 
“Record-Values, Nonstationarity Tests and Extreme Value Distributions.” 
<em>Global and Planetary Change</em>, <strong>44</strong>(1-4), 11–26. 
<a href="https://doi.org/10.1016/j.gloplacha.2004.06.002">doi:10.1016/j.gloplacha.2004.06.002</a>.
</p>
<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2), 313-330. 
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>


<h3>See Also</h3>

<p><code>p.regression.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># three plots available
p.plot(ZaragozaSeries, plot = 1)
p.plot(ZaragozaSeries, plot = 2)
p.plot(ZaragozaSeries, plot = 3)

# Posible fits (plot 1):
#fit a line
p.plot(ZaragozaSeries, record = c(1,0,0,0))
# fit a second order polynomial
p.plot(ZaragozaSeries, record = c(1,0,0,0), 
  smooth.formula = y ~ poly(x, degree = 2))
# force the line to pass by E(t*p_t) = 1 when t = 1, i.e., E(t*p_t) = 1 + beta_1 * (t-1)
p.plot(ZaragozaSeries, record = c(1,0,0,0), 
  smooth.formula = y ~ I(x-1) - 1 + offset(rep(1, length(x))))
# force the second order polynomial pass by E(t*p_t) = 1 when t = 1
p.plot(ZaragozaSeries, record = c(1,0,0,0), 
  smooth.formula = y ~ I(x-1) + I(x^2-1) - 1 + offset(rep(1, length(x))))
# fit a loess
p.plot(ZaragozaSeries, record = c(1,0,0,0), 
  smooth.method = stats::loess, span = 0.25)
</code></pre>


</div>