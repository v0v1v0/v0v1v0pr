<div class="container">

<table style="width: 100%;"><tr>
<td>ArchiveGribGrab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Download archived model data from the NOMADS server.
</h2>

<h3>Description</h3>

<p>This function gives access to archived NOMADS model data.
The available models can be viewed by calling <code>NOMADSArchiveList</code> without arguments.
The data arrives in grib (gridded binary) format that can be read with <code>ReadGrib</code>.
Some of these files are in GRIB format, others are in GRIB2 format; select the appropriate file type when calling <code>ReadGrib</code>.
Note that this is a legacy function that emulates the archive data retrieval capability when NOMADS NCEP used to host past data sets.  
At present the data are hosted on NCEI.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">ArchiveGribGrab(abbrev, model.date, model.run, preds,
    local.dir = NULL, file.names = NULL, tidy = FALSE,
    verbose = TRUE, download.method = NULL, file.type = "grib2")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>abbrev</code></td>
<td>

<p>Model abbreviation per <code>NOMADSArchiveList</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.date</code></td>
<td>

<p>The year, month, and day of the model run, in YYYYMMDD format
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.run</code></td>
<td>

<p>Which hour the model was run (i.e. 00, 06, 12, 18 for GFS)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preds</code></td>
<td>

<p>A scalar or vector of prediction to get (analysis is 00)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local.dir</code></td>
<td>

<p>Where to save the grib file, defaults to the current directory.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.names</code></td>
<td>

<p>A list of length <code>length(preds)</code> of file names to which the 
downloaded GRIB files are directed to.  
Default <code>NULL</code>, meaning files will be named per their model date and time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tidy</code></td>
<td>

<p>If <code>TRUE</code>, remove all files with the suffix ".grb" from <code>local.dir</code> prior to downloading a new grib file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>If <code>TRUE</code>, give information on connection status.  Default <code>TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>download.method</code></td>
<td>

<p>Allows the user to set the download method used by <code>download.file</code>: <code>"internal"</code>, <code>"wget"</code> <code>"curl"</code>, <code>"lynx"</code>.
If <code>NULL</code> (the default), let R decide.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.type</code></td>
<td>

<p>Determine whether to get GRIB1 (<code>"grib1"</code>) or GRIB2 (<code>"grib2"</code>) file formats.
Sometimes both are available, sometimes only one.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>grib.info$file.name</code></td>
<td>
<p>The path and file name of the grib file that was downloaded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grib.info$url</code></td>
<td>
<p>The URL that the grib file was downloaded from</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>References</h3>

<p><a href="https://www.ncei.noaa.gov/data/">https://www.ncei.noaa.gov/data/</a>
</p>


<h3>See Also</h3>

<p><code>CheckNOMADSArchive</code>, <code>NOMADSArchiveList</code>, <code>ReadGrib</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#An example for the Global Forecast System
#Get data for January 1 2014
#Temperature at 2 m above ground
#3 hour prediction
# using GRIB

abbrev &lt;- "gfsanl"
model.date &lt;- 20140101
model.run &lt;- 06
preds &lt;- 3

## Not run: 
model.info &lt;- ArchiveGribGrab(abbrev, model.date, 
    model.run, preds, file.type = "grib2")
model.data &lt;- ReadGrib(model.info[[1]]$file.name, c("2 m above ground"), c("TMP"))

#Get surface temperature in Chapel Hill, NC
lat &lt;- 35.907605
lon &lt;- -79.052147

profile &lt;- BuildProfile(model.data, lon, lat, TRUE)
print(paste0("The temperature prediction in Chapel Hill was ", 
    sprintf("%.0f", profile[[1]]$profile.data[1,1,1] - 272.15), " degrees Celsius."))

## End(Not run)
</code></pre>


</div>