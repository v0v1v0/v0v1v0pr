<div class="container">

<table style="width: 100%;"><tr>
<td>loss_h</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Loss function for registration step optimization</h2>

<h3>Description</h3>

<p>Loss function for registration step optimization
</p>


<h3>Usage</h3>

<pre><code class="language-R">loss_h(
  Y,
  Theta_h,
  mean_coefs,
  knots,
  beta.inner,
  family,
  t_min,
  t_max,
  t_min_curve,
  t_max_curve,
  incompleteness = NULL,
  lambda_inc = NULL,
  periodic = FALSE,
  Kt = 8,
  warping = "nonparametric",
  priors = FALSE,
  prior_sd = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>vector of observed points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta_h</code></td>
<td>
<p>B-spline basis for inverse warping functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_coefs</code></td>
<td>
<p>spline coefficient vector for mean curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>knot locations for B-spline basis used to estimate mean and FPC basis function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.inner</code></td>
<td>
<p>spline coefficient vector to be estimated for warping function h.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>One of <code>c("gaussian","binomial","gamma","poisson")</code>.
For internal purposes, can also be set to <code>"gamma-varEM"</code> and
<code>"poisson-varEM"</code> if the preceding FPCA step in <code>register_fpca</code> was
performed with <code>fpca_type = "variationalEM"</code> which uses Gaussian family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_min, t_max</code></td>
<td>
<p>minimum and maximum value to be evaluated on the time domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_min_curve, t_max_curve</code></td>
<td>
<p>minimum and maximum value of the observed time domain of the
(potentially incomplete) curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incompleteness</code></td>
<td>
<p>Optional specification of incompleteness structure.
One of <code>c("leading","trailing","full")</code>, specifying that incompleteness
is present only in the initial measurements, only in the trailing measurements, or
in both, respectively. For details see the accompanying vignette.
Defaults to NULL, i.e. no incompleteness structure.
Can only be set when <code>warping = "nonparametric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_inc</code></td>
<td>
<p>Penalization parameter to control the amount of
overall dilation of the domain.
The higher this lambda, the more the registered domains are forced to have the
same length as the observed domains.
Only used if <code>incompleteness</code> is not NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodic</code></td>
<td>
<p>If <code>TRUE</code> uses periodic b-spline basis functions. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kt</code></td>
<td>
<p>Number of B-spline basis functions used to estimate mean functions. Default is 8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warping</code></td>
<td>
<p>If <code>nonparametric</code> (default), inverse warping functions are estimated nonparametrically. 
If <code>piecewise_linear2</code> they follow a piecewise linear function with 2 knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors</code></td>
<td>
<p>For <code>warping = "piecewise_linear2"</code> only. Logical indicator of whether to add Normal priors to pull the knots toward the identity line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_sd</code></td>
<td>
<p>For <code>warping = "piecewise_linear2"</code> with <code>priors = TRUE</code> only. User-specified standard deviation for the Normal priors 
(single value applied to all 4 knot priors).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The scalar value taken by the loss function.
</p>


<h3>Author(s)</h3>

<p>Julia Wrobel <a href="mailto:julia.wrobel@cuanschutz.edu">julia.wrobel@cuanschutz.edu</a>,
Erin McDonnell <a href="mailto:eim2117@cumc.columbia.edu">eim2117@cumc.columbia.edu</a>,
Alexander Bauer <a href="mailto:alexander.bauer@stat.uni-muenchen.de">alexander.bauer@stat.uni-muenchen.de</a>
</p>


</div>