<div class="container">

<table style="width: 100%;"><tr>
<td>predictCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a predicted value matrix (fit, lwr, upr) for a
regression, either lm or glm, on either link or response scale.</h2>

<h3>Description</h3>

<p>This adapts code from predict.glm and predict.lm. I eliminated
type = "terms" from consideration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predictCI(
  object,
  newdata = NULL,
  type = c("response", "link"),
  interval = c("none", "confidence", "prediction"),
  dispersion = NULL,
  scale = NULL,
  na.action = na.pass,
  level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Regression object, class must include glm or lm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Data frame including focal values for predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>One of c("response", "link"), defaults to former.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>One of c("none", "confidence",
"prediction"). "prediction" is defined only for lm objects, not
for glm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>
<p>Will be estimated if not provided. The variance
coefficient of the glm, same as scale squared. Dispersion is
allowed as an argument in predict.glm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>The square root of dispersion. In an lm, this is the
RMSE, called sigma in summary.lm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>What to do with missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Optional. Default = 0.95.  Specify whatever
confidence level one desires.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to predict</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>R's predict.glm does not have an interval argument. There are
about 50 methods to calculate CIs for predicted values of GLMs,
that's a major worry. This function takes the simplest route, calculating the
(fit, lwr, upr) in the linear predictor scale, and then if type=
"response", those 3 columns are put through linkinv().  This is
the same method that SAS manuals suggest they use, same as Ben
Bolker suggests in r-help (2010).  I'd rather use one of the
fancy tools like Edgeworth expansion, but that R code is not
available (but is promised).
</p>
<p>Use predict.lm with se.fit = TRUE to calculate fit and se.fit.
Then calculate lwr and upr as fit +/- tval * se.fit. If model is
lm, the model df.residual will be used to get tval. If glm, this
is a normal approximation, so we thugishly assert tval = 1.98.
</p>
<p>There's some confusing term translation. I wish R lm and glm would
be brought into line. For lm, residual.scale = sigma. For glm,
residual.scale = sqrt(dispersion)
</p>


<h3>Value</h3>

<p>c(fit, lwr, upr), and possibly more.
</p>


</div>