<div class="container">

<table style="width: 100%;"><tr>
<td>Parafac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust Parafac estimator for compositional data
</h2>

<h3>Description</h3>

<p>Compute a robust Parafac model for compositional data
</p>


<h3>Usage</h3>

<pre><code class="language-R">Parafac(X, ncomp = 2, center = FALSE, 
    center.mode = c("A", "B", "C", "AB", "AC", "BC", "ABC"),
    scale=FALSE, scale.mode=c("B", "A", "C"), 
    const="none", conv = 1e-06, start="svd", maxit=10000, 
    optim=c("als", "atld", "int2"),
    robust = FALSE, coda.transform=c("none", "ilr", "clr"), 
    ncomp.rpca = 0, alpha = 0.75, robiter = 100, crit=0.975, trace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>3-way array of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>Number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Whether to center the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.mode</code></td>
<td>
<p>If centering the data, on which mode to do this</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Whether to scale the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.mode</code></td>
<td>
<p>If scaling the data, on which mode to do this</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>
<p>Optional constraints for each mode. Can be a three element character
vector or a single character, one of <code>"none"</code> for no constraints (default),
<code>"orth"</code> for orthogonality constraints, <code>"nonneg"</code> for nonnegativity constraints or
<code>"zerocor"</code> for zero correlation between the extracted factors. For example,
<code>const="orth"</code> means orthogonality constraints for all modes,
while <code>const=c("orth", "none", "none")</code> sets the orthogonality constraint
only for mode A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>Convergence criterion, defaults to <code>1e-6</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Initial values for the A, B and C components. Can be <code>"svd"</code> 
for starting point of the algorithm from SVD's, <code>"random"</code> for random
starting point (orthonormalized component matrices or nonnegative matrices in
case of nonnegativity constraint), or a list containing user specified components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations, default is <code>maxit=10000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>
<p>How to optimize the CP loss function, default is to use ALS, i.e. 
<code>optim="als"</code>. Other optins are ATLD (<code>optim="atld"</code>) and INT2 (<code>optim="INT2"</code>).
Please note that ATLD cannot be used with the robust option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>Whether to apply a robust estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coda.transform</code></td>
<td>
<p>If the data are a composition, use an <em>ilr</em> or <em>clr</em> transformation. 
Default is non-compositional data, i.e. <code>coda.transform="none"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp.rpca</code></td>
<td>
<p>Number of components for robust PCA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Measures the fraction of outliers the algorithm should
resist. Allowed values are between 0.5 and 1 and the default is 0.75</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robiter</code></td>
<td>
<p>Maximal number of iterations for robust estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>Cut-off for identifying outliers, default <code>crit=0.975</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>Logical, provide trace output</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function can compute four 
versions of the Parafac model: 
</p>

<ol>
<li>
<p> Classical Parafac,
</p>
</li>
<li>
<p> Parafac for compositional data,
</p>
</li>
<li>
<p> Robust Parafac and
</p>
</li>
<li>
<p> Robust Parafac for compositional data.
</p>
</li>
</ol>
<p>This is controlled though the paramters <code>robust=TRUE</code> and coda.transform=c("none", "ilr").
</p>


<h3>Value</h3>

<p>An object of class "parafac" which is basically a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>Fit value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fp</code></td>
<td>
<p>Fit percentage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss</code></td>
<td>
<p>Sum of squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A </code></td>
<td>
<p>Orthogonal loading matrix for the A-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Orthogonal loading matrix for the A-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bclr</code></td>
<td>
<p>Orthogonal loading matrix for the B-mode, clr transformed. 
Available only if coda.transform="ilr", otherwise NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Orthogonal loading matrix for the C-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xhat</code></td>
<td>
<p>(Robustly) reconstructed array</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>
<p>Optional constraints (same as the input parameter)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rd</code></td>
<td>
<p>Residual distances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Score distances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag</code></td>
<td>
<p>The observations whose residual distance <code>rd</code> is larger than <code>cutoff.rd</code> or 
score distance <code>sd</code> is larger than <code>cutoff.sd</code>, can be 
considered outliers and receive a flag equal to zero. 
The regular observations receive a flag 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>The paramater <code>robust</code>, whether robust method is used or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coda.transform</code></td>
<td>
<p>Which coda transformation is used, can be <code>coda.transform=c("none", "ilr", "clr")</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Valentin Todorov <a href="mailto:valentin.todorov@chello.at">valentin.todorov@chello.at</a> and 
Maria Anna Di Palma <a href="mailto:madipalma@unior.it">madipalma@unior.it</a> and
Michele Gallo <a href="mailto:mgallo@unior.it">mgallo@unior.it</a>
</p>


<h3>References</h3>

<p>Harshman, R.A. (1970). Foundations of Parafac procedure: 
models and conditions for an "explanatory" multi-mode factor 
analysis. <em>UCLA Working Papers in Phonetics</em>, 16: 1–84.
</p>
<p>Engelen, S., Frosch, S. and Jorgensen, B.M. (2009). A fully 
robust PARAFAC method analyzing fluorescence data. 
<em>Journal of Chemometrics</em>, 23(3): 124–131.
</p>
<p>Kroonenberg, P.M. (1983).Three-mode principal component analysis: 
Theory and applications (Vol. 2), DSWO press.
</p>
<p>Rousseeuw, P.J. and Driessen, K.V. (1999). A fast algorithm for 
the minimum covariance determinant estimator. 
<em>Technometrics</em>, 41(3): 212–223.
</p>
<p>Egozcue J.J., Pawlowsky-Glahn V., Mateu-Figueras G. and 
Barcel'o-Vidal, C. (2003). Isometric logratio transformations 
for compositional data analysis. <em>Mathematical Geology</em>, 35(3): 279-300
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############
##
## Example with the UNIDO Manufacturing value added data

data(va3way)
dim(va3way)

## Treat quickly and dirty the zeros in the data set (if any) 
va3way[va3way==0] &lt;- 0.001

## 
res &lt;- Parafac(va3way)
res
print(res$fit)
print(res$A)

## Distance-distance plot
plot(res, which="dd", main="Distance-distance plot")

data(ulabor)
res &lt;- Parafac(ulabor, robust=TRUE, coda.transform="ilr")
res

## Plot Orthonormalized A-mode component plot
plot(res, which="comp", mode="A", main="Component plot, A-mode")

## Plot Orthonormalized B-mode component plot
plot(res, which="comp", mode="B", main="Component plot, B-mode")

## Plot Orthonormalized C-mode component plot
plot(res, which="comp", mode="C", main="Component plot, C-mode")


</code></pre>


</div>