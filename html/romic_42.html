<div class="container">

<table style="width: 100%;"><tr>
<td>plot_heatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Heatmap</h2>

<h3>Description</h3>

<p>Generate a heatmap visualization of a features x samples matrix of
measurements.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_heatmap(
  tomic,
  feature_var = NULL,
  sample_var = NULL,
  value_var = NULL,
  cluster_dim = "both",
  distance_measure = "dist",
  hclust_method = "ward.D2",
  change_threshold = Inf,
  plot_type = "grob",
  max_display_features = 800,
  x_label = NULL,
  y_label = NULL,
  colorbar_label = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tomic</code></td>
<td>
<p>Either a <code>tidy_omic</code> or <code>triple_omic</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_var</code></td>
<td>
<p>variable from "features" to use as a unique feature
label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_var</code></td>
<td>
<p>variable from "samples" to use as a unique sample label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value_var</code></td>
<td>
<p>which variable in "measurements" to use for quantification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_dim</code></td>
<td>
<p>rows, columns, or both</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_measure</code></td>
<td>
<p>variable to use for computing dis-similarity
</p>

<dl>
<dt>corr</dt>
<dd>
<p>pearson correlation</p>
</dd>
<dt>dist</dt>
<dd>
<p>euclidean distance</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hclust_method</code></td>
<td>
<p>method from stats::hclust to use for clustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>change_threshold</code></td>
<td>
<p>values with a more extreme absolute change will be
thresholded to this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_type</code></td>
<td>
<p>plotly (for interactivity) or grob (for a static ggplot)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_display_features</code></td>
<td>
<p>aggregate and downsample distinct feature to
this number to speed to up heatmap rendering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_label</code></td>
<td>
<p>label for x-axis (if NULL then use <code>feature_var</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_label</code></td>
<td>
<p>label for y-axis (if NULL then use <code>sample_var</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorbar_label</code></td>
<td>
<p>label for color-bar; default is log2 abundance</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a ggplot2 grob
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)

tomic &lt;- brauer_2008_triple %&gt;%
  filter_tomic(
    filter_type = "category",
    filter_table = "features",
    filter_variable = "BP",
    filter_value = c(
      "protein biosynthesis",
      "rRNA processing", "response to stress"
    )
  )

plot_heatmap(
  tomic = tomic,
  value_var = "expression",
  change_threshold = 5,
  cluster_dim = "rows",
  plot_type = "grob",
  distance_measure = "corr"
)
</code></pre>


</div>