<div class="container">

<table style="width: 100%;"><tr>
<td>biasBound_condExpectation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bias bound approach for conditional expectation estimation</h2>

<h3>Description</h3>

<p>Estimates the density at a given point or across a range, and provides visualization options for density,
bias, and confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">biasBound_condExpectation(
  Y,
  X,
  x = NULL,
  h = 0.09,
  alpha = 0.05,
  est_Ar = NULL,
  resol = 100,
  xi_lb = NULL,
  xi_ub = NULL,
  methods_get_xi = "Schennach",
  if_plot_ft = FALSE,
  ora_Ar = NULL,
  if_plot_conditional_mean = TRUE,
  kernel.fun = "Schennach2004",
  if_approx_kernel = TRUE,
  kernel.resol = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A numerical vector of sample data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numerical vector of sample data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Optional. A scalar or range of points where the density is estimated. If NULL, a range is automatically generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>A scalar bandwidth parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Confidence level for intervals. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_Ar</code></td>
<td>
<p>Optional list of estimates for A and r. If NULL, they are computed using <code>get_est_Ar()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resol</code></td>
<td>
<p>Resolution for the estimation range. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi_lb</code></td>
<td>
<p>Optional. Lower bound for the interval of Fourier Transform frequency xi. Used for determining the range over which A and r is estimated. If NULL, it is automatically determined based on the methods_get_xi.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi_ub</code></td>
<td>
<p>Optional. Upper bound for the interval of Fourier Transform frequency xi. Similar to xi_lb, it defines the upper range for A and r estimation. If NULL, the upper bound is determined based on the methods_get_xi.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methods_get_xi</code></td>
<td>
<p>A string specifying the method to automatically determine the xi interval if xi_lb and xi_ub are NULL. Options are "Schennach" and "Schennach_loose". If "Schennach" the range is selected based on the Theorem 2 in Schennach2020, if "Schennach_loose", it is defined by the initial interval given in Theorem 2 without selecting the xi_n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>if_plot_ft</code></td>
<td>
<p>Logical. If TRUE, plots the Fourier transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ora_Ar</code></td>
<td>
<p>Optional list of oracle values for A and r.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>if_plot_conditional_mean</code></td>
<td>
<p>Logical. If TRUE, plots the conditional mean estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel.fun</code></td>
<td>
<p>A string specifying the kernel function to be used. Options are "Schennach2004", "sinc", "normal", "epanechnikov".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>if_approx_kernel</code></td>
<td>
<p>Logical. If TRUE, uses approximations for the kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel.resol</code></td>
<td>
<p>The resolution for kernel function approximation. See <code>fun_approx</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing various outputs including estimated values, plots, and intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example 1: point estimation of conditional expectation of Y on X
biasBound_condExpectation(
 Y = sample_data$Y,
 X = sample_data$X,
 x = 1,
 h = 0.09,
 kernel.fun = "Schennach2004"
)

# Example 2: conditional expectation of Y on X with manually selected range of xi
# biasBound_condExpectation(
# Y = sample_data$Y,
#  X = sample_data$X,
#  h = 0.09,
#  xi_lb = 1,
#  xi_ub = 12,
#  kernel.fun = "Schennach2004"
# )

</code></pre>


</div>