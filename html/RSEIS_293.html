<div class="container">

<table style="width: 100%;"><tr>
<td>Spectrum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Different Spectrum Types in Physical Units</h2>

<h3>Description</h3>

<p>Spectrum is a wrapper function for stats::fft and
RSEIS::mtapspec. For a given method (multi-taper spectrum or fft
spectrum) and spectrum type (power, energy, amplitude, or phase), it
returns the spectrum in physical units (obeying Parseval's theorem)
and the corresponding frequency axis.</p>


<h3>Usage</h3>

<pre><code class="language-R">Spectrum(x, dt, one_sided = TRUE, type = 1, method = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Time series for which a spectrum is to be calculated (assumed
to be in volts)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>Sample interval for x (assumed to be in seconds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one_sided</code></td>
<td>
<p>Logical: should the spectrum be a function of
positive frequencies only (f &lt; nyquist frequency) and spectral
density doubled to be consistent with that (TRUE, default), or
should the spectrum be provided for all frequencies, positive and
negative?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of spectrum: 1 (default) is power spectrum; 2 is
energy spectrum; 3 is amplitude spectrum; 4 is phase spectrum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used to calculate spectrum. 1 (default) is fft; 2
is multi-taper.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Phase spectrum is currently enabled only for method = 1 (fft). All
possible energy and power spectra obey Parseval's relation (sum(s)*df
~= mean(x^2) for power; sum(s)*df ~= sum(x^2)*dt for
energy). Parseval's relation may not be exact due to approximations
used in making the spectrum one-sided or in the multi-taper method.
</p>
<p>Input units are assumed to be volts and seconds; if other input units
are used, adjust output units accordingly.
</p>


<h3>Value</h3>

<p>List with following elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>frequency axis (Hz; cycles per second, not radians per
second)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>interval for frequency axis (Hz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spectrum</code></td>
<td>
<p>spectral values corresponding to f</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>spectrum type: Power, Energy, Amplitude, or Phase</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>Units of spectrum (assuming that input units are volts
and seconds)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jake Anderson
</p>


<h3>See Also</h3>

<p>RSEIS::mtapspec
stats::fft
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example time series
x = rnorm(1000)
dt = 0.01

## power spectrum, multi-taper method, one-sided
S = Spectrum(x, dt, type = 1, method = 2, one_sided = TRUE)
sum(S$spectrum) * S$df ## frequency-domain power
mean(x^2) ## time-domain power

## energy spectrum, fft method, two-sided
S = Spectrum(x, dt, type = 2, method = 1, one_sided = FALSE)
sum(S$spectrum) * S$df ## frequency-domain energy
sum(x^2) * dt ## time-domain energy
</code></pre>


</div>