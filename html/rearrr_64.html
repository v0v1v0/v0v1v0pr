<div class="container">

<table style="width: 100%;"><tr>
<td>shear_3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shear values around an origin in 3 dimensions</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>Shears points around an origin in 3-dimensional space.
See applied shearing matrices under <strong>Details</strong>.
</p>
<p>The data points in <code>`data`</code> are moved prior to the shearing, to bring
the origin to <code>0</code> in all dimensions. After the shearing, the
inverse move is applied to bring the origin back to its original position.
</p>
<p>The origin can be supplied as coordinates or as a function that returns coordinates. The
latter can be useful when supplying a grouped <code>data.frame</code> and shearing around e.g. the centroid
of each group.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shear_3d(
  data,
  x_col,
  y_col,
  z_col,
  x_shear = NULL,
  y_shear = NULL,
  z_shear = NULL,
  suffix = "_sheared",
  origin = NULL,
  origin_fn = NULL,
  keep_original = TRUE,
  shear_col_name = ".shear",
  origin_col_name = ".origin",
  overwrite = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>data.frame</code> or <code>vector</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_col, y_col, z_col</code></td>
<td>
<p>Name of x/y/z column in <code>`data`</code>. All must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_shear, y_shear, z_shear</code></td>
<td>
<p>Shear factor for the x/y/z dimension (<code>numeric</code>). Decides the amount of shearing.
Can be <code>vector</code>s with multiple shear factors.
</p>
<p><strong>N.B.</strong> Exactly <strong>2</strong> of the dimensions must have shear factors specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>Suffix to add to the names of the generated columns.
</p>
<p>Use an empty string (i.e. <code>""</code>) to overwrite the original columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>Coordinates of the origin to shear around.
<code>Vector</code> with 3 elements (i.e. origin_x, origin_y, origin_z).
Ignored when <code>`origin_fn`</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin_fn</code></td>
<td>
<p>Function for finding the origin coordinates.
</p>
<p><strong>Input</strong>: Each column will be passed as a <code>vector</code> in the order of <code>`cols`</code>.
</p>
<p><strong>Output</strong>: A <code>vector</code> with one scalar per dimension.
</p>
<p>Can be created with <code>create_origin_fn()</code> if you want to apply
the same function to each dimension.
</p>
<p>E.g. <code>`create_origin_fn(median)`</code> would find the median of each column.
</p>
<p><strong>Built-in functions</strong> are <code>centroid()</code>,
<code>most_centered()</code>,
and <code>midrange()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_original</code></td>
<td>
<p>Whether to keep the original columns. (Logical)
</p>
<p>Some columns may have been overwritten, in which case only the newest versions are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shear_col_name</code></td>
<td>
<p>Name of new column with the shearing amounts. If <code>NULL</code>, no column is added.
</p>
<p>Also adds a string version with the same name + <code>"_str"</code>, making it easier to group by the shearing amounts
when plotting multiple shears.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin_col_name</code></td>
<td>
<p>Name of new column with the origin coordinates. If <code>NULL</code>, no column is added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Whether to allow overwriting of existing columns. (Logical)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Applies one of the following transformation matrices, depending on which
two shearing amounts are specified:
</p>
<p>Given <code>`x_shear`</code> and <code>`y_shear`</code>:</p>

<table>
<tr>
<td style="text-align: left;">
   [ <code class="reqn">1</code> </td>
<td style="text-align: left;"> , <code class="reqn">0</code> </td>
<td style="text-align: left;"> , <code>x_shear</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
   [ <code class="reqn">0</code> </td>
<td style="text-align: left;"> , <code class="reqn">1</code> </td>
<td style="text-align: left;"> , <code>y_shear</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
   [ <code class="reqn">0</code> </td>
<td style="text-align: left;"> , <code class="reqn">0</code> </td>
<td style="text-align: left;"> , <code class="reqn">1</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Given <code>`x_shear`</code> and <code>`z_shear`</code>:</p>

<table>
<tr>
<td style="text-align: left;">
   [ <code class="reqn">1</code> </td>
<td style="text-align: left;"> , <code>x_shear</code> </td>
<td style="text-align: left;"> , <code class="reqn">0</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
   [ <code class="reqn">0</code> </td>
<td style="text-align: left;"> , <code class="reqn">1</code> </td>
<td style="text-align: left;"> , <code class="reqn">0</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
   [ <code class="reqn">0</code> </td>
<td style="text-align: left;"> , <code>z_shear</code> </td>
<td style="text-align: left;"> , <code class="reqn">1</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Given <code>`y_shear`</code> and <code>`z_shear`</code>:</p>

<table>
<tr>
<td style="text-align: left;">
   [ <code class="reqn">1</code> </td>
<td style="text-align: left;"> , <code class="reqn">0</code> </td>
<td style="text-align: left;"> , <code class="reqn">0</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
   [ <code>y_shear</code> </td>
<td style="text-align: left;"> , <code class="reqn">1</code> </td>
<td style="text-align: left;"> , <code class="reqn">0</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
   [ <code>z_shear</code> </td>
<td style="text-align: left;"> , <code class="reqn">0</code> </td>
<td style="text-align: left;"> , <code class="reqn">1</code> </td>
<td style="text-align: left;"> ] </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>data.frame</code> (<code>tibble</code>) with six new columns containing
the sheared x-, y- and z-values and the shearing amounts and origin coordinates.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other mutate functions: 
<code>apply_transformation_matrix()</code>,
<code>cluster_groups()</code>,
<code>dim_values()</code>,
<code>expand_distances()</code>,
<code>expand_distances_each()</code>,
<code>flip_values()</code>,
<code>roll_values()</code>,
<code>rotate_2d()</code>,
<code>rotate_3d()</code>,
<code>shear_2d()</code>,
<code>swirl_2d()</code>,
<code>swirl_3d()</code>
</p>
<p>Other shearing functions: 
<code>shear_2d()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Attach packages
library(rearrr)
library(dplyr)
has_ggplot &lt;- require(ggplot2)  # Attach if installed

# Set seed
set.seed(1)

df_square &lt;- square(runif(100)) %&gt;%
  rename(x = .square_x,
         y = Value) %&gt;%
  mutate(z = 1)

# Shear the x and z axes
# around the centroid
df_sheared &lt;- shear_3d(
  data = df_square,
  x_col = "x",
  y_col = "y",
  z_col = "z",
  x_shear = 2,
  z_shear = 4,
  origin_fn = centroid
)

# Plot sheared data
# Black: original points
# Red: sheared points
if (has_ggplot){
  df_sheared %&gt;%
    ggplot(aes(x = x, y = y)) +
    geom_point() +
    geom_point(aes(x = x_sheared, y = y_sheared, color = "red")) +
    theme_minimal()
}

## Not run: 
# Plot 3d with plotly
plotly::plot_ly(
  x = df_sheared$x_sheared,
  y = df_sheared$y_sheared,
  z = df_sheared$z_sheared,
  type = "scatter3d",
  mode = "markers",
  color = df_sheared$.shear_str
)

## End(Not run)

# Shear the y and z axes
# around the centroid
df_sheared &lt;- shear_3d(
  data = df_square,
  x_col = "x",
  y_col = "y",
  z_col = "z",
  y_shear = 2,
  z_shear = 4,
  origin_fn = centroid
)

# Plot sheared data
# Black: original points
# Red: sheared points
if (has_ggplot){
  df_sheared %&gt;%
    ggplot(aes(x = x, y = y)) +
    geom_point() +
    geom_point(aes(x = x_sheared, y = y_sheared, color = "red")) +
    theme_minimal()
}

## Not run: 
# Plot 3d with plotly
plotly::plot_ly(
  x = df_sheared$x_sheared,
  y = df_sheared$y_sheared,
  z = df_sheared$z_sheared,
  type = "scatter3d",
  mode = "markers",
  color = df_sheared$.shear_str
)

## End(Not run)

# Shear the y and z axes with multiple amounts at once
# around the centroid
df_sheared &lt;- shear_3d(
  data = df_square,
  x_col = "x",
  y_col = "y",
  z_col = "z",
  y_shear = c(0, 2, 4),
  z_shear = c(0, 4, 6),
  origin_fn = centroid
)

# Plot sheared data
if (has_ggplot){
  df_sheared %&gt;%
    ggplot(aes(x = x_sheared, y = y_sheared, color = .shear_str)) +
    geom_point() +
    theme_minimal()
}

## Not run: 
# Plot 3d with plotly
plotly::plot_ly(
  x = df_sheared$x_sheared,
  y = df_sheared$y_sheared,
  z = df_sheared$z_sheared,
  type = "scatter3d",
  mode = "markers",
  color = df_sheared$.shear_str
)

## End(Not run)
</code></pre>


</div>