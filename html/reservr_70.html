<div class="container">

<table style="width: 100%;"><tr>
<td>tf_compile_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compile a Keras model for truncated data under dist</h2>

<h3>Description</h3>

<p>Compile a Keras model for truncated data under dist
</p>


<h3>Usage</h3>

<pre><code class="language-R">tf_compile_model(
  inputs,
  intermediate_output,
  dist,
  optimizer,
  censoring = TRUE,
  truncation = TRUE,
  metrics = NULL,
  weighted_metrics = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputs</code></td>
<td>
<p>List of keras input layers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intermediate_output</code></td>
<td>
<p>Intermediate model layer to be used as input to
distribution parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A <code>Distribution</code> to use for compiling the loss and parameter
outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>String (name of optimizer) or optimizer instance. See
<code style="white-space: pre;">⁠optimizer_*⁠</code> family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censoring</code></td>
<td>
<p>A flag, whether the compiled model should support censored
observations. Set to <code>FALSE</code> for higher efficiency. <code>fit(...)</code> will error if
the resulting model is used to fit censored observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncation</code></td>
<td>
<p>A flag, whether the compiled model should support truncated
observations. Set to <code>FALSE</code> for higher efficiency. <code>fit(...)</code> will warn if
the resuting model is used to fit truncated observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metrics</code></td>
<td>
<p>List of metrics to be evaluated by the model during
training and testing. Each of these can be:
</p>

<ul>
<li>
<p> a string (name of a
built-in function),
</p>
</li>
<li>
<p> a function, optionally with a <code>"name"</code> attribute or
</p>
</li>
<li>
<p> a <code>Metric()</code>
instance. See the <code style="white-space: pre;">⁠metric_*⁠</code> family of functions.
</p>
</li>
</ul>
<p>Typically you will use
<code>metrics = c('accuracy')</code>. A function is any callable with the
signature <code>result = fn(y_true, y_pred)</code>. To specify different
metrics for different outputs of a multi-output model, you could
also pass a named list, such as
<code>metrics = list(a = 'accuracy', b = c('accuracy', 'mse'))</code>.
You can also pass a list to specify a metric or a list of
metrics for each output, such as
<code>metrics = list(c('accuracy'), c('accuracy', 'mse'))</code>
or <code>metrics = list('accuracy', c('accuracy', 'mse'))</code>. When you pass
the strings <code>'accuracy'</code> or <code>'acc'</code>, we convert this to one of
<code>metric_binary_accuracy()</code>,
<code>metric_categorical_accuracy()</code>,
<code>metric_sparse_categorical_accuracy()</code> based on the
shapes of the targets and of the model output. A similar
conversion is done for the strings <code>"crossentropy"</code>
and <code>"ce"</code> as well.
The metrics passed here are evaluated without sample weighting;
if you would like sample weighting to apply, you can specify
your metrics via the <code>weighted_metrics</code> argument instead.
</p>
<p>If providing an anonymous R function, you can customize the printed name
during training by assigning <code style="white-space: pre;">⁠attr(&lt;fn&gt;, "name") &lt;- "my_custom_metric_name"⁠</code>,
or by calling <code>custom_metric("my_custom_metric_name", &lt;fn&gt;)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted_metrics</code></td>
<td>
<p>List of metrics to be evaluated and weighted by
<code>sample_weight</code> or <code>class_weight</code> during training and testing.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>reservr_keras_model</code> that can be used to train truncated
and censored observations from <code>dist</code> based on input data from <code>inputs</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">dist &lt;- dist_exponential()
params &lt;- list(rate = 1.0)
N &lt;- 100L
rand_input &lt;- runif(N)
x &lt;- dist$sample(N, with_params = params)

if (interactive()) {
  tf_in &lt;- keras3::layer_input(1L)
  mod &lt;- tf_compile_model(
    inputs = list(tf_in),
    intermediate_output = tf_in,
    dist = dist,
    optimizer = keras3::optimizer_adam(),
    censoring = FALSE,
    truncation = FALSE
  )
}

</code></pre>


</div>