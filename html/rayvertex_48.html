<div class="container">

<table style="width: 100%;"><tr>
<td>rasterize_scene</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rasterize Scene</h2>

<h3>Description</h3>

<p>Render a 3D scene with meshes, lights, and lines using a software rasterizer.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rasterize_scene(
  scene,
  filename = NA,
  width = 800,
  height = 800,
  line_info = NULL,
  alpha_line = 1,
  parallel = TRUE,
  plot = is.na(filename),
  fov = 20,
  lookfrom = c(0, 0, 10),
  lookat = NULL,
  camera_up = c(0, 1, 0),
  fsaa = 2,
  light_info = directional_light(),
  color = "red",
  type = "diffuse",
  background = "black",
  tangent_space_normals = TRUE,
  shadow_map = TRUE,
  shadow_map_bias = 0.003,
  shadow_map_intensity = 0,
  shadow_map_dims = NULL,
  ssao = FALSE,
  ssao_intensity = 10,
  ssao_radius = 0.1,
  tonemap = "none",
  debug = "none",
  near_plane = 0.1,
  far_plane = 100,
  shader = "default",
  block_size = 4,
  shape = NULL,
  line_offset = 1e-05,
  ortho_dimensions = c(1, 1),
  bloom = FALSE,
  antialias_lines = TRUE,
  environment_map = "",
  background_sharpness = 1,
  verbose = FALSE,
  vertex_transform = NULL,
  validate_scene = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scene</code></td>
<td>
<p>The scene object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>Default <code>NULL</code>. Filename to save the image. If <code>NULL</code>, the image will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Default <code>400</code>. Width of the rendered image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>Default <code>400</code>. Width of the rendered image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line_info</code></td>
<td>
<p>Default <code>NULL</code>. Matrix of line segments to add to the scene. Number of rows must be a multiple of 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_line</code></td>
<td>
<p>Default <code>1</code>. Line transparency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Default <code>TRUE</code>. Whether to use parallel processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Default <code>is.na(filename)</code>. Whether to plot the image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fov</code></td>
<td>
<p>Default <code>20</code>. Width of the rendered image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lookfrom</code></td>
<td>
<p>Default <code>c(0,0,10)</code>. Camera location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lookat</code></td>
<td>
<p>Default <code>NULL</code>. Camera focal position, defaults to the center of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>camera_up</code></td>
<td>
<p>Default <code>c(0,1,0)</code>. Camera up vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsaa</code></td>
<td>
<p>Default <code>2</code>. Full screen anti-aliasing multiplier. Must be positive integer, higher numbers
will improve anti-aliasing quality but will vastly increase memory usage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>light_info</code></td>
<td>
<p>Default <code>directional_light()</code>. Description of scene lights, generated with the <code>point_light()</code> and
<code>directional_light()</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Default <code>darkred</code>. Color of model if no material file present (or for faces using the default material).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Default <code>diffuse</code>. Shader type. Other options: <code>vertex</code> (Gouraud shading), <code>phong</code>, and <code>color</code> (no lighting).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>Default <code>white</code>. Background color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tangent_space_normals</code></td>
<td>
<p>Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shadow_map</code></td>
<td>
<p>Default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shadow_map_bias</code></td>
<td>
<p>Default <code>0.005</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shadow_map_intensity</code></td>
<td>
<p>Default <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shadow_map_dims</code></td>
<td>
<p>Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssao</code></td>
<td>
<p>Default <code>FALSE</code>. Whether to add screen-space ambient occlusion (SSAO) to the render.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssao_intensity</code></td>
<td>
<p>Default <code>10</code>. Intensity of the shadow map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssao_radius</code></td>
<td>
<p>Default <code>0.1</code>. Radius to use when calculating the SSAO term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tonemap</code></td>
<td>
<p>Default <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>Default <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>near_plane</code></td>
<td>
<p>Default <code>0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>far_plane</code></td>
<td>
<p>Default <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shader</code></td>
<td>
<p>Default <code>"default"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_size</code></td>
<td>
<p>Default <code>4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Default <code>NULL</code>. The shape to render in the OBJ mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line_offset</code></td>
<td>
<p>Default <code>0.0001</code>. Amount to offset lines towards camera to prevent z-fighting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ortho_dimensions</code></td>
<td>
<p>Default <code>c(1,1)</code>. Width and height of the orthographic camera. Will only be used if <code>fov = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bloom</code></td>
<td>
<p>Default <code>FALSE</code>. Whether to apply bloom to the image. If <code>TRUE</code>,
this performs a convolution of the HDR image of the scene with a sharp, long-tailed
exponential kernel, which does not visibly affect dimly pixels, but does result in emitters light
slightly bleeding into adjacent pixels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>antialias_lines</code></td>
<td>
<p>Default <code>TRUE</code>. Whether to anti-alias lines in the scene.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment_map</code></td>
<td>
<p>Default <code>""</code>. Image file to use as a texture for all reflective and refractive
materials in the scene, along with the background.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background_sharpness</code></td>
<td>
<p>Default <code>1.0</code>. A number greater than zero but less than one indicating the sharpness
of the background image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Default <code>FALSE</code>. Prints out timing information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex_transform</code></td>
<td>
<p>Default <code>NULL</code>. A function that transforms the vertex locations, based on their location.
Function should takes a length-3 numeric vector and returns another length-3 numeric vector as the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validate_scene</code></td>
<td>
<p>Default <code>TRUE</code>. Whether to validate the scene input.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Rasterized image.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(run_documentation()) {
#Let's load the cube OBJ file included with the package

rasterize_scene(cube_mesh(),lookfrom=c(2,4,10), 
              light_info = directional_light(direction=c(0.5,1,0.7)))
}
if(run_documentation()) {
#Flatten the cube, translate downwards, and set to grey
base_model = cube_mesh() |&gt;
 scale_mesh(scale=c(5,0.2,5)) |&gt;
 translate_mesh(c(0,-0.1,0)) |&gt;
 set_material(diffuse="grey80") 
 
rasterize_scene(base_model, lookfrom=c(2,4,10), 
              light_info = directional_light(direction=c(0.5,1,0.7)))
}
if(run_documentation()) {           
#load the R OBJ file, scale it down, color it blue, and add it to the grey base
r_model = obj_mesh(r_obj(simple_r = TRUE)) |&gt;
 scale_mesh(scale=0.5) |&gt;
 set_material(diffuse="dodgerblue") |&gt;
 add_shape(base_model)
 
rasterize_scene(r_model, lookfrom=c(2,4,10), 
              light_info = directional_light(direction=c(0.5,1,0.7)))
}
if(run_documentation()) {
#Zoom in and reduce the shadow mapping intensity
rasterize_scene(r_model, lookfrom=c(2,4,10), fov=10,shadow_map = TRUE, shadow_map_intensity=0.3,
              light_info = directional_light(direction=c(0.5,1,0.7)))
}
if(run_documentation()) {
#Include the resolution (4x) of the shadow map for less pixellation around the edges
#Also decrease the shadow_map_bias slightly to remove the "peter panning" floating shadow effect
rasterize_scene(r_model, lookfrom=c(2,4,10), fov=10,
              shadow_map_dims=4, 
              light_info = directional_light(direction=c(0.5,1,0.7)))
}
if(run_documentation()) {
#Add some more directional lights and change their color
lights = directional_light(c(0.7,1.1,-0.9),color = "orange",intensity = 1) |&gt;
           add_light(directional_light(c(0.7,1,1),color = "dodgerblue",intensity = 1)) |&gt;
           add_light(directional_light(c(2,4,10),color = "white",intensity = 0.5))
rasterize_scene(r_model, lookfrom=c(2,4,10), fov=10,
              light_info = lights)
}
if(run_documentation()) {
#Add some point lights
lights_p = lights |&gt;
 add_light(point_light(position=c(-1,1,0),color="red", intensity=2)) |&gt;
 add_light(point_light(position=c(1,1,0),color="purple", intensity=2)) 
rasterize_scene(r_model, lookfrom=c(2,4,10), fov=10,
              light_info = lights_p)
}
if(run_documentation()) {
#change the camera position
rasterize_scene(r_model, lookfrom=c(-2,2,-10), fov=10,
              light_info = lights_p)
}
if(run_documentation()) {
              
#Add a spiral of lines around the model by generating a matrix of line segments
t = seq(0,8*pi,length.out=361)
line_mat = matrix(nrow=0,ncol=9)

for(i in 1:360) {
  line_mat = add_lines(line_mat,
                      generate_line(start = c(0.5*sin(t[i]), t[i]/(8*pi), 0.5*cos(t[i])),
                                    end  = c(0.5*sin(t[i+1]), t[i+1]/(8*pi), 0.5*cos(t[i+1]))))
}

rasterize_scene(r_model, lookfrom=c(2,4,10), fov=10, line_info = line_mat,
              light_info = lights)
}
</code></pre>


</div>