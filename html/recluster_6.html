<div class="container">

<table style="width: 100%;"><tr>
<td>recluster.boot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bootstrap nodes of consensus trees
</h2>

<h3>Description</h3>

<p>Given an initial tree and a data matrix, this function computes bootstrap for nodes. Each tree used for bootstrap is constructed by re-sampling the row order several times and by applying a consensus rule as done by recluster.cons. The number of sampled columns (species) can be varied.
</p>


<h3>Usage</h3>

<pre><code class="language-R">recluster.boot(tree, mat, phylo = NULL, tr = 100, p = 0.5, 
dist = "simpson", method = "average", boot = 1000, level = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>A reference phylo tree for sites presumably constructed with recluster.cons function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>

<p>The matrix used to construct the tree.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>An ultrametric and rooted tree for species phylogeny having the same labels of the mat columns. Only required for phylogenetic beta-diversity indices.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>

<p>The number of trees to be included in the consensus.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>A numeric value between 0.5 and 1 giving the proportion for a clade to be represented in the consensus tree.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>

<p>A beta-diversity index (the Simpson index by default) included in recluster.dist or any custom binary dissimilarity to be specified according to the syntax of designdist function of the vegan package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Any clustering method allowed by hclust.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>

<p>The number of trees used for bootstrap computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>The ratio between the number of species to be included in the analysis and the original number of species in the mat matrix.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computation can be time consuming due to the high number of trees required for analysis. It is suggested to assess the degree of row bias by recluster.hist and recluster.node.strength to optimize the number of required consensus trees before starting the analysis.
</p>


<h3>Value</h3>

<p>A vector indicating the percentage of bootstrap trees replicating each original node.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
"recluster: an unbiased clustering procedure for beta-diversity turnover"
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(datamod)
tree&lt;-recluster.cons(datamod,tr=10)
boot&lt;-recluster.boot(tree$cons,tr=5,boot=50,datamod)
recluster.plot(tree$cons,boot,direction="downwards")

data(treemod)
tree&lt;-recluster.cons(datamod,treemod, dist="phylosort", tr=10)
boot&lt;-recluster.boot(tree$cons, datamod, treemod,tr=5,boot=50)
recluster.plot(tree$cons,boot,direction="downwards")

</code></pre>


</div>