<div class="container">

<table style="width: 100%;"><tr>
<td>dGenWish</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density of the (singular) Generalized Wishart distribution

</h2>

<h3>Description</h3>

<p>Computes the density of the (possibly singular) Generalized
Wishart distribution with null-space equal to the space spanned by the
"one" vector.  This corresponds to the case considered by McCullagh
(2009) and Hanks and Hooten (2013).

</p>


<h3>Usage</h3>

<pre><code class="language-R">dGenWish(Dobs, Sigma, df,log=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dobs</code></td>
<td>
<p>An observed squared-distance matrix.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>The covariance parameter of the Generalized Wishart.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>An integer specifying the degrees of freedom.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical.  If True, then the log-likelihood is computed.

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Following McCullagh (2009), the likelihood can be computed by considering any contrast matrix L of full rank, and with n-1 rows and n columns,
where n is the number of columns of 'Dobs'.  If
</p>
<p>Dobs ~ GenWish(Sigma,df,1)
</p>
<p>is distributed as a generalized Wishart distribution with kernel (null
space) equal to the one vector, and df degrees of freedom, then the
likelihood can be computed by computing the likelihood of
</p>
<p>L(-Dobs)L' ~ Wishart(L(2*Sigma)L',df)
</p>
<p>Additionally, following Srivastava (2003), this likelihood holds (up
to a proportionality constant) in the singular case where df&lt;n.
</p>
<p>Following this formulation, the log-likelihood computed here (up to an
additive constant) is
</p>
<p>-df/2*log|L(2*Sigma)L'| -1/2*tr (L(2*Sigma)L')^-1 L(-D)L' 
</p>



<h3>Value</h3>

<p>A numeric likelihood or log-likelihood





</p>


<h3>Author(s)</h3>

<p>Ephraim M. Hanks

</p>


<h3>References</h3>

<p>McCullagh 2009.  Marginal likelihood for distance matrices.
Statistica Sinica 19: 631-649.
</p>
<p>Srivastava 2003.  Singular Wishart and multivariate beta
distributions.  The Annals of Statistics.  31(5), 1537-1560.
</p>
<p>Hanks and Hooten 2013.  Circuit theory and model-based inference for
landscape connectivity.  Journal of the American Statistical
Association.  108(501), 22-33.

</p>


<h3>Examples</h3>

<pre><code class="language-R">ras=raster(nrow=30,ncol=30)
extent(ras) &lt;- c(0,30,0,30)
values(ras) &lt;- 1
int=ras
cov.ras=ras

## get precision matrix of entire graph
B.int=get.TL(int)
Q.int=get.Q(B.int,1)

## get precision at a few nodes
Phi=get.Phi(Q.int,obs.idx=1:20)
S=ginv(as.matrix(Phi))

## simulate distance matrix
Dsim=rGenWish(df=20,Sigma=S)
image(Dsim)

## calculate log-likelihood
ll=dGenWish(Dsim,S,df=20,log=TRUE)
ll
</code></pre>


</div>