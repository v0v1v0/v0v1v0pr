<div class="container">

<table style="width: 100%;"><tr>
<td>max_incong</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Algortihm for maximizing incongruence between two phylogenies</h2>

<h3>Description</h3>

<p>Prunes the host (H) and symbiont (S) phylogenies to conform with the trimmed
matrix and computes the given global-fit method (PACo or ParaFit) between
the pruned trees. Then, determines the frequency of each host-symbiont
association occurring in a given percentile of cases that maximize
phylogenetic incongruence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">max_incong(
  HS,
  treeH,
  treeS,
  n,
  N,
  method = "paco",
  symmetric = FALSE,
  ei.correct = "none",
  percentile = 0.99,
  diff.fq = FALSE,
  strat = "sequential",
  cl = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HS</code></td>
<td>
<p>Host-Symbiont association matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeH</code></td>
<td>
<p>Host phyolgeny. An object of class "phylo".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeS</code></td>
<td>
<p>Symbiont phylogeny. An object of class "phylo".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of associations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Specifies the desired global-fit method (PACo or ParaFit).
The default is <code>PACo</code>. Options are <code>"paco"</code> (PACo) or
<code>"paraF"</code> (ParaFit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>Specifies the type of Procrustes superimposition. Default
is <code>FALSE</code>, indicates that the superposition is applied
asymmetrically (S depends on H). If <code>TRUE</code>, PACo is applied
symmetrically (dependency between S and H is reciprocal).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ei.correct</code></td>
<td>
<p>Specifies how to correct potential negative eigenvalues
from the conversion of phylogenetic distances into Principal
Coordinates: <code>"none"</code> (the default) indicates that no correction
is applied, particularly if H and S are ultrametric; <code>"sqrt.D"</code>
takes the element-wise square-root of the phylogenetic distances;
<code>"lingoes"</code> and <code>"cailliez"</code> apply the classical Lingoes
and Cailliez corrections, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentile</code></td>
<td>
<p>Percentile to evaluate (<em>p</em>). Default is
<code>0.99</code> (99\%).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.fq</code></td>
<td>
<p>Determines whether a correction to detect those associations
that present a similar contribution to (in)congruence and occur with
some frequency at the 0.01 and 0.99 percentiles. These correction
avoid multiple associations being overrepresented.
If <code>TRUE</code> a corrected frequency value (observed in p -
observed in (p-1)) is computed for each host-symbiont association.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> expressions sequentially in the current <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> expressions in parallel in
separate <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> sessions running in the background.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code>parallelly::availableCores()</code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.y.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dataframe with host-symbiont associations in rows. The first and
second columns display the names of the host and symbiont terminals,
respectively. The third column designates the host-symbiont
association by pasting the names of the terminals, and the fourth
column displays the frequency of occurrence of each host-symbiont
association in <em>p</em>. If <code>diff.fq = TRUE</code>, column 5 displays
the corrected frequencies.
</p>


<h3>NOTE</h3>

<p>The <code>node.label</code> object in both trees can not contain NAs or null
values (i.e. no numeric value). All nodes should have a value. Else
remove node labels within the <code>"phylo"</code> class tree
with <code>tree$node.label &lt;- NULL</code>. For more details, see
<code>distory::dist.multiPhylo()</code>.
</p>
<div class="sourceCode"><pre>  \code{GD} method can not be used with the trimmed matrices produced
  with \code{\link[=trimHS_maxI]{trimHS_maxI()}} or with the algorithm
  \code{\link[=max_incong]{max_incong()}} for those datasets with
  multiple associations.
</pre></div>


<h3>Examples</h3>

<pre><code class="language-R">data(nuc_pc)
N = 1 #for the example, we recommend 1e+4 value
n = 15
NPi &lt;- max_incong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                  symmetric = FALSE, ei.correct = "sqrt.D",
                  percentile = 0.99, diff.fq = TRUE)


</code></pre>


</div>