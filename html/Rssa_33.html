<div class="container">

<table style="width: 100%;"><tr>
<td>frobenius.cor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Frobenius correlations of the component matrices</h2>

<h3>Description</h3>

<p>Function calculates Frobenius correlations between grouped matrices
from the SSA matrix decomposition</p>


<h3>Usage</h3>

<pre><code class="language-R">frobenius.cor(x, groups, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input SSA object, supposed to be of class ‘ossa’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>list of numeric vectors, indices of elementary matrix components
in the SSA matrix decomposition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>decompose</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function computes matrix of Frobenius correlations between grouped matrices from the SSA matrix decomposition.
For group <code class="reqn">\mathcal{I} = \{i_1, \dots, i_s\}</code> the group matrix is defined as
<code class="reqn">\mathbf{X}_\mathcal{I} = \sum_{i \in \mathcal{I}} \sigma_i U_i V_i^\mathrm{T}</code>.
</p>
<p>Frobenius correlation of two matrices is defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">%
    \mathrm{fcor}(\mathbf{Z}, \mathbf{Y}) =
      \frac{\langle \mathbf{Z}, \mathbf{Y} \rangle_\mathrm{F}}
           {\|\mathbf{Z}\|_\mathrm{F} \cdot \|\mathbf{Y}\|_\mathrm{F}}.
  </code>
</p>

<p>Frobenius correlation is a measure of Frobenius orthogonality of the components.
If grouped matrices are correlated then the w-correlations of the corresponding reconstructed series is not
relevant measure of separability (and one should use <code>owcor</code> instead).
Also, if the elementary matrices <code class="reqn">\mathbf{X}_i = \sigma_i U_i V_i^\mathrm{T}</code>
of the decomposition are not F-orthogonal,
then <code class="reqn">\sigma_i</code> do not reflect their true contributions into the matrix decomposition.
</p>
<p>This function normally should be used only for object of class ‘ossa’.
Otherwise it always returns identical matrix (for disjoint groups).
</p>


<h3>Value</h3>

<p>Object of type 'wcor.matrix'.
</p>


<h3>See Also</h3>

<p><code>wcor</code>,
<code>owcor</code>,
<code>iossa</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Separation of two mixed sine-waves with equal amplitudes
N &lt;- 150
L &lt;- 70
omega1 &lt;- 1/5
omega2 &lt;- 1/10

v &lt;- sin(2*pi*omega1 * (1:N)) + sin(2*pi*omega2 * (1:N))
s &lt;- ssa(v, L)
fs &lt;- fossa(s, nested.groups = 1:4, gamma = 100)

# Decomposition is F-orthogonal
plot(frobenius.cor(fs, groups = 1:4), main = "F-correlation matrix")

plot(wcor(s, groups = 1:4))
plot(wcor(fs, groups = 1:4))


# Separate two non-separable sine series with different amplitudes

N &lt;- 150
L &lt;- 70

omega1 &lt;- 0.07
omega2 &lt;- 0.0675

F &lt;- 2*sin(2*pi*omega1 * (1:N)) + 2*sin(2*pi*omega2 * (1:N))
s &lt;- ssa(F, L)
ios &lt;- iossa(s, nested.groups = list(1:2, 3:4),
             kappa = NULL, maxiter = 1000, tol = 1e-5)

plot(reconstruct(ios, groups = ios$iossa.groups))
summary(ios)

# Decomposition is really oblique
plot(frobenius.cor(ios, groups = 1:4), main = "F-correlation matrix")

plot(wcor(ios, groups = 1:4))
plot(owcor(ios, groups = list(1:2, 3:4)), main = "Oblique W-correlation matrix")




data(USUnemployment)
unempl.male &lt;- USUnemployment[, "MALE"]

s &lt;- ssa(unempl.male)
ios &lt;- iossa(s, nested.groups = list(c(1:4, 7:11), c(5:6, 12:13)))
summary(ios)

# W-cor matrix before IOSSA and w-cor matrix after it
plot(wcor(s, groups = 1:30))
plot(wcor(ios, groups = 1:30))

# Confirmation of the indicated max value in the above warning
plot(frobenius.cor(ios, groups = 1:30), main = "F-correlation matrix")

</code></pre>


</div>