<div class="container">

<table style="width: 100%;"><tr>
<td>revisedsil</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The revised silhouette
</h2>

<h3>Description</h3>

<p>This function returns a revised silhouette plot, 
cluster centers in weighted squared Euclidean distances and  
a matrix containing the weighted squared Euclidean distances between cases and each cluster center.
Missing values are adjusted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">revisedsil(d,reRSKC=NULL,CASEofINT=NULL,col1="black",
	CASEofINT2 = NULL, col2="red", print.plot=TRUE, 
	W=NULL,C=NULL,out=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>A numerical data matrix, <code>N</code> by <code>p</code>, where <code>N</code> is the number of cases and <code>p</code> is the number of features.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reRSKC</code></td>
<td>

<p>A list output from RSKC function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CASEofINT</code></td>
<td>

<p>Necessary if print.plot=TRUE.
A vector of the case indices that appear in the revised silhouette plot. 
The revised silhouette widths of these indices are colored in <code>col1</code> if <code>CASEofINT != NULL</code>.
The average silhouette of each cluster printed in the plot is computed EXCLUDING these cases.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col1</code></td>
<td>

<p>See <code>CASEofINT</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CASEofINT2</code></td>
<td>

<p>A vector of the case indices that appear in the revised silhouette plot.
The indices are colored in <code>col2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col2</code></td>
<td>

<p>See <code>CASEofINT2</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.plot</code></td>
<td>

<p>If <code>TRUE</code>, the revised silhouette is plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>Necessary if <code>reRSKC = NULL</code>. A positive real vector of weights of length <code>p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>Necessary if <code>reRSKC = NULL</code>.  An integer vector of class labels of length <code>N</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>

<p>Necessary if <code>reRSKC = NULL</code>. 
Vector of the case indices that should be excluded in the calculation of cluster centers.
In <code>RSKC</code>, cluster centers are calculated without the cases that have the furthest 100*<code>alpha</code> % Weighted squared Euclidean distances to their closest cluster centers.
If one wants to obtain the cluster centers from <code>RSKC</code> output, set <code>out</code> = <code>&lt;RSKCoutput&gt;$oW</code>. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trans.mu</code></td>
<td>

<p>Cluster centers in reduced weighted dimension.
See example for more detail.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WdisC</code></td>
<td>

<p><code>N</code> by <code>ncl</code> matrix, where <code>ncl</code> is the prespecified number of clusters. It contains the weighted distance between each case and all cluster centers.
See example for more detail.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sil.order</code></td>
<td>

<p>Silhouette values of each case in the order of the case index.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sil.i</code></td>
<td>

<p>Silhouette values of cases ranked by decreasing order within clusters.
The corresponding case index are in <code>obs.i</code>
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yumi Kondo &lt;y.kondo@stat.ubc.ca&gt;
</p>


<h3>References</h3>

<p>Yumi Kondo (2011), Robustificaiton of the sparse K-means clustering algorithm, MSc. Thesis, University of British Columbia
<a href="http://hdl.handle.net/2429/37093">http://hdl.handle.net/2429/37093</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# little simulation function 
sim &lt;-
function(mu,f){
   D&lt;-matrix(rnorm(60*f),60,f)
   D[1:20,1:50]&lt;-D[1:20,1:50]+mu
   D[21:40,1:50]&lt;-D[21:40,1:50]-mu  
   return(D)
   }


### output trans.mu ###

p&lt;-200;ncl&lt;-3
# simulate a 60 by p data matrix with 3 classes 
d&lt;-sim(2,p)
# run RSKC
re&lt;-RSKC(d,ncl,L1=2,alpha=0.05)
# cluster centers in weighted squared Euclidean distances by function sil
sil.mu&lt;-revisedsil(d,W=re$weights,C=re$labels,out=re$oW,print.plot=FALSE)$trans.mu
# calculation 
trans.d&lt;-sweep(d[,re$weights!=0],2,sqrt(re$weights[re$weights!=0]),FUN="*") 
class&lt;-re$labels;class[re$oW]&lt;-ncl+1
MEANs&lt;-matrix(NA,ncl,ncol(trans.d))
for ( i in 1 : 3) MEANs[i,]&lt;-colMeans(trans.d[class==i,,drop=FALSE])
sil.mu==MEANs
# coincides 

### output WdisC ###

p&lt;-200;ncl&lt;-3;N&lt;-60
# generate 60 by p data matrix with 3 classes 
d&lt;-sim(2,p)
# run RSKC
re&lt;-RSKC(d,ncl,L1=2,alpha=0.05)
si&lt;-revisedsil(d,W=re$weights,C=re$labels,out=re$oW,print.plot=FALSE)
si.mu&lt;-si$trans.mu
si.wdisc&lt;-si$WdisC
trans.d&lt;-sweep(d[,re$weights!=0],2,sqrt(re$weights[re$weights!=0]),FUN="*") 
WdisC&lt;-matrix(NA,N,ncl)
for ( i in 1 : ncl) WdisC[,i]&lt;-rowSums(scale(trans.d,center=si.mu[i,],scale=FALSE)^2)
# WdisC and si.wdisc coincides

</code></pre>


</div>