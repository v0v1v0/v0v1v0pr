<div class="container">

<table style="width: 100%;"><tr>
<td>simu</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to generate simulated data used in the manuscript.</h2>

<h3>Description</h3>

<p>This function is used to generate simulated data under various settings.
Let <code class="reqn">Z</code> be a <code class="reqn">p</code>-dimensional vector of possible time-dependent covariates and
<code class="reqn">\beta</code> be the vector of regression coefficient.
The survival times (<code class="reqn">T</code>) are generated from the hazard function specified as follow:
</p>

<dl>
<dt>Scenario 1.1</dt>
<dd>
<p>Proportional hazards model:
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Z) = \lambda_0(t) e^{-0.5 Z_1 + 0.5 Z_2 - 0.5 Z_3 ... + 0.5 Z_{10}},</code>
</p>
</dd>
</dl>
<p>where <code class="reqn">\lambda_0(t) = 2t</code>.
</p>
<dl>
<dt>Scenario 1.2</dt>
<dd>
<p>Proportional hazards model with noise variable:
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Z) = \lambda_0(t) e^{2Z_1 + 2Z_2 + 0Z_3 + ... + 0Z_{10}},</code>
</p>
</dd>
</dl>
<p>where <code class="reqn">\lambda_0(t) = 2t</code>.
</p>
<dl>
<dt>Scenario 1.3</dt>
<dd>
<p>Proportional hazards model with nonlinear covariate effects:
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Z) = \lambda_0(t) e^{[2\sin(2\pi Z_1) + 2|Z_2 - 0.5|]},</code>
</p>
</dd>
</dl>
<p>where <code class="reqn">\lambda_0(t) = 2t</code>.
</p>
<dl>
<dt>Scenario 1.4</dt>
<dd>
<p>Accelerated failure time model:
</p>
<p style="text-align: center;"><code class="reqn">\log(T) = -2 + 2Z_1 + 2Z_2 + \epsilon,</code>
</p>
<p> where <code class="reqn">\epsilon</code> follows <code class="reqn">N(0, 0.5^2).</code></p>
</dd>
<dt>Scenario 1.5</dt>
<dd>
<p>Generalized gamma family:
</p>
<p style="text-align: center;"><code class="reqn">T = e^{\sigma\omega},</code>
</p>
<p> where <code class="reqn">\omega = \log(Q^2 g) / Q</code>, <code class="reqn">g</code> follows Gamma(<code class="reqn">Q^{-2}, 1</code>),
<code class="reqn">\sigma = 2Z_1, Q = 2Z_2.</code></p>
</dd>
<dt>Scenario 2.1</dt>
<dd>
<p>Dichotomous time dependent covariate with at most one change in value:
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Z(t)) = \lambda_0(t)e^{2Z_1(t) + 2Z_2},</code>
</p>

<p>where <code class="reqn">Z_1(t)</code> is the time-dependent covariate: <code class="reqn">Z_1(t) = \theta I(t \ge U_0) + (1 - \theta) I(t &lt; U_0)</code>,
,<code class="reqn">\theta</code> is a Bernoulli variable with equal probability, and <code class="reqn">U_0</code> follows a uniform distribution over <code class="reqn">[0, 1]</code>.</p>
</dd>
<dt>Scenario 2.2</dt>
<dd>
<p>Dichotomous time dependent covariate with multiple changes:
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Z(t)) = e^{2Z_1(t) + 2Z_2},</code>
</p>

<p>where <code class="reqn">Z_1(t) = \theta[I(U_1\le t &lt; U_2) + I(U_3 \le t)] + (1 - \theta)[I(t &lt; U_1) + I(U_2\le t &lt; U_3)]</code>,
<code class="reqn">\theta</code> is a Bernoulli variable with equal probability, and <code class="reqn">U_1\le U_2\le U_3</code>
are the first three terms of a stationary Poisson process with rate 10.</p>
</dd>
<dt>Scenario 2.3</dt>
<dd>
<p>Proportional hazard model with a continuous time dependent covariate:
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Z(t)) = 0.1 e^{Z_1(t) + Z_2},</code>
</p>
<p> where <code class="reqn">Z_1(t) = kt + b</code>,
<code class="reqn">k</code> and <code class="reqn">b</code> are independent uniform random variables over <code class="reqn">[1, 2]</code>.</p>
</dd>
<dt>Scenario 2.4</dt>
<dd>
<p>Non-proportional hazards model with a continuous time dependent covariate:
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Z(t)) = 0.1 \cdot[1 + \sin\{Z_1(t) + Z_2\}],</code>
</p>
<p> where <code class="reqn">Z_1(t) = kt + b</code>,
<code class="reqn">k</code> and <code class="reqn">b</code> follow independent uniform distributions over <code class="reqn">[1, 2]</code>.</p>
</dd>
<dt>Scenario 2.5</dt>
<dd>
<p>Non-proportional hazards model with a nonlinear time dependent covariate:
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Z(t)) = 0.1 \cdot[1 + \sin\{Z_1(t) + Z_2\}],</code>
</p>
<p> where <code class="reqn">Z_1(t) = 2kt\cdot \{I(t &gt; 5) - 1\} + b</code>,
<code class="reqn">k</code> and <code class="reqn">b</code> follow independent uniform distributions over <code class="reqn">[1, 2]</code>.</p>
</dd>
</dl>
<p>The censoring times are generated from an independent uniform distribution over <code class="reqn">[0, c]</code>,
where <code class="reqn">c</code> was tuned to yield censoring percentages of 25

</p>


<h3>Usage</h3>

<pre><code class="language-R">simu(n, cen, scenario, summary = FALSE)

trueHaz(dat)

trueSurv(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>an integer value indicating the number of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cen</code></td>
<td>
<p>is a numeric value indicating the censoring percentage; three levels, 0%, 25%, 50%, are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scenario</code></td>
<td>
<p>can be either a numeric value or a character string.
This indicates the simulation scenario noted above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>a logical value indicating whether a brief data summary will be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>is a data.frame prepared by <code>simu</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>simu</code> returns a <code>data.frame</code>.
The returned data.frame consists of columns:
</p>

<dl>
<dt>id</dt>
<dd>
<p>is the subject id.</p>
</dd>
<dt>Y</dt>
<dd>
<p>is the observed follow-up time.</p>
</dd>
<dt>death</dt>
<dd>
<p>is the death indicator; death = 0 if censored.</p>
</dd>
<dt>z1–z10</dt>
<dd>
<p>is the possible time-independent covariate.</p>
</dd>
<dt>k, b, U</dt>
<dd>
<p>are the latent variables used to generate $Z_1(t)$ in Scenario 2.1 – 2.5.</p>
</dd>
</dl>
<p>The returned data.frame can be supply to <code>trueHaz</code> and <code>trueSurv</code> to generate the true cumulative hazard function and the survival function, respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
simu(10, 0.25, 1.2, TRUE)

set.seed(1)
simu(10, 0.50, 2.2, TRUE)

</code></pre>


</div>