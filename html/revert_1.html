<div class="container">

<table style="width: 100%;"><tr>
<td>getReversions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detecting reversion mutations</h2>

<h3>Description</h3>

<p>Function for detecting reversions for a given pathogenic mutation from reads alignment of NGS genomic data
</p>


<h3>Usage</h3>

<pre><code class="language-R">getReversions(
  bam.file,
  genome.version = "BSgenome.Hsapiens.UCSC.hg38",
  chromosome,
  pathog.mut.start,
  pathog.mut.type = "SNV",
  snv.reference.allele = NULL,
  snv.alternative.allele = NULL,
  deletion.sequence = NULL,
  deletion.length = NULL,
  insertion.sequence = NULL,
  flanking.window = 100,
  minus.strand = FALSE,
  check.wildtype.reads = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bam.file</code></td>
<td>
<p>Character. 
The input bam file containing aligned reads.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genome.version</code></td>
<td>
<p>Character. 
Genome version of alignments in bam file and the position of pathogenic mutation.
The name of genome version is specified by the available BSgenome data packages: BSgenome::available.genomes().
Default is "BSgenome.Hsapiens.UCSC.hg38".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chromosome</code></td>
<td>
<p>Character. 
Name of chromosome where pathogenic mutation is located, e.g., "chr17" or "17", "chrX" or "X".
The chromosome name should be concordant with the chromosome identifiers used in bam.file and genome.version</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathog.mut.start</code></td>
<td>
<p>Integer. 
Genomic coordinate of the start position of pathogenic mutation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathog.mut.type</code></td>
<td>
<p>Character. 
Type of pathogenic mutation: "SNV", "DEL" or "INS".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snv.reference.allele</code></td>
<td>
<p>Character.
Reference allele of pathogenic mutation if it is a single nucleotide variant (SNV).
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snv.alternative.allele</code></td>
<td>
<p>Character.
Alternative allele of pathogenic mutation if it is a SNV.
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deletion.sequence</code></td>
<td>
<p>Character. 
Deleted nucleotides of pathogenic mutation if it is a deletion (DEL). 
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deletion.length</code></td>
<td>
<p>Integer. 
Number of deleted nucleotides of pathogenic mutation if it is a DEL. 
Parameters deletion.sequence and deletion.length can not both be NULL when pathogenic mutation is DEL.
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>insertion.sequence</code></td>
<td>
<p>Character. 
Inserted nucleotides of pathogenic mutation if it is an insertion (INS). 
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flanking.window</code></td>
<td>
<p>Integer. 
Length of flanking regions (bp) to pathogenic mutation locus for reversion detection. 
Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minus.strand</code></td>
<td>
<p>Logical. 
TRUE if the gene in question is on the reverse strand. 
Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.wildtype.reads</code></td>
<td>
<p>Logical. 
TRUE if assume wildtype reads mapped to pathogenic mutation are restored to wildtype and alternative reversions will be detected from the wildtype reads.
Only used for pathogenic mutation targeted gene editing experiment.   
Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing two tables summarizing the reversion detection:
1. The numbers of different types of reads analysed in the input bam file
2. Reversion mutation table including the following columns: 
rev_id: Unique ID for reversion event
rev_freq: Frequency of reversion event
rev_type: Type of reversion event, i.e., complement reversion to pathogenic mutation, replacement reversion of pathogenic mutation, or alternative reversion to pathogenic mutation 
rev_mut_number: Index of each mutation in a reversion event
mut_id: Unique ID for reversion mutation 
chr: Chromosome
mut_start_pos: Start position of reversion mutation
mut_type: Type of reversion mutation, i.e., SNV, DEL or INS
mut_seq: Sequence changes of mutation, i.e., inserted or deleted sequences for indels, or reference and alternative alleles for SNVs 
mut_length: Length of mut_seq, 0 for SNV
mut_hgvs: HGVS Genomic DNA ID of reversion mutation
pathog_mut_hgvs: Original pathogenic reversion mutation
dist_to_pathog_mut: Distance between original pathogenic mutation and reversion mutation
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
# To detect reversions for BRCA2 mutation "chr13:g.32338763-32338764delAT"
bam.file2 &lt;- system.file('extdata', 'toy_alignments_2.bam', package = 'revert')
reversions &lt;- getReversions(
    bam.file = bam.file2, 
    genome.version = "BSgenome.Hsapiens.UCSC.hg38",
    chromosome = "chr13", 
    pathog.mut.start = 32338763, 
    pathog.mut.type = "DEL", 
    deletion.sequence = "AT",
    deletion.length = 2,
    flanking.window = 100,
    minus.strand = FALSE )

}
</code></pre>


</div>