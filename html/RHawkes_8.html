<div class="container">

<table style="width: 100%;"><tr>
<td>pred.den</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
RHawkes predictive density function
</h2>

<h3>Description</h3>

<p>Calculates the predictive density of the next observed event time after the 
censoring time <code>cens</code> based on observations over the interval 
[0,<code>cens</code>].
</p>


<h3>Usage</h3>

<pre><code class="language-R">pred.den(x, tms, cens, par, 
        h.fn = function(x, p) dexp(x, rate = 1 / p), 
        mu.fn = function(x, p) {
          exp(dweibull(x, shape = p[1], scale = p[2], log = TRUE) - 
          pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE))}, 
          H.fn = function(x, p) pexp(x, rate = 1 / p), 
          Mu.fn = function(x, p) {
            -pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE)
          })
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A scalar. The amount of time after the censoring time <code>cens</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tms</code></td>
<td>

<p>A numeric vector, with values sorted in ascending order. The event times
to fit the RHawkes point process model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>A numeric vector. Contains the parameters of the model, in order of the 
immigration parameters <code class="reqn">\mu(.)</code>, offspring parameters <code class="reqn">h(.)</code> and 
lastly the branching ratio <code class="reqn">\eta(.)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.fn</code></td>
<td>

<p>A (vectorized) function. The immigration hazard function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the offspring density function from 0 to <code>t</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the immigrant hazard function from 0 to <code>t</code>. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The predictive density of the next event evaluated at <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Feng Chen &lt;feng.chen@unsw.edu.au&gt;
Tom Stindl &lt;t.stindl@unsw.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(quake);
tms &lt;- sort(quake$time);
# add some random noise to the identical event times
tms[213:214] &lt;- tms[213:214] + 
                    sort(c(runif(1, -1, 1)/(24*60), runif(1, -1, 1)/(24*60)))
curve(pred.den(x, tms = tms, cens = 35064, par= c(0.314, 22.2, 1266, 0.512)) 
        ,0 ,2000, col = 2, lty = 2)
</code></pre>


</div>