<div class="container">

<table style="width: 100%;"><tr>
<td>sanitize_token</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Validate and sanitize the user's REDCap token</h2>

<h3>Description</h3>

<p>Verifies the token is nonmissing and conforms to the legal
pattern of a 32-character hexadecimal value.
Each character must be an (a) digit 0-9, (b) uppercase letter A-F, or
(c) lowercase letter a-f.
Trailing line endings are removed.
</p>
<p>A typical user does not call this function directly.  However functions like
<code>redcap_read()</code> call it to provide a more informative
error message to the user.
</p>
<p>Some institutions create their own tokens –not the standard
32-character hexadecimal value.  The pattern that validates their tokens
can be specified with the system environmental variable
<code>REDCAP_TOKEN_PATTERN</code> using
base::Sys.setenv.
</p>
<p>For example, the following regex pattern captures a
<a href="https://en.wikipedia.org/wiki/Base64">base64 encoded value</a>
with 40 characters (as opposed to a hexadecimal/base16 value
with 32 characters):
<code style="white-space: pre;">⁠^([A-Za-z\\d+/\\+=]{40})$⁠</code>.
See <a href="https://rgxdb.com/r/1NUN74O6">https://rgxdb.com/r/1NUN74O6</a> or
<a href="https://regex101.com/library/lXFWqM">https://regex101.com/library/lXFWqM</a>
for alternative approaches to validate base64 values.
</p>
<p>If no pattern is specified, the default is a 32-character hex token:
<code style="white-space: pre;">⁠^([0-9A-Fa-f]{32})(?:\\n)?$⁠</code>.  The important segment is contained in the
first (and only) capturing group
(<em>i.e.</em>, <code style="white-space: pre;">⁠[0-9A-Fa-f]{32}⁠</code>).
Any trailing newline character is removed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sanitize_token(token)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>token</code></td>
<td>
<p>The REDCap token. Required.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Although the function does not accept a parameter,
it is influenced by the <code>REDCAP_TOKEN_PATTERN</code>
environmental variable.
</p>


<h3>Value</h3>

<p>The token, without a terminal newline character.
</p>


<h3>Note</h3>

<p>Contact your institution's REDCap administrator for more information
about your project-specific token.
</p>


<h3>Author(s)</h3>

<p>Hao Zhu, Benjamin Nutter, Will Beasley, Jordan Mark Barbone
</p>


<h3>Examples</h3>

<pre><code class="language-R">secret_token_1 &lt;- "12345678901234567890123456ABCDEF"
secret_token_2 &lt;- "12345678901234567890123456ABCDEF\n"
secret_token_3 &lt;- "12345678901234567890123456abcdef"
REDCapR::sanitize_token(secret_token_1)
REDCapR::sanitize_token(secret_token_2)
REDCapR::sanitize_token(secret_token_3)

# Some institutions use a token system that follows a different pattern
Sys.setenv("REDCAP_TOKEN_PATTERN" = "^([A-Za-z\\d+/\\+=]{10})$")

secret_token_4 &lt;- "abcde1234="
REDCapR::sanitize_token(secret_token_4)
Sys.getenv("REDCAP_TOKEN_PATTERN")
Sys.unsetenv("REDCAP_TOKEN_PATTERN")
</code></pre>


</div>