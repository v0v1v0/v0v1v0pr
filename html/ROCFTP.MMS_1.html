<div class="container">

<table style="width: 100%;"><tr>
<td>ROCFTP.MMS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perfect Sampling</h2>

<h3>Description</h3>

<p><code>ROCFTP.MMS</code>, Read Once Coupling From The Past, with Metropolis-Multishift
is used to generate a perfect sample for a given posterior density based on the
two extreme starting paths, minimum and maximum of the most interest range of
the posterior. It uses the monotone random operation of multishift coupler
which allows to sandwich all of the state space in one point. It means both
Markov Chains starting from the maximum and minimum will be coalesced.
The generated sample is independent from the starting points. It is useful
for mixture distributions too. The output of this function is a real value as an exact
draw from the posterior distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ROCFTP.MMS(LB, start, post, sigma, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>LB</code></td>
<td>
<p>defines the length of each block. The algorithm starts new blocks to
find a coalescence of the two Markov chains started from extreme points of the
most interest range. So, if it is too small the algorithm after 50 blocks
repetition will give error message, and if it is too large then it will
increase generation time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>is a vector of initial values or the two extreme points of the most interest
range of posterior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post</code></td>
<td>
<p>is the posterior which is defined in the form of an R function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>is a real value for standard deviation of multishift coupler. Multishift coupler
is constructed based on normal density. If the posterior is a mixture
distribution or a multi-modal distribution, then sigma should be chosen in such
a way that Markov chains easily jumps between modes, and if the sigma is
chosen small; the Markov chains may trap in one mode and don't coalesce.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>has the default value of FALSE for density function of posteriors.
If TRUE; then posterior should be defined in log form.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Nabipoor M, Murdoch D. (2010) ROCFTP With Metropolis-Multishift Coupler, Summer
Research, Department of Statistical and actuarial sciences, University of
Western Ontario
</p>


<h3>Author(s)</h3>

<p>Majid Nabipoor: nabipoor@ualberta.ca
Duncan Murdoch: murdoch.duncan@gmail.com
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Unimodal posterior
post&lt;- function(x)
{
  dnorm(x, mean=30, sd=1)
}
start&lt;- c(20,40)
LB=30
ROCFTP.MMS(LB,start, post,1)
#Generate n i.i.d. exact sample
RG &lt;- function(i){ROCFTP.MMS(30, c(20,40), post, 1)}
n &lt;- 5
mrtx &lt;- matrix(1:n, ncol=1)
dat &lt;- apply(mrtx,1,RG)
qqnorm(dat, pch = 16, frame = FALSE)
qqline(dat, col = "steelblue", lwd = 3)

# multimodal posterior
post &lt;- function(x)
{
 0.2*dnorm(x, mean=-5, sd=1)+0.2*dnorm(x, mean=5, sd=1)+0.6*dnorm(x, mean=15, sd=1)
}
start &lt;- c(-15,25)
LB &lt;- 116
sigma &lt;- 3.5
ROCFTP.MMS(LB,start, post,sigma) #generates one exact sample
#Generate n i.i.d. exact sample
RG &lt;- function(i){ROCFTP.MMS(116, c(-15,25), post, 3.5)}
n &lt;- 5
mrtx &lt;- matrix(1:n, ncol=1)
apply(mrtx,1,RG)

#log form of posterior
post&lt;- function(x) {dnorm(x, mean=30, sd=1, log=TRUE)}
start&lt;- c(20,40)
LB=100
sigma=0.5
ROCFTP.MMS(LB,start, post, sigma, log=TRUE)
</code></pre>


</div>