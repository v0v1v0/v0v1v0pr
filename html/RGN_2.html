<div class="container">

<table style="width: 100%;"><tr>
<td>rgn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Gauss Newton optimization</h2>

<h3>Description</h3>

<p><code>rgn</code> performs optimization of weighted-sum-of-squares (WSS) objective function using the Robust Gauss Newton algorithm
</p>


<h3>Usage</h3>

<pre><code class="language-R">rgn(
  simFunc,
  simTarget = 0,
  weights = NULL,
  par,
  lower,
  upper,
  control = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>simFunc</code></td>
<td>
<p>is a function that simulates a (vector) response, with first argument the vector of parameters over which optimization is performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simTarget</code></td>
<td>
<p>is the target vector that <code>simFunc</code> is trying to match</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>is a vector of weights used in the WSS objective function. Defaults to equal weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>is the vector of initial parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>is the lower bounds on parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>is the upper bounds on parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list of RGN settings
</p>

<ul>
<li>
<p><code>control$n.multi</code> is number of multi-starts
(i.e. invocations of optimization with different initial parameter estimates). Default is 1.
</p>
</li>
<li>
<p><code>control$iterMax</code> is maximum iterations. Default is 100.
</p>
</li>
<li>
<p><code>control$dump</code> is level of diagnostic outputs between 0 (none) and 3 (highest). Default is 0.
</p>
</li>
<li>
<p><code>control$keep.multi</code> (TRUE/FALSE) controls whether diagnostic output from each multi-start is recorded. Default is FALSE.
</p>
</li>
<li>
<p><code>control$logFile</code> is log file name
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to <code>simFunc()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>rgn</code> minimizes the objective function <code>sum((weights*(simFunc-simTarget)^2))</code>,
which is a sum of squared weighted residuals (<code>residuals=weights*(simFunc-simTarget)</code>).
Note <code>simFunc</code> corresponds to the vector of residuals when default
arguments for <code>simTarget</code> and <code>weights</code> are used.
</p>


<h3>Value</h3>

<p>List with
</p>

<ul>
<li>
<p><code>par</code>, the optimal parameters
</p>
</li>
<li>
<p><code>value</code>, the optimal objective function value
</p>
</li>
<li>
<p><code>sim</code>, the simulated vector using optimal parameters
</p>
</li>
<li>
<p><code>residuals</code>, the vector of residuals using optimal parameters
</p>
</li>
<li>
<p><code>counts</code>, the total number of function calls
</p>
</li>
<li>
<p><code>convergence</code>, an integer code indicating reason for completion.
<code>1</code> maximum iterations reached,
<code>2</code> relative reduction in function value small.
<code>3</code> absolute reduction in function value small
<code>4</code> relative change in parameters small
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Example 1: Rosenbrock
simFunc_rosenbrock=function(x) c(1.0-x[1],10.0*(x[2]-x[1]**2))
rgnOut = rgn(simFunc=simFunc_rosenbrock,
             par=c(-1.0,  0.0), lower=c(-1.5, -1.0), upper=c( 1.5,  3.0),
             simTarget=c(0,0))
rgnOut$par #optimal parameters
rgnOut$value #optimal objective function value

# Example 2: Hymod

data("BassRiver") # load Bass River hydrological data
rgnOut = rgn(simFunc=simFunc_hymod,
             par=c(400.,0.5,0.1,0.2,0.1),
             lower=c(1.,0.1,0.05,0.000001,0.000001),
             upper=c(1000.,2.,0.95,0.99999,0.99999),
             simTarget=BassRiverData$Runoff.mm.day[365:length(BassRiverData$Date)],
             stateVal=c(100.0,30.0,27.0,25.0,30.0,0.0,0.0,0.0), # initial states for hymod
             nWarmUp=365,                                       # warmup period
             rain=BassRiverData$Rain.mm,                        # precip input
             pet=BassRiverData$ET.mm)                           # PET input
rgnOut$par #optimal parameters
rgnOut$value #optimal objective function value


</code></pre>


</div>