<div class="container">

<table style="width: 100%;"><tr>
<td>cov_fun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance function for functional data</h2>

<h3>Description</h3>

<p><code>S3</code> method to compute the sample covariance and cross-covariance
functions for a set of functional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cov_fun(X, Y = NULL)

## S3 method for class 'fData'
cov_fun(X, Y = NULL)

## S3 method for class 'mfData'
cov_fun(X, Y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>is the (eventually first) functional dataset, i.e. either an object
of class <code>fData</code> or an object of class <code>mfData</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>is the (optional) second functional dataset to be used to compute the
cross-covariance function,  either <code>NULL</code> or an <code>fData</code> or
<code>mfData</code> object (see the Value section for details).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a univariate random function X, defined
over the grid <code class="reqn">I = [a,b]</code>, the covariance
function is defined as:
</p>
<p style="text-align: center;"><code class="reqn">C(s,t) = Cov( X(s), X(t) ), \qquad s,t \in I.</code>
</p>

<p>Given another random function, Y, defined over the same grid as X, the cross-
covariance function of X and Y is:
</p>
<p style="text-align: center;"><code class="reqn">C^{X,Y}( s,t ) =  Cov( X(s), Y(t) ), \qquad s, t \in I.</code>
</p>

<p>For a generic L-dimensional random function X, i.e. an L-dimensional
multivariate functional datum, the covariance function is defined as the set
of blocks:
</p>
<p style="text-align: center;"><code class="reqn">C_{i,j}(s,t) = Cov( X_i(s), X_j(t)), i,j = 1, ...,L, s,t \in I,</code>
</p>

<p>while the cross-covariance function is defined by the blocks:
</p>
<p style="text-align: center;"><code class="reqn">C^{X,Y}_{i,j}(s,t) = Cov( X_i(s), Y_j(t))</code>
</p>

<p>The method <code>cov_fun</code> provides the sample estimator of the covariance or
cross-covariance functions for univariate or multivariate functional datasets.
</p>
<p>The class of <code>X</code> (<code>fData</code> or <code>mfData</code>) is used to dispatch the
correct implementation of the method.
</p>


<h3>Value</h3>

<p>The following cases are given:
</p>

<ul>
<li>
<p>if <code>X</code> is of class <code>fData</code> and <code>Y</code> is <code>NULL</code>, then
the covariance function of <code>X</code> is returned;
</p>
</li>
<li>
<p>if <code>X</code> is of class <code>fData</code> and <code>Y</code> is of
class <code>fData</code>,
the cross-covariance function of the two datasets is returned;
</p>
</li>
<li>
<p>if <code>X</code> is of class <code>mfData</code> and <code>Y</code> is <code>NULL</code>,
the upper-triangular blocks of the covariance function of <code>X</code>
are returned (in form of list and by row, i.e. in the sequence 1_1, 1_2, ...,
1_L, 2_2, ... - have a look at the labels of the list with <code>str</code>);
</p>
</li>
<li>
<p>if <code>X</code> is of class <code>mfData</code> and <code>Y</code> is of
class <code>fData</code>,
the cross-covariances of <code>X</code>'s components and <code>Y</code> are
returned (in form of list);
</p>
</li>
<li>
<p>if <code>X</code> is of class <code>mfData</code> and <code>Y</code> is of
class <code>mfData</code>,
the upper-triangular blocks of the cross-covariance of <code>X</code>'s and
<code>Y</code>'s components are returned (in form of list and by row, i.e. in the
sequence 1_1, 1_2, ..., 1_L, 2_2, ... - have a look at the labels
of the list with <code>str</code>));</p>
</li>
</ul>
<p>In any case, the return type is either an instance of the <code>S3</code> class <code>Cov</code>
or a list of instances of such class (for the case of multivariate
functional data).
</p>


<h3>See Also</h3>

<p><code>fData</code>, <code>mfData</code>, <code>plot.Cov</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generating a univariate functional dataset
N = 1e2

P = 1e2
t0 = 0
t1 = 1

time_grid = seq( t0, t1, length.out = P )

Cov = exp_cov_function( time_grid, alpha = 0.3, beta = 0.4 )

D1 = generate_gauss_fdata( N, centerline = sin( 2 * pi * time_grid ), Cov = Cov )
D2 = generate_gauss_fdata( N, centerline = sin( 2 * pi * time_grid ), Cov = Cov )

fD1 = fData( time_grid, D1 )
fD2 = fData( time_grid, D2 )

# Computing the covariance function of fD1

C = cov_fun( fD1 )
str( C )

# Computing the cross-covariance function of fD1 and fD2
CC = cov_fun( fD1, fD2 )
str( CC )

# Generating a multivariate functional dataset
L = 3

C1 = exp_cov_function( time_grid, alpha = 0.1, beta = 0.2 )
C2 = exp_cov_function( time_grid, alpha = 0.2, beta = 0.5 )
C3 = exp_cov_function( time_grid, alpha = 0.3, beta = 1 )

centerline = matrix( c( sin( 2 * pi * time_grid ),
                        sqrt( time_grid ),
                        10 * ( time_grid - 0.5 ) * time_grid ),
                     nrow = 3, byrow = TRUE )

D3 = generate_gauss_mfdata( N, L, centerline,
                       correlations = c( 0.5, 0.5, 0.5 ),
                       listCov = list( C1, C2, C3 ) )

# adding names for better readability of BC3's labels
names( D3 ) = c( 'comp1', 'comp2', 'comp3' )
mfD3 = mfData( time_grid, D3 )

D1 = generate_gauss_fdata( N, centerline = sin( 2 * pi * time_grid ),
                              Cov = Cov )
fD1 = fData( time_grid, D1 )

# Computing the block covariance function of mfD3
BC3 = cov_fun( mfD3 )
str( BC3 )

# computing cross-covariance between mfData and fData objects
CC = cov_fun( mfD3, fD1 )
str( CC )

</code></pre>


</div>