<div class="container">

<table style="width: 100%;"><tr>
<td>evo.dir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic vector analysis of phenotypic change</h2>

<h3>Description</h3>

<p>This function quantifies direction, size and rate of
evolutionary change of multivariate traits along node-to-tip paths and
between species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evo.dir(RR,angle.dimension=c("rates","phenotypes"),
  y.type=c("original","RR"),y=NULL,pair.type=c("node","tips"),pair=NULL,
  node=NULL,random=c("yes","no"),nrep=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>
<p>an object produced by <code>RRphylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle.dimension</code></td>
<td>
<p>specifies whether vectors of <code>"rates"</code> or
<code>"phenotypes"</code> are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.type</code></td>
<td>
<p>must be indicated when <code>angle.dimension = "phenotypes"</code>.
If <code>"original"</code>, it uses the phenotypes as provided by the user, if
<code>"RR"</code> it uses <code>RR$predicted.phenotypes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>specifies the phenotypes to be provided if <code>y.type =
"original"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pair.type</code></td>
<td>
<p>either <code>"node"</code> or <code>"tips"</code>. Angles are computed
between each possible couple of species descending from a specified node
(<code>"node"</code>), or between a given couple of species (<code>"tips"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pair</code></td>
<td>
<p>species pair to be specified if <code>pair.type = "tips"</code>. It
needs to be written as in the example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>node number to be specified if <code>pair.type = "node"</code>. Notice
the node number must refer to the dichotomic version of the original tree,
as produced by <code>RRphylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>whether to perform randomization test
(<code>"yes"</code>/<code>"no"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of replications must be indicated if <code>random =
"yes"</code>. It is set at 100 by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The way <code>evo.dir</code> computes vectors depends on whether
phenotypes or rates are used as variables. <code>RRphylo</code> rates
along a path are aligned along a chain of ancestor/descendant
relationships. As such, each rate vector origin coincides to the tip of its
ancestor, and the resultant of the path is given by vector addition. In
contrast, phenotypic vectors are computed with reference to a common origin
(i.e. the consensus shape in a geometric morphometrics). In this latter
case, vector subtraction (rather than addition) will define the resultant
of the evolutionary direction.  It is important to realize that resultants
could be at any angle even if the species (the terminal vectors) have
similar phenotypes, because path resultants, rather than individual
phenotypes, are being contrasted. However, the function also provides the
angle between individual phenotypes as 'angle.between.species'. To perform
randomization test (<code>random = "yes"</code>), the evolutionary directions of
the two species are collapsed together. Then, for each variable, the median
is found, and random paths of the same size as the original paths are
produced sampling at random from the 47.5th to the 52.5th percentile around
the medians. This way, a random distribution of angles is obtained under
the hypothesis that the two directions are actually parallel. The
'angle.direction' represents the angle formed by the species phenotype and
a vector of 1s (as long as the number of variables representing the
phenotype). This way, each species phenotype is contrasted to the same
vector. The 'angle.direction' values could be inspected to test whether
individual species phenotypes evolve towards similar directions.
</p>


<h3>Value</h3>

<p>Under all specs, <code>evo.dir</code> returns a 'list' object. The length
of the list is one if <code>pair.type = "tips"</code>.  If <code>pair.type =
  "node"</code>, the list is as long as the number of all possible species pairs
descending from the node. Each element of the list contains:
</p>
<p><strong>angle.path.A</strong> angle of the resultant vector of species A to
MRCA
</p>
<p><strong>vector.size.species.A</strong> size of the resultant vector of
species A to MRCA
</p>
<p><strong>angle.path.B</strong> angle of the resultant vector of species B to
MRCA
</p>
<p><strong>vector.size.species.B</strong> size of the resultant vector of
species B to MRCA
</p>
<p><strong>angle.between.species.to.mrca</strong> angle between the species
paths resultant vectors to the MRCA
</p>
<p><strong>angle.between.species</strong> angle between species vectors (as they
are, without computing the path)
</p>
<p><strong>MRCA</strong> the node identifying the most recent common ancestor of
A and B
</p>
<p><strong>angle.direction.A</strong> angle of the vector of species A (as it
is, without computing the path) to a fixed reference vector (the same for
all species)
</p>
<p><strong>vec.size.direction.A</strong> size of the vector of species A
</p>
<p><strong>angle.direction.B</strong> angle of the vector of species B (as it
is, without computing the path) to a fixed reference vector (the same for
all species)
</p>
<p><strong>vec.size.direction.B</strong> size of the vector of species B
</p>
<p>If <code>random = "yes"</code>, results also include p-values for the
angles.
</p>


<h3>Author(s)</h3>

<p>Pasquale Raia, Silvia Castiglione, Carmela Serio, Alessandro
Mondanaro, Marina Melchionna, Mirko Di Febbraro, Antonio Profico, Francesco
Carotenuto
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  data("DataApes")
  DataApes$PCstage-&gt;PCstage
  DataApes$Tstage-&gt;Tstage
  cc&lt;- 2/parallel::detectCores()

  RRphylo(tree=Tstage,y=PCstage, clus=cc)-&gt;RR

# Case 1. Without performing randomization test

 # Case 1.1 Computing angles between rate vectors
  # for each possible couple of species descending from node 72
    evo.dir(RR,angle.dimension="rates",pair.type="node",node=72 ,
    random="no")
  # for a given couple of species
    evo.dir(RR,angle.dimension="rates",pair.type="tips",
    pair= c("Sap_1","Tro_2"),random="no")

 # Case 1.2 computing angles between phenotypic vectors provided by the user
  # for each possible couple of species descending from node 72
    evo.dir(RR,angle.dimension="phenotypes",y.type="original",
    y=PCstage,pair.type="node",node=72,random="no")
  # for a given couple of species
    evo.dir(RR,angle.dimension="phenotypes",y.type="original",
    y=PCstage,pair.type="tips",pair=c("Sap_1","Tro_2"),random="no")

 # Case 1.3 computing angles between phenotypic vectors produced by "RRphylo"
  # for each possible couple of species descending from node 72
    evo.dir(RR,angle.dimension="phenotypes",y.type="RR",
    pair.type="node",node=72,random="no")
  # for a given couple of species
    evo.dir(RR,angle.dimension="phenotypes",y.type="RR",
    pair.type="tips",pair=c("Sap_1","Tro_2"),random="no")


# Case 2. Performing randomization test

 # Case 2.1 Computing angles between rate vectors
  # for each possible couple of species descending from node 72
    evo.dir(RR,angle.dimension="rates",pair.type="node",node=72 ,
    random="yes",nrep=10)

  # for a given couple of species
    evo.dir(RR,angle.dimension="rates",pair.type="tips",
    pair= c("Sap_1","Tro_2"),random="yes",nrep=10)

 # Case 2.2 computing angles between phenotypic vectors provided by the user
  # for each possible couple of species descending from node 72
    evo.dir(RR,angle.dimension="phenotypes",y.type="original",
    y=PCstage,pair.type="node",node=72,random="yes",nrep=10)

  # for a given couple of species
    evo.dir(RR,angle.dimension="phenotypes",y.type="original",
    y=PCstage,pair.type="tips",pair=c("Sap_1","Tro_2"),random="yes",nrep=10)

 # Case 2.3 computing angles between phenotypic vectors produced by "RRphylo"
  # for each possible couple of species descending from node 72
    evo.dir(RR,angle.dimension="phenotypes",y.type="RR",
    pair.type="node",node=72,random="yes",nrep=10)

  # for a given couple of species
    evo.dir(RR,angle.dimension="phenotypes",y.type="RR",
    pair.type="tips",pair=c("Sap_1","Tro_2"),random="yes",nrep=10)
    
## End(Not run)
</code></pre>


</div>