<div class="container">

<table style="width: 100%;"><tr>
<td>sEddyProc_sMDSGapFillAfterUstar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>sEddyProc sMDSGapFillAfterUstar</h2>

<h3>Description</h3>

<p>sEddyProc$sMDSGapFillAfterUstar - MDS gap filling algorithm after u* filtering</p>


<h3>Usage</h3>

<pre><code class="language-R">sEddyProc_sMDSGapFillAfterUstar(fluxVar, 
    uStarVar = "Ustar", uStarTh = .self$sGetUstarScenarios()[, 
        c("season", uStarSuffix), drop = FALSE], 
    uStarSuffix = "uStar", isFlagEntryAfterLowTurbulence = FALSE, 
    isFilterDayTime = FALSE, swThr = 10, 
    RgColName = "Rg", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fluxVar</code></td>
<td>
<p>Flux variable to gap fill after ustar filtering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uStarVar</code></td>
<td>
<p>Column name of friction velocity u * (ms-1),
default 'Ustar'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uStarTh</code></td>
<td>
<p>data.frame with
first column, season names, and second column estimates of uStar Threshold.
Alternatively, a single value to be used as threshold for all records
If only one value is given, it is used for all records.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uStarSuffix</code></td>
<td>
<p>Different suffixes required are for
different u * scenarios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isFlagEntryAfterLowTurbulence</code></td>
<td>
<p>Set to TRUE for flagging the
first entry after low turbulence as bad condition (by value of 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isFilterDayTime</code></td>
<td>
<p>Set to TRUE to also filter day-time values,
default only filters night-time data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>swThr</code></td>
<td>
<p>threshold of solar radiation below which data is
marked as night time respiration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RgColName</code></td>
<td>
<p>Column name of incoming short wave radiation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>sEddyProc_sMDSGapFill</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calling <code>sEddyProc_sMDSGapFill</code> after filtering for
(provided) friction velocity u*
</p>
<p>The u* threshold(s) are provided with argument <code>uStarTh</code> for
filtering the conditions of low turbulence.
After filtering, the data is gap filled using the MDS algorithm
<code>sEddyProc_sMDSGapFill</code>.
</p>
<p>With <code>isFlagEntryAfterLowTurbulence set to TRUE</code>, to be more
conservative, in addition
to the data acquired when uStar is below the threshold,
the first half hour measured with good turbulence conditions
after a period with low turbulence is also removed (Papale et al. 2006).</p>


<h3>Value</h3>

<p>Vector with quality flag from filtering (here 0: good data
, 1: low turbulence, 2: first half hour after low turbulence
, 3: no threshold available, 4: missing uStar value)
Gap filling results are in sTEMP data frame (with renamed columns)
that can be retrieved by <code>sEddyProc_sExportResults</code>.</p>


<h3>Author(s)</h3>

<p>AMM, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>


<ul>
<li> <p><code>sEddyProc_sEstimateUstarScenarios</code> and
<code>link{sEddyProc_sEstUstarThold}</code> for estimating the
u* threshold from the data.
</p>
</li>
<li> <p><code>sEddyProc_sMDSGapFillUStarScens</code> for
automated gapfilling for several scenarios of u* threshold estimates.
</p>
</li>
</ul>
</div>