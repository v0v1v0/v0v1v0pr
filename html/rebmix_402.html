<div class="container">

<table style="width: 100%;"><tr>
<td>dfmix-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predictive Marginal Density Calculation
</h2>

<h3>Description</h3>

<p>Returns the data frame containing observations <code class="reqn">\bm{x}_{1}, \ldots, \bm{x}_{n}</code> and
predictive marginal densities <code class="reqn">f(\bm{x} | c, \bm{w}, \bm{\Theta})</code>. Vectors <code class="reqn">\bm{x}</code> are subvectors of
<code class="reqn">\bm{y} = (y_{1}, \ldots, y_{d})^{\top}</code>. If <code class="reqn">\bm{x} = \bm{y}</code> the method returns the data frame containing observations <code class="reqn">\bm{y}_{1}, \ldots, \bm{y}_{n}</code> and
the corresponding predictive mixture densities <code class="reqn">f(\bm{y} | c, \bm{w}, \bm{\Theta})</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'REBMIX'
dfmix(x = NULL, Dataset = data.frame(), pos = 1, variables = expression(1:d), ...)
## ... and for other signatures
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>see Methods section below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>

<p>a data frame containing observations <code class="reqn">\bm{y} = (y_{1}, \ldots, y_{d})^{\top}</code> for which the predictive marginal densities are calculated. The default value is <code>data.frame()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>

<p>a desired row number in <code>x@summary</code> for which the predictive marginal densities are calculated. The default value is <code>1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>

<p>a vector containing indices of variables in subvectors <code class="reqn">\bm{x}</code>. The default value is <code>1:d</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>currently not used.
</p>
</td>
</tr>
</table>
<h3>Methods</h3>


<dl>
<dt><code>signature(x = "REBMIX")</code></dt>
<dd>
<p>an object of class <code>REBMIX</code>.</p>
</dd>
<dt><code>signature(x = "REBMVNORM")</code></dt>
<dd>
<p>an object of class <code>REBMVNORM</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Marko Nagode</p>


<h3>References</h3>

<p>M. Nagode and M. Fajdiga. The rebmix algorithm for the univariate finite mixture estimation.
Communications in Statistics - Theory and Methods, 40(5):876-892, 2011a. <a href="https://doi.org/10.1080/03610920903480890">doi:10.1080/03610920903480890</a>.<br><br>
M. Nagode and M. Fajdiga. The rebmix algorithm for the multivariate finite mixture estimation.
Communications in Statistics - Theory and Methods, 40(11):2022-2034, 2011b. <a href="https://doi.org/10.1080/03610921003725788">doi:10.1080/03610921003725788</a>.<br><br>
M. Nagode. Finite mixture modeling via REBMIX.
Journal of Algorithms and Optimization, 3(2):14-28, 2015. <a href="https://repozitorij.uni-lj.si/Dokument.php?id=127674&amp;lang=eng">https://repozitorij.uni-lj.si/Dokument.php?id=127674&amp;lang=eng</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate simulated dataset.

n &lt;- c(15, 15)

Theta &lt;- new("RNGMIX.Theta", c = 2, pdf = rep("normal", 3))

a.theta1(Theta, 1) &lt;- c(10, 20, 30)
a.theta1(Theta, 2) &lt;- c(3, 4, 5)
a.theta2(Theta, 1) &lt;- c(3, 2, 1)
a.theta2(Theta, 2) &lt;- c(15, 10, 5)

simulated &lt;- RNGMIX(Dataset.name = paste("simulated_", 1:4, sep = ""),
  rseed = -1,
  n = n,
  Theta = a.Theta(Theta))

# Number of classes or nearest neighbours to be processed.

K &lt;- c(as.integer(1 + log2(sum(n))), # Minimum v follows Sturges rule.
  as.integer(10 * log10(sum(n)))) # Maximum v follows log10 rule.

# Estimate number of components, component weights and component parameters.

simulatedest &lt;- REBMIX(model = "REBMVNORM",
  Dataset = a.Dataset(simulated),
  Preprocessing = "h",
  cmax = 4,
  Criterion = "BIC")

# Preprocess simulated dataset.

Dataset &lt;- data.frame(c(-7, 1), NA, c(3, 7))

f &lt;- dfmix(simulatedest, Dataset = Dataset, pos = 3, variables = c(1, 3))

f

# Plot finite mixture.

opar &lt;- plot(simulatedest, pos = 3, nrow = 3, ncol = 1,
  contour.drawlabels = TRUE, contour.labcex = 0.6)

par(usr = opar[[2]]$usr, mfg = c(2, 1))

points(x = f[, 1], y = f[, 2])

text(x = f[, 1], y = f[, 2], labels = format(f[, 3], digits = 3), cex = 0.8, pos = 4)
</code></pre>


</div>