<div class="container">

<table style="width: 100%;"><tr>
<td>realisedIbdVariance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance of realised relatedness coefficients</h2>

<h3>Description</h3>

<p>Compute the variance of realised relatedness coefficients, by doubly
integrating the corresponding two-locus coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">realisedIbdVariance(x, ids = leaves(x), coeff, L = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A ped object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>A vector naming two members of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>
<p>A string naming a coefficient for which the variance is to be
computed. See Details for legal values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>A positive number; the chromosome length in Morgan.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The double integral method was used by Guo to compute the variation in
proportion of the genome shared IBD (Guo 1995, see also Thompson 2013). The
method extends directly to other coefficients. The implementation here
supports Cotterman's kappa coefficients (of noninbred individuals), and
Jacquard's condensed identity coefficients.
</p>
<p>This function is a bare-bones implementation of the double integral method,
based on <code>stats::integrate</code>, and can probably be optimised in various ways.
</p>
<p>The <code>coeff</code> parameter must be either a character naming the coefficient to
compute, or a function. If a character, it must be one of the following
names:
</p>

<ul>
<li>
<p> "inb" (inbreeding coefficient)
</p>
</li>
<li>
<p> "kinship", "phi" (synonyms for the kinship coefficient)
</p>
</li>
<li>
<p> "k0", "k1", "k2" (kappa coefficients of noninbred individuals)
</p>
</li>
<li>
<p> "D1", "D2", ... "D9" (condensed identity coefficients)
</p>
</li>
</ul>
<h3>Value</h3>

<p>A positive number.
</p>


<h3>References</h3>


<ul>
<li>
<p> Guo (1995) <em>Proportion of genome shared identical by descent by relatives:
concept, computation, and applications</em>. Am J Hum Genet.
</p>
</li>
<li>
<p> Hill &amp; Weir (2011). <em>Variation in actual relationship as a consequence of
Mendelian sampling and linkage</em>. Genet Res.
</p>
</li>
<li>
<p> Thompson (2013). <em>Identity by Descent: Variation in Meiosis, Across
Genomes, and in Populations</em>. Genetics.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">###################################
### Box 1 of Hill &amp; Weir (2011) ###
###################################

# Eq. 4b of Hill &amp; Weir
phi = function(n, l) {
 1/(2*l^2) * (1/4)^n * sum(sapply(1:n, function(r)
   choose(n, r) * (2*r*l - 1 + exp(-2*r*l))/r^2))
}

# Chromosome of 1 Morgan
L = 1

### Full sibs ###

## Not run: 
x = nuclearPed(2)
realisedIbdVariance(x, ids = 3:4, coeff = "k2", L = L)

# Hill &amp; Weir (Box 1)
16*phi(4,L) - 16*phi(3,L) + 8*phi(2,L) - 2*phi(1,L)

## End(Not run)

### Double first cousins ###

## Not run: 
dfc = doubleFirstCousins()

# Runtime ~1 min
realisedIbdVariance(dfc, coeff = "k0", L = L)
realisedIbdVariance(dfc, coeff = "k1", L = L)
realisedIbdVariance(dfc, coeff = "k2", L = L)

# Hill &amp; Weir, Box 1
var_k2 = 64*phi(8,L) - 64*phi(7,L) + 40*phi(6,L) - 20*phi(5,L) +
  33/4*phi(4,L) - 5/2*phi(3,L) + 5/8*phi(2,L)-1/8*phi(1,L)
var_k1 = 4*var_k2
var_k0 = var_k2 + 2 * (4*phi(4,L) - 2*phi(3,L) + 3/4*phi(2,L) - 1/4*phi(1,L))

var_k0
var_k1
var_k2

## End(Not run)

</code></pre>


</div>