<div class="container">

<table style="width: 100%;"><tr>
<td>hMeanChiSq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>harmonic mean chi-squared test</h2>

<h3>Description</h3>

<p>p-values and confidence intervals from the harmonic mean chi-squared test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hMeanChiSq(
  z,
  w = rep(1, length(z)),
  alternative = c("greater", "less", "two.sided", "none"),
  bound = FALSE
)

hMeanChiSqMu(
  thetahat,
  se,
  w = rep(1, length(thetahat)),
  mu = 0,
  alternative = c("greater", "less", "two.sided", "none"),
  bound = FALSE
)

hMeanChiSqCI(
  thetahat,
  se,
  w = rep(1, length(thetahat)),
  alternative = c("two.sided", "greater", "less", "none"),
  conf.level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Numeric vector of z-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Numeric vector of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Either "greater" (default), "less", "two.sided", or "none".
Specifies the alternative to be considered in the computation of the p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>
<p>If <code>FALSE</code> (default), p-values that cannot be computed are reported as <code>NaN</code>.
If <code>TRUE</code>, they are reported as "&gt; bound".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetahat</code></td>
<td>
<p>Numeric vector of parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Numeric vector of standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The null hypothesis value. Defaults to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Numeric vector specifying the conf.level of the confidence interval. Defaults to 0.95.
summarize the gamma values, i.e.,
the local minima of the p-value function between the thetahats. Defaults is a vector of 1s.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>hMeanChiSq</code>: returns the p-values from the harmonic mean chi-squared test
based on the study-specific z-values.
</p>
<p><code>hMeanChiSqMu</code>: returns the p-value from the harmonic mean chi-squared test
based on study-specific estimates and standard errors.
</p>
<p><code>hMeanChiSqCI</code>: returns a list containing confidence interval(s)
obtained by inverting the harmonic mean chi-squared test based on study-specific
estimates and standard errors. The list contains:
</p>
<table><tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Confidence interval(s).</p>
</td>
</tr></table>
<p><br><br>
If the <code>alternative</code> is "none", the list also contains:
</p>
<table><tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Local minima of the p-value function between the thetahats.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Leonhard Held, Florian Gerber
</p>


<h3>References</h3>

<p>Held, L. (2020). The harmonic mean chi-squared test to substantiate scientific findings.
<em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, <b>69</b>, 697-708.
<a href="https://doi.org/10.1111/rssc.12410">doi:10.1111/rssc.12410</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example from Fisher (1999) as discussed in Held (2020)
pvalues &lt;- c(0.0245, 0.1305, 0.00025, 0.2575, 0.128)
lower &lt;- c(0.04, 0.21, 0.12, 0.07, 0.41)
upper &lt;- c(1.14, 1.54, 0.60, 3.75, 1.27)
se &lt;- ci2se(lower = lower, upper = upper, ratio = TRUE)
thetahat &lt;- ci2estimate(lower = lower, upper = upper, ratio = TRUE)

## hMeanChiSq() --------
hMeanChiSq(z = p2z(p = pvalues, alternative = "less"),
           alternative = "less")
hMeanChiSq(z = p2z(p = pvalues, alternative = "less"),
           alternative = "two.sided")
hMeanChiSq(z = p2z(p = pvalues, alternative = "less"),
           alternative = "none")

hMeanChiSq(z = p2z(p = pvalues, alternative = "less"),
           w = 1 / se^2, alternative = "less")
hMeanChiSq(z = p2z(p = pvalues, alternative = "less"),
           w = 1 / se^2, alternative = "two.sided")
hMeanChiSq(z = p2z(p = pvalues, alternative = "less"),
           w = 1 / se^2, alternative = "none")


## hMeanChiSqMu() --------
hMeanChiSqMu(thetahat = thetahat, se = se, alternative = "two.sided")
hMeanChiSqMu(thetahat = thetahat, se = se, w = 1 / se^2,
             alternative = "two.sided")
hMeanChiSqMu(thetahat = thetahat, se = se, alternative = "two.sided",
             mu = -0.1)

## hMeanChiSqCI() --------
## two-sided
CI1 &lt;- hMeanChiSqCI(thetahat = thetahat, se = se, w = 1 / se^2,
                    alternative = "two.sided")
CI2 &lt;- hMeanChiSqCI(thetahat = thetahat, se = se, w = 1 / se^2,
                    alternative = "two.sided", conf.level = 0.99875)
## one-sided
CI1b &lt;- hMeanChiSqCI(thetahat = thetahat, se = se, w = 1 / se^2,
                     alternative = "less", conf.level = 0.975)
CI2b &lt;- hMeanChiSqCI(thetahat = thetahat, se = se, w = 1 / se^2,
                     alternative = "less", conf.level = 1 - 0.025^2)

## confidence intervals on hazard ratio scale
print(exp(CI1$CI), digits = 2)
print(exp(CI2$CI), digits = 2)
print(exp(CI1b$CI), digits = 2)
print(exp(CI2b$CI), digits = 2)


## example with confidence region consisting of disjunct intervals
thetahat2 &lt;- c(-3.7, 2.1, 2.5)
se2 &lt;- c(1.5, 2.2, 3.1)
conf.level &lt;- 0.95; alpha &lt;- 1 - conf.level
muSeq &lt;- seq(-7, 6, length.out = 1000)
pValueSeq &lt;- hMeanChiSqMu(thetahat = thetahat2, se = se2,
                          alternative = "none", mu = muSeq)
(hm &lt;- hMeanChiSqCI(thetahat = thetahat2, se = se2, alternative = "none"))

plot(x = muSeq, y = pValueSeq, type = "l", panel.first = grid(lty = 1),
     xlab = expression(mu), ylab = "p-value")
abline(v = thetahat2, h = alpha, lty = 2)
arrows(x0 = hm$CI[, 1], x1 = hm$CI[, 2], y0 = alpha,
       y1 = alpha, col = "darkgreen", lwd = 3, angle = 90, code = 3)
points(hm$gamma, col = "red", pch = 19, cex = 2)

</code></pre>


</div>