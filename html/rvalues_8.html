<div class="container">

<table style="width: 100%;"><tr>
<td>mroot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multi-dimensional Root (Zero) Finding
</h2>

<h3>Description</h3>

<p>For a given multi-dimensional function with both a vector of lower bounds
and upper bounds, <code>mroot</code> finds a vector such that each 
component of the function is zero.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mroot(f, lower, upper, ..., f.lower = f(lower, ...), f.upper = f(upper, ...),
      tol = .Machine$double.eps^0.25, maxiter = 5000) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>the function for which the root is sought
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>

<p>a vector of lower end points 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>

<p>a vector of upper end points
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to <code>f</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.lower, f.upper</code></td>
<td>

<p>the same as <code>f(lower)</code> and <code>f(upper)</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>the convergence tolerance
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>the maximum number of iterations
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>f</code> is from <code class="reqn">R^{n}</code> to <code class="reqn">R^{n}</code> with 
<code class="reqn">f(x_1,\dots,x_n) = (f_1(x_1),\dots,f_n(x_n))</code>.
</p>
<p>A root <code class="reqn">x = (x_1,\dots,x_n)</code> of <code class="reqn">f</code> satisfies
<code class="reqn">f_k(x_k) = 0</code> for each component <code class="reqn">k</code>.
</p>
<p><code>lower</code> <code class="reqn"> = (l_1,\ldots,l_n)</code> and <code>upper</code> 
<code class="reqn">= (u_1,\dots,u_n)</code> are both n-dimensional vectors
such that, for each <code class="reqn">k</code>, <code class="reqn">f_k</code> changes sign over the
interval <code class="reqn"> [l_k, u_k]</code>. 
</p>


<h3>Value</h3>

<p>a vector giving the estimated root of the function
</p>


<h3>Author(s)</h3>

<p>Nicholas Henderson
</p>


<h3>See Also</h3>

<p><code>uniroot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ff &lt;- function(x,a) {
    ans &lt;- qnorm(x) - a
    return(ans)
}
n &lt;- 10000
a &lt;- rnorm(n)
low &lt;- rep(0,n)
up &lt;- rep(1,n)

## Find the roots of ff, first using mroot and
## then by using uniroot inside a loop.

system.time(mr &lt;- mroot(ff, lower = low, upper = up, a = a))

ur &lt;- rep(0,n)
system.time({
for(i in 1:n) {
   ur[i] &lt;- uniroot(ff, lower = 0, upper = 1, a = a[i])$root    
}
})

</code></pre>


</div>