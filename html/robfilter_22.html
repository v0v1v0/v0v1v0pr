<div class="container">

<table style="width: 100%;"><tr>
<td>scarm.filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SCARM (Slope Comparing Adaptive Repeated Median)</h2>

<h3>Description</h3>

<p>A procedure for robust online signal extraction from univariate time series ("smoothing") by a moving window technique with adaptive window width selection based on Repeated Median regression</p>


<h3>Usage</h3>

<pre><code class="language-R">scarm.filter(time.series,
             right.width=30, min.left.width=right.width,
             min.width=floor(right.width/3), max.width=200,
             sign.level=0.001, bound.noise.sd=0.01, rtr=TRUE,
             autocorrelations="automatic")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>
<p>a numeric vector or (univariate) time series object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right.width</code></td>
<td>
<p>a positive integer &gt;=5 defining the fixed width of the right-hand window used for testing; the choice of <code>right.width</code> is crucial to distinguish between a patch of outliers and a signal change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.left.width</code></td>
<td>
<p>a positive integer <code class="reqn">\ge</code> <code>right.width</code> defining the minimum width of the left-hand window used for testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.width</code></td>
<td>
<p>a positive integer <code class="reqn">\ge 5</code> specifying the minimum window width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.width</code></td>
<td>
<p>a positive integer <code class="reqn">\ge</code> <code>min.width</code> and <code class="reqn">\ge</code> <code>right.width</code> + <code>min.left.width</code> specifying the maximum window width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign.level</code></td>
<td>
<p>significance level of the test procedure; must be a value in <code class="reqn">(0,0.5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound.noise.sd</code></td>
<td>
<p>a lower bound for the estimate of the noise standard deviation; this bound ensures that the noise scale estimate cannot be zero due to ties in the data; must be a value <code class="reqn">&gt; 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtr</code></td>
<td>
<p>if <code>rtr=TRUE</code>, the signal estimation is restricted to the range of the rightmost <code>min.width</code> observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autocorrelations</code></td>
<td>
<p>the <code>scarm.filter</code> is developed for non-autocorrelated data, but can be adapted to work for AR(1) processes with parameter <code class="reqn">\phi = -0.9,-0.6,...,0.9</code>; <code>autocorrelations</code> must be either "no" (<code class="reqn">\phi=0</code>), "high.positive" (<code class="reqn">\phi=0.9</code>), "moderate.positive" (<code class="reqn">\phi=0.6</code>), "small.positive" (<code class="reqn">\phi=0.3</code>), "small.negative" (<code class="reqn">\phi=-0.3</code>), "moderate.negative (<code class="reqn">\phi=-0.6</code>)", "high.negative (<code class="reqn">\phi=-0.9</code>)" or "automatic"; if <code>autocorrelations="automatic"</code>, the true parameter <code class="reqn">\phi</code> is estimated at each time point.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>scarm.filter</code> fits a Repeated Median (RM, Siegel, 1982) regression line to a moving window sample with length varying between <code>min.width</code> and <code>max.width</code>.
</p>
<p>For each time point, the window width is adapted to the current data situation by a test comparing two RM slopes estimated in separated sub-windows, a right-hand and a left-hand window.
</p>
<p>A more detailed description of the filter can be found in Borowski and Fried (2011).
</p>


<h3>Value</h3>

<p><code>scarm.filter</code> returns an object of class <code>scarm.filter</code>.  
An object of class <code>scarm.filter</code> is a list containing the 
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>signal.est</code></td>
<td>
<p>a vector containing the signal estimations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope.est</code></td>
<td>
<p>a vector containing the slope (or trend) estimations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapted.width</code></td>
<td>
<p>a vector containing the adapted window widths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.statistic</code></td>
<td>
<p>a vector containing the SCARM test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>critvals</code></td>
<td>
<p>a vector containing the critical values for test decision</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise.sd</code></td>
<td>
<p>a vector containing the estimates of the noise standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope.diff</code></td>
<td>
<p>a vector containing the differences of the Repeated Median slopes estimated in the left-hand and right-hand window</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acf.lag.one</code></td>
<td>
<p>a vector containing the estimated autocorrelations at lag one for each time point; estimation is done on the recent <code>max.width</code> observations at each time point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>
<p>the original input data</p>
</td>
</tr>
</table>
<p>In addition, the input arguments used for the analysis are returned as list members.
</p>
<p>Application of the function <code>plot</code> to an object of class
<code>scarm.filter</code> returns a plot showing the original time series 
with the filtered output. If <code>info==TRUE</code> (default), a plot of the adapted window widths is also given.
</p>


<h3>Author(s)</h3>

<p>Matthias Borowski</p>


<h3>References</h3>

 
<p>Borowski, M. and Fried, R. (2011)
Robust repeated median regression in moving windows with data-adaptive width selection, <em>Discussion Paper 28/2011, SFB 823, TU Dortmund University</em>.<br></p>
<p>Gelper, S., Schettlinger, K., Croux, C., and Gather, U. (2009)
Robust online scale estimation in time series: A model-free approach,
<em>Journal of Statistical Planning and Inference</em>, <b>139</b>(2), 335-349.<br></p>
<p>Siegel, A.F. (1982)
Robust Regression Using Repeated Medians,
<em>Biometrika</em> <b>69</b>(1), 242-244.<br></p>


<h3>See Also</h3>

<p><code>robreg.filter</code>, <code>adore.filter</code>, <code>madore.filter</code>, <code>mscarm.filter</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># Time series
data(multi.ts)
x &lt;- multi.ts[,1]

# apply SCARM Filter 
scarm.extr &lt;- scarm.filter(x)
plot(scarm.extr)
</code></pre>


</div>