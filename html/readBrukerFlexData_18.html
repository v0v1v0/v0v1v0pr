<div class="container">

<table style="width: 100%;"><tr>
<td>readBrukerFlexFile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reads mass spectrometry data in Bruker Daltonics XMASS format.</h2>

<h3>Description</h3>

<p>This function reads mass spectrometry data in Bruker Daltonics XMASS format
used by Bruker Daltonics mass spectrometer of *flex series (autoflex,
microflex, ultraflex).
</p>


<h3>Usage</h3>

<pre><code class="language-R">readBrukerFlexFile(
  fidFile,
  removeMetaData = FALSE,
  useHpc = TRUE,
  filterZeroIntensities = FALSE,
  keepNegativeIntensities = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fidFile</code></td>
<td>
<p><code>character</code>, path to <em>fid</em> file which should be
read.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removeMetaData, </code></td>
<td>
<p><code>logical</code>, to calculate mass data a lot of meta
data are needed. To save memory they could be deleted after calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useHpc</code></td>
<td>
<p><code>logical</code>, should Bruker Daltonics' High Precision
Calibration be used if available?
(see also: <code>.hpc</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filterZeroIntensities</code></td>
<td>
<p><code>logical</code>, don't change it.
If <code>TRUE</code> all intensities equal <code>0.0</code> are removed.
(see also: ‘Details’ section)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepNegativeIntensities</code></td>
<td>
<p><code>logical</code>, don't change it.
If <code>FALSE</code> all intensities less than zero are replaced by
zero.
(see also: ‘Details’ section)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>logical</code>, print verbose messages?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>readBrukerFlexFile</code> has to import the following data to calculating
mass from <em>acqu</em> file:<br></p>

<table>
<tr>
<td style="text-align: left;">
acqu-value </td>
<td style="text-align: left;"> becomes metaData </td>
<td style="text-align: left;"> description </td>
</tr>
<tr>
<td style="text-align: left;">
$BYTORDA </td>
<td style="text-align: left;"> metaData$byteOrder </td>
<td style="text-align: left;"> endianness of fid file </td>
</tr>
<tr>
<td style="text-align: left;">
$TD </td>
<td style="text-align: left;"> metaData$number </td>
<td style="text-align: left;"> total number of measured time periods </td>
</tr>
<tr>
<td style="text-align: left;">
$DELAY </td>
<td style="text-align: left;"> metaData$timeDelay </td>
<td style="text-align: left;"> first measured intensity after
  <em>metaData$timeDelay</em> ns </td>
</tr>
<tr>
<td style="text-align: left;">
$DW </td>
<td style="text-align: left;"> metaData$timeDelta </td>
<td style="text-align: left;"> ns between measured time periods </td>
</tr>
<tr>
<td style="text-align: left;">
$ML1 </td>
<td style="text-align: left;"> metaData$calibrationConstants[1] </td>
<td style="text-align: left;"> mass calibration constant </td>
</tr>
<tr>
<td style="text-align: left;">
$ML2 </td>
<td style="text-align: left;"> metaData$calibrationConstants[2] </td>
<td style="text-align: left;"> mass calibration constant </td>
</tr>
<tr>
<td style="text-align: left;">
$ML3 </td>
<td style="text-align: left;"> metaData$calibrationConstants[3] </td>
<td style="text-align: left;"> mass calibration constant </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>If High Precision Calibration (HPC) is used, <code>readBrukerFlexFile</code> needs:
</p>

<table>
<tr>
<td style="text-align: left;">
acqu-value </td>
<td style="text-align: left;"> becomes metaData </td>
<td style="text-align: left;"> description </td>
</tr>
<tr>
<td style="text-align: left;">
$HPClBHi </td>
<td style="text-align: left;"> metaData$hpc$limits[“maxMass”] </td>
<td style="text-align: left;"> upper mass
 threshold </td>
</tr>
<tr>
<td style="text-align: left;">
$HPClBLo </td>
<td style="text-align: left;"> metaData$hpc$limits[“minMass”] </td>
<td style="text-align: left;"> lower mass
 threshold </td>
</tr>
<tr>
<td style="text-align: left;">
$HPClOrd </td>
<td style="text-align: left;"> metaData$hpc$order </td>
<td style="text-align: left;"> polynomial order </td>
</tr>
<tr>
<td style="text-align: left;">
$HPClUse </td>
<td style="text-align: left;"> metaData$hpc$use </td>
<td style="text-align: left;"> maybe using of HPC? (seems to be always
“yes” in our test data) </td>
</tr>
<tr>
<td style="text-align: left;">
$HPCStr </td>
<td style="text-align: left;"> metaData$hpc$coefficients </td>
<td style="text-align: left;"> polynomial coefficients in a
string </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><code>readBrukerFlexFile</code> tries also to import [optional]: <br></p>

<table>
<tr>
<td style="text-align: left;">
acqu-value </td>
<td style="text-align: left;"> becomes metaData </td>
<td style="text-align: left;"> description </td>
</tr>
<tr>
<td style="text-align: left;">
DATATYPE </td>
<td style="text-align: left;"> metaData$dataType </td>
<td style="text-align: left;"> e.g CONTINUOUS MASS SPECTRUM </td>
</tr>
<tr>
<td style="text-align: left;">
SPECTROMETER/DATASYSTEM </td>
<td style="text-align: left;"> metaData$dataSystem </td>
<td style="text-align: left;">
 e.g. Bruker Flex Series </td>
</tr>
<tr>
<td style="text-align: left;">
.SPECTROMETER TYPE </td>
<td style="text-align: left;"> metaData$spectrometerType </td>
<td style="text-align: left;"> e.g. TOF </td>
</tr>
<tr>
<td style="text-align: left;">
.INLET </td>
<td style="text-align: left;"> metaData$inlet </td>
<td style="text-align: left;"> DIRECT </td>
</tr>
<tr>
<td style="text-align: left;">
.IONIZATION MODE </td>
<td style="text-align: left;"> metaData$ionizationMode </td>
<td style="text-align: left;"> e.g. LD+ </td>
</tr>
<tr>
<td style="text-align: left;">
$DATE </td>
<td style="text-align: left;"> metaData$date </td>
<td style="text-align: left;"> same as $AQ_DATE but often only "0" </td>
</tr>
<tr>
<td style="text-align: left;">
$ACQMETH </td>
<td style="text-align: left;"> metaData$acquisitionMethod </td>
<td style="text-align: left;"> path to method file </td>
</tr>
<tr>
<td style="text-align: left;">
$AQ_DATE </td>
<td style="text-align: left;"> metaData$acquisitionDate </td>
<td style="text-align: left;"> acquisition date </td>
</tr>
<tr>
<td style="text-align: left;">
$AQ_mod </td>
<td style="text-align: left;"> metaData$acquisitionMode </td>
<td style="text-align: left;"> acquisition mode </td>
</tr>
<tr>
<td style="text-align: left;">
$AQOP_m </td>
<td style="text-align: left;"> metaData$acquisitionOperatorMode, metaData$tofMode </td>
<td style="text-align: left;">
 LINEAR / REFLECTOR </td>
</tr>
<tr>
<td style="text-align: left;">
$ATTEN </td>
<td style="text-align: left;"> metaData$laserAttenuation </td>
<td style="text-align: left;"> laser beam attenuation </td>
</tr>
<tr>
<td style="text-align: left;">
$CMT[1:4] </td>
<td style="text-align: left;"> metaData$comments </td>
<td style="text-align: left;"> comments </td>
</tr>
<tr>
<td style="text-align: left;">
$DEFLON </td>
<td style="text-align: left;"> metaData$deflection </td>
<td style="text-align: left;"> deflection ON/OFF </td>
</tr>
<tr>
<td style="text-align: left;">
$DIGTYP </td>
<td style="text-align: left;"> metaData$digitizerType </td>
<td style="text-align: left;"> type of digitizer </td>
</tr>
<tr>
<td style="text-align: left;">
$DPCAL1 </td>
<td style="text-align: left;"> metaData$deflectionPulserCal1 </td>
<td style="text-align: left;"> deflection pulser cal 1 </td>
</tr>
<tr>
<td style="text-align: left;">
$DPMASS </td>
<td style="text-align: left;"> metaData$deflectionPulserMass </td>
<td style="text-align: left;"> deflection pulser mass </td>
</tr>
<tr>
<td style="text-align: left;">
$FCVer </td>
<td style="text-align: left;"> metaData$flexControlVersion </td>
<td style="text-align: left;"> Version of
 Bruker Daltonics FlexControl software </td>
</tr>
<tr>
<td style="text-align: left;">
$ID_raw </td>
<td style="text-align: left;"> metaData$id </td>
<td style="text-align: left;"> spectrum id </td>
</tr>
<tr>
<td style="text-align: left;">
$INSTRUM </td>
<td style="text-align: left;"> metaData$instrument </td>
<td style="text-align: left;"> e.g. AUTOFLEX </td>
</tr>
<tr>
<td style="text-align: left;">
$InstrID </td>
<td style="text-align: left;"> metaData$instrumentId </td>
<td style="text-align: left;"> ID of mass spectrometer </td>
</tr>
<tr>
<td style="text-align: left;">
$InstTyp </td>
<td style="text-align: left;"> metaData$instrumentType </td>
<td style="text-align: left;"> instrument type </td>
</tr>
<tr>
<td style="text-align: left;">
$Lift1 </td>
<td style="text-align: left;"> metaData$lift[1] </td>
<td style="text-align: left;"> LIFT constant? </td>
</tr>
<tr>
<td style="text-align: left;">
$Lift2 </td>
<td style="text-align: left;"> metaData$lift[2] </td>
<td style="text-align: left;"> LIFT constant? </td>
</tr>
<tr>
<td style="text-align: left;">
$Masserr </td>
<td style="text-align: left;"> metaData$massError </td>
<td style="text-align: left;"> initial mass error in ppm </td>
</tr>
<tr>
<td style="text-align: left;">
$NoSHOTS </td>
<td style="text-align: left;"> metaData$laserShots </td>
<td style="text-align: left;"> number of applied laser shots </td>
</tr>
<tr>
<td style="text-align: left;">
$PATCHNO </td>
<td style="text-align: left;"> metaData$patch </td>
<td style="text-align: left;"> sample postion on target </td>
</tr>
<tr>
<td style="text-align: left;">
$PATH </td>
<td style="text-align: left;"> metaData$path </td>
<td style="text-align: left;"> original file path
 (on Bruker *flex series controller PC) </td>
</tr>
<tr>
<td style="text-align: left;">
$REPHZ </td>
<td style="text-align: left;"> metaData$laserRepetition </td>
<td style="text-align: left;"> laser repetition rate in Hz </td>
</tr>
<tr>
<td style="text-align: left;">
$SPOTNO </td>
<td style="text-align: left;"> metaData$spot </td>
<td style="text-align: left;"> same as <em>$PATCHNO</em>
 (in older files often empty, that's why <code>readBrukerFlexFile</code>
 uses <em>$PATHNO</em> instead) </td>
</tr>
<tr>
<td style="text-align: left;">
$SPType </td>
<td style="text-align: left;"> metaData$spectrumType </td>
<td style="text-align: left;"> e.g. TOF </td>
</tr>
<tr>
<td style="text-align: left;">
$TgIDS </td>
<td style="text-align: left;"> metaData$target$id </td>
<td style="text-align: left;"> target ids </td>
</tr>
<tr>
<td style="text-align: left;">
$TgCount </td>
<td style="text-align: left;"> metaData$target$count </td>
<td style="text-align: left;"> number of measurements
 with this target </td>
</tr>
<tr>
<td style="text-align: left;">
$TgSer </td>
<td style="text-align: left;"> metaData$target$serialNumber </td>
<td style="text-align: left;"> target serial number </td>
</tr>
<tr>
<td style="text-align: left;">
$TgTyp </td>
<td style="text-align: left;"> metaData$target$typeNumber </td>
<td style="text-align: left;"> target type number </td>
</tr>
<tr>
<td style="text-align: left;">
$TLift </td>
<td style="text-align: left;"> metaData$tlift </td>
<td style="text-align: left;"> LIFT constant? </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>import from file path:
</p>

<table>
<tr>
<td style="text-align: left;">
value </td>
<td style="text-align: left;"> becomes metaData </td>
<td style="text-align: left;"> description </td>
</tr>
<tr>
<td style="text-align: left;">
full current path to fid file </td>
<td style="text-align: left;"> metaData$file </td>
<td style="text-align: left;">
 path on local machine </td>
</tr>
<tr>
<td style="text-align: left;">
sample name </td>
<td style="text-align: left;"> metaData$sampleName </td>
<td style="text-align: left;"> - </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><code>filterZeroIntensities</code>: Change default value is <b>not recommended</b>!
If <code>TRUE</code> all intensities equal zero are removed.
This parameter exists only to be compatible to
Bruker Daltonics CompassXport's mzXML export function. For details see:
‘Release Notes for CompassXport 3.0.3’,
cap. 6 ‘Filtering of Zero Intensities’:
“Bruker Daltonics' Acquisition Software will compress Analysis raw
data. To save on operation time and to keep export file sizes small,
CompassXport 3.0.3 will filter out zero (0.0) intensities
when exporting to mzXML or mzData ...”
</p>
<p><code>keepNegativeIntensities</code>: Change default value is
<b>not recommended</b>! If <code>TRUE</code> negative intensity values are not
replaced by zero. This parameter exists only to be compatible to
Bruker Daltonics CompassXport.
</p>


<h3>Value</h3>

<p>A <code>list</code> of spectra and metadata.
</p>

<ul>
<li>
<p><code>spectrum$mass</code>: A vector of calculated mass.
</p>
</li>
<li>
<p><code>spectrum$tof</code>: A vector of time-of-flight data.
</p>
</li>
<li>
<p><code>spectrum$intensity</code>: A vector of intensity values.
</p>
</li>
<li>
<p><code>metaData</code>: A list of metaData depending on read spectrum.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><a href="https://github.com/sgibb/readBrukerFlexData/wiki">https://github.com/sgibb/readBrukerFlexData/wiki</a>,
<code>importBrukerFlex</code>,
<code>readBrukerFlexDir</code>,
<code>.hpc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load library
library("readBrukerFlexData")

## get examples directory
exampleDirectory &lt;- system.file("Examples", package="readBrukerFlexData")

## read example spectrum
spec &lt;- readBrukerFlexFile(file.path(exampleDirectory,
  "2010_05_19_Gibb_C8_A1/0_A1/1/1SLin/fid"))

## print metaData
print(spec$metaData)

## plot spectrum
plot(spec$spectrum$mass, spec$spectrum$intensity, type="l", col="red")

</code></pre>


</div>