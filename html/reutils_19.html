<div class="container">

<table style="width: 100%;"><tr>
<td>efetch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>efetch - downloading full records</h2>

<h3>Description</h3>

<p><code>efetch</code> performs calls to the NCBI EFetch utility to retrieve data records
in the requested format for an NCBI Accession Number, one or more primary UIDs,
or for a set of UIDs stored in the user's web environment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">efetch(uid, db = NULL, rettype = NULL, retmode = NULL, outfile = NULL,
  retstart = NULL, retmax = NULL, querykey = NULL, webenv = NULL,
  strand = NULL, seqstart = NULL, seqstop = NULL, complexity = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>uid</code></td>
<td>
<p>(Required) A list of UIDs provided either as a character vector, as an
<code>esearch</code> object, or by reference to a Web Environment
and a query key obtained directly from previous calls to <code>esearch</code>
(if <code>usehistory = TRUE</code>), <code>epost</code> or <code>elink</code>.
If UIDs are provided as a plain character vector, <code>db</code> must be
specified explicitly, and all of the UIDs must be from the database
specified by <code>db</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>(Required if <code>uid</code> is a character vector of UIDs)
Database from which to retrieve records. See
<a href="https://www.ncbi.nlm.nih.gov/books/NBK25497/table/chapter2.T._entrez_unique_identifiers_ui/?report=objectonly">here</a>
for the supported databases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rettype</code></td>
<td>
<p>A character string specifying the retrieval type, such as 'abstract' or
'medline' for PubMed, 'gp' or 'fasta' for Protein, or 'gb', or 'fasta' for Nuccore. See 
<a href="https://www.ncbi.nlm.nih.gov/books/NBK25499/table/chapter4.T._valid_values_of__retmode_and/?report=objectonly">here</a>
for the available values for each database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retmode</code></td>
<td>
<p>A character string specifying the data mode of the records returned,
such as 'text' or 'xml'. See 
<a href="https://www.ncbi.nlm.nih.gov/books/NBK25499/table/chapter4.T._valid_values_of__retmode_and/?report=objectonly">here</a>
for the available values for each database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile</code></td>
<td>
<p>A character string naming a file for writing the data to.
Required if more than 500 UIDs are retrieved at once. In this case UIDs
have to be provided by reference to a Web Environment and a query key
obtained directly from previous calls to <code>esearch</code>
(if <code>usehistory = TRUE</code>), <code>epost</code> or <code>elink</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retstart</code></td>
<td>
<p>Numeric index of the first record to be retrieved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retmax</code></td>
<td>
<p>Total number of records from the input set to be retrieved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>querykey</code></td>
<td>
<p>An integer specifying which of the UID lists attached
to a user's Web Environment will be used as input to <code>efetch</code>.
(Usually obtained drectely from objects returned by a previous call to
<code>esearch</code>, <code>epost</code> or <code>elink</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>webenv</code></td>
<td>
<p>A character string specifying the Web Environment that
contains the UID list. (Usually obtained directely from objects returned
by a previous call to <code>esearch</code>, <code>epost</code> or
<code>elink</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strand</code></td>
<td>
<p>Strand of DNA to retrieve. (1: plus strand, 2: minus strand)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqstart</code></td>
<td>
<p>First sequence base to retrieve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqstop</code></td>
<td>
<p>Last sequence base to retrieve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complexity</code></td>
<td>
<p>Data content to return. (0: entire data structure,
1: bioseq, 2: minimal bioseq-set, 3: minimal nuc-prot, 4: minimal pub-set)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the official online documentation for NCBI's
<a href="https://www.ncbi.nlm.nih.gov/books/NBK25499/#chapter4.EFetch">EUtilities</a>
for additional information.
</p>
<p>See
<a href="https://www.ncbi.nlm.nih.gov/books/NBK25499/table/chapter4.T._valid_values_of__retmode_and/?report=objectonly">here</a>
for the default values for <code>rettype</code> and <code>retmode</code>, as well as a list of the available
databases for the  EFetch utility.
</p>


<h3>Value</h3>

<p>An <code>efetch</code> object.
</p>


<h3>Note</h3>

<p>If you are going to retrieve more than 500 UIDs at once, you will have to provide
the UIDs by reference to a Web Environment and a query key obtained from previous
calls to <code>esearch</code> (if <code>usehistory = TRUE</code>), <code>epost</code>
or <code>elink</code> <strong>and</strong> you will have to specify an <code>outfile</code> to
write the data to, rather than collecting the data into an R object.
</p>


<h3>See Also</h3>

<p><code>content</code>, <code>getUrl</code>, <code>getError</code>,
<code>database</code>, <code>retmode</code>, <code>rettype</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## From Protein, retrieve a raw GenPept record and write it to a file.
p &lt;- efetch("195055", "protein", "gp")
p

write(content(p, "text"), file = "~/AAD15290.gp")

## Get accessions for a list of GenBank IDs (GIs)
acc &lt;- efetch(c("1621261", "89318838", "68536103", "20807972", "730439"),
              "protein", rettype = "acc")
acc
acc &lt;- strsplit(content(acc), "\n")[[1]]
acc

## Get GIs from a list of accession numbers
gi &lt;- efetch(c("CAB02640.1", "EAS10332.1", "YP_250808.1", "NP_623143.1", "P41007.1"),
             "protein", "uilist")
gi

## we can conveniently extract the UIDs using the eutil method #xmlValue(xpath)
gi$xmlValue("/IdList/Id")

## or we can extract the contents of the efetch query using the fuction content()
## and use the XML package to retrieve the UIDs
doc &lt;- content(gi)
XML::xpathSApply(doc, "/IdList/Id", XML::xmlValue)

## Get the scientific name for an organism starting with the NCBI taxon id.
tx &lt;- efetch("527031", "taxonomy")
tx
 
## Convenience accessor for XML nodes of interest using XPath
## Extract the TaxIds of the Lineage
tx["//LineageEx/Taxon/TaxId"]

## Use an XPath expession to extract the scientific name.
tx$xmlValue("/TaxaSet/Taxon/ScientificName")

## Iteratively retrieve a large number of records
# First store approx. 8400 UIDs on the History server.
uid &lt;- esearch(term = "hexokinase", db = 'protein', usehistory = TRUE)
# Fetch the records and write to file in batches of 500.
efetch(uid, rettype = "fasta", retmode = "text", outfile = "~/tmp/hexokinases.fna")


## End(Not run)
</code></pre>


</div>