<div class="container">

<table style="width: 100%;"><tr>
<td>scaleTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic tree calibration</h2>

<h3>Description</h3>

<p>The function is a wrapper around the functions "scalePhylo",
"assign.ages", and "assign.brlen" written by Gene Hunt
(http://paleobiology.si.edu/staff/individuals/hunt.cfm). It rescales tree
branch lengths according to given calibration dates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scaleTree(tree, tip.ages=NULL, node.ages=NULL,min.branch=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree. The tree needs not to be ultrametric and
fully dichotomous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.ages</code></td>
<td>
<p>a named vector including the ages (i.e. distance from the
youngest tip within the tree) of the tips to be changed. If unspecified, the
function assumes all the tips are correctly placed with respect to the root.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.ages</code></td>
<td>
<p>a named vector including the ages (i.e. distance from the
youngest tip within the tree) of the nodes to be changed. If no calibration
date for nodes is supplied, the tree root is fixed and the function shifts
node position only where needed to fit tip ages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.branch</code></td>
<td>
<p>has been deprecated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Rescaled phylogentic tree with tip labels ordered according to their position in the tree.
</p>


<h3>Author(s)</h3>

<p>Silvia Castiglione, Pasquale Raia, Carmela Serio, Alessandro
Mondanaro, Marina Melchionna, Mirko Di Febbraro, Antonio Profico, Francesco
Carotenuto
</p>


<h3>See Also</h3>

<p><a href="../doc/Tree-Manipulation.html#scaleTree"><code>scaleTree</code> vignette</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(ape)
library(phytools)

data("DataFelids")
DataFelids$treefel-&gt;tree

max(nodeHeights(tree))-&gt;H

#### Example 1 ####
rep(0,4)-&gt;tipAges
names(tipAges)&lt;-tips(tree,146)
scaleTree(tree,tipAges)-&gt;treeS1

edge.col&lt;-rep("black",nrow(tree$edge))
edge.col[which(treeS1$edge[,2]%in%getDescendants(treeS1,146))]&lt;-"red"

layout(2:1)
plot(tree,edge.color = edge.col,show.tip.label=FALSE)
plot(treeS1,edge.color = edge.col,show.tip.label=FALSE)

#### Example 2 ####
nodeAges&lt;-c(23.5,15.6)
names(nodeAges)&lt;-c(85,139)
scaleTree(tree,node.ages=nodeAges)-&gt;treeS2

edge.col&lt;-rep("black",nrow(tree$edge))
edge.col[which(treeS1$edge[,2]%in%c(getDescendants(treeS1,85),
                                    getDescendants(treeS1,139)))]&lt;-"red"

layout(2:1)
plot(tree,edge.color = edge.col,show.tip.label=FALSE)
nodelabels(bg="w",frame="n",node=c(85,139),col="green")
plot(treeS2,edge.color = edge.col,show.tip.label=FALSE)
nodelabels(bg="w",frame="n",node=c(85,139),col="green")

#### Example 3 ####
16-&gt;nodeAges
names(nodeAges)&lt;-"145"
tipAges&lt;-19
names(tipAges)&lt;-tree$tip.label[1]
scaleTree(tree,tip.ages = tipAges,node.ages=nodeAges)-&gt;treeS3

edge.col&lt;-rep("black",nrow(tree$edge))
edge.col[which(treeS3$edge[,2]%in%c(1,getMommy(tree,1),
                                    getDescendants(treeS3,145)))]&lt;-"red"

layout(2:1)
plot(tree,edge.color = edge.col,show.tip.label=FALSE)
nodelabels(bg="w",frame="n",node=145,col="green")
plot(treeS3,edge.color = edge.col,show.tip.label=FALSE)
nodelabels(bg="w",frame="n",node=145,col="green")

</code></pre>


</div>