<div class="container">

<table style="width: 100%;"><tr>
<td>covEstimation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance matrix estimation</h2>

<h3>Description</h3>

<p>Function which performs various estimations of covariance matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">covEstimation(rets, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rets</code></td>
<td>
<p>a matrix <code class="reqn">(T \times N)</code> of returns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>control parameters (see *Details*).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>control</code> is a list that can supply any of the following
components: 
</p>

<ul>
<li> <p><code>type</code> method used to compute the
covariance matrix, among <code>'naive'</code>, <code>'ewma'</code>, <code>'lw'</code>,
<code>'factor'</code>,<code>'const'</code>, <code>'cor'</code>, <code>'oneparm'</code>,
<code>'diag'</code> and <code>'large'</code> where: 
</p>
<p><code>'naive'</code> is used to compute 
the naive (standard) covariance matrix. 
</p>
<p><code>'ewma'</code> is used to compute the exponential weighting moving average covariance matrix. The following formula is used 
to compute the ewma covariance matrix:
</p>
<p style="text-align: center;"><code class="reqn">\Sigma_t := \lambda \Sigma_{t-1} + (1-\lambda)r_{t-1}r_{t-1}</code>
</p>

<p>where <code class="reqn">r_t</code> is the <code class="reqn">(N \times 1)</code> vector of returns at time
<code class="reqn">t</code>. Note that the data must be sorted from the oldest to the latest. See RiskMetrics (1996)
</p>
<p><code>'factor'</code> is used to compute the covariance matrix estimation using a
K-factor approach. See Harman (1976).
</p>
<p><code>'lw'</code> is a weighted average of the sample covariance matrix and a
'prior' or 'shrinkage target'. The prior is given by a one-factor model and
the factor is equal to the cross-sectional average of all the random
variables. See Ledoit and Wolf (2003).
</p>
<p><code>'const'</code> is a weighted average of the sample covariance matrix and a
'prior' or 'shrinkage target'.  The prior is given by constant correlation
matrix. See Ledoit and Wolf (2002).
</p>
<p><code>'cor'</code> is a weighted average of the sample covariance matrix and a
'prior' or 'shrinkage target'.  The prior is given by the constant
correlation covariance matrix given by Ledoit and Wolf (2003).
</p>
<p><code>'oneparm'</code> is a weighted average of the sample covariance matrix and a
'prior' or 'shrinkage target'.  The prior is given by the one-parameter
matrix. All variances are the same and all covariances are zero. 
See Ledoit and Wolf (2004).
</p>
<p><code>'diag'</code> is a weighted average of the sample covariance matrix and a
'prior' or 'shrinkage target'.  The prior is given by a diagonal matrix. 
See Ledoit and Wolf (2002).
</p>
<p><code>'large'</code> This estimator is a weighted average of the sample covariance
matrix and a 'prior' or 'shrinkage target'. Here, the prior is given by a
one-factor model. The factor is equal to the cross-sectional average of all
the random variables. The weight, or 'shrinkage intensity' is chosen to
minimize quadratic loss measured by the Frobenius norm. The estimator is
valid as the number of variables and/or the number of observations go to
infinity, but Monte-Carlo simulations show that it works well for values as
low as 10. The main advantage is that this estimator is guaranteed to be
invertible and well-conditioned even if variables outnumber observations. 
See Ledoit and Wolf (2004).
</p>
<p><code>'bs'</code> is the Bayes-Stein estimator for the covariance matrix given by
Jorion (1986).
</p>
<p>Default: <code>type = 'naive'</code>.
</p>
</li>
<li> <p><code>lambda</code> decay parameter. Default: <code>lambda = 0.94</code>.
</p>
</li>
<li> <p><code>K</code> number of factors to use when the K-factor approach is
chosen to estimate the covariance matrix. Default: <code>K = 1</code>.</p>
</li>
</ul>
<h3>Value</h3>

<p>A <code class="reqn">(N \times N)</code> covariance matrix.
</p>


<h3>Note</h3>

<p>Part of the code is adapted from the Matlab code by Ledoit and Wolf (2014).
</p>


<h3>Author(s)</h3>

<p>David Ardia, Kris Boudt and Jean-Philippe Gagnon Fleury.
</p>


<h3>References</h3>

<p>Jorion, P. (1986). 
Bayes-Stein estimation for portfolio analysis.
<em>Journal of Financial and Quantitative Analysis</em> <b>21</b>(3), pp.279-292. 
</p>
<p>Harman, H.H. (1976)
<em>Modern Factor Analysis</em>. 
3rd Ed. Chicago: University of Chicago Press.
</p>
<p>Ledoit, O., Wolf, M. (2002).  
Improved estimation of the covariance matrix of stock returns with an application to portfolio selection. 
<em>Journal of Empirical Finance</em> <b>10</b>(5), pp.603-621. 
</p>
<p>Ledoit, O., Wolf, M. (2003).  
Honey, I Shrunk the Sample Covariance Matrix.
<em>Journal of Portfolio Management</em> <b>30</b>(4), pp.110-119. 
</p>
<p>Ledoit, O., Wolf, M. (2004).  
A well-conditioned estimator for large-dimensional covariance matrices.
<em>Journal of Multivariate Analysis</em> <b>88</b>(2), pp.365-411. 
</p>
<p>RiskMetrics (1996)
<em>RiskMetrics Technical Document</em>.
J. P. Morgan/Reuters.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load returns of assets or portfolios
data("Industry_10")
rets = Industry_10

# Naive covariance estimation
covEstimation(rets)

# Ewma estimation of the covariance with default lambda = 0.94
covEstimation(rets, control = list(type = 'ewma'))

# Ewma estimation of the covariance with default lambda = 0.90
covEstimation(rets, control = list(type = 'ewma', lambda = 0.9))

# Factor estimation of the covariance with dafault K = 1
covEstimation(rets, control = list(type = 'factor'))

# Factor estimation of the covariance with K = 3
covEstimation(rets, control = list(type = 'factor', K = 3))

# Ledot-Wolf's estimation of the covariance
covEstimation(rets, control = list(type = 'lw'))

# Shrinkage of the covariance matrix using constant correlation matrix
covEstimation(rets, control = list(type = 'const'))

# Shrinkage of the covariance matrix towards constant correlation matrix by
# Ledoit-Wolf.
covEstimation(rets, control = list(type = 'cor'))

# Shrinkage of the covariance matrix towards one-parameter matrix
covEstimation(rets, control = list(type = 'oneparm'))

# Shrinkage of the covaraince matrix towards diagonal matrix
covEstimation(rets, control = list(type = 'diag'))

# Shrinkage of the covariance matrix for large data set
covEstimation(rets, control = list(type = 'large'))
</code></pre>


</div>