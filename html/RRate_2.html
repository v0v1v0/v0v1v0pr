<div class="container">

<table style="width: 100%;"><tr>
<td>HLtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Hosmer-Lemeshow test
</h2>

<h3>Description</h3>

<p>Test whether each element of x is sampled with the probability specified by the corrsponding element in p.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HLtest(x, p, g = 10, null = "all", boot = 1000, info = T, dir = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A boolean vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>A probability vector having the same length with x.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>

<p>The group number used in the test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>

<p>a character in c('all', 'chi2','boot'). 
If null=='chi2', then we use (g-1) degree of freedom chi2 distribution to approximately compute p value.
If null=='boot', then we use parametric bootstrap to compute p value.
If null=='all', then both methods are used. This is the default option.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>


<p>The resampling times to compute p value. Only effective when null=='boot' or 'all'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>

<p>Draw the null distribution of the test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>

<p>The directory to save the plot of the null distribution. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Null Hypothesis: Each element of x is sampled with a probability which is the corresponding element of p.
We group x to g groups according to p. Then we compare the success proportion with the mean value of p in each group. 
</p>


<h3>Value</h3>






<p>A list is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>

<p>The test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_chi2</code></td>
<td>

<p>The p value approximated by using chi2 distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_boot</code></td>
<td>

<p>The p value computed by using parametric bootstrap.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wei Jiang, Jing-Hao Xue and Weichuan Yu
</p>
<p>Maintainer: Wei Jiang &lt;wjiangaa@connect.ust.hk&gt;
</p>


<h3>References</h3>

<p>Hosmer, D. W., &amp; Lemesbow, S. (1980). Goodness of fit tests for the multiple logistic regression model. <em>Communications in statistics-Theory and Methods</em>, 9(10), 1043-1069.
</p>
<p>Jiang, W., Xue, J-H, and Yu, W.  What is the probability of replicating a statistically significant association in genome-wide association studies?. <em>Submitted</em>.
</p>


<h3>See Also</h3>

<p><code>RRate</code>
<code>repRateEst</code>, 
<code>SEest</code>,
<code>repSampleSizeRR</code>,
<code>repSampleSizeRR2</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">alpha&lt;-5e-6               #Significance level in the primary study
alphaR&lt;-5e-3              #Significance level in the replication study
zalpha2&lt;-qnorm(1-alpha/2)
zalphaR2&lt;-qnorm(1-alphaR/2)

##Load data
data('smryStats1')        #Example of summary statistics in 1st study
n2.0&lt;-2000                #Number of individuals in control group
n2.1&lt;-2000                #Number of individuals in case group

SE2&lt;-SEest(n2.0, n2.1, smryStats1$F_U, smryStats1$F_A) #SE in replication study
######  RR estimation  ######
RRresult&lt;-repRateEst(log(smryStats1$OR),smryStats1$SE, SE2,zalpha2,zalphaR2, output=TRUE,dir='.')

#### Hosmer-Lemeshow test  ####
data('smryStats2')        #Example of summary statistics in 2nd study
sigIdx&lt;-(smryStats1$P&lt;alpha)
repIdx&lt;-(sign(smryStats1$Z[sigIdx])*smryStats2$Z[sigIdx]&gt;zalphaR2)
groupNum&lt;-10 
HLresult&lt;-HLtest(repIdx,RRresult$RR,g=groupNum,dir='.')
</code></pre>


</div>