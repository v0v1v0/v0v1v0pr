<div class="container">

<table style="width: 100%;"><tr>
<td>fit_t_pl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
High-dimensional phylogenetic models of trait evolution
</h2>

<h3>Description</h3>

<p>Fits high-dimensional model of trait evolution on trees through penalized likelihood. A phylogenetic Leave-One-Out Cross-Validated log-likelihood (LOOCV) is used to estimate model parameters.</p>


<h3>Usage</h3>

<pre><code class="language-R">
fit_t_pl(Y, tree, model=c("BM", "OU", "EB", "lambda"),
		 method=c("RidgeAlt", "RidgeArch", "RidgeAltapprox", 
		 "LASSO", "LASSOapprox"), targM=c("null", "Variance", 
		 "unitVariance"), REML=TRUE, up=NULL, low=NULL, 
		 tol=NULL, starting=NULL, SE=NULL,
		 scale.height=TRUE, ...)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>A matrix of phenotypic traits values (the variables are represented as columns)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>An object of class 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>The evolutionary model, "BM" is Brownian Motion, "OU" is Ornstein-Uhlenbeck, "EB" is Early Burst, and "lambda" is Pagel's lambda transformation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The penalty method. "RidgeArch": Archetype (linear) Ridge penalty, "RidgeAlt": Quadratic Ridge penalty, "LASSO": Least Absolute Selection and Shrinkage Operator. "RidgeAltapprox" and "LASSOapprox" are fast approximations of the LOOCV for the Ridge quadratic and LASSO penalties
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targM</code></td>
<td>

<p>The target matrix used for the Ridge regularizations. "null" is a null target, "Variance" for a diagonal unequal variance target, "unitVariance" for an equal diagonal target. Only works with "RidgeArch","RidgeAlt", and "RidgeAltapprox" methods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>

<p>Use REML (default) or ML for estimating the parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>up</code></td>
<td>

<p>Upper bound for the parameter search of the evolutionary model (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low</code></td>
<td>

<p>Lower bound for the parameter search of the evolutionary model (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>minimum value for the regularization parameter. Singularities can occur with a zero value in high-dimensional cases. (default is NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting</code></td>
<td>

<p>Starting values for the parameter search (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>

<p>Standard errors associated with values in Y. If TRUE, SE will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.height</code></td>
<td>

<p>Whether the tree should be scaled to unit length or not. (default is TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Options to be passed through. (e.g., echo=FALSE to stop printing messages)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fit_t_pl</code> allows fitting various multivariate evolutionary models to high-dimensional datasets (where the number of variables <em>p</em> is larger than <em>n</em>). Models estimates are more accurate than maximum likelihood methods. Models fit can be compared using the GIC criterion (see ?GIC). Details about the methods are described in <em>Clavel et al. (2019)</em>.
</p>


<h3>Value</h3>

<p>a list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>loocv</code></td>
<td>
<p>the (negative) cross-validated penalized likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.par</code></td>
<td>
<p>the evolutionary model parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>the regularization/tuning parameter of the penalized likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrstruct</code></td>
<td>
<p>a list with the tansformed variables and the phylogenetic tree with branch length stretched to the model estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the evolutionary model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the penalization method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of traits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targM</code></td>
<td>
<p>the target used for Ridge Penalization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>a list with the estimated evolutionary covariance matrix and it's inverse</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>logical indicating if the REML (TRUE) or ML (FALSE) method has been used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p><code>Y</code> is the input dataset and <code>tree</code> is the input phylogenetic tree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>the estimated standard error</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The LASSO is computationally intensive. Please wait! For highly-dimensional datasets you should favor the "RidgeArch" method to speed up the computations.
The Ridge penalties with "null" or "unitVariance" targets are rotation invariants.</p>


<h3>Author(s)</h3>

<p>J. Clavel</p>


<h3>References</h3>

<p>Clavel, J., Aristide, L., Morlon, H., 2019. A Penalized Likelihood framework for high-dimensional phylogenetic comparative methods and an application to new-world monkeys brain evolution. Syst. Biol. 68: 93-116.
</p>


<h3>See Also</h3>

<p><code>ancestral</code>,
<code>phyl.pca_pl</code>,  
<code>GIC.fit_pl.rpanda</code>, 
<code>gic_criterion</code>
<code>mvgls</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

if(test){
require(mvMORPH)
set.seed(1)
n &lt;- 32 # number of species
p &lt;- 31 # number of traits

tree &lt;- pbtree(n=n) # phylogenetic tree
R &lt;- Posdef(p)      # a random symmetric matrix (covariance)

# simulate a dataset
Y &lt;- mvSIM(tree, model="BM1", nsim=1, param=list(sigma=R))

# fit the model
fit_t_pl(Y, tree, model="BM", method="RidgeAlt")

# try on rotated axis (using PCA)
trans &lt;- prcomp(Y, center=FALSE)
fit_t_pl(trans$x, tree, model="BM", method="RidgeAlt")

# Estimate the SE (similar to Pagel's lambda for BM). 
# Advised with empirical datasets
fit_t_pl(Y, tree, model="BM", method="RidgeAlt", SE=TRUE)
}

</code></pre>


</div>