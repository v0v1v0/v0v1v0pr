<div class="container">

<table style="width: 100%;"><tr>
<td>render_bokeh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Render Bokeh</h2>

<h3>Description</h3>

<p>Takes an image and a depth map to render the image with depth of field
(i.e. similar to "Portrait Mode" in an iPhone). User can specify a custom bokeh shape,
or use one of the built-in bokeh types.
</p>


<h3>Usage</h3>

<pre><code class="language-R">render_bokeh(
  image,
  depthmap,
  focus = 0.5,
  focallength = 100,
  fstop = 4,
  filename = NULL,
  preview = TRUE,
  preview_focus = FALSE,
  bokehshape = "circle",
  bokehintensity = 1,
  bokehlimit = 0.8,
  rotation = 0,
  aberration = 0,
  gamma_correction = TRUE,
  progress = interactive(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>image</code></td>
<td>
<p>Image filename or 3-layer RGB array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depthmap</code></td>
<td>
<p>Depth map filename or 1d array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focus</code></td>
<td>
<p>Defaults <code>0.5</code>. Depth in which to blur.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focallength</code></td>
<td>
<p>Default <code>100</code>. Focal length of the virtual camera.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fstop</code></td>
<td>
<p>Default <code>4</code>. F-stop of the virtual camera.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>Default <code>NULL</code>. The filename of the image to be saved. If this is not given, the image will be plotted instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preview</code></td>
<td>
<p>Default <code>TRUE</code>. If <code>FALSE</code>, it will not display the image and just return the RGB array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preview_focus</code></td>
<td>
<p>Default <code>FALSE</code>. If <code>TRUE</code>, a red line will be drawn across the image
showing where the camera will be focused.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bokehshape</code></td>
<td>
<p>Default <code>circle</code>. Also built-in: <code>hex</code>. The shape of the bokeh. If the user
passes in a 2D matrix, that matrix will control the shape of the bokeh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bokehintensity</code></td>
<td>
<p>Default <code>1</code>. Intensity of the bokeh when the pixel intensity is greater than <code>bokehlimit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bokehlimit</code></td>
<td>
<p>Default <code>0.8</code>. Limit after which the bokeh intensity is increased by <code>bokehintensity</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>
<p>Default <code>0</code>. Number of degrees to rotate the hexagonal bokeh shape.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aberration</code></td>
<td>
<p>Default <code>0</code>. Adds chromatic aberration to the image. Maximum of <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_correction</code></td>
<td>
<p>Default <code>TRUE</code>. Controls gamma correction when adding colors. Default exponent of 2.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Default <code>TRUE</code>. Whether to display a progress bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>plot_image()</code> if <code>preview = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>3-layer RGB array of the processed image.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(run_documentation()){
#Plot the dragon
plot_image(dragon)
}
if(run_documentation()){
#Plot the depth map
plot_image(dragondepth/1500)
}
if(run_documentation()){
#Preview the focal plane:
render_bokeh(dragon, dragondepth, focus=950, preview_focus = TRUE)
}
if(run_documentation()){
#Change the focal length:
render_bokeh(dragon, dragondepth, focus=950, focallength=300)
}
if(run_documentation()){
#Add chromatic aberration:
render_bokeh(dragon, dragondepth, focus=950, focallength=300, aberration = 0.5)
}
if(run_documentation()){
#Change the focal distance:
render_bokeh(dragon, dragondepth, focus=600, focallength=300)
render_bokeh(dragon, dragondepth, focus=1300, focallength=300)
}
if(run_documentation()){
#Change the bokeh shape to a hexagon:
render_bokeh(dragon, dragondepth, bokehshape = "hex",
            focallength=300, focus=600)
}
if(run_documentation()){
#Change the bokeh intensity:
render_bokeh(dragon, dragondepth,
            focallength=400, focus=900, bokehintensity = 1)
render_bokeh(dragon, dragondepth,
            focallength=400, focus=900, bokehintensity = 3)
}
if(run_documentation()){
#Rotate the hexagonal shape:
render_bokeh(dragon, dragondepth, bokehshape = "hex", rotation=15,
            focallength=300, focus=600)
}
</code></pre>


</div>