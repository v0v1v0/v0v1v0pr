<div class="container">

<table style="width: 100%;"><tr>
<td>pffrGLS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized function-on-function regression with non-i.i.d. residuals</h2>

<h3>Description</h3>

<p>Implements additive regression for functional and scalar covariates and functional responses.
This function is a wrapper for <code>mgcv</code>'s <code>gam</code> and its siblings to fit models of the general form <br><code class="reqn">Y_i(t) = \mu(t) + \int X_i(s)\beta(s,t)ds + f(z_{1i}, t) + f(z_{2i}) + z_{3i} \beta_3(t) + \dots  + E_i(t))</code><br>
with a functional (but not necessarily continuous) response <code class="reqn">Y(t)</code>,
(optional) smooth intercept <code class="reqn">\mu(t)</code>, (multiple) functional covariates <code class="reqn">X(t)</code> and scalar covariates
<code class="reqn">z_1</code>, <code class="reqn">z_2</code>, etc. The residual functions <code class="reqn">E_i(t) \sim GP(0, K(t,t'))</code> are assumed to be i.i.d.
realizations of a Gaussian process. An estimate of the covariance operator <code class="reqn">K(t,t')</code> evaluated on <code>yind</code>
has to be supplied in the <code>hatSigma</code>-argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pffrGLS(
  formula,
  yind,
  hatSigma,
  algorithm = NA,
  method = "REML",
  tensortype = c("te", "t2"),
  bs.yindex = list(bs = "ps", k = 5, m = c(2, 1)),
  bs.int = list(bs = "ps", k = 20, m = c(2, 1)),
  cond.cutoff = 500,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula with special terms as for <code>gam</code>, with additional special terms <code>ff()</code> and <code>c()</code>. See <code>pffr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yind</code></td>
<td>
<p>a vector with length equal to the number of columns of the matrix of functional responses giving the vector of evaluation points <code class="reqn">(t_1, \dots ,t_{G})</code>.
see <code>pffr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hatSigma</code></td>
<td>
<p>(an estimate of) the within-observation covariance (along the responses' index), evaluated at <code>yind</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>the name of the function used to estimate the model. Defaults to <code>gam</code> if the matrix of functional responses has less than <code>2e5</code> data points
and to <code>bam</code> if not. "gamm" (see <code>gamm</code>) and "gamm4" (see <code>gamm4</code>) are valid options as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>See <code>pffr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tensortype</code></td>
<td>
<p>See <code>pffr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs.yindex</code></td>
<td>
<p>See <code>pffr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs.int</code></td>
<td>
<p>See <code>pffr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond.cutoff</code></td>
<td>
<p>if the condition number of <code>hatSigma</code> is greater than this,  <code>hatSigma</code> is
made “more” positive-definite via <code>nearPD</code> to ensure a condition number equal to cond.cutoff. Defaults to 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments that are valid for <code>gam</code> or <code>bam</code>. See <code>pffr</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a fitted <code>pffr</code>-object, see <code>pffr</code>.
</p>


<h3>Details</h3>

<p>Note that <code>hatSigma</code> has to be positive definite. If <code>hatSigma</code> is close to positive <em>semi-</em>definite or badly conditioned,
estimated standard errors become unstable (typically much too small). <code>pffrGLS</code> will try to diagnose this and issue a warning.
The danger is especially big if the number of functional observations is smaller than the number of gridpoints
(i.e, <code>length(yind)</code>), since the raw covariance estimate will not have full rank.<br>
Please see <code>pffr</code> for details on model specification and
implementation. <br> THIS IS AN EXPERIMENTAL VERSION AND NOT WELL TESTED YET – USE AT YOUR OWN RISK.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>See Also</h3>

<p><code>pffr</code>, <code>fpca.sc</code>
</p>


</div>