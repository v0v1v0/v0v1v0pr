<div class="container">

<table style="width: 100%;"><tr>
<td>capture</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Capture-recapture Models</h2>

<h3>Description</h3>

<p><code>capture</code> fits the Cormack capture-recapture model to <code>n</code> sample
periods. Set <code>n</code> to the appropriate value and type <code>eval(setup)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">capture(z, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A Poisson generalized linear model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of repeated observations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>n &lt;- periods</code> # number of periods
</p>
<p><code>eval(setup)</code>
</p>
<p>This produces the following variables -
</p>
<p><code>p[i]</code>: logit capture probabilities,
</p>
<p><code>pbd</code>: constant capture probability,
</p>
<p><code>d[i]</code>: death parameters,
</p>
<p><code>b[i]</code>: birth parameters,
</p>
<p><code>pw</code>: prior weights.
</p>
<p>Then set up a Poisson model for log linear models:
</p>
<p><code>z &lt;- glm(y~model, family=poisson, weights=pw)</code>
</p>
<p>and call the function, <code>capture</code>.
</p>
<p>If there is constant effort, then all estimates are correct. Otherwise,
<code>n[1]</code>, <code>p[1]</code>, <code>b[1]</code>, are correct only if there is no
birth in period 1.  <code>n[s]</code>, <code>p[s]</code>, are correct only if there is
no death in the last period.  <code>phi[s-1]</code> is correct only if effort is
constant in <code>(s-1, s)</code>.  <code>b[s-1]</code> is correct only if <code>n[s]</code>
and <code>phi[s-1]</code> both are.
</p>


<h3>Value</h3>

<p><code>capture</code> returns a matrix containing the estimates.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>Examples</h3>

<pre><code class="language-R">
y &lt;- c(0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,14,1,1,0,2,1,2,1,16,0,2,0,11,
	2,13,10,0)
n &lt;- 5
eval(setup)
# closed population
print(z0 &lt;- glm(y~p1+p2+p3+p4+p5, family=poisson, weights=pw))
# deaths and emigration only
print(z1 &lt;- update(z0, .~.+d1+d2+d3))
# immigration only
print(z2 &lt;- update(z1, .~.-d1-d2-d3+b2+b3+b4))
# deaths, emigration, and immigration
print(z3 &lt;- update(z2, .~.+d1+d2+d3))
# add trap dependence
print(z4 &lt;- update(z3, .~.+i2+i3))
# constant capture probability over the three middle periods
print(z5 &lt;- glm(y~p1+pbd+p5+d1+d2+d3+b2+b3+b4, family=poisson, weights=pw))
# print out estimates
capture(z5, n)

</code></pre>


</div>