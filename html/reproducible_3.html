<div class="container">

<table style="width: 100%;"><tr>
<td>.sortDotsUnderscoreFirst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exported generics and methods</h2>

<h3>Description</h3>

<p>There are a number of generics that are exported for other packages to use.
These are listed below. They are not intended for use by normal users; rather,
they are made available for package developers to build specific methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.sortDotsUnderscoreFirst(obj)

.orderDotsUnderscoreFirst(obj)

.tagsByClass(object)

## S4 method for signature 'ANY'
.tagsByClass(object)

.cacheMessage(
  object,
  functionName,
  fromMemoise = getOption("reproducible.useMemoise", TRUE),
  verbose = getOption("reproducible.verbose", 1)
)

## S4 method for signature 'ANY'
.cacheMessage(
  object,
  functionName,
  fromMemoise = getOption("reproducible.useMemoise", TRUE),
  verbose = getOption("reproducible.verbose", 1)
)

.cacheMessageObjectToRetrieve(
  functionName,
  fullCacheTableForObj,
  cachePath,
  cacheId,
  verbose
)

.addTagsToOutput(object, outputObjects, FUN, preDigestByClass)

## S4 method for signature 'ANY'
.addTagsToOutput(object, outputObjects, FUN, preDigestByClass)

.preDigestByClass(object)

## S4 method for signature 'ANY'
.preDigestByClass(object)

.checkCacheRepo(
  object,
  create = FALSE,
  verbose = getOption("reproducible.verbose", 1)
)

## S4 method for signature 'ANY'
.checkCacheRepo(
  object,
  create = FALSE,
  verbose = getOption("reproducible.verbose", 1)
)

.prepareOutput(object, cachePath, ...)

## S4 method for signature 'ANY'
.prepareOutput(object, cachePath, ...)

.addChangedAttr(object, preDigest, origArguments, ...)

## S4 method for signature 'ANY'
.addChangedAttr(object, preDigest, origArguments, ...)

updateFilenameSlots(obj, curFilenames, newFilenames, isStack = NULL)

## Default S3 method:
updateFilenameSlots(obj, curFilenames, newFilenames, isStack = NULL, ...)

## S3 method for class 'list'
updateFilenameSlots(obj, ...)

## S3 method for class 'environment'
updateFilenameSlots(obj, ...)

makeMemoisable(x)

## Default S3 method:
makeMemoisable(x)

## S3 method for class 'data.table'
makeMemoisable(x)

unmakeMemoisable(x)

## Default S3 method:
unmakeMemoisable(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>An object. This function only has useful methods for <code style="white-space: pre;">⁠Raster*⁠</code>,
with all other classes being simply a pass-through</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Any R object returned from a function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functionName</code></td>
<td>
<p>A character string indicating the function name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fromMemoise</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the message will be about
recovery from memoised copy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Numeric, -1 silent (where possible), 0 being very quiet,
1 showing more messaging, 2 being more messaging, etc.
Default is 1. Above 3 will output much more information about the internals of
Caching, which may help diagnose Caching challenges. Can set globally with an
option, e.g., <code style="white-space: pre;">⁠options('reproducible.verbose' = 0) to reduce to minimal⁠</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullCacheTableForObj</code></td>
<td>
<p>The data.table entry from the Cache database for only
this <code>cacheId</code>, e.g., via <code>showCache()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cachePath</code></td>
<td>
<p>A repository used for storing cached objects.
This is optional if <code>Cache</code> is used inside a SpaDES module.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cacheId</code></td>
<td>
<p>Character string. If passed, this will override the calculated hash
of the inputs, and return the result from this cacheId in the <code>cachePath</code>.
Setting this is equivalent to manually saving the output of this function, i.e.,
the object will be on disk, and will be recovered in subsequent
This may help in some particularly finicky situations
where Cache is not correctly detecting unchanged inputs. This will guarantee
the object will be identical each time; this may be useful in operational code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputObjects</code></td>
<td>
<p>Optional character vector indicating which objects to
return. This is only relevant for list, environment (or similar) objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>A function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preDigestByClass</code></td>
<td>
<p>A list, usually from <code>.preDigestByClass</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>create</code></td>
<td>
<p>Logical. If TRUE, then it will create the path for cache.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Anything passed to methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preDigest</code></td>
<td>
<p>The full, element by element hash of the input arguments to that same function,
e.g., from <code>.robustDigest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origArguments</code></td>
<td>
<p>These are the actual arguments (i.e., the values, not the names) that
were the source for <code>preDigest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curFilenames</code></td>
<td>
<p>An optional character vector of filenames currently existing
and that are pointed to in the obj. If omitted, will take from the <code>obj</code>
using <code>Filenames(obj)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newFilenames</code></td>
<td>
<p>An optional character vector of filenames to use instead of
the curFilenames. This can also be a single directory, in which case the
renaming will be given:
<code>file.path(newFilenames, basename(Filenames(obj, allowMultiple = FALSE)))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object to make memoisable.
See individual methods in other packages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>.sortDotsUnderscoreFirst</code>: This exists so Windows, Linux, and Mac machines can have
the same order after a sort. It will put dots and underscores first
(with the sort key based on their second character, see examples.
It also sorts lower case before upper case.
</p>
<p>The methods should do as described below.
</p>
<p><code>.tagsByClass</code> should return a character vector, with a single colon (":") dividing
two parts: the tag type and tag value, for the specific class.
</p>
<p><code>.cacheMessage</code> should make a call to <code>message</code> that gives information about
the loaded cached object being returned.
</p>
<p><code>.objecxtToRetrieveMessage</code> is the messaging for recovering an object from Cache.
</p>
<p><code>.addTagsToOutput</code> should add one or more attributes to an object, named either
<code>"tags"</code>, <code>"call"</code> or <code>"function"</code>. It may be wise to do a "deep" copy within this
method, but it may not be necessary.
</p>
<p><code>.addChangedAttr</code> should return the same object, with this a very specific
attribute added: it must be named ".Cache", and have a sub-list element named
"changed", which must be a logical, <code>TRUE</code> or <code>FALSE</code>, to describe whether the object
has changed or not since last attempt to cache it. This is mostly useful when there
are only one or a few sub-elements of e.g., a large list, that are changed. <code>Cache</code>
will be able to only recover the changed parts, to reduce time required to
complete a call to <code>Cache</code>.
</p>
<p><code>updateFilenameSlots</code>: this exists because when copying file-backed rasters, the
usual mechanism of <code>writeRaster</code> can be very slow. This function allows
for a user to optionally create a hard link to the old file, give it a new
name, then update the filename slot(s) in the <code style="white-space: pre;">⁠Raster*⁠</code> class object. This
can be 100s of times faster for large rasters.
</p>
<p><code>makeMemoiseable</code> and <code>unmakeMemoisable</code> methods are run during <code>Cache</code>. The
methods should address any parts that will not successfully work for memoising,
most notably, <code>data.table</code> or other pass-by-reference objects likely need to
be deep copied, so that the memoised version doesn't get changed after being
stashed in the RAM cache (i.e., memoised)
</p>
<p><code>makeMemoiseable</code> and <code>unmakeMemoisable</code> are, by default, just a pass through
for most class. <code>reproducible</code> only has a method for <code>data.table</code> class objects.
</p>


<h3>Value</h3>

<p><code>.sortDotsUnderscoreFirst</code>: the same object as <code>obj</code>,
but sorted with dots and underscores first,
lower case before upper case.
</p>
<p><code>.tagsByClass</code> default method returns <code>NULL</code>.
</p>
<p><code>.cacheMessage</code>: nothing; called for its messaging side effect, which,
by default, just edits the name of the function into a generic "loaded cached result"
message.
</p>
<p><code>.addTagsToOutput</code>: The inputted object but with tags attached.
</p>
<p><code>.preDigestByClass</code>: A list with elements that have a difficult time
being digested correctly, e.g., an S4 object with some elements removed and
handled for digesting purposes. The default method for <code>preDigestByClass</code> and
simply returns <code>NULL</code>.
</p>
<p><code>.checkCacheRepo</code>: A character string with a path to a cache repository.
</p>
<p><code>.prepareOutput</code>: The object, modified
</p>
<p><code>.addChangedAttr</code>: the object, with an attribute ".Cache" and sub-element, "changed",
added set to either <code>TRUE</code> or <code>FALSE</code>
</p>
<p><code>updateFilenameSlots</code>: The original object, but with its internal file pointer
updated to the <code>newFilenames</code>
</p>
<p>The same object, but with any modifications, especially
dealing with saving of environments, which memoising doesn't handle
correctly in some cases.
</p>


<h3>Author(s)</h3>

<p>Eliot McIntire
</p>


<h3>Examples</h3>

<pre><code class="language-R">items &lt;- c(A = "a", Z = "z", `.D` = ".d", `_C` = "_C")
.sortDotsUnderscoreFirst(items)

# dots &amp; underscore (using 2nd character), then all lower then all upper
items &lt;- c(B = "Upper", b = "lower", A = "a", `.D` = ".d", `_C` = "_C")
.sortDotsUnderscoreFirst(items)

# with a vector
.sortDotsUnderscoreFirst(c(".C", "_B", "A")) # _B is first

.tagsByClass(character())

a &lt;- 1
.cacheMessage(a, "mean")

a &lt;- 1
.preDigestByClass(a) # returns NULL in the simple case here.

a &lt;- normalizePath(file.path(tempdir(), "test"), mustWork = FALSE)
.checkCacheRepo(a, create = TRUE)

a &lt;- 1
.prepareOutput(a) # does nothing

b &lt;- "NULL"
.prepareOutput(b) # converts to NULL

if (requireNamespace("terra", quietly = TRUE)) {
  r &lt;- terra::rast(terra::ext(0, 10, 0, 10), vals = 1:100)

  # write to disk manually -- will be in tempdir()
  r &lt;- terra::writeRaster(r, filename = tempfile(fileext = ".tif"))

  # copy it to the cache repository
  r &lt;- .prepareOutput(r, tempdir())
}
a &lt;- 1
.addChangedAttr(a) # does nothing because default method is just a pass through
</code></pre>


</div>