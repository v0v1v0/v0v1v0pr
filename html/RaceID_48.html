<div class="container">

<table style="width: 100%;"><tr>
<td>inspectKNN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for inspecting pruned k-nearest neighbourhoods</h2>

<h3>Description</h3>

<p>This function allows inspection of the local background model and the pruning of nearest neighbours for a given cell. A dimensional reduction representation is plotted where k nearest neighours and outliers are highlighted. Alternatively, the dependence of the transcript count variance or, alternatively, the coefficient of variation (CV) on the mean in log2 space is plotted. The  mean-variance dependence is plotted along with a loess-regression, a second order polynomial fit, and the background model of the local variability. The CV plot also highlights the local variability associated with cell-to-cell variability of total transcript counts, as calculated directly from the mean and variance of total transcript counts (turquoise) or from a local fit of a gamma distribution (orange).
</p>


<h3>Usage</h3>

<pre><code class="language-R">inspectKNN(
  i,
  expData,
  res,
  cl,
  object = NULL,
  nb = res$pars$nb,
  pvalue = 0.01,
  backModel = NULL,
  alpha = res$alpha[i],
  plotSymbol = FALSE,
  id = NULL,
  degree = 2,
  span = 0.75,
  cv = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>Either integer column index or column name of <code>expData</code>. Pruning is inspected for the neighbourhood of this cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expData</code></td>
<td>
<p>Matrix of gene expression values with genes as rows and cells as columns. These values have to correspond to unique molecular identifier counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>List object with k nearest neighbour information returned by <code>pruneKnn</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>List object with clustering information, returned by the <code>graphCluster</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>SCseq</code> class object. Required if <code>plotSymbol</code> is <code>TRUE</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>Input parameter of <code>pruneKnn</code>. See <code>help(pruneKnn)</code>. Default is res$pars$nb.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>Positive real number between 0 and 1. All nearest neighbours with link probability <code>&lt; pvalue</code> are pruned. Default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backModel</code></td>
<td>
<p>Optional background model. Second order polynomial fitting the mean-variance dpendence on log2 scales as returned by <code>lm</code>. Default is <code>NULL</code> and the local background model is computed as in <code>pruneKnn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Input parameter of <code>pruneKnn</code>. See <code>help(pruneKnn)</code>. Default is res$pars$alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotSymbol</code></td>
<td>
<p>Logical. If <code>TRUE</code> then a dimensional reduction representation is plotted highlighting cell <code>i</code>, all k nearest neighbours, all outliers, and the stringest outlier in different colours. Function <code>plotsymbolsmap</code> is used. Additional parameter for this function, such as <code>um=TRUE</code> can be given. Default is <code>FALSE</code>, and the local mean-variance dependence is plotted along with a second order polynomial fit and a local regression. See <code>plotMV</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Valid column name of expData. If <code>plotSymbol=TRUE</code> this corresponding cell is highlighted in the dimensional reduction representation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>Input parameter for mean-variance fit. See <code>plotMV</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>Input parameter for mean-variance fit. See <code>plotMV</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>Input parameter for mean-variance fit. See <code>plotMV</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters for <code>plotsymbolsmap</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List object with six components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pv.neighbours.cell</code></td>
<td>
<p>Vector of outlier p-values (Bonferroni-corrected) for each of the k-nearest neighbours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.neighours</code></td>
<td>
<p>Vector of cluster numbers for central cell and each of the k-nearest neighbours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p><code>alpha</code> parameter used for pruning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expr.neighbours</code></td>
<td>
<p>Matrix of normalized transcript counts for the central cell and each of the k-nearest neighbours (normalized to the minimum number of total trascript counts across all neighours). Additional columns indicate inferred local mean, standard deviation, and strongest outlier p-value. Rows are sorted by p-values of the strongest outlier cell in increasing order. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv.neighbours</code></td>
<td>
<p>Matrix of outlier p-values of all genes for the central cells and each of the k-nearest neighbours. Rows are sorted by p-values of the strongest outlier cell in increasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strongest.outlier</code></td>
<td>
<p>Column name of strongest outlier.</p>
</td>
</tr>
</table>
</div>