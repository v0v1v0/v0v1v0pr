<div class="container">

<table style="width: 100%;"><tr>
<td>calc_candidate_regions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine candidate regions of selection</h2>

<h3>Description</h3>

<p>Determine candidate regions of selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_candidate_regions(
  scan,
  threshold = NA,
  pval = FALSE,
  ignore_sign = FALSE,
  window_size = 1e+06,
  overlap = 0,
  right = TRUE,
  min_n_mrk = 1,
  min_n_extr_mrk = 1,
  min_perc_extr_mrk = 0,
  join_neighbors = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scan</code></td>
<td>
<p>a data frame containing scores (output of <code>ihh2ihs</code>, <code>ines2rsb</code> or <code>ies2xpehh</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>boundary score above which markers are defined as "extreme".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>logical. If <code>TRUE</code> use the (negative log-) p-value instead of the score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_sign</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), take absolute values of score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_size</code></td>
<td>
<p>size of sliding windows. If set to 1, no windows
are constructed and only the individual extremal markers are reported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>size of window overlap (default 0, i.e. no overlap).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p>logical, indicating if the windows should be closed on the right (and open on the left) or vice versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_n_mrk</code></td>
<td>
<p>minimum number of markers per window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_n_extr_mrk</code></td>
<td>
<p>minimum number of markers with extreme
value in a window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_perc_extr_mrk</code></td>
<td>
<p>minimum percentage of extremal markers among all markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>join_neighbors</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), merge neighboring windows with
extreme values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There is no generally agreed method how to determine genomic
regions which might have been under recent selection. Since selection tends
to yield clusters of markers with outlier values, a common approach is
to search for regions with an elevated number or fraction
of outlier or extremal markers.
This function allows to set three conditions a window must fulfill
in order to classify as candidate region:
</p>

<ul>
<li> <p><code>min_n_mrk</code> a minimum number of (any) markers.
</p>
</li>
<li> <p><code>min_n_extr_mrk</code> a minimum number of markers with outlier / extreme value.
</p>
</li>
<li> <p><code>min_perc_extr_mrk</code> a minimum percentage of extremal markers among all markers.
</p>
</li>
</ul>
<p>"Extreme" markers are defined by having a score above the specified <code>threshold</code>.
</p>


<h3>Value</h3>

<p>A data frame with chromosomal regions, i.e. windows that fulfill
the necessary conditions to qualify as candidate regions under selection.
For each region the overall number of markers, their mean and maximum,
the number of markers with extremal values, their percentage of all markers
and their average are reported.
</p>


<h3>See Also</h3>

<p><code>calc_region_stats</code>
</p>


</div>