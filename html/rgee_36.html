<div class="container">

<table style="width: 100%;"><tr>
<td>ee_image_to_gcs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates a task to export an EE Image to Google Cloud Storage.</h2>

<h3>Description</h3>

<p>Creates a task to export an EE Image to Google Cloud Storage.
This function is a wrapper around
<code>ee$batch$Export$image$toCloudStorage(...)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ee_image_to_gcs(
  image,
  description = "myExportImageTask",
  bucket = NULL,
  fileNamePrefix = NULL,
  timePrefix = TRUE,
  dimensions = NULL,
  region = NULL,
  scale = NULL,
  crs = NULL,
  crsTransform = NULL,
  maxPixels = NULL,
  shardSize = NULL,
  fileDimensions = NULL,
  skipEmptyTiles = NULL,
  fileFormat = NULL,
  formatOptions = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>image</code></td>
<td>
<p>The image to be exported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>
<p>User-friendly name of the task.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bucket</code></td>
<td>
<p>Cloud Storage bucket name for the export.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileNamePrefix</code></td>
<td>
<p>Cloud Storage object name prefix for the export.
Defaults to the name of the task.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timePrefix</code></td>
<td>
<p>Prefixes the current date and time to the exported files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimensions</code></td>
<td>
<p>Defines the image dimensions for export.
It can be specified as a single positive integer for the maximum dimension
or in "WIDTHxHEIGHT" format, where WIDTH and HEIGHT are positive integers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region</code></td>
<td>
<p>The lon,lat coordinates for a LinearRing or Polygon
specifying the region to export. It can be specified as nested lists
of numbers or a serialized string. Defaults to the image's region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Image resolution in meters per pixel. Defaults to the native
resolution of the image asset unless a crsTransform is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>The coordinate reference system of the exported image's
projection. Defaults to the image's default projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crsTransform</code></td>
<td>
<p>A comma-separated string of 6 numbers describing
the affine transform of the coordinate reference system of the exported
image's projection, in the order:
xScale, xShearing, xTranslation, yShearing, yScale, and yTranslation.
Defaults to the image's native CRS transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxPixels</code></td>
<td>
<p>Maximum number of pixels allowed in the exported image.
The task will fail if the exported region exceeds this limit in the specified projection.
Defaults to 100,000,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shardSize</code></td>
<td>
<p>Size given in pixels of the shards in which the image
will be computed. Defaults to 256.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileDimensions</code></td>
<td>
<p>Defines the pixel dimensions for each image file when the image size exceeds
the capacity of a single file.To indicate a square shape, use a single number;
for width and height, use a list of two dimensions.
Please note that the image will be clipped to the overall image dimensions.
The specified file dimensions must be a multiple of the shardSize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skipEmptyTiles</code></td>
<td>
<p>If TRUE, skip writing empty (i.e., fully-masked)
image tiles. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileFormat</code></td>
<td>
<p>The string file format to which the image is exported.
Currently only 'GeoTIFF' and 'TFRecord' are supported, defaults
to 'GeoTIFF'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formatOptions</code></td>
<td>
<p>A dictionary of string keys to format-specific
options. **kwargs: Holds other keyword arguments that may have been
deprecated, such as 'crs_transform'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An unstarted Task that exports the image to Google Cloud Storage.
</p>


<h3>See Also</h3>

<p>Other image export task creator: 
<code>ee_image_to_asset()</code>,
<code>ee_image_to_drive()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(rgee)
library(stars)
library(sf)

ee_users()
ee_Initialize(gcs = TRUE)

# Define study area (local -&gt; earth engine)
# Communal Reserve Amarakaeri - Peru
rlist &lt;- list(xmin = -71.13, xmax = -70.95,ymin = -12.89, ymax = -12.73)
ROI &lt;- c(rlist$xmin, rlist$ymin,
         rlist$xmax, rlist$ymin,
         rlist$xmax, rlist$ymax,
         rlist$xmin, rlist$ymax,
         rlist$xmin, rlist$ymin)
ee_ROI &lt;- matrix(ROI, ncol = 2, byrow = TRUE) %&gt;%
  list() %&gt;%
  st_polygon() %&gt;%
  st_sfc() %&gt;%
  st_set_crs(4326) %&gt;%
  sf_as_ee()


# Get the mean annual NDVI for 2011
cloudMaskL457 &lt;- function(image) {
  qa &lt;- image$select("pixel_qa")
  cloud &lt;- qa$bitwiseAnd(32L)$
    And(qa$bitwiseAnd(128L))$
    Or(qa$bitwiseAnd(8L))
  mask2 &lt;- image$mask()$reduce(ee$Reducer$min())
  image &lt;- image$updateMask(cloud$Not())$updateMask(mask2)
  image$normalizedDifference(list("B4", "B3"))
}

ic_l5 &lt;- ee$ImageCollection("LANDSAT/LT05/C01/T1_SR")$
  filterBounds(ee$FeatureCollection(ee_ROI))$
  filterDate("2011-01-01", "2011-12-31")$
  map(cloudMaskL457)

# Create simple composite
mean_l5 &lt;- ic_l5$mean()$rename("NDVI")
mean_l5 &lt;- mean_l5$reproject(crs = "EPSG:4326", scale = 500)
mean_l5_Amarakaeri &lt;- mean_l5$clip(ee_ROI)

# Move results from Earth Engine to GCS
task_img &lt;- ee_image_to_gcs(
 image = mean_l5_Amarakaeri,
 bucket = "rgee_dev",
 fileFormat = "GEO_TIFF",
 region = ee_ROI,
 fileNamePrefix = "my_image_demo"
)

task_img$start()
ee_monitoring(task_img)

# Move results from GCS to local
ee_gcs_to_local(task = task_img)


## End(Not run)
</code></pre>


</div>