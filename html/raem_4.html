<div class="container">

<table style="width: 100%;"><tr>
<td>capzone</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the capture zone of a well element</h2>

<h3>Description</h3>

<p><code>capzone()</code> determines the capture zone of a well element in the flow field by performing backward
particle tracking until the requested time is reached.
</p>


<h3>Usage</h3>

<pre><code class="language-R">capzone(aem, well, time, npar = 15, dt = time/10, zstart = aem$base, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>aem</code></td>
<td>
<p><code>aem</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>well</code></td>
<td>
<p>analytic element of class <code>well</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>numeric, time of the capture zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>integer, number of particles to use in the backward tracking. Defaults to 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>numeric, time step length used in the particle tracking. Defaults <code>time / 10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zstart</code></td>
<td>
<p>numeric value with the starting elevation of the particles. Defaults to the base of the aquifer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>tracelines()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>capzone()</code> is a thin wrapper around <code>tracelines()</code>. Backward particle tracking is performed using <code>tracelines()</code>
and setting <code>forward = FALSE</code>. Initial particle locations are computed by equally spacing <code>npar</code> locations at the well
radius at the <code>zstart</code> elevation. To obtain a sharper delineation of the capture zone envelope, try using more particles
or decreasing <code>dt</code>.
</p>
<p>Note that different <code>zstart</code> values only have an effect in models with vertical flow components.
</p>


<h3>Value</h3>

<p><code>capzone()</code> returns an object of class <code>tracelines</code>.
</p>


<h3>See Also</h3>

<p><code>tracelines()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A model with vertical flow components
k &lt;- 10
top &lt;- 10; base &lt;- 0
n &lt;- 0.3

uf &lt;- uniformflow(TR = 100, gradient = 0.001, angle = -10)
rf &lt;- constant(TR, xc = -1000, yc = 0, hc = 20)
w1 &lt;- well(200, 50, Q = 250)
w2 &lt;- well(-200, -100, Q = 450)
as &lt;- areasink(0, 0, N = 0.001, R = 1500)

m &lt;- aem(k, top, base, n = n, uf, rf, w1, w2, as)

# 5-year capture zone at two different starting levels
# here, the number of particles are set to small values to speed up the examples
# increase the number of particles to obtain a sharper delineation of the envelope
cp5a &lt;- capzone(m, w1, time = 5 * 365, zstart = base, npar = 6, dt = 365 / 4)
cp5b &lt;- capzone(m, w1, time = 5 * 365, zstart = 8, npar = 6, dt = 365 / 4)

xg &lt;- seq(-800, 800, length = 100)
yg &lt;- seq(-500, 500, length = 100)
contours(m, xg, yg, col = 'dodgerblue', nlevels = 20)
plot(cp5a, add = TRUE)
plot(cp5b, add = TRUE, col = 'forestgreen') # smaller zone

# plot the convex hull of the endpoints as a polygon
endp &lt;- endpoints(cp5b)
hull &lt;- chull(endp[, c('x', 'y')])
polygon(endp[hull, c('x', 'y')], col = adjustcolor('forestgreen', alpha.f = 0.7))

</code></pre>


</div>