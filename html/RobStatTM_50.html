<div class="container">

<table style="width: 100%;"><tr>
<td>refine.sm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>IRWLS iterations for S- or M-estimators</h2>

<h3>Description</h3>

<p>This function performs iterative improvements for S- or
M-estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">refine.sm(
  x,
  y,
  initial.beta,
  initial.scale,
  k = 50,
  conv = 1,
  b,
  cc,
  family,
  step = "M",
  tol
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.beta</code></td>
<td>
<p>vector of initial regression estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.scale</code></td>
<td>
<p>initial residual scale estimate. If missing the (scaled) median of
the absolute residuals is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>maximum number of refining steps to be performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>an integer indicating whether to check for convergence (1) at each step,
or to force running k steps (0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>tuning constant for the M-scale estimator, used if iterations are for an S-estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p>tuning constant for the rho function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>string specifying the name of the family of loss function to be used (current
valid options are "bisquare", "opt" and "mopt")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>a string indicating whether the iterations are to compute an S-estimator
('S') or an M-estimator ('M')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance to detect convergence (relative difference of consecutive vectors of parameters)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs iterative improvements for S- or
M-estimators. Both iterations are formally the same, the
only difference is that for M-iterations the residual
scale estimate remains fixed, while for S-iterations
it is updated at each step. In this case, we follow
the Fast-S algorithm of Salibian-Barrera and Yohai
an use one step updates for the M-scale, as opposed
to a full computation. This as internal function.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta.rw</code></td>
<td>
<p>The updated vector of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.rw</code></td>
<td>
<p>The corresponding estimated residual scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>A logical value indicating whether the algorithm
converged</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matias Salibian-Barrera, <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a>.
</p>


</div>