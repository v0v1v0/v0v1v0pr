<div class="container">

<table style="width: 100%;"><tr>
<td>getMAPS_ClaDS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Gets the Maximum A Posteriori for each ClaDS parameter
</h2>

<h3>Description</h3>

<p>Extract the MAPs (Maximum A Posteriori) for the marginal posterior distributions estimated with fit_ClaDS
</p>


<h3>Usage</h3>

<pre><code class="language-R">getMAPS_ClaDS(sampler, burn = 1/2, thin = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sampler</code></td>
<td>

<p>The output of a fit_ClaDS run.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>

<p>Number of iterations to drop in the beginning of the chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>

<p>Thinning parameter, one iteration out of "thin" is kept to compute the MAPs.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector MAPS containing the MAPs for the marginal posterior distribution for each of the model's parameters.
</p>
<p>MAPS[1:4] are the estimated hyperparameters, with MAPS[1] the sigma parameter (new rates stochasticity), MAPS[2] the alpha parameter (new rates trend),  MAPS[3] the turnover rate epsilon, and MAPS[4] the initial speciation rate lambda_0. 
</p>
<p>MAPS[-(1:4)] are the estimated branch-specific speciation rates, given in the same order as the edges of the phylogeny on which the inference was performed.
</p>


<h3>Author(s)</h3>

<p>O. Maliet
</p>


<h3>References</h3>

<p>Maliet O., Hartig F. and Morlon H. 2019, A model with many small shifts for estimating species-specific diversificaton rates, <em>Nature Ecology and Evolution</em>, doi 10.1038/s41559-019-0908-0
</p>


<h3>See Also</h3>

<p><code>fit_ClaDS</code>, <code>plot_ClaDS_chains</code>, <code>getMAPS_ClaDS0</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("Caprimulgidae_ClaDS2")


if(test){
MAPS = getMAPS_ClaDS(Caprimulgidae_ClaDS2$sampler, thin = 1)

print(paste0("sigma = ", MAPS[1], " ; alpha = ", 
  MAPS[2], " ; epsilon = ", MAPS[3], " ; l_0 = ", MAPS[4] ))
plot_ClaDS_phylo(Caprimulgidae_ClaDS2$tree, MAPS[-(1:4)])
}
</code></pre>


</div>