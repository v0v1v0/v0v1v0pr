<div class="container">

<table style="width: 100%;"><tr>
<td>uvector</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML estimation vector for reducible SDEs</h2>

<h3>Description</h3>

<p>These functions are not normally called directly by the user.
Function <code>uvector()</code> is used by <code>sdefit()</code>. Function
<code>uvector_noh()</code> is a more limited version, maintained for documentation
purposes. Function <code>logdet_and_v()</code> is used by <code>uvector()</code> and
<code>uvector_noh()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">uvector(x, t, unit = NULL, beta0, beta1, eta, eta0, x0, t0, lambda,
  mum = 1, mu0 = 1, mup = 1, sorted = FALSE, final = FALSE)

uvector_noh(x, t, beta0, beta1, eta, eta0, x0, t0, lambda, final = FALSE)

logdet.and.v(cdiag, csub = NULL, z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, t</code></td>
<td>
<p>Data vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>Unit id vector, if any.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0, beta1, eta, eta0, x0, t0</code></td>
<td>
<p>SDE parameters or re-parameterizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Named list of parameters(s) for <code>phi()</code>, possibly local
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mum, mu0, mup</code></td>
<td>
<p>Optional <code class="reqn">\sigma</code> multipliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorted</code></td>
<td>
<p>Data already ordered by increasing t?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final</code></td>
<td>
<p>Mode, see below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdiag</code></td>
<td>
<p>Vector with the diagonal elements <code class="reqn">c_{ii}</code> of
<code class="reqn">C</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>csub</code></td>
<td>
<p>Vector with sub-diagonal <code class="reqn">c_{i, i-1}</code> for <code class="reqn">i &gt;
1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A numeric vector</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>uvector()</code> and <code>uvector_noh()</code> calculate a vector of
residuals for sum of squares minimization by <code>nls()</code> or <code>nlme()</code>.
The first one works both for single-unit and for bilevel hierarchical models.
It is backward-compatible with <code>uvector_noh()</code>, which is only for
single-unit models but simpler and easier to understand. They require a
transformation function <code>phi(x, theta)</code>, and a function
<code>phiprime(x, theta)</code> for the derivative dy/dx, where <code>theta</code> is a
list containing the transformation parameters.
</p>
<p><code>logdet_and_v()</code> calculates <code class="reqn">\log[\det(L)]</code> and <code class="reqn">v
= L^{-1} z</code>, where <code class="reqn">C = LL'</code>, with <code class="reqn">L</code> lower-triangular.
</p>
<p>The three functions are essentially unchanged from Garc√≠a (2019)
&lt;<a href="https://doi.org/10.1007/s00180-018-0837-4">doi:10.1007/s00180-018-0837-4</a>&gt;, except for a somewhat safer computation
for very small <code>beta1</code>, and adding in <code>logdet_and_v()</code> a shortcut
for when <code class="reqn">L</code> is diagonal (e.g., when <code class="reqn">\sigma_m = 0</code>). The
transformation functions <code>phi</code> and <code>phiprime</code> can be passed as
globals, as in the original, or in an environment named <code>trfuns</code>.
</p>


<h3>Value</h3>

<p><code>uvector()</code> and <code>uvector_noh()</code>: If <code>final = FALSE</code>
(default), return a vector whose sum of squares should be minimized over the
parameters to obtain maximum-likelihood estimates. If <code>final = TRUE</code>,
passing the ML parameter estimates returns a list with the sigma estimates,
the maximized log-likelihood, and AIC and BIC criteria..
</p>
<p><code>logdet_and_v()</code>: List with elements <code>logdet</code> and <code>v</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>uvector()</code>: Estimation vector, general
</p>
</li>
<li> <p><code>uvector_noh()</code>: Estimation vector, non-hierarchical
</p>
</li>
<li> <p><code>logdet.and.v()</code>: Logarithm of determinant, and <code class="reqn">v</code> vector
</p>
</li>
</ul>
</div>