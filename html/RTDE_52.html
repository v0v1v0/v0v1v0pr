<div class="container">

<table style="width: 100%;"><tr>
<td>zvalueRTDE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Z-value random variable</h2>

<h3>Description</h3>

<p>Compute the Z-value variable from a bivariate dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">zvalueRTDE(obs, omega, nbpoint, output=c("orig", "relexcess"), 
    marg=c("upareto", "ufrechet", "uunif"))

## S3 method for class 'zvalueRTDE'
print(x, ...)
## S3 method for class 'zvalueRTDE'
summary(object, ...)


relexcess(x, nbpoint, ...)
## Default S3 method:
relexcess(x, nbpoint, ...)
## S3 method for class 'zvalueRTDE'
relexcess(x, nbpoint, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>bivariate numeric dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>a numeric for omega, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbpoint</code></td>
<td>
<p>a numeric for the number of largest points to be selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>a character string for the output: 
either <code>"orig"</code> for original value 
or <code>"relexcess"</code> for relative excess.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marg</code></td>
<td>
<p>a character string for the empirical margin transformation:
either <code>"upareto"</code> for unit Pareto, 
<code>"ufrechet"</code> for unit Frechet or 
<code>"uunif"</code> for unit uniform margin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object inheriting from <code>"zvalueRTDE"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to subsequent methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a bivariate dataset <code class="reqn">(X_i, Y_i)_i</code> of <code class="reqn">n</code> points,
two variables are defined:
(1) for <code>output="orig"</code>, the <code class="reqn">\tilde Z_{\omega,i}</code> variable
</p>
<p style="text-align: center;"><code class="reqn">\tilde Z_{\omega,i} = \min \left(
        f\left(\frac{R_i^X}{n+1}\right),
        \frac{\omega}{1-\omega} f\left(\frac{R_i^Y}{n+1}\right) \right)
    </code>
</p>

<p>where <code class="reqn">f(x)</code> is the margin transformation and <code class="reqn">i=1,...,n</code>;
(2) for <code>output="relexcess"</code>, the <code class="reqn">Z_{j}</code> variable
</p>
<p style="text-align: center;"><code class="reqn">
        \frac{\widetilde Z_{\omega,n-m+j,n}}{\widetilde Z_{\omega,n-m,n}}
    </code>
</p>

<p>where <code class="reqn">m</code> equals <code>nbpoint</code>, <code class="reqn">j=1,\dots, m</code>,
and <code class="reqn">\widetilde Z_{\omega,1,n},...,
     \widetilde Z_{\omega,n,n}</code> are the order statistics of 
<code class="reqn">\widetilde Z_{\omega,1},...,\widetilde Z_{\omega,n}</code>.
The margin transformation is 
</p>
<p style="text-align: center;"><code class="reqn">
    f(x) = \frac{1}{1-x}, f(x) = \frac{1}{-\log(x)}, f(x) = x,
    </code>
</p>

<p>respectively for unit Pareto (<code>marg="upareto"</code>),
unit Frechet (<code>marg="ufrechet"</code>) and unit uniform margin
(<code>marg="uunif"</code>).
</p>


<h3>Value</h3>

<p><code>zvalueRTDE</code> computes the Z-variable and
returns an object of class <code>"zvalueRTDE"</code>
having the following components <code>type</code> (either
<code>"orig"</code> or <code>"relexcess"</code>), <code>omega</code>,
<code>Ztilde</code> or <code>Z</code>, <code>n</code>, possibly <code>m</code>.
</p>
<p><code>relexcess</code> computes the relative excesses
from a Z-variable and returns an object of class <code>"zvalueRTDE"</code>
of type <code>"relexcess"</code>.
</p>


<h3>Author(s)</h3>

<p>Christophe Dutang
</p>


<h3>References</h3>

<p>C. Dutang, Y. Goegebeur, A. Guillou (2014),
<em>Robust and bias-corrected estimation of the coefficient of tail dependence</em>,
Volume 57, Insurance: Mathematics and Economics
</p>
<p>This work was supported by a research grant (VKR023480) from VILLUM FONDEN and an international project for scientific cooperation (PICS-6416).
</p>


<h3>See Also</h3>

<p>See <code>fitRTDE</code> for the fitting process and
<code>dataRTDE</code> for the data-handling process.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#####
# (1) example

omega &lt;- 1/2
m &lt;- 10
n &lt;- 100
obs &lt;- cbind(rupareto(n), rupareto(n)) + rupareto(n)

#unit Pareto transform
zvalueRTDE(obs, omega, output="orig")

relexcess(zvalueRTDE(obs, omega, output="orig"), m)
zvalueRTDE(obs, omega, nbpoint=m, output="relexcess")

		
</code></pre>


</div>