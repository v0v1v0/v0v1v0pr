<div class="container">

<table style="width: 100%;"><tr>
<td>route_wave</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Flood wave routing</h2>

<h3>Description</h3>

<p>Route a flood wave down a prismatic channel.
</p>


<h3>Usage</h3>

<pre><code class="language-R">route_wave(
  So,
  n,
  Cm,
  g,
  B,
  SS,
  initial.condition,
  boundary.condition,
  downstream.condition,
  timestep,
  spacestep,
  numnodes,
  monitor.nodes,
  monitor.times,
  engine = c("Dynamic", "Kinematic"),
  scheme = c("MacCormack", "Lax"),
  boundary.type = c("QQ", "Qy", "yQ", "yy")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>So</code></td>
<td>
<p>Channel slope [<code class="reqn">L L^{-1}</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Manning's roughness coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cm</code></td>
<td>
<p>Unit conversion coefficient for Manning's equation. For SI units, Cm = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Gravitational acceleration [<code class="reqn">L T^{-2}</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Channel bottom width [<code class="reqn">L</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SS</code></td>
<td>
<p>Channel sideslope [<code class="reqn">L L^{-1}</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.condition</code></td>
<td>
<p>The initial flow rate [<code class="reqn">L^3 T^{-1}</code>], assumed constant 
throughout the channel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary.condition</code></td>
<td>
<p>Vector specifying the upstream boundary condition 
for the full duration of the model. If <code>engine = "Kinematic"</code>, values are 
assumed to be flow [<code class="reqn">L^3 T^{-1}</code>]. If <code>engine = "Dynamic"</code>, the form of the 
boundary condition is determined by the argument <code>boundary.type</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downstream.condition</code></td>
<td>
<p>Only used if <code>engine = "Dynamic"</code>. Vector specifying 
the upstream boundary condition for the full duration of the model. Must be the same
length as <code>boundary.condition</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timestep</code></td>
<td>
<p>Temporal resolution of the model. Also the assumed time interval [<code class="reqn">T</code>] 
between elements of <code>boundary.condition</code> and <code>downstream.condition</code>. 
The user is responsible for ensuring numerical stability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacestep</code></td>
<td>
<p>the spatial resolution of the model, interpreted as the distance [<code class="reqn">L</code>]
between nodes in the model domain. The user is responsible for ensuring numerical stability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numnodes</code></td>
<td>
<p>The number of nodes used to discretize the channel. The total channel extent is
computed as <code>spacestep*(numnodes - 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor.nodes</code></td>
<td>
<p>the nodes to be monitored every time step. Specified as a vector of node 
indices, with 1 being the upstream boundary and <code>numnodes</code> being the downstream boundary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor.times</code></td>
<td>
<p>the time steps at which to monitor every node. Specified as a vector of 
indices of <code>boundary.condition</code>. Defaults to five equally-spaced time steps including 
the first and last time steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>engine</code></td>
<td>
<p>The engine to be used for routing the flood wave. 
May be either "Kinematic" or "Dynamic".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scheme</code></td>
<td>
<p>Only used if <code>engine = "Dynamic"</code>. Specifies whether to use the 
Lax Diffusive scheme or the MacCormack predictor-corrector scheme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary.type</code></td>
<td>
<p>Only used if <code>engine = "Dynamic"</code>. Specifies what boundary data
is supplied. Possible characters are If <code>boundary.type = "QQ"</code>, both <code>boundary.condition</code>
and <code>downstream.condition</code> are assumed to be flows [<code class="reqn">L^3 T^{-1}</code>]. If 
<code>boundary.type = "Qy"</code> the upstream boundary is assumed to be flow
while the downstream boundary is assumed to be depth [<code class="reqn">L</code>]. Other possibilities
are <code>"yQ"</code> and <code>"yy"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Provides implementations of a Kinematic Wave Model (KWM) and 
a Dynamic Wave Model (DWM) with the choice of two numerical schemes. The MacCormack 
scheme is a second-order accurate predictor-corrector scheme that provides efficient 
flood wave routing. The Lax diffusive scheme can be used to obtain smooth solutions for
problems with discontinuities in the boundary conditions, e.g. sudden gate closures.
The DWM implementation uses the Method of Characteristics (MOC) to compute the flow 
regime at the model boundaries, and allows the user to specify boundaries in terms of 
depths and/or flows. the KWM implementation assumes the normal depth at the upstream
boundary and is only first-order accurate.
</p>


<h3>Value</h3>

<p>data.frame with columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>Time step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>Node index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Time since start.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>Downstream distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flow</code></td>
<td>
<p>Flow rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>Flow depth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>velocity</code></td>
<td>
<p>Flow velocity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>Flow area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor.type</code></td>
<td>
<p>Row refers to a monitored node ("node") or timestep ("timestep").</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run:  
# kinematic wave routing
times = seq(0, 30000, by = 25)
floodwave = ifelse(times &gt;= 9000, 250,
  250 + (750/pi)*(1 - cos(pi*times/(60*75))))
route_wave(0.001, 0.045, 1.486, 32.2, 100, 0, initial.condition = 250, 
  boundary.condition = floodwave, timestep = 25, spacestep = 50, 
  numnodes=301, monitor.nodes = c(1, 101, 201, 301), 
  monitor.times = seq(1, length(times), by = 10), engine = "Kinematic")
# dynamic wave routing with zero-gradient downstream condition using MacCormack scheme
route_wave(0.001, 0.045, 1.486, 32.2, 100, 0, initial.condition = 250, 
  boundary.condition = floodwave, downstream.condition = rep(-1, length(times)), 
  timestep = 25, spacestep = 500, numnodes = 31, engine = "Dynamic", 
  scheme = "MacCormack", monitor.nodes = c(1, 11, 21, 31), 
  monitor.times = seq(1, length(times), by = 10))
# mixed boundary conditions (sudden gate closure) using Lax scheme
lax = route_wave(0.00008, 0.013, 1, 9.81, 6.1, 1.5, 
  initial.condition = 126, boundary.condition = rep(5.79, 2001), 
  downstream.condition = rep(0, 2001), timestep = 1, spacestep = 10, 
  numnodes = 501, monitor.nodes = c(1, 151, 251, 301, 501), 
  monitor.times = c(1, 501, 1001, 1501, 2001), 
  engine="Dynamic", scheme="Lax", boundary.type="yQ")
# extract data for a monitored point
require(dplyr)
filter(lax, monitor.type == "node", node == 151)

## End(Not run)
</code></pre>


</div>