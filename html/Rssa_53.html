<div class="container">

<table style="width: 100%;"><tr>
<td>hmatr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the heterogeneity matrix.</h2>

<h3>Description</h3>

<p>Function calculates the heterogeneity matrix for the one-dimensional series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hmatr(F, ...,
      B = N %/% 4, T = N %/% 4, L = B %/% 2,
      neig = 10)

## S3 method for class 'hmatr'
plot(x,
     col = rev(heat.colors(256)),
     main = "Heterogeneity Matrix", xlab = "", ylab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>the series to be checked for structural changes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>ssa</code> routine for
<code>hmatr</code> call or <code>image</code> for <code>plot.hmatr</code> call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>integer, length of base series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>integer, length of tested series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>integer, window length for the decomposition of the base
series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neig</code></td>
<td>
<p>integer, number of eigentriples to consider for
calculating projections</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>'hmatr' object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color palette to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>labels for 'x' and 'y' axis</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <em>heterogeneity matrix</em> (H-matrix) provides a
consistent view on the structural discrepancy between different parts of the
series. Denote by <code class="reqn">F_{i,j}</code> the subseries of F of the form: <code class="reqn">F_{i,j} =
  \left(f_{i},\dots,f_{j}\right)</code>. Fix two integers <code class="reqn">B &gt; L</code> and <code class="reqn">T \geq L</code>. Let
these integers denote the lengths of <em>base</em> and <em>test</em> subseries,
respectively. Introduce the H-matrix <code class="reqn">G_{B,T}</code> with the elements <code class="reqn">g_{ij}</code> as
follows:
</p>
<p style="text-align: center;"><code class="reqn">
    g_{ij} = g(F_{i,i+B}, F_{j,j+T}),
  </code>
</p>

<p>for <code class="reqn">i=1,\dots,N-B+1</code> and <code class="reqn">j=1,\dots,N-T+1</code>, that is we split the series
F into subseries of lengths B and T and calculate the heterogeneity index
between all possible pairs of the subseries.
</p>
<p>The heterogeneity index <code class="reqn">g(F^{(1)}, F^{(2)})</code> between the series
<code class="reqn">F^{(1)}</code> and <code class="reqn">F^{(2)}</code> can be calculated as follows: let
<code class="reqn">U_{j}^{(1)}</code>, <code class="reqn">j=1,\dots,L</code> denote the eigenvectors of the
SVD of the trajectory matrix of the series <code class="reqn">F^{(1)}</code>. Fix I to be a
subset of <code class="reqn">\left\{1,\dots,L\right\}</code> and denote <code class="reqn">\mathcal{L}^{(1)} =
  \mathrm{span}\,\left(U_{i},\, i \in I\right)</code>. Denote by
<code class="reqn">X^{(2)}_{1},\dots,X^{(2)}_{K_{2}}</code> (<code class="reqn">K_{2} = N_{2} - L + 1</code>) the
L-lagged vectors of the series <code class="reqn">F^{(2)}</code>. Now define
</p>
<p style="text-align: center;"><code class="reqn">
    g(F^{(1)},F^{(2)})
    = \frac{\sum_{j=1}^{K_{2}}{\mathrm{dist}^{2}\left(X^{(2)}_{j},
        \mathcal{L}^{(1)}\right)}}
    {\sum_{j=1}^{K_{2}}{\left\|X^{(2)}_{j}\right\|^{2}}}, </code>
</p>
<p> where
<code class="reqn">\mathrm{dist}\,(X,\mathcal{L})</code> denotes the Euclidean distance between the
vector X and the subspace <code class="reqn">\mathcal{L}</code>. One can easily see that
<code class="reqn">0 \leq g \leq 1</code>.
</p>


<h3>Value</h3>

<p>object of type 'hmatr'
</p>


<h3>References</h3>

<p>Golyandina, N., Nekrutkin, V. and Zhigljavsky, A. (2001): <em>Analysis of
Time Series Structure: SSA and related techniques.</em> Chapman and Hall/CRC. ISBN 1584881941
</p>


<h3>See Also</h3>

<p><code>ssa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate H-matrix for co2 series
h &lt;- hmatr(co2, L = 24)
# Plot the matrix
plot(h)
</code></pre>


</div>