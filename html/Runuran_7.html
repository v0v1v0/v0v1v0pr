<div class="container">

<table style="width: 100%;"><tr>
<td>dari.new</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>UNU.RAN generator based on Discrete Automatic Rejection Inversion (DARI)</h2>

<h3>Description</h3>

<p>UNU.RAN random variate generator for discrete distributions with
given probability mass function (PMF).
It is based on Discrete Automatic Rejection Inversion (‘DARI’).
</p>
<p>[Universal] – Rejection Method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dari.new(pmf, lb, ub, mode=NA, sum=1, ...)
darid.new(distr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pmf</code></td>
<td>
<p>probability mass function. (<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>lower bound of domain;
use <code>-Inf</code> if unbounded from left. (numeric, integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>upper bound of domain;
use <code>Inf</code> if unbounded from right. (numeric, integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>mode of distribution. (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum</code></td>
<td>
<p>sum over all “probabilities”. (numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(optional) arguments for <code>pmf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>distribution object. (S4 object of class <code>"unuran.discr"</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates an <code>unuran</code> object based on ‘DARI’
(Discrete Automatic Rejection Inversion). It can be used to draw
samples of a discrete random variate with given probability mass function
using <code>ur</code>.
</p>
<p>Function <code>pmf</code> must be postive but need not be normalized
(i.e., it can be any multiple of a probability mass function).
</p>
<p>The given function must be <code class="reqn">T_{-0.5}</code>-concave;
this includes all log-concave distributions.
</p>
<p>In addition the algorithm requires the location of the <code>mode</code>.
If omitted then it is computed by a slow numerical search.
</p>
<p>If the sum over all probabilities is different from 1 then a rough
estimate of this sum is required.
</p>
<p>Alternatively, one can use function <code>darid.new</code> where the object
<code>distr</code> of class <code>"unuran.discr"</code> must contain all required
information about the distribution.
</p>


<h3>Value</h3>

<p>An object of class <code>"unuran"</code>.
</p>


<h3>Author(s)</h3>

<p>Josef Leydold and Wolfgang H\"ormann
<a href="mailto:unuran@statmath.wu.ac.at">unuran@statmath.wu.ac.at</a>.
</p>


<h3>References</h3>

<p>W. H\"ormann, J. Leydold, and G. Derflinger (2004):
Automatic Nonuniform Random Variate Generation.
Springer-Verlag, Berlin Heidelberg.
See Section 10.2 (Tranformed Probability Rejection).
</p>


<h3>See Also</h3>

<p><code>ur</code>,
<code>unuran.discr</code>,
<code>unuran.new</code>,
<code>unuran</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create a sample of size 100 for a Binomial distribution
## with 1000 number if observations and probability 0.2
gen &lt;- dari.new(pmf=dbinom, lb=0, ub=1000, size=1000, prob=0.2)
x &lt;- ur(gen,100)

## Create a sample from a distribution with PMF
##  p(x) = 1/x^3, x &gt;= 1  (Zipf distribution)
zipf &lt;- function (x) { 1/x^3 }
gen &lt;- dari.new(pmf=zipf, lb=1, ub=Inf)
x &lt;- ur(gen,100)

## Alternative approach
distr &lt;- udbinom(size=100,prob=0.3)
gen &lt;- darid.new(distr)
x &lt;- ur(gen,100)

</code></pre>


</div>