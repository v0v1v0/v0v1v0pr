<div class="container">

<table style="width: 100%;"><tr>
<td>LinReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simple Linear Regression</h2>

<h3>Description</h3>

<p>A simple example based on estimating the parameters of a linear regression model
using
</p>
<p>* Data annealing sequential Monte Carlo (<code>LinReg</code>).
</p>
<p>* Likelihood annealing sequential Monte Carlo (<code>LinRegLA</code>).
</p>
<p>* Likelihood annealing sequential Monte Carlo with the temperature schedule,
number of MCMC repeats and random walk covariance matrices adapted online (<code>LinRegLA_adapt</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">LinReg(model, particles = 1000, plot = FALSE)

LinRegLA(model, particles = 1000, temperatures = seq(0, 1, 0.05)^5)

LinRegLA_adapt(model, particles = 1000, resampTol = 0.5, tempTol = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Choice of regression model (1 for density as the predictor
and 2 for adjusted density as the predictor).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>particles</code></td>
<td>
<p>An integer specifying the number of particles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A boolean variable to determine whether to plot the posterior estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temperatures</code></td>
<td>
<p>In likelihood annealing SMC the targets are defined as <code class="reqn">P(y|\theta)^{\gamma_t}P(\theta)</code>
where <code class="reqn">0=\gamma_0\le \ldots \le \gamma_T = 1</code> can be referred to
as the temperatures, <code class="reqn">P(y|\theta)</code> is the likelihood and <code class="reqn">P(\theta)</code>
is the prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resampTol</code></td>
<td>
<p>The adaptive implementation of likelihood annealing SMC allows for
the resampling tolerance to be specified. This parameter can be set to a value in
the range [0,1) corresponding to a fraction of the size of the particle set or it
may be set to an integer corresponding to an actual effective sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tempTol</code></td>
<td>
<p>A tolerance for adaptive choice of the temperature schedule such
that the conditional ESS is maintained at tempTol*particles.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Williams (1959) considers two competing linear regression models
for the maximum compression strength parallel to the grain for radiata
pine. Both models are of the form
</p>
<p><code class="reqn">y_i = \alpha + \beta (x_i - \bar{x}) + \epsilon_i</code>,
</p>
<p>where <code class="reqn">\epsilon_i ~ N(0,\sigma^2)</code> and <code class="reqn">i=1,\ldots,42</code>.
Here <code class="reqn">y</code> is the maximum compression strength in pounds per square
inch. The density (in pounds per cubic foot) of the radiata pine
is considered a useful predictor, so model 1 uses density for <code class="reqn">x</code>.
Model 2 instead considers the density adjusted for resin content, which
is associated with high density but not with strength.
</p>
<p>This example is frequently used as a test problem in model choice
(see for example Carlin and Chib (1995) and Friel and Pettitt (2008)).
We use the standard uninformative normal and inverse gamma priors for this example
along with the transformation <code class="reqn">\phi=log(\sigma^2)</code> so that all parameters
are on the real line and <code class="reqn">\theta = [\alpha,\beta,\phi]</code>.
The evidence can be computed using numerical estimation
for both of the competing models. The log evidence is -309.9 for model 1 and
-301.4 for model 2.
</p>
<p>The <code>LinReg</code> function implements a data annealing approach to this example.
</p>
<p>The <code>LinRegLA</code> function implements a likelihood annealing approach to this example.
</p>
<p>The <code>LinRegLA_adapt</code> function implements a likelihood annealing approach to this example
with adaptation of the temperature schedule, number of MCMC repeats and random walk covariance
matrices.
</p>


<h3>Value</h3>

<p>The <code>LinReg</code> function returns a <code>list</code> containing the final particle
approximation to the target (<code class="reqn">\theta</code> and the corresponding weights) as well as the logarithm
of the estimated model evidence.
</p>
<p>The <code>LinRegLA</code> function returns a <code>list</code> containing the population
of particles and their associates log likelihoods, log priors and weights at each iteration. The
effective sample size at each of the iterations and several different
estimates of the logarithm of the model evidence are also returned.
</p>
<p>The <code>LinRegLA_adapt</code> function returns a <code>list</code> containing all of the same
output as <code>LinRegLA</code>, in addition to the adaptively chosen temperature schedule
and number of MCMC repeats.
</p>


<h3>Author(s)</h3>

<p>Adam M. Johansen, Dirk Eddelbuettel and Leah F. South
</p>


<h3>References</h3>

<p>B. P. Carlin and S. Chib. Bayesian model choice via Markov chain
Monte Carlo. Journal of the Royal Statistical Society: Series B
(Statistical Methodology). 57(3):473-484, 1995.
</p>
<p>N. Friel and A. N. Pettitt. Marginal likelihood estimation via power posteriors.
Journal of the Royal Statistical Society: Series B (Statistical Methodology).
70(3):589-607, 2008.
</p>
<p>Williams, E. (1959). Regression analysis. Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R">res &lt;- LinReg(model=1, particles=1000, plot=TRUE)

res &lt;- LinRegLA(model=1, particles=1000)

res &lt;- LinRegLA_adapt(model=1, particles=1000)

</code></pre>


</div>