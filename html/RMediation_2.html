<div class="container">

<table style="width: 100%;"><tr>
<td>ci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CI for a nonlinear function of coefficients estimates</h2>

<h3>Description</h3>

<p>This function returns a (<code class="reqn">1-\alpha</code>)% confidence interval (CI) for a
well–defined nonlinear function of the coefficients in single–level and
multilevel structural equation models. The <code>ci</code> function uses the Monte
Carlo (<code>type="MC"</code>) and the asymptotic normal theory
(<code>type="asymp"</code>) with the multivariate delta standard error
(Asymptotic–Delta) method (Sobel, 1982) to compute a CI. In addition, for
each of the methods, when a user specifies <code>plot=TRUE</code> and
<code>plotCI=TRUE</code>, a plot of the sampling distribution of the quantity of
interest in the <code>quant</code> argument and an overlaid plot of the CI will be
produced. When <code>type="all"</code> and <code>plot=TRUE</code>, two overlaid plots of
the sampling distributions corresponding to each method will be produced;
when <code>plotCI=TRUE</code>, then the overlaid plots of the CIs for both methods
will be displayed as well.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ci(
  mu,
  Sigma,
  quant,
  alpha = 0.05,
  type = "MC",
  plot = FALSE,
  plotCI = FALSE,
  n.mc = 1e+06,
  H0 = FALSE,
  mu0 = NULL,
  Sigma0 = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>(1) a vector of means (e.g., coefficient estimates) for the
normal random variables. A user can assign a name to each mean value, e.g.,
<code>mu=c(b1=.1,b2=3)</code>; otherwise, the coefficient names are assigned
automatically as follows: <code>b1,b2,...</code>. Or, (2) a lavaan object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>either a covariance matrix or a vector that stacks all
the columns of the lower triangle variance–covariance matrix one
underneath the other.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>quantity of interest, which is a nonlinear/linear function of
the model parameters. Argument <code>quant</code> is a formula that
<strong>must</strong> start with the symbol "tilde" (<code>~</code>): e.g.,
<code>~b1*b2*b3*b4</code>. The names of coefficients must conform to the names
provided in the argument <code>mu</code> or to the default names, i.e.,
<code>b1,b2,...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level for the CI. The default value is .05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>method used to compute a CI. It takes on the values <code>"MC"</code>
(default) for Monte Carlo, <code>"asymp"</code> for Asymptotic–Delta, or
<code>"all"</code> that produces CIs using both methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>when <code>TRUE</code>, plot the approximate sampling distribution of
the quantity of interest using the specified method(s) in the argument
<code>type</code>. The default value is <code>FALSE</code>. When <code>type="all"</code>,
superimposed density plots generated by both methods are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotCI</code></td>
<td>
<p>when <code>TRUE</code>, overlays a CI plot with error bars on the
density plot of the sampling distribution of <code>quant</code>. When
<code>type="all"</code>, the superimposed CI plots generated by both methods are
added to the density plots. Note that to obtain a CI plot, one must also
specify <code>plot="TRUE"</code>. The default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mc</code></td>
<td>
<p>Monte Carlo sample size. The default sample size is 1e+6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0</code></td>
<td>
<p>False. If <code>TRUE</code>, it will estimate the sampling distribution
of <code class="reqn">H_{0}:f(\bm b)=0</code>. See the arguments <code>mu0</code> and <code>Sigma0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>a vector of means (e.g., coefficient estimates) for the
normal random variables that satisfy the null hypothesis <code class="reqn">H_{0}:f(\bm
  b)=0</code>. If it is not provided, smallest z value of <code>mu</code> is zet to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma0</code></td>
<td>
<p>either a covariance matrix or a vector that stacks all
the columns of the lower triangle variance–covariance matrix one
underneath the other. If it is not provided, then <code>Sigma</code> is used
instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>When <code>type</code> is <code>"MC"</code> or <code>"asymp"</code>, <code>ci</code> returns
a list that contains: </p>
<table>
<tr style="vertical-align: top;">
<td><code>(<code class="reqn">1-\alpha</code>)% CI</code></td>
<td>
<p>a vector of lower
and upper confidence limits,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimate</code></td>
<td>
<p>a point estimate of the
quantity of interest,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>standard error of the quantity of
interest,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC Error</code></td>
<td>
<p>When <code>type="MC"</code>, error of the Monte Carlo
estimate.</p>
</td>
</tr>
</table>
<p> When <code>type="all"</code>, <code>ci</code> returns a list of two
objects, each of which a list that contains the results produced by
each method as described above.
</p>


<h3>Note</h3>

<p>A shiny web application for  Monte Carlo method of this function is available at <a href="https://amplab.shinyapps.io/MEDMC/">https://amplab.shinyapps.io/MEDMC/</a>
</p>


<h3>Author(s)</h3>

<p>Davood Tofighi <a href="mailto:dtofighi@gmail.com">dtofighi@gmail.com</a>
</p>


<h3>References</h3>

<p>Tofighi, D. and MacKinnon, D. P. (2011). RMediation: An R
package for mediation analysis confidence intervals. <em>Behavior
Research Methods</em>, <b>43</b>, 692–700. <a href="https://doi.org/10.3758/s13428-011-0076-x">doi:10.3758/s13428-011-0076-x</a>
</p>


<h3>See Also</h3>

<p><code>medci</code> <code>RMediation-package</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ci(mu=c(b1=1,b2=.7,b3=.6, b4= .45), Sigma=c(.05,0,0,0,.05,0,0,.03,0,.03),
quant=~b1*b2*b3*b4, type="all", plot=TRUE, plotCI=TRUE)
#An Example of Conservative Null Sampling Distribution
ci(c(b1=.3,b2=.4,b3=.3), c(.01,0,0,.01,0,.02),
quant=~b1*b2*b3, type="mc", plot=TRUE, plotCI=TRUE, H0=TRUE, mu0=c(b1=.3,b2=.4,b3=0)  )
#An Example of Less Conservative Null Sampling Distribution
ci(c(b1=.3,b2=.4,b3=.3), c(.01,0,0,.01,0,.02),
quant=~b1*b2*b3, type="mc", plot=TRUE, plotCI=TRUE, H0=TRUE, mu0=c(b1=0,b2=.4,b3=0.1)  )
</code></pre>


</div>