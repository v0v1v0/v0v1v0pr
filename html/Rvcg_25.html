<div class="container">

<table style="width: 100%;"><tr>
<td>vcgClostOnKDtreeFromBarycenters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>search a KD-tree from Barycenters for multiple closest point searches on a mesh</h2>

<h3>Description</h3>

<p>search a KD-tree from Barycenters for multiple closest point searches on a mesh
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcgClostOnKDtreeFromBarycenters(
  x,
  query,
  k = 50,
  sign = TRUE,
  barycentric = FALSE,
  borderchk = FALSE,
  angdev = NULL,
  weightnorm = FALSE,
  facenormals = FALSE,
  threads = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class "vcgKDtreeWithBarycenters"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>query</code></td>
<td>
<p>matrix or triangular mesh containing coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer: check the kdtree for the<code>k</code> closest faces (using faces' barycenters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign</code></td>
<td>
<p>logical: if TRUE, signed distances are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barycentric</code></td>
<td>
<p>logical: if TRUE, barycentric coordinates of the hit
points are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>borderchk</code></td>
<td>
<p>logical: request checking if the hit face is at the border of the mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angdev</code></td>
<td>
<p>maximum deviation between reference and target normals. If the none of the k closest triangles match this criterion, the closest point on the closest triangle is returned but the corresponding distance in $quality is set to 1e5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightnorm</code></td>
<td>
<p>logical if angdev is set, this requests the normal of the closest points to be estimated by weighting the surrounding vertex normals. Otherwise, simply the hit face's normal is used (faster but slightly less accurate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facenormals</code></td>
<td>
<p>logical: if TRUE only the facenormal of the face the closest point has hit is returned, the weighted average of the surrounding vertex normals otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>integer: threads to use in closest point search.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>returns an object of class "mesh3d" with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>vb </code></td>
<td>
<p>4 x n matrix containing n vertices as homolougous coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normals </code></td>
<td>
<p>4 x n matrix containing vertex normals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quality </code></td>
<td>
<p>numeric vector containing distances to target.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it </code></td>
<td>
<p>3 x m integer matrix containing vertex indices forming triangular
faces.Only available, when x is a mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border </code></td>
<td>
<p>integer vector of length n: if borderchk = TRUE, for each clostest point the value will be 1 if the hit face is at the border of the target mesh and 0 otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barycoords </code></td>
<td>
<p>3 x m Matrix containing barycentric coordinates of
closest points; only available if barycentric=TRUE.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Stefan Schlager
</p>


<h3>See Also</h3>

<p><code>vcgCreateKDtreeFromBarycenters, vcgSearchKDtree,  vcgCreateKDtree</code>
</p>


</div>