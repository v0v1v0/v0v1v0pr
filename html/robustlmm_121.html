<div class="container">

<table style="width: 100%;"><tr>
<td>getME</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract or Get Generalize Components from a Fitted Mixed Effects Model</h2>

<h3>Description</h3>

<p>Extract (or “get”) “components” – in a generalized
sense – from a fitted mixed-effects model, i.e. from an object
of class <code>rlmerMod</code> or <code>merMod</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'rlmerMod'
getME(
  object,
  name = c("X", "Z", "Zt", "Ztlist", "mmList", "y", "mu", "u", "b.s", "b", "Gp", "Tp",
    "Lambda", "Lambdat", "Tlist", "A", "U_b", "Lind", "sigma", "flist", "fixef", "beta",
    "theta", "ST", "is_REML", "n_rtrms", "n_rfacs", "N", "n", "p", "q", "p_i", "l_i",
    "q_i", "k", "m_i", "m", "cnms", "devcomp", "offset", "lower", "rho_e", "rho_b",
    "rho_sigma_e", "rho_sigma_b", "M", "w_e", "w_b", "w_b_vector", "w_sigma_e",
    "w_sigma_b", "w_sigma_b_vector"),
  ...
)

theta(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted mixed-effects model of class
<code>rlmerMod</code>, i.e. typically the result of
<code>rlmer()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>a character string specifying the name of the
“component”.  Possible values are:<br></p>

<dl>
<dt>
<code>"X"</code>:</dt>
<dd>
<p>fixed-effects model matrix</p>
</dd>
<dt>
<code>"Z"</code>:</dt>
<dd>
<p>random-effects model matrix</p>
</dd>
<dt>
<code>"Zt"</code>:</dt>
<dd>
<p>transpose of random-effects model matrix</p>
</dd>
<dt>
<code>"Ztlist"</code>:</dt>
<dd>
<p>list of components of the transpose of the random-effects model matrix,
separated by individual variance component</p>
</dd>
<dt>
<code>"mmList"</code>:</dt>
<dd>
<p>list of raw model matrices associated with random effects terms</p>
</dd>
<dt>
<code>"y"</code>:</dt>
<dd>
<p>response vector</p>
</dd>
<dt>
<code>"mu"</code>:</dt>
<dd>
<p>conditional mean of the response</p>
</dd>
<dt>
<code>"u"</code>:</dt>
<dd>
<p>conditional mode of the “spherical” random effects variable</p>
</dd>
<dt>
<code>"b.s"</code>:</dt>
<dd>
<p>synonym for “u”</p>
</dd>
<dt>
<code>"b"</code>:</dt>
<dd>
<p>conditional mode of the random effects variable</p>
</dd>
<dt>
<code>"Gp"</code>:</dt>
<dd>
<p>groups pointer vector.  A pointer to the beginning of each group
of random effects corresponding to the random-effects terms.</p>
</dd>
<dt>
<code>"Tp"</code>:</dt>
<dd>
<p>theta pointer vector.  A pointer to the beginning
of the theta sub-vectors corresponding to the
random-effects terms, beginning with 0 and including
a final element giving the total number of random effects</p>
</dd>
<dt>
<code>"Lambda"</code>:</dt>
<dd>
<p>relative covariance factor of the random effects.</p>
</dd>
<dt>
<code>"U_b"</code>:</dt>
<dd>
<p>synonym for “Lambda”</p>
</dd>
<dt>
<code>"Lambdat"</code>:</dt>
<dd>
<p>transpose of the relative covariance factor of the random effects.</p>
</dd>
<dt>
<code>"Lind"</code>:</dt>
<dd>
<p>index vector for inserting elements of <code class="reqn">\theta</code> into the
nonzeros of <code class="reqn">\Lambda</code></p>
</dd>
<dt>
<code>"A"</code>:</dt>
<dd>
<p>Scaled sparse model matrix (class
<code>dgCMatrix</code>) for
the unit, orthogonal random effects, <code class="reqn">U</code>,
equal to <code>getME(.,"Zt") %*% getME(.,"Lambdat")</code></p>
</dd>
<dt>
<code>"sigma"</code>:</dt>
<dd>
<p>residual standard error</p>
</dd>
<dt>
<code>"flist"</code>:</dt>
<dd>
<p>a list of the grouping variables (factors) involved in the random effect terms</p>
</dd>
<dt>
<code>"fixef"</code>:</dt>
<dd>
<p>fixed-effects parameter estimates</p>
</dd>
<dt>
<code>"beta"</code>:</dt>
<dd>
<p>fixed-effects parameter estimates (identical to the result of <code>fixef</code>, but without names)</p>
</dd>
<dt>
<code>"theta"</code>:</dt>
<dd>
<p>random-effects parameter estimates: these are parameterized as the relative Cholesky factors of each random effect term</p>
</dd>
<dt>
<code>"ST"</code>:</dt>
<dd>
<p>A list of S and T factors in the TSST' Cholesky
factorization of the relative variance matrices of the random
effects associated with each random-effects term.  The unit lower
triangular matrix, <code class="reqn">T</code>, and the diagonal matrix, <code class="reqn">S</code>, for
each term are stored as a single matrix with diagonal elements
from <code class="reqn">S</code> and off-diagonal elements from <code class="reqn">T</code>.</p>
</dd>
<dt>
<code>"is_REML"</code>:</dt>
<dd>
<p>returns <code>TRUE</code> for rlmerMod-objects (for compatibility with lme4)</p>
</dd>
<dt>
<code>"n_rtrms"</code>:</dt>
<dd>
<p>number of random-effects terms</p>
</dd>
<dt>
<code>"n_rfacs"</code>:</dt>
<dd>
<p>number of distinct random-effects grouping factors</p>
</dd>
<dt>
<code>"N"</code>:</dt>
<dd>
<p>number of rows of <code>X</code></p>
</dd>
<dt>
<code>"n"</code>:</dt>
<dd>
<p>length of the response vector, <code>y</code></p>
</dd>
<dt>
<code>"p"</code>:</dt>
<dd>
<p>number of columns of the fixed effects model matrix, <code>X</code></p>
</dd>
<dt>
<code>"q"</code>:</dt>
<dd>
<p>number of columns of the random effects model matrix, <code>Z</code></p>
</dd>
<dt>
<code>"p_i"</code>:</dt>
<dd>
<p>numbers of columns of the raw model matrices, <code>mmList</code></p>
</dd>
<dt>
<code>"l_i"</code>:</dt>
<dd>
<p>numbers of levels of the grouping factors</p>
</dd>
<dt>
<code>"q_i"</code>:</dt>
<dd>
<p>numbers of columns of the term-wise model matrices, <code>ZtList</code></p>
</dd>
<dt>
<code>"k"</code>:</dt>
<dd>
<p>number of random effects terms</p>
</dd>
<dt>
<code>"m_i"</code>:</dt>
<dd>
<p>numbers of covariance parameters in each term</p>
</dd>
<dt>
<code>"m"</code>:</dt>
<dd>
<p>total number of covariance parameters, i.e., the
same as <code>dim@nth</code> below.</p>
</dd>
<dt>
<code>"cnms"</code>:</dt>
<dd>
<p>the “component names”, a ‘list’.</p>
</dd>
<dt>
<code>"devcomp"</code>:</dt>
<dd>
<p>a list consisting of a named numeric vector,
<code>cmp</code>, and a named integer vector, <code>dims</code>, describing
the fitted model.  The elements of <code>cmp</code> are:<br></p>

<dl>
<dt>ldL2</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>ldRX2</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>wrss</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>ussq</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>pwrss</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>drsum</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>REML</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>dev</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>sigmaML</dt>
<dd>
<p>always NA, for consistency with lme4 output</p>
</dd>
<dt>sigmaREML</dt>
<dd>
<p>REML estimate of residual standard deviation</p>
</dd>
</dl>
<p> The elements of <code>dims</code> are:<br></p>

<dl>
<dt>N</dt>
<dd>
<p>number of rows of <code>X</code></p>
</dd>
<dt>n</dt>
<dd>
<p>length of <code>y</code></p>
</dd>
<dt>p</dt>
<dd>
<p>number of columns of <code>X</code></p>
</dd>
<dt>nmp</dt>
<dd>
<p><code>n-p</code></p>
</dd>
<dt>nth</dt>
<dd>
<p>length of <code>theta</code></p>
</dd>
<dt>q</dt>
<dd>
<p>number of columns of <code>Z</code></p>
</dd>
<dt>nAGQ</dt>
<dd>
<p>see <code>glmer</code></p>
</dd>
<dt>compDev</dt>
<dd>
<p>see <code>glmerControl</code></p>
</dd>
<dt>useSc</dt>
<dd>
<p><code>TRUE</code> if model has a scale parameter</p>
</dd>
<dt>reTrms</dt>
<dd>
<p>number of random effects terms</p>
</dd>
<dt>REML</dt>
<dd>
<p><code>0</code> indicates the model was fitted by maximum
likelihood, any other positive integer indicates fitting by
restricted maximum likelihood</p>
</dd>
<dt>GLMM</dt>
<dd>
<p><code>TRUE</code> if a GLMM</p>
</dd>
<dt>NLMM</dt>
<dd>
<p><code>TRUE</code> if an NLMM</p>
</dd>
</dl>
</dd>
<dt>
<code>"offset"</code>:</dt>
<dd>
<p>model offset</p>
</dd>
<dt>
<code>"lower"</code>:</dt>
<dd>
<p>lower bounds on random-effects model
parameters (i.e, "theta" parameters). In order to constrain
random effects covariance matrices to be semi-positive-definite,
this vector is equal to 0 for elements of
the <code>theta</code> vector corresponding to diagonal elements of
the Cholesky factor, <code>-Inf</code>
otherwise. (<code>getME(.,"lower")==0</code> can be used as a test to
identify diagonal elements, as in <code>isSingular</code>.)
</p>
</dd>
<dt>
<code>"rho_e"</code>:</dt>
<dd>
<p>rho function used for the residuals</p>
</dd>
<dt>
<code>"rho_b"</code>:</dt>
<dd>
<p>list of rho functions used for the random effects</p>
</dd>
<dt>
<code>"rho_sigma_e"</code>:</dt>
<dd>
<p>rho function used for the residuals when estimating sigma</p>
</dd>
<dt>
<code>"rho_sigma_b"</code>:</dt>
<dd>
<p>list of rho functions used for the random effects when estimating the covariance parameters</p>
</dd>
<dt>
<code>"M"</code>:</dt>
<dd>
<p>list of matrices, blocks of the Henderson's equations and the matrices used for computing the linear approximations of the estimates of beta and spherical random effects.</p>
</dd>
<dt>
<code>"w_e"</code>:</dt>
<dd>
<p>robustness weights associated with the observations</p>
</dd>
<dt>
<code>"w_b"</code>:</dt>
<dd>
<p>robustness weights associated with the spherical random effects, returned in the same format as <code>ranef()</code></p>
</dd>
<dt>
<code>"w_b_vector"</code>:</dt>
<dd>
<p>robustness weights associated with the spherical random effects, returned as one long vector</p>
</dd>
<dt>
<code>"w_sigma_e"</code>:</dt>
<dd>
<p>robustness weights associated with the observations when estimating sigma</p>
</dd>
<dt>
<code>"w_sigma_b"</code>:</dt>
<dd>
<p>robustness weights associated with the spherical random effects when estimating the covariance parameters, returned in the same format as <code>ranef()</code></p>
</dd>
<dt>
<code>"w_sigma_b_vector"</code>:</dt>
<dd>
<p>robustness weights associated with the spherical random effects when estimating the covariance parameters, returned as one long vector</p>
</dd>
</dl>
<dl>
<dt>
<code>"ALL"</code>:</dt>
<dd>
<p>get all of the above as a <code>list</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potentially further arguments; not here.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>theta</code> is short for <code>getME(, "theta")</code>.
</p>
<p>The goal is to provide “everything a user may want” from a fitted
<code>rlmerMod</code> object <em>as far</em> as it is not available by methods, such
as <code>fixef</code>, <code>ranef</code>, <code>vcov</code>, etc.
</p>


<h3>Value</h3>

<p>Unspecified, as very much depending on the <code>name</code>.
</p>


<h3>See Also</h3>

<p><code>getCall()</code>;
more standard methods for rlmerMod objects, such as <code>ranef</code>,
<code>fixef</code>, <code>vcov</code>, etc.:
see <code>methods(class="rlmerMod")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## shows many methods you should consider *before* using getME():
methods(class = "rlmerMod")

## doFit = FALSE to speed up example
(fm1 &lt;- rlmer(Reaction ~ Days + (Days|Subject), sleepstudy,
              method="DASvar", doFit=FALSE))
Z &lt;- getME(fm1, "Z")
stopifnot(is(Z, "CsparseMatrix"),
          c(180,36) == dim(Z),
	  all.equal(fixef(fm1), b1 &lt;- getME(fm1, "beta"),
		    check.attributes=FALSE, tolerance = 0))

## A way to get *all* getME()s :
## internal consistency check ensuring that all work:
parts &lt;- getME(fm1, "ALL")
str(parts, max=2)
stopifnot(identical(Z,  parts $ Z),
          identical(b1, parts $ beta))
stopifnot(all.equal(theta(fm1), getME(fm1, "theta")))
</code></pre>


</div>