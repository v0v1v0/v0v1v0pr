<div class="container">

<table style="width: 100%;"><tr>
<td>mse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Residuals and prediction error rates</h2>

<h3>Description</h3>

<p>Residuals and prediction error rates (MSEP, SEP, etc. or classification error rate)  for models with quantitative or qualitative responses. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">
residreg(pred, Y)
residcla(pred, y)

msep(pred, Y)
rmsep(pred, Y)
sep(pred, Y)
bias(pred, Y)
cor2(pred, Y)
r2(pred, Y)
rpd(pred, Y)
rpdr(pred, Y)
mse(pred, Y, digits = 3)

err(pred, y)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>Prediction (<code class="reqn">m, q</code>); output of a function <code>predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Observed response (<code class="reqn">m, q</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observed response (<code class="reqn">m, 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits for the numerical outputs.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The rate <code class="reqn">R2</code> is calculated by <code class="reqn">R2 = 1 - MSEP(current model) / MSEP(null model)</code>, where  <code class="reqn">MSEP = Sum((y_i - pred_i)^2)/n</code> and "null model" is the overall mean of <code class="reqn">y</code>. For predictions over CV or Test sets, and/or for non linear models, it can be different from the square of the correlation coefficient (<code class="reqn">cor2</code>) between the observed values and the predictions. 
</p>
<p>Function <code>sep</code> computes the SEP, referred to as "corrected SEP" (SEP_c) in Bellon et al. 2010. SEP is the standard deviation of the residuals. There is the relation: <code class="reqn">MSEP = BIAS^2 + SEP^2</code>.
</p>
<p>Function <code>rpd</code> computes the ratio of the "deviation" (sqrt of the mean of the squared residuals for the null model when it is defined by the simple average) to the "performance" (sqrt of the mean of the squared residuals for the current model, i.e. RMSEP), i.e. <code class="reqn">RPD = SD / RMSEP = RMSEP(null model) / RMSEP</code> (see eg. Bellon et al. 2010).
</p>
<p>Function <code>rpdr</code> computes a robust RPD. 
</p>


<h3>Value</h3>

<p>Residuals or prediction error rates.
</p>


<h3>References</h3>

<p>Bellon-Maurel, V., Fernandez-Ahumada, E., Palagos, B., Roger, J.-M., McBratney, A., 2010. Critical review of chemometric indicators commonly used for assessing the quality of the prediction of soil attributes by NIR spectroscopy. TrAC Trends in Analytical Chemistry 29, 1073-1081. https://doi.org/10.1016/j.trac.2010.05.006
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## EXAMPLE 1

n &lt;- 6 ; p &lt;- 4
Xtrain &lt;- matrix(rnorm(n * p), ncol = p)
ytrain &lt;- rnorm(n)
Ytrain &lt;- cbind(y1 = ytrain, y2 = 100 * ytrain)
m &lt;- 3
Xtest &lt;- Xtrain[1:m, , drop = FALSE] 
Ytest &lt;- Ytrain[1:m, , drop = FALSE] 
ytest &lt;- Ytest[1:m, 1]
nlv &lt;- 3
fm &lt;- plskern(Xtrain, Ytrain, nlv = nlv)
pred &lt;- predict(fm, Xtest)$pred

residreg(pred, Ytest)
msep(pred, Ytest)
rmsep(pred, Ytest)
sep(pred, Ytest)
bias(pred, Ytest)
cor2(pred, Ytest)
r2(pred, Ytest)
rpd(pred, Ytest)
rpdr(pred, Ytest)
mse(pred, Ytest, digits = 3)

## EXAMPLE 2

n &lt;- 50 ; p &lt;- 8
Xtrain &lt;- matrix(rnorm(n * p), ncol = p)
ytrain &lt;- sample(c(1, 4, 10), size = n, replace = TRUE)
Xtest &lt;- Xtrain[1:5, ]
ytest &lt;- ytrain[1:5]
nlv &lt;- 5
fm &lt;- plsrda(Xtrain, ytrain, nlv = nlv)
pred &lt;- predict(fm, Xtest)$pred

residcla(pred, ytest)
err(pred, ytest)

</code></pre>


</div>