<div class="container">

<table style="width: 100%;"><tr>
<td>neiGWAS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Genome-wide association mapping of neighbor effects</h2>

<h3>Description</h3>

<p>A function to test neighbor effects for each marker and to calculate p-values at a given reference scale.
</p>


<h3>Usage</h3>

<pre><code class="language-R">neiGWAS(
  geno,
  pheno,
  gmap,
  smap,
  scale,
  addcovar = NULL,
  grouping = rep(1, nrow(smap)),
  response = c("quantitative", "binary"),
  model = c("lmm", "lm"),
  n_core = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geno</code></td>
<td>
<p>An individual x marker matrix. Bialleles (i.e., A or a) must be converted into -1 or 1 digit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>A numeric vector including phenotypes for individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmap</code></td>
<td>
<p>A matrix or data.frame including chromosome numbers in the first column, and SNP positions in the second column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smap</code></td>
<td>
<p>A matrix showing a spatial map for individuals. The first and second column include spatial points along an x-axis and y-axis, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A numeric scalar indicating the maximum spatial distance between a focal individual and neighbors to define neighbor effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addcovar</code></td>
<td>
<p>An optional matrix including additional non-genetic covariates. It contains no. of individuals x no. of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>A positive integer vector assigning each individual to a group. This argument can be useful when a "smap" contains different experimental replicates. Default setting means that all individuals are belong to a single group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>An option to select if the phenotype is a <code>"quantitative"</code> trait subject to linear models, or a <code>"binary"</code> trait subject to logistic models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>An option to select linear mixed model <code>"lmm"</code> or linear model <code>"lm"</code>. Default setting is to use a mixed model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_core</code></td>
<td>
<p>No. of cores for a multi-core computation. This does not work for Windows OS. Default is a single-core computation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calls a mixed model via the <code>gaston</code> package. If <code>"lmm"</code> with <code>"binary"</code> is selected, p-values are based on Wald tests.
This is because the logistic mixed model is based on a pseudo-likelihood and thus likelihood ratio tests are not applicable. See Chen et al. (2016) for the theory.
</p>


<h3>Value</h3>

<p>A data.frame including the chromosome number, marker position, and p-values.
</p>

<ul>
<li>
<p><code>chr</code> Chromosome number
</p>
</li>
<li>
<p><code>pos</code> Marker position
</p>
</li>
<li>
<p><code>p</code> p-value by a likelihood ratio test between models with or without neighbor effects
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Yasuhiro Sato (<a href="mailto:sato.yasuhiro.36c@kyoto-u.jp">sato.yasuhiro.36c@kyoto-u.jp</a>)
</p>


<h3>References</h3>

<p>Chen H, Wang C, Conomos M. et al. (2016) Control for population structure and relatedness for binary traits in genetic association studies via logistic mixed models. The American Journal of Human Genetics 98: 653-666.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
g &lt;- matrix(sample(c(-1,1),100*1000,replace = TRUE),100,1000)
gmap &lt;- cbind(c(rep(1,nrow(g)/2),rep(2,nrow(g)/2)),c(1:ncol(g)))
x &lt;- runif(nrow(g),1,100)
y &lt;- runif(nrow(g),1,100)
smap &lt;- cbind(x,y)
grouping &lt;- c(rep(1,nrow(g)/2),rep(2,nrow(g)/2))
pheno &lt;- nei_simu(geno=g,smap=smap,scale=44,grouping=grouping,n_causal=50,pveB=0.4,pve=0.8)

fake_nei &lt;- list()
fake_nei[[1]] &lt;- g
fake_nei[[2]] &lt;- gmap
fake_nei[[3]] &lt;- smap
fake_nei[[4]] &lt;- data.frame(pheno,grouping)
names(fake_nei) &lt;- c("geno","gmap","smap","pheno")

scale &lt;- 43
gwas_out &lt;- neiGWAS(geno=fake_nei$geno, pheno=fake_nei$pheno[,1],
                    gmap=fake_nei$gmap, smap=fake_nei$smap,
                    scale=scale, addcovar=as.matrix(fake_nei$pheno$grouping),
                    grouping=fake_nei$pheno$grouping)

gaston::manhattan(gwas_out)
gaston::qqplot.pvalues(gwas_out$p)
</code></pre>


</div>