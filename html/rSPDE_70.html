<div class="container">

<table style="width: 100%;"><tr>
<td>simulate.CBrSPDEobj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of a fractional SPDE using the
covariance-based rational SPDE approximation</h2>

<h3>Description</h3>

<p>The function samples a Gaussian random field based using the
covariance-based rational SPDE approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'CBrSPDEobj'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  user_nu = NULL,
  user_kappa = NULL,
  user_sigma = NULL,
  user_range = NULL,
  user_tau = NULL,
  user_theta = NULL,
  user_m = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>The covariance-based rational SPDE approximation,
computed using <code>matern.operators()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An object specifying if and how the random number generator should be initialized (‘seeded’).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_nu</code></td>
<td>
<p>If non-null, update the shape parameter of the
covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_kappa</code></td>
<td>
<p>If non-null, update the range parameter
of the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_sigma</code></td>
<td>
<p>If non-null, update the standard deviation of
the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_range</code></td>
<td>
<p>If non-null, update the range parameter
of the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_tau</code></td>
<td>
<p>If non-null, update the parameter tau.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_theta</code></td>
<td>
<p>For non-stationary models. If non-null, update the vector of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_m</code></td>
<td>
<p>If non-null, update the order of the rational
approximation, which needs to be a positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with the <code>n</code> samples as columns.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sample a Gaussian Matern process on R using a rational approximation
kappa &lt;- 10
sigma &lt;- 1
nu &lt;- 0.8
range &lt;- sqrt(8*nu)/kappa

# create mass and stiffness matrices for a FEM discretization
x &lt;- seq(from = 0, to = 1, length.out = 101)
fem &lt;- rSPDE.fem1d(x)

# compute rational approximation of covariance function at 0.5
tau &lt;- sqrt(gamma(nu) / (sigma^2 * kappa^(2 * nu) *
(4 * pi)^(1 / 2) * gamma(nu + 1 / 2)))
op_cov &lt;- matern.operators(
  loc_mesh = x, nu = nu,
  range = range, sigma = sigma, d = 1, m = 2,
  parameterization = "matern"
)

# Sample the model and plot the result
Y &lt;- simulate(op_cov)
plot(x, Y, type = "l", ylab = "u(x)", xlab = "x")

</code></pre>


</div>