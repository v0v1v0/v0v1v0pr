<div class="container">

<table style="width: 100%;"><tr>
<td>PlotSpectrogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates and Plots spectrogram</h2>

<h3>Description</h3>

<p>Plots spectrogram of the heart rate signal as calculated by
CalculateSpectrogram() function
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotSpectrogram(
  HRVData,
  size,
  shift,
  sizesp = NULL,
  freqRange = NULL,
  scale = "linear",
  verbose = NULL,
  showLegend = TRUE,
  Tags = NULL,
  Indexes = NULL,
  eplim = NULL,
  epColorPalette = NULL,
  markEpisodes = TRUE,
  ymark = NULL,
  showEpLegend = TRUE,
  epLegendCoords = NULL,
  main = "Spectrogram of the HR  series",
  xlab = "Time (sec.)",
  ylab = "Frequency (Hz.)",
  ylim = freqRange,
  Tag = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HRVData</code></td>
<td>
<p>Data structure that stores the beats register and information
related to it</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Size of window for calculating spectrogram (seconds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>Displacement of window for calculating spectrogram (seconds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizesp</code></td>
<td>
<p>Points for calculation (zero padding). If the user does not 
specify it, the function estimates a propper value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqRange</code></td>
<td>
<p>Vector with two components specifying the frequency range 
that the program should plot. If the user does not specify it, the function 
uses the whole frequency range. It is possible to specify the frequency range
using the ylim parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Scale used to plot spectrogram, linear or logarithmic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Deprecated argument maintained for compatibility, 
use SetVerbose() instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showLegend</code></td>
<td>
<p>Logical argument. If true, a legend of the color map is 
shown (default is TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tags</code></td>
<td>
<p>List of tags to specify which episodes, as apnoea or oxygen 
desaturation, are included in the plot. <em>Tags</em>="all" plots all episodes present
in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Indexes</code></td>
<td>
<p>List of indexes of episodes (see ListEpisodes())
to specify which episodes are included in the plot.
<em>Indexes</em>="all" plots all episodes present in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eplim</code></td>
<td>
<p>Two-component vector specifying the y-range (min,max) for the
vertical lines limiting each episode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epColorPalette</code></td>
<td>
<p>Vector specifying the color of each of the episodes that 
will be plotted. The length of colorPalette should be equal or greater than 
the number of different episodes to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markEpisodes</code></td>
<td>
<p>Boolean specyfing if a horizontal mark should be included 
for each of the episodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymark</code></td>
<td>
<p>Two-component vector specifying the y-range (min,max) for the
horizontal marks. Only used if markEpisodes = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showEpLegend</code></td>
<td>
<p>Boolean argument. If TRUE, a legend of the episodes is 
included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epLegendCoords</code></td>
<td>
<p>Two-component vector specifiying the coordinates where
the legend should be placed. By defaul, the legend is placed on top of the
plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A main title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A label for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>A label for the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Numeric vectors of length 2, giving the x and y coordinates 
range. If freqRange is specified, ylim is overwriten by it because of backward
compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tag</code></td>
<td>
<p>Deprecated argument maintained for
compatibility, use Tags instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other graphical parameters. See 
<code>filled.contour</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>PlotSpectrogram
</p>


<h3>Note</h3>

<p>PlotSpectrogram with <em>showLegend = TRUE</em> uses the layout function 
and so is restricted to a full page display. Select <em>showLegend = FALSE</em>
in order to use the layout function.
</p>


<h3>Author(s)</h3>

<p>M. Lado, A. Mendez, D. Olivieri, L. Rodriguez, X. Vila. C.A. Garcia
</p>


<h3>References</h3>

<p>L. Rodriguez-Linares, A. Mendez, M. Lado, D. Olivieri, X. Vila, 
I. Gomez-Conde, "An open source tool for heart rate variability spectral 
analysis", Computer Methods and Programs in Biomedicine 103, 39-50, 
doi:10.1016/j.cmpb.2010.05.012 (2011)
</p>


<h3>See Also</h3>

<p><code>CalculateSpectrogram</code> for spectrogram calculation
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# Read file "a03" from the physionet apnea-ecg database
library(RHRV)
HRVData &lt;- CreateHRVData()
HRVData &lt;- LoadBeatWFDB(HRVData,RecordName="test_files/WFDB/a03")
HRVData &lt;- LoadApneaWFDB(HRVData,RecordName="test_files/WFDB/a03")
# Add other type of episode for a more complete example (this episode does
# not have any physiological meaning)
HRVData &lt;- AddEpisodes(HRVData,InitTimes=c(4500),Durations=c(1000), 
                       Tags="Other", Values = 1)         
# Calculating heart rate signal:
HRVData &lt;- BuildNIHR(HRVData)
 
# Filtering heart rate signal:
HRVData &lt;- FilterNIHR(HRVData)

# Interpolating heart rate signal:
HRVData = InterpolateNIHR(HRVData)
 
# Calculating and Plotting Spectrogram
spctr &lt;- PlotSpectrogram(HRVData, size = 120, shift = 10, sizesp = 1024,
         freqRange=c(0,0.14), color.palette = topo.colors)
         
spctr &lt;- PlotSpectrogram(HRVData,size=120, shift=60, Tags="all", 
                         ylim=c(0,0.1),
                         showLegend=T, 
                         eplim = c(0,0.06),
                         epColorPalette=c("skyblue","white"), 
                         showEpLegend = T,
                         epLegendCoords = c(15000,0.08), 
                         ymark=c(0.001,0.002))

## End(Not run)
</code></pre>


</div>