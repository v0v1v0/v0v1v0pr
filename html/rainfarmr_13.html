<div class="container">

<table style="width: 100%;"><tr>
<td>rfweights</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derive weights from a fine-scale precipitation climatology</h2>

<h3>Description</h3>

<p>Weights for downscaling are computed interpolating a fine-scale
climatology to the target grid and dividing it by an averaged version of
itself. A suitable climatology could be represented for example by a
fine-scale precipitation climatology from a high-resolution regional
climate model (see e.g. Terzago et al. (2018)
doi: <a href="http://doi.org/10.5194/nhess-18-2825-2018">10.5194/nhess-18-2825-2018</a>), a local high-resolution gridded
climatology from observations, or a reconstruction such as those which
can be downloaded from the <a href="http://www.worldclim.org">WORLDCLIM</a> or
<a href="http://chelsa-climate.org">CHELSA</a> websites.
The latter data could be converted to NetCDF format using
for example the <a href="https://www.gdal.org">GDAL tools</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rfweights(z, lon, lat, lonc, latc, nf, fsmooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>matrix with a spatial field of fine-scale precipitation climatology.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>vector of longitudes of the high-resolution climatology</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>vector of latitudes of the high-resolution climatology</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lonc</code></td>
<td>
<p>vector of longitudes of the coarse field to downscale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latc</code></td>
<td>
<p>vector of latitudes of the coarse field to downscale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>refinement factor for downscaling (the coarse resolution is
increased by this factor).
The number of longitudes and latitudes is expected to be equal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsmooth</code></td>
<td>
<p>logical to compute weights against a smooth average.
If false box averaging is used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The matrix of weights with dimensions <code>c(lonc*nf, latc*nf)</code>
</p>


<h3>Author(s)</h3>

<p>Jost von Hardenberg, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>References</h3>

<p>Terzago, S. et al. (2018). NHESS 18(11), 2825â€“2840
doi: <a href="http://doi.org/10.5194/nhess-18-2825-2018">10.5194/nhess-18-2825-2018</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Make synthetic fine-scale precipitation climatology
z &lt;- exp(metagauss(initmetagauss(1.7, 64)))
# Specify lon and lat of the input
lon &lt;- seq(10,17.875,0.125)
lat &lt;- seq(40,47.875,0.125)
# Specify lon and lat of the coarse field and the downscaling factor
lonc &lt;- seq(12,15.5,0.5)
latc &lt;- seq(42,45.5,0.5)
nf &lt;- 4
ww &lt;- rfweights(z, lon, lat, lonc, latc, nf) 
</code></pre>


</div>