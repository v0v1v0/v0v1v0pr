<div class="container">

<table style="width: 100%;"><tr>
<td>markedData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Format Wildbook data for mark-recaputure analysis</h2>

<h3>Description</h3>

<p>Format data from <code>searchWB</code> function in <code>RWildbook</code> package for
mark-recapture analysis with <code>marked</code> and <code>RMark</code> packages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">markedData(data, varname_of_capturetime = "dateInMilliseconds",
  varlist = c("individualID"), start.dates, end.dates = NULL,
  date_format = "%Y-%m-%d", origin = "1970-01-01", removeZeros = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The raw data set from <code>searchWB</code> function in <code>RWildbook</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varname_of_capturetime</code></td>
<td>
<p>A character object which is the variable name for capture/encounter sighted time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varlist</code></td>
<td>
<p>A character vector of the names of variables for mark-recapture analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.dates</code></td>
<td>
<p>A character vector of dates which are the start dates of the capture occasions.
The elements should be in the form of date_format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end.dates</code></td>
<td>
<p>A character vector of dates which are the end dates of the capture occasions.
The elements should be in the form of date_format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date_format</code></td>
<td>
<p>The format for all the arguments of date value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>A point of time which set to be zero in millisecond.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removeZeros</code></td>
<td>
<p>If TRUE (default) then individuals with no captures are removed from the data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>markedData</code> function format the wildbook data set that users search with
the <code>searchWB</code> fucntion for the mark-recapture analysis with <code>mark</code> and
<code>RMark</code> package. In <code>marked</code> package, users can process a certain form of
data set with <code>process.data</code> function in <code>marked</code> package. The <code>markedData</code>
function reutrns data set which can be the input data set of <code>process.data</code>.
</p>
<p><strong>Defalut NULL value for end.dates argument</strong>
</p>
<p>The default value for <code>end.date</code> argument are NULL which means the capture occasion intervals
are divided by the elements of <code>start.date</code> argument. In this case, the end date of the last
capture occasion is the value of <code>Sys.Date()</code>.
</p>
<p><strong>The class of output</strong>
The class of the ouput of <code>markedData</code> is "data.table" and "data.frame". With installing
the <code>data.table</code> package, the ouput is a data.table, otherwise it is a data.frame. That means
users can process the data with <code>data.table</code> package. Also users can directly process the output
with <code>process.data</code> function in <code>marked</code> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
## You will need to supply your own login information for whaleshark.org to
## run these examples.

## Load packages
library(marked)

## Extract data for individual A-001 through A-099
data1 &lt;- searchWB(username="username",
                  password="password",
                  baseURL ="whaleshark.org",
                  object="Encounter",
                  individualID=paste0("A-0",rep(0:9,rep(10,10)),rep(0:9,10))[-1])

## Define start and end dates of capture occasions
start.dates1 &lt;- paste0(1998:2016,"-01-01") #Define the start.date value
end.dates1 &lt;- paste0(1998:2016,"-04-01") #Define the end.date value

## Format data for use in marked
markedData1.1 &lt;- markedData(data = data1,
                             varname_of_capturetime = "dateInMilliseconds",
                             varlist = c("individualID"),
                             start.dates = start.dates1,
                             end.dates = NULL,
                             date_format = "%Y-%m-%d",
                             origin = "1970-01-01",
                             removeZeros = TRUE)


## Fit simple CJS model in marked
markedData1.proc=process.data(markedData1.1,model="CJS",begin.time=1)
markedData1.ddl=make.design.data(markedData1.proc)
markedData1.cjs=crm(markedData1.proc,
                    markedData1.ddl,
                    model.parameters=list(Phi=list(formula=~time),p=list(formula=~time)))

## Format data including location as a covariate
markedData1.2 &lt;- markedData(data = data1,
                           varname_of_capturetime = "dateInMilliseconds",
                           varlist = c("individualID","locationID"),
                           start.dates = start.dates1,
                           end.dates = end.dates1,
                           date_format = "%Y-%m-%d",
                           origin = "1970-01-01")

## End(Not run)                           

</code></pre>


</div>