<div class="container">

<table style="width: 100%;"><tr>
<td>Gaussfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Gaussians to Absorption Features of a Normalized Spectrum</h2>

<h3>Description</h3>

<p>This function takes a spectrum, which ideally is a high signal-to-noise template
spectrum estimated with the <code>estimate_template</code> function, and the
absorption features found with the <code>findabsorptionfeatures</code> function
and uses nonlinear least-squares to fit Gaussians to the features. This follows
the procedure described in <a href="https://arxiv.org/abs/2005.14083">Holzer et al. (2020)</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Gaussfit(wvl, flx, ftrs, cores = 1, mse_max1 = 0.00014, mse_max2 = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wvl</code></td>
<td>
<p>vector of wavelengths of the spectrum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flx</code></td>
<td>
<p>vector of normalized flux of the spectrum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftrs</code></td>
<td>
<p>a list of length 2 vectors that each give the lower and upper bounds of found absorption features. The <code>wvbounds</code> component of the <code>findabsorptionfeatures</code> function output is designed to be this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>the integer count of cores to parallelize over. If set to 1, no parallelization is done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse_max1</code></td>
<td>
<p>the maximum mean squared error required for a fit from one Gaussian to be considered a good fit for an absorption feature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse_max2</code></td>
<td>
<p>the maximum mean squared error required for a fit of two Gaussians to be considered a good fit for an absorption feature</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>a dataframe with the wavelength bounds, fitted amplitude,
fitted center, fitted spread, and fit type for absorption features with a
good fit. A fit type of 0 indicates that the feature had a good fit of a single
Gaussian. A fit type of 1 indicates that the feature did not have a good fit
with a single Gaussian initially, but after fitting with two it did.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>the vector of fitted values (with the same length as the
<code>wvl</code> parameter) using only the features that produced a good fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>goodfits</code></td>
<td>
<p>a vector of the indices for which rows in the <code>ftrs</code>
parameter were well fitted with either 1 or 2 Gaussians at the end</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>a vector with the mean squared error for each of the features in
the <code>ftrs</code> parameter using the final fitted values</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(template)
ftrs = findabsorptionfeatures(template$Wavelength,
                              template$Flux,
                              pix_range = 8, gamma = 0.05,
                              alpha = 0.07, minlinedepth = 0.015)
gapp = Gaussfit(template$Wavelength, template$Flux, ftrs)
plot(template$Wavelength, template$Flux)
lines(template$Wavelength, gapp$fitted, col=2)

</code></pre>


</div>