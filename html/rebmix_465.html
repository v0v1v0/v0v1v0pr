<div class="container">

<table style="width: 100%;"><tr>
<td>optbins-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Optimal Numbers of Bins Calculation
</h2>

<h3>Description</h3>

<p>Returns the matrix of size <code class="reqn">n_{\mathrm{D}} \times d</code> containing optimal numbers of bins <code class="reqn">v_{1}, \ldots, v_{d}</code> for all processed datasets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'list'
optbins(Dataset = list(), Rule = "Knuth equal",
        ymin = numeric(), ymax = numeric(), kmin = numeric(),
        kmax = numeric(), ...)
## ... and for other signatures
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>

<p>a list of length <code class="reqn">n_{\mathrm{D}}</code> of data frames of size <code class="reqn">n \times d</code> containing <em>d</em>-dimensional datasets. Each of the <code class="reqn">d</code> columns
represents one random variable. Numbers of observations <code class="reqn">n</code> equal the number of rows in the datasets.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rule</code></td>
<td>

<p>a character giving the histogram binning rule. One of <code>"Sturges"</code>, <code>"Log10"</code>, <code>"RootN"</code>, default <code>"Knuth equal"</code> or <code>"Knuth unequal"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymin</code></td>
<td>

<p>a vector of length <code class="reqn">d</code> containing minimum observations. The default value is <code>numeric()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>

<p>a vector of length <code class="reqn">d</code> containing maximum observations. The default value is <code>numeric()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmin</code></td>
<td>

<p>lower limit of the number of bins. The default value is <code>numeric()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>

<p>upper limit of the number of bins. The default value is <code>numeric()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>currently not used.
</p>
</td>
</tr>
</table>
<h3>Methods</h3>


<dl>
<dt><code>signature(x = "list")</code></dt>
<dd>
<p>a list of data frames.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Branislav Panic, Marko Nagode</p>


<h3>References</h3>

<p>K. K. Knuth. Optimal data-based binning for histograms and histogram-based probability density models. 
Digital Signal Processing, 95:102581, 2019.
<a href="https://doi.org/10.1016/j.dsp.2019.102581">doi:10.1016/j.dsp.2019.102581</a>.<br><br>
B. Panic, J. Klemenc, M. Nagode. Improved initialization of the EM algorithm for mixture model parameter estimation.
Mathematics, 8(3):373, 2020.
<a href="https://doi.org/10.3390/math8030373">doi:10.3390/math8030373</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate multivariate normal datasets.

n &lt;- c(750, 1000)

Theta &lt;- new("RNGMVNORM.Theta", c = 2, d = 2)

a.theta1(Theta, 1) &lt;- c(8, 6)
a.theta1(Theta, 2) &lt;- c(6, 8)
a.theta2(Theta, 1) &lt;- c(8, 2, 2, 4)
a.theta2(Theta, 2) &lt;- c(2, 1, 1, 4)

sim2d &lt;- RNGMIX(model = "RNGMVNORM", 
  Dataset.name = paste("sim2d_", 1:5, sep = ""),
  rseed = -1,
  n = n,
  Theta = a.Theta(Theta))

# Calculate optimal numbers of bins.

opt.k &lt;- optbins(Dataset = sim2d@Dataset,
  Rule = "Knuth equal",
  ymin = sim2d@ymin,
  ymax = sim2d@ymax,
  kmin = 2, 
  kmax = 20)

opt.k

# Create object of class EM.Control.

EM &lt;- new("EM.Control", strategy = "exhaustive", variant = "EM",
  acceleration = "fixed", acceleration.multiplier = 1.0, tolerance = 1.0E-4,
  maximum.iterations = 1000)

# Estimate number of components, component weights and component parameters.

sim2dest &lt;- REBMIX(model = "REBMVNORM", 
  Dataset = a.Dataset(sim2d),
  Preprocessing = "h",
  cmax = 10,
  ymin = a.ymin(sim2d),
  ymax = a.ymax(sim2d),
  K = opt.k,
  Criterion = "BIC",
  EMcontrol = EM)

# Plot finite mixture.

plot(sim2dest, pos = 3, nrow = 4, what = c("pdf", "marginal pdf", "IC"))

# Estimate number of components, component weights and component 
# parameters for well known Iris dataset.

Dataset &lt;- list(iris[, c(1:4)])

# Calculate optimal numbers of bins using non-equal number of bins in each dimension.

opt.k &lt;- optbins(Dataset = Dataset,
  Rule = "Knuth unequal",
  kmin = 2, 
  kmax = 20)

opt.k

# Estimate number of components, component weights and component parameters.

irisest &lt;- REBMIX(model = "REBMVNORM", 
  Dataset = Dataset,
  Preprocessing = "h",
  cmax = 10,
  K = opt.k,
  Criterion = "BIC",
  EMcontrol = EM)
  
irisest
</code></pre>


</div>