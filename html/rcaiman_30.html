<div class="container">

<table style="width: 100%;"><tr>
<td>fit_coneshaped_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit cone-shaped model</h2>

<h3>Description</h3>

<p>Statistical modeling for predicting digital numbers from spherical
coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_coneshaped_model(sky_points, use_azimuth_angle = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sky_points</code></td>
<td>
<p>The <em>data.frame</em> returned by <code>extract_rl()</code> or a
<em>data.frame</em> with same structure and names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_azimuth_angle</code></td>
<td>
<p>Logical vector of length one. If <code>TRUE</code>, the
Equation 4 from Díaz and Lencinas (2018)) is used: <code class="reqn">sDN =
  a + b \cdot \theta + c  \cdot \theta^2 + d  \cdot sin(\phi) + e  \cdot
  cos(\phi)</code>, where <code class="reqn">sDN</code> is sky digital number, <code class="reqn">a,b,c,d</code> and
<code class="reqn">e</code> are coefficients, <code class="reqn">\theta</code> is zenith angle, and <code class="reqn">\phi</code> is
azimuth angle. If <code>FALSE</code>, the next simplified version based on
Wagner (2001) is used: <code class="reqn">sDN = a + b \cdot
  \theta + c  \cdot \theta^2</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method was presented in Díaz and Lencinas (2018), under the
heading <em>Estimation of the sky DN as a previous step for our method</em>. If you
use this function in your research, please cite that paper in addition to
this package (<code style="white-space: pre;">⁠citation("rcaiman"⁠</code>).
</p>


<h3>Value</h3>

<p>A list of two objects, one of class <code>function</code> and the other of class
<code>lm</code> (see <code>stats::lm()</code>). If the fitting fails, it returns <code>NULL</code>. The
function requires two arguments–zenith and azimuth in degrees–to return
relative luminance.
</p>


<h3>References</h3>

<p>Díaz GM, Lencinas JD (2018).
“Model-based local thresholding for canopy hemispherical photography.”
<em>Canadian Journal of Forest Research</em>, <b>48</b>(10), 1204–1216.
<a href="https://doi.org/10.1139/cjfr-2018-0006">doi:10.1139/cjfr-2018-0006</a>.<br><br> Wagner S (2001).
“Relative radiance measurements and zenith angle dependent segmentation in hemispherical photography.”
<em>Agricultural and Forest Meteorology</em>, <b>107</b>(2), 103–115.
<a href="https://doi.org/10.1016/s0168-1923%2800%2900232-x">doi:10.1016/s0168-1923(00)00232-x</a>.
</p>


<h3>See Also</h3>

<p><code>thr_mblt()</code>
</p>
<p>Other Sky Reconstruction Functions: 
<code>cie_sky_model_raster()</code>,
<code>fit_cie_sky_model()</code>,
<code>fit_trend_surface()</code>,
<code>fix_reconstructed_sky()</code>,
<code>interpolate_sky_points()</code>,
<code>ootb_sky_reconstruction()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
path &lt;- system.file("external/DSCN4500.JPG", package = "rcaiman")
caim &lt;- read_caim(path, c(1250, 1020) - 745, 745 * 2, 745 * 2)
z &lt;- zenith_image(ncol(caim), lens("Nikon_FCE9"))
a &lt;- azimuth_image(z)
r &lt;- gbc(caim$Blue)

sky_points &lt;- extract_rl(r, z, a, extract_sky_points_simple(r, z, a),
                         NULL,
                         use_window = FALSE)#this is important when
                                            #extract_sky_points_simple()
                                            #is used
model &lt;- fit_coneshaped_model(sky_points$sky_points)
summary(model$model)
sky_cs &lt;- model$fun(z, a)
plot(r/sky_cs)
plot(sky_cs)

z &lt;- zenith_image(50, lens())
a &lt;- azimuth_image(z)
sky_cs &lt;- model$fun(z, a)
persp(sky_cs, theta = 90, phi = 20)

## End(Not run)
</code></pre>


</div>