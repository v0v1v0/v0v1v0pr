<div class="container">

<table style="width: 100%;"><tr>
<td>integrate_gk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adaptive Gauss-Kronrod Quadrature for multiple limits</h2>

<h3>Description</h3>

<p>Integrates fun over the bounds [ lower, upper ] vectorized over <code>lower</code> and
<code>upper</code>. Vectorized list structures of parameters can also be passed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">integrate_gk(
  fun,
  lower,
  upper,
  params = list(),
  .tolerance = .Machine$double.eps^0.25,
  .max_iter = 100L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>A function to integrate.
Must be vectorized and take one or two arguments, the first being points to
evaluate at and the second (optionally) being parameters to apply.
It must return a numeric vector the same length as its first input.
</p>
<p>Currently, infinite bounds are not supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>
<p>Integration bounds. Must have the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Parameters to pass as a second argument to <code>fun</code>.
The actual parameters must have the same length as the number of integrals to
compute. Can be a possibly nested list structures containing numeric vectors.
Alternatively, can be a matrix with the same number of rows as the number of integrals to compute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.tolerance</code></td>
<td>
<p>Absolute element-wise tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.max_iter</code></td>
<td>
<p>Maximum number of iterations. The number of
integration intervals will be at most <code>length(lower) * .max_iter</code>. Therefor the maximum
number of function evaluations per integration interval will be
<code>15 * .max_iter</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The integration error is estimated by the Gauss-Kronrod quadrature as the
absolute difference between the 7-point quadrature and the 15-point
quadrature. Integrals that did not converge will be bisected at the midpoint.
The <code>params</code> object will be recursively subsetted on all numeric vectors with
the same length as the number of observations.
</p>


<h3>Value</h3>

<p>A vector of integrals with the i-th entry containing an approximation
of the integral of fun(t, pick_params_at(params, i)) dt over the interval lower[i] to upper[i]
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Argument recycling and parallel integration of two intervals
integrate_gk(sin, 0, c(pi, 2 * pi))

dist &lt;- dist_exponential()
integrate_gk(
  function(x, p) dist$density(x, with_params = p),
  lower = 0, upper = 1:10,
  params = list(rate = 1 / 1:10)
)
dist$probability(1:10, with_params = list(rate = 1 / 1:10))

</code></pre>


</div>