<div class="container">

<table style="width: 100%;"><tr>
<td>find.optimal.thresh.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to find the optimal RANKS score thereshold
</h2>

<h3>Description</h3>

<p>Function to find the optimal quantile alpha and corresponding threshold by  cross-validation with a kernel-based
score method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find.optimal.thresh.cv(K, ind.pos, ind.non.pos, m = 5, 
alpha = seq(from = 0.05, to = 0.6, by = 0.05), init.seed = NULL, 
opt.fun = compute.F, fun = KNN.score, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>matrix. Kernel matrix or any valid symmetric matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.pos</code></td>
<td>
<p>indices of the positive examples. They are the indices the row of RW corresponding to positive examples of the training set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.non.pos</code></td>
<td>
<p>indices of the non positive examples. They are the indices the row of RW corresponding to non positive examples  of the training set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of folds (default: 5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>vector of the quantiles to be tested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.seed</code></td>
<td>
<p>initial seed for the random generator. If NULL (def) no initialization is performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.fun</code></td>
<td>
<p>Function implementing the metric to select the optimal threshold.
The F-score (compute.F) is the default. Available functions:
</p>
<p>- compute.F: F-score (default) 
</p>
<p>- compute.acc:accuracy.  
</p>
<p>Any function having two arguments representing the vector of predicted and true labels can be in principle used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>function. It must be a kernel-based score method (default KNN.score)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments for the function fun</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function to find the optimal quantile alpha and corresponding threshold by  cross-validation with a kernel-based
score method. The optimality is computed with respect to a specific metric (def: F-score).
This function is used by <code>multiple.ker.score.thresh.cv</code>, <code>ker.score.classifier.holdout</code>, <code>ker.score.classifier.cv</code>.
</p>


<h3>Value</h3>

<p>A list with 3 elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>quantile corresponding to the best F-score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>threshold corresponding to the best F-score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.scores</code></td>
<td>
<p>scores of the positive elements computed through CV</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>multiple.ker.score.thresh.cv</code>, <code>Kernel functions</code>, <code>ker.score.classifier.holdout</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Finding the optimal threshold in the Tanimoto chemical structure similarity network 
# between 1253 DrugBank drugs for the prediction of the DrugBank category Penicillins using
# the KNN-score with the random walk kernel 
library(bionetdata);
data(DD.chem.data);
data(DrugBank.Cat);
K &lt;- rw.kernel(DD.chem.data);
labels &lt;- DrugBank.Cat[,"Penicillins"];
ind.pos &lt;- which(labels==1);
ind.non.pos &lt;- which(labels==0);
res &lt;- find.optimal.thresh.cv(K, ind.pos, ind.non.pos);
res
</code></pre>


</div>