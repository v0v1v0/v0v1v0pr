<div class="container">

<table style="width: 100%;"><tr>
<td>ROSE-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
ROSE: Random Over-Sampling Examples</h2>

<h3>Description</h3>

<p>Functions to deal with binary classification
problems in the presence of imbalanced classes. Synthetic balanced samples are
generated according to ROSE (Menardi and Torelli, 2014).
Functions that implement more traditional remedies to the class imbalance
are also provided, as well as different metrics to evaluate a learner accuracy.
These are estimated by holdout, bootrstrap or cross-validation methods.
</p>


<h3>Details</h3>








<p>The package pivots on function <code>ROSE</code> which generates synthetic balanced
samples and thus allows to strenghten the subsequent estimation of any binary classifier.
ROSE (Random Over-Sampling Examples) is a bootstrap-based technique
which aids the task of binary classification in the presence of rare classes.
It handles both continuous and categorical data by generating synthetic examples from
a conditional density estimate of the two classes. 
Different metrics to evaluate a learner accuracy are supplied by
functions <code>roc.curve</code> and <code>accuracy.meas</code>.
Holdout, bootstrap or cross-validation estimators of these accuracy metrics are
computed by means of ROSE and provided by function <code>ROSE.eval</code>, to be used in
conjuction with virtually any binary classifier.
Additionally, function <code>ovun.sample</code> implements more traditional remedies
to the class imbalance, such as over-sampling the minority class, under-sampling the majority
class, or a combination of over- and under- sampling.
</p>


<h3>Author(s)</h3>

<p>Nicola Lunardon, Giovanna Menardi, Nicola Torelli
</p>
<p>Maintainer:
Nicola Lunardon &lt;lunardon@stat.unipd.it&gt;
</p>


<h3>References</h3>

<p>Lunardon, N., Menardi, G., and Torelli, N. (2014). ROSE: a Package for Binary Imbalanced Learning. <em>R Jorunal</em>, 6:82–92.
</p>
<p>Menardi, G. and Torelli, N. (2014). Training and assessing classification rules with imbalanced data. <em>Data Mining and Knowledge Discovery</em>, 28:92–122.
</p>


<h3>See Also</h3>

<p><code>nnet</code>,
<code>rpart</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># loading data
data(hacide)

# check imbalance
table(hacide.train$cls)

# train logistic regression on imbalanced data
log.reg.imb &lt;- glm(cls ~ ., data=hacide.train, family=binomial)

# use the trained model to predict test data
pred.log.reg.imb &lt;- predict(log.reg.imb, newdata=hacide.test,
                            type="response")

# generate new balanced data by ROSE
hacide.rose &lt;- ROSE(cls ~ ., data=hacide.train, seed=123)$data

# check (im)balance of new data
table(hacide.rose$cls)

# train logistic regression on balanced data
log.reg.bal &lt;- glm(cls ~ ., data=hacide.rose, family=binomial)

# use the trained model to predict test data
pred.log.reg.bal &lt;- predict(log.reg.bal, newdata=hacide.test,
                            type="response")

# check accuracy of the two learners by measuring auc
roc.curve(hacide.test$cls, pred.log.reg.imb)
roc.curve(hacide.test$cls, pred.log.reg.bal, add.roc=TRUE, col=2)

# determine bootstrap distribution of the AUC of logit models
# trained on ROSE balanced samples
# B has been reduced from 100 to 10 for time saving solely
boot.auc.bal &lt;- ROSE.eval(cls ~ ., data=hacide.train, learner= glm,
                          method.assess = "BOOT",
                          control.learner=list(family=binomial),
                          trace=TRUE, B=10)

summary(boot.auc.bal)
</code></pre>


</div>