<div class="container">

<table style="width: 100%;"><tr>
<td>simul.comb.shift</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulating trees from shift.estimates() results to test model adequacy
</h2>

<h3>Description</h3>

<p>Simulates trees with combination of shifts from shifts.estimates() output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  simul.comb.shift(n = 10000, phylo, sampling.fractions,
                   shift.res, combi = 1, clade.size = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>numeric. Defines the number of simulations to generate (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling.fractions</code></td>
<td>

<p>the output resulting from get.sampling.fractions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift.res</code></td>
<td>

<p>the output resulting from shift.estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combi</code></td>
<td>

<p>numeric. Corresponds to the rank of the combination in the global comparison (shift.res$total).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clade.size</code></td>
<td>

<p>numeric. Defines the minimum number of species in a subgroup. Default is 5.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Some combinations of shifts might be complex cases to simulate because the backbone needs to be rich enough to graft subclades. Some simulations will not satisfy this condition and will then be discarded. In consequence, the number of simulated phylogenies in the output will not be equal to n for complex simulations. This is why the value of n is high by default (n = 10000), to ensure to have enough simulations (around 500) to test the presence.
</p>
<p>clade.size argument should be the same value for the whole procedure in the empirical case (same than for get.sampling.fraction and get.comb.shift).
</p>


<h3>Value</h3>

<p>a list of simulated phylogenies as object of type phylo. Tips of subclades are named with the letters a, b, c, etc. while tips of backbones are named with letters z, y, etc. The empirical groups are sorted from the more recent to the older one (i.e. group a will be the more recent empirical subclade, etc.).
</p>


<h3>Author(s)</h3>

<p>Nathan Mazet</p>


<h3>References</h3>

<p>Mazet, N., Morlon, H., Fabre, P., Condamine, F.L., (2023). Estimating clade‐specific diversification rates and palaeodiversity dynamics from reconstructed phylogenies. <em>Methods in Ecology and in Evolution</em> 14, 2575–2591. https://doi.org/10.1111/2041-210X.14195
</p>


<h3>See Also</h3>

<p><code>shift.estimates</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# loading data
data("Cetacea")
data("taxo_cetacea")
data("shifts_cetacea")

# with the results from shifts.estimates()

# no shifts tested at genus level
taxo_cetacea_no_genus &lt;- taxo_cetacea[names(taxo_cetacea) != "Genus"]

f_cetacea &lt;- get.sampling.fractions(phylo = Cetacea,
                                    data = taxo_cetacea_no_genus)

all_posteriors_cetacea &lt;- simul.comb.shift(phylo = Cetacea,
                                           sampling.fractions = f_cetacea,
                                           shift.res = shifts_cetacea)
  
</code></pre>


</div>