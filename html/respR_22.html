<div class="container">

<table style="width: 100%;"><tr>
<td>calc_rate.bg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate background oxygen uptake or input rates</h2>

<h3>Description</h3>

<p>This function calculates the rate of change of oxygen over time from "blank"
or control respirometry experiments, to allow for background adjustments of
experimental data. It accepts background oxygen~time data as data frames and
<code>inspect</code> objects. The data must be in the same time and oxygen units as the
data from which the rate which will be adjusted was extracted. Multiple
columns of background oxygen measurements can be entered as long as they
share the same time data. In this case the function returns rates for all
columns, and also calculates a mean rate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_rate.bg(x, time = NULL, oxygen = NULL, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>data.frame</code> or <code>inspect</code> object. This is the data to extract
background rate(s) from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>integer. Defaults to 1. This specifies the column number of the
time data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oxygen</code></td>
<td>
<p>integer value or vector. This specifies the column number(s) of
the oxygen data. Multiple columns of oxygen can be specified. If NULL,
function assumes oxygen data are in <em>all</em> columns of the data frame except
the <code>time</code> column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. Defaults to TRUE. Plots the data. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Allows additional plotting controls to be passed, such as <code>pos</code>,
<code>legend = FALSE</code>, and <code>quiet = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main difference between <code>calc_rate.bg</code> and <code>calc_rate</code>, is that this
function allows a rate to be determined from the same region of multiple
oxygen data columns, whereas <code>calc_rate</code> allows multiple rates to be
determined from different regions of a single dataset.
</p>


<h4>Units</h4>

<p>There are no units involved in <code>calc_rate.bg</code>. This is a deliberate decision.
The units of oxygen concentration and time will be specified later in
<code>convert_rate()</code> when rates are converted to specific output units. It is
important however, the background time~oxygen data is in the same time and
oxygen units as the data used to determine the rate which will be adjusted.
</p>



<h4>Subsetting data regions</h4>

<p><code>calc_rate.bg</code> does not have internal subsetting of data regions. If you need
to subset the data to specific regions you don't want to use, see
<code>subset_data()</code>, which allows for easy passing (or piping) of subsets to
<code>calc_rate.bg</code>.
</p>



<h4>Background respiration vs background input of oxygen</h4>

<p>Most users will be using this function to account for background oxygen
consumption rates from microbial activity that need to be quantified and
their effects removed from experimental specimen rates. However, there are
some experiments where oxygen <em>input</em> rates may be of interest, for example
in open tank or open arena respirometry where the input of oxygen from the
water surface has been calculated or quantified. There are also cases in
closed respirometry where there may be an input of oxygen via leaks or oxygen
production from photosynthesis which need to be quantified. <code>calc_rate.bg</code> is
readily capable of quantifying production rates as well as consumption, and
these can also be used for adjustments in <code>adjust_rate()</code>.
</p>



<h4>Plot</h4>

<p>A plot is produced (provided <code>plot = TRUE</code>) showing all examined columns of
oxygen against time (bottom blue axis) and row index (top red axis), with the
rate and linear model coefficients. Single rates can be plotted by changing
the <code>pos</code> input either in the main function call, or by plotting the output,
e.g. <code>plot(object, pos = 2)</code>. Console output messages can be suppressed using
<code>quiet = TRUE</code>. If equations obscure the plot they can be suppressed using
<code>legend = FALSE</code>.
</p>



<h4>S3 Generic Functions</h4>

<p>Saved output objects can be used in the generic S3 functions <code>print()</code>,
<code>summary()</code>, and <code>mean()</code>.
</p>

<ul>
<li> <p><code>print()</code>: prints all background rates, plus the mean background rate.
</p>
</li>
<li> <p><code>summary()</code>: prints summary table of all results and metadata, or those
specified by the <code>pos</code> input. e.g. <code>summary(x, pos = 1:5)</code>. The summary can
be exported as a separate dataframe by passing <code>export = TRUE</code>.
</p>
</li>
<li> <p><code>mean()</code>: calculates the mean of all rates, or those specified by the <code>pos</code>
input. e.g. <code>mean(x, pos = 1:5)</code> The mean can be exported as a separate value
by passing <code>export = TRUE</code>.
</p>
</li>
</ul>
<h4>More</h4>

<p>For additional help, documentation, vignettes, and more visit the <code>respR</code>
website at <a href="https://januarharianto.github.io/respR/">https://januarharianto.github.io/respR/</a>
</p>



<h3>Value</h3>

<p>Output is a <code>list</code> object of class <code>calc_rate.bg</code> containing original
data, linear models, summary information, and the primary output of
interest <code style="white-space: pre;">⁠$rate.bg⁠</code>, which contains a rate for each oxygen column present
in the input data. There is also <code style="white-space: pre;">⁠$rate.bg.mean⁠</code> containing the mean of all
background rates. Note, this is not used in <code>adjust_rate</code>, where the
<code>method</code> input there determines how <code style="white-space: pre;">⁠$rate.bg⁠</code> is applied, but can easily
be extracted and applied as an adjustment value if desired.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Inspect and calculate background rate from two columns
inspect(urchins.rd, time = 1, oxygen = 18:19) %&gt;%
  calc_rate.bg()

# Same example but enter as a data frame, save as an object and use
# in adjust_rate
bg_rate &lt;- calc_rate.bg(urchins.rd,
                        time = 1,
                        oxygen = 18:19,
                        plot = FALSE)

inspect(urchins.rd, 1, 2, plot = FALSE) %&gt;%
  calc_rate(from = 10, to = 30, by = "time", plot = FALSE) %&gt;%
  adjust_rate(by = bg_rate)

# Subset single column data first before calculating background rate
subset_data(background_con.rd, from = 5000, to = 20000, by = "time") %&gt;%
  calc_rate.bg()
  
</code></pre>


</div>