<div class="container">

<table style="width: 100%;"><tr>
<td>rprior_prob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prior simulation of GEV parameters - prior on probability scale</h2>

<h3>Description</h3>

<p>Simulates from the prior distribution for GEV parameters based on
Crowder (1992), in which independent beta priors are specified
for ratios of probabilities (which is equivalent to
a Dirichlet prior on differences between these probabilities).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rprior_prob(n, quant, alpha, exc = FALSE, lb = NULL, lb_prob = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric scalar. The size of sample required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>A numeric vector of length 3.  Contains quantiles
<code class="reqn">q_1, q_2, q_3</code>.  A prior distribution is placed on the
non-exceedance (<code>exc = FALSE</code>) or exceedance (<code>exc = TRUE</code>)
probabilities corresponding to these quantiles.
The values should <em>increase</em> with the index of the vector.
If not, the values in <code>quant</code> will be sorted into increasing order
without warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric vector of length 4. Parameters of the Dirichlet
distribution for the exceedance probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exc</code></td>
<td>
<p>A logical scalar.  Let <code class="reqn">M</code> be the GEV variable,
<code class="reqn">r_q = P(M \leq q)</code>,
<code class="reqn">p_q = P(M &gt; q) = 1 - r_q</code> and
<code>quant</code> = (<code class="reqn">q_1, q_2, q_3</code>).
If <code>exc = FALSE</code> then a Dirichlet(<code>alpha</code>) distribution is
placed on
<code class="reqn">(r_{q_1}, r_{q_2} - r_{q_1}, r_{q_3} - r_{q_2}, 1 - r_{q_3})</code>, as in
Northrop et al. (2017).
If <code>exc = TRUE</code> then a Dirichlet(<code>alpha</code>) distribution
is placed on
<code class="reqn">(1 - p_{q_1}, p_{q_1} - p_{q_2}, p_{q_2} - p_{q_3}, p_{q_3})</code>, where
<code class="reqn">p_q = P(M &gt; q)</code>, as in Stephenson (2016).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>A numeric scalar.  If this is not <code>NULL</code> then the simulation
is constrained so that <code>lb</code> is an approximate lower bound on the
GEV variable.  Specifically, only simulated GEV parameter values for
which the 100<code>lb_prob</code>% quantile is greater than <code>lb</code> are
retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb_prob</code></td>
<td>
<p>A numeric scalar.  The non-exceedance probability involved
in the specification of <code>lb</code>.  Must be in (0,1).  If <code>lb=NULL</code>
then <code>lb_prob</code> is not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simulation is based on the way that the prior is constructed.
See Stephenson (1996) the evdbayes user guide or Northrop et al. (2017)
Northrop et al. (2017) for details of the construction of the prior.
First, differences between probabilities are simulated from a Dirichlet
distribution. Then the GEV location, scale and shape parameters that
correspond to these quantile values are found, by solving numerically a
set of three non-linear equations in which the GEV quantile function
evaluated at the simulated probabilities is equated to the quantiles in
<code>quant</code>. This is reduced to a one-dimensional optimisation over the
GEV shape parameter.
</p>


<h3>Value</h3>

<p>An <code>n</code> by 3 numeric matrix.
</p>


<h3>References</h3>

<p>Crowder, M. (1992) Bayesian priors based on parameter
transformation using the distribution function.
<em>Ann. Inst. Statist. Math.</em>, <strong>44</strong>(3), 405-416.
<a href="https://link.springer.com/article/10.1007/BF00050695">https://link.springer.com/article/10.1007/BF00050695</a>
</p>
<p>Stephenson, A. 2016. Bayesian Inference for Extreme Value
Modelling. In <em>Extreme Value Modeling and Risk Analysis: Methods and
Applications</em>, edited by D. K. Dey and J. Yan, 257-80. London:
Chapman and Hall. <a href="https://doi.org/10.1201/b19721">doi:10.1201/b19721</a>
</p>
<p>Northrop, P. J., Attalides, N. and Jonathan, P. (2017)
Cross-validatory extreme value threshold selection and uncertainty
with application to ocean storm severity.
<em>Journal of the Royal Statistical Society Series C: Applied
Statistics</em>, <strong>66</strong>(1), 93-120.
<a href="https://doi.org/10.1111/rssc.12159">doi:10.1111/rssc.12159</a>
</p>


<h3>See Also</h3>

<p><code>rpost</code> and <code>rpost_rcpp</code> for sampling
from an extreme value posterior distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R">quant &lt;- c(85, 88, 95)
alpha &lt;- c(4, 2.5, 2.25, 0.25)
x &lt;- rprior_prob(n = 1000, quant = quant, alpha = alpha, exc = TRUE)
x &lt;- rprior_prob(n = 1000, quant = quant, alpha = alpha, exc = TRUE, lb = 0)
</code></pre>


</div>