<div class="container">

<table style="width: 100%;"><tr>
<td>em_estimation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized expectation-maximization algorithm.</h2>

<h3>Description</h3>

<p>Penalized expectation-maximization algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">em_estimation(
  p,
  item_data,
  pred_data,
  prox_data,
  mean_predictors,
  var_predictors,
  item_type,
  theta,
  pen_type,
  tau_vec,
  id_tau,
  num_tau,
  alpha,
  gamma,
  pen,
  pen.deriv,
  anchor,
  final_control,
  samp_size,
  num_items,
  num_responses,
  num_predictors,
  num_quad,
  adapt_quad,
  optim_method,
  estimator_history,
  estimator_limit,
  NA_cases,
  exit_code
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>List of parameters with starting values obtained from preprocess.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item_data</code></td>
<td>
<p>Matrix or data frame of item responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_data</code></td>
<td>
<p>Matrix or data frame of DIF and/or impact predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prox_data</code></td>
<td>
<p>Vector of observed proxy scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_predictors</code></td>
<td>
<p>Possibly different matrix of predictors for the mean
impact equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_predictors</code></td>
<td>
<p>Possibly different matrix of predictors for the
variance impact equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item_type</code></td>
<td>
<p>Character value or vector indicating the type of
item to be modeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Vector of fixed quadrature points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen_type</code></td>
<td>
<p>Character value indicating the penalty function to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau_vec</code></td>
<td>
<p>Vector of tau values that either are automatically generated
or provided by the user. The first <code>tau_vec</code> will be equal to <code>Inf</code>
to identify a minimal value of tau in which all DIF is removed from the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_tau</code></td>
<td>
<p>Logical indicating whether to identify the minimum value of tau
in which all DIF parameters are removed from the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_tau</code></td>
<td>
<p>Numeric value indicating the number of tau values to run
regDIF on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value indicating the alpha parameter in the elastic net
penalty function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Numeric value indicating the gamma parameter in the MCP
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>
<p>Index for the tau vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.deriv</code></td>
<td>
<p>Logical value indicating whether to use the second
derivative of the penalized parameter during regularization. The default is
TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anchor</code></td>
<td>
<p>Optional numeric value or vector indicating which item
response(s) are anchors (e.g., <code>anchor = 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_control</code></td>
<td>
<p>Control parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp_size</code></td>
<td>
<p>Numeric value indicating the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_items</code></td>
<td>
<p>Numeric value indicating the number of items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_responses</code></td>
<td>
<p>Vector with number of responses for each item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_predictors</code></td>
<td>
<p>Numeric value indicating the number of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_quad</code></td>
<td>
<p>Numeric value indicating the number of quadrature points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt_quad</code></td>
<td>
<p>Logical value indicating whether to use adaptive quad.
needs to be identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_method</code></td>
<td>
<p>Character value indicating the type of optimization
method to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator_history</code></td>
<td>
<p>List to save EM iterations for supplemental EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator_limit</code></td>
<td>
<p>Logical value indicating whether the EM algorithm reached
the maxit limit in the previous estimation round.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NA_cases</code></td>
<td>
<p>Logical vector indicating if observation is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exit_code</code></td>
<td>
<p>Integer indicating if the model has converged properly.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>"list"</code> of matrices with unprocessed model estimates
</p>


</div>