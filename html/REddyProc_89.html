<div class="container">

<table style="width: 100%;"><tr>
<td>sEddyProc_sEstimateUstarScenarios</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>sEddyProc sEstimateUstarScenarios</h2>

<h3>Description</h3>

<p>Estimate the distribution of u* threshold by bootstrapping over data</p>


<h3>Usage</h3>

<pre><code class="language-R">sEddyProc_sEstimateUstarScenarios(ctrlUstarEst = usControlUstarEst(), 
    ctrlUstarSub = usControlUstarSubsetting(), 
    UstarColName = "Ustar", NEEColName = "NEE", 
    TempColName = "Tair", RgColName = "Rg", 
    ..., seasonFactor = usCreateSeasonFactorMonth(sDATA$sDateTime), 
    nSample = 200L, probs = c(0.05, 0.5, 
        0.95), isVerbose = TRUE, suppressWarningsAfterFirst = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ctrlUstarEst</code></td>
<td>
<p>control parameters
for estimating uStar on a single binned series,
see <code>usControlUstarEst</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrlUstarSub</code></td>
<td>
<p>control parameters
for subsetting time series (number of temperature and Ustar classes
...), see <code>usControlUstarSubsetting</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UstarColName</code></td>
<td>
<p>column name for UStar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NEEColName</code></td>
<td>
<p>column name for NEE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TempColName</code></td>
<td>
<p>column name for air temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RgColName</code></td>
<td>
<p>column name for solar radiation for
omitting night time data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to <code>sEddyProc_sEstUstarThreshold</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seasonFactor</code></td>
<td>
<p>factor of
seasons to split (data is resampled only within the seasons)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSample</code></td>
<td>
<p>the number of repetitions in the bootstrap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>the quantiles of the bootstrap sample
to return. Default is the 5%, median and 95% of the bootstrap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isVerbose</code></td>
<td>
<p>set to FALSE to omit printing progress</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppressWarningsAfterFirst</code></td>
<td>
<p>set to FALSE to show also warnings
for all bootstrap estimates instead of only the first bootstrap sample</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The choice of the criterion for sufficiently turbulent conditions
(u * &gt; chosen threshold)
introduces large uncertainties in calculations based on gap-filled Eddy data.
Hence, it is good practice to compare derived quantities based on
gap-filled data using a range of u * threshold estimates.
</p>
<p>This method explores the probability density of the threshold by
repeating its estimation
on a bootstrapped sample.
By default it returns the 90% confidence interval (argument <code>probs</code>).
For larger intervals the sample number need to be
increased (argument <code>probs</code>).
</p>
<dl>
<dt>Quality Assurance</dt>
<dd>
<p>If more than <code>ctrlUstarEst$minValidBootProp</code>
(default 40%) did not report a threshold,
no quantiles (i.e. NA) are reported.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>updated class. Request results by
<code>sEddyProc_sGetEstimatedUstarThresholdDistribution</code></p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code>sEddyProc_sEstUstarThold</code>
, <code>sEddyProc_sGetEstimatedUstarThresholdDistribution</code>
, <code>sEddyProc_sSetUstarScenarios</code>
, <code>sEddyProc_sMDSGapFillUStarScens</code></p>


</div>