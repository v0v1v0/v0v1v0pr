<div class="container">

<table style="width: 100%;"><tr>
<td>horizonplot-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Horizon plots of Raster objects.</h2>

<h3>Description</h3>

<p>This method draws horizon graphs for each zone as
calculated with <code>zonal</code> from the directions defined by
<code>xyLayer</code></p>


<h3>Usage</h3>

<pre><code class="language-R">
## S4 method for signature 'RasterStackBrick,missing'
horizonplot(x, data = NULL,
    dirXY = y, stat = 'mean', digits = 0,
    origin = mean, 
    xlab = 'Time', ylab = 'direction',
    colorkey = TRUE, colorkey.digits = 1,
    scales=list(y = list(relation = "same")),
    ...)

## S4 method for signature 'SpatRaster,missing'
horizonplot(x, data = NULL,
    dirXY = y, stat = 'mean', digits = 0,
    origin = mean, 
    xlab = 'Time', ylab = 'direction',
    colorkey = TRUE, colorkey.digits = 1,
    scales=list(y = list(relation = "same")),
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>RasterStackBrick</code> object or a <code>SpatRaster</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code>xyLayer</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>a function to be applied to summarize the values by
zone. See <code>zonal</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>An integer, number of digits for <code>zonal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>From the <code>latticeExtra</code> help page: "the baseline y
value for the first (positive) segment (i.e. the value at
which red changes to blue)." It can be: a number, used acrros
all panels, or a function (or a character defining a
function), evaluated with the values in each panel. The
default is the <code>mean</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Labels of the axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorkey</code></td>
<td>
<p>If <code>colorkey = TRUE</code> a suitable color scale bar is
constructed using the values of <code>origin</code> and
<code>horizonscale</code> (see below). For additional information
see <code>levelplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorkey.digits</code></td>
<td>
<p>Digits for rounding values in <code>colorkey</code>
labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>From the <code>lattice::xyplot</code> help page: "A list
determining how the x- and y-axes (tick marks and labels) are
drawn.  The list contains parameters in <code>name=value</code>
form, and may also contain two other lists called <code>x</code> and
<code>y</code> of the same form.  Components of <code>x</code> and
<code>y</code> affect the respective axes only, while those in
<code>scales</code> affect both.  When parameters are specified in
both lists, the values in <code>x</code> or <code>y</code> are used." In
<code>horizonplot</code> the most interesting component is
<code>relation</code>, a character string that determines how axis
limits are calculated for each panel.  Possible values are
<code>"same"</code> (default), <code>"free"</code> and <code>"sliced"</code>.
"For ‘relation="same"’, the same limits,
usually large enough to encompass all the data, are used for
all the panels.  For ‘relation="free"’, limits for each panel
is determined by just the points in that panel.  Behavior for
‘relation="sliced"’ is similar, except that the length (max -
min) of the scales are constrained to remain the same across
panels."</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for the <code>horizonplot</code>
function. <code>horizonscale</code> is the most interesting, being (from
the <code>latticeExtra</code> help page) "the scale of each color
segment. There are 3 positive segments and 3 negative segments. If
this is a given as a number then all panels will have comparable
distances, though not necessarily the same actual values (similar in
concept to ‘scales$relation = "sliced"’)". On the other hand,
<code>col.regions</code> is used to choose the color scale.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>(Extracted from the reference): "The horizon graph allows to
examine how a large number of items changed through time, to spot
extraordinary behaviors and predominant patterns, view each of the
items independently from the others when they wish, make comparisons
between the items, and view changes that occurred with enough
precision to determine if further examination is required."</p>


<h3>References</h3>

<p><a href="http://vis.berkeley.edu/papers/horizon/2009-TimeSeries-CHI.pdf">http://vis.berkeley.edu/papers/horizon/2009-TimeSeries-CHI.pdf</a>
</p>


<h3>See Also</h3>

 <p><code>horizonplot</code>,
<code>xyplot</code>, <code>levelplot</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(raster)
library(terra)
library(zoo)

url &lt;- "ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/"
sst.dat = read.table(paste(url, "SST011970_032003.dat", sep=''), header = FALSE) 
sst.ll = read.table(paste(url, "SSTlonlat.dat", sep=''), header = FALSE)

spSST &lt;- SpatialPointsDataFrame(sst.ll, sst.dat)
gridded(spSST) &lt;- TRUE
proj4string(spSST) = "+proj=longlat +datum=WGS84"
SST &lt;- brick(spSST)

idx &lt;- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month')
idx &lt;- as.yearmon(idx)
SST &lt;- setZ(SST, idx)
names(SST) &lt;- as.character(idx)

horizonplot(SST)

horizonplot(SST, stat='sd')

## Different scales for each panel, with colors representing deviations
## from the origin in *that* panel
horizonplot(SST, scales=list('free'))

## origin may be a function...
horizonplot(SST, origin=mean)
## ...or a number
horizonplot(SST, origin=0)

## A different color palette
pal &lt;- RColorBrewer::brewer.pal(n=6, 'PuOr')
horizonplot(SST, origin = 0, col.regions = pal)

## The width of each color segment can be defined with horizonscale
horizonplot(SST, horizonscale=1, origin=0)

## End(Not run)

## Not run: 

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

horizonplot(SISmm)

## End(Not run)


</code></pre>


</div>