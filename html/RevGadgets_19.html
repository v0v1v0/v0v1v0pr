<div class="container">

<table style="width: 100%;"><tr>
<td>plotPostPredStats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot Posterior Predictive Statistics</h2>

<h3>Description</h3>

<p>Plots the posterior predictive statistics data
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotPostPredStats(
  data,
  prob = c(0.9, 0.95),
  col = NULL,
  side = "both",
  type = "strict",
  PPES = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(list of data frames; no default) A list of data frames
of the empirical and simulated values, such as the output of
processPostPredStats.R</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>(vector of numerics; default c(0.9, 0.95)) The
posterior-predictive intervals to shade.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>(vector of colors; default NULL) The colors for each quantile.
Defaults to blue and red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>(character; default "both") Whether the plotted/colored 
intervals are on "both" sides, the "left" side, or the "right" 
side of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>(character; default "strict") Whether equal values are
considered as less extreme as the observed data ("strict") or half of the
equal values are considered to be higher and half to be lower ("midpoint")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPES</code></td>
<td>
<p>(boolean; default FALSE) Whether we provide the posterior
predictive effect size (PPES).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments are passed to stats::density().</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces one ggplot object per metric. Intended
to plot the results of the RevBayes tutorial:
Assessing Phylogenetic Reliability Using RevBayes and P3
Model adequacy testing using posterior prediction (Data Version).
</p>
<p>Each plot shows the rejection region for the provided quantiles,
as well as a p-value for the observed statistic. If side="left" (or "right"),
then the p-value is the fraction of simulated statistics that are less than
( or greater than) or equal to the observed statistic. If side="both", then
the p-value is calculated by first fitting a KDE to the samples, then
computing the fraction of simulated statistics with density lower than the
density of he observed statistic; in this sense, the "both" option computes
the size of HPD defined by the observed statistic.
</p>


<h3>Value</h3>

<p>A list of ggplot objects, where each plot contains a density
distribution of the predicted values and a dashed line of the empirical
value. The blue shaded region of the density plot corresponds to the 5%
two-sided quantile and the orange corresponds to the 2% two-sided quantile.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# download the example datasets to working directory

url_emp &lt;-
   "https://revbayes.github.io/tutorials/intro/data/empirical_data_pps_example.csv"
dest_path_emp &lt;- "empirical_data_pps_example.csv"
download.file(url_emp, dest_path_emp)

url_sim &lt;-
   "https://revbayes.github.io/tutorials/intro/data/simulated_data_pps_example.csv"
dest_path_sim &lt;- "simulated_data_pps_example.csv"
download.file(url_sim, dest_path_sim)

# to run on your own data, change this to the path to your data file
file_sim &lt;- dest_path_sim
file_emp &lt;- dest_path_emp

t &lt;- processPostPredStats(path_sim = file_sim,
                         path_emp = file_emp)
plots &lt;- plotPostPredStats(data = t)
plots[[1]]

# remove files
# WARNING: only run for example dataset!
# otherwise you might delete your data!
file.remove(dest_path_sim, dest_path_emp)



</code></pre>


</div>