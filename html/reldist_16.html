<div class="container">

<table style="width: 100%;"><tr>
<td>reldist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inference for Relative Distributions</h2>

<h3>Description</h3>

<p>Estimate and graph relative distribution and density functions for continuous or discrete data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reldist(y, yo=FALSE, ywgt=FALSE,yowgt=FALSE,
  show="none", decomp="locadd",
  location="median", scale="IQR",
  rpmult=FALSE, 
  z=FALSE, zo=FALSE,
  smooth = 0.35, 
  quiet = TRUE, 
  cdfplot=FALSE,
  ci=FALSE,
  bar="no",
  add=FALSE,
  graph=TRUE, type="l",
  xlab="Reference proportion",ylab="Relative Density",yaxs="r",
  yolabs=pretty(yo), yolabslabs=NULL, 
  ylabs=pretty(y), ylabslabs=NULL,
  yolabsloc=0.6, ylabsloc=1, 
  ylim=NULL, cex=0.8, lty=1,
  binn=5000,
  aicc=seq(0.0001, 5, length=30),
  deciles=(0:10)/10,
  discrete=FALSE,
  method="Bayes",
  y0=NULL,
  control = list(samples = 4000, burnin = 1000),
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Sample from comparison distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yo</code></td>
<td>
<p>Sample from reference distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrete</code></td>
<td>
<p>Do <code>y</code> and <code>yo</code> refer to a 
discrete distribution? If <code>TRUE</code> a discrete estimator is 
used instead of the default continuous one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>Degree of smoothness required in the fit.
Higher values lead to smoother curves, lower positive
values lead to closer fits to the observed data.  If it is
not specified the value that minimizes GCV is used. If a
value less than zero is specified then the value is chosen
to minimize a corrected AIC. If <code>discrete=TRUE</code>
it is the minimum number of values to pool in the reference
distribution in the probability mass function estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used to estimate the relative density. The default
(<code>"Bayes"</code>) uses a density estimator based on Poisson Nonparametric Regression and Bayesian inference developed by Wand and Wu (2022).
The option (<code>"bgk"</code>) uses a Gaussian kernel density estimator for bounded
domain one-dimensional data developed by Botev, Grotowski and Kroese
(2010). The option (<code>"gam"</code>) uses a local likelihood approach
based on smoothed Poisson regression. The option <code>"loclik"</code> uses
log-splines. The option <code>"quick"</code> uses the Anscombe transformation
to stabilize variances. In versions prior to 1.3 the <code>"quick"</code>
approach was used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>Graph the results on the current device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar</code></td>
<td>
<p>Graph the deciles on the current device.  Possible values
of <code>bar</code> are <code>"no"</code> (no deciles plotted), <code>"yes"</code>
(deciles plotted with the non-parametric fit,<br><code>"only"</code>(deciles plotted without non-parametric fit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Add the density to the current plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>plotting limit for the vertical axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Line type to be used for the density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Horizontal label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Vertical label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabs</code></td>
<td>
<p>Locations for label to be added to the right axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabslabs</code></td>
<td>
<p>Labels indicating the original scale for the
comparison distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabsloc</code></td>
<td>
<p>Distance of labels to right of axis (in lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yolabs</code></td>
<td>
<p>locations for labels to be added to the tip axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yolabslabs</code></td>
<td>
<p>Labels indicating the original scale for the
reference distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yolabsloc</code></td>
<td>
<p>Distance of labels above axis (in lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxs</code></td>
<td>
<p>Style of vertical axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdfplot</code></td>
<td>
<p>calculate and plot the CDF rather than the density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Should the output be returned invisibly?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Plot (pointwise) 95% confidence intervals?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ywgt</code></td>
<td>
<p>Weights on the comparison sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yowgt</code></td>
<td>
<p>Weights on the reference sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Covariate on the comparison sample to be used to adjust it
to the reference distribution. Only used if the form of matching 
specified in<br><code>decomp="covariate"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zo</code></td>
<td>
<p>Covariate on the reference sample to be used in
the adjustment.  to the reference distribution. Only used if
the form of matching specified in<br><code>decomp="covariate"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>Type of relative distribution to produce.  Possible values
are <code>"none"</code> (comparisons to reference), <code>residual</code>
(location-matched reference to reference), <code>effect</code> (comparison
to location-matched reference).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decomp</code></td>
<td>
<p>Form of matching to the comparison sample.  Possible
values are <code>locmult</code> (multiplicatively scale the reference),
<code>locadd</code> (additively shift the reference), <code>lsadd</code>
(location/scale additive shift), <code>covariate</code> (covariate adjust
the reference (requires z and zo to be specified)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>How to measure location.  Possible values are
<code>"mean"</code> and <code>"median"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>How to measure the scale.  Possible values are
<code>"standev"</code> (standard deviation) and <code>IQR</code> (interquartile
range).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rpmult</code></td>
<td>
<p>Only in calculation of polarization indices:
multiplicatively scale the reference sample to the comparison sample
before comparing the two distributions?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binn</code></td>
<td>
<p>Number of bins used in the smoother.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deciles</code></td>
<td>
<p>The percentiles used for the histogram bins. Typically
deciles (i.e., 0.0, 0.1, 0.2,...,0.9, 1.0), but any set can be used
(e.g., quintiles, terciles).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aicc</code></td>
<td>
<p>Values of the smoothing parameter to search
over in minimizing the corrected AIC. Only used if 
<code>method="gam"</code> and <code>smooth</code> is less than 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of plot to use. See <code>par()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Character expansion to use in plots. See <code>par()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>A test to see if <code>yo</code> was passed. If <code>y0</code> is passed 
it prints a warning.  If <code>y0</code> is passed and <code>yo</code> is not passed 
then <code>y0</code> is used as the sample from reference distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list; A simple list of control options for the STAN HMC computation used when <code>method="Bayes"</code>, the default.
The two components are <code>samples=4000</code>, the number of samples drawn and <code>burnin=1000</code>, the burn-in used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to the plot functions. See <code>par()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Horizontal coordinates for the density (typically
percentages).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Density at x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rp</code></td>
<td>
<p>95% confidence interval for the median relative
polarization as lower bound, estimate, upper bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rpl</code></td>
<td>
<p>95% confidence interval for the lower relative
polarization as lower bound, estimate, upper bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rpu</code></td>
<td>
<p>95% confidence interval for the upper relative
polarization as lower bound, estimate, upper bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdf</code></td>
<td>
<p>x coordinates for the CDF (typically percentages) and y CDF
at x.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Most of the code is for the plotting and tinkering.  The guts of the
method are forming the relative data at the top.  The rest is a
standard fixed interval density estimation with a few bells and
whistles.</p>


<h3>References</h3>

<p>For more examples see the tech report
</p>
<p>Mark S. Handcock and Eric Mark Aldrich <em>Applying Relative Distribution Methods in R</em>
University of Washington CSSS Working Paper No.
27, Available at SSRN: <a href="https://doi.org/10.2139/ssrn.1515775">doi:10.2139/ssrn.1515775</a>.
</p>
<p>Z. I. Botev, J. F. Grotowski and D. P. Kroese
<em>Kernel Density Estimation Via Diffusion</em>
Annals of Statistics, 2010, Volume 38, Number 5, Pages 2916-2957.
</p>
<p>M. Wand and J. C. F. Yu
<em>Density Estimation via Bayesian Inference Engines</em>
AStA Advances in Statistical Analysis, 2021, <a href="https://doi.org/10.1007/s10182-021-00422-8">doi:10.1007/s10182-021-00422-8</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# First load the data.
#

data(nls, package="reldist")

#
# A simple example comparing permanent wages of the original to the
# recent cohort in the NLS.  See H&amp;M (1999) for details.

reldist(y=recent$chpermwage,yo=original$chpermwage,method="bgk")

#
# A more sophisticated version of the same.
#

reldist(y=recent$chpermwage, yo=original$chpermwage,
        yowgt=original$wgt, ywgt=recent$wgt,      
        bar=TRUE,                                   
        smooth=0.1, method="bgk",                             
        yolabs=seq(-1, 3, by=0.5),                 
        ylim=c(0, 3.0),cex=0.8,                   
        ylab="Relative Density",                 
        xlab="Proportion of the Original Cohort")

#
# A CDF version.
#

reldist(y=recent$chpermwage, yo=original$chpermwage,
    yowgt=original$wgt, ywgt=recent$wgt,      
    cdfplot=TRUE,                               
    smooth=0.4,                              
    yolabs=seq(-1,3,by=0.5),                 
    ylabs=seq(-1,3,by=0.5),                  
    cex=0.8,                                 
    method="bgk",                             
    ylab="proportion of the recent cohort",  
    xlab="proportion of the original cohort")
</code></pre>


</div>