<div class="container">

<table style="width: 100%;"><tr>
<td>select_PSU</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Select sample of primary stage units (PSU)
</h2>

<h3>Description</h3>

<p>Select sample of primary stage units (PSU) on the basis of the PSU allocated in the allocation step.
</p>


<h3>Usage</h3>

<pre><code class="language-R">     select_PSU(alloc, type="ALLOC", pps=TRUE, plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alloc</code></td>
<td>
<p>Output of the allocation step (beat.st)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of SSU allocation ("ALLOC" = optimal, "PROP" = proportional to population size, "EQUAL" = equal size in each stratum)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pps</code></td>
<td>
<p>Type of PSU selection in strata (pps = TRUE –&gt; proportional to size, pps= FALSE–&gt; simple random sampling)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If TRUE, a plot of PSUs and SSUs ditribution is produced</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list including: universe_PSU, sample_PSU
</p>


<h3>Author(s)</h3>

<p>Alessio Guandalini</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(readr)
pop &lt;- read_rds("https://github.com/barcaroli/R2BEAT_workflows/blob/master/pop.RDS?raw=true")
library(R2BEAT)
cv &lt;- as.data.frame(list(DOM=c("DOM1","DOM2"),
                         CV1=c(0.02,0.03),
                         CV2=c(0.03,0.06),
                         CV3=c(0.03,0.06),
                         CV4=c(0.05,0.08)))
cv
samp_frame &lt;- pop
samp_frame$one &lt;- 1
id_PSU &lt;- "municipality"  
id_SSU &lt;- "id_ind"        
strata_var &lt;- "stratum"   
target_vars &lt;- c("income_hh","active","inactive","unemployed")   
deff_var &lt;- "stratum"     
domain_var &lt;- "region"  
delta =  1       # households = survey units
minimum &lt;- 50    # minimum number of SSUs to be interviewed in each selected PSU
deff_sugg &lt;- 1.5 # suggestion for the deff value

inp &lt;- prepareInputToAllocation1(samp_frame,
                                  id_PSU,
                                  id_SSU,
                                  strata_var,
                                  target_vars,
                                  deff_var,
                                  domain_var,
                                  minimum,
                                  delta,
                                  deff_sugg)
inp$desfile$MINIMUM &lt;- 50
alloc &lt;- beat.2st(stratif = inp$strata, 
                   errors = cv, 
                   des_file = inp$des_file, 
                   psu_file = inp$psu_file, 
                   rho = inp$rho, 
                   deft_start = NULL,
                   effst = inp$effst, 
                   minPSUstrat = 2,
                   minnumstrat = 50
)
sample_1st &lt;- select_PSU(alloc, type="ALLOC", pps=TRUE, plot=TRUE)
sample_1st$PSU_stats

## End(Not run)
</code></pre>


</div>