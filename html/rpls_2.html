<div class="container">

<table style="width: 100%;"><tr>
<td>PRM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust PLS</h2>

<h3>Description</h3>

<p>Robust PLS by partial robust M-regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PRM(formula,data,a,wfunX,wfunY,center.type,scale.type,usesvd,numit,prec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame which contains the variables given in formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>number of PLS components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wfunX</code></td>
<td>
<p>weight function to downweight leverage points; predefined weight funcktions "Fair", "Huber", "Tukey" and "Hampel" with respective tuning constants are passed via a list object, e.g. list("Fair",0.95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wfunY</code></td>
<td>
<p>weight function to downweight residuals; predefined weight funcktions "Fair", "Huber", "Tukey" and "Hampel" with respective tuning constants are passed via a list object, e.g. list("Fair",0.95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.type</code></td>
<td>
<p>type of centering of the data in form of a string that matches an R function, e.g. "median"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.type</code></td>
<td>
<p>type of scaling for the data in form of a string that matches an R function, e.g. "qn" or alternatively "no" for no scaling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numit</code></td>
<td>
<p>the number of maximal iterations for the convergence of the coefficient estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>a value for the precision of estimation of the coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usesvd</code></td>
<td>
<p>if TRUE singular value decomposition is performed; logical, default is FALSE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>M regression is used to robustify PLS. Employment of seperate weight functions for leverage points and residuals.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>vector with regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>coefficient for intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wy</code></td>
<td>
<p>vector of length(y) with residual weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>vector of length(y) with weights for leverage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>overall weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>matrix with PLS X-scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>matrix with PLS X-loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>vector with fitted y-values</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Filzmoser &lt;peter.filzmoser@tuwien.ac.at&gt;</p>


<h3>References</h3>

<p>S. Serneels, C. Croux, P. Filzmoser, and P.J. Van Espen.
Partial robust M-regression. Chemometrics and Intelligent Laboratory System, Vol. 79(1-2), pp. 55-64, 2005.</p>


<h3>Examples</h3>

<pre><code class="language-R">U &lt;- c(rep(2,20), rep(5,30))
X &lt;- replicate(6, U+rnorm(50))
beta &lt;- c(rep(1, 3), rep(-1,3))
e &lt;- c(rnorm(45,0,1.5),rnorm(5,-20,1))
y &lt;- X%*%beta + e
d &lt;- as.data.frame(X)
d$y &lt;- y
res &lt;- PRM(y~., data=d, 3, wfunX=list("Fair",0.95),
wfunY=list("Fair",0.95), center.type = "median",
scale.type = "no",usesvd = FALSE,
numit = 100, prec = 0.01)
res$coef
</code></pre>


</div>