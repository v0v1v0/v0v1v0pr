<div class="container">

<table style="width: 100%;"><tr>
<td>xform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain or replace the “xform” transforms for an image</h2>

<h3>Description</h3>

<p>These functions convert the “qform” or “sform” information in a NIfTI
header to or from a corresponding affine matrix. These two “xform”
mechanisms are defined by the NIfTI standard, and may both be in use in a
particular image header. They define the relationship between the storage
order of the image and real space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">xform(image, useQuaternionFirst = TRUE)

qform(x) &lt;- value

sform(x) &lt;- value

orientation(x, useQuaternionFirst = TRUE)

orientation(x) &lt;- value

rotation(x, useQuaternionFirst = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>image, x</code></td>
<td>
<p>An image, in any acceptable form (see <code>asNifti</code>),
or a 4x4 numeric xform matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useQuaternionFirst</code></td>
<td>
<p>A single logical value. If <code>TRUE</code>, the
“qform” matrix will be used first, if it is defined; otherwise the
“sform” matrix will take priority.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>A new 4x4 qform or sform matrix, or orientation string. If a
matrix has a <code>"code"</code> attribute, the appropriate qform or sform code
is also set.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Image orientation is indicated using a three-character string, with each
character indicating the approximate world-space direction of the positive
axes in the first, second and third dimensions, in order. Each character may
be ‘R’ for left-to-right, ‘L’ for right-to-left, ‘A’ for posterior-to-
anterior, ‘P’ for anterior-to-posterior, ‘S’ for inferior-to-superior, or
‘I’ for superior-to-inferior. The default for NIfTI is RAS, meaning that the
first dimension points towards the right, the second towards the front and
the third towards the top. An xform matrix is an affine transform relative
to that default.
</p>
<p>The upper-left 3x3 matrix in a 3D affine transform governs scale, rotation
and skew, while the last column is a translation. (The <code>rotation</code>
function extracts the rotation part alone.) The final row is always
(0,0,0,1). Reorienting an image involves permuting and possibly reversing
some of the axes, both in the data and the metadata. The sense of the
translation may also need to be reversed, but this is only possible if the
image dimensions are known.
</p>


<h3>Value</h3>

<p>For <code>xform</code>, an affine matrix corresponding to the “qform”
or “sform” information in the image header, with an <code>"imagedim"</code>
attribute giving the original image dimensions and a <code>"code"</code>
attribute giving the corresponding xform code. For <code>orientation</code>, a
string with three characters indicating the (approximate) orientation of
the image. The replacement forms return the modified object.
</p>


<h3>Note</h3>

<p>The qform and sform replacement functions are for advanced users only.
Modifying the transforms without knowing what you're doing is usually
unwise, as you can make the image object inconsistent.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>References</h3>

<p>The NIfTI-1 standard (<a href="https://www.nitrc.org/docman/view.php/26/64/nifti1.h">https://www.nitrc.org/docman/view.php/26/64/nifti1.h</a>)
is the definitive reference on “xform” conventions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">im &lt;- readNifti(system.file("extdata", "example.nii.gz", package="RNifti"))
xform(im)

# Remove the qform information
qform(im) &lt;- structure(diag(4), code=0L)

# The same as above, since the sform is unmodified
xform(im)

# The identity matrix corresponds to RAS orientation
orientation(diag(4))

</code></pre>


</div>