<div class="container">

<table style="width: 100%;"><tr>
<td>r2_var</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>r2_var function</h2>

<h3>Description</h3>

<p>This function estimates var(R2(y~x[,v1]))
where R2 is the R squared value of the model,
where R2 is the R squared value of the model,
y is N by 1 matrix having the dependent variable, and
x is N by M matrix having M explanatory variables.
v1 indicates the ith column in the x matrix
(v1 can be multiple values between 1 - M, see Arguments below)
</p>


<h3>Usage</h3>

<pre><code class="language-R">r2_var(dat, v1, nv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>N by (M+1) matrix having variables in the order of cbind(y,x)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v1</code></td>
<td>
<p>This can be set as v1=c(1), v1=c(1,2) or possibly with more values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nv</code></td>
<td>
<p>Sample size</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function will test the null hypothesis for R2. To get the test statistics for R2(y~x[,v1]). The outputs are listed as follows.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rsq</code></td>
<td>
<p>R2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Variance of R2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2_based_p</code></td>
<td>
<p>P-value under the null hypothesis, i.e. R2=0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_r2</code></td>
<td>
<p>Upper limit of 95% CI for R2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_r2</code></td>
<td>
<p>Lower limit of 95% CI for R2</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
#To get the test statistics for R2(y~x[,1])
dat=dat1
nv=length(dat$V1)
v1=c(1)
output=r2_var(dat,v1,nv)
output

#r2redux output

#output$rsq (R2)
#0.03836254

#output$var (variance of R2) 
#0.0001436128

#output$r2_based_p (P-value under the null hypothesis, i.e. R2=0)
#1.188162e-10

#output$upper_r2 (upper limit of 95% CI for R2)
#0.06433782

#output$lower_r2 (lower limit of 95% CI for R2)
#0.01764252


#To get the test statistic for R2(y~x[,1]+x[,2]+x[,3])

dat=dat1
nv=length(dat$V1)
v1=c(1,2,3) 
r2_var(dat,v1,nv)

#r2redux output

#output$rsq (R2)
#0.03836254

#output$var (variance of R2)
#0.0001436128

#output$r2_based_p (R2 based P-value)
#1.188162e-10

#output$upper_r2 (upper limit of 95% CI for R2)
#0.06433782

#output$lower_r2 (lower limit of 95% CI for R2)
#0.0176425


#When comparing two independent sets of PGSs 
#Letâ€™s assume dat1$V1 and dat2$V2 are independent for this example
#(e.g. male PGS vs. female PGS)

nv=length(dat1$V1)
v1=c(1)
output1=r2_var(dat1,v1,nv)
nv=length(dat2$V1)
v1=c(1)
output2=r2_var(dat2,v1,nv)

#To get the difference between two independent sets of PGSs 
r2_diff_independent=abs(output1$rsq-output2$rsq)

#To get the variance of the difference between two independent sets of PGSs 
var_r2_diff_independent= output1$var+output2$var
sd_r2_diff_independent=sqrt(var_r2_diff_independent)

#To get p-value (following eq. 15 in the paper)
chi=r2_diff_independent^2/var_r2_diff_independent
p_value=pchisq(chi,1,lower.tail=FALSE)
#to get 95% CI (following eq. 15 in the paper)
uci=r2_diff_independent+1.96*sd_r2_diff_independent
lci=r2_diff_independent-1.96*sd_r2_diff_independent
</code></pre>


</div>