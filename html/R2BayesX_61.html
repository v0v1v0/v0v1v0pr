<div class="container">

<table style="width: 100%;"><tr>
<td>plotblock</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Factor Variable and Random Effects Plots
</h2>

<h3>Description</h3>

<p>Function to plot effects for model terms including factor, or group variables for random effects, 
typically used for objects created within <code>bayesx</code> or <code>read.bayesx.output</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotblock(x, residuals = FALSE, range = c(0.3, 0.3), 
  col.residuals = "black", col.lines = "black", c.select = NULL, 
  fill.select = NULL , col.polygons = NULL, data = NULL,
  shift = NULL, trans = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a <code>list</code> of length of the unique factors, where each <code>list</code> element 
contains the estimated effects for one factor as a matrix, see <code>fitted.bayesx</code>, or 
one data matrix with first column as the group or factor variable. Also formulas are accepted, 
e.g it is possible to specify the plot with <code>f ~ x</code> or <code>f1 + f2 ~ x</code>. By convention, 
the covariate for which effects should be plotted, is always in the first column in the 
resulting data matrix, that is used for plotting, i.e. in the second formula example, the data 
matrix is <code>cbind(x, f1, f2)</code>, also see argument <code>c.select</code> and <code>fill.select</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>if set to <code>TRUE</code>, partial residuals will be plotted if available. Partial
residuals may be set as an <code>attr</code>ibute of <code>x</code> named 
<code>"partial.resids"</code>, where the partial residuals must be a matrix with first column 
specifying the covariate, and second column the partial residuals that should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p><code>numeric</code> vector, specifying the left and right bound of the block.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.residuals</code></td>
<td>
<p>the color of the partial residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.lines</code></td>
<td>
<p>vector of maximum length of columns of <code>x</code> minus 1, specifying the color of 
the lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.select</code></td>
<td>
<p><code>integer</code> vector of maximum length of columns of <code>x</code>, selects the 
columns of the resulting data matrix that should be used for plotting. E.g. if <code>x</code> has 5 
columns, then <code>c.select = c(1, 2, 5)</code> will select column 1, 2 and 5 for plotting. Note that 
first element of <code>c.select</code> should always be 1, since this is the column of the covariate 
the effect is plotted for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.select</code></td>
<td>
<p><code>integer</code> vector, select pairwise the columns of the resulting data matrix 
that should form one polygon with a certain background color specified in argument <code>col</code>. 
E.g. <code>x</code> has three columns, or is specified with formula <code>f1 + f2 ~ x</code>, then setting 
<code>fill.select = c(0, 1, 1)</code> will draw a polygon with <code>f1</code> and <code>f2</code> as boundaries. 
If <code>x</code> has five columns or the formula is e.g. <code>f1 + f2 + f3 + f4 ~ x</code>, then setting
<code>fill.select = c(0, 1, 1, 2, 2)</code>, the pairs <code>f1</code>, <code>f2</code> and <code>f3</code>, <code>f4</code>
are selected to form two polygons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.polygons</code></td>
<td>
<p>specify the background color for the upper and lower confidence bands, e.g. 
<code>col = c("green", "red")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>if <code>x</code> is a formula, a <code>data.frame</code> or <code>list</code>. By default the variables 
are taken from <code>environment(x)</code>: typically the environment from which <code>plotblock</code> is 
called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>numeric. Constant to be added to the smooth before plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>function to be applied to the smooth before plotting, e.g., to transform the
plot to the response scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters, please see the details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>plotblock</code> draws for every factor or group the effect as a "block" in one graphic, 
i.e. similar to boxplots, estimated fitted effects, e.g. containing quantiles for <code>MCMC</code> 
estimated models, are drawn as one block, where the upper lines represent upper quantiles, the 
middle line the mean or median, and lower lines lower quantiles, also see the examples. The 
following graphical parameters may be supplied additionally:
</p>

<ul>
<li> <p><code>cex</code>: specify the size of partial residuals,
</p>
</li>
<li> <p><code>lty</code>: the line type for each column that is plotted, e.g. <code>lty = c(1, 2)</code>,
</p>
</li>
<li> <p><code>lwd</code>: the line width for each column that is plotted, e.g. <code>lwd = c(1, 2)</code>,
</p>
</li>
<li> <p><code>poly.lty</code>: the line type to be used for the polygons,
</p>
</li>
<li> <p><code>poly.lwd</code>: the line width to be used for the polygons,
</p>
</li>
<li> <p><code>density</code> <code>angle</code>, <code>border</code>: see <code>polygon</code>,
</p>
</li>
<li> <p><code>...</code>: other graphical parameters, see function <code>plot</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Nikolaus Umlauf, Thomas Kneib, Stefan Lang, Achim Zeileis.
</p>


<h3>See Also</h3>

<p><code>plot.bayesx</code>, <code>bayesx</code>, <code>read.bayesx.output</code>, 
<code>fitted.bayesx</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate some data
set.seed(111)
n &lt;- 500

## regressors
dat &lt;- data.frame(fac = factor(rep(1:10, n/10)))

## response
dat$y &lt;- with(dat, 1.5 + c(2.67, 5, 6, 3, 4, 2, 6, 7, 9, 7.5)[fac] + 
  rnorm(n, sd = 0.6))

## Not run: 
## estimate model
b &lt;- bayesx(y ~ fac, data = dat)
summary(b)

## plot factor term effects
plot(b, term = "fac")

## extract fitted effects
f &lt;- fitted(b, term = "fac")

## now use plotblock
plotblock(f)

## some variations
plotblock(f, col.poly = c(2, 3))
plotblock(f, col.poly = NA, lwd = c(2, 1, 1, 1, 1))
plotblock(f, col.poly = NA, lwd = 3, range = c(0.5,0.5))
plotblock(f, col.poly = NA, lwd = 3, col.lines = 1:5, lty = 1)
plotblock(f, col.poly = NA, lwd = 3, col.lines = 1:5, 
  lty = c(3, 1, 2, 2, 1))
plotblock(f, resid = TRUE)
plotblock(f, resid = TRUE, cex = 0.1)
plotblock(f, resid = TRUE, cex = 0.1, col.resid = 2)
plotblock(f, resid = TRUE, cex = 2, col.resid = 3, pch = 3)
plotblock(f, lty = 0, poly.lty = 1, density = c(5, 20))
plotblock(f, lty = 0, poly.lty = 1, density = c(5, 20), 
  poly.lwd = c(1, 2))
plotblock(f, lty = 0, poly.lty = c(1, 2), density = c(5, 20))
plotblock(f, lty = 0, poly.lty = c(1, 2), density = c(5, 20), 
  border = c("red", "green3"))
plotblock(f, lty = 0, poly.lty = c(1, 2), density = c(5, 20), 
  border = c("red", "green3"), col.poly = c("blue", "yellow"))
plotblock(f, lty = c(1,0,0,0,0), poly.lty = c(1, 2), 
  density = c(5, 20), border = c("red", "green3"), 
  col.poly = c("blue", "yellow"))
plotblock(f, lty = c(1,0,0,0,0), poly.lty = c(1, 2), 
  density = c(20, 20), border = c("red", "green3"), 
  col.poly = c("blue", "yellow"), angle = c(10, 75))

## End(Not run)

## another example
plotblock(y ~ fac, data = dat, range = c(0.45, 0.45))

dat &lt;- data.frame(fac = factor(rep(1:10, n/10)))
dat$y &lt;- with(dat, c(2.67, 5, 6, 3, 4, 2, 6, 7, 9, 7.5)[fac])
plotblock(y ~ fac, data = dat)
plotblock(cbind(y - 0.1, y + 0.1) ~ fac, data = dat)
plotblock(cbind(y - 0.1, y + 0.1) ~ fac, data = dat, 
  fill.select = c(0, 1, 1))
plotblock(cbind(y - 0.1, y + 0.1) ~ fac, data = dat, 
  fill.select = c(0, 1, 1), poly.lty = 2, lty = 1, 
  border = "grey5")
</code></pre>


</div>