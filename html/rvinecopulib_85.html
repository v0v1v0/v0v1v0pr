<div class="container">

<table style="width: 100%;"><tr>
<td>vine</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Vine copula models</h2>

<h3>Description</h3>

<p>Automated fitting or creation of custom vine copula models
</p>


<h3>Usage</h3>

<pre><code class="language-R">vine(
  data,
  margins_controls = list(mult = NULL, xmin = NaN, xmax = NaN, bw = NA, deg = 2),
  copula_controls = list(family_set = "all", structure = NA, par_method = "mle",
    nonpar_method = "constant", mult = 1, selcrit = "aic", psi0 = 0.9, presel = TRUE,
    trunc_lvl = Inf, tree_crit = "tau", threshold = 0, keep_data = FALSE, show_trace =
    FALSE, cores = 1),
  weights = numeric(),
  keep_data = FALSE,
  cores = 1
)

vine_dist(margins, pair_copulas, structure)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix or data.frame. Discrete variables have to be declared as
<code>ordered()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins_controls</code></td>
<td>
<p>a list with arguments to be passed to
<code>kde1d::kde1d()</code>. Currently, there can be
</p>

<ul>
<li> <p><code>mult</code> numeric vector of length one or d; all bandwidths for marginal
kernel density estimation are multiplied with <code>mult</code>. Defaults to
<code>log(1 + d)</code> where <code>d</code> is the number of variables after applying
<code>rvinecopulib:::expand_factors()</code>.
</p>
</li>
<li> <p><code>xmin</code> numeric vector of length d; see <code>kde1d::kde1d()</code>.
</p>
</li>
<li> <p><code>xmax</code> numeric vector of length d; see <code>kde1d::kde1d()</code>.
</p>
</li>
<li> <p><code>bw</code> numeric vector of length d; see <code>kde1d::kde1d()</code>.
</p>
</li>
<li> <p><code>deg</code> numeric vector of length one or d; <code>kde1d::kde1d()</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula_controls</code></td>
<td>
<p>a list with arguments to be passed to <code>vinecop()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>optional vector of weights for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_data</code></td>
<td>
<p>whether the original data should be stored; if you want to
store the pseudo-observations used for fitting the copula, use the
<code>copula_controls</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>the number of cores to use for parallel computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>A list with with each element containing the specification of a
marginal stats::Distributions. Each marginal specification
should be a list with containing at least the distribution family (<code>"distr"</code>)
and optionally the parameters, e.g.
<code>list(list(distr = "norm"), list(distr = "norm", mu = 1), list(distr = "beta", shape1 = 1, shape2 = 1))</code>.
Note that parameters that have no default values have to be provided.
Furthermore, if <code>margins</code> has length one, it will be recycled for every component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pair_copulas</code></td>
<td>
<p>A nested list of 'bicop_dist' objects, where
<code>pair_copulas[[t]][[e]]</code> corresponds to the pair-copula at edge <code>e</code> in
tree <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structure</code></td>
<td>
<p>an <code>rvine_structure</code> object, namely a compressed
representation of the vine structure, or an object that can be coerced
into one (see <code>rvine_structure()</code> and <code>as_rvine_structure()</code>).
The dimension must be <code>length(pair_copulas[[1]]) + 1</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>vine_dist()</code> creates a vine copula by specifying the margins, a nested list
of <code>bicop_dist</code> objects and a quadratic structure matrix.
</p>
<p><code>vine()</code> provides automated fitting for vine copula models.
<code>margins_controls</code> is a list with the same parameters as
<code>kde1d::kde1d()</code> (except for <code>x</code>). <code>copula_controls</code> is a list
with the same parameters as <code>vinecop()</code> (except for <code>data</code>).
</p>


<h3>Value</h3>

<p>Objects inheriting from <code>vine_dist</code> for <code>vine_dist()</code>, and
<code>vine</code> and <code>vine_dist</code> for <code>vine()</code>.
</p>
<p>Objects from the <code>vine_dist</code> class are lists containing:
</p>

<ul>
<li> <p><code>margins</code>, a list of marginals (see below).
</p>
</li>
<li> <p><code>copula</code>, an object of the class <code>vinecop_dist</code>, see <code>vinecop_dist()</code>.
</p>
</li>
</ul>
<p>For objects from the <code>vine</code> class, <code>copula</code> is also an object of the class
<code>vine</code>, see <code>vinecop()</code>. Additionally, objects from the <code>vine</code> class contain:
</p>

<ul>
<li> <p><code>margins_controls</code>, a <code>list</code> with the set of fit controls that was passed
to <code>kde1d::kde1d()</code> when estimating the margins.
</p>
</li>
<li> <p><code>copula_controls</code>, a <code>list</code> with the set of fit controls that was passed
to <code>vinecop()</code> when estimating the copula.
</p>
</li>
<li> <p><code>data</code> (optionally, if <code>keep_data = TRUE</code> was used), the dataset that was
passed to <code>vine()</code>.
</p>
</li>
<li> <p><code>nobs</code>, an <code>integer</code> containing the number of observations that was used
to fit the model.
</p>
</li>
</ul>
<p>Concerning <code>margins</code>:
</p>

<ul>
<li>
<p> For objects created with <code>vine_dist()</code>, it simply corresponds to the <code>margins</code>
argument.
</p>
</li>
<li>
<p> For objects created with <code>vine()</code>, it is a list of objects of class <code>kde1d</code>,
see <code>kde1d::kde1d()</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># specify pair-copulas
bicop &lt;- bicop_dist("bb1", 90, c(3, 2))
pcs &lt;- list(
  list(bicop, bicop), # pair-copulas in first tree
  list(bicop) # pair-copulas in second tree
)

# specify R-vine matrix
mat &lt;- matrix(c(1, 2, 3, 1, 2, 0, 1, 0, 0), 3, 3)

# set up vine copula model with Gaussian margins
vc &lt;- vine_dist(list(distr = "norm"), pcs, mat)

# show model
summary(vc)

# simulate some data
x &lt;- rvine(50, vc)

# estimate a vine copula model
fit &lt;- vine(x, copula_controls = list(family_set = "par"))
summary(fit)

## model for discrete data
x &lt;- as.data.frame(x)
x[, 1] &lt;- ordered(round(x[, 1]), levels = seq.int(-5, 5))
fit_disc &lt;- vine(x, copula_controls = list(family_set = "par"))
summary(fit_disc)

</code></pre>


</div>