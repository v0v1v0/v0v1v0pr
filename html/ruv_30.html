<div class="container">

<table style="width: 100%;"><tr>
<td>ruv_summary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
RUV Summary
</h2>

<h3>Description</h3>

<p>Post-process and summarize the results of call to RUV2, RUV4, RUVinv, or RUVrinv.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ruv_summary(Y, fit, rowinfo=NULL, colinfo=NULL, colsubset=NULL, sort.by="F.p", 
            var.type=c("ebayes", "standard", "pooled"),
            p.type=c("standard", "rsvar", "evar"), min.p.cutoff=10e-25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>The original data matrix used in the call to RUV2/4/inv/rinv
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>A RUV model fit (a list), as returned by RUV2 / RUV4 / RUVinv / RUVrinv
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowinfo</code></td>
<td>

<p>A matrix or dataframe containing information about the rows (samples).  This information is included in the summary that is returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colinfo</code></td>
<td>

<p>A matrix or dataframe containing information about the columns (features, e.g. genes).  This information is included in the summary that is returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colsubset</code></td>
<td>

<p>A vector indexing the features of interest.  Only only data on these features will be returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort.by</code></td>
<td>

<p>An index variable; which column of <code>C</code> (see below) should be used to sort the features.  The default is "F.p", meaning that features will be sorted by the F-test p-value.  If <code>NULL</code>, features will note be sorted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.type</code></td>
<td>

<p>Which type of estimate for sigma2 should be used from the call to variance_adjust?  The options are "ebayes", "standard", or "pooled."  See variance_adjust for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.type</code></td>
<td>

<p>Which type of p-values should be used from the call to variance_adjust?  The options are "standard", "rsvar", or "evar". 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.p.cutoff</code></td>
<td>

<p>p-values below this value will be changed and set equal to this value.  Useful for plotting p-values on a log scale.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function post-processes the results of a call to RUV2/4/inv/rinv and then nicely summarizes the output.  The post-processing step primarily consists of a call to variance_adjust, which computes various adjustments to variances, t-statistics, and and p-values.  See variance_adjust for details.  The <code>var.type</code> and <code>p.type</code> options determine which of these adjustments are used.  An additional post-processing step is that the column means of the <code>Y</code> matrix are computed, both before and after the call to <code>RUV1</code> (if <code>eta</code> was specified).  
</p>
<p>After post-processing, the results are summarized into a list containing 4 objects: 1) the data matrix <code>Y</code>; 2) a dataframe <code>R</code> containing information about the rows (samples); 3) a dataframe <code>C</code> containing information about the columns (features, e.g. genes), and 4) a list <code>misc</code> of other information returned by RUV2/4/inv/rinv. 
</p>
<p>Finally, if <code>colsubset</code> is specified, then <code>C</code> is subset to include only the features of interest (as are the relevant entries of <code>misc</code> that are used to compute projection plots).  If <code>sort.by</code> is specified, the features will also be sorted.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The original data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A dataframe of row-wise information, including <code>X</code>, <code>Z</code>, and any other data passed in with <code>rowinfo</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>A dataframe of column-wise information, including p-values, estimated regression coefficients, estimated variances, column means, an index of the negative controls, and any other data passed in with <code>colinfo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>misc</code></td>
<td>
<p>A list of additional information returned by RUV2/4/inv/rinv</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Johann Gagnon-Bartsch
</p>


<h3>See Also</h3>

<p><code>RUV2</code>, <code>RUV4</code>, <code>RUVinv</code>, <code>RUVrinv</code>, <code>variance_adjust</code>
</p>


</div>