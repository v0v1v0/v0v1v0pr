<div class="container">

<table style="width: 100%;"><tr>
<td>FitRsmRoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the radiological search model (RSM) to an ROC dataset</h2>

<h3>Description</h3>

<p>Fit an RSM-predicted ROC curve to a <strong>binned single-treatment single-reader ROC dataset</strong>
</p>


<h3>Usage</h3>

<pre><code class="language-R">FitRsmRoc(binnedRocData, lesDistr, trt = 1, rdr = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>binnedRocData</code></td>
<td>
<p>The <strong>binned ROC</strong> dataset containing the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lesDistr</code></td>
<td>
<p>The lesion distribution 1D array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trt</code></td>
<td>
<p>The selected treatment, default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdr</code></td>
<td>
<p>The selected reader, default is 1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If dataset is FROC, first convert it to ROC, using <code>DfFroc2Roc</code>. MLE ROC algorithms 
require binned datasets. Use <code>DfBinDataset</code> to perform the binning prior to calling 
this function. 
In the RSM: (1) The (random) number of latent NLs per case is Poisson distributed 
with mean parameter lambda, and the corresponding ratings are sampled from 
<code class="reqn">N(0,1)</code>. The (2) The (random) number of latent LLs per diseased case is 
binomial distributed with success probability nu and trial size equal to 
the number of lesions in the case, and the corresponding ratings are sampled from 
N(<code class="reqn">mu</code>,1). (3) A latent NL or LL is actually marked if its rating exceeds 
the lowest threshold zeta1. To avoid clutter error bars are only shown for the 
lowest and uppermost operating points. Because of the extra parameter, and the 
requirement to have five counts, the chi-square statistic often cannot be calculated.
</p>


<h3>Value</h3>

<p>The return value is a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The mean of the diseased distribution relative 
to the non-diseased one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The Poisson parameter describing the distribution 
of latent NLs per case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>The binomial success probability describing the distribution
of latent LLs per diseased case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zetas</code></td>
<td>
<p>The RSM cutoffs, zetas or thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUC</code></td>
<td>
<p>The RSM fitted ROC-AUC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdAUC</code></td>
<td>
<p>The standard deviation of AUC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NLLIni</code></td>
<td>
<p>The initial value of negative LL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NLLFin</code></td>
<td>
<p>The final value of negative LL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ChisqrFitStats</code></td>
<td>
<p>The chisquare goodness of fit results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMat</code></td>
<td>
<p>The covariance matrix of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fittedPlot</code></td>
<td>
<p>A <span class="pkg">ggplot2</span> object containing the fitted 
operating characteristic along with the empirical operating points. 
Use <code>print</code> to display the object</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chakraborty DP (2006) A search model and figure of merit for observer data acquired according to the free-response 
paradigm. Phys Med Biol 51, 3449-3462.
</p>
<p>Chakraborty DP (2006) ROC Curves predicted by a model of visual search. Phys Med Biol 51, 3463â€“3482.
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Test with included ROC data (some bins have zero counts)
lesDistr &lt;- UtilLesionDistrVector(dataset02)
retFit &lt;- FitRsmRoc(dataset02, lesDistr)
## print(retFit$fittedPlot)

## Test with included degenerate ROC data
lesDistr &lt;- UtilLesionDistrVector(datasetDegenerate)
retFit &lt;- FitRsmRoc(datasetDegenerate, lesDistr)

## Test with single interior point data
fp &lt;- c(rep(1,7), rep(2, 3))
tp &lt;- c(rep(1,5), rep(2, 5))
binnedRocData &lt;- Df2RJafrocDataset(fp, tp)
lesDistr &lt;- UtilLesionDistrVector(binnedRocData)
retFit &lt;- FitRsmRoc(binnedRocData, lesDistr)

## Test with two interior data points
fp &lt;- c(rep(1,7), rep(2, 5), rep(3, 3))
tp &lt;- c(rep(1,3), rep(2, 5), rep(3, 7))
binnedRocData &lt;- Df2RJafrocDataset(fp, tp)
lesDistr &lt;- UtilLesionDistrVector(binnedRocData)
retFit &lt;- FitRsmRoc(binnedRocData, lesDistr)


## Test with three interior data points
fp &lt;- c(rep(1,12), rep(2, 5), rep(3, 3), rep(4, 5)) #25
tp &lt;- c(rep(1,3), rep(2, 5), rep(3, 7), rep(4, 10)) #25
binnedRocData &lt;- Df2RJafrocDataset(fp, tp)
lesDistr &lt;- UtilLesionDistrVector(binnedRocData)
retFit &lt;- FitRsmRoc(binnedRocData, lesDistr)

## test for TONY data, i = 2 and j = 3 
## only case permitting chisqure calculation
lesDistr &lt;- UtilLesionDistrVector(dataset01)
rocData &lt;- DfFroc2Roc(dataset01)
retFit &lt;- FitRsmRoc(rocData, lesDistr, trt = 2, rdr = 3)
## print(retFit$fittedPlot)
retFit$ChisqrFitStats


</code></pre>


</div>