<div class="container">

<table style="width: 100%;"><tr>
<td>fit_models_RA_5bm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Model fitting for reference analysis using 5 benchmarks:
Posterior inference for benchmark and actual heterogeneity priors

</h2>

<h3>Description</h3>

<p>Computes the posterior distribution of the
parameters in a random-effects meta-analysis (expressed
as a normal-normal hierarchical model) for
each of five benchmark heterogeneity priors and
the actual heterogeneity prior(s) specified.
Applies the function <code>bayesmeta</code> from the package bayesmeta.



</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_models_RA_5bm(df, tau.prior=list(), compute.J.bm=TRUE,
                  m_J=NA, M_J=NA, upper.J=3, digits.J=2,
                  m_inf=NA, M_inf=NA, rlmc0=0.0001, rlmc1=0.9999,
                  mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>data frame with one column "y" containing the (transformed) effect estimates for the individual studies and
one column "sigma" containing the standard errors of these estimates.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute.J.bm</code></td>
<td>

<p>logical. Specifies if the parameter values of the two benchmarks priors
SGC(<code class="reqn">m_J</code>) and SIGC(<code class="reqn">M_J</code>) and the corresponding marginal posteriors should be computed.
Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_J</code></td>
<td>

<p>parameter value <code class="reqn">m=m_J</code> of the SGC(<code class="reqn">m</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_j_sgc</code> and the arguments
<code>df</code>, <code>upper.J</code>, <code>digits.J</code>, <code>mu.mean</code> and <code>mu.sd</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_J</code></td>
<td>

<p>parameter value <code class="reqn">M=M_J</code> of the SIGC(<code class="reqn">M</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_j_sigc</code> and the arguments
<code>df</code>, <code>upper.J</code>, <code>digits.J</code>, <code>mu.mean</code> and <code>mu.sd</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.J</code></td>
<td>

<p>upper bound for the parameters <code>M_J</code> and <code>m_J</code>. Real number in <code class="reqn">(1,\infty)</code>. Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits.J</code></td>
<td>

<p>specifies the desired precision of the parameter values <code class="reqn">M_J</code> and <code class="reqn">m_J</code>, i.e. to how many digits these two values
should be determined. Possible values are 1,2,3. Defaults to 2.
Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_inf</code></td>
<td>

<p>parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 0.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_inf_sgc</code>, such that the median RLMC is
approximately equal to <code>rlmc0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_inf</code></td>
<td>

<p>parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 1.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_inf_sigc</code>, such that the median RLMC is
approximately equal to <code>rlmc1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlmc0</code></td>
<td>

<p>RLMC target value for the SGC(<code class="reqn">m_{inf}</code>) benchmark prior (typically close to 0).
Is required only if <code>m_inf=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlmc1</code></td>
<td>

<p>RLMC target value for the SIGC(<code class="reqn">M_{inf}</code>) benchmark prior (typically close to 1).
Is required only if <code>M_inf=NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The five heterogeneity benchmark priors used are
introduced in the Supplementary Material of Ott et al. (2021, Sections 2.2.1, 2.5 and 2.6, see also Section 3.4 of Ott et al. (2021) for Jeffreys reference prior),
where they are denoted by
SGC(<code class="reqn">m_{inf}</code>), SIGC(<code class="reqn">M_J</code>), SGC(<code class="reqn">m_J</code>), SIGC(<code class="reqn">M_{inf}</code>)
and Jeffreys.
Note that "Jeffreys" refers to Jeffreys reference prior,
which is improper, but leads to a proper posterior if
there are at least two studies in the meta-analysis data set.
</p>
<p>If the fits induced by the SIGC(<code class="reqn">M_J</code>) and SGC(<code class="reqn">m_J</code>) benchmarks
are not needed for the analysis (such as for the posterior reference analysis
proposed in the Supplementary Material of Ott et al. (2021), see for example Table 8 for illustration),
specifying
<code>compute.J.bm=FALSE</code> may reduce the
computation time by several minutes.
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.

</p>


<h3>Value</h3>

<p>A list with two elements:
The first element named "fits" is a list containing the model fits and the
second element called "par" is a named vector giving the parameter values
of the benchmark priors.
The vector "par" has the following five components:
<code>m_inf</code>, <code>M_J</code>, <code>m_J</code>, <code>M_inf</code> and <code>C</code>.
</p>
<p>The element "fits" is a list of lists of class <code>bayesmeta</code>.
This list has length <code class="reqn">5</code> + length(<code>tau.prior</code>)
and contains one element for each heterogeneity prior considered
(5 benchmark priors and the actual priors specified),
in the following order:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit.SGC.m_inf </code></td>
<td>
<p> for SGC(<code>m_inf</code>) benchmark prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.SIGC.M_J </code></td>
<td>
<p> for SIGC(<code>M_J</code>) benchmark prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.SGC.m_J </code></td>
<td>
<p> for SGC(<code>m_J</code>) benchmark prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.SIGC.M_inf </code></td>
<td>
<p> for SIGC(<code>M_inf</code>) benchmark prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.j </code></td>
<td>
<p> for Jeffreys (improper) reference prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.actual_1 </code></td>
<td>
<p> for the first prior in the list <code>tau.prior</code> (if specified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.actual_2 </code></td>
<td>
<p> for the second prior in the list <code>tau.prior</code> (if specified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> ...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.actual_n </code></td>
<td>
<p> for the nth prior in the list <code>tau.prior</code> (if specified)</p>
</td>
</tr>
</table>
<p>See <code>bayesmeta</code> in the package bayesmeta
for information on the structure of the lists of class <code>bayesmeta</code>.
</p>


<h3>Warning </h3>

<p>This function may take several minutes to run if the parameter <code>m_J</code> and/or <code>M_J</code>
is not specified,
especially if the desired precision is <code>digits.J=2</code> or even <code>digits.J=3</code>.
</p>
<p>If <code>fit_models_RA</code> ends with an error or warning,
we recommend to check the values of the parameters <code>M_J</code>, <code>m_J</code> and <code>M_inf</code>
for the benchmark priors.
The choice of these parameters can be studied by using the functions
<code>M_j_sigc</code>, <code>m_j_sgc</code> and <code>M_inf_sigc</code>.
If one of the parameters <code>m_inf</code>, <code>M_J</code>, <code>m_J</code> or <code>M_inf</code>
has a value larger than 5*10^6, a warning message will be displayed,
since such large parameter values may lead to numerical problems
in the <code>bayesmeta</code> function.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505–4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code>bayesmeta</code> in the package bayesmeta,
<code>m_j_sgc</code>, <code>M_j_sigc</code>,
<code>m_inf_sgc</code>, <code>M_inf_sigc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># for aurigular acupuncture (AA) data set with one
# actual half-normal and the "DuMouchel" heterogeneity prior
data(aa)
# warning: it takes ca. 7 min. to run this function
fit_models_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                        "DuMouchel"))

# computation is much faster if m_J and M_J are specified
fit_models_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                        "DuMouchel"),
                  m_J = 1.35, M_J = 1.3)

</code></pre>


</div>