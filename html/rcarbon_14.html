<div class="container">

<table style="width: 100%;"><tr>
<td>ckde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Composite Kernel Density Estimates of Radiocarbon Dates</h2>

<h3>Description</h3>

<p>Computes a Composite Kernel Density Estimate (CKDE) from multiple sets of randomly sampled calendar dates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ckde(x, timeRange, bw, normalised = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>simdates</code> class object, generated using <code>sampleDates</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeRange</code></td>
<td>
<p>A vector of length 2 indicating the start and end date of the analysis in cal BP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Kernel bandwidth to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalised</code></td>
<td>
<p>A logical variable indicating whether the contribution of individual dates should be equal (TRUE), or weighted based on the area under the curve of non-normalised calibration (FALSE). Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes Kernel Density Estimates using randomly sampled calendar dates contained in a <code>simdates</code> class object (generated using the <code>sampledates()</code> function). The output contains <code>nsim</code> KDEs, where <code>nsim</code> is the argument used in <code>simulate.dates()</code>. The resulting object can be plotted to visualise a CKDE (cf Brown 2017), and if <code>boot</code> was set to <code>TRUE</code> in <code>sampleDates</code> its bootstrapped variant (cf McLaughlin 2018 for a similar analysis). The shape of the CKDE is comparable to an SPD generated from non-normalised dates when the argument <code>normalised</code> is set to FALSE.
</p>


<h3>Value</h3>

<p>An object of class <code>ckdeSPD</code> with the following elements
</p>

<ul>
<li>
<p><code>timeRange</code> The <code>timeRange</code> setting used.
</p>
</li>
<li>
<p><code>res.matrix</code> A matrix containing the KDE values with rows representing calendar dates.
</p>
</li>
</ul>
<h3>References</h3>

<p>Brown, W. A. 2017. The past and future of growth rate estimation in demographic temporal frequency analysis: Biodemographic interpretability and the ascendance of dynamic growth models. <em>Journal of Archaeological Science</em>, 80: 96–108. DOI: https://doi.org/10.1016/j.jas.2017.02.003 <br>
McLaughlin, T. R. 2018. On Applications of Space–Time Modelling with Open-Source 14C Age Calibration. <em>Journal of Archaeological Method and Theory</em>. DOI https://doi.org/10.1007/s10816-018-9381-3
</p>


<h3>See Also</h3>

<p><code>sampleDates</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(emedyd)
x = calibrate(x=emedyd$CRA, errors=emedyd$Error,normalised=FALSE)
bins = binPrep(sites=emedyd$SiteName, ages=emedyd$CRA,h=50)
s = sampleDates(x,bins=bins,nsim=100,boot=FALSE)
ckdeNorm = ckde(s,timeRange=c(16000,9000),bw=100,normalised=TRUE)
plot(ckdeNorm,type='multiline',calendar='BCAD')

## End(Not run)

</code></pre>


</div>