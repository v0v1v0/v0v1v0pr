<div class="container">

<table style="width: 100%;"><tr>
<td>ref.analysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC Analysis and Summaries for Reference Prior on an Intrinsic Autoregressive Model for Areal Data</h2>

<h3>Description</h3>

<p>Performs analysis on a geographical areal data set using the objective prior
for intrinsic conditional autoregressive (ICAR) random effects
(Keefe et al. 2019).  It takes a shapefile, data, and region names to
construct a neighborhood matrix and perform Markov chain Monte Carlo sampling on the
unstructured and spatial random effects.  Finally, the function obtains regional estimates and
performs posterior inference on the model parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ref.analysis(
  shape.file,
  X,
  y,
  x.reg.names,
  y.reg.names,
  shp.reg.names = NULL,
  iters = 10000,
  burnin = 5000,
  verbose = TRUE,
  tauc.start = 1,
  beta.start = 1,
  sigma2.start = 1,
  step.tauc = 0.5,
  step.sigma2 = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>shape.file</code></td>
<td>
<p>A shapefile corresponding to the regions for analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix of covariates, which should include a column of 1's for models with a non-zero intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.reg.names</code></td>
<td>
<p>A vector specifying the order of region names contained in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.reg.names</code></td>
<td>
<p>A vector specifying the order of region names contained in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shp.reg.names</code></td>
<td>
<p>A vector specifying the order of region names contained in the shapefile, if there is not a NAME column in the file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>Number of MCMC iterations to perform.  Defaults to 10,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of MCMC iterations to discard as burn-in.  Defaults to 5,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If FALSE, MCMC progress is not printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauc.start</code></td>
<td>
<p>Starting MCMC value for the spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.start</code></td>
<td>
<p>Starting MCMC value for the fixed effect regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2.start</code></td>
<td>
<p>Starting MCMC value for the variance of the unstructured random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.tauc</code></td>
<td>
<p>Step size for the spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.sigma2</code></td>
<td>
<p>Step size for the variance of the unstructured random effects.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing <code>H</code>, MCMC chains, parameter summaries, fitted regional values,
and regional summaries.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>The neighborhood matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMC</code></td>
<td>
<p>Matrix of MCMC chains for all model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.median</code></td>
<td>
<p>Posterior medians of the fixed effect regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.hpd</code></td>
<td>
<p>Highest Posterior Density intervals for the fixed effect regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauc.median</code></td>
<td>
<p>Posterior median of the spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauc.hpd</code></td>
<td>
<p>Highest Posterior Density interval for the spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2.median</code></td>
<td>
<p>Posterior median of the unstructured random effects variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2.hpd</code></td>
<td>
<p>Highest Posterior Density interval for the unstructured random effects variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauc.accept</code></td>
<td>
<p>Final acceptance rate for the spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2.accept</code></td>
<td>
<p>Final acceptance rate for the unstructured random effects variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.dist</code></td>
<td>
<p>Matrix of fitted posterior values for each region in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg.medians</code></td>
<td>
<p>Vector of posterior medians for fitted response by region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg.hpd</code></td>
<td>
<p>Data frame of Highest Posterior Density intervals by region.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Erica M. Porter, Matthew J. Keefe, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Refer to the vignette attached to the package.

</code></pre>


</div>