<div class="container">

<table style="width: 100%;"><tr>
<td>selectDWD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select data from the DWD CDC FTP Server</h2>

<h3>Description</h3>

<p>Select data files for downloading with <code>dataDWD()</code>.<br>
The available <code>res/var/per</code> folders with datasets are listed
<a href="https://bookdown.org/brry/rdwd/available-datasets.html">online</a>.<br>
Set <code style="white-space: pre;">⁠res="", var="", per=""⁠</code> to avoid the default interactive selection.<br>
The arguments <code>name/id</code> and <code>res/var/per</code> can be vectors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectDWD(
  name = "",
  res = NA,
  var = NA,
  per = NA,
  expand = TRUE,
  id = findID(name, exactmatch = exactmatch, mindex = mindex, quiet = quiet, failempty =
    failempty),
  exactmatch = TRUE,
  mindex = metaIndex,
  failempty = TRUE,
  findex = fileIndex,
  current = FALSE,
  base = dwdbase,
  meta = FALSE,
  quiet = rdwdquiet(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Char: station name(s) passed to <code>findID()</code>, along with
<code>exactmatch</code>, <code>mindex</code> and <code>failempty</code>.
All 3 arguments are ignored if <code>id</code> is given.
DEFAULT: "" (all stations at <code>res/var/per</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>Char: temporal <strong>res</strong>olution at <code>base</code>, e.g.
<code style="white-space: pre;">⁠"hourly","daily","monthly"⁠</code>.
See section 'Description' above and <code>fileIndex</code>.
Use <code>res=""</code> for matching options from all resolutions.
DEFAULT: NA for interactive selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Char: weather <strong>var</strong>iable of interest, e.g.
<code style="white-space: pre;">⁠"air_temperature", "cloudiness", "precipitation", "solar", "kl"⁠</code>.
See section 'Description' above and <code>fileIndex</code>.
DEFAULT: NA for interactive selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>per</code></td>
<td>
<p>Char: desired time <strong>per</strong>iod, e.g.
"recent" (up to date records from the last 1.5 years) or
"historical" (long time series).
Can be abbreviated. To get both datasets, use <code>per="hr"</code>.
DEFAULT: NA for interactive selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expand</code></td>
<td>
<p>Logical: get all possible <code>res/var/per</code> combinations?
Set to FALSE if you want only the given combinations.
If FALSE, they cannot be NA or "".
DEFAULT: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Char/Number: station ID with or without leading zeros, e.g. "00614" or 614.
Is internally converted to an integer.
Use NA (the default from <code>findID</code>) to get all data at <code>res/var/per</code>.
DEFAULT: <code>findID</code><code style="white-space: pre;">⁠(name, exaxtmatch, mindex, failempty)⁠</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exactmatch</code></td>
<td>
<p>Logical passed to <code>findID()</code>: match <code>name</code>
with <code>==</code>)? Else with <code>grepl()</code>. DEFAULT: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindex</code></td>
<td>
<p>Single object: Index with metadata passed to <code>findID()</code>.
DEFAULT: <code>metaIndex</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failempty</code></td>
<td>
<p>Fail if no matching station is found in <code>findID()</code>?
Avoid downloading all files. DEFAULT: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>findex</code></td>
<td>
<p>Single object: Index used to select filename, as returned by
<code>createIndex()</code>.To use a current / custom index, see <code>current</code> and
<a href="https://bookdown.org/brry/rdwd/fileindex.html">https://bookdown.org/brry/rdwd/fileindex.html</a>.
DEFAULT: <code>fileIndex</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>current</code></td>
<td>
<p>Single logical when <code>res/var/per</code> is given: instead of
<code>findex</code>, use a list of the currently available files at
base/res/var/per? This will call <code>indexFTP()</code>, thus
requires availability of the <code>RCurl</code> package.
See <a href="https://bookdown.org/brry/rdwd/fileindex.html">https://bookdown.org/brry/rdwd/fileindex.html</a>.
DEFAULT: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>Single char: main directory of DWD ftp server.
Must be the same <code>base</code> used to create <code>findex</code>.
DEFAULT: <code>dwdbase</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta</code></td>
<td>
<p>Logical: select Beschreibung file from <code>ismeta</code> entries in <code>findex</code>?
See <code>metaIndex</code> for a compilation of all Beschreibung files.
See the 'Examples' section for handling pdf and txt files.
DEFAULT: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Suppress id length warnings? DEFAULT: FALSE through <code>rdwdquiet()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>indexFTP()</code> if <code>current=TRUE</code>,
except folder and base.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Character string with file path and name(s) in the format
"base/res/var/per/filename.zip"
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Oct 2016, rewritten May 2022
</p>


<h3>See Also</h3>

<p><code>dataDWD()</code>, <code>metaIndex</code>,
<a href="https://bookdown.org/brry/rdwd/station-selection.html#by-name">website station selection chapter</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Give weather station name (must exist in metaIndex):
selectDWD("Potsdam", res="daily", var="kl", per="historical")

# all files for all stations matching "Koeln":
tail(selectDWD("Koeln", res="", var="", per="", exactmatch=FALSE)) # 686 files
findID("Koeln", FALSE)

## Not run:  # Excluded from CRAN checks to save time

# selectDWD("Potsdam") # interactive selection of res/var/per

# directly give station ID:
selectDWD(id="00386", res="daily", var="kl", per="historical")
selectDWD(id=537, "", "", "", "") # 8 files

# period can be abbreviated:
selectDWD(id="5419", res="daily", var="kl", per="h")

# selectDWD is vectorizable!
# since version 1.5.28 (2022-05-12) outer product, not elementwise comparison:
selectDWD("Freiburg", res="daily", var="kl", per="rh")
selectDWD("Freiburg", res=c("daily","monthly"), var="kl", per="r")
selectDWD("Freiburg", res=c("daily","monthly"), var="kl", per="hr")
# get old behaviour (needed e.g. in nearbyStations):
ids &lt;- c(3761,3761, 3603)
# all combinations:
selectDWD(id=ids, res="daily", var="kl", per=c("h","r","r")) # 4
# only given combinations:
selectDWD(id=ids, res="daily", var="kl", per=c("h","r","r"), expand=FALSE) # 3

# all files in all paths matching id:
head( selectDWD(id=c(1050, 386), res="",var="",per="") ) # 277 files
# all files in a given path (if ID is empty):
head(  selectDWD(id="", res="daily", var="kl", per="recent")   ) # 585 files

selectDWD(id=386, res="monthly", var="kl", per="h")

# Meta  data - Description and Beschreibung txt/pdf files.:
# manually select .txt (not pdf) files for automated opening with readDWD.
link &lt;- selectDWD(res="monthly", var="kl", per="h", meta=TRUE) # omit ID/Name!
link
link2 &lt;- grep("\\.txt$", link, value=TRUE)   ;   link2
m &lt;- dataDWD(link2, dir=locdir())
head(m)
# 
# Open PDF files with your system's default Viewer:
dataDWD(link[1], dir=locdir())

## End(Not run)

</code></pre>


</div>