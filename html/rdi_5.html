<div class="container">

<table style="width: 100%;"><tr>
<td>rdi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate RDI dissimilarity matrix</h2>

<h3>Description</h3>

<p>Wrapper function for calculating RDIs
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdi(genes, seqAnnot, params = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genes</code></td>
<td>
<p>vector (or matrix) containing the gene calls for each sequence.
If genes is a matrix, counts will be calculated for each 
column of 'genes', and the resulting count matrices will be
concatenated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqAnnot</code></td>
<td>
<p>matrix containing repertoire annotations. Must be same length
as 'genes'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>list; contains parameters to pass to child functions.
Should contain <code>countParams</code> and <code>distParams</code> lists,
which contain parameters for calcVDJcounts and
calcRDI, respectively. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters to pass to calcVDJcounts and 
calcRDI.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a wrapper for the two core functions of RDI, 
calcVDJcounts and calcRDI. To control the function of 
both <code>calcVDJcounts</code> and <code>calcRDI</code>, additional parameters can be specified
either directly in the RDI function call, or parameters for the individual functions 
can be wrapped up into lists of parameters and passed into the <code>params</code> parameter.
<code>params</code> should be a list containing at least one of two parameter lists:
<code>countParams</code> and <code>distParams</code>, which  
will be passed to <code>calcVDJcounts</code> and <code>calcRDI</code>, respectively. An example
analysis is included below.
</p>


<h3>Value</h3>

<p>Dissimilarity structure, as calculated by dist. In addition to the standard
attributes returned by dist, two additional attributes are defined as follows:
</p>

<table>
<tr>
<td style="text-align: right;">
  <em>nseq</em>  </td>
<td style="text-align: left;"> integer, the number of sequences used after subsampling  
                              the repertoires</td>
</tr>
<tr>
<td style="text-align: right;">
  <em>ngenes</em>  </td>
<td style="text-align: left;"> integers, the number of genes in each column of "genes" 
                                that were included in at least one repertoire.
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
#create genes
genes = sample(letters, 10000, replace=TRUE)

#create sequence annotations
seqAnnot = data.frame(donor = sample(1:4, 10000, replace=TRUE),
                      visit = sample(c("V1","V2","V3"), 10000, replace=TRUE),
                      cellType = sample(c("B","T"), 10000, replace=TRUE)
                     )
                     
#parameters
params = list(
  countParams = list(
    select = list(
      visit = c("V1","V3"),
      cellType = "B"
    ),
    combine = list(
      visit = "V[13]"
    ),
    simplifyNames = FALSE
  ),
  distParams = list(
    constScale=FALSE
  )
)

##calculate RDI
d = rdi(genes, seqAnnot, params)

##plot using hierarchical clustering
plot(hclust(d))

</code></pre>


</div>