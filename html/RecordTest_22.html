<div class="container">

<table style="width: 100%;"><tr>
<td>p.chisq.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pearson's Chi-Square Test for Probabilities of Record</h2>

<h3>Description</h3>

<p>This function performs a chi-square goodness-of-fit test
based on the record probabiliteis <code class="reqn">p_t</code> to study the hypothesis
of the classical record model (i.e., of IID continuous RVs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.chisq.test(
  X,
  record = c("upper", "lower"),
  simulate.p.value = FALSE,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>record</code></td>
<td>
<p>A character string indicating the type of record to be 
calculated, "upper" or "lower".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate.p.value</code></td>
<td>
<p>Logical. Indicates whether to compute p-values by
Monte Carlo simulation. It is recommended if the function returns a 
warning (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>If <code>simulate.p.value = TRUE</code>, an integer specifying the 
number of replicates used in the Monte Carlo estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null hypothesis of this chi-square test is that in every vector 
(columns of the matrix <code>X</code>), the probability of record at 
time <code class="reqn">t</code> is <code class="reqn">1/t</code> as in the classical record model, 
and the alternative that the probabilities are not equal to those values. 
First, the chi-square goodness-of-fit statistics to study the  null 
hypothesis <code class="reqn">H_0:\,p_t = 1/t</code> are calculated for each time 
<code class="reqn">t=2,\ldots,T</code>, where the observed value is the number of records at 
time <code class="reqn">t</code> in the <code class="reqn">M</code> vectors and the expected value under the null
is <code class="reqn">M / t</code>. The test statistic is the sum of the previous <code class="reqn">T-1</code> 
statistics and its distribution under the null 
is approximately <code class="reqn">\chi^2_{T-1}</code>.
</p>
<p>The chi-square approximation may not be valid with low <code class="reqn">M</code>, since it
requires expected values <code class="reqn">&gt; 5</code> or up to <code class="reqn">20\%</code> of the expected 
values are between 1 and 5. If this condition is not satisfied, a warning 
is displayed. In order to avoid this problem, a <code>simulate.p.value</code>
can be made by means of Monte Carlo simulations.
</p>


<h3>Value</h3>

<p>A <code>"htest"</code> object  with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Value of the chi-squared statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the type of test performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name of the data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Benestad RE (2003). 
“How Often Can We Expect a Record Event?” 
<em>Climate Research</em>, <strong>25</strong>(1), 3-13.
<a href="https://doi.org/10.3354/cr025003">doi:10.3354/cr025003</a>.
</p>
<p>Benestad RE (2004). 
“Record-Values, Nonstationarity Tests and Extreme Value Distributions.” 
<em>Global and Planetary Change</em>, <strong>44</strong>(1-4), 11–26. 
<a href="https://doi.org/10.1016/j.gloplacha.2004.06.002">doi:10.1016/j.gloplacha.2004.06.002</a>.
</p>


<h3>See Also</h3>

<p><code>global.test</code>, <code>score.test</code>,
<code>p.record</code>, <code>p.regression.test</code>, 
<code>lr.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Warning, M = 76 small for the value of T = 70
p.chisq.test(ZaragozaSeries)
# Simulate p-value
p.chisq.test(ZaragozaSeries, simulate.p.value = TRUE, B = 10000)

</code></pre>


</div>