<div class="container">

<table style="width: 100%;"><tr>
<td>optimizeALS-deprecated</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>[Deprecated] Perform iNMF on scaled datasets</h2>

<h3>Description</h3>

<p><b>Please turn to <code>runINMF</code> or <code>runIntegration</code></b>.
</p>
<p>Perform integrative non-negative matrix factorization to return factorized H,
W, and V matrices. It optimizes the iNMF objective function using block
coordinate descent (alternating non-negative least squares), where the number
of factors is set by k. TODO: include objective function equation here in
documentation (using deqn)
</p>
<p>For each dataset, this factorization produces an H matrix (cells by k), a V
matrix (k by genes), and a shared W matrix (k by genes). The H matrices
represent the cell factor loadings. W is held consistent among all datasets,
as it represents the shared components of the metagenes across datasets. The
V matrices represent the dataset-specific components of the metagenes.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>liger</code> object. Should normalize, select genes, and scale
before calling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Inner dimension of factorization (number of factors). Run suggestK
to determine appropriate value; a general rule of thumb is that a higher k
will be needed for datasets with more sub-structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Regularization parameter. Larger values penalize
dataset-specific effects more strongly (ie. alignment should increase as
lambda increases). Run suggestLambda to determine most appropriate value for
balancing dataset alignment and agreement (default 5.0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>Convergence threshold. Convergence occurs when
|obj0-obj|/(mean(obj0,obj)) &lt; thresh. (default 1e-6)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iters</code></td>
<td>
<p>Maximum number of block coordinate descent iterations to
perform (default 30).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>Number of restarts to perform (iNMF objective function is
non-convex, so taking the best objective from multiple successive
initializations is recommended). For easier reproducibility, this increments
the random seed by 1 for each consecutive restart, so future factorizations
of the same dataset can be run with one rep if necessary. (default 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.init</code></td>
<td>
<p>Initial values to use for H matrices. (default NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W.init</code></td>
<td>
<p>Initial values to use for W matrix (default NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.init</code></td>
<td>
<p>Initial values to use for V matrices (default NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand.seed</code></td>
<td>
<p>Random seed to allow reproducible results (default 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.obj</code></td>
<td>
<p>Print objective function values after convergence (default
FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print progress bar/messages (TRUE by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to other methods</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>liger</code> object with H, W, and V slots set.
</p>


<h3>See Also</h3>

<p><code>rliger-deprecated</code>
</p>


</div>