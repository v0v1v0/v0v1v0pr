<div class="container">

<table style="width: 100%;"><tr>
<td>foster.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots Based on Foster-Stuart and Diersen-Trenkler Statistics</h2>

<h3>Description</h3>

<p>This function builds a ggplot object to display two-sided
reference intervals based on Foster-Stuart and Diersen-Trenkler 
statistics to study the hypothesis of the classical record model (i.e., 
of IID continuous RVs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">foster.plot(
  X,
  weights = function(t) 1,
  statistic = c("D", "d", "S", "s", "U", "L", "W"),
  point.col = "black",
  point.shape = 19,
  conf.int = TRUE,
  conf.level = 0.9,
  conf.aes = c("ribbon", "errorbar"),
  conf.col = "grey69"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A function indicating the weight given to the different 
records according to their position in the series,
e.g., if <code>function(t) t-1</code> then <code class="reqn">\omega_t = t-1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>A character string indicating the type of statistic to be 
calculated, i.e., one of <code>"D"</code>, <code>"d"</code>, <code>"S"</code>, <code>"s"</code>,
<code>"U"</code>, <code>"L"</code> or <code>"W"</code> (see <code>foster.test</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.col, point.shape</code></td>
<td>
<p>Value with the colour and shape of the points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>Logical. Indicates if the RIs are also shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>(If <code>conf.int == TRUE</code>) Confidence level of the RIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.aes</code></td>
<td>
<p>(If <code>conf.int == TRUE</code>) A character string indicating 
the aesthetic to display for the RIs, <code>"ribbon"</code> (grey area) or 
<code>"errorbar"</code> (vertical lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.col</code></td>
<td>
<p>Colour used to plot the expected value and (if 
<code>conf.int == TRUE</code>) RIs.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function plots the observed values of the statistic selected with 
<code>statistic</code>, obtained with the series up to time <code class="reqn">t</code> for 
<code class="reqn">t=1,\ldots,T</code>. The plot also includes the expected values and 
reference intervals (RIs) based on the asymptotic normal distribution 
of the statistics under the null hypothesis.
</p>
<p>This function implements the same ideas that <code>N.plot</code>, but with
the statistics computed in <code>foster.test</code>. 
</p>
<p>These plots are useful to see the evolution in the record occurrence 
and to follow the evolution of the trend. The plot was proposed by 
Cebrián, Castillo-Mateo, Asín (2022) where its application is shown.
</p>


<h3>Value</h3>

<p>A ggplot graph object.
</p>


<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2), 313-330. 
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>
<p>Diersen J, Trenkler G (1996). “Records Tests for Trend in Location.”
<em>Statistics</em>, <strong>28</strong>(1), 1-12.
<a href="https://doi.org/10.1080/02331889708802543">doi:10.1080/02331889708802543</a>.
</p>
<p>Diersen J, Trenkler G (2001). 
“Weighted Records Tests for Splitted Series of Observations.”
In J Kunert, G Trenkler (eds.), 
<em>Mathematical Statistics with Applications in Biometry: Festschrift in Honour of Prof. Dr. Siegfried Schach</em>, 
pp. 163–178. Lohmar: Josef Eul Verlag.
</p>
<p>Foster FG, Stuart A (1954). 
“Distribution-Free Tests in Time-Series Based on the Breaking of Records.”
<em>Journal of the Royal Statistical Society B</em>, 
<strong>16</strong>(1), 1-22.
<a href="https://doi.org/10.1111/j.2517-6161.1954.tb00143.x">doi:10.1111/j.2517-6161.1954.tb00143.x</a>.
</p>


<h3>See Also</h3>

<p><code>foster.test</code>, <code>N.plot</code>, 
<code>N.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># D-statistic
foster.plot(ZaragozaSeries)
# D-statistic with linear weights
foster.plot(ZaragozaSeries, weights = function(t) t-1)
# S-statistic with linear weights
foster.plot(ZaragozaSeries, statistic = "S", weights = function(t) t-1)
# U-statistic with weights (upper tail)
foster.plot(ZaragozaSeries, statistic = "U", weights = function(t) t-1)
# L-statistic with weights (lower tail)
foster.plot(ZaragozaSeries, statistic = "L", weights = function(t) t-1)

</code></pre>


</div>