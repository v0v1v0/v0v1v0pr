<div class="container">

<table style="width: 100%;"><tr>
<td>CreateGeobyClassObject</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create merged biogeography-by-class object
</h2>

<h3>Description</h3>

<p>Create a merged biogeography-by-class object to be passed to fit_t_comp_subgroup using a stochastic map created from any model in BioGeoBEARS (see documentation in BioGeoBEARS package) and a simmap object from phytools (see documentation in phytools package).
</p>


<h3>Usage</h3>

<pre><code class="language-R">
CreateGeobyClassObject(phylo,simmap,trim.class,ana.events,clado.events,
	stratified=FALSE,rnd=5)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>the object of type 'phylo' (see ape documentation) used to build ancestral range stochastic maps in BioGeoBEARS
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simmap</code></td>
<td>

<p>a phylo object created using <code>make.simmap</code> in phytools
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim.class</code></td>
<td>

<p>category in the simmap object that represents the subgroup of interest (see Details and Examples)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ana.events</code></td>
<td>

<p>the "ana.events" table produced in BioGeoBEARS that lists anagenetic events in the stochastic map
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clado.events</code></td>
<td>

<p>the "clado.events" table produced in BioGeoBEARS that lists cladogenetic events in the stochastic map
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratified</code></td>
<td>

<p>logical indicating whether the ancestral biogeography stochastic map was built from a stratified analysis in BioGeoBEARS
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd</code></td>
<td>

<p>an integer value indicating the number of decimals to which values should be rounded in order to reconcile class and geo.objects (default is 5)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function merges a class object (which reconstructs group membership through time) and a stochastic map of ancestral biogeography (to reconstruct sympatry through time),
such that lineages can only interact when they belong to the same subgroup AND are sympatric.
</p>
<p>This allows fitting models of competition where only sympatric members of a subgroup can compete (e.g., all lineages that share similar diets or habitats).
</p>
<p>This function should be used to format the geography object so that it can be correctly
passed to the numerical integration performed in <code>fit_t_comp_subgroup</code>. 
</p>


<h3>Value</h3>

<p>Returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>a <code>simmap</code> object with phylogeny trimmed to subgroup of interest (including all branches determined to belong to that subgroup)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geography.object</code></td>
<td>
<p>a list with the following components:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geography.matrix</code></td>
<td>
<p>a list of matrices specifying both sympatry &amp; group membership (==1) or allopatry and/or non-membership in the focal subgroup (==0) for each species pair for each internode interval (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>a vector containing the time since the root of the tree at which nodes or changes in biogeographyXsubgroup membership occur (used internally in other functions)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spans</code></td>
<td>
<p>a vector specifying the distances between times (used internally in other functions)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan Drury <a href="mailto:jonathan.p.drury@gmail.com">jonathan.p.drury@gmail.com</a></p>


<h3>References</h3>

<p>Drury, J., Tobias, J., Burns, K., Mason, N., Shultz, A., and Morlon, H. in review. Contrasting impacts of competition on ecological and social trait evolution in songbirds. <em>PLOS Biology</em>.
</p>
<p>Drury, J., Clavel, J., Manceau, M., and Morlon, H. 2016. Estimating the effect of competition on trait evolution using maximum likelihood inference. <em>Systematic Biology</em> doi 10.1093/sysbio/syw020
</p>


<h3>See Also</h3>

<p><code>fit_t_comp_subgroup</code>, <code>CreateGeoObject_BioGeoBEARS</code> , <code>CreateClassObject</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(BGB.examples)



Canidae.phylo&lt;-BGB.examples$Canidae.phylo
dummy.group&lt;-c(rep("B",3),rep("A",12),rep("B",2),rep("A",6),rep("B",5),rep("A",6))
names(dummy.group)&lt;-Canidae.phylo$tip.label

Canidae.simmap&lt;-phytools::make.simmap(Canidae.phylo,dummy.group)

#build GeobyClass object with "A" as the focal group

Canidae.geobyclass.object&lt;-CreateGeobyClassObject(phylo=Canidae.phylo,simmap=Canidae.simmap, 
trim.class="A",ana.events=BGB.examples$Canidae.ana.events, 
clado.events=BGB.examples$Canidae.clado.events,stratified=FALSE, rnd=5)
	
phytools::plotSimmap(Canidae.geobyclass.object$map)


</code></pre>


</div>