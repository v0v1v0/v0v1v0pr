<div class="container">

<table style="width: 100%;"><tr>
<td>update_classes_dp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dirichlet process-based update of latent classes</h2>

<h3>Description</h3>

<p>This function updates the latent classes based on a Dirichlet process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">update_classes_dp(
  Cmax,
  beta,
  z,
  b,
  Omega,
  delta,
  xi,
  D,
  nu,
  Theta,
  s_desc = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Cmax</code></td>
<td>
<p>The maximum number of classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The matrix of the decision-maker specific coefficient vectors of dimension
<code>P_r</code> x <code>N</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>The vector of the allocation variables of length <code>N</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>The matrix of class means as columns of dimension <code>P_r</code> x <code>C</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>The matrix of class covariance matrices as columns of dimension
<code>P_r*P_r</code> x <code>C</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>A numeric for the concentration parameter vector <code>rep(delta,C)</code> of the
Dirichlet prior for <code>s</code>.
Per default, <code>delta = 1</code>. In case of Dirichlet process-based updates of the
latent classes, <code>delta = 0.1</code> per default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>The mean vector of length <code>P_r</code> of the normal prior for each <code>b_c</code>.
Per default, <code>xi = numeric(P_r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The covariance matrix of dimension <code>P_r</code> x <code>P_r</code> of the normal prior for
each <code>b_c</code>.
Per default, <code>D = diag(P_r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>The degrees of freedom (a natural number greater than <code>P_r</code>) of the Inverse
Wishart prior for each <code>Omega_c</code>.
Per default, <code>nu = P_r + 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>The scale matrix of dimension <code>P_r</code> x <code>P_r</code> of the Inverse Wishart prior for
each <code>Omega_c</code>.
Per default, <code>Theta = diag(P_r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_desc</code></td>
<td>
<p>If <code>TRUE</code>, sort the classes in descending class weight.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To be added.
</p>


<h3>Value</h3>

<p>A list of updated values for <code>z</code>, <code>b</code>, <code>Omega</code>, <code>s</code>,
and <code>C</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
z &lt;- c(rep(1,20),rep(2,30))
b &lt;- matrix(c(1,1,1,-1), ncol=2)
Omega &lt;- matrix(c(1,0.3,0.3,0.5,1,-0.3,-0.3,0.8), ncol=2)
beta &lt;- sapply(z, function(z) rmvnorm(b[,z], matrix(Omega[,z],2,2)))
delta &lt;- 1
xi &lt;- numeric(2)
D &lt;- diag(2)
nu &lt;- 4
Theta &lt;- diag(2)
RprobitB:::update_classes_dp(
  Cmax = 10, beta = beta, z = z, b = b, Omega = Omega,
  delta = delta, xi = xi, D = D, nu = nu, Theta = Theta
)
</code></pre>


</div>