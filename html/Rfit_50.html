<div class="container">

<table style="width: 100%;"><tr>
<td>rfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Rank-based Estimates of Regression Coefficients </h2>

<h3>Description</h3>

<p>Minimizes Jaeckel's dispersion function to obtain a rank-based solution for linear models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rfit(formula, data = list(), ...)

## Default S3 method:
rfit(formula, data, subset, yhat0 = NULL, 
scores = Rfit::wscores, symmetric = FALSE, TAU = "F0", 
betahat0 = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class formula </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> an optional data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p> an optional argument specifying the subset of observations to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat0</code></td>
<td>
<p> an n by 1 vector of initial fitted values, default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p> an object of class 'scores'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p> logical.  If 'FALSE' uses median of residuals as estimate of intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TAU</code></td>
<td>
<p>version of estimation routine for scale parameter.  F0 for Fortran, R for (slower) R, N for none</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betahat0</code></td>
<td>
<p> a p by 1 vector of initial parameter estimates, default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments to be passed to fitting routines </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rank-based estimation involves replacing the L2 norm of least squares estimation with a pseudo-norm which is a function of the residuals and the scored ranks of the residuals.
That is, in rank-based estimation, the usual notion of Euclidean distance is replaced with another measure of distance which is referred to as Jaeckel's (1972) dispersion function.
Jaeckel's dispersion function depends on a score function and a library of commonly used score functions is included; eg., linear (Wilcoxon) and normal (Gaussian) scores.
If an inital fit is not supplied (i.e. yhat0 = NULL and betahat0 = NULL) then inital fit is based on a LS fit.
</p>
<p>Esimation of scale parameter tau is provided which may be used for inference.  
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>estimated regression coefficents with intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals, i.e. y-yhat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p> yhat = x betahat</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>xc</code></td>
<td>
<p>centered design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauhat</code></td>
<td>
<p>estimated value of the scale parameter tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taushat</code></td>
<td>
<p>estimated value of the scale parameter tau_s</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>betahat</code></td>
<td>
<p>estimated regression coefficents</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Call to the function</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> John Kloke, Joesph McKean </p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Jaeckel, L. A. (1972). Estimating regression coefficients by minimizing the dispersion of residuals. <em>Annals of Mathematical Statistics</em>, 43, 1449 - 1458.
</p>
<p>Jureckova, J. (1971). Nonparametric estimate of regression coefficients. <em>Annals of Mathematical Statistics</em>, 42, 1328 - 1338.
</p>


<h3>See Also</h3>

<p><code>summary.rfit</code>
<code>drop.test</code>
<code>rstudent.rfit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(baseball)
data(wscores)
fit&lt;-rfit(weight~height,data=baseball)
summary(fit)

### set the starting value
x1 &lt;- runif(47); x2 &lt;- runif(47); y &lt;- 1 + 0.5*x1 + rnorm(47)
# based on a fit to a sub-model
rfit(y~x1+x2,yhat0=fitted.values(rfit(y~x1)))

### set value of delta used in estimation of tau ###
w &lt;- factor(rep(1:3,each=3))
y &lt;- rt(9,9)
rfit(y~w)$tauhat
rfit(y~w,delta=0.95)$tauhat  # recommended when n/p &lt; 5
</code></pre>


</div>