<div class="container">

<table style="width: 100%;"><tr>
<td>setup.grid.1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Creates a One-Dimensional Finite Difference Grid
</h2>

<h3>Description</h3>

<p>Subdivides the one-dimensional model domain into one or more zones that
are each sub-divided into grid cells. The resulting grid structure can be
used in the other <code>ReacTran</code> functions.
</p>
<p>The grid structure is characterized by the position of the middle of
the grid cells (<code>x.mid</code>) and the position of the interfaces between
grid cells (<code>x.int</code>).
</p>
<p>Distances are calculated between the interfaces (<code>dx</code>), i.e. the
thickness of the grid cells. An auxiliary set of distances (<code>dx.aux</code>)
is calculated between the points where the concentrations are specified
(at the center of each grid cell and the two external interfaces).
</p>
<p>A more complex grid consisting of multiple zones can be constructed when
specifying the endpoints of ech zone (<code>x.down</code>), the interval length
(<code>L</code>), and the number of layers in each zone (<code>N</code>) as vectors.
In each zone, one can control the grid resolution near the upstream and
downstream boundary.
</p>
<p>The grid resolution at the upstream interface changes according to the
power law relation <code>dx[i+1] = min(max.dx.1,p.dx.1*dx[i])</code>,
where <code>p.dx.1</code> determines the rate of increase and <code>max.dx.1</code>
puts an upper limit on the grid cell size.
</p>
<p>A similar formula controls the resolution at the downstream interface.
This allows refinement of the grid near the interfaces.
</p>
<p>If only <code>x.up, N</code> and <code>dx.1</code> are specified, then the grid size
is taken constant = <code>dx.1</code> (and <code>L=N*dx.1</code>)
</p>


<h3>Usage</h3>

<pre><code class="language-R">setup.grid.1D(x.up = 0, x.down = NULL, L = NULL, N = NULL, dx.1 = NULL,
              p.dx.1 = rep(1, length(L)), max.dx.1 = L, dx.N = NULL,
              p.dx.N = rep(1, length(L)), max.dx.N = L)

## S3 method for class 'grid.1D'
plot(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.up </code></td>
<td>
<p>position of the upstream interface; one value [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.down </code></td>
<td>
<p>position of the endpoint of each zone; one value when the
model domain covers only one zone (<code>x.down</code> = position of downstream
interface), or a vector of length M when the model domain is divided into
M zones (<code>x.down[M]</code> = position of downstream interface) [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L </code></td>
<td>
<p>thickness of zones; one value (model domain = one zone) or a
vector of length M (model domain = M zones) [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>number of grid cells within a zone; one value or a vector of
length M [-]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx.1 </code></td>
<td>
<p>size of the first grid cell in a zone; one value or a vector
of length M [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.dx.1 </code></td>
<td>
<p>power factor controlling the increase in grid cell size near
the upstream boundary; one value or a vector of length M. The default
value is 1 (constant grid cell size) [-]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dx.1 </code></td>
<td>
<p>maximum grid cell size in the upstream half of the zone;
one value or a vector of length M [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx.N </code></td>
<td>
<p>size of the last grid cell in a zone; one value or a vector
of length M [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.dx.N </code></td>
<td>
<p>power factor controlling the increase in grid cell size near the
downstream boundary; one value or a vector of length M. The default value
is 1 (constant grid cell size) [-]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dx.N </code></td>
<td>
<p>maximum grid cell size in the downstream half of the zone;
one value or a vector of length M [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>the object of class <code>grid.1D</code> that needs plotting
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to the function plot
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of type <code>grid.1D</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>the total number of grid cells [-]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.up </code></td>
<td>
<p>position of the upstream interface; one value [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.down </code></td>
<td>
<p>position of the downstream interface; one value [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.mid </code></td>
<td>
<p>position of the middle of the grid cells;
vector of length <code>N</code> [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.int </code></td>
<td>
<p>position of the interfaces of the grid cells;
vector of length <code>N+1</code> [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx </code></td>
<td>
<p>distance between adjacent cell interfaces (thickness of grid
cells); vector of length <code>N</code> [L]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx.aux </code></td>
<td>
<p>auxiliary vector containing the distance between adjacent
cell centers; at the upper and lower boundary calculated as
(<code>x[1]-x.up</code>) and (<code>x.down-x[N]</code>) respectively; vector of
length <code>N+1</code> [L]
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Filip Meysman &lt;filip.meysman@nioz.nl&gt;,
Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code>tran.1D</code>, for a discretisation of the general transport equation in 1-D
</p>
<p><code>setup.grid.2D</code> for the creation of grids in 2-D
</p>
<p><code>setup.prop.1D</code>, for defining properties on the 1-D grid.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># one zone, constant resolution
(GR &lt;- setup.grid.1D(x.up = 0, L = 10, N = 10))
(GR &lt;- setup.grid.1D(x.up = 0, L = 10, dx.1 = 1))
(GR &lt;- setup.grid.1D(x.up = 0, L = 10, dx.N = 1))
plot(GR)

# one zone, constant resolution, origin not zero
(GR &lt;- setup.grid.1D(x.up = 5, x.down = 10, N = 10))
plot(GR)

# one zone, variable resolution
(GR &lt;- setup.grid.1D(x.up = 0, L = 10, dx.1 = 1, p.dx.1 = 1.2))
(GR &lt;- setup.grid.1D(x.up = 0, L = 10, dx.N = 1, p.dx.N = 1.2))
plot(GR)

# one zone, variable resolution, imposed number of layers
(GR &lt;- setup.grid.1D(x.up = 0, L = 10, N = 6, dx.1 = 1, p.dx.1 = 1.2))
(GR &lt;- setup.grid.1D(x.up = 0, L = 10, N = 6, dx.N = 1, p.dx.N = 1.2))
plot(GR)

# one zone, higher resolution near upstream and downstream interfaces
(GR &lt;- setup.grid.1D(x.up = 0, x.down = 10, dx.1 = 0.1,
                     p.dx.1 = 1.2, dx.N = 0.1, p.dx.N = 1.2))
plot(GR)

# one zone, higher resolution near upstream and downstream interfaces
# imposed number of layers 
(GR &lt;- setup.grid.1D(x.up = 0, x.down = 10, N = 20, 
                     dx.1 = 0.1, p.dx.1 = 1.2, 
                     dx.N = 0.1, p.dx.N = 1.2))
plot(GR)

# two zones, higher resolution near the upstream
# and downstream interface
(GR&lt;-setup.grid.1D(x.up = 0, L = c(5, 5), 
         dx.1 = c(0.2, 0.2), p.dx.1 = c(1.1, 1.1), 
         dx.N = c(0.2, 0.2), p.dx.N = c(1.1, 1.1)))
plot(GR)

# two zones, higher resolution near the upstream
# and downstream interface
# the number of grid cells in each zone is imposed via N
(GR &lt;- setup.grid.1D(x.up = 0, L = c(5, 5), N = c(20, 10),
         dx.1 = c(0.2, 0.2), p.dx.1 = c(1.1, 1.1), 
         dx.N = c(0.2, 0.2), p.dx.N = c(1.1, 1.1)))
plot(GR)
</code></pre>


</div>