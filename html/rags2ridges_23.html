<div class="container">

<table style="width: 100%;"><tr>
<td>evaluateSfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visual inspection of the fit of a regularized precision matrix</h2>

<h3>Description</h3>

<p>Function aiding the visual inspection of the fit of an estimated (possibly
regularized) precision matrix vis-a-vis the sample covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evaluateSfit(
  Phat,
  S,
  diag = FALSE,
  fileType = "pdf",
  nameExt = "",
  dir = getwd()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Phat</code></td>
<td>
<p>(Regularized) estimate of the precision <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Sample covariance <code>matrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>A <code>logical</code> determining if the diagonal elements should be
retained for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileType</code></td>
<td>
<p>A <code>character</code> determining the output file type. Must be
one of: "pdf", "eps".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nameExt</code></td>
<td>
<p>A <code>character</code> determining the extension of default
output names generated by the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>A <code>character</code> specifying the directory in which the visual
output is stored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function outputs various visualizations to aid the visual inspection of
an estimated and possibly regularized precision matrix vis-a-vis the sample
covariance matrix. The inverse of the estimated precision matrix <code>P</code> is
taken to represent the estimated covariance matrix. The function then
outputs a QQ-plot and a heatmap of the observed covariances against the
estimated ones. The heatmap has the estimated covariances as
lower-triangular elements and the observed covariances as the
upper-triangular elements. The function outputs analogous plots for the
estimated and observed correlations. In case the observed covariance matrix
<code>S</code> is non-singular also a QQ-plot an a heatmap are generated for the
estimated and observed partial correlations.
</p>
<p>The function generates files with extension <code>fileType</code> under default
output names. These files are stored in the directory <code>dir</code> (default is
the working directory). To avoid overwriting of files when working in a
single directory one may employ the argument <code>nameExt</code>. By using
<code>nameExt</code> the default output names are extended with a character of
choice.
</p>


<h3>Author(s)</h3>

<p>Wessel N. van Wieringen, Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;
</p>


<h3>See Also</h3>

<p><code>ridgeP</code>, <code>covML</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
## Obtain some (high-dimensional) data
p = 25
n = 10
set.seed(333)
X = matrix(rnorm(n*p), nrow = n, ncol = p)
colnames(X)[1:25] = letters[1:25]
Cx &lt;- covML(X)

## Obtain regularized precision matrix
P &lt;- ridgeP(Cx, lambda = 10, type = 'Alt')

## Evaluate visually fit of regularized precision matrix vis-a-vis sample covariance
evaluateSfit(P, Cx, diag = FALSE, fileType = "pdf", nameExt = "test")
## End(Not run)

</code></pre>


</div>