<div class="container">

<table style="width: 100%;"><tr>
<td>NullObject.parameters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Null Model for SKAT and burden tests </h2>

<h3>Description</h3>

<p> Get the parameters under the null model to peforms burden tests or SKAT</p>


<h3>Usage</h3>

<pre><code class="language-R">  NullObject.parameters(pheno, RVAT, pheno.type = c("categorical", "continuous"), 
                        ref.level, data, formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p> The phenotype of each individual: a factor if <code>pheno.type = "categorical"</code>, and a numeric vector if <code>pheno.type = "continuous"</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RVAT</code></td>
<td>
<p> The type of Rare Variant Association Test (RVAT) to perform: should be "burden" or "SKAT"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno.type</code></td>
<td>
<p> The type of phenotype: "categorical" for binary or multinomial traits, or "continuous"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.level</code></td>
<td>
<p> The reference group of individuals for the regression, only needed if <code>RVAT = "burden"</code> and <code>pheno.type = "categorical"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Optional, a matrix containing the covariates with one column per covariate and one row per individual </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> Optional, an R formula corresponding to the regression model indicating which covariates from <code>data</code> to include in the model if only some of them are to be included</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Warning: individuals in <code>pheno</code> and <code>data</code> should be in the same order.  
</p>
<p>This function gets the parameters under the null model for SKAT or the burden tests.  
</p>
<p>For burden tests, it computes the Log-Likelihood under the null model used to perform the Likelihood Ratio Test.   
</p>
<p>For SKAT, it computes the probabilites for each individual of belonging to each group based on the group sizes and the potential covariates.  
</p>
<p>If <code>formula</code> is missing, all columns from <code>data</code> will be included as covariates.
</p>


<h3>Value</h3>

<p>A list containing different elements depending on the <code>RVAT</code> performed and the <code>pheno.type</code>.  
</p>
<p>- if <code>RVAT = "burden"</code> and <code>pheno.type = "categorical"</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A factor containing the group of each individual as given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.level</code></td>
<td>
<p> The reference group of individuals for the regression as given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0.LogLik</code></td>
<td>
<p> The Log-Likelihood of the null model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.toinclude</code></td>
<td>
<p> Which covariates to include in the regression, depends on the argument <code>formula</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> The <code>data</code> argument containing covariates, NULL if it was missing</p>
</td>
</tr>
</table>
<p>- if <code>RVAT = "burden"</code> and <code>pheno.type = "continuous"</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>A numeric vector containing the phenotype value for each individual as given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.toinclude</code></td>
<td>
<p> Which covariates to include in the regression, depends on the argument <code>formula</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> The <code>data</code> argument containing covariates, NULL if it was missing</p>
</td>
</tr>
</table>
<p>- if <code>RVAT = "SKAT"</code> and <code>pheno.type = "categorical"</code>:  
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Pi.data</code></td>
<td>
<p> A matrix n.individuals x n.groups containing the probabilities that each individual belong to each group </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> A matrix containing 1 in the first column for the intercept, and covariates from <code>data</code> and <code>formula</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p> A factor containing the group of each individual as given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get.moments</code></td>
<td>
<p> How to compute moments based on sample size for p-value calculations (only used if <code>get.moments = "size.based"</code> for a categorical phenotype in <code>SKAT</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P1</code></td>
<td>
<p> The vairance-covariance matrix of (Y - Pi_hat)</p>
</td>
</tr>
</table>
<p>- if <code>RVAT = "SKAT"</code> and <code>pheno.type = "continuous"</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ymp</code></td>
<td>
<p> A matrix n.individuals x 1 containing the (y - pi_hat) values, i.e. the residuals from the regression of the phenotype on the potential covariates </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> A matrix containing 1 in the first column for the intercept, and covariates from <code>data</code> and <code>formula</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p> The phenotype of each individual as given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P1</code></td>
<td>
<p> The variance matrix of <code>ymp</code> </p>
</td>
</tr>
</table>
<h3>See Also</h3>

 <p><code>SKAT</code>, <code>burden</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">#Random phenotype of 100 individuals 
random.multi.pheno &lt;- sample(1:3, 100, replace = TRUE)
#Random continuous phenotype
random.continuous.pheno &lt;- rnorm(100)
#Random sex covariate
random.covar &lt;- matrix( sample(1:2, prob = c(0.4, 0.6), size = 100, replace = TRUE),
                        ncol = 1 )

#Null Model for burden with a multinomi-category phenotype
#Controls as reference group, no covariates
H0.burden.multi &lt;- NullObject.parameters(pheno = as.factor(random.multi.pheno), 
                                         RVAT = "burden", pheno.type = "categorical", ref.level = 1)
#Null Model for SKAT with a continuous phenotype and a covariate
H0.SKAT.continuous &lt;- NullObject.parameters(pheno = random.continuous.pheno,
                                            RVAT = "SKAT", pheno.type = "continuous",
                                            data = random.covar)
</code></pre>


</div>