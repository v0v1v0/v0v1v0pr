<div class="container">

<table style="width: 100%;"><tr>
<td>Many moment and maximum likelihood estimations of variance components</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Many moment and maximum likelihood estimations of variance components
</h2>

<h3>Description</h3>

<p>Many moment and maximum likelihood estimations of variance components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">colvarcomps.mom(x, id, parallel = FALSE) 
colvarcomps.mle(x, id, ranef = FALSE, tol= 1e-08, maxiters = 100, 
parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A matrix with the data, where each column refers to a different sample of subjects. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>A numerical vector indicating the subject. You must put consecutive numbers and no zero values. 
Alternatively this can be a factor variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranef</code></td>
<td>

<p>Do you also want the random effects to be returned? TRUE or FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>The tolerance level to terminate the golden ratio search. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiters</code></td>
<td>
<p>The maximum number of iterations to perform.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>

<p>Should the computations run in parallel? TRUE or FALSE.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the "colvarcomp.mom" works for <b>balanced designs only</b>, i.e. for each subject the same number of
measurements have been taken. The "colvarcomps.mle" works for unbalanced as well.
</p>
<p>The variance components, the variance of the between measurements and the 
variance of the within are estimated using moment estimators. The "colvarcomps.mom" 
is the moment analogue of a random effects model which uses likelihood estimation ("colvarcomps.mle"). 
It is much faster, but can give negative variance of the random effects, in which case it becomes zero.
</p>
<p>The maximum likelihood version is a bit slower (try youselves to see the difference), but statistically 
speaking is to be preferred when small samples are available. The reason why it is only a little bit slower 
and not a lot slower as one would imagine is because we are using a closed formula to calculate the two variance
components (Demidenko, 2013, pg. 67-69). Yes, there are closed formulas for linear mixed models.     
</p>


<h3>Value</h3>

<p>For the "colvarcomps.mom":
A matrix with 5 columns, The MSE, the estimate of the between variance, 
the variance components ratio and a 95% confidence 
for the ratio.
</p>
<p>For the "colvarcomps.mle":
<b>If ranef = FALSE</b> 
a list with a single component called "info". That is a matrix with 3 columns, The MSE, the estimate of 
the between variance and the log-likelihood value. <b>If ranef = TRUE</b> a list including "info" and an 
extra component called "ranef" containing the random effects. It is a matrix with the same number of columns
as the data. Each column contains the randome effects of each variable. 
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris
</p>
<p>R implementation and documentation: Michail Tsagris &lt;mtsagris@uoc.gr&gt; and Manos Papadakis &lt;papadakm95@gmail.com&gt;.
</p>


<h3>References</h3>

<p>D.C. Montgomery (2001). Design and analysis of experiments (5th Edition). New York: John Wiley &amp; Sons. 
</p>
<p>Charles S. Davis (2002). Statistical methods for the analysis of repeated measures. New York: Springer-Verlag.
</p>
<p>Demidenko E. (2013). Mixed Models: Thoery and Applications with R 2nd Edition). New Jersey: 
John Wiley &amp; Sons (Excellent book).
</p>


<h3>See Also</h3>

<p><code> varcomps.mle, colrint.regbx
</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example taken from Montgomery, page 514-517.
y &lt;- c(98, 97, 99, 96, 91, 90, 93, 92,
96, 95, 97, 95, 95, 96, 99, 98)
y &lt;- matrix(y)
id &lt;- rep(1:4, each = 4)

x &lt;- rmvnorm(100, numeric(100), diag(rexp(100)) )
id &lt;- rep(1:25, each = 4)
n &lt;- 25  ;  d &lt;- 4
a &lt;- colvarcomps.mom(x, id) 
mean(a[, 4]&lt;0 &amp; a[, 5]&gt;0)  
b &lt;- colvarcomps.mle(x, id) 
x &lt;- NULL
</code></pre>


</div>