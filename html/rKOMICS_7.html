<div class="container">

<table style="width: 100%;"><tr>
<td>msc.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build cluster matrix</h2>

<h3>Description</h3>

<p>The msc.matrix function reads the output of clustering analyses (UC file) for specified minimum percent identity (MPI) values and organizes the data into a matrix format. This matrix represents the presence or absence of Minicircle Sequence Classes (MSCs) in each sample. The resulting matrix simplifies downstream analyses and visualizations by eliminating the need for manual data manipulation and reformatting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msc.matrix(files, samples, groups)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>files</code></td>
<td>
<p>a character vector containing the names of the UC files generated by the VSEARCH tool. Each file represents the output of clustering analysis for a specific minimum percent identity (MPI), such as all.minicircles.circ.id70.uc, all.minicircles.circ.id80.uc, and so on. Please ensure that your file names end with 'idxx.uc' for this function to work properly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>a character vector containing the sample names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a vector of the same length as the samples, specifying the groups (e.g., species) to which the samples belong.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a a list that contains one cluster matrix per percent identity. Each matrix represents the presence or absence of MSCs in each sample. In the cluster matrix, a value of 0 indicates that the MSC is not present in the sample, while a value higher than 0 indicates that the MSC is found at least once in the sample.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(exData)

### run function

matrices &lt;- msc.matrix(files = system.file("extdata", exData$ucs, package="rKOMICS"), 
                      samples = exData$samples, 
                      groups = exData$species)


### or: 
data(matrices)

### show matrix with id 95%
matrices[["id95"]]
rowSums(matrices[["id95"]]) # --&gt; frequency of MSC across all samples
colSums(matrices[["id95"]]) # --&gt; number of MSC per sample

</code></pre>


</div>