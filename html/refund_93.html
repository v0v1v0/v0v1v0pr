<div class="container">

<table style="width: 100%;"><tr>
<td>predict.pffr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction for penalized function-on-function regression</h2>

<h3>Description</h3>

<p>Takes a fitted <code>pffr</code>-object produced by <code>pffr()</code> and produces
predictions given a new set of values for the model covariates or the original
values used for the model fit. Predictions can be accompanied by standard errors,
based on the posterior distribution of the model coefficients. This is a wrapper
function for <code>predict.gam()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pffr'
predict(object, newdata, reformat = TRUE, type = "link", se.fit = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted <code>pffr</code>-object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A named list (or a <code>data.frame</code>) containing the values of the
model covariates at which predictions are required.
If no <code>newdata</code> is provided then predictions corresponding to the original data
are returned. If <code>newdata</code> is provided then it must contain all the variables needed
for prediction, in the format supplied to <code>pffr</code>, i.e., functional predictors must be
supplied as matrices with each row corresponding to one observed function.
See Details for more on index variables and prediction for models fit on
irregular or sparse data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reformat</code></td>
<td>
<p>logical, defaults to TRUE. Should predictions be returned in matrix form (default) or
in the long vector shape returned by <code>predict.gam()</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>see <code>predict.gam()</code> for details.
Note that <code>type == "lpmatrix"</code> will force <code>reformat</code> to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>see <code>predict.gam()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed on to <code>predict.gam()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Index variables (i.e., evaluation points) for the functional covariates are reused
from the fitted model object and cannot be supplied with <code>newdata</code>.
Prediction is always for the entire index range of the responses as defined
in the original fit. If the original fit was performed on sparse or irregular,
non-gridded response data supplied via <code>pffr</code>'s <code>ydata</code>-argument
and no <code>newdata</code> was supplied, this function will
simply return fitted values for the original evaluation points of the response (in list form).
If the original fit was performed on sparse or irregular data and <code>newdata</code> <em>was</em>
supplied, the function will return predictions on the grid of evaluation points given in
<code>object$pffr$yind</code>.
</p>


<h3>Value</h3>

<p>If <code>type == "lpmatrix"</code>, the design matrix for the supplied covariate values in long format.
If <code>se == TRUE</code>, a list with entries <code>fit</code> and <code>se.fit</code> containing fits and standard errors, respectively.
If <code>type == "terms"</code> or <code>"iterms"</code> each of these lists is a list of matrices of the same dimension as the response for <code>newdata</code>
containing the linear predictor and its se for each term.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>See Also</h3>

<p><code>predict.gam()</code>
</p>


</div>