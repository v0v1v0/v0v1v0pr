<div class="container">

<table style="width: 100%;"><tr>
<td>rTable.2x2xK</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Randomly Generate 2x2xK Contingency Tables
</h2>

<h3>Description</h3>

<p>A generic function that generates 2 x 2 x K contingency tables under product multinomial, multinomial or Poisson sampling plans.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rTable.2x2xK(p,sampling="Multinomial",N,K=NULL,lambda=NULL,print.raw=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>A finite  <code class="reqn">2\times 2\times K</code> matrix of cell probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>

<p>Sampling plan. It takes 'Product' for product multinomial sampling, 'Multinomial' for multinomial sampling, and 'Poisson' for Poisson sampling plans.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>Total number of individuals to be generated under product multinomial or multinomial sampling plans. It is a vector of positive integers containing total number of observations in each center under product multinomial sampling plan, a positive integer of total sample size under all centers under multinomial sampling plan, and not required under Poisson sampling plan. If <code>N</code> is not a positive integer, its converted to do so.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>

<p>Number of centers. It must be supplied if a scalar is entered as the value of <code>lambda</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Mean number of individuals in each cell of table. It is either a <code class="reqn">2\times 2\times K</code> positive matrix or a positive scalar under Poisson sampling plan and not required for both multinomial and product multinomial sampling plans. If a positive scalar is entered, mean number of individuals in each cell will be equal to each other.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.raw</code></td>
<td>

<p>If <code>TRUE</code>, generated raw data is printed on the screen.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To generate random tables under multinomial sampling plan, multinomial distribution with entered cell probabilities and total number of observations is directly used.
</p>
<p>To generate random tables under product multinomial sampling plan, center totals must be entered by <code>N</code>. It is not possible to fix any dimension of 2x2 table under each center. Suppose that center totals are denoted by <code class="reqn">n_{ij+}</code>, where <code class="reqn">i,j=1,2</code>. Then with the counts satisfying <code class="reqn">\sum_{ij}n_{ijk}=n_{ij+}</code>, we have the following multinomial form that <code>rTable.RxC</code> uses (Agresti, 2002):
</p>
<p style="text-align: center;"><code class="reqn">
      \frac{n_{ij+}!}{\prod_{ij}n_{ijk}!}\prod_{ij}p_{ij|k}^{n_{ijk}},
      </code>
</p>
 
<p>where <code class="reqn">k=1,\dots,K</code>, <code class="reqn">n_{ijk}</code> is the count of cell <code class="reqn">(i,j,k)</code>, and given that an individual is in <code class="reqn">k</code>th center, <code class="reqn">p_{ij|k}</code> is the conditional probability of being the cell <code class="reqn">(i,j)</code> of 2x2 table. This multinomial form is used to generate data under each center.
</p>
<p>To generate random tables under Poisson sampling plan, Poisson distribution with entered mean cell counts is directly used.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rTable</code></td>
<td>
<p>A <code class="reqn">2\times 2\times K</code> dimensional array including generated 2 x 2 x K contingency table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rTable.raw</code></td>
<td>
<p>Generated table in a <code class="reqn">N\times 3</code> dimensional matrix in raw data format. First columns represent 2x2 table and the third is for center.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Total number of generated individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>
<p>Used sampling plan in data generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ICC</code></td>
<td>
<p>Returns <code>FALSE</code> to indicate the data is generated without intraclass-correlated clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structure</code></td>
<td>
<p>Returns "2 x 2 x K" to indicate structure of generated table is "2 x 2 x K."</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.raw</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in raw data format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.regular</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in the format determined by <code>structure</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>


<h3>References</h3>

<p>Agresti A. (2002) <em>Categorical Data Analysis</em>, Wiley, New York.
</p>
<p>Demirhan, H. and Hamurkaroglu, C. (2008) Bayesian estimation of log odds ratios from RxC and 2 x 2 x K contingency tables, <em>Statistica Neerlandica</em> <b>62</b>, 405-424.
</p>
<p>Kroese D.P., Taimre T., Botev Z.I. (2011) <em>Handbook of Monte Carlo Methods</em>, Wiley, New York. 
</p>


<h3>Examples</h3>

<pre><code class="language-R"># --- Generate a 2x2x8 contingency table under multinomial sampling plan ---
num.centers=8                                   # Number of centers
sampl="Multinomial"                             # Generate table under multinomial 
                                                #  sampling plan
cell.prob=array(0.03125,dim=c(2,2,num.centers)) # Enter cell probabilities in 2x2xK format 
num.obs=124                                     # Number of observations

x=rTable.2x2xK(p=cell.prob,sampling=sampl,N=num.obs)
print(x)

# --- Generate a 2x2x8 contingency table under product multinomial sampling plan ---
sampl="Product"                                 # Generate table under product 
                                                #  multinomial sampling plan
center.margins=array(10,num.centers)            # Enter center margins 

y=rTable.2x2xK(p=cell.prob,sampling=sampl,N=center.margins)
print(y)

# --- Generate a 2x2x8 contingency table under Poisson sampling plan ---
num.centers=3
sampl="Poisson"                                 # Generate table under Poisson 
                                                #  sampling plan
cell.mean=array(3,dim=c(2,2,num.centers))       # Enter mean number of individuals 
                                                #  in each cell

z=rTable.2x2xK(sampling=sampl,lambda=cell.mean)
print(z)
</code></pre>


</div>