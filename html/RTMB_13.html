<div class="container">

<table style="width: 100%;"><tr>
<td>AD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert R object to AD</h2>

<h3>Description</h3>

<p>Signify that this object should be given an AD interpretation if evaluated in an active AD context. Otherwise, keep object as is.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AD(x, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object to be converted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>Logical; Force AD conversion even if no AD context? (for debugging)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>AD</code> is a generic constructor, converting plain R structures to RTMB objects if in an autodiff context. Otherwise, it does nothing (and adds virtually no computational overhead).
</p>
<p><code>AD</code> knows the following R objects:
</p>

<ul>
<li>
<p> Numeric objects from <span class="pkg">base</span>, such as <code>numeric()</code>, <code>matrix()</code>, <code>array()</code>, are converted to class advector with other attributes kept intact.
</p>
</li>
<li>
<p> Complex objects from <span class="pkg">base</span>, such as <code>complex()</code>, are converted to class adcomplex.
</p>
</li>
<li>
<p> Sparse matrices from <span class="pkg">Matrix</span>, such as <code>Matrix()</code>, <code>Diagonal()</code>, are converted to <code>adsparse</code> which is essentially a <code>dgCMatrix</code> with advector x-slot.
</p>
</li>
</ul>
<p><code>AD</code> provides a reliable way to avoid problems with method dispatch when mixing operand types. For instance, sub assigning <code>x[i] &lt;- y</code> may be problematic when <code>x</code> is numeric and <code>y</code> is <code>advector</code>. A prior statement <code>x &lt;- AD(x)</code> solves potential method dispatch issues and can therefore be used as a reliable alternative to ADoverload.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## numeric object to AD
AD(numeric(4), force=TRUE)
## complex object to AD
AD(complex(4), force=TRUE)
## Convert sparse matrices (Matrix package) to AD representation
F &lt;- MakeTape(function(x) {
  M &lt;- AD(Matrix::Matrix(0,4,4))
  M[1,] &lt;- x
  D &lt;- AD(Matrix::Diagonal(4))
  D@x[] &lt;- x
  M + D
}, 0)
F(2)
</code></pre>


</div>