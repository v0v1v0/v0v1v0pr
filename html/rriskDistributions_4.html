<div class="container">

<table style="width: 100%;"><tr>
<td>get.beta.par</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting parameters of a Beta distribution from two or more quantiles</h2>

<h3>Description</h3>

<p><code>get.beta.par</code> returns the parameters of estimated beta distribution where the
<code>p</code>th percentiles match with the quantiles <code>q</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.beta.par(p = c(0.025, 0.5, 0.975), q, show.output = TRUE, plot = TRUE,
     tol = 0.001, fit.weights = rep(1, length(p)), scaleX = c(0.1, 0.9), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric, single value or vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>numeric, single value or vector of quantiles corresponding to p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.output</code></td>
<td>
<p>logical, if <code>TRUE</code> the <code>optim</code> result will be printed (default value is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> the graphical diagnostics will be plotted (default value is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric, single positive value giving the absolute convergence tolerance for reaching zero (default value is <code>0.001</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.weights</code></td>
<td>
<p>numerical vector of the same length as a probabilities vector 
<code>p</code> containing positive values for weighting quantiles. By default all
quantiles will be weighted by 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleX</code></td>
<td>
<p>numerical vector of the length 2 containing values (from the open interval (0, 1))
for scaling quantile-axis (relevant only if <code>plot = TRUE</code>). The smaller the left value,
the further the graph is extrapolated within the lower percentile, the greater the right
value, the further it goes within the upper percentile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to the functions <code>plot</code> and <code>points</code> (relevant only if <code>plot = TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The number of probabilities, the number of quantiles and the numbers of weightings
must be identical and should be at least two. Using the default <code>p</code>, the
three corresponding quantiles are the 2.5th percentile, the median and the 97.5th
percentile, respectively. <code>get.beta.par</code> uses the R function <code>optim</code>
with the method <code>L-BFGS-B</code>. If this method fails the optimization method
<code>CG</code> will be invoked.
<br><br>
If <code>show.output = TRUE</code> the output of the function <code>optim</code> will be shown.
The item <code>convergence</code> equal to 0 means the successful completion of the
optimization procedure, otherwise it indicates a convergence error. The item
<code>value</code> displays the achieved minimal value of the functions that were minimized.
<br><br>
The estimated distribution parameters returned by the function <code>optim</code> are
accepted if the achieved value of the minimized function (output component
<code>value</code> of <code>optim</code>) is smaller than the argument <code>tol</code>.
<br><br>
The items of the probability vector <code>p</code> should lie between 0 and 1.
<br><br>
The items of the weighting vector <code>fit.weights</code> should be positive values.
<br><br>
The function which will be minimized is defined as a sum of squared differences
between the given probabilities and the theoretical probabilities of the specified
distribution evaluated at the given quantile points (least squares estimation).
</p>


<h3>Value</h3>

<p>Returns fitted parameters of a Beta distribution or missing
values (<code>NA</code>'s) if the distribution cannot fit the specified quantiles.
</p>


<h3>Note</h3>

<p>It should be noted that there might be deviations between the estimated
and the theoretical distribution parameters in certain circumstances. This is
because the estimation of the parameters is based on a numerical optimization
method and depends strongly on the initial values. In addition, one must always
keep in mind that a distribution for different combinations of parameters may
look very similar. Therefore, the optimization method cannot always find the
"right" distribution, but a "similar" one.
<br><br>
If the function terminates with the eror massage "convergence error occurred or
specified tolerance not achieved", one may try to set the convergence tolerance
to a higher value. It is yet to be noted, that good til very good fits of parameters
could only be obtained for tolerance values that are smaller than 0.001.
</p>


<h3>Author(s)</h3>

<p>Matthias Greiner <a href="mailto:matthias.greiner@bfr.bund.de">matthias.greiner@bfr.bund.de</a> (BfR), <br>
Katharina Schueller <a href="mailto:schueller@stat-up.de">schueller@stat-up.de</a> (<abbr><span class="acronym">STAT-UP</span></abbr> Statistical Consulting), <br>
Natalia Belgorodski <a href="mailto:belgorodski@stat-up.de">belgorodski@stat-up.de</a> (<abbr><span class="acronym">STAT-UP</span></abbr> Statistical Consulting)
</p>


<h3>See Also</h3>

<p>See <code>pbeta</code> for distribution implementation details.
</p>


<h3>Examples</h3>

<pre><code class="language-R">q &lt;- stats::qbeta(p = c(0.025, 0.5, 0.975), shape1 = 2, shape2 = 3)
old.par &lt;- graphics::par(mfrow = c(2, 3))
get.beta.par(q = q)
get.beta.par(q = q, scaleX = c(0.001, 0.999))
get.beta.par(q = q, fit.weights = c(10, 1, 10))
get.beta.par(q = q, fit.weights = c(1, 10, 1))
get.beta.par(q = q, fit.weights = c(100, 1, 100))
get.beta.par(q = q, fit.weights = c(1, 100, 1))
graphics::par(old.par)

q &lt;- stats::qbeta(p = c(0.025, 0.5, 0.975), shape1 = 1, shape2 = 1)
old.par &lt;- graphics::par(mfrow = c(2, 3))
get.beta.par(q = q)
get.beta.par(q = q, fit.weights = c(10, 1, 10))
get.beta.par(q = q, fit.weights = c(1, 10, 1))
get.beta.par(q = q, fit.weights = c(100, 1, 100))
get.beta.par(q = q, fit.weights = c(1, 100, 1))
graphics::par(old.par)

q &lt;- stats::qbeta(p = c(0.025, 0.5, 0.975), shape1 = 0.3, shape2 = 0.1)
old.par &lt;- graphics::par(mfrow = c(2, 3))
get.beta.par(q = q)
get.beta.par(q = q, fit.weights = c(10, 1, 10))
get.beta.par(q = q, fit.weights = c(1, 10, 1))
get.beta.par(q = q, fit.weights = c(100, 1, 100))
get.beta.par(q = q, fit.weights = c(1, 100, 1))
graphics::par(old.par)

## example with only two quantiles
q &lt;- stats::qbeta(p = c(0.025, 0.975), shape1 = 2, shape2 = 3)
old.par &lt;- graphics::par(mfrow = c(2, 3))
get.beta.par(p = c(0.025, 0.975), q = q)
get.beta.par(p = c(0.025, 0.975), q = q, fit.weights = c(10, 1))
get.beta.par(p = c(0.025, 0.975), q = q, fit.weights = c(1, 10))
get.beta.par(p = c(0.025, 0.975), q = q, fit.weights = c(100, 1))
get.beta.par(p = c(0.025, 0.975), q = q, fit.weights = c(1, 100))
graphics::par(old.par)

</code></pre>


</div>