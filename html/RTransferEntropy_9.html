<div class="container">

<table style="width: 100%;"><tr>
<td>transfer_entropy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to estimate Shannon and Renyi transfer entropy between two time
series x and y.</h2>

<h3>Description</h3>

<p>Function to estimate Shannon and Renyi transfer entropy between two time
series x and y.
</p>


<h3>Usage</h3>

<pre><code class="language-R">transfer_entropy(
  x,
  y,
  lx = 1,
  ly = 1,
  q = 0.1,
  entropy = "Shannon",
  shuffles = 100,
  type = "quantiles",
  quantiles = c(5, 95),
  bins = NULL,
  limits = NULL,
  nboot = 300,
  burn = 50,
  quiet = NULL,
  seed = NULL,
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of numeric values, ordered by time.
Also allowed are <code>xts</code>, <code>zoo</code>,
or <code>ts</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of numeric values, ordered by time.
Also allowed are <code>xts</code>, <code>zoo</code>,
or <code>ts</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lx</code></td>
<td>
<p>Markov order of x, i.e. the number of lagged values affecting the
current value of x. Default is <code>lx = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ly</code></td>
<td>
<p>Markov order of y, i.e. the number of lagged values affecting the
current value of y. Default is <code>ly = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a weighting parameter used to estimate Renyi transfer entropy,
parameter is between 0 and 1. For <code>q = 1</code>, Renyi transfer
entropy converges to Shannon transfer entropy. Default is
<code>q = 0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entropy</code></td>
<td>
<p>specifies the transfer entropy measure that is estimated,
either 'Shannon' or 'Renyi'. The first character can be used
to specify the type of transfer entropy as well. Default is
<code>entropy = 'Shannon'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shuffles</code></td>
<td>
<p>the number of shuffles used to calculate the effective
transfer entropy. Default is <code>shuffles = 100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>specifies the type of discretization applied to the observed time
series:'quantiles', 'bins' or 'limits'. Default is
<code>type = 'quantiles'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>
<p>specifies the quantiles of the empirical distribution of the
respective time series used for discretization.
Default is <code>quantiles = c(5,95)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>specifies the number of bins with equal width used for
discretization. Default is <code>bins = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>specifies the limits on values used for discretization.
Default is <code>limits = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replications for each direction of
the estimated transfer entropy. Default is <code>nboot = 300</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>the number of observations that are dropped from the beginning of
the bootstrapped Markov chain. Default is <code>burn = 50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>if FALSE (default), the function gives feedback.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a seed that seeds the PRNG (will internally just call set.seed),
default is <code>seed = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>if missing values should be removed (will remove the values at
the same point in the other series as well). Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class transfer_entropy, containing the transfer entropy
estimates in both directions, the effective transfer entropy
estimates in both directions, standard errors and p-values based on
bootstrap replications of the Markov chains under the null hypothesis
of statistical independence, an indication of statistical
significance, and quantiles of the bootstrap samples
(if <code>nboot &gt; 0</code>).
</p>


<h3>See Also</h3>

<p><code>coef</code>, <code>print.transfer_entropy</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># construct two time-series
set.seed(1234567890)
n &lt;- 500
x &lt;- rep(0, n + 1)
y &lt;- rep(0, n + 1)

for (i in seq(n)) {
  x[i + 1] &lt;- 0.2 * x[i] + rnorm(1, 0, 2)
  y[i + 1] &lt;- x[i] + rnorm(1, 0, 2)
}

x &lt;- x[-1]
y &lt;- y[-1]

# Calculate Shannon's Transfer Entropy
te_result &lt;- transfer_entropy(x, y, nboot = 100)
te_result

summary(te_result)


  # Parallel Processing using the future-package
  library(future)
  plan(multisession)

  te_result2 &lt;- transfer_entropy(x, y, nboot = 100)
  te_result2

  # revert back to sequential execution
  plan(sequential)

  te_result2 &lt;- transfer_entropy(x, y, nboot = 100)
  te_result2

  # General set of quiet
  set_quiet(TRUE)
  a &lt;- transfer_entropy(x, y, nboot = 0)

  set_quiet(FALSE)
  a &lt;- transfer_entropy(x, y, nboot = 0)

  # close multisession, see also ?plan
  plan(sequential)

</code></pre>


</div>