<div class="container">

<table style="width: 100%;"><tr>
<td>wofost_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
WOFOST crop growth model
</h2>

<h3>Description</h3>

<p>Create a WOFOST crop growth model object. Trhough this interface, you first create a model object and then you run it. The advantage is that you can easily change single parameters of the model and run the model again.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wofost_model(crop, weather, soil, control)
run(x, ...)
crop(x) &lt;- value
soil(x) &lt;- value
control(x) &lt;- value
weather(x) &lt;- value
force(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>crop</code></td>
<td>
<p>list. Crop parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weather</code></td>
<td>
<p>data.frame with weather data. See Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soil</code></td>
<td>
<p>list. Soil parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list. Model control options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>crop, weather, soil, or control data, as above; or a data.frame for "force"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>WOFOST model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additiontal arguments. <code>stopError</code>(logica). If an error occurs and <code>stopError</code> is <code>TRUE</code>, and error message is given. Otherwise, a warning is given and some simulation data (up till when the error occurred) may be returned</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The weather data must be passed as a data.frame with the following variables and units.
</p>

<table>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <b>variable</b> </td>
<td style="text-align: left;"> <b>description</b> </td>
<td style="text-align: left;"> <b>class / unit</b> </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>date</code> </td>
<td style="text-align: left;"> "Date" class variable </td>
<td style="text-align: left;"> - </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>srad</code> </td>
<td style="text-align: left;"> Solar radiation  </td>
<td style="text-align: left;"> kJ m-2 day-1 </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>tmin</code> </td>
<td style="text-align: left;"> Minimum temperature </td>
<td style="text-align: left;"> degrees C </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>tmax</code> </td>
<td style="text-align: left;"> Maximum temperature </td>
<td style="text-align: left;"> degrees C </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>vapr</code> </td>
<td style="text-align: left;"> Vapor pressure </td>
<td style="text-align: left;"> kPa </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>wind</code> </td>
<td style="text-align: left;"> Wind speed </td>
<td style="text-align: left;"> m s-1 </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
<td style="text-align: left;"> <code>prec</code> </td>
<td style="text-align: left;"> Precipitation </td>
<td style="text-align: left;"> mm day-1 </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Note that there should not be any time gaps between the days in the data.frame 
</p>


<h3>Value</h3>

<p>WofostModel object
</p>


<h3>References</h3>

<p>Van Diepen, C.A., J. Wolf, and H van Keulen, 1989. WOFOST: a simulation model of crop production. Soil Use and Management, 5: 16-24
</p>
<p>Van Keulen, H. and J. Wolf, 1986. Modelling of agricultural production : weather, soils and crops. <a href="http://edepot.wur.nl/168025">http://edepot.wur.nl/168025</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# weather data
f &lt;- system.file("extdata/Netherlands_Swifterbant.csv", package="meteor")
w &lt;- read.csv(f)
w$date &lt;- as.Date(w$date)

crop &lt;- wofost_crop("barley")
soil &lt;- wofost_soil("ec1")
contr &lt;- wofost_control()

contr$modelstart &lt;- as.Date("1980-02-06")
contr$latitude=52.57
contr$elevation=50

# create model
m &lt;- wofost_model(crop, w, soil, contr)

# run model
x &lt;- run(m)
plot(x[,"date"], x[, "LAI"], cex=.5)

# make a change
m$control$modelstart = as.Date("1980-02-20")

# run model again
y &lt;- run(m)
lines(y[,"date"], y[, "LAI"], col="red")

# change the crop 
crop(m) &lt;- wofost_crop("potato_704") 
p &lt;- run(m)
lines(p[,"date"], p[, "LAI"], col="blue")
</code></pre>


</div>