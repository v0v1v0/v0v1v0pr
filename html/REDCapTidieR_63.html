<div class="container">

<table style="width: 100%;"><tr>
<td>read_redcap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Import a REDCap database into a tidy supertibble</h2>

<h3>Description</h3>

<p>Query the REDCap API to retrieve data and metadata about a project,
and transform the output into a "supertibble" that contains data
and metadata organized into tibbles, broken down by instrument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">read_redcap(
  redcap_uri,
  token,
  raw_or_label = "label",
  forms = NULL,
  export_survey_fields = NULL,
  export_data_access_groups = NULL,
  suppress_redcapr_messages = TRUE,
  guess_max = .Machine$integer.max,
  allow_mixed_structure = getOption("redcaptidier.allow.mixed.structure", FALSE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>redcap_uri</code></td>
<td>
<p>The
URI/URL of the REDCap server (e.g.,
"https://server.org/apps/redcap/api/"). Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project. Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw_or_label</code></td>
<td>
<p>A string (either 'raw', 'label', or 'haven') that specifies whether
to export the raw coded values or the labels for the options of categorical
fields. Default is 'label'. If 'haven' is supplied, categorical fields are converted
to <code>haven_labelled</code> vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forms</code></td>
<td>
<p>A character vector of REDCap instrument names that specifies
which instruments to import. Default is <code>NULL</code> which imports all instruments
in the project.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export_survey_fields</code></td>
<td>
<p>A logical that specifies whether to export
survey identifier and timestamp fields. The default, <code>NULL</code>,
tries to determine if survey fields exist and returns them if available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export_data_access_groups</code></td>
<td>
<p>A logical that specifies whether to export
the data access group field. The default, <code>NULL</code>, tries to determine if a data
access group field exists and returns it if available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress_redcapr_messages</code></td>
<td>
<p>A logical to control whether to suppress messages
from REDCapR API calls. Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guess_max</code></td>
<td>
<p>A positive base::numeric value
passed to <code>readr::read_csv()</code> that specifies the maximum number of records to
use for guessing column types. Default <code>.Machine$integer.max</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_mixed_structure</code></td>
<td>
<p>A logical to allow for support of mixed repeating/non-repeating
instruments. Setting to <code>TRUE</code> will treat the mixed instrument's non-repeating versions
as repeating instruments with a single instance. Applies to longitudinal projects
only. Default <code>FALSE</code>. Can be set globally with <code>options(redcaptidier.allow.mixed.structure = TRUE)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses the <a href="https://ouhscbbmc.github.io/REDCapR/index.html">REDCapR</a>
package to query the REDCap API. The REDCap API returns a
<a href="https://en.wikipedia.org/wiki/Block_matrix">block matrix</a> that mashes
data from all data collection instruments
together. The <code>read_redcap()</code> function
deconstructs the block matrix and splices the data into individual tibbles,
where one tibble represents the data from one instrument.
</p>


<h3>Value</h3>

<p>A <code>tibble</code> in which each row represents a REDCap instrument. It
contains the following columns:
</p>

<ul>
<li> <p><code>redcap_form_name</code>, the name of the instrument
</p>
</li>
<li> <p><code>redcap_form_label</code>, the label for the instrument
</p>
</li>
<li> <p><code>redcap_data</code>, a tibble with the data for the instrument
</p>
</li>
<li> <p><code>redcap_metadata</code>, a tibble of data dictionary entries for each field in the instrument
</p>
</li>
<li> <p><code>redcap_events</code>, a tibble with information about the arms and longitudinal events represented in the instrument.
Only if the project has longitudinal events enabled
</p>
</li>
<li> <p><code>structure</code>, the instrument structure, either "repeating" or "nonrepeating"
</p>
</li>
<li> <p><code>data_rows</code>, the number of rows in the instrument's data tibble
</p>
</li>
<li> <p><code>data_cols</code>, the number of columns in the instrument's data tibble
</p>
</li>
<li> <p><code>data_size</code>, the size in memory of the instrument's data tibble computed by <code>lobstr::obj_size()</code>
</p>
</li>
<li> <p><code>data_na_pct</code>, the percentage of cells in the instrument's data columns that are <code>NA</code> excluding identifier and
form completion columns
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
redcap_uri &lt;- Sys.getenv("REDCAP_URI")
token &lt;- Sys.getenv("REDCAP_TOKEN")

read_redcap(
  redcap_uri,
  token,
  raw_or_label = "label"
)

## End(Not run)

</code></pre>


</div>