<div class="container">

<table style="width: 100%;"><tr>
<td>Q4</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>'Q4' class for storing rotation data as quaternions</h2>

<h3>Description</h3>

<p>Creates or tests for objects of class "Q4".
</p>


<h3>Usage</h3>

<pre><code class="language-R">as.Q4(x, ...)

## Default S3 method:
as.Q4(x, theta = NULL, ...)

## S3 method for class 'SO3'
as.Q4(x, ...)

## S3 method for class 'Q4'
as.Q4(x, ...)

## S3 method for class 'data.frame'
as.Q4(x, ...)

is.Q4(x)

id.Q4
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object to be coerced or tested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>vector or single rotation angle; if <code>length(theta)==1</code>, the
same theta is used for all axes</p>
</td>
</tr>
</table>
<h3>Format</h3>

<p><code>id.Q4</code> is the identity rotation given by the matrix
<code class="reqn">[1,0,0,0]^\top</code>.
</p>
<p>An object of class <code>Q4</code> with 1 rows and 4 columns.
</p>


<h3>Details</h3>

<p>Construct a single or sample of rotations in 3-dimensions in quaternion form.
Several possible inputs for <code>x</code> are possible and they are differentiated
based on their class and dimension.
</p>
<p>For <code>x</code> an n-by-3 matrix or a vector of length 3, the angle-axis
representation of rotations is utilized.  More specifically, each quaternion
can be interpreted as a rotation of some reference frame about the axis
<code class="reqn">U</code> (of unit length) through the angle <code class="reqn">\theta</code>.  For each axis and
angle the quaternion is formed through
</p>
<p style="text-align: center;"><code class="reqn">q=[cos(\theta/2),sin(\theta/2)U]^\top.</code>
</p>

<p>The object <code>x</code> is treated as if it has rows <code class="reqn">U</code> and <code>theta</code> is
a vector or angles. If no angle is supplied then the length of each axis is
taken to be the angle of rotation theta.
</p>
<p>For <code>x</code> an n-by-9 matrix of rotation matrices or an object of class
<code>"SO3"</code>, this function will return the quaternion equivalent of
<code>x</code>.  See <code>SO3</code> or the vignette "rotations-intro" for more
details on rotation matrices.
</p>
<p>For <code>x</code> an n-by-4 matrix, rows are treated as quaternions; rows that
aren't of unit length are made unit length while the rest are returned
untouched.  A message is printed if any of the rows are not quaternions.
</p>
<p>For <code>x</code> a <code>"data.frame"</code>, it is translated into a matrix of the
same dimension and the dimensionality of <code>x</code> is used to determine the
data type: angle-axis, quaternion or rotation (see above). As demonstrated
below, <code>is.Q4</code> may return <code>TRUE</code> for a data frame, but the
functions defined for objects of class <code>'Q4'</code> will not be called until
<code>as.Q4</code> has been used.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>as.Q4</code></td>
<td>
<p>coerces its object into a Q4 type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.Q4</code></td>
<td>
<p>returns <code>TRUE</code> or <code>FALSE</code> depending on whether its
argument satisfies the conditions to be an quaternion; namely it must be
four-dimensional and of unit length</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Pull off subject 1's wrist measurements
Subj1Wrist &lt;- subset(drill, Subject == '1' &amp; Joint == 'Wrist')

                               ## The measurements are in columns 5:8
all(is.Q4(Subj1Wrist[,5:8]))   #TRUE, even though Qs is a data.frame, the rows satisfy the
                               #conditions necessary to be quaternions BUT,
                               #S3 methods (e.g. 'mean' or 'plot') for objects of class
                               #'Q4' will not work until 'as.Q4' is used

Qs &lt;- as.Q4(Subj1Wrist[,5:8])  #Coerce measurements into 'Q4' type using as.Q4.data.frame
all(is.Q4(Qs))                 #TRUE
mean(Qs)                       #Estimate central orientation for subject 1's wrist, see ?mean.Q4
Rs &lt;- as.SO3(Qs)               #Coerce a 'Q4' object into rotation matrix format, see ?as.SO3

#Visualize the measurements, see ?plot.Q4 for more

  plot(Qs, col = c(1, 2, 3))

</code></pre>


</div>