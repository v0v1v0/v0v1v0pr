<div class="container">

<table style="width: 100%;"><tr>
<td>rq.nc.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-convex penalized quantile regression</h2>

<h3>Description</h3>

<p>Warning: this function is no longer exported. Produces penalized quantile regression models for a range of lambdas and penalty of choice. If lambda is unselected than an iterative algorithm is used to 
find a maximum lambda such that the penalty is large enough to produce an intercept only model. Then range of lambdas goes from the maximum lambda found to "eps" on the 
log scale. Local linear approximation approach used by Wang, Wu and Li to extend LLA as proposed by Zou and Li (2008) to the quantile regression setting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rq.nc.fit(
  x,
  y,
  tau = 0.5,
  lambda = NULL,
  weights = NULL,
  intercept = TRUE,
  penalty = "SCAD",
  a = 3.7,
  iterations = 1,
  converge_criteria = 1e-06,
  alg = "LP",
  penVars = NULL,
  internal = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Conditional quantile being modelled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Vector of lambdas. Default is for lambdas to be automatically generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weights for the objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Whether model should include an intercept. Constant does not need to be included in "x".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Type of penalty: "LASSO", "SCAD" or "MCP".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Additional tuning parameter for SCAD and MCP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations to be done for iterative LLA algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge_criteria</code></td>
<td>
<p>Difference in betas from iteration process that would satisfy convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>Defaults for small p to linear programming (LP), see Wang, Wu and Li (2012) for details. QICD is no longer available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penVars</code></td>
<td>
<p>Variables that should be penalized. With default value of NULL all variables are penalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>internal</code></td>
<td>
<p>Whether call to this function has been made internally or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional items to be sent to rq.lasso.fit.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the following:
</p>

<dl>
<dt>coefficients</dt>
<dd>
<p>Coefficients from the penalized model.</p>
</dd>
<dt>PenRho</dt>
<dd>
<p>Penalized objective function value.</p>
</dd>
<dt>residuals</dt>
<dd>
<p> Residuals from the model.</p>
</dd>
<dt>rho</dt>
<dd>
<p> Objective function evaluation without the penalty.</p>
</dd>
<dt>coefficients</dt>
<dd>
<p> Coefficients from the penalized model.</p>
</dd> 
<dt>tau</dt>
<dd>
<p> Conditional quantile being modeled.</p>
</dd>
<dt>n</dt>
<dd>
<p> Sample size.</p>
</dd>  
<dt>penalty</dt>
<dd>
<p> Penalty used, SCAD or MCP.</p>
</dd> 
<dt>penalty</dt>
<dd>
<p>Penalty selected.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Ben Sherwood, <a href="mailto:ben.sherwood@ku.edu">ben.sherwood@ku.edu</a> and Adam Maidman.
</p>


<h3>References</h3>


<ul>
<li>
<p> Wang, L., Wu, Y. and Li, R. (2012). Quantile regression of analyzing heterogeneity in ultra-high dimension. <em>J. Am. Statist. Ass</em>, <b>107</b>, 214–222.
</p>
</li>
<li>
<p> Wu, Y. and Liu, Y. (2009). Variable selection in quantile regression. <em>Statistica Sinica</em>, <b>19</b>, 801–817.
</p>
</li>
<li>
<p> Zou, H. and Li, R. (2008). One-step sparse estimates in nonconcave penalized likelihood models. <em>Ann. Statist.</em>, <b>36</b>, 1509–1533.
</p>
</li>
<li>
<p> Peng, B. and Wang, L. (2015). An iterative coordinate-descent algorithm for high-dimensional nonconvex penalized quantile regression. <em>J. Comp. Graph.</em>, <b>24</b>, 676–694.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
x &lt;- matrix(rnorm(800),nrow=100)
y &lt;- 1 + x[,1] - 3*x[,5] + rnorm(100)
scadModel &lt;- rq.nc.fit(x,y,lambda=1)

## End(Not run)
</code></pre>


</div>