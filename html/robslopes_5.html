<div class="container">

<table style="width: 100%;"><tr>
<td>TheilSen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Theil-Sen slope and intercept estimator.
</h2>

<h3>Description</h3>

<p>Computes the Theil-Sen median slope estimator by Theil (1950) and Sen (1968).
The implemented algorithm was proposed by Dillencourt et. al (1992) and runs in an expected <code class="reqn">O(n log n)</code> time while requiring <code class="reqn">O(n)</code> storage.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TheilSen(x, y, alpha = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A vector of predictor values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A vector of response values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Determines the order statistic of the target slope, which is equal to <code class="reqn">[alpha*n*(n-1)]</code>, where <code class="reqn">n</code> denotes the sample size. Defaults to <code>NULL</code>, which corresponds
with the (upper) median. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Whether or not to print out the progress of the algorithm. Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given two input vectors <code>x</code> and <code>y</code> of length <code class="reqn">n</code>, the Theil-Sen estimator is computed as <code class="reqn">med_{ij} (y_i - y_j)/(x_i-x_j)</code>.  By default, the median in this experssion is the upper median, defined as <code class="reqn">\lfloor (n +2) / 2 \rfloor</code>. 
By changing <code>alpha</code>, other order statistics of the slopes can be computed.
</p>


<h3>Value</h3>

<p>A list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>intecept </code></td>
<td>
<p>The estimate of the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope </code></td>
<td>
<p>The Theil-Sen estimate of the slope.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jakob Raymaekers
</p>


<h3>References</h3>

<p>Theil, H. (1950), A rank-invariant method of linear and polynomial regression
analysis (Parts 1-3),  <em>Ned. Akad. Wetensch. Proc. Ser. A</em>, <b>53</b>, 386-392,
521-525, 1397-1412.
</p>
<p>Sen, P. K. (1968). Estimates of the regression coefficient based on Kendall's tau.  <em>Journal of the American statistical association</em>, <b>63</b>(324), 1379-1389.
</p>
<p>Dillencourt, M. B., Mount, D. M., &amp; Netanyahu, N. S. (1992). A randomized algorithm for slope selection. <em>International Journal of Computational Geometry &amp; Applications</em>, <b>2</b>(01), 1-27.
</p>
<p>Raymaekers (2023). "The R Journal: robslopes: Efficient Computation of the (Repeated) Median Slope", The R Journal. <a href="https://journal.r-project.org/articles/RJ-2023-012/">(link to open access pdf)</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># We compare the implemented algorithm against a naive brute-force approach.

bruteForceTS &lt;- function(x, y) {
  
  n &lt;- length(x)
  medind1 &lt;- floor(((n * (n - 1)) / 2 + 2) / 2)
  medind2 &lt;- floor((n + 2) / 2)
  temp &lt;-  t(sapply(1:n, function(z)  apply(cbind(x, y), 1 ,
                                                  function(k) (k[2] - y[z]) /
                                                    (k[1] - x[z]))))
  TSslope &lt;- sort(as.vector(temp[lower.tri(temp)]))[medind1]
  TSintercept &lt;- sort(y - x * TSslope)[medind2]
  return(list(intercept = TSintercept, slope = TSslope))
}


n = 100
set.seed(2)
x = rnorm(n)
y = x + rnorm(n)

t0 &lt;- proc.time()
TS.fast &lt;- TheilSen(x, y, NULL, FALSE)
t1 &lt;- proc.time()
t1 - t0

t0 &lt;- proc.time()
TS.naive &lt;- bruteForceTS(x, y)
t1 &lt;- proc.time()
t1 - t0

TS.fast$slope - TS.naive$slope

</code></pre>


</div>