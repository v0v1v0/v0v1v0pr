<div class="container">

<table style="width: 100%;"><tr>
<td>setup.prop.2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Attaches a Property to a Two-Dimensional Grid
</h2>

<h3>Description</h3>

<p>Calculates the value of a given property at the middle of grid cells
(<code>mid</code>) and at the interfaces of the grid cells (<code>int</code>).
</p>
<p>Two possibilities are available: either specifying a mathematical function
(<code>func</code>) that describes the spatial dependency of the property, or
asssuming a constant value (<code>value</code>). To allow for anisotropy, the
spatial dependency can be different in the x and y direction.
</p>
<p>For example, in a sediment model, the routine can be used to specify the
porosity, the mixing intensity or other parameters over the grid of the
reactangular sediment domain.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setup.prop.2D(func = NULL, value = NULL, grid, y.func = func, 
              y.value = value, ...)

## S3 method for class 'prop.2D'
contour(x, grid, xyswap = FALSE, filled = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>func </code></td>
<td>
<p>function that describes the spatial dependency in the 
x-direction; defined as <code>func &lt;- function (x,y, ...); 
    it should return as many elements as in x or y</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value </code></td>
<td>
<p>constant value given to the property in the x-direction
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid </code></td>
<td>
<p>list specifying the 2D grid characteristics, see
<code>setup.grid.2D</code> for details on the structure of this list
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.func </code></td>
<td>
<p>function that describes the spatial dependency in the
y-direction; defined as <code>y.func &lt;- function (x, y, ...)</code>;
it should return as many elements as in x or y. 
By default the same as in the x-direction. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.value </code></td>
<td>
<p>constant value given to the property in the y-direction.
By default the same as in the x-direction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>the object of class <code>prop.2D</code> that needs plotting
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filled </code></td>
<td>
<p>if <code>TRUE</code>, uses <code>filled.contour</code>, else <code>contour</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyswap </code></td>
<td>
<p>if <code>TRUE</code>, then x- and y-values are swapped and
the y-axis is oriented from top to bottom. Useful for drawing
vertical depth profiles
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>
<p>additional arguments that are passed on to <code>func</code> or
to the method
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li> <p>When the property is isotropic, the <code>x.mid</code> and
<code>y.mid</code> values are identical. This is for example the case for
sediment porosity.
</p>
</li>
<li> <p>When the property is anisotropic, the <code>x.mid</code> and
<code>y.mid</code> values can differ. This can be for example the case for
the velocity, where in general, the value will differ between the x and
y direction.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list of type <code>prop.2D</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x.mid </code></td>
<td>
<p>property value in the x-direction defined at the middle of the
grid cells; Nx * Ny matrix (where Nx and Ny = number of cells in x, y
direction)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.mid </code></td>
<td>
<p>property value in the y-direction at the middle of the grid
cells; Nx * Ny matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.int </code></td>
<td>
<p>property value in the x-direction defined at the
x-interfaces of the grid cells;
(Nx+1)*Ny matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.int </code></td>
<td>
<p>property value in the y-direction at the y-interfaces of the
grid cells; Nx*(Ny+1) matrix
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>For some properties, it does not make sense to use <code>y.func</code> different 
to <code>func</code>. For instance, for volume fractions, AFDW.
</p>
<p>For other properties, it may be usefull to have <code>y.func</code> or 
<code>y.value</code> different from <code>func</code> or <code>value</code>, for instance
for velocities, surface areas, ...
</p>


<h3>Author(s)</h3>

<p>Filip Meysman &lt;filip.meysman@nioz.nl&gt;,
Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Inverse quadratic function 
inv.quad &lt;- function(x, y, a = NULL, b = NULL)
   return(1/((x-a)^2+(y-b)^2))


# Construction of the 2D grid 
x.grid &lt;- setup.grid.1D (x.up = 0, L = 10, N = 10)
y.grid &lt;- setup.grid.1D (x.up = 0, L = 10, N = 10)
grid2D &lt;- setup.grid.2D (x.grid, y.grid)

# Attaching the inverse quadratic function to the 2D grid 
(twoD &lt;- setup.prop.2D (func = inv.quad, grid = grid2D, a = 5, b = 5))

# show 
contour(log(twoD$x.int))

</code></pre>


</div>