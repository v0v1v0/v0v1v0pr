<div class="container">

<table style="width: 100%;"><tr>
<td>wsmooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-dimensional smoothing</h2>

<h3>Description</h3>

<p>'wsmooth' weighted whittaker  smoothing.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wsmooth(chromatogram, penalty = 1, lambda = 1, min_int = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chromatogram</code></td>
<td>
<p><em>raw_GCxGC</em> or <em>preproc_GCxGC</em> object with
<em>name</em> and <em>mod_time</em> slots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>an integer of the order of the penalty. Only penalty of
first (penalty = 1) and second  (penalty = 2) order are allowed. By
default, the smooth function is performed with first penalty order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>smoothing parameter: larger values lead to more smoothing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_int</code></td>
<td>
<p>minimum intensity value. The smoothing routine usually
creates low intensity artifacts which can obscure other compounds signals.
The min intensity value replace signals bellow the given value with 0.
For quadrupole mass detector this artifacts may range from 0-100, while
for TOF mass analyzers it can be 0-1e3.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes a raw two-dimensional chromatogram and performs
the weighted wittaker smoothing. It smooths the signal with linear or
quadratic penalty, depending on the provided penalty,
along side the first dimension, based on Whittaker smoother
(Eilers 2003).
</p>


<h3>References</h3>

<p>Eilers PH (2003).
“A perfect smoother.”
<em>Analytical Chemistry</em>, <b>75</b>(14), 3631–3636.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
chrom_name &lt;- system.file("extdata", "08GB.cdf", package = "RGCxGC")
chrom_2D &lt;- read_chrom(chrom_name, 5L)
chrom_smooth &lt;- wsmooth(chrom_2D, penalty = 1, lambda = 1e1)
plot(chrom_smooth, nlevels = 150,
           color.palette = colorRamps::matlab.like,
           main = expression(paste(lambda, "= 10, penalty = 1")) )
# Remove intensities bellow 1.75e5 (too high)    
chrom_smooth2 &lt;- wsmooth(chrom_2D, penalty = 1,
                         lambda = 1e1, min_int = 1.75e5)
plot(chrom_smooth2, nlevels = 150,
           color.palette = colorRamps::matlab.like,
           main = expression(paste(lambda,
            "= 10, penalty = 1, min_int = 1.75e5")) )
</code></pre>


</div>