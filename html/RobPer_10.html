<div class="container">

<table style="width: 100%;"><tr>
<td>sampler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generator for irregularly sampled observation times 
</h2>

<h3>Description</h3>

<p>Generates irregularly sampled observation times with a periodic sampling pattern
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampler(ttype, npoints, ncycles, ps = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ttype</code></td>
<td>

<p>character string: Specifying the sampling pattern. Possible options: <code>"equi"</code> and <code>"unif"</code> for unperiodic sampling, <code>"sine"</code> and <code>"trian"</code> for sampling with a periodic density (see Details). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>

<p>integer: Sample size <code class="reqn">n</code> (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncycles</code></td>
<td>

<p>integer: Number of sampling cycles <code class="reqn">n_s</code> (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps</code></td>
<td>

<p>positive numeric value: Sampling period <code class="reqn">p_s</code> (see Details).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sampler</code> generates observation times <code class="reqn">t_1,\ldots,t_n</code> with a periodic sampling of period <code class="reqn">p_s</code>. Four distributions are possible:
In case of <code>ttype="equi"</code>, the <code class="reqn">t_i</code> are equidistantly sampled with <code class="reqn">t_i=i\frac{p_sn_s}{n}</code>.
For <code>ttype="unif"</code>, the observation times are independently drawn form a uniform distribution on <code class="reqn">[0,n_sp_s]</code>.
Both these sampling schemes are aperiodic, the sampling period <code class="reqn">p_s</code> only influences the length <code class="reqn">t_n-t_1</code> of the series of observation times.                       
</p>
<p>For <code>ttype="sine"</code> and <code>ttype="trian"</code>, observation cycles <code class="reqn">z^\star_i</code> are drawn from a uniform distribution on <code class="reqn">\{1,\ldots,n_s\}</code> and observation phases <code class="reqn">\varphi^\star_i</code> are drawn from a density 
</p>
<p style="text-align: center;"><code class="reqn">d_{sine}(x)= \sin(2\pi x)+1</code>
</p>
<p> (for <code>ttype="sine"</code>) or  
</p>
<p style="text-align: center;"><code class="reqn">d_{trian}(x)= 3x, \quad  0\leq x\leq\frac{2}{3},</code>
</p>
 
<p style="text-align: center;"><code class="reqn">d_{trian}(x)= 6-6x, \quad \frac{2}{3}&lt;x\leq 1</code>
</p>
<p> (for <code>ttype="trian"</code>).
The unsorted observation times <code class="reqn">t^\star_i</code> are then generated using 
</p>
<p style="text-align: center;"><code class="reqn">t^\star_i= \varphi^\star_i+(z^\star_i-1)p_s.</code>
</p>

<p>Separately sampling observation cycle and phase was proposed by Hall and Yin (2003). For more details see Thieler, Fried and Rathjens (2016) or Thieler et al. (2013).
</p>


<h3>Value</h3>

<p>numeric vector: Ordered observation times.
</p>


<h3>Note</h3>

<p>To sample from <code class="reqn">d_{sine}</code>, the function <code>BBsolve</code>, package <code>BB</code>, is used. 
</p>
<p>A former version of this function is used in Thieler et al. (2013).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler and Jonathan Rathjens
</p>


<h3>References</h3>

<p>Hall, P. and Yin, J. (2003): Nonparametric Methods for Deconvolving Multiperiodic Functions. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 65 (4), 869-886
</p>
<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code>tsgen</code> (see there for an example).
</p>


</div>