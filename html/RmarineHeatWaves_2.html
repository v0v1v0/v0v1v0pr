<div class="container">

<table style="width: 100%;"><tr>
<td>block_average</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Yearly Means for Event Metrics.</h2>

<h3>Description</h3>

<p>Calculate Yearly Means for Event Metrics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">block_average(data, x = t, y = temp, report = "full")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Accepts the data returned by the <code>detect</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>This column is expected to contain a vector of dates as per the
specification of <code>make_whole</code>. If a column headed <code>t</code> is present in
the dataframe, this argument may be ommitted; otherwise, specify the name of
the column with dates here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>This is a column containing the measurement variable. If the column
name differs from the default (i.e. <code>temp</code>), specify the name here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report</code></td>
<td>
<p>Specify either <code>full</code> or <code>partial</code>. Selecting <code>full</code> causes
the report to contain NAs for any years in which no events were detected
(except for <code>count</code>, which will be zero in those years), while <code>partial</code>
reports only the years wherein events were detected. The default is <code>full</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function needs to be provided with the full output from the <code>detect</code>
function. Note that the yearly averages are calculted only for complete years
(i.e. years that start/end part-way through the year at the beginning or end
of the original time series are removed from the calculations).
</p>
<p>This function differs from the python implementation of the function of the
same name (i.e., <code>blockAverage</code>, see <a href="https://github.com/ecjoliver/marineHeatWaves">https://github.com/ecjoliver/marineHeatWaves</a>)
in that we only provide the ability to calculate the average (or aggregate)
event metrics in 'blocks' of one year, while the python version allows
arbitrary (integer) block sizes.
</p>


<h3>Value</h3>

<p>The function will return a data frame of the averaged (or aggregate)
metrics. It includes the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>The year over which the metrics were averaged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_mean</code></td>
<td>
<p>Seawater temperature for the specified year [deg. C].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_min</code></td>
<td>
<p>The minimum temperature for the specified year [deg. C].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_max</code></td>
<td>
<p>The maximum temperature for the specified year [deg. C].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>The number of events per year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p>The average duration of events per year [days].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_mean</code></td>
<td>
<p>The average event "mean intensity" in each year [deg. C].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_max</code></td>
<td>
<p>The average event "maximum (peak) intensity" in each year
[deg. C].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_var</code></td>
<td>
<p>The average event "intensity variability" in each year
[deg. C].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_cum</code></td>
<td>
<p>The average event "cumulative intensity" in each year
[deg. C x days].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate_onset</code></td>
<td>
<p>Average event onset rate in each year [deg. C / days].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate_decline</code></td>
<td>
<p>Average event decline rate in each year [deg. C / days].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_days</code></td>
<td>
<p>Total number of events days in each year [days].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_icum</code></td>
<td>
<p>Total cumulative intensity over all events in each year [deg. C x days].</p>
</td>
</tr>
</table>
<p><code>int_max_rel_thresh</code>, <code>int_mean_rel_thresh</code>,
<code>int_var_rel_thresh</code>, and <code>int_cum_rel_thresh</code>
are as above except relative to the threshold (e.g., 90th percentile) rather
than the seasonal climatology.
</p>
<p><code>int_max_abs</code>, <code>int_mean_abs</code>, <code>int_var_abs</code>, and
<code>int_cum_abs</code> are as above except as absolute magnitudes
rather than relative to the seasonal climatology or threshold.
</p>
<p><code>int_max_norm</code> and <code>int_mean_norm</code> are as above except
units are in multiples of threshold exceedances, i.e., a value of 1.5
indicates the event intensity (relative to the climatology) was 1.5 times the
value of the threshold (relative to climatology,
i.e., threshold - climatology.)
</p>


<h3>Author(s)</h3>

<p>Albertus J. Smit, Eric C. J. Oliver
</p>


<h3>References</h3>

<p>Hobday, A.J. et al. (2016), A hierarchical approach to defining
marine heatwaves, Progress in Oceanography, 141, pp. 227-238,
doi: 10.1016/j.pocean.2015.12.014
</p>


<h3>Examples</h3>

<pre><code class="language-R"># ts_dat &lt;- make_whole(sst_Med)
# res &lt;- detect(ts_dat, climatology_start = "1983-01-01",
#               climatology_end = "2012-12-31")
# out &lt;- block_average(res)
# summary(glm(count ~ year, out, family = "poisson"))

## Not run: 
plot(out$year, out$count, col = "salmon", pch = 16,
     xlab = "Year", ylab = "Number of events")
lines(out$year, out$count)

## End(Not run)
</code></pre>


</div>