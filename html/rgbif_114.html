<div class="container">

<table style="width: 100%;"><tr>
<td>occ_issues</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parse and examine further GBIF occurrence issues on a dataset.</h2>

<h3>Description</h3>

<p>Parse and examine further GBIF occurrence issues on a dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">occ_issues(.data, ..., mutate = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>Output from a call to <code>occ_search()</code>, <code>occ_data()</code>, or
<code>occ_download_import()</code>. The data from <code>occ_download_import</code>
is just a regular data.frame so you can pass in a data.frame to this
function, but if it doesn't have certain columns it will fail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Named parameters to only get back (e.g. cdround), or to
remove (e.g. -cdround).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutate</code></td>
<td>
<p>(character) One of:
</p>

<ul>
<li> <p><code>split</code> Split issues into new columns.
</p>
</li>
<li> <p><code>expand</code> Expand issue abbreviated codes into descriptive names.
for downloads datasets, this is not super useful since the
issues come to you as expanded already.
</p>
</li>
<li> <p><code>split_expand</code> Split into new columns, and expand issue names.
</p>
</li>
</ul>
<p>For split and split_expand, values in cells become y ("yes") or n ("no")</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See also the vignette <strong>Cleaning data using GBIF issues</strong>
</p>
<p>Note that you can also query based on issues, e.g.,
<code>occ_search(taxonKey=1, issue='DEPTH_UNLIKELY')</code>. However, I imagine
it's more likely that you want to search for occurrences based on a
taxonomic name, or geographic area, not based on issues, so it makes sense
to pull data down, then clean as needed using this function.
</p>
<p>This function only affects the <code>data</code> element in the <code>gbif</code> class that is
returned from a call to <code>occ_search()</code>. Maybe in a future version
we will remove the associated records from the <code>hierarchy</code> and <code>media</code>
elements as they are removed from the <code>data</code> element.
</p>
<p>You'll notice that we sort columns to make it easier to glimpse the important
parts of your data, namely taxonomic name, taxon key, latitude and longitude,
and the issues. The columns are unchanged otherwise.
</p>


<h3>References</h3>

<p>https://gbif.github.io/gbif-api/apidocs/org/gbif/api/vocabulary/OccurrenceIssue.html
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# what do issues mean, can print whole table
head(gbif_issues())
# or just occurrence related issues
gbif_issues()[which(gbif_issues()$type %in% c("occurrence")),]
# or search for matches
iss &lt;- c('cdround','cudc','gass84','txmathi')
gbif_issues()[ gbif_issues()$code %in% iss, ]

# compare out data to after occ_issues use
(out &lt;- occ_search(limit=100))
out %&gt;% occ_issues(cdround)

# occ_data
(out &lt;- occ_data(limit=100))
out %&gt;% occ_issues(cdround)

# Parsing output by issue
(res &lt;- occ_data(
  geometry='POLYGON((30.1 10.1,40 40,20 40,10 20,30.1 10.1))',
  limit = 600))

## or parse issues in various ways
### include only rows with cdround issue
gg &lt;- res %&gt;% occ_issues(cdround)
NROW(res$data)
NROW(gg$data)
head(res$data)[,c(1:5)]
head(gg$data)[,c(1:5)]

### remove data rows with certain issue classes
res %&gt;% occ_issues(-cdround, -cudc)

### split issues into separate columns
res %&gt;% occ_issues(mutate = "split")
res %&gt;% occ_issues(-cudc, -mdatunl, mutate = "split")
res %&gt;% occ_issues(gass84, mutate = "split")

### expand issues to more descriptive names
res %&gt;% occ_issues(mutate = "expand")

### split and expand
res %&gt;% occ_issues(mutate = "split_expand")

### split, expand, and remove an issue class
res %&gt;% occ_issues(-cdround, mutate = "split_expand")

## Or you can use occ_issues without %&gt;%
occ_issues(res, -cdround, mutate = "split_expand")

# from GBIF downloaded data via occ_download_* functions
res &lt;- occ_download_get(key="0000066-140928181241064", overwrite=TRUE)
x &lt;- occ_download_import(res)
occ_issues(x, -txmathi)
occ_issues(x, txmathi)
occ_issues(x, gass84)
occ_issues(x, zerocd)
occ_issues(x, gass84, txmathi)
occ_issues(x, mutate = "split")
occ_issues(x, -gass84, mutate = "split")
occ_issues(x, mutate = "expand")
occ_issues(x, mutate = "split_expand")

# occ_search/occ_data with many inputs - give slightly different output
# format than normal 2482598, 2498387
xyz &lt;- occ_data(taxonKey = c(9362842, 2492483, 2435099), limit = 300)
xyz
length(xyz) # length 3
names(xyz) # matches taxonKey values passed in
occ_issues(xyz, -gass84)
occ_issues(xyz, -cdround)
occ_issues(xyz, -cdround, -gass84)

## End(Not run)
</code></pre>


</div>