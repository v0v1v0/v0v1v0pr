<div class="container">

<table style="width: 100%;"><tr>
<td>mse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean Squared Error loss of a factor model</h2>

<h3>Description</h3>

<p>MSE of factor models <code>w</code> and <code>h</code> given sparse matrix <code class="reqn">A</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">mse(A, w, d = NULL, h, mask_zeros = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>matrix of features-by-samples in dense or sparse format (preferred classes are "matrix" or "Matrix::dgCMatrix", respectively). Prefer sparse storage when more than half of all values are zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>dense matrix of class <code>matrix</code> with factors (columns) by features (rows)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>diagonal scaling vector of rank length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>dense matrix of class <code>matrix</code> with samples (columns) by factors (rows)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask_zeros</code></td>
<td>
<p>handle zeros as missing values, available only when <code>A</code> is sparse</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mean squared error of a matrix factorization of the form <code class="reqn">A = wdh</code> is given by </p>
<p style="text-align: center;"><code class="reqn">\frac{\sum_{i,j}{(A - wdh)^2}}{ij}</code>
</p>
<p> where <code class="reqn">i</code> and <code class="reqn">j</code> are the number of rows and columns in <code class="reqn">A</code>.
</p>
<p>Thus, this function simply calculates the cross-product of <code class="reqn">wh</code> or <code class="reqn">wdh</code> (if <code class="reqn">d</code> is specified),
subtracts that from <code class="reqn">A</code>, squares the result, and calculates the mean of all values.
</p>
<p>If no diagonal scaling vector is present in the model, input <code>d = rep(1, k)</code> where <code>k</code> is the rank of the model.
</p>
<p><strong>Parallelization.</strong> Calculation of mean squared error is performed in parallel across columns in <code>A</code> using the number of threads set by <code>setRcppMLthreads</code>.
By default, all available threads are used, see <code>getRcppMLthreads</code>.
</p>


<h3>Value</h3>

<p>mean squared error of the factorization model
</p>


<h3>Author(s)</h3>

<p>Zach DeBruine
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(Matrix)
A &lt;- Matrix::rsparsematrix(1000, 1000, 0.1)
model &lt;- nmf(A, k = 10, tol = 0.01)
c_mse &lt;- mse(A, model$w, model$d, model$h)
R_mse &lt;- mean((A - model$w %*% Diagonal(x = model$d) %*% model$h)^2)
all.equal(c_mse, R_mse)

## End(Not run)
</code></pre>


</div>