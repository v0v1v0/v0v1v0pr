<div class="container">

<table style="width: 100%;"><tr>
<td>nei_simu</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating phenotypes with self and neighbor effects</h2>

<h3>Description</h3>

<p>A function to simulate phenotypes caused by self and neighbor effects, with the proportion of phenotypic variation explained (PVE) by fixed and random effects controlled.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nei_simu(
  geno,
  smap,
  scale,
  alpha = Inf,
  grouping = rep(1, nrow(smap)),
  kernel = c("exp", "gaussian"),
  n_causal,
  pveB,
  pve,
  b_ratio = c(1, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geno</code></td>
<td>
<p>An individual x marker matrix. Bialleles (i.e., A or a) must be converted into -1 or 1 digit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smap</code></td>
<td>
<p>A matrix showing a spatial map for individuals. The first and second column include spatial points along an x-axis and y-axis, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A numeric scalar indicating the maximum spatial distance between a focal individual and neighbors to define neighbor effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Distance decay coefficient <code class="reqn">\alpha</code> in a dispersal kernel. Default is set at Inf, meaning no distance decay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>A positive integer vector assigning each individual to a group. This argument can be useful when a "smap" contains different experimental replicates. Default setting means that all individuals are belong to a single group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>An option to select a negative exponential <code>"exp"</code> or Gaussian <code>"gaussian"</code> for a dispersal kernel of neighbor effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_causal</code></td>
<td>
<p>No. of causal markers in a simulated phenotype</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pveB</code></td>
<td>
<p>Proportion of phenotypic variation explained by fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pve</code></td>
<td>
<p>Proportion of phenotypic variation explained by fixed and random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_ratio</code></td>
<td>
<p>A vector composed of two numeric scalars that control the ratio of contributions of self or neighbor effects to a phenotype. The first and second element are for self and neighbor effects, respectively.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of simulated phenotype values for all individuals
</p>


<h3>Author(s)</h3>

<p>Yasuhiro Sato (<a href="mailto:sato.yasuhiro.36c@kyoto-u.jp">sato.yasuhiro.36c@kyoto-u.jp</a>)
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
g &lt;- matrix(sample(c(-1,1),100*1000,replace = TRUE),100,1000)
gmap &lt;- cbind(c(rep(1,nrow(g)/2),rep(2,nrow(g)/2)),c(1:ncol(g)))
x &lt;- runif(nrow(g),1,100)
y &lt;- runif(nrow(g),1,100)
smap &lt;- cbind(x,y)
grouping &lt;- c(rep(1,nrow(g)/2),rep(2,nrow(g)/2))
pheno &lt;- nei_simu(geno=g,smap=smap,scale=44,grouping=grouping,n_causal=50,pveB=0.4,pve=0.8)

fake_nei &lt;- list()
fake_nei[[1]] &lt;- g
fake_nei[[2]] &lt;- gmap
fake_nei[[3]] &lt;- smap
fake_nei[[4]] &lt;- data.frame(pheno,grouping)
names(fake_nei) &lt;- c("geno","gmap","smap","pheno")
</code></pre>


</div>