<div class="container">

<table style="width: 100%;"><tr>
<td>calcAgreement</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate agreement metric after integration</h2>

<h3>Description</h3>

<p>This metric quantifies how much the factorization and alignment distorts the
geometry of the original datasets. The greater the agreement, the less
distortion of geometry there is. This is calculated by performing
dimensionality reduction on the original and quantile aligned (or just
factorized) datasets, and measuring similarity between the k nearest
neighbors for each cell in original and aligned datasets. The Jaccard index
is used to quantify similarity, and is the final metric averages across all
cells.
</p>
<p>Note that for most datasets, the greater the chosen <code>nNeighbor</code>, the
greater the agreement in general. Although agreement can theoretically
approach 1, in practice it is usually no higher than 0.2-0.3.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcAgreement(
  object,
  ndims = 40,
  nNeighbors = 15,
  useRaw = FALSE,
  byDataset = FALSE,
  seed = 1,
  dr.method = NULL,
  k = nNeighbors,
  use.aligned = NULL,
  rand.seed = seed,
  by.dataset = byDataset
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>liger</code> object. Should call quantile_norm before calling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndims</code></td>
<td>
<p>Number of factors to produce in NMF. Default <code>40</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nNeighbors</code></td>
<td>
<p>Number of nearest neighbors to use in calculating Jaccard
index. Default <code>15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useRaw</code></td>
<td>
<p>Whether to evaluate just factorized <code class="reqn">H</code> matrices instead of
using quantile aligned <code class="reqn">H.norm</code> matrix. Default <code>FALSE</code> uses
aligned matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byDataset</code></td>
<td>
<p>Whether to return agreement calculated for each dataset
instead of the average for all datasets. Default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed to allow reproducible results. Default <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dr.method</code></td>
<td>
<p>[defunct] We no longer support other methods but just NMF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k, rand.seed, by.dataset</code></td>
<td>
<p>[Deprecated] See Usage for replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.aligned</code></td>
<td>
<p>[defunct] Use <code>useRaw</code> instead.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector of agreement metric. A single value if
<code>byDataset = FALSE</code> or each dataset a value otherwise.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("RcppPlanc", quietly = TRUE)) {
    pbmc &lt;- pbmc %&gt;%
    normalize %&gt;%
    selectGenes %&gt;%
    scaleNotCenter %&gt;%
    runINMF %&gt;%
    quantileNorm
    calcAgreement(pbmc)
}
</code></pre>


</div>