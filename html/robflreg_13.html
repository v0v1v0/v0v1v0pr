<div class="container">

<table style="width: 100%;"><tr>
<td>rob.ff.reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust function-on-function regression</h2>

<h3>Description</h3>

<p>This function is used to perform both classical and robust function-on-function regression model </p>
<p style="text-align: center;"><code class="reqn">
Y(t) = \sum_{m=1}^M \int X_m(s) \beta_m(s,t) ds + \epsilon(t),</code>
</p>
<p> where <code class="reqn">Y(t)</code> denotes the functional response, <code class="reqn">X_m(s)</code> denotes the <code class="reqn">m</code>-th functional predictor, <code class="reqn">\beta_m(s,t)</code> denotes the <code class="reqn">m</code>-th bivariate regression coefficient function, and <code class="reqn">\epsilon(t)</code> is the error function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rob.ff.reg(Y, X, model = c("full", "selected"), emodel = c("classical", "robust"),
 fmodel = c("MCD", "MLTS", "MM", "S", "tau"), nbasisY = NULL, nbasisX = NULL,
 gpY = NULL, gpX = NULL, ncompY = NULL, ncompX = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>An <code class="reqn">n \times p</code>-dimensional matrix containing the observations of functional response <code class="reqn">Y(t)</code>, where <code class="reqn">n</code> is the sample size and <code class="reqn">p</code> denotes the number of grid points for <code class="reqn">Y(t)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A list consisting of <code class="reqn">M</code> functional predictors <code class="reqn">X_m(s), 1\le m\le M</code>. Each element of <code>X</code> is an <code class="reqn">n \times p_m</code>-dimensional matrix containing the observations of <code class="reqn">m</code>-th functional predictor <code class="reqn">X_m(s)</code>, where <code class="reqn">n</code> is the sample size and <code class="reqn">p_m</code> denotes the number of grid points for <code class="reqn">X_m(s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model to be fitted. Possibilities are "full" and "selected".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emodel</code></td>
<td>
<p>Method to be used for functional principal component decomposition. Possibilities are "classical"" and "robust".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmodel</code></td>
<td>
<p>Fitting model used to estimate the function-on-function regression model. Possibilities are "MCD", "MLTS", "MM", "S", and "tau".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasisY</code></td>
<td>
<p>An integer value specifying the number of B-spline basis expansion functions to be used to approximate the functional principal components for the response variable <code class="reqn">Y(t)</code>. If <code>NULL</code>, then, <code class="reqn">min(20, p/4)</code> number of B-spline basis expansion functions are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasisX</code></td>
<td>
<p>A vector with length <code class="reqn">M</code>. Its <code class="reqn">m</code>-th value denotes the number of B-spline basis expansion functions to be used to approximate the functional principal components for the <code class="reqn">m</code>-th functional predictor <code class="reqn">X_m(s)</code>. If <code>NULL</code>, then, <code class="reqn">min(20, p_m/4)</code> number of B-spline basis expansion functions are used for each functional predictor, where <code class="reqn">p_m</code> denotes the number of grid points for <code class="reqn">X_m(s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpY</code></td>
<td>
<p>A vector containing the grid points of the functional response <code class="reqn">Y(t)</code>. If <code>NULL</code>, then <code class="reqn">p</code>
equally spaced time points in te interval [0, 1] are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpX</code></td>
<td>
<p>A list with length <code class="reqn">M</code>. The <code class="reqn">m</code>-th element of <code>gpX</code> is a vector containing the grid points of
the <code class="reqn">m</code>-th functional predictor <code class="reqn">X_m(s)</code>. If <code>NULL</code>, then, <code class="reqn">p_m</code> equally spaced time points in te interval
[0, 1] are used for the <code class="reqn">m</code>-th functional predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncompY</code></td>
<td>
<p>An integer specifying the number of functional principal components to be computed for the functional response <code class="reqn">Y(t)</code>. If <code>NULL</code>, then, the number whose usage results in at least 95% explained variation is used as the number of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncompX</code></td>
<td>
<p>A vector with length <code class="reqn">M</code>. Its <code class="reqn">m</code>-th value denotes the number of functional principal components to be computed for the <code class="reqn">m</code>-th functional predictor <code class="reqn">X_m(s)</code>. If <code>NULL</code>, then, for each functional predictor, the number whose usage results in at least 95% explained variation is used as the number of principal components.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When performing a function-on-function regression model based on the functional principal component analysis, first, both the functional response <code class="reqn">Y(t)</code> and functional predictors <code class="reqn">X_m(s), 1\le m\le M</code> are decomposed by the functional principal component analysis method: </p>
<p style="text-align: center;"><code class="reqn">Y(t) = \bar{Y}(t) + \sum_{k=1}^K \nu_k \phi_k(t),</code>
</p>
 <p style="text-align: center;"><code class="reqn">X_m(s) = \bar{X}_m(s) + \sum_{l=1}^{K_m} \xi_{ml} \psi_{ml}(s),</code>
</p>
<p> where <code class="reqn">\bar{Y}(t)</code> and <code class="reqn">\bar{X}_m(s)</code> are the mean functions, <code class="reqn">\phi_k(t)</code> and <code class="reqn">\psi_{ml}(s)</code> are the weight functions, and <code class="reqn">\nu_k = \int (Y(t) - \bar{Y}(t)) \phi_k(t)</code> and <code class="reqn">\xi_{ml} = \int (X_m(s) - \bar{X}_m(s)) \psi_{ml}(s)</code> are the principal component scores for the functional response and <code class="reqn">m</code>-th functional predictor, respectively. Assume that the <code class="reqn">m</code>-th bivariate regression coefficient function admits the expansion </p>
<p style="text-align: center;"><code class="reqn">\beta_m(s,t) = \sum_{k=1}^K \sum_{l=1}^{K_m} b_{mkl} \phi_k(t) \psi_{ml}(s),</code>
</p>
<p> where <code class="reqn">b_{mkl} = \int \int \beta_m(s,t) \phi_k(t) \psi_{ml}(s) dt ds</code>. Then, the following multiple regression model is obtained for the functional response: </p>
<p style="text-align: center;"><code class="reqn">\hat{Y}(t) = \bar{Y}(s) + \sum_{k=1}^K ( \sum_{m=1}^M \sum_{l=1}^{K_m} b_{mkl} \xi_{ml} ) \phi_k(t).</code>
</p>

<p>If <code>model = "full"</code>, then, all the functional predictor variables are used in the model.
</p>
<p>If <code>model = "selected"</code>, then, only the significant functional predictor variables determined by the forward variable selection procedure of Beyaztas and Shang (2021) are used in the model.
</p>
<p>If <code>emodel = "classical"</code>, then, the least-squares method is used to estimate the function-on-function regression model.
</p>
<p>If <code>emodel = "robust"</code>, then, the robust functional principal component analysis of Bali et al. (2011) along with the method specified in <code>fmodel</code> is used to estimate the  function-on-function regression model.
</p>
<p>If <code>fmodel = "MCD"</code>, then, the minimum covariance determinant estimator of Rousseeuw et al. (2004) is used to estimate the function-on-function regression model.
</p>
<p>If <code>fmodel = "MLTS"</code>, then, the multivariate least trimmed squares estimator Agullo et al. (2008) is used to estimate the function-on-function regression model.
</p>
<p>If <code>fmodel = "MM"</code>, then, the MM estimator of Kudraszow and Maronna (2011) is used to estimate the function-on-function regression model.
</p>
<p>If <code>fmodel = "S"</code>, then, the S estimator of Bilodeau and Duchesne (2000) is used to estimate the function-on-function regression model.
</p>
<p>If <code>fmodel = "tau"</code>, then, the tau estimator of Ben et al. (2006) is used to estimate the function-on-function regression model.
</p>


<h3>Value</h3>

<p>A list object with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A list of matrices including the original functional response and functional predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>An <code class="reqn">n \times p</code>-dimensional matrix containing the fitted values of the functional response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>An <code class="reqn">n \times p</code>-dimensional matrix containing the residual functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpca.results</code></td>
<td>
<p>A list object containing the functional principal component analysis results of the functional predictor and functional predictors variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.details</code></td>
<td>
<p>A list object containing model details, such as number of basis functions, number of principal components, and grid points used for each functional variable.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ufuk Beyaztas and Han Lin Shang
</p>


<h3>References</h3>

<p>J. Agullo and C. Croux and S. V. Aelst (2008), "The multivariate least-trimmed squares estimator", <em>Journal of Multivariate Analysis</em>, <b>99</b>(3), 311-338.
</p>
<p>M. G. Ben and E. Martinez and V. J. Yohai (2006), "Robust estimation for the multivariate linear model based on a <code class="reqn">\tau</code> scale", <em>Journal of Multivariate Analysis</em>, <b>97</b>(7), 1600-1622.
</p>
<p>U. Beyaztas and H. L. Shang (2021), "A partial least squares approach for function-on-function interaction regression", <em>Computational Statistics</em>, <b>36</b>(2), 911-939.
</p>
<p>J. L. Bali and G. Boente and D. E. Tyler and J. -L.Wang (2011), "Robust functional principal components: A projection-pursuit approach", <em>The Annals of Statistics</em>, <b>39</b>(6), 2852-2882.
</p>
<p>M. Bilodeau and P. Duchesne (2000), "Robust estimation of the SUR model", <em>The Canadian Journal of Statistics</em>, <b>28</b>(2), 277-288.
</p>
<p>N. L. Kudraszow and R. A. Moronna (2011), "Estimates of MM type for the multivariate linear model", <em>Journal of Multivariate Analysis</em>, <b>102</b>(9), 1280-1292.
</p>
<p>P. J. Rousseeuw and K. V. Driessen and S. V. Aelst and J. Agullo (2004), "Robust multivariate regression", <em>Technometrics</em>, <b>46</b>(3), 293-305.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sim.data &lt;- generate.ff.data(n.pred = 5, n.curve = 200, n.gp = 101)
Y &lt;- sim.data$Y
X &lt;- sim.data$X
gpY &lt;- seq(0, 1, length.out = 101) # grid points of Y
gpX &lt;- rep(list(seq(0, 1, length.out = 101)), 5) # grid points of Xs
model.MM &lt;- rob.ff.reg(Y = Y, X = X, model = "full", emodel = "robust",
                       fmodel = "MM", gpY = gpY, gpX = gpX)
</code></pre>


</div>