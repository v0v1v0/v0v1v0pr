<div class="container">

<table style="width: 100%;"><tr>
<td>calculateShiftBayesFactor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayes Factors in support of a shift in diversification rates over a given
time interval.</h2>

<h3>Description</h3>

<p>This function computes the Bayes Factor in favor of a rate-shift between
time t1 and t2 (t1 &lt; t2).
The default assumption (suitable to standard HSMRF and GMRF models) is
that the prior probability of a shift is 0.5.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculateShiftBayesFactor(
  rate_trace,
  time_trace,
  rate_name,
  time_name,
  t1,
  t2,
  prior_prob = 0.5,
  decrease = TRUE,
  return_2lnBF = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rate_trace</code></td>
<td>
<p>(list; no default) The processed Rev output of the rate
of interest through time for computation (output of readTrace()).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_trace</code></td>
<td>
<p>(list; no default) The processed Rev output of the
change/interval times of the rate of interest through time for computation
(output of readTrace()).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate_name</code></td>
<td>
<p>(character; no default) The name of the parameter
(e.g. "speciation") for which Bayes Factor is to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_name</code></td>
<td>
<p>(character; no default) The name of the interval times
(e.g. "interval_times) for the rate change times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>(numeric; no default) Support will be assessed for a shift between
time t1 and time t2 (t1 &lt; t2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>
<p>(numeric; no default) Support will be assessed for a shift between
time t1 and time t2 (t1 &lt; t2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_prob</code></td>
<td>
<p>(numeric; 0.5) The prior probability of a shift over this
interval (default of 0.5 applies to standard HSMRF- and GMRF-based models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decrease</code></td>
<td>
<p>(logical; default TRUE) Should support be assessed for a
decrease in the parameter (if TRUE) or an increase (if FALSE) between
t1 and t2?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_2lnBF</code></td>
<td>
<p>(logical; TRUE) Should the 2ln(BF) be returned
(if TRUE) or simply the BF (if FALSE)?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The Bayes Factor.
</p>


<h3>References</h3>

<p>Kass and Raftery (1995) Bayes Factors.
<em>JASA</em>, <b>90 (430)</b>, 773-795.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

#' # download the example datasets to working directory
url_times &lt;-
   "https://revbayes.github.io/tutorials/intro/data/primates_EBD_speciation_times.log"
dest_path_times &lt;- "primates_EBD_speciation_times.log"
download.file(url_times, dest_path_times)

url_rates &lt;-
   "https://revbayes.github.io/tutorials/intro/data/primates_EBD_speciation_rates.log"
dest_path_rates &lt;- "primates_EBD_speciation_rates.log"
download.file(url_rates, dest_path_rates)

# to run on your own data, change this to the path to your data file
speciation_time_file &lt;- dest_path_times
speciation_rate_file &lt;- dest_path_rates

speciation_times &lt;- readTrace(speciation_time_file, burnin = 0.25)
speciation_rate &lt;- readTrace(speciation_rate_file, burnin = 0.25)

calculateShiftBayesFactor(speciation_rate,
                          speciation_times,
                          "speciation",
                          "interval_times",
                          0.0,40.0,
                          decrease=FALSE)

# remove file
# WARNING: only run for example dataset!
# otherwise you might delete your data!
file.remove(dest_path_times, dest_path_rates)


</code></pre>


</div>