<div class="container">

<table style="width: 100%;"><tr>
<td>prob_statistic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Frequencies of the associations for the posterior probability trees</h2>

<h3>Description</h3>

<p>Computes frequencies (or residual/corrected frequencies) of the
host-symbiont associations for pairs (H and S) of posterior  probability
trees from the statistics generatedwith <code>GD</code> (Geodesic Distances),
<code>PACo</code> (PACo) or <code>ParaFit</code>(ParaFit).
</p>


<h3>Usage</h3>

<pre><code class="language-R">prob_statistic(
  ths,
  HS,
  mTreeH,
  mTreeS,
  freqfun = "paco",
  fx,
  percentile = 0.01,
  correction = "none",
  symmetric = FALSE,
  ei.correct = "none",
  algm = "maxcong",
  proc.warns = FALSE,
  strat = "sequential",
  cl = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ths</code></td>
<td>
<p>List of trimmed matrices produced by
<code>trimHS_maxC()</code> or
<code>trimHS_maxI()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HS</code></td>
<td>
<p>Host-Symbiont association matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mTreeH</code></td>
<td>
<p>Number of posterior-probability trees of host.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mTreeS</code></td>
<td>
<p>Number of posterior-probability trees of symbiont.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqfun</code></td>
<td>
<p>The global-fit method to compute using the
posterior probability trees. Options are <code>"geoD"</code> (Geodesic
Distances), <code>"paco"</code> (PACo) or <code>"paraF"</code> (ParaFit).
It should be the same method used to obtain <code>"fx"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>Vector of statistics produced with
<code>max_cong()</code> or
<code>max_incong()</code> for GD, PACo or
ParaFit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentile</code></td>
<td>
<p>Percentile to evaluate (<em>p</em>). Default is
<code>0.01</code> (1\%).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>Correction to be assumed. The default value is
<code>"none"</code>. If <code>= "res.fq"</code>, a residual frequency value
(observed - expected frequency) is computed for each host-symbiont
association that maximizes phylogenetic congruence. If
<code>= "diff.fq"</code>, a corrected frequency value
(observed in p - observed in (p-1)) is computed for each
host-symbiont association.
It should be the same correction used to obtain <code>"fx"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>Specifies the type of Procrustes superimposition. Default
is <code>FALSE</code>, indicates that the superposition is applied
asymmetrically (S depends on H). If <code>TRUE</code>, PACo is applied
symmetrically (dependency between S and H is reciprocal).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ei.correct</code></td>
<td>
<p>Specifies how to correct potential negative eigenvalues
from the conversion of phylogenetic distances into Principal
Coordinates: <code>"none"</code> (the default) indicates that no correction
is applied, particularly if H and S are ultrametric; <code>"sqrt.D"</code>
takes the element-wise square-root of the phylogenetic distances;
<code>"lingoes"</code> and <code>"cailliez"</code> apply the classical Lingoes
and Cailliez corrections, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algm</code></td>
<td>
<p>Only required if <code>correction = "none"</code>. Specifies the
algorithm that has been used to obtain
<code>"fx"</code> without correction. Use <code>= "maxcong"</code> for
<code>max_cong()</code>, and <code>= "maxincong"</code> for
<code>max_incong()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proc.warns</code></td>
<td>
<p>Switches on/off trivial warnings returned when treeH and
treeS differ in size (number of tips). Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> expressions sequentially in the current <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> expressions in parallel in
separate <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> sessions running in the background.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code>parallelly::availableCores()</code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with the value of the statistics for each of the
probability trees.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("nuc_cp")
N = 10 #for the example, we recommend 1e+4 value
n = 15
# Maximizing congruence (not run)
NPc &lt;- max_cong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                symmetric = FALSE, ei.correct = "sqrt.D",
                percentile = 0.01, strat = "parallel", cl = 8)
THSc &lt;- trimHS_maxC(N, np_matrix, n)
pp_treesPACOo_cong &lt;- prob_statistic(THSc, np_matrix, NUC_500tr[1:10],
                         CP_500tr[1:10], freqfun = "paco", NPc,
                         percentile = 0.01, correction = "none",
                         algm = "maxcong", symmetric = FALSE,
                         ei.correct = "sqrt.D",
                         strat = "parallel", cl = 8)

# Maximizing incongruence
NPi &lt;- max_incong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                  symmetric = FALSE, ei.correct = "sqrt.D",
                  percentile = 0.99, diff.fq = TRUE)
THSi &lt;- trimHS_maxI(N, np_matrix, n)
pp_treesPACOo_incong &lt;- prob_statistic(THSi, np_matrix, NUC_500tr[1:5],
                                 CP_500tr[1:5], freqfun = "paco", NPi,
                                 percentile = 0.99, correction = "diff.fq",
                                 symmetric = FALSE, ei.correct = "sqrt.D",
                                 strat = "parallel", cl = 8)


</code></pre>


</div>