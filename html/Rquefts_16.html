<div class="container">

<table style="width: 100%;"><tr>
<td>predict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Spatial QUEFTS model predictions
</h2>

<h3>Description</h3>

<p>Make spatial predictions with a QUEFTS model. First create a model, then use the model with a SpatRaster of soil properties to make spatial predictions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Rcpp_QueftsModel'
predict(object, supply, yatt, leaf_ratio, stem_ratio, 
		var="yield", filename="", overwrite=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>QUEFTSModel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supply</code></td>
<td>
<p>SpatRaster with nutrient supply data (Ns, Ps, Ks)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yatt</code></td>
<td>
<p>SpatRaster with attainable yield</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leaf_ratio</code></td>
<td>
<p>positive numeric (typically between 0 and 1) indicating the leaf weight relative to the storage organ weight. For example: 0.46 for maize, 0.17 for potato, and 0.18 for rice</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stem_ratio</code></td>
<td>
<p>positive numeric (typically between 0 and 1) indicating the stem weight relative to the storage organ weight, For example: 0.56 for maize, 0.14 for potato, and 0.67 for rice</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>character. Output variable name. Either "yield" or "gap"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>character. Output filename. Optional</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code>filename</code> is overwritten</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>list. Options for writing files as in <code>writeRaster</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(terra)

ff &lt;- list.files(system.file("sp", package="Rquefts"), full.names=TRUE)
r &lt;- rast(ff)

soil &lt;- r[[c("Tavg", "pH", "SOC", "Kex", "Pex", "Ptot")]]
supply &lt;- lapp(soil, nutSupply2)
plot(supply)

yatt &lt;- rast(system.file("sp/Ya.tif", package="Rquefts"))

maize &lt;- quefts_crop("Maize")
fertilizer &lt;- list(N=0, P=0, K=0)
q &lt;- quefts(crop=maize, fert=fertilizer)

p &lt;- predict(q, supply, yatt, 0.46, 0.56)
plot(p)

g &lt;- predict(q, supply, yatt, 0.46, 0.56, "gap")
plot(g)
</code></pre>


</div>