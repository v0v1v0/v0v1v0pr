<div class="container">

<table style="width: 100%;"><tr>
<td>svyreg_huberM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Huber Robust Survey Regression M- and GM-Estimator</h2>

<h3>Description</h3>

<p><code>svyreg_huberM</code> and <code>svyreg_huberGM</code> compute, respectively,
a survey weighted <em>M</em>- and <em>GM</em>-estimator of regression using
the Huber psi-function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">svyreg_huberM(formula, design, k, var = NULL, na.rm = FALSE, asym = FALSE,
              verbose = TRUE, ...)
svyreg_huberGM(formula, design, k, type = c("Mallows", "Schweppe"),
               xwgt, var = NULL, na.rm = FALSE, asym = FALSE, verbose = TRUE,
               ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>[formula]</code> object (i.e., symbolic description
of the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>an object of class <code>survey.design</code>; see
<code>svydesign</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p><code>[double]</code> robustness tuning constant
(<code class="reqn">0 &lt; k \leq \infty</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>a one-sided <code>[formula]</code> object or variable name
(<code>[character]</code>) that defines the heteroscedastic variance
or <code>[NULL]</code> indicating homoscedastic variance (default:
<code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p><code>[logical]</code> indicating whether <code>NA</code> values should
be removed before the computation proceeds (default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asym</code></td>
<td>
<p><code>[logical]</code> toggle for asymmetric Huber psi-function
(default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>[logical]</code> indicating whether additional information
is printed to the console (default: <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>[character]</code> <code>"Mallows"</code> or <code>"Schweppe"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xwgt</code></td>
<td>
<p><code>[numerical vector]</code> or <code>[NULL]</code> of weights in
the design space (default: <code>NULL</code>); <code>xwgt</code> is only
relevant for <code>type = "Mallows"</code> or <code>type = "Schweppe"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to the method (e.g., <code>maxit</code>:
maxit number of iterations, etc.).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Package <span class="pkg">survey</span> must be attached to the search path in order to use
the functions (see <code>library</code> or <code>require</code>).
</p>
<p><code>svyreg_huberM</code> and <code>svyreg_huberGM</code> compute, respectively,
<em>M</em>- and <em>GM</em>-estimates of regression by iteratively re-weighted
least squares (IRWLS).  The estimate of regression scale is (by default)
computed as the (normalized) weighted median of absolute deviations
from the weighted median (MAD; see <code>weighted_mad</code>) for
each IRWLS iteration. If the weighted MAD is zero (or nearly so),
the scale is computed as the (normalized) weighted interquartile
range (IQR).
</p>

<dl>
<dt>M-estimator</dt>
<dd>
<p>The regression M-estimator <code>svyreg_huberM</code> is robust against
residual outliers (granted that the tuning constant <code>k</code> is
chosen appropriately).
</p>
</dd>
<dt>GM-estimator</dt>
<dd>
<p>Function <code>svyreg_huberGM</code> implements the Mallows and Schweppe
regression GM-estimator (see argument <code>type</code>).
The regression GM-estimators are robust against residual outliers
<em>and</em> outliers in the model's design space (leverage
observations; see argument <code>xwgt</code>).
</p>
</dd>
<dt>Numerical optimization</dt>
<dd>
<p>See <code>svyreg_control</code>.
</p>
</dd>
<dt>Models</dt>
<dd>
<p>Models for <code>svyreg_rob</code> are specified symbolically. A typical
model has the form <code>response ~ terms</code>, where <code>response</code>
is the (numeric) response vector and <code>terms</code> is a series of
terms which specifies a linear predictor for <code>response</code>; see
<code>formula</code> and <code>lm</code>.
</p>
<p>A formula has an implied intercept term. To remove this use
either <code>y ~ x - 1</code> or <code>y ~ 0 + x</code>; see
<code>formula</code> for more details of allowed formulae.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>Object of class <code>svyreg.rob</code>
</p>


<h3>Failure of convergence</h3>

<p>By default, the method assumes a maximum number of <code>maxit = 100</code>
iterations and a numerical tolerance criterion to stop the iterations of
<code>tol = 1e-05</code>. If the algorithm fails to converge, you may
consider changing the default values; see <code>svyreg_control</code>.
</p>


<h3>See Also</h3>

<p>Overview (of all implemented functions)
</p>
<p>Overview (of all implemented functions)
</p>
<p><code>summary</code>, <code>coef</code>,
<code>residuals</code>, <code>fitted</code>,
<code>SE</code> and <code>vcov</code>
</p>
<p><code>plot</code> for regression diagnostic plot methods
</p>
<p>Other robust estimating methods <code>svyreg_tukeyM</code> and
<code>svyreg_tukeyGM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">head(workplace)

library(survey)
# Survey design for stratified simple random sampling without replacement
dn &lt;- if (packageVersion("survey") &gt;= "4.2") {
        # survey design with pre-calibrated weights
        svydesign(ids = ~ID, strata = ~strat, fpc = ~fpc, weights = ~weight,
                  data = workplace, calibrate.formula = ~-1 + strat)
    } else {
        # legacy mode
        svydesign(ids = ~ID, strata = ~strat, fpc = ~fpc, weights = ~weight,
                  data = workplace)
    }

# Compute regression M-estimate with Huber psi-function
m &lt;- svyreg_huberM(payroll ~ employment, dn, k = 8)

# Regression inference
summary(m)

# Extract the coefficients
coef(m)

# Extract variance/ covariance matrix
vcov(m)

# Diagnostic plots (e.g., standardized residuals against fitted values)
plot(m, which = 1L)

# Plot of the robustness weights of the M-estimate against its residuals
plot(residuals(m), robweights(m))
</code></pre>


</div>