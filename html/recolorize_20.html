<div class="container">

<table style="width: 100%;"><tr>
<td>colorResiduals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate squared residuals for color centers</h2>

<h3>Description</h3>

<p>Calculates the squared distance between each pixel and its assigned color
center.
</p>


<h3>Usage</h3>

<pre><code class="language-R">colorResiduals(
  pixel_matrix,
  pixel_assignments,
  centers,
  color_space = "Lab",
  metric = "euclidean",
  ref_white = "D65"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pixel_matrix</code></td>
<td>
<p>2D matrix of pixels to classify (rows = pixels, columns =
channels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pixel_assignments</code></td>
<td>
<p>A vector of color center assignments for each
pixel. Must match the order of <code>pixel_matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>A matrix of color centers, with rows as centers and
columns as color channels. Rows are assumed to match the index values of
<code>pixel_assignments</code>, e.g. a pixel assigned <code>1</code> in the assignment vector
is assigned to the color in the first row of <code>centers</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_space</code></td>
<td>
<p>Color space in which to calculate distances. One of
"sRGB", "Lab", "Luv", or "XYZ". Passed to
<code>convertColor</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>Distance metric to be used for calculating pairwise pixel
distances in the given color space; passed to <code>dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_white</code></td>
<td>
<p>Passed to <code>convertColor</code> if
<code style="white-space: pre;">⁠color_space = "Lab⁠</code>. Reference white for CIE Lab space.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following attributes:
</p>

<ol>
<li> <p><code>sq_residuals</code>: The squared residual for every pixel in pixel_matrix.
</p>
</li>
<li> <p><code>tot_residuals</code>: The sum of all squared residuals.
</p>
</li>
<li> <p><code>avg_residual</code>: The average squared residual.
</p>
</li>
<li> <p><code>residuals_by_center</code>: A list of squared residuals for every color center.
</p>
</li>
<li> <p><code>avg_by_center</code>: The average squared residual for every color center.
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R"># RGB extremes (white, black, red, green, blue, yellow, magenta, cyan)
ctrs &lt;- matrix(c(1, 1, 1,
                 0, 0, 0,
                 1, 0, 0,
                 0, 1, 0,
                 0, 0, 1,
                 1, 1, 0,
                 1, 0, 1,
                 0, 1, 1), byrow = TRUE, ncol = 3)

# plot it
recolorize::plotColorPalette(ctrs)

# create a pixel matrix of random colors
pixel_matrix &lt;- matrix(runif(3000), ncol = 3)

# assign pixels
# see `assignPixels` function for details
reassigned &lt;- assignPixels(ctrs, pixel_matrix, adjust_centers = TRUE)

# find residuals from original color centers
color_residuals &lt;- colorResiduals(pixel_matrix = pixel_matrix,
                                  pixel_assignments = reassigned$pixel_assignments,
                                  centers = ctrs)

# compare to residuals from adjusted color centers
color_residuals_adjust &lt;- colorResiduals(pixel_matrix = pixel_matrix,
                                  pixel_assignments = reassigned$pixel_assignments,
                                  centers = reassigned$centers)
# to reset graphical parameters:
current_par &lt;- graphics::par(no.readonly = TRUE)

layout(matrix(1:2, nrow = 2))
hist(color_residuals$sq_residuals,
 breaks = 30, border = NA, col = "tomato",
 xlim = c(0, 1), xlab = "Squared residual",
 main = "Original centers")

hist(color_residuals_adjust$sq_residuals,
breaks = 30, border = NA, col = "cornflowerblue",
xlim = c(0, 1), xlab = "Squared residual",
main = "Adjusted centers")

graphics::par(current_par)
</code></pre>


</div>