<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_lambda_group</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>calculates factor loadings of groupfactors</h2>

<h3>Description</h3>

<p>returns object which includes group and id of the individuals
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_lambda_group(
  Y,
  X,
  beta_est,
  factor_group,
  g,
  lambda,
  comfactor,
  S,
  k,
  kg,
  robust,
  method_estimate_beta = "individual",
  method_estimate_factors = "macro",
  verbose = FALSE,
  initialise = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Y: NxT dataframe with the panel data of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>X: NxTxp array containing the observable variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_est</code></td>
<td>
<p>estimated values of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_group</code></td>
<td>
<p>estimated group specific factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Vector with estimated group membership for all individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>loadings of the estimated common factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comfactor</code></td>
<td>
<p>estimated common factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>number of estimated groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of common factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kg</code></td>
<td>
<p>number of group specific factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>TRUE or FALSE: defines using the classical or robust algorithm to estimate beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_estimate_beta</code></td>
<td>
<p>defines how beta is estimated. Default case is an estimated beta for each individual. Default value is "individual." Possible values are "homogeneous", "group" or "individual".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_estimate_factors</code></td>
<td>
<p>defines method of robust estimaton of the factors: "macro", "pertmm" or "cz"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>when TRUE, it prints messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialise</code></td>
<td>
<p>indicator of being in the initialisation phase</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a data.frame with a row for each time series. The first number of columns contain the individual loadings to the group specific factors.
Furthermore "group" (group membership) and id (the order in which the time series appear in Y) are added.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#' #example with data generated with DGP 2
data &lt;- create_data_dgp2(30, 10)
Y &lt;- data[[1]]
X &lt;- data[[2]]
g &lt;- data[[3]] #true group membership
set.seed(1)
beta_est &lt;- matrix(rnorm(4 * nrow(Y)), nrow = 4)
factor_group &lt;- data[[5]] #true values of group specific factors
comfactor &lt;- matrix(0, nrow = 1, ncol = ncol(Y))
lambda &lt;- matrix(0, nrow = 1, ncol = nrow(Y))
calculate_lambda_group(Y, X, beta_est, factor_group, g, lambda, comfactor,
3, 0, c(3, 3, 3), TRUE)
</code></pre>


</div>