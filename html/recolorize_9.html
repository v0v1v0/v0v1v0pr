<div class="container">

<table style="width: 100%;"><tr>
<td>backgroundIndex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Index and remove background pixels for color clustering</h2>

<h3>Description</h3>

<p>Largely internal function for identifying, indexing, and removing background
pixels from an image.
</p>


<h3>Usage</h3>

<pre><code class="language-R">backgroundIndex(img, bg_condition)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>img</code></td>
<td>
<p>An image array, preferably the output of <code>readPNG</code>,
<code>readJPEG</code>, or <code>link[recolorize]{readImage}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg_condition</code></td>
<td>
<p>Background condition, output of
<code>backgroundCondition</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function flattens a 3-channel image into a 2D matrix before indexing and
removing background pixels to take advantage of faster indexing procedures.
The <code>idx</code>, <code>idx_flat</code>, and <code>img_dims</code> elements are used to reconstruct the
original and recolored images by other functions.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ol>
<li> <p><code>flattened_img</code>: The original image, flattened into a 2D matrix
(rows = pixels, columns = channels).
</p>
</li>
<li> <p><code>img_dims</code>: Dimensions of the original image.
</p>
</li>
<li> <p><code>non_bg</code>: Pixels from <code>flattened_img</code> that fall outside the
background masking conditions. Used for further color clustering and
analysis.
</p>
</li>
<li> <p><code>idx</code>: 2D (row-column) indices for background pixels.
</p>
</li>
<li> <p><code>idx_flat</code>: Same as <code>idx</code>, but flattened to vector order.
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R"># get image path and read in image
img_path &lt;- system.file("extdata/chongi.png", package = "recolorize")
img &lt;- png::readPNG(img_path)
recolorize::plotImageArray(img)

# generate a white background condition
bg_condition &lt;- backgroundCondition(lower = rep(0.9, 3),
                                    upper = rep(1, 3))

# index background pixels
bg_indexed &lt;- backgroundIndex(img, bg_condition)

# we can reconstruct the original image from the flattened array
img2 &lt;- bg_indexed$flattened_img
dim(img2) &lt;- bg_indexed$img_dims

# notice the original background color (light gray) now shows
recolorize::plotImageArray(img2)

</code></pre>


</div>