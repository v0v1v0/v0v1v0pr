<div class="container">

<table style="width: 100%;"><tr>
<td>butfilt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Butterworth filter</h2>

<h3>Description</h3>

<p>Design and apply butterworth low/high/band pass filters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">butfilt(a, fl=0, fh=0.5, deltat=1, type="BP", proto="BU",
 npoles=5, chebstop=30.0, trbndw=0.3, RM=FALSE, zp=TRUE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>vector signal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fl</code></td>
<td>
<p>low frequency cut-off, default=0 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fh</code></td>
<td>
<p>high frequency cut-off, DEFAULT= (1/2dt) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltat</code></td>
<td>
<p>sample rate, s, deFAULT=1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of filter, one of c("LP",  "HP","BP" ,"BR" ), DEFAULT="BP" </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proto</code></td>
<td>
<p>prototype, c("BU", "BE" , "C1" ,"C2"), DEFAULT="BU"  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoles</code></td>
<td>
<p>number of poles or order, DEFAULT=5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chebstop</code></td>
<td>
<p>Chebyshev stop band attenuation, DEFAULT=30.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trbndw</code></td>
<td>
<p>Chebyshev transition bandwidth, DEFAULT=0.3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RM</code></td>
<td>
<p>Remove mean value from trace, default=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zp</code></td>
<td>
<p>zero phase filter, default=TRUE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Creation of butfilt is a described by the following arguments:
</p>

<dl>
<dt>LP</dt>
<dd>
<p>low pass  </p>
</dd>
<dt>HP</dt>
<dd>
<p>high pass </p>
</dd>
<dt>BP</dt>
<dd>
<p>band pass </p>
</dd>
<dt>BR</dt>
<dd>
<p>band reject </p>
</dd>
<dt>BU</dt>
<dd>
<p>Butterworth </p>
</dd>
<dt>BE</dt>
<dd>
<p>Bessel </p>
</dd>
<dt>C1</dt>
<dd>
<p>Chebyshev type 1 </p>
</dd>
<dt>C2</dt>
<dd>
<p>Chebyshev type 2 </p>
</dd>
</dl>
<p>Arguments chebstop , trbndw  are ignored for non-chebyshev filters.
LP and HP filters are seet by specifying fl for HP filters and fh for
LP filters, the other argumentin each case is ignored.
</p>
<p>Mean values should be removed prior to calling this function, and then set RM=FALSE.
This is true especially if tapering is applied prior to filtering.
</p>
<p>Zero phase filter is achived by running filter back and forth.  Otherwise
a single pass is returned.  This should be equivalent to package signal filtfilt (from MATLAB).
</p>


<h3>Value</h3>

<p>Filtered time series. 
</p>


<h3>Author(s)</h3>

<p>originally written in FORTRAN by David Harris,
converted to C and modified by Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;</p>


<h3>References</h3>

<p>Harris, D., 1990: XAPiir: A recursive digital filtering
package. United States: N. p., Web. doi:10.2172/6416972.</p>


<h3>See Also</h3>

<p>AUGMENTbutfilt</p>


<h3>Examples</h3>

<pre><code class="language-R">data(CE1)

ts1  &lt;-  CE1$y
zz  &lt;-  butfilt(ts1, fl=1, fh=15,  deltat=CE1$dt, type="LP" ,  proto="BU",
npoles=5 )



###  try plotting:

### the above, by default, is zero phase.
#####  next filter with non-zero-phase
z2  &lt;-  butfilt(ts1, fl=1, fh=15,  deltat=CE1$dt, type="LP" ,  proto="BU",
npoles=5, zp=FALSE )
ex = seq(from=0, by=CE1$dt, length=length(ts1))

plot(ex,  ts1, type='l')
lines(ex, zz, col='red')
lines(ex, z2, col='blue')


plot(ex[ex&lt;0.5],  ts1[ex&lt;0.5], type='l')
lines(ex[ex&lt;0.5], zz[ex&lt;0.5], col='red')
lines(ex[ex&lt;0.5], z2[ex&lt;0.5], col='blue')



</code></pre>


</div>