<div class="container">

<table style="width: 100%;"><tr>
<td>generate_gauss_mfdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generation of gaussian multivariate functional data</h2>

<h3>Description</h3>

<p><code>generate_gauss_mfdata</code> generates a dataset of multivariate functional
data with a desired mean and covariance function in each dimension and a
desired correlation structure among components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_gauss_mfdata(
  N,
  L,
  centerline,
  correlations,
  listCov = NULL,
  listCholCov = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the number of distinct functional observations to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>the number of components of the multivariate functional data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerline</code></td>
<td>
<p>the centerline of the distribution, represented as a
2-dimensional data structure with L rows (one for each dimension) having the
measurements along the grid as columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlations</code></td>
<td>
<p>is the vector containing the <code class="reqn">1/2 L (L-1)</code>
correlation coefficients <code class="reqn">\rho_{ij}</code> in the model generating data.
They have to be provided in the following order:
</p>
<p style="text-align: center;"><code class="reqn">(\rho_{1,2},\ldots,\rho_{1,L},\rho_{2,3},\ldots,\rho_{2,L},\ldots,
\rho_{L,L-1}),</code>
</p>

<p>that is to say, the row-wise, upper triangular part of the correlation matrix
without the diagonal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listCov</code></td>
<td>
<p>a list containing the <code class="reqn">L</code> covariance operators (provided
in form of a <code class="reqn">P \times P</code> matrix), one for each component of the
multivariate functional random variable, that have to be used in the
generation of the processes <code class="reqn">\epsilon_1(t), \ldots, \epsilon_L(t)</code>.
At least one argument between <code>listCov</code> and <code>listCholCov</code> must be
different from <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listCholCov</code></td>
<td>
<p>the Cholesky factor of the <code class="reqn">L</code> covariance operators
(in <code class="reqn">P \times P</code> matrix form), one for each component of the
multivariate functional random variable, that have to be used in the
generation of the processes <code class="reqn">\epsilon_1(t), \ldots, \epsilon_L(t)</code>.
At least one argument between <code>listCov</code> and <code>listCholCov</code> must be
different from <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In particular, the following model is considered for the generation of data:
</p>
<p style="text-align: center;"><code class="reqn">X(t) = ( m_1( t ) + \epsilon_1( t ), \ldots, m_L(t) +
 \epsilon_L(t)), \quad t \in I = [a, b]</code>
</p>

<p>where <code class="reqn">L</code> is the number of components of the multivariate functional
random variable, <code class="reqn">m_i(t)</code> is the <code class="reqn">i-</code>th component of the center and
<code class="reqn">\epsilon_i(t)</code> is a centered gaussian process with covariance function
<code class="reqn">C_i</code>. That is to say:
</p>
<p style="text-align: center;"><code class="reqn">Cov( \epsilon_{i}(s), \epsilon_{i}(t) ) = C( s, t ), \quad \forall i =
 1, \ldots, L, \quad \forall s, t \in I</code>
</p>

<p>A correlation structure among <code class="reqn">\epsilon_1(t),\ldots,\epsilon_L(t)</code> is
allowed in the following way:
</p>
<p style="text-align: center;"><code class="reqn"> Cor( \epsilon_i(t), \epsilon_j(t)) = \rho_{i,j}, \quad \forall
i \neq j, \quad \forall t \in I.</code>
</p>

<p>All the functions are supposed to be observed on an evenly-spaced, one-
dimensional grid of P points: <code class="reqn">[ a = t_0, t_1, \ldots, t_{P-1} = b]
\subset I </code>.
</p>


<h3>Value</h3>

<p>The function returns a list of L matrices, one for each component of
the multivariate functional random variable, containing the discretized
values of the generated observations (in form of <code class="reqn">N \times P</code>
matrices).
</p>


<h3>See Also</h3>

<p><code>exp_cov_function</code>, <code>mfData</code>,
<code>generate_gauss_fdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
N = 30
P = 1e2
L = 3

time_grid = seq( 0, 1, length.out = P )

C1 = exp_cov_function( time_grid, alpha = 0.1, beta = 0.2 )
C2 = exp_cov_function( time_grid, alpha = 0.2, beta = 0.5 )
C3 = exp_cov_function( time_grid, alpha = 0.3, beta = 1 )


centerline = matrix( c( sin( 2 * pi * time_grid ),
                        sqrt( time_grid ),
                        10 * ( time_grid - 0.5 ) * time_grid ),
                     nrow = 3, byrow = TRUE )

generate_gauss_mfdata( N, L, centerline,
                       correlations = c( 0.5, 0.5, 0.5 ),
                       listCov = list( C1, C2, C3 ) )

CholC1 = chol( C1 )
CholC2 = chol( C2 )
CholC3 = chol( C3 )

generate_gauss_mfdata( N, L, centerline,
                       correlations = c( 0.5, 0.5, 0.5 ),
                      listCholCov = list( CholC1, CholC2, CholC3 ) )

</code></pre>


</div>