<div class="container">

<table style="width: 100%;"><tr>
<td>reference_allele_counts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tabulate occurrences of all observed alleles in reference genetic data</h2>

<h3>Description</h3>

<p>Takes the first output of <code>tcf2long</code>, along with two columns named "collection" and "sample_type",
and returns a data frame of allele counts for each locus within each reference population.
Alleles to be counted are identified from both reference and mixture populations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reference_allele_counts(D, pop_level = "collection")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A data frame containing, at minimum, a column of sample group identifiers named
"collection", a column designating each row as "reference" or "mixture", named "sample_type",
and (from tcf2long output) locus, gene copy, and observed alleles. If higher-level reporting
unit counts are desired, must have a column of reporting unit identifiers named "repunit"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_level</code></td>
<td>
<p>a character vector expressing the population level for which allele counts
should be tabulated. Set to "collection" for collection/underlying sample group (default),
or "repunit" for reporting unit/overlying sample groups</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The "collection" column should be a key assigning samples to the desired groups,
e.g. collection site, run time, year.
The "sample_type" column must contain either "reference" or "mixture" for each sample.
</p>


<h3>Value</h3>

<p><code>reference_allele_counts</code> returns a long-format dataframe, with count data for
each collection, locus, and allele. Counts are only drawn from "reference" samples; alleles
unique to the "mixture" samples will still appear in the list, but will have 0s for all groups.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## count alleles in alewife reference populations
example(tcf2long)  # gets variable ale_long
ale_rac &lt;- reference_allele_counts(ale_long$long)

</code></pre>


</div>