<div class="container">

<table style="width: 100%;"><tr>
<td>rtk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rarefy tables</h2>

<h3>Description</h3>

<p> Rarefy datasets in R or from a path. </p>


<h3>Usage</h3>

<pre><code class="language-R">rtk(input, repeats = 10, depth = 1000, ReturnMatrix = 0, margin = 2,
    verbose = FALSE, threads = 1, tmpdir = NULL, seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>This can be either a numeric matrix or a path to a text file in tab-delimited format on the locally available storage. The later option is for very big matrices, to avoid unnecessary memory consumption in R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeats</code></td>
<td>
<p>Number of times to compute diversity measures. (<code>default: 10</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>Number of elements per row/column to rarefy to. The so called rarefaction depth or samplesize. Can also be a vector of ints. (<code>default: 1000</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ReturnMatrix</code></td>
<td>
<p>Number of rarefied matrices which are returned to R. Set to zero to only measure diversity. (<code>default: 1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>Indicates which margin in the matrix represents the Samples and Species. Default is to rarefy assuming columns represent single samples (margin=2). If margin=1, rows are assumed to be samples. (default: 2 (columns))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If extra output should be printed to std::out or not to see progress of rarefaction. (<code>default: TRUE)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>Number of threads to use during rarefaction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmpdir</code></td>
<td>
<p>Location to store temporary files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Set seed to integer &gt; 0 to get reproducible results. <code>default: 0</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>rare</code> takes a dataset and calcualtes the diversity measures, namely the shannon diversity, richness, simpson index, the inverse simpson index, chao1 and evenness.
</p>
<p>If wished for the function can also return one or multiple rarefied matrices rarefied to one or multiple depths. Those can then also be used to create collectorcurves (see <code>collectors.curve</code>).
</p>


<h3>Value</h3>

<p>The function <code>rare</code> returns an object of class 'rarefaction',  containing the  objects <code>divvs</code>, <code>raremat</code>, <code>skipped</code>, <code>div.median</code> and <code>depths</code>. If more than one depth was computed the elements 1-4 are inside a list themself and can be acessed by the index of the desired depth.
</p>
<p>The object <code>divvs</code> contains a list of diversity measures for each sample provieded.
</p>
<p><code>raremat</code> is one or multiple rarefied matrices. Samples with not enough counts are removed, thus not all <code>raremat</code>-matrices for different depths might be of the same size. If and which sampels where excluded is denoted in the element <code>skipped</code> using the names of the respective samples.
</p>
<p><code>depths</code> just contains the input variable and might be usefull for further analysis of the results.
</p>
<p>It is possible to plot the results of the rarefaction, depending on the parameters passed to <code>rare</code>. See <code>plot.rtk</code> for examples.
</p>


<h3>Author(s)</h3>

<p>Paul Saary, Falk Hildebrand</p>


<h3>References</h3>

<p>Saary, Paul, et al. "RTK: efficient rarefaction analysis of large datasets." 
Bioinformatics (2017): btx206.
</p>


<h3>See Also</h3>

<p><code>plot.rtk</code>, <code>collectors.curve</code></p>


<h3>Examples</h3>

<pre><code class="language-R">require("rtk")
# generate semi sparse example data
data            &lt;- matrix(sample(x = c(rep(0, 1500),rep(1:10, 500),1:1000),
                          size = 120, replace = TRUE), 10)
# find the column with the lowest aboundance
samplesize      &lt;- min(colSums(data))
# rarefy the dataset, so each column contains the same number of samples
data.rarefied   &lt;- rtk(input = data, depth = samplesize, ReturnMatrix = 1)

richness   &lt;- get.diversity(data.rarefied, div = "richness")
eveness    &lt;- get.diversity(data.rarefied, div = "eveness")

</code></pre>


</div>