<div class="container">

<table style="width: 100%;"><tr>
<td>pp_check.evpost</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior predictive checks for an evpost object</h2>

<h3>Description</h3>

<p><code>pp_check</code> method for class "evpost".  This provides an interface
to the functions that perform posterior predictive checks in the
<strong>bayesplot</strong> package.  See PPC-overview for
details of these functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'evpost'
pp_check(
  object,
  ...,
  type = c("stat", "overlaid", "multiple", "intervals", "user"),
  subtype = NULL,
  stat = "median",
  nrep = 8,
  fun = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class "evpost", a result of a call to
<code>rpost</code> or <code>rpost_rcpp</code>.
Currently <code>object$model = "gev"</code>,
<code>"gp"</code>, <code>"bingp"</code> and <code>"pp"</code> are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to bayesplot functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character vector.  The type of bayesplot plot required:
</p>

<ul>
<li>
<p> "stat" for predictive test statistics
(see PPC-test-statistics),
</p>
</li>
<li>
<p> "overlaid" for comparison of observed data to predictive simulated
datasets using overlaid density function or distribution functions
(see PPC-distributions),
</p>
</li>
<li>
<p> "multiple" for comparison of observed data to predictive simulated
datasets using multiple summary plots
(see PPC-distributions),
</p>
</li>
<li>
<p> "intervals" for comparison of observed data to predictive simulated
datasets using sample medians and a predictive interval,
(see PPC-intervals),
</p>
</li>
<li>
<p> "user" for direct access to the default bayesplot function
<code>pp_check</code>.  This requires the argument
<code>fun</code> to be supplied
(see pp_check).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtype</code></td>
<td>
<p>A character scalar.  Specifies the form of the plot(s)
produced.  Could be one of
<code>"dens", "hist", "boxplot", "ribbon"</code> or <code>"intervals"</code>.
If <code>subtype</code> is not supplied then the defaults are:
<code>"ecdf"</code> if <code>type = overlaid</code>,
<code>"dens"</code> if <code>type = multiple</code>,
<code>"intervals"</code> if <code>type = intervals</code>.
<code>subtype</code> is not relevant if <code>type = "stat"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>See PPC-test-statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>If <code>type = "multiple"</code> the maximum number of
summary plots of the predictive simulated datasets to include.
If <code>nrep</code> is greater than <code>nrow(object$data_rep)</code> then
<code>nrep</code> is set equal to <code>nrow(object$data_rep)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>The plotting function to call.
Only relevant if <code>type = "user"</code>.
Can be any of the functions detailed at PPC-overview.
The "ppc_" prefix can optionally be dropped if fun is specified
as a string.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For details of these functions see PPC-overview.
See also the vignette
<a href="https://CRAN.R-project.org/package=revdbayes">Posterior Predictive Extreme Value Inference</a>
and the <strong>bayesplot</strong> vignette
<a href="https://CRAN.R-project.org/package=bayesplot">Graphical posterior predictive checks</a>.
</p>
<p>The general idea is to compare the observed data <code>object$data</code>
with a matrix <code>object$data_rep</code> in which each row is a
replication of the observed data simulated from the posterior predictive
distribution.  For greater detail see Chapter 6 of Gelman et al. (2013).
</p>
<p>The format of <code>object$data</code> depends on the model:
</p>

<ul>
<li> <p><code>model = "gev"</code>. A vector of block maxima.
</p>
</li>
<li> <p><code>model = "gp"</code>. Data that lie above the threshold,
i.e. threshold exceedances.
</p>
</li>
<li> <p><code>model = "bingp"</code> or <code>model = "pp"</code>. The input data are
returned but any value lying below the threshold is set to
<code>object$thresh</code>.
</p>
</li>
</ul>
<p>In all cases any missing values have been removed from the data.
</p>
<p>If <code>model = "bingp"</code> or <code>"pp"</code> the rate of threshold exceedance
is part of the inference.  Therefore, the number of values in
<code>object$data_rep</code> that lie above the threshold varies between
predictive replications, with values below the threshold being
left-censored at the threshold.  This limits a little the posterior
predictive checks that it is useful to perform.  In the examples below
we have compared <code>object$data</code> and <code>object$data_rep</code> using
only their sample maxima.
</p>


<h3>Value</h3>

<p>A ggplot object that can be further customized using the
<strong>ggplot2</strong> package.
</p>


<h3>References</h3>

<p>Jonah Gabry (2016). bayesplot: Plotting for Bayesian
Models. R package version 1.1.0.
<a href="https://CRAN.R-project.org/package=bayesplot">https://CRAN.R-project.org/package=bayesplot</a>
</p>
<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B.,
Vehtari, A., and Rubin, D. B. (2013). <em>Bayesian Data Analysis</em>.
Chapman &amp; Hall/CRC Press, London, third edition. (Chapter 6)
</p>


<h3>See Also</h3>

<p><code>rpost</code> and <code>rpost_rcpp</code> for sampling
from an extreme value posterior distribution.
</p>
<p><strong>bayesplot</strong> functions PPC-overview,
PPC-distributions,
PPC-test-statistics,
PPC-intervals,
pp_check.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# GEV model
data(portpirie)
mat &lt;- diag(c(10000, 10000, 100))
pn &lt;- set_prior(prior = "norm", model = "gev", mean = c(0,0,0), cov = mat)
gevp  &lt;- rpost(1000, model = "gev", prior = pn, data = portpirie,
               nrep = 50)

# Posterior predictive test statistics
pp_check(gevp)
pp_check(gevp, stat = "min")
pp_check(gevp, stat = c("min", "max"))
iqr &lt;- function(y) diff(quantile(y, c(0.25, 0.75)))
pp_check(gevp, stat = "iqr")

# Overlaid density and distributions functions
pp_check(gevp, type = "overlaid")
pp_check(gevp, type = "overlaid", subtype = "dens")

# Multiple plots
pp_check(gevp, type = "multiple")
pp_check(gevp, type = "multiple", subtype = "hist")
pp_check(gevp, type = "multiple", subtype = "boxplot")

# Intervals
pp_check(gevp, type = "intervals")
pp_check(gevp, type = "intervals", subtype = "ribbon")

# User-supplied bayesplot function
# Equivalent to p_check(gevp, type = "overlaid")
pp_check(gevp, type = "user", fun = "dens_overlay")

# GP model
u &lt;- quantile(gom, probs = 0.65)
fp &lt;- set_prior(prior = "flat", model = "gp", min_xi = -1)
gpg &lt;- rpost(n = 1000, model = "gp", prior = fp, thresh = u,
             data = gom, nrep = 50)
pp_check(gpg)
pp_check(gpg, type = "overlaid")

# bin-GP model
bp &lt;- set_bin_prior(prior = "jeffreys")
bgpg &lt;- rpost(n = 1000, model = "bingp", prior = fp, thresh = u,
              data = gom, bin_prior = bp, nrep = 50)
pp_check(bgpg, stat = "max")

# PP model
data(rainfall)
rthresh &lt;- 40
pf &lt;- set_prior(prior = "flat", model = "gev", min_xi = -1)
ppr &lt;- rpost(n = 1000, model = "pp", prior = pf, data = rainfall,
             thresh = rthresh, noy = 54, nrep = 50)
pp_check(ppr, stat = "max")

</code></pre>


</div>