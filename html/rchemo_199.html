<div class="container">

<table style="width: 100%;"><tr>
<td>wdist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distance-based weights</h2>

<h3>Description</h3>

<p>Calculation of weights from a vector of distances using a decreasing inverse exponential function.
</p>
<p>Let <code class="reqn">d</code> be a vector of distances. 
</p>
<p>1- Preliminary weights are calculated by <code class="reqn">w = exp(-d / (h * mad(d)))</code> , where <code class="reqn">h</code> is a scalar &gt; 0 (scale factor).  
</p>
<p>2- The weights corresponding to distances higher than <code class="reqn">median(d) + cri * mad(d)</code>, where <code class="reqn">cri</code> is a scalar &gt; 0, are set to zero. This step is used for removing outliers. 
</p>
<p>3- Finally, the weights are "normalized" between 0 and 1 by <code class="reqn">w = w / max(w)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wdist(d, h, cri = 4, squared = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>A vector of distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>A scaling factor (positive scalar). Lower is <code class="reqn">h</code>, sharper is the decreasing function. See the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cri</code></td>
<td>
<p>A positive scalar used for defining outliers in the distances vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>Logical. If <code>TRUE</code>, distances <code class="reqn">d</code> are replaced by the squared distances in the decreasing function, which corresponds to a Gaussian (RBF) kernel function. Default to <code class="reqn">FALSE)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of weights.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x1 &lt;- sqrt(rchisq(n = 100, df = 10))
x2 &lt;- sqrt(rchisq(n = 10, df = 40))
d &lt;- c(x1, x2)
h &lt;- 2 ; cri &lt;- 3
w &lt;- wdist(d, h = h, cri = cri)

oldpar &lt;- par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
plot(d)
hist(d, n = 50)
plot(w, ylim = c(0, 1)) ; abline(h = 1, lty = 2)
plot(d, w, ylim = c(0, 1)) ; abline(h = 1, lty = 2)
par(oldpar)

d &lt;- seq(0, 15, by = .5)
h &lt;- c(.5, 1, 1.5, 2.5, 5, 10, Inf)
for(i in 1:length(h)) {
  w &lt;- wdist(d, h = h[i])
  z &lt;- data.frame(d = d, w = w, h = rep(h[i], length(d)))
  if(i == 1) res &lt;- z else res &lt;- rbind(res, z)
  }
res$h &lt;- as.factor(res$h)
headm(res)
plotxy(res[, c("d", "w")], asp = 0, group = res$h, pch = 16)

</code></pre>


</div>