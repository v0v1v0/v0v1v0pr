<div class="container">

<table style="width: 100%;"><tr>
<td>Generalized.Rational.Kriging</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Rational Kriging</h2>

<h3>Description</h3>

<p>This functions fits the generalized rational kriging model to the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Generalized.Rational.Kriging(
  X,
  y,
  fit = TRUE,
  kernel = NULL,
  kernel.parameters = list(),
  nlopt.parameters = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix for input (feature)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector for output (target), only one-dimensional output is supported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>whether to fit the length scale parameters from data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>a kernel class object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel.parameters</code></td>
<td>
<p>a list of parameters required for the kernel, if no kernel class object is provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlopt.parameters</code></td>
<td>
<p>a list of parameters required for NLopt, including choice of optimization algorithm and maximum number of evaluation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Ordinary kriging and rational kriging can be obtained as special cases of generalized rational kriging. 
Please see Joseph (2024) for details. 
The <a href="https://spectralib.org/">Spectra</a> library is used for fast computation of the first eigenvalues/vectors. 
Only interpolation is available. Noisy output is not supported for generalized rational kriging.  
</p>
<p>The kernel choices are required and can be specified by 
(i) providing the kernel class object to <code>kernel</code>
or (ii) specifying the kernel type and other parameters in <code>kernel.parameters</code>. 
Please see examples section of Fit.Kriging for detail usages. 
</p>
<p>When the lengthscale / correlation parameters are unknown, 
all parameters including the constant mean can be estimated via Maximum Likelihood method by setting <code>fit=TRUE</code>. 
The initial / lower bound / upper bound of the lengthscale parameters can be provided in <code>kernel.parameters</code>, 
otherwise a good initial and range would be estimated from the data. 
The optimization is performed via <a href="https://nlopt.readthedocs.io/en/latest/">NLopt</a> library, 
a open-source library for nonlinear optimization. 
All gradient-free optimization methods in <a href="https://nlopt.readthedocs.io/en/latest/">NLopt</a> 
are supported and can be specified in <code>nlopt.parameters</code>.
See <code>nloptr::nloptr.print.options()</code> for the list of available derivative-free algorithms (prefix with NLOPT_GN or NLOPT_LN).  
The maximum number of optimization steps can also be defined in <code>nlopt.parameters</code>.
Please see examples section of Fit.Kriging for detail usages.
</p>


<h3>Value</h3>

<p>A Generalized Rational Kriging Class Object.
</p>


<h3>Author(s)</h3>

<p>Chaofan Huang and V. Roshan Joseph
</p>


<h3>References</h3>

<p>Joseph, V. R. (2024). Rational Kriging. <em>Journal of the American Statistical Association</em>.
</p>
<p>Qiu, Y., Guennebaud, G., &amp; Niesen, J. (2015). Spectra: C++ library for large scale eigenvalue problems.
</p>


<h3>See Also</h3>

<p>Fit.Kriging, Predict.Kriging, Get.Kriging.Parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># one dimensional example 
f &lt;- function(x) {
  x &lt;- 0.5 + 2*x
  y &lt;- sin(10*pi*x)/(2*x) + (x-1)^4
  return (y)
}

set.seed(1234)
# train set
n &lt;- 30
p &lt;- 1
X &lt;- matrix(runif(n),ncol=p)
y &lt;- apply(X, 1, f)
newX &lt;- matrix(seq(0,1,length=1001), ncol=p)

# approach 1
kriging &lt;- Generalized.Rational.Kriging(X, y, fit=TRUE, 
                                        kernel.parameters=list(type="RQ",alpha=1))
pred &lt;- Predict.Kriging(kriging, newX)
plot(newX, f(newX), "l")
points(X, y, pch=16, col="blue")
lines(newX, pred$mean, col="red", lty=2)
lines(newX, pred$mean-2*pred$sd, col="red", lty=3)
lines(newX, pred$mean+2*pred$sd, col="red", lty=3)
Get.Kriging.Parameters(kriging)

# approach 2
kriging &lt;- Fit.Kriging(X, y, interpolation=TRUE, fit=TRUE, model="GRK",
                       kernel.parameters=list(type="RQ",alpha=1))
pred &lt;- Predict.Kriging(kriging, newX)
plot(newX, f(newX), "l")
points(X, y, pch=16, col="blue")
lines(newX, pred$mean, col="red", lty=2)
lines(newX, pred$mean-2*pred$sd, col="red", lty=3)
lines(newX, pred$mean+2*pred$sd, col="red", lty=3)
Get.Kriging.Parameters(kriging)

</code></pre>


</div>