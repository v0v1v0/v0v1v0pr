<div class="container">

<table style="width: 100%;"><tr>
<td>sEddyProc_sMRFluxPartition</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>sEddyProc sMRFluxPartition</h2>

<h3>Description</h3>

<p>Nighttime-based partitioning of net ecosystem fluxes into gross fluxes GPP and REco</p>


<h3>Usage</h3>

<pre><code class="language-R">sEddyProc_sMRFluxPartition(FluxVar = if (missing(FluxVar.s)) "NEE_f" else FluxVar.s, 
    QFFluxVar = if (missing(QFFluxVar.s)) "NEE_fqc" else QFFluxVar.s, 
    QFFluxValue = if (missing(QFFluxValue.n)) 0L else QFFluxValue.n, 
    TempVar = if (missing(TempVar.s)) "Tair_f" else TempVar.s, 
    QFTempVar = if (missing(QFTempVar.s)) "Tair_fqc" else QFTempVar.s, 
    QFTempValue = if (missing(QFTempValue.n)) 0 else QFTempValue.n, 
    RadVar = if (missing(RadVar.s)) "Rg" else RadVar.s, 
    TRef = if (missing(T_ref.n)) 273.15 + 
        15 else T_ref.n, suffix = if (missing(Suffix.s)) "" else Suffix.s, 
    FluxVar.s, QFFluxVar.s, QFFluxValue.n, 
    TempVar.s, QFTempVar.s, QFTempValue.n, 
    RadVar.s, T_ref.n, Suffix.s, debug.l, 
    debug = if (!missing(debug.l)) debug.l else list(useLocaltime = FALSE), 
    parsE0Regression = list())</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>FluxVar</code></td>
<td>
<p>Variable
name of column with original and
filled net ecosystem fluxes (NEE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QFFluxVar</code></td>
<td>
<p>Quality
flag of NEE variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QFFluxValue</code></td>
<td>
<p>Value
of quality flag for _good_ (original) data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TempVar</code></td>
<td>
<p>Filled
air- or soil temperature variable (degC)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QFTempVar</code></td>
<td>
<p>Quality
flag of filled temperature variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QFTempValue</code></td>
<td>
<p>Value
of temperature quality flag for _good_
(original) data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RadVar</code></td>
<td>
<p>Unfilled
(original) radiation variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TRef</code></td>
<td>
<p>Reference
temperature in Kelvin (degK)
used in <code>fLloydTaylor</code> for regressing Flux and Temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>String
suffix needed for different processing
setups on the same dataset (for explanations see below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FluxVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QFFluxVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QFFluxValue.n</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TempVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QFTempVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QFTempValue.n</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RadVar.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_ref.n</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Suffix.s</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug.l</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>List
with debugging control
(passed also to <code>sEddyProc_sRegrE0fromShortTerm</code>
for providing <code>fixedE0 = myE0</code>).</p>

<dl>
<dt>useLocaltime</dt>
<dd>
<p>see details on solar vs local time</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parsE0Regression</code></td>
<td>
<p>list
with further parameters passed down to
<code>sEddyProc_sRegrE0fromShortTerm</code> and <code>fRegrE0fromShortTerm</code>,
such as <code>TempRange</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<dl>
<dt>
Description of newly generated variables with partitioning results:</dt>
<dd>

<ul>
<li>
<p> PotRad - Potential radiation <br></p>
</li>
<li>
<p> FP_NEEnight - Good (original) NEE nighttime fluxes used for flux partitioning <br></p>
</li>
<li>
<p> FP_Temp - Good (original) temperature measurements used for flux partitioning <br></p>
</li>
<li>
<p> E_0 - Estimated temperature sensitivity <br></p>
</li>
<li>
<p> R_ref - Estimated reference respiration <br></p>
</li>
<li>
<p> Reco - Estimated ecosystem respiration <br></p>
</li>
<li>
<p> GPP_f - Estimated gross primary production <br></p>
</li>
</ul>
</dd>
</dl>
<dl>
<dt>Background</dt>
<dd>
<p>This partitioning is based on the regression of nighttime respiration with
temperature using the Lloyd-Taylor-Function <code>fLloydTaylor</code>.
First the temperature sensitivity E_0 is estimated from short term data,
see <code>sEddyProc_sRegrE0fromShortTerm</code>.
Next the reference temperature R_ref is estimated for successive periods
throughout the whole dataset (see <code>sEddyProc_sRegrRref</code>).
These estimates are then used to calculate the respiration during daytime
and nighttime and with this GPP.
Attention: Gap filling of the net ecosystem fluxes (NEE) and temperature
measurements (Tair or Tsoil) is required
prior to the partitioning!
</p>
</dd>
</dl>
<dl>
<dt>Selection of daytime data based on solar time</dt>
<dd>
<p>The respiration-temperature regression is very
sensitive to the selection of night- and daytime data.
Nighttime is selected by a combined threshold of current solar radiation
and potential radiation.
The current implementation calculates potential radiation based on exact
solar time, based on latitude and longitude.
(see <code>fCalcPotRadiation</code>)
Therefore it might differ from implementations that use local winter
clock time instead.
</p>
</dd>
</dl>
<dl>
<dt>Different processing setups on the same dataset</dt>
<dd>
<p>Attention: When processing the same site data set with different setups for
the gap filling or flux partitioning
(e.g. due to different ustar filters),
a string suffix is needed! This suffix is added to the result column names
to distinguish the results of the different setups.
If a suffix is provided and if the defaults for FluxVar and QFFluxVar
are used, the suffix will be added to their variable names
(e.g. 'NEE_f' will be renamed to 'NEE_uStar_f' and 'NEE_fqc' to
'NEE_uStar_fqc' for the suffix = 'uStar').
Currently, this works only with defaults of FluxVar = 'NEE_f'
and QFFluxVar = 'NEE_fqc'.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>Flux partitioning results (see variables in details) in sTEMP data frame
(with renamed columns).
On success, return value is NULL. On failure an integer scalar error code
is returned:
-111 if regression of E_0 failed due to insufficient relationship in the data.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>References</h3>

<p>Reichstein M, Falge E, Baldocchi D et al. (2005) On the separation of
net ecosystem exchange
into assimilation and ecosystem respiration: review and improved algorithm.
Global Change Biology, 11, 1424-1439.</p>


</div>