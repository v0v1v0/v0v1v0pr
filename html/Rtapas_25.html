<div class="container">

<table style="width: 100%;"><tr>
<td>tangle_gram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tanglegram of the host-symbiont frequencies</h2>

<h3>Description</h3>

<p>Maps the estimated (in)congruence metrics of the individual host-symbiont
associations as heatmap on a tanglegram. It also plots the average frequency
(or residual/corrected frequency) of occurrence of each terminal
and optionally, the fast maximum likelihood estimators of ancestral states
of each node.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tangle_gram(
  treeH,
  treeS,
  HS,
  fqtab,
  colscale = "diverging",
  colgrad,
  nbreaks = 50,
  node.tag = TRUE,
  cexpt = 1,
  link.lwd = 1,
  link.lty = 1,
  fsize = 0.5,
  pts = FALSE,
  link.type = "straight",
  ftype = "i",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>treeH</code></td>
<td>
<p>Host phylogeny. An object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeS</code></td>
<td>
<p>Symbiont phylogeny. An object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HS</code></td>
<td>
<p>Host-symbiont association matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fqtab</code></td>
<td>
<p>Dataframe produced with <code>max_cong()</code> or
<code>max_incong()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colscale</code></td>
<td>
<p>Choose between <code>"diverging"</code>, color reflects distance
from 0 (centered at 0, recommended if <code>"res.fq = TRUE"</code>)
or <code>"sequential"</code>, color reflects distance from minimum value
(spanning from the min to max frequencies observed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colgrad</code></td>
<td>
<p>Vector of R specified colors defining the color gradient of
the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbreaks</code></td>
<td>
<p>Number of discrete values along <code>"colgrad"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.tag</code></td>
<td>
<p>Specifies whether maximum likelihood estimators of ancestral
states are to be computed. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexpt</code></td>
<td>
<p>Size of color points at terminals and nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.lwd</code></td>
<td>
<p>Line width for plotting, default to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.lty</code></td>
<td>
<p>Line type. Coded as <code>lty</code> in
<code>par()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsize</code></td>
<td>
<p>Relative font size for tip labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>Logical value indicating whether or not to plot filled circles at
each vertex of the tree, as well as at transition points between
mapped states. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.type</code></td>
<td>
<p>If curved linking lines are desired, set to <code>"curved"</code>.
Default is <code>"straight"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftype</code></td>
<td>
<p>Font type. Options are <code>"reg"</code>, <code>"i"</code>
(italics), <code>"b"</code> (bold) or <code>"bi"</code> (bold-italics).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any graphical option admissible in
<code>phytools::plot.cophylo()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tanglegram with quantitative information displayed as heatmap.
</p>


<h3>NOTE</h3>

<p>In order to calculate the ancestral states in the phylogenies, all
nodes of the trees (node.label) must have a value (NA or
empty values are not allowed). In addition, the trees must be
time-calibrated and preferably rooted. If one of these elements
is missing, an error will be generated and nodes and points of
terminals will be displayed as black.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nuc_cp)
N = 10 #for the example, we recommend 1e+4 value
n = 8
NPc &lt;- max_cong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                symmetric = TRUE, ei.correct = "sqrt.D",
                percentile = 0.01, res.fq = FALSE,
                strat = "parallel", cl = 4)
col = c("darkorchid4", "gold")
tangle_gram(NUCtr, CPtr, np_matrix, NPc, colscale = "sequential",
            colgrad = col, nbreaks = 50, node.tag = TRUE)


</code></pre>


</div>