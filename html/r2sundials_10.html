<div class="container">

<table style="width: 100%;"><tr>
<td>r2sundials-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Wrapper for 'SUNDIALS' Solving ODE and Sensitivity Problem
</h2>

<h3>Description</h3>

<p>Wrapper for widely used 'SUNDIALS' software (SUite of Nonlinear and DIfferential/ALgebraic Equation Solvers) and more precisely to its 'CVODES' solver. It is aiming to solve ordinary differential equations (ODE) and optionally pending forward sensitivity problem. The wrapper is made 'R' friendly by allowing to pass custom parameters to user's callback functions. Such functions can be both written in 'R' and in 'C++' ('RcppArmadillo' flavor). In case of 'C++', performance is greatly improved so this option is highly advisable when performance matters. If provided, Jacobian matrix can be calculated either in dense or sparse format. In the latter case 'rmumps' package is used to solve corresponding linear systems. Root finding and pending event management are optional and can be specified as 'R' or 'C++' functions too. This makes them a very flexible tool for controlling the ODE system during the time course simulation. 'SUNDIALS' library was published in Hindmarsh et al. (2005) &lt;doi:10.1145/1089014.1089020&gt;.
Interface for commonly used SUNDIALS library for solving ODE system. It is made R friendly by allowing to pass custom parameters to user's callback functions. They can be both written in R and in C++ (Rcpp flavor). In case of C++, performance is greatly improved so this option is highly advisable when performance matters. Jacobian matrix can be specified as either dense or sparse matrix. In the latter case <span class="pkg">rmumps</span> package is used to solve corresponding linear systems. Root finding and corresponding event management are optional and can be too specified as R or C++ functions which makes them a very flexible tool for controlling the ODE system during the time course simulation.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> r2sundials</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Wrapper for 'SUNDIALS' Solving ODE and Sensitivity Problem</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 6.5.0-5</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-07-22</td>
</tr>
<tr>
<td style="text-align: left;">
Authors@R: </td>
<td style="text-align: left;"> c(
   person("Serguei", "Sokol", role=c("cre", "aut"), email="sokol@insa-toulouse.fr"),
   person("Carol S.", "Woodward", role="ctb"),
   person("Daniel R.", "Reynolds", role="ctb"),
   person("Alan C.", "Hindmarsh", role="ctb"),
   person("David J.", "Gardner", role="ctb"),
   person("Cody J.", "Balos", role="ctb"),
   person("Radu", "Serban", role="ctb"),
   person("Scott D.", "Cohen", role="ctb"),
   person("Peter N.", "Brown", role="ctb"),
   person("George", "Byrne", role="ctb"),
   person("Allan G.", "Taylor", role="ctb"),
   person("Steven L.", "Lee", role="ctb"),
   person("Keith E.", "Grant", role="ctb"),
   person("Aaron", "Collier", role="ctb"),
   person("Lawrence E.", "Banks", role="ctb"),
   person("Steve", "Smith", role="ctb"),
   person("Cosmin", "Petra", role="ctb"),
   person("Slaven", "Peles", role="ctb"),
   person("John", "Loffeld", role="ctb"),
   person("Dan", "Shumaker", role="ctb"),
   person("Ulrike", "Yang", role="ctb"),
   person("James", "Almgren-Bell", role="ctb"),
   person("Shelby L.", "Lockhart", role="ctb"),
   person("Hilari C.", "Tiedeman", role="ctb"),
   person("Ting", "Yan", role="ctb"),
   person("Jean M.", "Sexton", role="ctb"),
   person("Chris", "White", role="ctb"),
   person("Lawrence Livermore National Security", role="cph"),
   person("Southern Methodist University", role="cph"),
   person("INSA", role="cph"),
   person("INRAE", role="cph"),
   person("CNRS", role="cph")
   )</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Serguei Sokol &lt;sokol@insa-toulouse.fr&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Wrapper for widely used 'SUNDIALS' software (SUite of Nonlinear and DIfferential/ALgebraic Equation Solvers) and more precisely to its 'CVODES' solver. It is aiming to solve ordinary differential equations (ODE) and optionally pending forward sensitivity problem. The wrapper is made 'R' friendly by allowing to pass custom parameters to user's callback functions. Such functions can be both written in 'R' and in 'C++' ('RcppArmadillo' flavor). In case of 'C++', performance is greatly improved so this option is highly advisable when performance matters. If provided, Jacobian matrix can be calculated either in dense or sparse format. In the latter case 'rmumps' package is used to solve corresponding linear systems. Root finding and pending event management are optional and can be specified as 'R' or 'C++' functions too. This makes them a very flexible tool for controlling the ODE system during the time course simulation. 'SUNDIALS' library was published in Hindmarsh et al. (2005) &lt;doi:10.1145/1089014.1089020&gt;.</td>
</tr>
<tr>
<td style="text-align: left;">
BugReports: </td>
<td style="text-align: left;"> https://github.com/sgsokol/r2sundials/issues</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> R (&gt;= 3.0.2), rmumps (&gt;= 5.2.1-6)</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> Rcpp (&gt;= 1.0.0)</td>
</tr>
<tr>
<td style="text-align: left;">
LinkingTo: </td>
<td style="text-align: left;"> Rcpp, RcppArmadillo, rmumps (&gt;= 5.2.1-6)</td>
</tr>
<tr>
<td style="text-align: left;">
Suggests: </td>
<td style="text-align: left;"> RcppXPtrUtils, slam, RUnit, deSolve, RcppArmadillo</td>
</tr>
<tr>
<td style="text-align: left;">
RoxygenNote: </td>
<td style="text-align: left;"> 7.2.3</td>
</tr>
<tr>
<td style="text-align: left;">
Encoding: </td>
<td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
<td style="text-align: left;">
NeedsCompilation: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
Biarch: </td>
<td style="text-align: left;"> FALSE</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Serguei Sokol [cre, aut],
  Carol S. Woodward [ctb],
  Daniel R. Reynolds [ctb],
  Alan C. Hindmarsh [ctb],
  David J. Gardner [ctb],
  Cody J. Balos [ctb],
  Radu Serban [ctb],
  Scott D. Cohen [ctb],
  Peter N. Brown [ctb],
  George Byrne [ctb],
  Allan G. Taylor [ctb],
  Steven L. Lee [ctb],
  Keith E. Grant [ctb],
  Aaron Collier [ctb],
  Lawrence E. Banks [ctb],
  Steve Smith [ctb],
  Cosmin Petra [ctb],
  Slaven Peles [ctb],
  John Loffeld [ctb],
  Dan Shumaker [ctb],
  Ulrike Yang [ctb],
  James Almgren-Bell [ctb],
  Shelby L. Lockhart [ctb],
  Hilari C. Tiedeman [ctb],
  Ting Yan [ctb],
  Jean M. Sexton [ctb],
  Chris White [ctb],
  Lawrence Livermore National Security [cph],
  Southern Methodist University [cph],
  INSA [cph],
  INRAE [cph],
  CNRS [cph]</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
get_cnst                Get Predefined Constant
r2cvodes                Solving ODE System and Sensitivity Equations
r2sundials-package      Wrapper for 'SUNDIALS' Solving ODE and
                        Sensitivity Problem
</pre>
<p>The main function of the package is r2cvodes() which wraps and converts its arguments in data structures and parameters convenient for calling <code>cvodes()</code> from SUNDIALS library.
</p>
<p>When using r2sundials::r2cvodes(), some callback functions have to be written by the user either in R or in C++ (RcppArmadillo flavor). One of them is mandatory and defines the rhs of the ODE system to solve. Others are optional and can be used to
</p>

<ul>
<li>
<p> calculate Jacobian matrix in sparse or dense format;
</p>
</li>
<li>
<p> calculate root vector for tracking particular events and
</p>
</li>
<li>
<p> handle them in a way defined by the user himself;
</p>
</li>
<li>
<p> calculate sensitivity rhs if sensitivity to some parameters is required and user does not want to rely on internal procedures for estimating such rhs.
</p>
</li>
</ul>
<p>Note that if 'SUNDIALS' 'CVODES' is compiled with parameter SUNDIALS_INDEX_SIZE set to 32, some memory copying is spared if a C++ function calculating sparse Jacobian is provided by user.
</p>
<p>The version number of this package if made of CVODES original version, e.g. 5.0.0 followed by one digit for R wrapper release. This can give 5.0.0-1.
</p>


<h3>Author(s)</h3>

<p>Serguei Sokol [cre, aut],
  Carol S. Woodward [ctb],
  Daniel R. Reynolds [ctb],
  Alan C. Hindmarsh [ctb],
  David J. Gardner [ctb],
  Cody J. Balos [ctb],
  Radu Serban [ctb],
  Scott D. Cohen [ctb],
  Peter N. Brown [ctb],
  George Byrne [ctb],
  Allan G. Taylor [ctb],
  Steven L. Lee [ctb],
  Keith E. Grant [ctb],
  Aaron Collier [ctb],
  Lawrence E. Banks [ctb],
  Steve Smith [ctb],
  Cosmin Petra [ctb],
  Slaven Peles [ctb],
  John Loffeld [ctb],
  Dan Shumaker [ctb],
  Ulrike Yang [ctb],
  James Almgren-Bell [ctb],
  Shelby L. Lockhart [ctb],
  Hilari C. Tiedeman [ctb],
  Ting Yan [ctb],
  Jean M. Sexton [ctb],
  Chris White [ctb],
  Lawrence Livermore National Security [cph],
  Southern Methodist University [cph],
  INSA [cph],
  INRAE [cph],
  CNRS [cph]
Maintainer: Serguei Sokol &lt;sokol@insa-toulouse.fr&gt;
</p>


<h3>References</h3>

<p><a href="https://computing.llnl.gov/">Original SUNDIALS CVODES user documentation</a> (search for cvs_guide.pdf)
</p>


<h3>See Also</h3>

<p><code>deSolve</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # a very simple ODE for exponential transition from 0 to 1: y'=1-y, y(0)=0
  frhs=function(t, y, param, psens) 1-y
  ti=seq(0, 5, length.out=101)
  y0=0
  res_exp=r2sundials::r2cvodes(y0, ti, frhs)
  plot(ti, res_exp[1,], t="l", xlab="Time", ylab="Y")
</code></pre>


</div>