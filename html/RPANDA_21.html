<div class="container">

<table style="width: 100%;"><tr>
<td>CreateGeoObject</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create biogeography object
</h2>

<h3>Description</h3>

<p>This function returns names of internode intervals, named descendants of each node,
and a geography object formatted in a way that can be
passed to <code>fit_t_comp</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">
CreateGeoObject(phylo,map)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>

<p>either a matrix modified from <code>phylo$edge</code> or a phylo object created using <code>make.simmap</code> (see Details and Examples)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function should be used to format the geography object so that it can be correctly
passed to the numerical integration performed in <code>fit_t_comp</code>. 
</p>
<p>The <code>map</code> can either be a matrix formed by specifying the region in which each branch specified by <code>phylo$edge</code> existed, or a stochastic map stored as a phylo object output from <code>make.simmap</code> (see Examples).
</p>


<h3>Value</h3>

<p>a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>geography.object</code></td>
<td>
<p>a list of matrices specifying sympatry (1) or allopatry (0) for each species pair for each internode interval (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>a vector containing the time since the root of the tree at which nodes or changes in biogeography occur (used internally in other functions)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spans</code></td>
<td>
<p>a vector specifying the distances between times (used internally in other functions)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan Drury <a href="mailto:jonathan.p.drury@gmail.com">jonathan.p.drury@gmail.com</a></p>


<h3>References</h3>

<p>Drury, J., Clavel, J., Manceau, M., and Morlon, H. 2016. Estimating the effect of competition on trait evolution using maximum likelihood inference. <em>Systematic Biology</em> doi 10.1093/sysbio/syw020
</p>


<h3>See Also</h3>

<p><code>fit_t_comp</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Anolis.data)
#Create a geography.object with a modified edge matrix
#First, specify which region each branch belonged to:
Anolis.regions&lt;-c(rep("cuba",14),rep("hispaniola",17),"puerto_rico")
Anolis.map&lt;-cbind(Anolis.data$phylo$edge,Anolis.regions)
CreateGeoObject(Anolis.data$phylo,map=Anolis.map)

#Create a geography.object with a make.simmap object
#First, specify which region each branch belonged to:
require(phytools)
geo&lt;-c(rep("cuba",7),rep("hispaniola",9),"puerto_rico")
names(geo)&lt;-Anolis.data$phylo$tip.label
stochastic.map&lt;-phytools::make.simmap(Anolis.data$phylo, 
							geo, model="ER", nsim=1)
CreateGeoObject(Anolis.data$phylo,map=stochastic.map)

</code></pre>


</div>