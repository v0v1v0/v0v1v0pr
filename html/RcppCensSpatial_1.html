<div class="container">

<table style="width: 100%;"><tr>
<td>CovMat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance matrix for spatial models</h2>

<h3>Description</h3>

<p>It computes the spatial variance-covariance matrix considering exponential,
gaussian, matérn, or power exponential correlation function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CovMat(phi, tau2, sig2, coords, type = "exponential", kappa = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>spatial scaling parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2</code></td>
<td>
<p>nugget effect parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>partial sill parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>2D spatial coordinates of dimensions <code class="reqn">n\times 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of spatial correlation function: <code>'exponential'</code>,
<code>'gaussian'</code>, <code>'matern'</code>, and <code>'pow.exp'</code> for exponential,
gaussian, matérn, and power exponential, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>parameter for some spatial correlation functions. For exponential
and gaussian <code>kappa=NULL</code>, for power exponential <code>0 &lt; kappa &lt;= 2</code>,
and for matérn correlation function <code>kappa &gt; 0</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The spatial covariance matrix is given by
</p>
<p><code class="reqn">\Sigma = [Cov(s_i, s_j )] = \sigma^2 R(\phi) + \tau^2 I_n</code>,
</p>
<p>where <code class="reqn">\sigma^2 &gt; 0</code> is the partial sill, <code class="reqn">\phi &gt; 0</code> is the spatial scaling
parameter, <code class="reqn">\tau^2 &gt; 0</code> is known as the nugget effect in the geostatistical
framework, <code class="reqn">R(\phi)</code> is the <code class="reqn">n\times n</code> correlation matrix computed from a
correlation function, and <code class="reqn">I_n</code> is the <code class="reqn">n\times n</code> identity matrix.
</p>
<p>The spatial correlation functions available are:
</p>

<dl>
<dt>
<strong>Exponential</strong>:</dt>
<dd>
<p><code class="reqn">Corr(d) = exp(-d/\phi)</code>,</p>
</dd>
<dt>
<strong>Gaussian</strong>:</dt>
<dd>
<p><code class="reqn">Corr(d) = exp(-(d/\phi)^2)</code>,</p>
</dd>
<dt>
<strong>Matérn</strong>:</dt>
<dd>
<p><code class="reqn">Corr(d) = \frac{1}{2^{(\kappa-1)}\Gamma(\kappa)}\left(\frac{d}{\phi}\right)^\kappa K_\kappa \left( \frac{d}{\phi} \right)</code>,</p>
</dd>
<dt>
<strong>Power exponential</strong>:</dt>
<dd>
<p><code class="reqn">Corr(d) = exp(-(d/\phi)^\kappa)</code>,</p>
</dd>
</dl>
<p>where <code class="reqn">d \geq 0</code> is the Euclidean distance between two observations,
<code class="reqn">\Gamma(.)</code> is the gamma function, <code class="reqn">\kappa</code> is the smoothness parameter,
and <code class="reqn">K_\kappa(.)</code> is the modified Bessel function of the second kind of order
<code class="reqn">\kappa</code>.
</p>


<h3>Value</h3>

<p>An <code class="reqn">n\times n</code> spatial covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Alejandro Ordoñez, Christian E. Galarza, and Larissa A. Matos.
</p>


<h3>See Also</h3>

<p><code>dist2Dmatrix</code>, <code>EM.sclm</code>, <code>MCEM.sclm</code>, <code>SAEM.sclm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1000)
n = 20
coords = round(matrix(runif(2*n, 0, 10), n, 2), 5)
Cov = CovMat(phi=5, tau2=0.8, sig2=2, coords=coords, type="exponential")
</code></pre>


</div>