<div class="container">

<table style="width: 100%;"><tr>
<td>exportToSPSS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Basic SPSS translation functions</h2>

<h3>Description</h3>

<p>Basic functons to make working with R easier for SPSS users: getData and
getDat provide an easy way to load SPSS datafiles, and exportToSPSS to write
to a datafile and syntax file that SPSS can import; filterBy and useAll
allow easy temporary filtering of rows from the dataframe; mediaan and modus
compute the median and mode of ordinal or numeric data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exportToSPSS(
  dat,
  savfile = NULL,
  datafile = NULL,
  codefile = NULL,
  fileEncoding = "UTF-8",
  newLinesInString = " |n| "
)

filterBy(
  dat,
  expression,
  replaceOriginalDataframe = TRUE,
  envir = parent.frame()
)

getData(
  filename = NULL,
  file = NULL,
  errorMessage = "[defaultErrorMessage]",
  applyRioLabels = TRUE,
  use.value.labels = FALSE,
  to.data.frame = TRUE,
  stringsAsFactors = FALSE,
  silent = FALSE,
  ...
)

getDat(..., dfName = "dat", backup = TRUE)

mediaan(vector)

modus(vector)

useAll(dat, replaceFilteredDataframe = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Dataframe to process: for filterBy, dataframe to filter rows
from; for useAll, dataframe to restore ('unfilter').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savfile</code></td>
<td>
<p>The name of the SPSS format .sav file (alternative for
writing a datafile and a codefile).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datafile</code></td>
<td>
<p>The name of the data file, a comma separated values file
that can be read into SPSS by using the code file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>codefile</code></td>
<td>
<p>The name of the code file, the SPSS syntax file that can be
used to import the data file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileEncoding</code></td>
<td>
<p>The encoding to use to write the files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newLinesInString</code></td>
<td>
<p>A string to replace newlines with (SPSS has problems
reading newlines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expression</code></td>
<td>
<p>Logical expression determining which rows to keep and
which to drop. Can be either a logical vector or a string which is then
evaluated. If it's a string, it's evaluated using 'with' to evaluate the
expression using the variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replaceOriginalDataframe</code></td>
<td>
<p>Whether to also replace the original
dataframe in the parent environment. Very messy, but for maximum
compatibility with the 'SPSS way of doing things', by default, this is true.
After all, people who care about the messiness/inappropriateness of this
function wouldn't be using it in the first place :-)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>The environment where to create the 'backup' of the unfiltered
dataframe, for when useAll is called and the filter is deactivated again.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename, file</code></td>
<td>
<p>It is possible to specify a path and filename to load
here. If not specified, the default R file selection dialogue is shown.
<code>file</code> is still available for backward compatibility but will
eventually be phased out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorMessage</code></td>
<td>
<p>The error message that is shown if the file does not
exist or does not have the right extension; "[defaultErrorMessage]" is
replaced with a default error message (and can be included in longer
messages).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>applyRioLabels</code></td>
<td>
<p>Whether to apply the labels supplied by Rio. This will
make variables that has value labels into factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.value.labels</code></td>
<td>
<p>Only useful when reading from SPSS files: whether to
read variables with value labels as factors (TRUE) or numeric vectors
(FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to.data.frame</code></td>
<td>
<p>Only useful when reading from SPSS files: whether to
return a dataframe or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stringsAsFactors</code></td>
<td>
<p>Whether to read strings as strings (FALSE) or
factors (TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Whether to suppress potentially useful information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional options, passed on to the function used to import the
data (which depends on the extension of the file).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfName</code></td>
<td>
<p>The name of the dataframe to create in the parent environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backup</code></td>
<td>
<p>Whether to backup an object with name <code>dfName</code>, if one
already exists in the parent environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vector</code></td>
<td>
<p>For mediaan and modus, the vector for which to find the median
or mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replaceFilteredDataframe</code></td>
<td>
<p>Whether to replace the filtered dataframe
passed in the 'dat' argument (see replaceOriginalDataframe).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>getData returns the imported dataframe, with the filename from which it was
read stored in the 'filename' attribute.
</p>
<p>getDat is a simple wrapper for <code>getData()</code> which creates a dataframe in
the parent environment, by default with the name 'dat'. Therefore, calling
<code>getDat()</code> in the console will allow the user to select a file, and the
data from the file will then be read and be available as 'dat'. If an object
with <code>dfName</code> (i.e. 'dat' by default) already exists, it will be backed
up with a warning. <code>getDat()</code> therefore returns nothing.
</p>
<p>mediaan returns the median, or, in the case of a factor where the median is
in between two categories, both categories.
</p>
<p>modus returns the mode.
</p>


<h3>Note</h3>

<p>getData() currently can't read from LibreOffice or OpenOffice files.
There doesn't seem to be a platform-independent package that allows this.
Non-CRAN package ROpenOffice from OmegaHat should be able to do the trick,
but fails to install (manual download and installation using
http://www.omegahat.org produces "ERROR: dependency 'Rcompression' is not
available for package 'ROpenOffice'" - and manual download and installation
of RCompression produces "Please define LIB_ZLIB; ERROR: configuration
failed for package 'Rcompression'"). If you have any suggestions, please let
me know!
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## Not run: 
### Open a dialogue to read an SPSS file
getData();

## End(Not run)

### Get a median and a mode
mediaan(c(1,2,2,3,4,4,5,6,6,6,7));
modus(c(1,2,2,3,4,4,5,6,6,6,7));

### Create an example dataframe
(exampleDat &lt;- data.frame(x=rep(8, 8), y=rep(c(0,1), each=4)));
### Filter it, replacing the original dataframe
(filterBy(exampleDat, "y=0"));
### Restore the old dataframe
(useAll(exampleDat));
</code></pre>


</div>