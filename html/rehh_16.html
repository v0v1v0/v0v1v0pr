<div class="container">

<table style="width: 100%;"><tr>
<td>data2haplohh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert data from input file to an object of class haplohh</h2>

<h3>Description</h3>

<p>Convert input data files to an object of <code>haplohh-class</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data2haplohh(
  hap_file,
  map_file = NA,
  min_perc_geno.hap = NA,
  min_perc_geno.mrk = 100,
  min_maf = NA,
  chr.name = NA,
  popsel = NA,
  recode.allele = FALSE,
  allele_coding = "12",
  haplotype.in.columns = FALSE,
  remove_multiple_markers = FALSE,
  polarize_vcf = TRUE,
  capitalize_AA = TRUE,
  vcf_reader = "data.table",
  position_scaling_factor = NA,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hap_file</code></td>
<td>
<p>file containing haplotype data (see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_file</code></td>
<td>
<p>file containing map information (see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_perc_geno.hap</code></td>
<td>
<p>threshold on percentage of missing data for haplotypes
(haplotypes with less than <code>min_perc_geno.hap</code> percent of markers genotyped are discarded). Default is <code>NA</code>,
hence no constraint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_perc_geno.mrk</code></td>
<td>
<p>threshold on percentage of missing data for markers (markers genotyped on less than
<code>min_perc_geno.mrk</code> percent of haplotypes are discarded). By default, <code>min_perc_geno.mrk=100</code>,
hence only fully genotyped markers are retained.
This value cannot be set to <code>NA</code> or zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_maf</code></td>
<td>
<p>threshold on the Minor Allele Frequency. Markers having a MAF lower than or equal to minmaf are discarded.
In case of multi-allelic markers the second-most frequent allele is referred to as minor allele.
Setting this value to zero eliminates monomorphic sites. Default is <code>NA</code>,
hence no constraint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chr.name</code></td>
<td>
<p>name of the chromosome considered (relevant if data for several chromosomes is
contained in the haplotype or map file).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popsel</code></td>
<td>
<p>code of the population considered (relevant for fastPHASE output which
can contain haplotypes from various populations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recode.allele</code></td>
<td>
<p>*Deprecated*. logical. <code>FALSE</code> by default. <code>TRUE</code> forces parameter <code>allele_coding</code> to <code>"map"</code>,
<code>FALSE</code> leaves it unchanged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allele_coding</code></td>
<td>
<p>the allele coding provided by the user. Either <code>"12"</code> (default), <code>"01"</code>, <code>"map"</code> or <code>"none"</code>.
The option is irrelevant for vcf files and ms output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haplotype.in.columns</code></td>
<td>
<p>logical. If <code>TRUE</code>, phased input haplotypes are assumed to be in columns (as produced
by the SHAPEIT2 program (O'Connell et al., 2014).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_multiple_markers</code></td>
<td>
<p>logical. If <code>FALSE</code> (default), conversion
stops, if multiple markers with the same chromosomal position are encountered.
If <code>TRUE</code>, duplicated markers are removed (all but the first marker with identical positions).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polarize_vcf</code></td>
<td>
<p>logical. Only of relevance for vcf files. If <code>TRUE</code> (default), tries to polarize
variants with help of the AA entry in the INFO field. Unpolarized alleles are discarded.
If <code>FALSE</code>, allele coding of vcf file is used unchanged as internal coding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>capitalize_AA</code></td>
<td>
<p>logical. Only of relevance for vcf files with ancestral allele information.
Low confidence ancestral alleles are usually coded by lower-case letters. If <code>TRUE</code> (default), these are
changed to upper case before the alleles of the sample are matched for polarization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcf_reader</code></td>
<td>
<p>library used to read vcf. By default, low-level parsing is
performed using the generic package <code>data.table</code>. In order to read compressed files,
the package <code>R.utils</code> must be installed, too.
If the specialized package <code>vcfR</code> is available, set this parameter to <code>"vcfR"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position_scaling_factor</code></td>
<td>
<p>intended primarily for output of ms where
positions lie in the interval [0,1]. These can be rescaled to sizes
of typical markers in real data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), report verbose progress.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Five haplotype input formats are supported:
</p>

<ul>
<li>
<p> a "standard format" with haplotypes in rows and markers in columns (with no header, but a haplotype ID/name in
the first column).
</p>
</li>
<li>
<p> a "transposed format" similar to the one produced by the phasing program SHAPEIT2
(O'Connell et al., 2014) in which haplotypes are in columns and markers in rows
(with neither header nor marker IDs nor haplotype IDs).
</p>
</li>
<li>
<p> output files from the fastPHASE program (Sheet and Stephens, 2006).
If haplotypes from several different population were phased simultaneously (-u fastPHASE option
was used), it is necessary to specify the population of interest by parameter <code>popsel</code>
(if this parameter is not or wrongly set, the error message will provide a list of
the population numbers contained in the file).
</p>
</li>
<li>
<p> files in variant call format (vcf). No mapfile is needed is this case. If
the file contains several chromosomes, it is necessary to choose one by parameter
<code>chr.name</code>.
</p>
</li>
<li>
<p> output of the simulation program 'ms'. No mapfile is needed in this case. If the file
contains several 'runs', a specific number has to be specified by the
parameter <code>chr.name</code>.
</p>
</li>
</ul>
<p>The "transposed format" has to be explicitly set while the other formats
are recognized automatically.
</p>
<p>The map file contains marker information in three, or, if it is used for
polarization (see below), five columns:
</p>

<ul>
<li>
<p> marker name/id
</p>
</li>
<li>
<p> chromosome
</p>
</li>
<li>
<p> position (physical or genetic)
</p>
</li>
<li>
<p> ancestral allele encoding
</p>
</li>
<li>
<p> derived allele encoding
</p>
</li>
</ul>
<p>The markers must be in the same order as in the haplotype file. If
several chromosomes are represented in the map file, it is necessary to choose that
which corresponds to the haplotype file by parameter <code>chr.name</code>.
</p>
<p>Haplotypes can be given either with alleles already coded as numbers (in two possible ways)
or with the actual alleles (e.g. nucleotides) which can be translated into numbers
either using the fourth and fifth column of the map file or by their alpha-numeric order.
Correspondingly, the parameter <code>allele_coding</code> has to be set to either <code>"12"</code>,
<code>"01"</code>, <code>"map"</code> or <code>"none"</code>:
</p>

<ul>
<li> <p><code>"12"</code>: 0 represents missing values, 1 the ancestral allele
and 2 (or higher integers) derived allele(s).
</p>
</li>
<li> <p><code>"01"</code>: <code>NA</code> or '.' (a point) represent missing values, 0 the
ancestral and 1 (or higher integers) derived allele(s).
</p>
</li>
<li> <p><code>"map"</code>: for each marker, the fourth column of the map file
defines the ancestral allele and the fifth column derived alleles.
In case of multiple derived alleles, they must be separated by commas without space.
Alleles in the haplotype file which do not appear in neither of the two columns
of the map file are regarded as missing values (<code>NA</code>).
</p>
</li>
<li> <p><code>"none"</code>: <code>NA</code> or '.' (a point) represent missing values, otherwise for each
marker the allele that comes first in alpha-numeric
order is coded by 0, the next by 1, etc. Evidently, this coding does not convey
any information about allele status as ancestral or derived, hence the alleles
cannot be regarded as polarized.
</p>
</li>
</ul>
<p>The information of allelic ancestry is exploited only in the frequency-bin-wise
standardization of iHS (see <code>ihh2ihs</code>). However, although ancestry status does
not figure in the formulas of the cross populations statistics
Rsb and XP-EHH, their values do depend on the assigned status.
</p>
<p>The arguments <code>min_perc_geno.hap</code>,
<code>min_perc_geno.mrk</code> and <code>min_maf</code> are evaluated in this order.
</p>


<h3>Value</h3>

<p>The returned value is an object of <code>haplohh-class</code>.
</p>


<h3>References</h3>

<p>Scheet P, Stephens M (2006) A fast and flexible statistical model for large-scale population genotype
data: applications to inferring missing genotypes and haplotypic phase. <em>Am J Hum Genet</em>, <strong>78</strong>, 629-644.
</p>
<p>O'Connell J, Gurdasani D, Delaneau O, et al (2014) A general approach for haplotype phasing
across the full spectrum of relatedness. <em>PLoS Genet</em>, <strong>10</strong>, e1004234.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#copy example files into the current working directory.
make.example.files()
#create object using a haplotype file in "standard format"
hap &lt;- data2haplohh(hap_file = "bta12_cgu.hap",
                   map_file = "map.inp",
                   chr.name = 12,
                   allele_coding = "map")
#create object using fastPHASE output
hap &lt;- data2haplohh(hap_file = "bta12_hapguess_switch.out",
                   map_file = "map.inp",
                   chr.name = 12,
                   popsel = 7,
                   allele_coding = "map")
#clean up demo files
remove.example.files()
</code></pre>


</div>