<div class="container">

<table style="width: 100%;"><tr>
<td>Tephra3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tephra Lagrangian Transport Model</h2>

<h3>Description</h3>

<p>This function models the transport of a single particle through a spatially variable, windy, turbulent atmosphere with gravity. It allows 4D-varying atmospheric wind and density. Currently, only Rayleigh drag (low Re) is permitted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Tephra3d(vx0, vy0, vz0, x0 = 0, y0 = 0, z0 = 0, t0 = 0,
  rho_r = 2000, r = 1, dt = 0.01, Cd = 0.6, verbose = FALSE,
  rho_a = NULL, zt = NULL, wx = 0, wy = 0, wz = 0, mindist = 0,
  TOPO = NULL, Kh = 0, Kz = 0, eddy_timescale = 60, g = 9.80665)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vx0</code></td>
<td>
<p>initial x component of velocity [m/s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vy0</code></td>
<td>
<p>initial y component of velocity [m/s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vz0</code></td>
<td>
<p>initial z component of velocity [m/s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>initial easting [m]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>initial northing [m]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0</code></td>
<td>
<p>initial elevation [m]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>initial time [s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_r</code></td>
<td>
<p>density of tephra particle [kg/m^3]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>rock radius [m]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>model time interval [s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cd</code></td>
<td>
<p>drag coefficient [unitless]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical: print runtime info to screen?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_a</code></td>
<td>
<p>scalar or function(x,y,z,t) or function(z) giving atmospheric density [kg/m^3]. If NULL, use a variable-density isothermal atmosphere (T = 0 deg C)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zt</code></td>
<td>
<p>function(x,y) giving topographic height [m]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wx</code></td>
<td>
<p>scalar or function(x,y,z,t) or function(z) giving component of wind to the east [m/s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wy</code></td>
<td>
<p>scalar or function(x,y,z,t) or function(z) giving component of wind to the north [m/s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wz</code></td>
<td>
<p>scalar or function(x,y,z,t) or function(z) giving upward component of wind [m/s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindist</code></td>
<td>
<p>minimum distance a particle must travel before simulation can stop. This is to prevent early model ends due to spurious collision with crater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TOPO</code></td>
<td>
<p>DEM: list containing vectors x and y and matrix z with dimensions (length(x), length(y))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kh</code></td>
<td>
<p>horizontal eddy diffusivity [m^2/s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kz</code></td>
<td>
<p>vertical eddy diffusivity (often neglected) [m^2/s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eddy_timescale</code></td>
<td>
<p>1/e decay time of turbulent eddies [s]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>gravitational acceleration [m/s^2]</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">Tephra3d(vx0 = 40, vy0 = 0, vz0 = 40, z0 = 0)
</code></pre>


</div>