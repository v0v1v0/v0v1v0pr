<div class="container">

<table style="width: 100%;"><tr>
<td>rdrandinf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Randomization Inference for RD Designs under Local Randomization</h2>

<h3>Description</h3>

<p><code>rdrandinf</code> implements randomization inference and related methods for RD designs,
using observations in a specified or data-driven selected window around the cutoff where
local randomization is assumed to hold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdrandinf(
  Y,
  R,
  cutoff = 0,
  wl = NULL,
  wr = NULL,
  statistic = "diffmeans",
  p = 0,
  evall = NULL,
  evalr = NULL,
  kernel = "uniform",
  fuzzy = NULL,
  nulltau = 0,
  d = NULL,
  dscale = NULL,
  ci,
  interfci = NULL,
  bernoulli = NULL,
  reps = 1000,
  seed = 666,
  quietly = FALSE,
  covariates,
  obsmin = NULL,
  wmin = NULL,
  wobs = NULL,
  wstep = NULL,
  wasymmetric = FALSE,
  wmasspoints = FALSE,
  nwindows = 10,
  dropmissing = FALSE,
  rdwstat = "diffmeans",
  approx = FALSE,
  rdwreps = 1000,
  level = 0.15,
  plot = FALSE,
  firststage = FALSE,
  obsstep = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a vector containing the values of the outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>a vector containing the values of the running variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the RD cutoff (default is 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>the left limit of the window. The default takes the minimum of the running variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wr</code></td>
<td>
<p>the right limit of the window. The default takes the maximum of the running variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the statistic to be used in the balance tests. Allowed options are <code>diffmeans</code> (difference in means statistic), <code>ksmirnov</code> (Kolmogorov-Smirnov statistic) and <code>ranksum</code> (Wilcoxon-Mann-Whitney standardized statistic). Default option is <code>diffmeans</code>. The statistic <code>ttest</code> is equivalent to <code>diffmeans</code> and included for backward compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the order of the polynomial for outcome transformation model (default is 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evall</code></td>
<td>
<p>the point at the left of the cutoff at which to evaluate the transformed outcome is evaluated. Default is the cutoff value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalr</code></td>
<td>
<p>specifies the point at the right of the cutoff at which the transformed outcome is evaluated. Default is the cutoff value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>specifies the type of kernel to use as weighting scheme. Allowed kernel types are <code>uniform</code> (uniform kernel), <code>triangular</code> (triangular kernel) and <code>epan</code> (Epanechnikov kernel). Default is <code>uniform</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzzy</code></td>
<td>
<p>indicates that the RD design is fuzzy. <code>fuzzy</code> can be specified as the variable containing the values of the endogenous treatment variable, or as a vector where the first element is the vector of endogenous treatment values and the second element is a string containing the name of the statistic to be used. Allowed statistics are <code>itt</code> (intention-to-treat statistic) and <code>tsls</code> (2SLS statistic). Default statistic is <code>ar</code>. The <code>tsls</code> statistic relies on large-sample approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nulltau</code></td>
<td>
<p>the value of the treatment effect under the null hypothesis (default is 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the effect size for asymptotic power calculation. Default is 0.5 * standard deviation of outcome variable for the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dscale</code></td>
<td>
<p>the fraction of the standard deviation of the outcome variable for the control group used as alternative hypothesis for asymptotic power calculation. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>calculates a confidence interval for the treatment effect by test inversion. <code>ci</code> can be specified as a scalar or a vector, where the first element indicates the value of alpha for the confidence interval (typically 0.05 or 0.01) and the remaining elements, if specified, indicate the grid of treatment effects to be evaluated. This option uses <code>rdsensitivity</code> to calculate the confidence interval. See corresponding help for details. Note: the default tlist can be narrow in some cases, which may truncate the confidence interval. We recommend the user to manually set a large enough tlist.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interfci</code></td>
<td>
<p>the level for Rosenbaum's confidence interval under arbitrary interference between units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bernoulli</code></td>
<td>
<p>the probabilities of treatment for each unit when assignment mechanism is a Bernoulli trial. This option should be specified as a vector of length equal to the length of the outcome and running variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>the number of replications (default is 1000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed to be used for the randomization test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quietly</code></td>
<td>
<p>suppresses the output table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>the covariates used by <code>rdwinselect</code> to choose the window when <code>wl</code> and <code>wr</code> are not specified. This should be a matrix of size n x k where n is the total sample size and k is the number of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsmin</code></td>
<td>
<p>the minimum number of observations above and below the cutoff in the smallest window employed by the companion command <code>rdwinselect</code>. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmin</code></td>
<td>
<p>the smallest window to be used (if <code>minobs</code> is not specified) by the companion command <code>rdwinselect</code>. Specifying both <code>wmin</code> and <code>obsmin</code> returns an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wobs</code></td>
<td>
<p>the number of observations to be added at each side of the cutoff at each step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wstep</code></td>
<td>
<p>the increment in window length (if <code>obsstep</code> is not specified) by the companion command <code>rdwinselect</code>.  Specifying both <code>obsstep</code> and <code>wstep</code> returns an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wasymmetric</code></td>
<td>
<p>allows for asymmetric windows around the cutoff when (<code>wobs</code> is specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmasspoints</code></td>
<td>
<p>specifies that the running variable is discrete and each masspoint should be used as a window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nwindows</code></td>
<td>
<p>the number of windows to be used by the companion command <code>rdwinselect</code>. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropmissing</code></td>
<td>
<p>drop rows with missing values in covariates when calculating windows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdwstat</code></td>
<td>
<p>the statistic to be used by the companion command <code>rdwinselect</code> (see corresponding help for options). Default option is <code>ttest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>forces the companion command <code>rdwinselect</code> to conduct the covariate balance tests using a large-sample approximation instead of finite-sample exact randomization inference methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdwreps</code></td>
<td>
<p>the number of replications to be used by the companion command <code>rdwinselect</code>. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the minimum accepted value of the p-value from the covariate balance tests to be used by the companion command <code>rdwinselect</code>. Default is .15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>draws a scatter plot of the minimum p-value from the covariate balance test against window length implemented by the companion command <code>rdwinselect</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firststage</code></td>
<td>
<p>reports the results from the first step when using tsls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsstep</code></td>
<td>
<p>the minimum number of observations to be added on each side of the cutoff for the sequence of fixed-increment nested windows. Default is 2. This option is deprecated and only included for backward compatibility.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sumstats</code></td>
<td>
<p>summary statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.stat</code></td>
<td>
<p>observed statistic(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>randomization p-value(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.pvalue</code></td>
<td>
<p>asymptotic p-value(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>chosen window</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>confidence interval (only if <code>ci</code> option is specified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interf.ci</code></td>
<td>
<p>confidence interval under interferecen (only if <code>interfci</code> is specified)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matias Cattaneo, Princeton University. <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>
</p>
<p>Rocio Titiunik, Princeton University. <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>
</p>
<p>Gonzalo Vazquez-Bare, UC Santa Barbara. <a href="mailto:gvazquez@econ.ucsb.edu">gvazquez@econ.ucsb.edu</a>
</p>


<h3>References</h3>

<p>Cattaneo, M.D., R. Titiunik and G. Vazquez-Bare. (2016). <a href="https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2016_Stata.pdf">Inference in Regression Discontinuity Designs under Local Randomization</a>. <em>Stata Journal</em> 16(2): 331-367.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Toy dataset
X &lt;- array(rnorm(200),dim=c(100,2))
R &lt;- X[1,] + X[2,] + rnorm(100)
Y &lt;- 1 + R -.5*R^2 + .3*R^3 + (R&gt;=0) + rnorm(100)
# Randomization inference in window (-.75,.75)
tmp &lt;- rdrandinf(Y,R,wl=-.75,wr=.75)
# Randomization inference in window (-.75,.75), all statistics
tmp &lt;- rdrandinf(Y,R,wl=-.75,wr=.75,statistic='all')
# Randomization inference with window selection
# Note: low number of replications to speed up process.
# The user should increase the number of replications.
tmp &lt;- rdrandinf(Y,R,statistic='all',covariates=X,wmin=.5,wstep=.125,rdwreps=500)



</code></pre>


</div>