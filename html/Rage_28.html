<div class="container">

<table style="width: 100%;"><tr>
<td>age_from_stage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate age-specific traits from a matrix population model</h2>

<h3>Description</h3>

<p>These functions use age-from-stage decomposition methods to calculate
age-specific survivorship (<code>lx</code>), survival probability (<code>px</code>),
mortality hazard (<code>hx</code>), or reproduction (<code>mx</code>) from a matrix
population model (MPM). A detailed description of these methods can be found
in sections 5.3.1 and 5.3.2 of Caswell (2001). A separate function
<code>mpm_to_table</code> uses the same methods to calculate a full life
table.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpm_to_mx(matU, matR, start = 1L, xmax = 1000, lx_crit = 0.01, tol = 1e-04)

mpm_to_lx(matU, start = 1L, xmax = 1000, lx_crit = 0.01, tol = 1e-04)

mpm_to_px(matU, start = 1L, xmax = 1000, lx_crit = 0.01, tol = 1e-04)

mpm_to_hx(matU, start = 1L, xmax = 1000, lx_crit = 0.01, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matU</code></td>
<td>
<p>The survival component of a MPM (i.e., a
square projection matrix reflecting survival-related transitions; e.g.,
progression, stasis, and retrogression). Optionally with named rows and
columns indicating the corresponding life stage names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matR</code></td>
<td>
<p>The reproductive component of a MPM (i.e., a
square projection matrix reflecting transitions due to reproduction; either
sexual, clonal, or both). Optionally with named rows and columns indicating
the corresponding life stage names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>The index (or stage name) of the first stage at which the author
considers the beginning of life. Defaults to <code>1</code>. Alternately, a
numeric vector giving the starting population vector (in which case
<code>length(start)</code> must match <code>ncol(matU))</code>. See section
<em>Starting from multiple stages</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>Maximum age to which age-specific traits will be calculated
(defaults to <code>1000</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lx_crit</code></td>
<td>
<p>Minimum value of <code>lx</code> to which age-specific traits will
be calculated (defaults to <code>0.01</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>To account for floating point errors that occasionally lead to
values of <code>lx</code> slightly greater than 1, values of <code>lx</code> within the
open interval (<code>1</code>, <code>1 + tol</code>) are coerced to 1. Defaults to
<code>0.0001</code>. To prevent coercion, set <code>tol</code> to <code>0</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector
</p>


<h3>Starting from multiple stages</h3>

<p>Rather than specifying argument <code>start</code> as a single stage class from
which all individuals start life, it may sometimes be desirable to allow for
multiple starting stage classes. For example, if users want to start their
calculation of age-specific traits from reproductive maturity (i.e., first
reproduction), they should account for the possibility that there may be
multiple stage classes in which an individual could first reproduce.
</p>
<p>To specify multiple starting stage classes, users should specify argument
<code>start</code> as the desired starting population vector (<strong>n1</strong>), giving
the proportion of individuals starting in each stage class (the length of
<code>start</code> should match the number of columns in the relevant MPM).
</p>
<p>See function <code>mature_distrib</code> for calculating the proportion of
individuals achieving reproductive maturity in each stage class.
</p>


<h3>Note</h3>

<p>Note that the units of time for the returned vectors (i.e., <code>x</code>)
are the same as the projection interval (<code>ProjectionInterval</code>) of the
MPM.
</p>
<p>The output vector is calculated recursively until the age class
(<code>x</code>) reaches <code>xmax</code> or survivorship (<code>lx</code>) falls below
<code>lx_crit</code>, whichever comes first. To force calculation to <code>xmax</code>,
set <code>lx_crit</code> to <code>0</code>. Conversely, to force calculation to
<code>lx_crit</code>, set <code>xmax</code> to <code>Inf</code>.
</p>
<p>Note that the units of time in returned values (i.e., <code>x</code>) are the
same as the projection interval ('ProjectionInterval') of the MPM.
</p>


<h3>Author(s)</h3>

<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>
<p>Roberto Salguero-GÃ³mez &lt;rob.salguero@zoo.ox.ac.uk&gt;
</p>
<p>Hal Caswell &lt;h.caswell@uva.nl&gt;
</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>References</h3>

<p>Caswell, H. 2001. Matrix Population Models: Construction, Analysis, and
Interpretation. Sinauer Associates; 2nd edition. ISBN: 978-0878930968
</p>
<p>Jones O. R. 2021. Life tables: Construction and interpretation In:
Demographic Methods Across the Tree of Life. Edited by Salguero-Gomez R &amp;
Gamelon M. Oxford University Press. Oxford, UK. ISBN: 9780198838609
</p>
<p>Preston, S., Heuveline, P., &amp; Guillot, M. 2000. Demography: Measuring and
Modeling Population Processes. Wiley. ISBN: 9781557864512
</p>


<h3>See Also</h3>

<p><code>lifetable_convert</code>
</p>
<p>Other life tables: 
<code>lifetable_convert</code>,
<code>mpm_to_table()</code>,
<code>qsd_converge()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mpm1)

# age-specific survivorship
mpm_to_lx(mpm1$matU)
mpm_to_lx(mpm1$matU, start = 2) # starting from stage 2
mpm_to_lx(mpm1$matU, start = "small") # equivalent using named life stages
mpm_to_lx(mpm1$matU, xmax = 10) # to a maximum age of 10
mpm_to_lx(mpm1$matU, lx_crit = 0.05) # to a minimum lx of 0.05

# age-specific survival probability
mpm_to_px(mpm1$matU)

# age-specific mortality hazard
mpm_to_hx(mpm1$matU)

# age-specific fecundity
mpm_to_mx(mpm1$matU, mpm1$matF)


### starting from first reproduction
repstages &lt;- repro_stages(mpm1$matF)
n1 &lt;- mature_distrib(mpm1$matU, start = 2, repro_stages = repstages)

mpm_to_lx(mpm1$matU, start = n1)
mpm_to_px(mpm1$matU, start = n1)
mpm_to_hx(mpm1$matU, start = n1)
mpm_to_mx(mpm1$matU, mpm1$matF, start = n1)

</code></pre>


</div>