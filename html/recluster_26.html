<div class="container">

<table style="width: 100%;"><tr>
<td>recluster.procrustes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes a procrustes analysis between two matrices even if only a subset of cases are shared.
</h2>

<h3>Description</h3>

<p>This function computes a procrustes analysis (as done by the vegan procrustes function) but it also allows including a subset of cases shared between the two matrices and some unshared cases. The shared cases must be listed first and in the same order in the two matrices. Moreover, the number of shared cases must be indicated. The function applies a procrustes analysis by scaling, mirroring ad rotating the second matrix to minimizing its dissimilarity from the first on the basis of shared cases. Then, the same transformation is applied to the unshared cases of the second matrix. Finally, it allows including the matrices of coordinates for variables as obtained, for example, by PCA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">recluster.procrustes(X, Y, Yv=FALSE, num=nrow(X), scale = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Target matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>Matrix to be rotated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yv</code></td>
<td>

<p>Matrix of variables for the matrix to be rotated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num</code></td>
<td>

<p>number of shared cases between the target matrix and the matrix to be rotated (by default all).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>number of shared cases between the target matrix and the matrix to be rotated (by default all).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>See procrustes() for other parameters
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>recluster.procrustes uses the vegan function procrustes to rotate a configuration (Y) to maximum similarity with another target matrix configuration (X) on the basis of a series of shared objects (rows). These objects must be in the same order in the two X and Y matrices. In case of additional cases (rows) in both the X and Y matrices, the same transformation is applied to the case of the Y matrices which are not shared with X. Moreover, the same transformation can be applied to an additional Yv matrix likely representing the coordinates of variables as obtained for example by PCA or other ordination methods. The functions returns an object of the class "procrustes" as implemented in vegan.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Yrot</code></td>
<td>

<p>Rotated matrix Y.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Target matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yvrot</code></td>
<td>

<p>Rotated matrix of variables Yv.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss</code></td>
<td>

<p>Sum of squared differences between X and Yrot on the basis of shared objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>

<p>Orthogonal rotation matrix on the basis of shared objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>translation</code></td>
<td>

<p>Translation of the origin on the basis of shared objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>Scaling factor on the basis of shared objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmean</code></td>
<td>

<p>The centroid of the target on the basis of shared objects.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Dapporto L., Voda R., Dinca V., Vila R.
"Comparing population patterns for genetic and morphological markers with uneven sample sizes. An example for the butterfly Maniola jurtina"
Methods Ecol Evol (2014), 5, 834-843.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Create and plot a target matrix
ex1 &lt;-rbind(c(1,5),c(5,5),c(3,4),c(3,6))
plot(ex1,col=c(1:4),pch=19,xlim=c(0,6),ylim=c(0,6),cex=2)
#Create and plot a matrix to be rotated. Only the points 1-4 are shared
ex2&lt;-rbind(c(3,1),c(3,3),c(2.5,2),c(3.5,2),c(3,4))
plot(ex2,col=c(1:5),pch=19,xlim=c(0,6),ylim=c(0,6),cex=2)

#Perform the procrustes and plot the matrices
procr1&lt;-recluster.procrustes(ex1,ex2,num=4)
plot(procr1$X,col=c(1:4),pch=19,xlim=c(-4,4),ylim=c(-4,4),cex=2)
plot(procr1$Yrot,col=c(1:5),pch=19,xlim=c(-4,4),ylim=c(-4,4),cex=2)
</code></pre>


</div>