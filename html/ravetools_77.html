<div class="container">

<table style="width: 100%;"><tr>
<td>pwelch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate 'Welch Periodogram'</h2>

<h3>Description</h3>

<p><code>pwelch</code> is for single signal trace only; <code>mv_pwelch</code>
is for multiple traces. Currently <code>mv_pwelch</code> is experimental and
should not be called directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pwelch(
  x,
  fs,
  window = 64,
  noverlap = window/2,
  nfft = "auto",
  window_family = hamming,
  col = "black",
  xlim = NULL,
  ylim = NULL,
  main = "Welch periodogram",
  plot = 0,
  log = c("xy", "", "x", "y"),
  ...
)

## S3 method for class ''ravetools-pwelch''
print(x, ...)

## S3 method for class ''ravetools-pwelch''
plot(
  x,
  log = c("xy", "x", "y", ""),
  se = FALSE,
  xticks,
  type = "l",
  add = FALSE,
  col = graphics::par("fg"),
  col.se = "orange",
  alpha.se = 0.5,
  lty = 1,
  lwd = 1,
  cex = 1,
  las = 1,
  main = "Welch periodogram",
  xlab,
  ylab,
  xlim = NULL,
  ylim = NULL,
  xaxs = "i",
  yaxs = "i",
  xline = 1.2 * cex,
  yline = 2 * cex,
  mar = c(2.6, 3.8, 2.1, 0.6) * (0.5 + cex/2),
  mgp = cex * c(2, 0.5, 0),
  tck = -0.02 * cex,
  grid = TRUE,
  ...
)

mv_pwelch(
  x,
  margin,
  fs,
  window = 64,
  noverlap = window/2,
  nfft = "auto",
  window_family = hamming
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numerical vector or a row-major vector, signals.
If <code>x</code> is a matrix, then each row is a channel. For <code>plot</code>
function, <code>x</code> is the instance returned by <code>pwelch</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fs</code></td>
<td>
<p>sample rate, average number of time points per second</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>window length in time points, default size is <code>64</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noverlap</code></td>
<td>
<p>overlap between two adjacent windows, measured in time
points; default is half of the <code>window</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfft</code></td>
<td>
<p>number of points in window function; default is automatically
determined from input data and window, scaled up to the nearest power of 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_family</code></td>
<td>
<p>function generator for generating filter windows,
default is <code>hamming</code>. This can be any window function listed in
the filter window family, or any window generator function from package
<code>gsignal</code>. Default is <code>hamming</code>. For 'iEEG' users, both
<code>hamming</code> and <code>blackmanharris</code> are offered by 'EEG-lab';
while <code>blackmanharris</code> offers better attenuation than Hamming windows,
it also has lower spectral resolution. <code>hamming</code> has a 42.5 dB side-lobe
attenuation. This may mask spectral content below this value (relative
to the peak spectral content). Choosing different windows enables
you to make trade-off between resolution (e.g., using a rectangular
window) and side-lobe attenuation (e.g., using a <code>hanning</code>
window)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, xlim, ylim, main, type, cex, las, xlab, ylab, lty, lwd, xaxs, yaxs, mar, mgp, tck</code></td>
<td>
<p>parameters passed to <code>plot.default</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>integer, whether to plot the result or not; choices are <code>0</code>, no plot; <code>1</code> plot on a new canvas; <code>2</code> add to existing canvas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>indicates which axis should be <code>log10</code>-transformed, used by the plot function. For <code>'x'</code> axis, it's <code>log10</code>-transform; for <code>'y'</code> axis, it's <code>10log10</code>-transform (decibel unit). Choices are <code>"xy"</code>, <code>"x"</code>, <code>"y"</code>, and <code>""</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>will be passed to <code>plot.pwelch</code> or ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>logical or a positive number indicating whether to plot standard
error of mean; default is false. If provided with a number, then a multiple
of standard error will be drawn. This option is only available when power
is in log-scale (decibel unit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xticks</code></td>
<td>
<p>ticks to show on frequency axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical, whether the plot should be added to existing canvas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.se, alpha.se</code></td>
<td>
<p>controls the color and opacity of the standard error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xline, yline</code></td>
<td>
<p>controls how close the axis labels to the corresponding axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>whether to draw rectangular grid lines to the plot; only
respected when <code>add=FALSE</code>; default is true</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>the margin in which <code>pwelch</code> should be applied to</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with class <code>'ravetools-pwelch'</code> that contains the
following items:
</p>

<dl>
<dt><code>freq</code></dt>
<dd>
<p>frequencies used to calculate the 'periodogram'</p>
</dd>
<dt><code>spec</code></dt>
<dd>
<p>resulting spectral power for each frequency</p>
</dd>
<dt><code>window</code></dt>
<dd>
<p>window function (in numerical vector) used</p>
</dd>
<dt><code>noverlap</code></dt>
<dd>
<p>number of overlapping time-points between two adjacent windows</p>
</dd>
<dt><code>nfft</code></dt>
<dd>
<p>number of basis functions</p>
</dd>
<dt><code>fs</code></dt>
<dd>
<p>sample rate</p>
</dd>
<dt><code>x_len</code></dt>
<dd>
<p>input signal length</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>a character string <code>'Welch'</code></p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- rnorm(1000)
pwel &lt;- pwelch(x, 100)
pwel

plot(pwel, log = "xy")

</code></pre>


</div>