<div class="container">

<table style="width: 100%;"><tr>
<td>RDML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 class <code>RDML</code> – contains methods to read and overview fluorescence 
data from RDML v1.1 and v1.2 format files</h2>

<h3>Description</h3>

<p>This class is a container for RDML format data (Lefever et al. 
2009). The data may be further transformed to the appropriate format of the 
<code>qpcR</code> (Ritz et al. 2008, Spiess et al. 2008) and <code>chipPCR</code> 
(Roediger et al. 2015) packages (see RDML.new for import details). 
Real-time PCR Data Markup Language (RDML) is the recommended file format 
element in the Minimum Information for Publication of Quantitative Real-Time 
PCR Experiments (MIQE) guidelines (Bustin et al. 2009). The inner structure of 
imported data faithfully reflects the structure of RDML file v1.2. All data with 
the exception for fluorescence values can be represented as <code>data.frame</code> by 
method <code>AsTable</code>. Such possibility of data representation streamlines 
sample filtering (by targets, types, etc.) and serves as request for <code>GetFData</code>
method, which extracts fluorescence data for specified samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RDML
</code></pre>


<h3>Format</h3>

<p>An <code>R6Class</code> generator object.</p>


<h3>Fields</h3>

<p>Type, structure of data and description of fields can be 
viewed at RDML v1.2 file description. Names of fields are first level of 
XML tree.
</p>


<h3>Methods</h3>


<dl>
<dt>new</dt>
<dd>
<p>creates a new instance of <code>RDML</code> class object (see RDML.new)</p>
</dd> 
<dt>AsTable</dt>
<dd>
<p>represent RDML data as <code>data.frame</code> (see RDML.AsTable)</p>
</dd>
<dt>GetFData</dt>
<dd>
<p>gets fluorescence data (see RDML.GetFData)</p>
</dd>
<dt>SetFData</dt>
<dd>
<p>sets fluorescence data (see RDML.SetFData)</p>
</dd>
<dt>Merge</dt>
<dd>
<p>merges two <code>RDML</code> to one (see MergeRDMLs)</p>
</dd>
<dt>AsDendrogram</dt>
<dd>
<p>represents structure of <code>RDML</code> object as dendrogram(see 
RDML.AsDendrogram)</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Konstantin A. Blagodatskikh &lt;k.blag@yandex.ru&gt;, Stefan Roediger 
&lt;stefan.roediger@b-tu.de&gt;, Michal Burdukiewicz 
&lt;michalburdukiewicz@gmail.com&gt;
</p>


<h3>References</h3>

<p>RDML format http://www.rdml.org/ <code>R6</code> package 
http://cran.r-project.org/web/packages/R6/index.html
</p>
<p><code>qpcR</code> package http://cran.r-project.org/web/packages/qpcR/index.html
</p>
<p><code>chipPCR</code> package: 
http://cran.r-project.org/web/packages/chipPCR/index.html
</p>
<p>Roediger S, Burdukiewicz M and Schierack P (2015). chipPCR: an R Package 
to Pre-Process Raw Data of Amplification Curves. <em>Bioinformatics</em> first 
published online April 24, 2015 doi:10.1093/bioinformatics/btv205
</p>
<p>Ritz, C., Spiess, A.-N., 2008. qpcR: an R package for sigmoidal model 
selection in quantitative real-time polymerase chain reaction analysis. 
<em>Bioinformatics</em> 24, 1549–1551. 
doi:10.1093/bioinformatics/btn227
</p>
<p>Spiess, A.-N., Feig, C., Ritz, C., 2008. Highly accurate sigmoidal fitting 
of real-time PCR data by introducing a parameter for asymmetry. <em>BMC 
Bioinformatics</em> 9, 221. doi:10.1186/1471-2105-9-221
</p>
<p>Bustin, S.A., Benes, V., Garson, J.A., Hellemans, J., Huggett, J., Kubista,
M., Mueller, R., Nolan, T., Pfaffl, M.W., Shipley, G.L., Vandesompele, J., 
Wittwer, C.T., 2009. The MIQE guidelines: minimum information for 
publication of quantitative real-time PCR experiments. <em>Clin. Chem.</em> 
55, 611–622.  doi:10.1373/clinchem.2008.112797
</p>
<p>Lefever, S., Hellemans, J., Pattyn, F., Przybylski, D.R., Taylor, C., 
Geurts, R., Untergasser, A., Vandesompele, J., RDML consortium, 2009. RDML:
structured language and reporting guidelines for real-time quantitative PCR
data.  <em>Nucleic Acids Res.</em> 37, 2065–2069. doi:10.1093/nar/gkp056
</p>


<h3>Examples</h3>

<pre><code class="language-R">## EXAMPLE 1:
## internal dataset lc96_bACTXY.rdml (in 'data' directory)
## generated by Roche LightCycler 96. Contains qPCR data
## with four targets and two types.
## Import with default settings.
PATH &lt;- path.package("RDML")
filename &lt;- paste(PATH, "/extdata/", "lc96_bACTXY.rdml", sep ="")
lc96 &lt;- RDML$new(filename)

tab &lt;- lc96$AsTable(name.pattern = paste(sample[[react$sample$id]]$description,
                                         react$id$id), 
                    quantity = sample[[react$sample$id]]$quantity$value)
## Show dyes names
unique(tab$target.dyeId)
## Show types of the samples for dye 'FAM'
library(dplyr)
unique(filter(tab, target.dyeId == "FAM")$sample.type)

## Show template quantities for dye 'FAM' type 'std'#' 
## Not run: 
COPIES &lt;- filter(tab, target.dyeId == "FAM", sample.type == "std")$quantity
## Define calibration curves (type of the samples - 'std').
## No replicates.
library(qpcR)
CAL &lt;- modlist(lc96$GetFData(filter(tab,
                                    target.dyeId == "FAM", 
                                    sample.type == "std")),
               baseline="lin", basecyc=8:15)
## Define samples to predict (first two samples with the type - 'unkn').
PRED &lt;- modlist(lc96$GetFData(filter(tab, 
                                    target.dyeId == "FAM", 
                                    sample.type == "unkn")),
               baseline="lin", basecyc=8:15)
## Conduct quantification.
calib(refcurve = CAL, predcurve = PRED, thresh = "cpD2",
      dil = COPIES)

## End(Not run)
## Not run: 
## EXAMPLE 2:
## internal dataset lc96_bACTXY.rdml (in 'data' directory)
## generated by Roche LightCycler 96. Contains qPCR data
## with four targets and two types.
## Import with default settings.
library(chipPCR)                        
PATH &lt;- path.package("RDML")
filename &lt;- paste(PATH, "/extdata/", "lc96_bACTXY.rdml", sep ="")
lc96 &lt;- RDML$new(filename)

tab &lt;- lc96$AsTable(name.pattern = paste(sample[[react$sample$id]]$description,
                                         react$id$id), 
                    quantity = sample[[react$sample$id]]$quantity$value)
## Show targets names
unique(tab$target)
## Fetch cycle dependent fluorescence for HEX chanel
tmp &lt;- lc96$GetFData(filter(tab, target == "bACT", sample.type == "std"))
## Fetch vector of dillutions 
dilution &lt;- filter(tab, target.dyeId == "FAM", sample.type == "std")$quantity

## Use plotCurves function from the chipPCR package to 
## get an overview of the amplification curves
tmp &lt;- as.data.frame(tmp)
plotCurves(tmp[,1], tmp[,-1])
par(mfrow = c(1,1))
## Use inder function from the chipPCR package to 
## calculate the Cq (second derivative maximum, SDM)
SDMout &lt;- sapply(2L:ncol(tmp), function(i) {
  SDM &lt;- summary(inder(tmp[, 1], tmp[, i]), print = FALSE)[2]
})

## Use the effcalc function from the chipPCR package and 
## plot the results for the calculation of the amplification
## efficiency analysis.
plot(effcalc(dilution, SDMout), CI = TRUE)

## End(Not run)
## Not run: 
## EXAMPLE 3:
## internal dataset BioRad_qPCR_melt.rdml (in 'data' directory)
## generated by Bio-Rad CFX96. Contains qPCR and melting data.
## Import with custom name pattern.
PATH &lt;- path.package("RDML")
filename &lt;- paste(PATH, "/extdata/", "BioRad_qPCR_melt.rdml", sep ="")
cfx96 &lt;- RDML$new(filename)
## Use plotCurves function from the chipPCR package to 
## get an overview of the amplification curves
library(chipPCR)
## Extract all qPCR data 
tab &lt;- cfx96$AsTable()
cfx96.qPCR &lt;- as.data.frame(cfx96$GetFData(tab))
plotCurves(cfx96.qPCR[,1], cfx96.qPCR[,-1], type = "l")

## Extract all melting data 
cfx96.melt &lt;- cfx96$GetFData(tab, dp.type = "mdp")
## Show some generated names for samples.
colnames(cfx96.melt)[2L:5]
## Select columns that contain
## samples with dye 'EvaGreen' and have type 'pos'
## using filtering by names.
cols &lt;- cfx96$GetFData(filter(tab, grepl("pos_EvaGreen$", fdata.name)),
                       dp.type = "mdp")
## Conduct melting curve analysis.
library(qpcR)
invisible(meltcurve(cols, fluos = 2:ncol(cols),
          temps = rep(1, ncol(cols) - 1)))

## End(Not run)
</code></pre>


</div>