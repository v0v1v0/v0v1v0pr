<div class="container">

<table style="width: 100%;"><tr>
<td>r_diff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>r_diff function</h2>

<h3>Description</h3>

<p>This function estimates var(R(y~x[,v1]) - R(y~x[,v2]))
where R is the correlation between y and x,
y is N by 1 matrix having the dependent variable, and
x is N by M matrix having M explanatory variables.
v1 or v2 indicates the ith column in the x matrix
(v1 or v2 can be multiple values between 1 - M, see Arguments below)
</p>


<h3>Usage</h3>

<pre><code class="language-R">r_diff(dat, v1, v2, nv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>N by (M+1) matrix having variables in the order of cbind(y,x)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v1</code></td>
<td>
<p>This can be set as v1=c(1) or v1=c(1,2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v2</code></td>
<td>
<p>This can be set as v2=c(2), v2=c(3), v2=c(1,3) or v2=c(3,4)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nv</code></td>
<td>
<p>Sample size</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function will estimate significant difference between two PGS (either dependent or independent and joint or single). To get the test statistics for the difference between R(y~x[,v1]) and R(y~x[,v2]). (here we define R_1=R(y~x[,v1])) and R_2=R(y~x[,v2]))). The outputs are listed as follows.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r1</code></td>
<td>
<p>R_1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>R_2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var1</code></td>
<td>
<p>Variance of R_1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var2</code></td>
<td>
<p>variance of R_2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_diff</code></td>
<td>
<p>Variance of difference between R_1 and R_2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2_based_p</code></td>
<td>
<p>P-value for significant difference between R_1 and R_2 for two tailed test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_based_p_one_tail</code></td>
<td>
<p>P-value for significant difference between R_1 and R_2 for one tailed test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_diff</code></td>
<td>
<p>Differences between R_1 and R_2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_diff</code></td>
<td>
<p>Upper limit of 95% CI for the difference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_diff</code></td>
<td>
<p>Lower limit of 95% CI for the difference</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">#To get the test statistics for the difference between R(y~x[,1]) and 
#R(y~x[,2]). (here we define R_1=R(y~x[,1])) and R_2=R(y~x[,2])))

dat=dat1
nv=length(dat$V1)
v1=c(1)
v2=c(2)
output=r_diff(dat,v1,v2,nv)
output

#r2redux output

#output$r1 (R_1)
#0.1958636

#output$r2 (R_2)
#0.197006

#output$var1 (variance of R_1)
#0.0009247466

#output$var2 (variance of R_1)
#0.0001451358

#output$var_diff (variance of difference between R_1 and R_2)
#3.65286e-06

#output$r_based_p (two tailed p-value for significant difference between R_1 and R_2)
#0.5500319

#output$r_based_p_one_tail (one tailed p-value 
#0.2750159

#output$mean_diff
#-0.001142375 (differences between R2_1 and R2_2)

#output$upper_diff (upper limit of 95% CI for the difference)
#0.002603666

#output$lower_diff (lower limit of 95% CI for the difference)
#-0.004888417


#To get the test statistics for the difference between R(y~x[,1]+[,2]) and 
#R(y~x[,2]). (here R_1=R(y~x[,1]+x[,2]) and R_2=R(y~x[,1]))

nv=length(dat$V1)
v1=c(1,2)
v2=c(2)
output=r_diff(dat,v1,v2,nv)
output

#output$r1
#0.1974001

#output$r2
#0.197006

#output$var1
#0.0009235848

#output$var2
#0.0009238836

#output$var_diff
#3.837451e-06

#output$r2_based_p
#0.8405593

#output$mean_diff
#0.0003940961

#output$upper_diff
#0.004233621

#output$lower_diff
#-0.003445429


#Note: If the directions are not consistent, for instance, if one correlation
#is positive (R_1) and another is negative (R_2), or vice versa, it is 
#crucial to approach the interpretation of the comparative test with caution. 
#This caution is especially emphasized when applying r_diff() 
#in a nested model comparison involving a joint model
</code></pre>


</div>