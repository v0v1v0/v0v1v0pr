<div class="container">

<table style="width: 100%;"><tr>
<td>cubeCoord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Coordinate representation of a compositional cube and of a sample of compositional cubes</h2>

<h3>Description</h3>

<p>cubeCoord computes a system of orthonormal coordinates of a compositional cube. 
Computation of either pivot coordinates or a coordinate system based on the given SBP is possible.
</p>
<p>Wrapper (cubeCoordWrapper): For each compositional cube in the sample cubeCoordWrapper computes 
a system of orthonormal coordinates and provide a simple descriptive analysis. 
Computation of either pivot coordinates or a coordinate system based on the 
given SBP is possible.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cubeCoord(
  x,
  row.factor = NULL,
  col.factor = NULL,
  slice.factor = NULL,
  value = NULL,
  SBPr = NULL,
  SBPc = NULL,
  SBPs = NULL,
  pivot = FALSE,
  print.res = FALSE
)

cubeCoordWrapper(
  X,
  obs.ID = NULL,
  row.factor = NULL,
  col.factor = NULL,
  slice.factor = NULL,
  value = NULL,
  SBPr = NULL,
  SBPc = NULL,
  SBPs = NULL,
  pivot = FALSE,
  test = FALSE,
  n.boot = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a data frame containing variables representing row, column and slice factors of the respective compositional cube and variable with the values of the composition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.factor</code></td>
<td>
<p>name of the variable representing the row factor. Needs to be stated with the quotation marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.factor</code></td>
<td>
<p>name of the variable representing the column factor. Needs to be stated with the quotation marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slice.factor</code></td>
<td>
<p>name of the variable representing the slice factor. Needs to be stated with the quotation marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>name of the variable representing the values of the composition. Needs to be stated with the quotation marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SBPr</code></td>
<td>
<p>an <code class="reqn">I-1\times I</code> array defining the sequential binary partition of the values of the row factor, where I is the number of the row factor levels. The values assigned in the given step to the + group are marked by 1, values from  the - group by -1 and the rest by 0. If it is not provided, the pivot version of coordinates is constructed automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SBPc</code></td>
<td>
<p>an <code class="reqn">J-1\times J</code> array defining the sequential binary partition of the values of the column factor, where J is the number of the column factor levels. The values assigned in the given step to the + group are marked by 1, values from  the - group by -1 and the rest by 0. If it is not provided, the pivot version of coordinates is constructed automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SBPs</code></td>
<td>
<p>an <code class="reqn">K-1\times K</code> array defining the sequential binary partition of the values of the slice factor, where K is the number of the slice factor levels. The values assigned in the given step to the + group are marked by 1, values from  the - group by -1 and the rest by 0. If it is not provided, the pivot version of coordinates is constructed automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pivot</code></td>
<td>
<p>logical, default is FALSE. If TRUE, or one of the SBPs is not defined, its pivot version is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.res</code></td>
<td>
<p>logical, default is FALSE. If TRUE, the output is displayed in the Console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data frame containing variables representing row, column and slice factors 
of the respective compositional cubes, variable with the values 
of the composition and variable distinguishing the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.ID</code></td>
<td>
<p>name of the variable distinguishing the observations. Needs to be stated with the quotation marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>logical, default is FALSE. If TRUE, the bootstrap analysis of coordinates is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>
<p>number of bootstrap samples.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>cubeCoord
</p>
<p>This transformation moves the IJK-part compositional cubes from the simplex into a (IJK-1)-dimensional real space isometrically with respect to its three-factorial nature.
</p>
<p>Wrapper (cubeCoordWrapper): Each of n IJK-part compositional cubes from the sample is 
with respect to its three-factorial nature isometrically transformed 
from the simplex into a (IJK-1)-dimensional real space. 
Sample mean values and standard deviations are computed and using 
bootstrap an estimate of 95 % confidence interval is given.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Coordinates</code></td>
<td>
<p>an array of orthonormal coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Grap.rep</code></td>
<td>
<p>graphical representation of the coordinates. 
Parts denoted by + form the groups in the numerator of the respective computational formula, 
parts - form the denominator and parts . are not involved in the given coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Row.balances</code></td>
<td>
<p>an array of row balances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Column.balances</code></td>
<td>
<p>an array of column balances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Slice.balances</code></td>
<td>
<p>an array of slice balances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Row.column.OR</code></td>
<td>
<p>an array of row-column OR coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Row.slice.OR</code></td>
<td>
<p>an array of row-slice OR coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Column.slice.OR</code></td>
<td>
<p>an array of column-slice OR coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Row.col.slice.OR</code></td>
<td>
<p>an array of coordinates describing the mutual interaction between all three factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Contrast.matrix</code></td>
<td>
<p>contrast matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Log.ratios</code></td>
<td>
<p>an array of pure log-ratios between groups of parts without the normalizing constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Coda.cube</code></td>
<td>
<p>cube form of the given composition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bootstrap</code></td>
<td>
<p>array of sample means, standard deviations and bootstrap confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cubes</code></td>
<td>
<p>Cube form of the given compositions.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kamila Facevicova
</p>


<h3>References</h3>

<p>Facevicova, K., Filzmoser, P. and K. Hron (2019) Compositional Cubes: Three-factorial Compositional Data. Under review.
</p>


<h3>See Also</h3>

<p><code>tabCoord</code> 
<code>tabCoordWrapper</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">###################
### Coordinate representation of a CoDa Cube
## Not run: 
### example from Fa\v cevicov\'a (2019)
data(employment2)
CZE &lt;- employment2[which(employment2$Country == 'CZE'), ]

# pivot coordinates
cubeCoord(CZE, "Sex", 'Contract', "Age", 'Value')

# coordinates with given SBP

r &lt;- t(c(1,-1))
c &lt;- t(c(1,-1))
s &lt;- rbind(c(1,-1,-1), c(0,1,-1))

cubeCoord(CZE, "Sex", 'Contract', "Age", 'Value', r,c,s)

## End(Not run)

###################
### Analysis of a sample of CoDa Cubes
## Not run: 
### example from Fa\v cevicov\'a (2019)
data(employment2)
### Compositional tables approach,
### analysis of the relative structure.
### An example from Facevi\v cov\'a (2019)

# pivot coordinates
cubeCoordWrapper(employment2, 'Country', 'Sex', 'Contract', 'Age', 'Value',  
test=TRUE)

# coordinates with given SBP (defined in the paper)

r &lt;- t(c(1,-1))
c &lt;- t(c(1,-1))
s &lt;- rbind(c(1,-1,-1), c(0,1,-1))

res &lt;- cubeCoordWrapper(employment2, 'Country', 'Sex', 'Contract', 
"Age", 'Value', r,c,s, test=TRUE)

### Classical approach,
### generalized linear mixed effect model.

library(lme4)
employment2$y &lt;- round(employment2$Value*1000)
glmer(y~Sex*Age*Contract+(1|Country),data=employment2,family=poisson)

### other relations within cube (in the log-ratio form)
### e.g. ratio between women and man in the group FT, 15to24
### and ratio between age groups 15to24 and 55plus

# transformation matrix
T &lt;- rbind(c(1,rep(0,5), -1, rep(0,5)), c(rep(c(1/4,0,-1/4), 4)))
T %*% t(res$Contrast.matrix) %*%res$Bootstrap[,1]

## End(Not run)
</code></pre>


</div>