<div class="container">

<table style="width: 100%;"><tr>
<td>determine.C</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>determine.C</h2>

<h3>Description</h3>

<p>by assumption, there is a point q such that to the left of q, f_B sim  f_0 (z). That is, there is a q
such that there are only null values to the left of q. We determine q using a
change point method related to penalized model selection. See
Gauran, Iris Ivy M. and Park, Junyong and Lim, Johan and Park, DoHwan and Zylstra, John and Peterson,
Thomas and Kann, Maricel and Spouge, John L. "Empirical null estimation using zero-inflated discrete
mixture distributions and its application to protein domain data" Biometrics, 2018 74:2
</p>


<h3>Usage</h3>

<pre><code class="language-R">determine.C(f_fit, df, t1, trace.plot = FALSE, start_at = 30, debug.flag = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f_fit</code></td>
<td>
<p>object returned by f.fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>data frame containing x and y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>initial estimates of xi, omega, and  lambda. Generally returned by fit.to.data.set.wrapper</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.plot</code></td>
<td>
<p>– produce a plot of each fit with a 1 second sleep. Can be watched as a movie.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_at</code></td>
<td>
<p>–  x &lt;- f_fit$midpoints  is of length 119 (quite arbitrary). We use the first start_at
values of x to fit the skew-normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug.flag</code></td>
<td>
<p>– debugging level. If debug.flag &gt;0 then some output is printed to the screen.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>– a vector of numbers of length equal to the rows in df (119 in this case). Say that this is qq.
We determine the minimum value of qq. This is the value "C" such that
– to the right of C, our data is generated from the NULL distribution
– to the left of C, we have a mixture of the NULL and non-NULL distribution
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(imp20000)                                      
imp&lt;-log(imp20000$importances)                               
t2&lt;-imp20000$counts
temp&lt;-imp[t2 &gt; 1]   #see                          
temp&lt;-temp[temp != -Inf]                         
temp &lt;- temp - min(temp) + .Machine$double.eps   
f_fit &lt;- f.fit(temp)                             
y &lt;- f_fit$zh$density                            
x &lt;- f_fit$midpoints                             
df &lt;- data.frame(x, y)                           
initial.estimates &lt;- fit.to.data.set.wrapper(df, temp, try.counter = 3,return.all=FALSE)           
initial.estimates&lt;-  initial.estimates$Estimate

qq&lt;- determine.C(f_fit,df,initial.estimates,start_at=37,trace.plot = FALSE)    
cc&lt;-x[which.min(qq)]                                                                             
plot(x,qq,main="determine cc")                                                                   
abline(v=cc)
# unfortunately the minima does not appear reasonable. In this case it is advisable to use the
# 95th quantile


#needs the  chromosome 22 data in  RFlocalfdr.data. Also has a long runtime.
library(RFlocalfdr.data)
data(ch22)                                                                                    
?ch22                                                                                        
t2 &lt;-ch22$C                                                                                   
imp&lt;-log(ch22$imp)                                                                            
#Detemine a cutoff to get a unimodal density.                                                 
res.temp &lt;- determine_cutoff(imp, t2 ,cutoff=c(25,30,35,40),plot=c(25,30,35,40),Q=0.75)       
plot(c(25,30,35,40),res.temp[,3])                                                             
imp&lt;-imp[t2 &gt; 30]
debug.flag &lt;- 0
f_fit&lt;- f.fit(imp,debug.flag=debug.flag,temp.dir=temp.dir)
#makes the plot histogram_of_variable_importances.png                              
y&lt;-f_fit$zh$density                                                                                                                           
x&lt;-f_fit$midpoints                                                                                                                                    
plot(density(imp),main="histogram and fitted spline")                                                                                     
lines(x,y,col="red")                                                                                                                      
df&lt;-data.frame(x,y)                                                                                                                           
initial.estimates &lt;- fit.to.data.set.wrapper(df,imp,debug.flag=debug.flag,plot.string="initial",
                                              temp.dir=temp.dir,try.counter=3)    
initial.estimates &lt;- data.frame(summary(initial.estimates)$parameters)$Estimate                                                               
# 1.102303 1.246756 1.799169
qq&lt;- determine.C(f_fit,df,initial.estimates,start_at=37,trace.plot = TRUE)    
cc&lt;-x[which.min(qq)]                                                                             
plot(x,qq,main="determine cc")                                                                   
abline(v=cc)

</code></pre>


</div>