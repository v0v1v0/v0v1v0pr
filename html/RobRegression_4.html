<div class="container">

<table style="width: 100%;"><tr>
<td>Robust_Variance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust_Variance</h2>

<h3>Description</h3>

<p>The aim is to provide a robust estimation of the variance for Guassian models with reduction dimension. More precisely we considering a q dimensional random vector  whose variance can be written as <code class="reqn">\Sigma = C + \sigma I</code> where C is a matrix of rank d, with d possibly much smaller than q, <code class="reqn">sigma</code> is a positive scalar, and I is the identity matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Robust_Variance(X,K=ncol(X),par=TRUE,alphaRM=0.75,
                c='default',w=2,mc_sample_size='default',
                methodMC='Robbins',niterMC=50,method_MCM='Weiszfeld',
                eps_vp=10^(-6))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix whose raws are the vector we want to estimate the variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>A vector containing the possible values of d. The 'good' d is chosen with the help of a penatly criterion if the length of K is larger than 10. Default is <code>ncol(X)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Is equal to <code>TRUE</code> if the parallelization of the algorithm is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc_sample_size</code></td>
<td>
<p>The number of data generated for the Monte-Carlo method for estimating robustly the eigenvalues of the variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methodMC</code></td>
<td>
<p>The method chosen to estimate robustly the variance. Can be <code>'Robbins'</code>, <code>'Grad'</code> or <code>'Fix'</code>. Default is <code>'Robbins'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niterMC</code></td>
<td>
<p>The number of iterations for estimating robustly the variance of each class if <code>methodMC='Fix'</code> or <code>methodMC='Grad'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_MCM</code></td>
<td>
<p>The method chosen to estimate Median Covariation Matrix. Can be <code>'Weiszfeld'</code> or <code>'ASGD'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaRM</code></td>
<td>
<p>A scalar between 1/2 and 1 used in the stepsequence for the Robbins-Monro method if <code>methodMC='Robbins'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>The constant in the stepsequence if <code>methodMC='Robbins'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>The power for the weighted averaged Robbins-Monro algorithm if <code>methodMC='Robbins'</code>. Default is <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps_vp</code></td>
<td>
<p>The minimum values for the estimates of the eigenvalues of the Variance can take. Default is <code>10^-6</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>The robust estimation of the variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invSigma</code></td>
<td>
<p>The robuste estimation of the inverse of the variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCM</code></td>
<td>
<p>The Median Covariation Matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvalues</code></td>
<td>
<p>A vector containing the estimation of the d+1 main eigenvalues of the variance, where d+1 is the optimal choice belong K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCM_eigenvalues</code></td>
<td>
<p>A vector containing the estimation of the d+1 main eigenvalues of the Median Covariation Matrix, where d+1 is the optimal choice belong K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cap</code></td>
<td>
<p>The result given for capushe for selecting d if the length of K is larger than 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction_results</code></td>
<td>
<p>A list containing the results for all possible K.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cardot, H., Cenac, P. and Zitt, P-A. (2013). Efficient and fast estimation of the geometric median in Hilbert spaces with an averaged stochastic gradient algorithm. <em>Bernoulli</em>, 19, 18-43.
</p>
<p>Cardot, H. and Godichon-Baggioni, A. (2017). Fast Estimation of the Median Covariation Matrix with Application to Online Robust Principal Components Analysis.  <em>Test</em>, 26(3), 461-480
</p>
<p>Vardi, Y. and Zhang, C.-H. (2000). The multivariate L1-median and associated data depth. <em>Proc. Natl. Acad. Sci. USA</em>, 97(4):1423-1426.
</p>


<h3>See Also</h3>

<p>See also <code>Robust_Mahalanobis_regression</code>, <code>Robust_regression</code> and <code>RobRegression-package</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
q&lt;-100
d&lt;-10
n&lt;-2000
Sigma&lt;- diag(c(d:1,rep(0,q-d)))+ diag(rep(0.1,q))
X=mvtnorm::rmvnorm(n=n,sigma=Sigma)
RobVar = Robust_Variance(X,K=q)
sum((RobVar$Sigma-Sigma)^2)/q

</code></pre>


</div>