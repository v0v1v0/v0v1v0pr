<div class="container">

<table style="width: 100%;"><tr>
<td>robustsae</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Small Area Estimation Modeling Both Means and Variances</h2>

<h3>Description</h3>

<p>This function provides full Bayesian Analysis for specific area-level small area models when data are provided for modeling both the mean and the variance.</p>


<h3>Usage</h3>

<pre><code class="language-R">robustsae(formula, S2, ni, nsim = 1000, burnin = 500, data, truemean)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fitted. The details of model
specification are given under Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2</code></td>
<td>
<p>a vector contain the sampling variances which are given for estimating the true variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ni</code></td>
<td>
<p>a vector containing the sample sizes for each area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>user-specified number of MCMC draws. See German (2006).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>the number of burning iterations for the sampler. See German (2006).</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>, <code>S2</code> and <code>ni</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truemean</code></td>
<td>
<p>true mean values for each area.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">\theta_i</code> denotes interest parameter for each area i, <code class="reqn">x_i</code> the available area-specific auxiliary data, <code class="reqn">\beta</code> the regression coefficients and <code class="reqn">m</code> the number of small areas. A typical area level model is given by
</p>
<p style="text-align: center;"><code class="reqn">y_i= x_i \beta + u_i + e_i, (i = 1, \ldots, m).</code>
</p>

<p>Assume that the random effects <code class="reqn">u_i</code> and the sampling errors <code class="reqn">e_i</code> are to be independently distributed  with the <code class="reqn">u_i ~ N(0, \sigma^2)</code> and the <code class="reqn">e_i ~ N(0, v_i)</code>. To foster robustness in small area estimation procedures, student t distribution is used for the random effects. Also, due to the availability of additional data purported to estimate the error variances, this considers modeling of both the means and the variances. 
</p>
<p>The robust Bayesian small area estimation model is
</p>
<p style="text-align: center;"><code class="reqn">y_i | \theta_i ~ N(\theta_i, v_i)</code>
</p>

<p style="text-align: center;"><code class="reqn">S_i^2 | v_i  ~ Gamma((n_i-1)/2,  1/(2v_i))</code>
</p>

<p style="text-align: center;"><code class="reqn"> \theta_i | \beta, \sigma^2, df ~ t(x_i\beta, \sigma^2, df)</code>
</p>
<p>,
where <code class="reqn">df</code> is degrees of freedom parameter.
For a full Bayesian analysis, this function uses the modified Jeffrey' prior which is the product of the general Jeffrey' prior and <code class="reqn">e^(-a/(2*\sigma^2))</code> where <code class="reqn">a</code> is chosen as 1:
</p>
<p style="text-align: center;"><code class="reqn">\pi(\beta) ~ 1</code>
</p>

<p style="text-align: center;"><code class="reqn">\pi(v_i)~ 1/v_i</code>
</p>

<p style="text-align: center;"><code class="reqn">\sigma^2 ~ Inv-Gamma(p/2, a/2),  for a&gt;0</code>
</p>

<p style="text-align: center;"><code class="reqn">\pi(df) ~ df^{-1/2} (df+1)^{p/2 -1} (df+3)^{- p/2 - 1/2}   </code>
</p>

<p>The estimates of interest parameters are obtained by Rao-Balackwellization with Gibbs sampling with Metropolis-Hastings algorithm.
</p>


<h3>Value</h3>

<p>The function returns a object of class <code>"robustsae"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p> Rao-Balackwellization estimates of theta's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p> Rao-Balackwellization estimates of v's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Criteria</code></td>
<td>
<p> a list containing the following comparison criteria : Returns NA if <code>truemean</code> is not provided. 
</p>

<ul>
<li>
<p><code>ASD</code>:  average squared deviation, defined as <code class="reqn">1/m \sum_{i=1}^{m} (\hat{\theta}_i - \theta_i)^2</code>
</p>
</li>
<li>
<p><code>AAB</code>:  average absolute bias, defined as <code class="reqn">1/m \sum_{i=1}^{m} |\hat{\theta}_i - \theta_i|</code>
</p>
</li>
<li>
<p><code>ASRB</code>:  average squared relative bias, defined as <code class="reqn">1/m \sum_{i=1}^{m} ((\hat{\theta}_i - \theta_i)/{\theta_i})^2</code>
</p>
</li>
<li>
<p><code>ARB</code>:  average relative bias, defined as <code class="reqn">1/m \sum_{i=1}^{m}
|(\hat{\theta}_i - \theta_i)/\theta_i|</code>
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Malay Ghosh, Jiyoun Myung, Fernando Moura
</p>


<h3>References</h3>

<p>Rao, J. N. K. (2003) <em> Small Area Estimation</em>. John Wiley and Sons.
</p>
<p>Chip, S., and Green berg, E. (1995). Understanding the Metropolis-Hastings Algorithm.
<em>The American Statistician</em>, <b>49</b>, 327-335.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># If there is truemean data,
# load data set
data(BZdata)
attach(BZdata)

result &lt;- robustsae(y ~ X1 + X2, S2, ni = BZdata$ni, nsim = 1000, burnin = 500, 
                      data = BZdata, truemean = truemean)
result

detach(BZdata)

# If there is no truemean data,
#load data set
data(corndata)
attach(corndata)

result2 &lt;- robustsae(Xi ~ Z1i, Si^2, ni=corndata$ni, data = corndata) # no truemean
result2$mean
result2$variance

detach(corndata)
</code></pre>


</div>