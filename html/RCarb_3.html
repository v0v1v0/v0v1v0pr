<div class="container">

<table style="width: 100%;"><tr>
<td>model_DoseRate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model dose rate evolution in carbonate-rich samples</h2>

<h3>Description</h3>

<p>This function models the dose rate evolution in carbonate enrich environments. For the
calculation internal functions are called.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_DoseRate(
  data,
  DR_conv_factors = NULL,
  length_step = 1L,
  max_time = 500L,
  n.MC = 100,
  method_control = list(),
  txtProgressBar = TRUE,
  verbose = TRUE,
  plot = TRUE,
  par_local = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame (<strong>required</strong>): input data following the structure given
in the example data set <code>data(Example_Data)</code>. The input data.frame should have at least
one row (i.e. values for one sample). For multiple rows the function is automatically re-called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DR_conv_factors</code></td>
<td>
<p>character (<em>optional</em>): applied dose rate conversion factors,
allowed input values are <code>"Carb2007"</code>, <code>"Adamiec_Aitken_1998"</code>, <code>"Guerin_et_al_2011"</code>,
<code>"Liritzis_et_al_2013"</code>. <code>NULL</code> triggers the default, which is <code>"Carb2007"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length_step</code></td>
<td>
<p>numeric (with default): step length used for the calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_time</code></td>
<td>
<p>numeric (with default): maximum temporal search range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.MC</code></td>
<td>
<p>numeric (with default): number of Monte Carlo runs used for the error calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_control</code></td>
<td>
<p>(<em>optional</em>): additional arguments that can be provided to the control the
the modelling. See details for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txtProgressBar</code></td>
<td>
<p>logical (with default): enables/disables the <code>txtProgressBar</code> for the MC runs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical (with default): enables/disables verbose mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical (with default): enables/disables plot output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_local</code></td>
<td>
<p>logical (with default): enables/disable local par settings, If set
to <code>FALSE</code> all global par settings are accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to the underlying plot functions, see also details for further information. Supported standard arguments are <code>mfrow</code>, <code>xlim</code>, <code>xlab</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is the starting point for the dose rate modelling for carbonate enrich
environments. It provides basically the same functionality as the original version of <code>'Carb'</code>, i.e.
you should be also aware of the limitations of this modelling approach. In particular: The model
assumes a linear carbonate mass increase due to post-depositional processes. Please read the
references cited blow.<br></p>
<p><strong>Uncertainty estimation</strong>
</p>
<p>For estimating the uncertainties, Monte-Carlo (MC) simulation runs are used. For very
small values (close to 0) this can, however, lead to edge effects (similar in <code>'Carb'</code>) since
values below 0 are set to 0.
</p>


<h3>Value</h3>

<p>The function returns numerical and graphical output
</p>
<p>———————————–<br><code style="white-space: pre;">⁠[ NUMERICAL OUTPUT ]⁠</code><br>
———————————–<br></p>

<ul><li>
<p> A data.frame which is the combination of the input and values calculated by this function.
</p>
</li></ul>
<p>———————————–<br><code style="white-space: pre;">⁠[ GRAPHICAL OUTPUT ]⁠</code><br>
———————————–<br></p>
<p><strong>Upper plot:</strong> Dose rate evolution over time backwards. The solid black line is the calculation
output, the grey shaded area indicates the 2-sigma error margins. The dashed blue line is an indicator
of the quality of the error estimations based on Monte Carlo (MC) runs.The closer it follows the
black line, the more reliable are the given error margins. <br></p>
<p><strong>Lower plot:</strong> Totally absorbed dose over time. The plot is an representation of the 'new'
age based on the carbonate modelling.
</p>


<h3>Function version</h3>

<p>0.2.1
</p>


<h3>How to cite</h3>

<p>Kreutzer, S., 2022. model_DoseRate(): Model dose rate evolution in carbonate-rich samples. Function version 0.2.1. In: Kreutzer, S., Nathan, R.P., Mauz, B., 2022. RCarb: Dose Rate Modelling of Carbonate-Rich Samples . R package version 0.1.6. https://r-lum.github.io/RCarb/
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany); based
on 'MATLAB' code given in file Carb_2007a.m of <em>Carb</em>
</p>


<h3>References</h3>

<p>Mauz, B., Hoffmann, D., 2014. What to do when carbonate replaced water: Carb, the model for estimating the
dose rate of carbonate-rich samples. Ancient TL 32, 24-32. <a href="http://ancienttl.org/ATL_32-2_2014/ATL_32-2_Mauz_p24-32.pdf">http://ancienttl.org/ATL_32-2_2014/ATL_32-2_Mauz_p24-32.pdf</a>
</p>
<p>Nathan, R.P., Mauz, B., 2008. On the dose-rate estimate of carbonate-rich sediments for trapped charge dating.
Radiation Measurements 43, 14-25. <a href="https://doi.org/10.1016/j.radmeas.2007.12.012">doi:10.1016/j.radmeas.2007.12.012</a> <br></p>
<p><strong>Further reading</strong>
</p>
<p>Nathan, R.P., 2010. Numerical modelling of environmental dose rate and its application to trapped-charge dating.
DPhil thesis, St Hugh's College, Oxford. <a href="https://ora.ox.ac.uk/objects/ora:6421">https://ora.ox.ac.uk/objects/ora:6421</a>
</p>
<p>Zimmerman, D.W., 1971. Thermoluminescent dating using fine grains from pottery.
Archaeometry 13, 29–52.<a href="https://doi.org/10.1111/j.1475-4754.1971.tb00028.x">doi:10.1111/j.1475-4754.1971.tb00028.x</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##load example data
data("Example_Data", envir = environment())

##run the function for one sample from
##the dataset
model_DoseRate(
data = Example_Data[14,],
n.MC = 2,
txtProgressBar = FALSE
)


</code></pre>


</div>