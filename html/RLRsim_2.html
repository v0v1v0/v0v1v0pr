<div class="container">

<table style="width: 100%;"><tr>
<td>exactLRT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood Ratio Tests for simple linear mixed models</h2>

<h3>Description</h3>

<p>This function provides an exact likelihood ratio test based on simulated
values from the finite sample distribution for simultaneous testing of the
presence of the variance component and some restrictions of the fixed
effects in a simple linear mixed model with known correlation structure of
the random effect and i.i.d. errors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exactLRT(
  m,
  m0,
  seed = NA,
  nsim = 10000,
  log.grid.hi = 8,
  log.grid.lo = -10,
  gridlength = 200,
  parallel = c("no", "multicore", "snow"),
  ncpus = 1L,
  cl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The fitted model under the alternative; of class <code>lme</code>,
<code>lmerMod</code> or <code>spm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m0</code></td>
<td>
<p>The fitted model under the null hypothesis; of class <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Specify a seed for <code>set.seed</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of values to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.grid.hi</code></td>
<td>
<p>Lower value of the grid on the log scale. See
<code>exactLRT</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.grid.lo</code></td>
<td>
<p>Lower value of the grid on the log scale. See
<code>exactLRT</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridlength</code></td>
<td>
<p>Length of the grid. See <code>LRTSim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>The type of parallel operation to be used (if any). If
missing, the default is "no parallelization").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>
<p>integer: number of processes to be used in parallel operation:
typically one would chose this to the number of available CPUs. Defaults to
1, i.e., no parallelization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>An optional parallel or snow cluster for use if parallel = "snow".
If not supplied, a cluster on the local machine is created for the duration
of the call.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model under the alternative must be a linear mixed model
<code class="reqn">y=X\beta+Zb+\varepsilon</code> with a <em>single</em>
random effect <code class="reqn">b</code> with known correlation structure and error terms that
are i.i.d. The hypothesis to be tested must be of the form </p>
<p style="text-align: center;"><code class="reqn">H_0:
\beta_{p+1-q}=\beta^0_{p+1-q},\dots,\beta_{p}=\beta^0_{p};\quad </code>
</p>
<p style="text-align: center;"><code class="reqn">Var(b)=0</code>
</p>
<p> versus </p>
<p style="text-align: center;"><code class="reqn">H_A:\;
\beta_{p+1-q}\neq \beta^0_{p+1-q}\;\mbox{or}\dots </code>
</p>
<p style="text-align: center;"><code class="reqn">\mbox{or}\;\beta_{p}\neq
\beta^0_{p}\;\;\mbox{or}\;Var(b)&gt;0</code>
</p>
<p> We use the exact finite sample distribution of the
likelihood ratio test statistic as derived by Crainiceanu &amp; Ruppert (2004).
</p>


<h3>Value</h3>

<p>A list of class <code>htest</code> containing the following components:
</p>

<ul>
<li> <p><code>statistic</code> the observed likelihood ratio
</p>
</li>
<li> <p><code>p</code> p-value for the observed test statistic
</p>
</li>
<li> <p><code>method</code> a character string indicating what type of test was
performed and how many values were simulated to determine the critical value
</p>
</li>
<li> <p><code>sample</code> the samples from the null distribution returned by
<code>LRTSim</code>
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Fabian Scheipl, updates for <span class="pkg">lme4.0</span>-compatibility by Ben Bolker
</p>


<h3>References</h3>

<p>Crainiceanu, C. and Ruppert, D. (2004) Likelihood ratio tests in
linear mixed models with one variance component, <em>Journal of the Royal
Statistical Society: Series B</em>,<b>66</b>,165â€“185.
</p>


<h3>See Also</h3>

<p><code>LRTSim</code> for the underlying simulation algorithm;
<code>RLRTSim</code> and <code>exactRLRT</code> for restricted likelihood
based tests
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(nlme);
data(Orthodont);

##test for Sex:Age interaction and Subject-Intercept
mA&lt;-lme(distance ~ Sex * I(age - 11), random = ~ 1| Subject,
  data = Orthodont, method = "ML")
m0&lt;-lm(distance ~ Sex + I(age - 11), data = Orthodont)
summary(mA)
summary(m0)
exactLRT(m = mA, m0 = m0)

</code></pre>


</div>