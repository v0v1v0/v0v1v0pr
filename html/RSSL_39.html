<div class="container">

<table style="width: 100%;"><tr>
<td>ICLeastSquaresClassifier</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Implicitly Constrained Least Squares Classifier</h2>

<h3>Description</h3>

<p>Implementation of the Implicitly Constrained Least Squares Classifier (ICLS) of Krijthe &amp; Loog (2015) and the projected estimator of Krijthe &amp; Loog (2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ICLeastSquaresClassifier(X, y, X_u = NULL, lambda1 = 0, lambda2 = 0,
  intercept = TRUE, x_center = FALSE, scale = FALSE, method = "LBFGS",
  projection = "supervised", lambda_prior = 0, trueprob = NULL,
  eps = 1e-09, y_scale = FALSE, use_Xu_for_scaling = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix, intercept term is added within the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector or factor with class assignments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_u</code></td>
<td>
<p>Design matrix of the unlabeled data, intercept term is added within the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>Regularization parameter in the unlabeled+labeled data regularized least squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>Regularization parameter in the labeled data only regularized least squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>TRUE if an intercept should be added to the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_center</code></td>
<td>
<p>logical; Whether the feature vectors should be centered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical; If TRUE, apply a z-transform to all observations in X and X_u before running the regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either "LBFGS" for solving using L-BFGS-B gradient descent or "QP" for a quadratic programming based solution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projection</code></td>
<td>
<p>One of "supervised", "semisupervised" or "euclidean"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_prior</code></td>
<td>
<p>numeric; prior on the deviation from the supervised mean y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trueprob</code></td>
<td>
<p>numeric; true mean y for all data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>numeric; Stopping criterion for the maximinimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_scale</code></td>
<td>
<p>logical; whether the target vector should be centered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_Xu_for_scaling</code></td>
<td>
<p>logical; whether the unlabeled objects should be used to determine the mean and scaling for the normalization</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In Implicitly Constrained semi-supervised Least Squares (ICLS) of Krijthe &amp; Loog (2015), we minimize the quadratic loss on the labeled objects, while enforcing that the solution has to be a solution that minimizes the quadratic loss for all objects for some (fractional) labeling of the data (the implicit constraints). The goal of this classifier is to use the unlabeled data to update the classifier, while making sure it still works well on the labeled data.
</p>
<p>The Projected estimator of Krijthe &amp; Loog (2016) builds on this by finding a classifier within the space of classifiers that minimize the quadratic loss on all objects for some labeling (the implicit constrained), that minimizes the distance to the supervised solution for some appropriately chosen distance measure. Using the projection="semisupervised", we get certain guarantees that this solution is always better than the supervised solution (see Krijthe &amp; Loog (2016)), while setting projection="supervised" is equivalent to ICLS.
</p>
<p>Both methods (ICLS and the projection) can be formulated as a quadratic programming problem and solved using either a quadratic programming solver (method="QP") or using a gradient descent approach that takes into account certain bounds on the labelings (method="LBFGS"). The latter is the preferred method.
</p>


<h3>Value</h3>

<p>S4 object of class ICLeastSquaresClassifier with the following slots:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>weight vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classnames</code></td>
<td>
<p>the names of the classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelform</code></td>
<td>
<p>formula object of the model used in regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>a scaling object containing the parameters of the z-transforms applied to the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization</code></td>
<td>
<p>the object returned by the optim function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unlabels</code></td>
<td>
<p>the labels assigned to the unlabeled objects</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Krijthe, J.H. &amp; Loog, M., 2015. Implicitly Constrained Semi-Supervised Least Squares Classification. In E. Fromont, T. De Bie, &amp; M. van Leeuwen, eds. 14th International Symposium on Advances in Intelligent Data Analysis XIV (Lecture Notes in Computer Science Volume 9385). Saint Etienne. France, pp. 158-169.
</p>
<p>Krijthe, J.H. &amp; Loog, M., 2016. Projected Estimators for Robust Semi-supervised Classification. arXiv preprint arXiv:1602.07865.
</p>


<h3>See Also</h3>

<p>Other RSSL classifiers: 
<code>EMLeastSquaresClassifier</code>,
<code>EMLinearDiscriminantClassifier</code>,
<code>GRFClassifier</code>,
<code>ICLinearDiscriminantClassifier</code>,
<code>KernelLeastSquaresClassifier</code>,
<code>LaplacianKernelLeastSquaresClassifier()</code>,
<code>LaplacianSVM</code>,
<code>LeastSquaresClassifier</code>,
<code>LinearDiscriminantClassifier</code>,
<code>LinearSVM</code>,
<code>LinearTSVM()</code>,
<code>LogisticLossClassifier</code>,
<code>LogisticRegression</code>,
<code>MCLinearDiscriminantClassifier</code>,
<code>MCNearestMeanClassifier</code>,
<code>MCPLDA</code>,
<code>MajorityClassClassifier</code>,
<code>NearestMeanClassifier</code>,
<code>QuadraticDiscriminantClassifier</code>,
<code>S4VM</code>,
<code>SVM</code>,
<code>SelfLearning</code>,
<code>TSVM</code>,
<code>USMLeastSquaresClassifier</code>,
<code>WellSVM</code>,
<code>svmlin()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(testdata)
w1 &lt;- LeastSquaresClassifier(testdata$X, testdata$y, 
                             intercept = TRUE,x_center = FALSE, scale=FALSE)
w2 &lt;- ICLeastSquaresClassifier(testdata$X, testdata$y, 
                               testdata$X_u, intercept = TRUE, x_center = FALSE, scale=FALSE)
plot(testdata$X[,1],testdata$X[,2],col=factor(testdata$y),asp=1)
points(testdata$X_u[,1],testdata$X_u[,2],col="darkgrey",pch=16,cex=0.5)

abline(line_coefficients(w1)$intercept,
       line_coefficients(w1)$slope,lty=2)
abline(line_coefficients(w2)$intercept,
       line_coefficients(w2)$slope,lty=1)

</code></pre>


</div>