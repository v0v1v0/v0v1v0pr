<div class="container">

<table style="width: 100%;"><tr>
<td>optStiefel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimize a function on the Stiefel manifold</h2>

<h3>Description</h3>

<p>Find a local minimum of a function defined on the stiefel manifold using algorithms described in Wen and Yin (2013).
</p>


<h3>Usage</h3>

<pre><code class="language-R">optStiefel(F, dF, Vinit, method = "bb", searchParams = NULL, tol = 1e-08,
  maxIters = 100, verbose = FALSE, maxLineSearchIters = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>A function V(P, S) -&gt; <code>R^1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dF</code></td>
<td>
<p>A function to compute the gradient of F.  Returns a <code>P x S</code> matrix with <code>dF(X)_ij  = d(F(X))/dX_ij</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vinit</code></td>
<td>
<p>The starting point on the stiefel manifold for the optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Line search type: "bb" or curvilinear</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchParams</code></td>
<td>
<p>List of parameters for the line search algorithm.  If the line search algorithm is the standard curvilinear search than the search parameters are rho1 and rho2.  If the line search algorithm is "bb" then the parameters are rho and eta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Convergence tolerance.  Optimization stops when Fprime &lt; abs(tol), an approximate stationary point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIters</code></td>
<td>
<p>Maximum iterations for each gradient step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean indicating whether to print function value and iteration number at each step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLineSearchIters</code></td>
<td>
<p>Maximum iterations for for each line search (one step in the gradient descent algorithm)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A stationary point of F on the Stiefel manifold.
</p>


<h3>Author(s)</h3>

<p>Alexander Franks
</p>


<h3>References</h3>

<p>(Wen and Yin, 2013)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Find the first eigenspace spanned by the first P eigenvectors for a 
## matrix M. The size of the matrix has been kept small and the tolerance 
## has been raised to keep the runtime 
## of this example below the CRAN submission threshold. 

N &lt;- 500
P &lt;- 3
Lam &lt;- diag(c(10, 5, 3, rep(1, N-P)))
U &lt;- rustiefel(N, N)
M &lt;- U %*% Lam %*% t(U)

F &lt;- function(V) { - sum(diag(t(V) %*% M %*% V)) }
dF &lt;- function(V) { - 2*M %*% V }
V = optStiefel(F, dF, Vinit=rustiefel(N, P),
               method="curvilinear",
               searchParams=list(rho1=0.1, rho2=0.9, tau=1),tol=1e-4)
               
print(sprintf("Sum of first %d eigenvalues is %f", P, -F(V)))

</code></pre>


</div>