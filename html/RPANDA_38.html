<div class="container">

<table style="width: 100%;"><tr>
<td>fit_coal_cst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum likelihood fit of the equilibrium model
</h2>

<h3>Description</h3>

<p>Fits the equilibrium diversity model with potentially time-varying turnover rate and potentially missing extant species to a phylogeny, by maximum likelihood. 
The implementation allows only exponential time variation of the turnover rate, although this could be modified using expressions in Morlon et al. PloSB 2010. Notations follow Morlon et al. PLoSB 2010.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_coal_cst(phylo, tau0 = 1e-2, gamma = 1, cst.rate = FALSE,
             meth = "Nelder-Mead", N0 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>

<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau0</code></td>
<td>

<p>initial value of the turnover rate at present (used by the optimization algorithm)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>initial value of the parameter controlling the exponential variation in turnover rate (used by the optimization algorithm)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cst.rate</code></td>
<td>

<p>logical: should be set to TRUE to fit an equilibrium diversity model with time-constant turnover rate (know as the Hey model, model 1 in Morlon et al. PloSB 2010). By default, a model with expontential time-varying rate exponential is fitted (model 2 in Morlon et al. PloSB 2010).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>

<p>optimization to use to maximize the likelihood function, see <em>optim</em> for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N0</code></td>
<td>
<p>Number of extant species.
With default value(0), N0 is set to the number of tips in the phylogeny. That is, the phylogeny is assumed to be 100% complete. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits models 1 (when cst.rate=TRUE) and 2 (when cst.rate=FALSE) from the PloSB 2010 paper. Likelihoods arising from these models are directly comparable to likelihoods from the fit_coal_var function, thus allowing to test support for equilibrium versus expanding diversity scenarios. Time runs from the present to the past. Hence, if gamma is estimated to be positive (for example), this means that the speciation rate decreases from past to present.











</p>


<h3>Value</h3>

<p>a list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the name of the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LH</code></td>
<td>
<p>the maximum log-likelihood value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aicc</code></td>
<td>
<p>the second order Akaike's Information Criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau0</code></td>
<td>
<p>the estimated turnover rate at present</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>the estimated parameter controlling the exponential variation in turnover rate (if cst.rate is FALSE)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>H Morlon</p>


<h3>References</h3>

<p>Hey, J. (1992) Using phylogenetic trees to study speciation and extinction, Evolution, 46: 627-640
</p>
<p>Morlon, H., Potts, M.D., Plotkin, J.B. (2010) Inferring the dynamics of diversification: a coalescent approach, PLoS B, 8(9): e1000493
</p>
<p>Morlon, H., Kemps, B., Plotkin, J.B., Brisson, D. (2012) Explosive radiation of a bacterial species group, Evolution, 66: 2577-2586
</p>
<p>Morlon, H. (2014) Phylogenetic approaches for studying diversification, Eco Lett, 17:508-525
</p>


<h3>See Also</h3>

<p><code>likelihood_coal_cst</code>, <code>fit_coal_var</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Cetacea)


if(test){
result &lt;- fit_coal_cst(Cetacea, tau0=1.e-3, gamma=-1, cst.rate=FALSE, N0=89)
print(result)
}
</code></pre>


</div>