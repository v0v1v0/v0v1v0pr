<div class="container">

<table style="width: 100%;"><tr>
<td>calibrate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibrate radiocarbon dates</h2>

<h3>Description</h3>

<p>Function for calibrating radiocarbon dates or uncalibrated SPDs.
</p>
<p>Function for calibrating a SPD generated by summing uncalibrated dates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calibrate(x, ...)

## Default S3 method:
calibrate(
  x,
  errors,
  ids = NA,
  dateDetails = NA,
  calCurves = "intcal20",
  resOffsets = 0,
  resErrors = 0,
  timeRange = c(55000, 0),
  normalised = TRUE,
  F14C = FALSE,
  calMatrix = FALSE,
  eps = 1e-05,
  ncores = 1,
  verbose = TRUE,
  ...
)

## S3 method for class 'UncalGrid'
calibrate(
  x,
  errors = 0,
  calCurves = "intcal20",
  timeRange = c(55000, 0),
  eps = 1e-05,
  type = "fast",
  datenormalised = FALSE,
  spdnormalised = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of uncalibrated radiocarbon ages or a UncalGrid class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>A vector of standard deviations corresponding to each estimated radiocarbon age.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>An optional vector of IDs for each date.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dateDetails</code></td>
<td>
<p>An optional vector of details for each date which will be returned in the output metadata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calCurves</code></td>
<td>
<p>Either a character string naming a calibration curve already provided with the rcarbon package (currently 'intcal20','intcal13','intcal13nhpine16','shcal20','shcal13','shcal13shkauri16',‚Äùmarine13','marine20' and 'normal'(i.e. no calibration) are possible; default is 'intcal20') or a custom calibration curve as three-column matrix or data.frame (calibrated year BP, uncalibrated age bp, standard deviation). Different existing curves can be specified per dated sample, but only one custom curve can be provided for all dates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resOffsets</code></td>
<td>
<p>A vector of offset values for any marine reservoir effect (default is no offset).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resErrors</code></td>
<td>
<p>A vector of offset value errors for any marine reservoir effect (default is no offset).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeRange</code></td>
<td>
<p>Earliest and latest data to calibrate for, in calendar years. Posterior probabilities beyond this range will be excluded (the default is sensible in most cases).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalised</code></td>
<td>
<p>A logical variable indicating whether the calibration should be normalised or not. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F14C</code></td>
<td>
<p>A logical variable indicating whether calibration should be carried out in F14C space or not. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calMatrix</code></td>
<td>
<p>a logical variable indicating whether the age grid should be limited to probabilities higher than <code>eps</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Cut-off value for density calculation. Default is 1e-5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores/workers used for parallel execution. Default is 1 (&gt;1 requires doSnow package).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical variable indicating whether extra information on progress should be reported. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Currently, two options are available. With "fast", a look-up is conducted for each calendar year that picks up the amplitude of the nearest CRA age. With "full", each CRA is calibrated individually and then summed (much slower).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datenormalised</code></td>
<td>
<p>Controls for calibrated dates with probability mass outside the timerange of analysis. If set to TRUE the total probability mass within the time-span of analysis is normalised to sum to unity. Should be set to FALSE when the parameter <code>normalised</code> in <code>calibrate</code> is set to FALSE. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spdnormalised</code></td>
<td>
<p>A logical variable indicating whether the total probability mass of the SPD is normalised to sum to unity.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes one or more calibrated radiocarbon ages using the method described in Bronk Ramsey 2008 (see also  Parnell 2017). It is possible to specify different calibration curves or reservoir offsets individually for each date, and control whether the resulting calibrated distribution is normalised to 1 under-the-curve or not. Calculations can also be executed in parallel to reduce computing time. The function was modified from the <code>BchronCalibrate</code> function in the <code>Bchron</code> package developed by A.Parnell (see references below).
</p>


<h3>Value</h3>

<p>An object of class CalDates with the following elements:
</p>

<ul>
<li>
<p><code>metadata</code> A data.frame containing relevant information regarding each radiocarbon date and the parameter used in the calibration process.
</p>
</li>
<li>
<p><code>grids</code> A list of calGrid class objects, containing the posterior probabilities for each calendar year. The most memory-efficient way to store calibrated dates, as only years with non-zero probability are stored, but aggregation methods such as <code>spd()</code> may then take longer to extract and combine multiple dates. NA when the parameter calMatrix is set to TRUE. 
</p>
</li>
<li>
<p><code>calMatrix</code> A matrix of probability values, one row per calendar year in timeRange and one column per date. By storing all possible years, not just those with non-zero probability, this approach takes more memory, but speeds up spd() and is suggested whenever the latter is to be used. NA when the parameter calMatrix is set to FALSE.  
</p>
</li>
</ul>
<h3>References</h3>

<p>Bronk Ramsey, C. 2008. Radiocarbon dating: revolutions in understanding, <em>Archaeometry</em> 50.2: 249-75. DOI: https://doi.org/10.1111/j.1475-4754.2008.00394.x <br>
Parnell, A. 2017. Bchron: Radiocarbon Dating, Age-Depth Modelling, Relative Sea Level Rate Estimation, and Non-Parametric Phase Modelling, R package: https://CRAN.R-project.org/package=Bchron
</p>


<h3>Examples</h3>

<pre><code class="language-R">x1 &lt;- calibrate(x=4000, errors=30)
plot(x1)
summary(x1)
# Example with a Marine Date, using a DeltaR of 300 and a DeltaR error of 30
x2 &lt;- calibrate(x=4000, errors=30, calCurves='marine20', resOffsets=300, resErrors=30)
plot(x2)
</code></pre>


</div>