<div class="container">

<table style="width: 100%;"><tr>
<td>lf_old</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct an FLM regression term</h2>

<h3>Description</h3>

<p>Defines a term <code class="reqn">\int_{T}\beta(t)X_i(t)dt</code> for inclusion in an <code>[mgcv]{gam}</code>-formula
(or <code>bam</code> or <code>gamm</code> or <code>[gamm4]{gamm4}</code>) as constructed by
<code>fgam</code>, where <code class="reqn">\beta(t)</code> is an unknown coefficient function and <code class="reqn">X_i(t)</code>
is a functional predictor on the closed interval <code class="reqn">T</code>. Defaults to a cubic B-spline with
second-order difference penalties for estimating <code class="reqn">\beta(t)</code>.  The functional predictor must
be fully observed on a regular grid.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lf_old(
  X,
  argvals = seq(0, 1, l = ncol(X)),
  xind = NULL,
  integration = c("simpson", "trapezoidal", "riemann"),
  L = NULL,
  splinepars = list(bs = "ps", k = min(ceiling(n/4), 40), m = c(2, 2)),
  presmooth = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an <code>N</code> by <code>J=ncol(argvals)</code> matrix of function evaluations
<code class="reqn">X_i(t_{i1}),., X_i(t_{iJ}); i=1,.,N.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argvals</code></td>
<td>
<p>matrix (or vector) of indices of evaluations of <code class="reqn">X_i(t)</code>; i.e. a matrix with
<em>i</em>th row <code class="reqn">(t_{i1},.,t_{iJ})</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xind</code></td>
<td>
<p>same as argvals. It will not be supported in the next version of refund.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integration</code></td>
<td>
<p>method used for numerical integration. Defaults to <code>"simpson"</code>'s rule
for calculating entries in <code>L</code>. Alternatively and for non-equidistant grids,
“<code>trapezoidal</code>” or <code>"riemann"</code>. <code>"riemann"</code> integration is always used if
<code>L</code> is specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>an optional <code>N</code> by <code>ncol(argvals)</code> matrix giving the weights for the numerical
integration over <code>t</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splinepars</code></td>
<td>
<p>optional arguments specifying options for representing and penalizing the
functional coefficient <code class="reqn">\beta(t)</code>. Defaults to a cubic B-spline with second-order difference
penalties, i.e. <code>list(bs="ps", m=c(2, 1))</code> See <code>te</code> or <code>s</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>presmooth</code></td>
<td>
<p>logical; if true, the functional predictor is pre-smoothed prior to fitting.  See
<code>smooth.basisPar</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the following entries
</p>

<ol>
<li> <p><code>call</code> - a <code>call</code> to <code>te</code> (or <code>s</code>, <code>t2</code>) using the appropriately
constructed covariate and weight matrices
</p>
</li>
<li> <p><code>argvals</code> - the <code>argvals</code> argument supplied to <code>lf</code>
</p>
</li>
<li> <p><code>L</code> - the  matrix of weights used for the integration
</p>
</li>
<li>
<p>xindname - the name used for the functional predictor variable in the <code>formula</code>
used by <code>mgcv</code>
</p>
</li>
<li> <p><code>tindname</code> - the name used for <code>argvals</code> variable in the <code>formula</code> used by <code>mgcv</code>
</p>
</li>
<li> <p><code>LXname</code> - the name used for the <code>L</code> variable in the <code>formula</code> used by <code>mgcv</code>
</p>
</li>
<li> <p><code>presmooth</code> - the <code>presmooth</code> argument supplied to <code>lf</code>
</p>
</li>
<li> <p><code>Xfd</code> - an <code>fd</code> object from presmoothing the functional predictors using
<code>{smooth.basisPar}</code>.  Only present if <code>presmooth=TRUE</code>.  See <code>{fd}</code>
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Mathew W. McLean <a href="mailto:mathew.w.mclean@gmail.com">mathew.w.mclean@gmail.com</a> and Fabian Scheipl
</p>


<h3>See Also</h3>

<p><code>{fgam}</code>, <code>{af}</code>, mgcv's <code>{linear.functional.terms}</code>,
<code>{fgam}</code> for examples
</p>


</div>