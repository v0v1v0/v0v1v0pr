<div class="container">

<table style="width: 100%;"><tr>
<td>mn.regu.path</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model-assisted inference for population means along a regularization path</h2>

<h3>Description</h3>

<p>This function implements model-assisted inference for population means with missing data,
using regularized calibrated estimation along a regularization path for propensity score (PS) estimation 
while based on cross validation for outcome regression (OR).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mn.regu.path(fold, nrho = NULL, rho.seq = NULL, y, tr, x, ploss = "cal",
  yloss = "gaus", off = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fold</code></td>
<td>
<p>A vector of length 2, with the second component giving the fold number for cross validation in outcome regression. The first component is not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrho</code></td>
<td>
<p>A vector of length 2 giving the number of tuning parameters in a regularization path for PS estimation and that in cross validation for OR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.seq</code></td>
<td>
<p>A list of two vectors giving the tuning parameters for propensity score estimation (first vector) and outcome regression (second vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes with missing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of non-missing indicators (=1 if <code>y</code> is observed or 0 if <code>y</code> is missing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">p</code> matix of covariates, used in both propensity score and outcome regression models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploss</code></td>
<td>
<p>A loss function used in propensity score estimation (either "ml" or "cal").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yloss</code></td>
<td>
<p>A loss function used in outcome regression (either "gaus" for continuous outcomes or "ml" for binary outcomes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>off</code></td>
<td>
<p>An offset value (e.g., the true value in simulations) used to calculate the z-statistic from augmented IPW estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to <code>glm.regu.cv</code> and <code>glm.regu.path</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <strong>Details</strong> for <code>mn.regu.cv</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ps</code></td>
<td>
<p>A list containing the results from fitting the propensity score model by <code>glm.regu.path</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fp</code></td>
<td>
<p>The matrix of fitted propensity scores, column by column, along the PS regularization path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>or</code></td>
<td>
<p>A list of objects, each giving the results from fitting the outcome regression model by <code>glm.regu.cv</code> for a PS tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fo</code></td>
<td>
<p>The matrix of fitted values from outcome regression based on cross validation, column by column, along the PS regularization path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>A list containing the results from augmented IPW estimation by <code>mn.aipw</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A vector of tuning parameters leading to converged results in propensity score estimation.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Tan, Z. (2020a) Regularized calibrated estimation of propensity scores with model misspecification and high-dimensional data, <em>Biometrika</em>, 107, 137–158.
</p>
<p>Tan, Z. (2020b) Model-assisted inference for treatment effects using regularized calibrated estimation with high-dimensional data, <em>Annals of Statistics</em>, 48, 811–837.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(simu.data)
n &lt;- dim(simu.data)[1]
p &lt;- dim(simu.data)[2]-2

y &lt;- simu.data[,1]
tr &lt;- simu.data[,2]
x &lt;- simu.data[,2+1:p]
x &lt;- scale(x)

# missing data
y[tr==0] &lt;- NA

mn.path.rcal &lt;- mn.regu.path(fold=5*c(0,1), nrho=(1+10)*c(1,1), y=y, tr=tr, x=x, 
                             ploss="cal", yloss="gaus")
mn.path.rcal$est


</code></pre>


</div>