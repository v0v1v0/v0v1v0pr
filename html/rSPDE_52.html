<div class="container">

<table style="width: 100%;"><tr>
<td>rspde.make.A</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Observation/prediction matrices for rSPDE models.</h2>

<h3>Description</h3>

<p>Constructs observation/prediction weight matrices
for rSPDE models based on <code>inla.mesh</code> or
<code>inla.mesh.1d</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rspde.make.A(
  mesh = NULL,
  loc = NULL,
  A = NULL,
  dim = NULL,
  rspde.order = 2,
  nu = NULL,
  index = NULL,
  group = NULL,
  repl = 1L,
  n.group = NULL,
  n.repl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mesh</code></td>
<td>
<p>An <code>inla.mesh</code>,
an <code>inla.mesh.1d</code> object or a <code>metric_graph</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>Locations, needed if an INLA mesh is provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>The A matrix from the standard SPDE approach, such as the matrix
returned by <code>inla.spde.make.A</code>. Should only be provided if
<code>mesh</code> is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>the dimension. Should only be provided if an
<code>mesh</code> is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rspde.order</code></td>
<td>
<p>The order of the covariance-based rational SPDE approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>If <code>NULL</code>, then the model will assume that nu will
be estimated. If nu is fixed, you should provide the value of nu.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>For each observation/prediction value, an index into loc. Default is seq_len(nrow(A.loc)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>For each observation/prediction value, an index into
the group model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repl</code></td>
<td>
<p>For each observation/prediction value, the replicate index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.group</code></td>
<td>
<p>The size of the group model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.repl</code></td>
<td>
<p>The total number of replicates.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code class="reqn">A</code> matrix for rSPDE models.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> #tryCatch version
tryCatch({
if (requireNamespace("INLA", quietly = TRUE)){
library(INLA)

set.seed(123)
loc &lt;- matrix(runif(100 * 2) * 100, 100, 2)
mesh &lt;- inla.mesh.2d(
  loc = loc,
  cutoff = 50,
  max.edge = c(50, 500)
)
A &lt;- rspde.make.A(mesh, loc = loc, rspde.order = 3)
}
#stable.tryCatch
}, error = function(e){print("Could not run the example")})

</code></pre>


</div>