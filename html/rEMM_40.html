<div class="container">

<table style="width: 100%;"><tr>
<td>EMMsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Synthetic Data to Demonstrate EMMs</h2>

<h3>Description</h3>

<p>A simulated data set with four clusters in <code class="reqn">R^2</code>. Each cluster is
represented by a bivariate normally distributed random variable.

<code class="reqn">\mu</code> are the coordinates of the means of the
distributions and <code class="reqn">\Sigma</code> contains the covariance matrices.
Two data stream are created using a fixed sequence <code class="reqn">&lt;1,2,1,3,4&gt;</code>
through
the four clusters. For the training data, the sequence is repeated 40 times
(200 data points) and for the test data five times (25 data points).
</p>
<p>The code to generate the data is shown in the Examples section below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data(EMMsim)</code></pre>


<h3>Format</h3>

<p><code>EMMsim_train</code> and <code>EMMsim_test</code> are matrices containing the
data.
</p>
<p><code>EMMsim_sequence_train</code> and <code>EMMsim_sequence_test</code>
contain the sequence of the data through the four clusters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(EMMsim)
plot(EMMsim_train)
points(EMMsim_test, col = "red")

## the data was generated by
## Not run: 
set.seed(1234)

## simulated data
mu &lt;- cbind(x = c(0, 0.2, 1, 0.9),
  y = c(0, 0.7, 1, 0.2))

sd_rho &lt;- cbind(
  x = c(0.2, 0.15, 0.05, 0.02),
  y = c(0.1, 0.04, 0.03, 0.05),
  rho = c(0, 0.7, 0.3,-0.4)
)

Sigma &lt;- lapply(
  1:nrow(sd_rho),
  FUN = function(i)
    rbind(
      c(sd_rho[i, "x"] ^ 2, sd_rho[i, "rho"] * sd_rho[i, "x"] * sd_rho[i, "y"]),
      c(sd_rho[i, "rho"] * sd_rho[i, "x"] * sd_rho[i, "y"], sd_rho[i, "y"] ^
          2)
    )
)

sequence &lt;- c(1, 2, 1, 3, 4)

EMMsim_sequence_train &lt;- rep(sequence, 40)
EMMsim_sequence_test &lt;- rep(sequence, 5)

library("MASS")
EMMsim_train &lt;- t(sapply(
  EMMsim_sequence_train,
  FUN = function(i)
    mvrnorm(1, mu = mu[i, ], Sigma = Sigma[[i]])
))

EMMsim_test &lt;- t(sapply(
  rep(EMMsim_sequence_test),
  FUN = function(i)
    mvrnorm(1, mu = mu[i, ], Sigma = Sigma[[i]])
))

## End(Not run)
</code></pre>


</div>