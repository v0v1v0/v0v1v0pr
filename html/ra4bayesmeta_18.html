<div class="container">

<table style="width: 100%;"><tr>
<td>plot_RA_fits</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Reference analysis plot based on bayesmeta fits:
Plot heterogeneity benchmark priors and the
corresponding marginal posteriors

</h2>

<h3>Description</h3>

<p>Plots the benchmark heterogeneity priors inducing the specified model fits <code>fits.bm</code>
and the corresponding marginal benchmark posteriors for different parameters in the
NNHM.
Also displays the actual heterogeneity priors inducing the specified actual model fits <code>fits.actual</code>
and the corresponding marginal posteriors.
All bayesmeta fits should be based on the same data set.

</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_RA_fits(fits.actual, fits.bm, type="pri.tau", xlim, ylim,
             legend=FALSE, pos.legend="topright",
             legend.tau.prior=c(), bty="o",
             col.actual=c("red","lightpink3","darkgreen","green",
                          "violetred")[1:length(fits.actual)],
             col.bm=c("cyan","black","blue","darkgray",
                      "dodgerblue")[1:length(fits.bm)],
             lty.actual=rep(2, times=length(col.actual)),
             lty.bm=rep(1, times=length(col.bm)),
             lwd.actual=rep(2, times=length(col.actual)),
             lwd.bm=rep(2, times=length(col.bm)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fits.actual</code></td>
<td>

<p>a list of model fits (max. 5 fits) of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fits.bm</code></td>
<td>

<p>a list of model fits (max. 5 fits) of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
To be used as benchmarks.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>specifies if heterogeneity priors or marginal posterior densities for
a given parameter should be plotted.
Options are <code>"pri.tau"</code> for heterogeneity priors, <code>"post.mu"</code> for the marg. posterior of the main effect mu, <code>"post.tau"</code> for the marg. posterior of the heterogeneity tau and
<code>"post.theta.new"</code> for the marg. posterior of the predicted effect theta_new in a new study.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>a vector of two real numbers. Limits of the x-axis. (First number &gt;= 0 for densities for tau.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>a vector of two real non-negative numbers. Limits of the y-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>

<p>logical. Specifies if a legend should be added to the plot. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.legend</code></td>
<td>

<p>a character string specifing the position of the legend in the plot.
Options are all the keywords accepted by
the <code>legend</code> function in the graphics package, i.e.
<code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and <code>"center"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.tau.prior</code></td>
<td>

<p>a vector of character strings or expressions with one
entry for each fit in <code>fits.actual</code> and <code>fits.bm</code>
(i.e. a vector of length length(<code>fits.actual</code>)+length(<code>fits.bm</code>)).
Determines the legend entries corresponding to
the actual und benchmark fits specified,
in the same order as in the list c(<code>fits.actual</code>, <code>fits.bm</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bty</code></td>
<td>

<p>the type of box to be drawn around the legend. The allowed values are "o" (the default) and "n".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.actual</code></td>
<td>

<p>vector of color specifications for the lines representing the actual fits in
<code>fits.actual</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.actual)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.bm</code></td>
<td>

<p>vector of color specifications for the lines representing the benchmark fits in
<code>fits.bm</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.bm)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.actual</code></td>
<td>

<p>vector of line type specifications for the lines representing the actual fits in
<code>fits.actual</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.actual)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.bm</code></td>
<td>

<p>vector of line type specifications for the lines representing the benchmark fits in
<code>fits.bm</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.bm)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.actual</code></td>
<td>

<p>numeric vector specifying the width of the lines representing the actual fits in
<code>fits.actual</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.actual)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.bm</code></td>
<td>

<p>numeric vector specifying the width of the lines representing the benchmark fits in
<code>fits.bm</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.bm)</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two alternative suggestions for posterior benchmarks are provided
in Ott et al. (2021, Section 3.4) and its Supplementary Material (Section 2.5) and they
can be computed using the functions <code>fit_models_RA</code> and <code>fit_models_RA_5bm</code>,
respectively.
</p>


<h3>Value</h3>

<p>No return value, produces graphical output only.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505â€“4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code>bayesmeta</code> in the package bayesmeta,
<code>fit_models_RA</code>, <code>plot_RA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># for aurigular acupuncture (AA) data set with two
# actual half-normal and half-Cauchy heterogeneity priors
data(aa)
  
# compute the model fits
fits &lt;- fit_models_RA(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                            function(t)dhalfcauchy(t, scale=1)))
# plot the HN0 benchmark prior (do not show the improper J benchmark)
fits.bm.pri &lt;- fits[1]
# benchmark fits under HN0 and J priors
fits.bm.post &lt;- fits[1:2]
fits.actual &lt;- fits[3:4]

# prior densities
plot_RA_fits(fits.actual=fits.actual, fits.bm=fits.bm.pri,
             type="pri.tau", xlim=c(0, 2), ylim=c(0, 3),
             legend=TRUE,
             legend.tau.prior=c("HN(1)", "HC(1)", "HN0"))

# marginal posterior for the effect mu
plot_RA_fits(fits.actual=fits.actual, fits.bm=fits.bm.post,
             type="post.mu", xlim=c(-1.5, 1.5), ylim=c(0, 3),
             legend=TRUE,
             legend.tau.prior=c("HN(1)", "HC(1)",
             "HN0", "J"))
             
</code></pre>


</div>