<div class="container">

<table style="width: 100%;"><tr>
<td>gsi_em_1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM algorithm from the simplest GSI model for pi and the individual posterior probabilities</h2>

<h3>Description</h3>

<p>Using a matrix of scaled likelihoods, this function does an EM algorithm to climb the
likelihood surface for pi, and computes the plug-in estimate of the posteriors
for all the individuals.  It returns the output in a list.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsi_em_1(SL, Pi_init, max_iterations, tolerance, return_progression)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SL</code></td>
<td>
<p>a matrix of the scaled likelihoods.  This is should have values for each individual in a column
(going down in the rows are values for different collections).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi_init</code></td>
<td>
<p>Starting value for the pi (collection mixture proportion) vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iterations</code></td>
<td>
<p>the maximum total number of reps iterations to do.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>the EM-algorithm will be considered converged when the sum over the elements of pi of the absolute value
of the difference between the previous and the current estimate is less than tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_progression</code></td>
<td>
<p>If true, then the pi_trace component of the output shows the value of pi visited en route to the end.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>gsi_em_1</code> returns a final Maximum-Likelihood estimate for pi and PofZ,
as well as the number of iterations needed to reach convergence ("iterations_performed"),
and traces of the pi values and change in pi in each iteration
</p>


<h3>Examples</h3>

<pre><code class="language-R"># this is shown with a scaled likelihood matrix from self-assignment
# of the reference individuals

# we have to get the ploidies to pass to tcf2param_list
locnames &lt;- names(alewife)[-(1:16)][c(TRUE, FALSE)]
ploidies &lt;- rep(2, length(locnames))
names(ploidies) &lt;- locnames
params &lt;- tcf2param_list(alewife, 17, ploidies = ploidies)
logl &lt;- geno_logL(params)
SL &lt;- apply(exp(logl), 2, function(x) x/sum(x))
test_em &lt;- gsi_em_1(SL,
                    rep(1/params$C, params$C),
                    max_iterations = 10^6,
                    tolerance = 10^-7,
                    return_progression = TRUE)
</code></pre>


</div>