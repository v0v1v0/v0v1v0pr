<div class="container">

<table style="width: 100%;"><tr>
<td>logistic.like</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>logistic.like - Logistic distance function likelihood</h2>

<h3>Description</h3>

<p>Computes a two parameter logistic distance function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logistic.like(
  a,
  dist,
  covars = NULL,
  w.lo = units::set_units(0, "m"),
  w.hi = max(dist),
  series = "cosine",
  expansions = 0,
  scale = TRUE,
  pointSurvey = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A vector of likelihood parameter values. Length and meaning 
depend on whether covariates and <code>expansions</code> are present as follows:
</p>

<ul>
<li>
<p> If no covariates and no expansions: <code>a</code> = [a, b] (see Details)
</p>
</li>
<li>
<p> If no covariates and <em>k</em> expansions: <code>a</code> = [a, b, e1, ..., e<em>k</em>] 
</p>
</li>
<li>
<p> If <em>p</em> covariates and no expansions: <code>a</code> = [a, b, b1, ..., b<em>p</em>] 
</p>
</li>
<li>
<p> If <em>p</em> covariates and <em>k</em> expansions: <code>a</code> = [a, b, b1, ..., b<em>p</em>, e1, ..., e<em>k</em>] 
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A numeric vector containing observed distances with measurement
units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>Data frame containing values of covariates at 
each observation in <code>dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.lo</code></td>
<td>
<p>Scalar value of the lowest observable distance, with measurement
units.  
This is the <em>left truncation</em> sighting distance.  Values less than 
<code>w.lo</code> are allowed in <code>dist</code>, but are ignored and 
their likelihood value is set to
<code>NA</code> in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.hi</code></td>
<td>
<p>Scalar value of the largest observable distance, with measurement
units.  
This is the <em>right truncation</em> sighting distance.
Values greater than <code>w.hi</code> are allowed in <code>dist</code>, 
but are ignored and their likelihood value is 
set to <code>NA</code> in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>A string specifying the type of expansion to 
use.  Currently, valid values are 'simple', 'hermite', and 
'cosine'; but, see <code>dfuncEstim</code> about 
defining other series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expansions</code></td>
<td>
<p>A scalar specifying the number of terms 
in <code>series</code>. Depending on the series, this could be 0 through 5.
The default of 0 equates to no expansion terms of any type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical scalar indicating whether or not to scale 
the likelihood into a density function, i.e., so that it integrates 
to 1. This parameter is used 
to stop recursion in other functions.
If <code>scale</code> equals TRUE, a numerical integration 
routine (<code>integration.constant</code>) is called, which 
in turn calls this likelihood function again
with <code>scale</code> = FALSE. Thus, this routine knows when its 
values are being used to compute the likelihood and when its 
values are being used to compute the constant of integration.  
All user defined likelihoods must have and use this parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointSurvey</code></td>
<td>
<p>Boolean. TRUE if <code>dist</code> is point 
transect data, FALSE if line transect data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The 'logistic' likelihood contains two 
parameters.  Parameter <code class="reqn">a</code> determines the scale and is 
labeled 'threshold' in Rdistance.  Parameter <code class="reqn">b</code> determines 
sharpness (slope) of the likelihood's decrease at <code class="reqn">a</code> and is labeled
'knee' in Rdistance.  
This function is sometimes called the 
<em>heavy side</em> function (e.g., engineering).  The technical form 
of the function is, 
</p>
<p style="text-align: center;"><code class="reqn">f(x|a,b) = 1 - \frac{1}{1 + \exp(-b(x-a))} = 
\frac{\exp( -b(x-a) )}{1 + exp( -b(x-a) )},</code>
</p>
 
<p>Parameter <code class="reqn">a</code> is the location (distance) of 
0.5. That is, the inverse likelihood of 0.5 
is <code class="reqn">a</code> before scaling 
(i.e., <code>logistic.like( c(a,b), a, scale=FALSE)</code> equals 
<code>0.5</code>). 
</p>
<p>Parameter <code class="reqn">b</code> is slope of function 
at <code class="reqn">a</code>.  
Prior to scaling, 
slope of the likelihood at <code class="reqn">a</code> is <code class="reqn">-b/4</code>. 
If <code class="reqn">b</code>
is large, the "knee" is sharp and the likelihood can look 
uniform with support from 
<code>w.lo</code> to <code class="reqn">a/f(0)</code>.  If <code class="reqn">b</code> is small, the 
"knee" is shallow and the density of observations declines 
in an elongated "S" shape pivoting at <code class="reqn">a/f(0)</code>.  
As <code class="reqn">b</code> grows large and assuming f(0) = 1, the effective 
strip width approaches <code class="reqn">a</code>.  
</p>
<p>See plots in Examples.
</p>


<h3>Value</h3>

<p>A numeric vector the same length and order as <code>dist</code> 
containing the likelihood contribution for corresponding distances 
in <code>dist</code>. 
Assuming <code>L</code> is the returned vector, 
the log likelihood of all data is <code>-sum(log(L), na.rm=T)</code>. 
Note that the returned likelihood value for distances less than 
<code>w.lo</code> or greater than <code>w.hi</code> is <code>NA</code>, and thus it is 
essential to use <code>na.rm=TRUE</code> in the sum. If <code>scale</code> = TRUE, 
the integral of the likelihood from <code>w.lo</code> to <code>w.hi</code> is 1.0. 
If <code>scale</code> = FALSE, the integral of the likelihood is
arbitrary.
</p>


<h3>Expansion Terms</h3>

<p>If <code>expansions</code> = k (k &gt; 0), the 
expansion function specified by <code>series</code> is called (see for example
<code>cosine.expansion</code>). Assuming 
<code class="reqn">h_{ij}(x)</code> is the <code class="reqn">j^{th}</code> expansion term 
for the <code class="reqn">i^{th}</code> distance and that 
<code class="reqn">c_1, c_2, \dots, c_k</code> are (estimated) 
coefficients, the likelihood contribution 
for the <code class="reqn">i^{th}</code> distance is, 
</p>
<p style="text-align: center;"><code class="reqn">f(x|a,b,c_1,c_2,\dots,c_k) = f(x|a,b)(1 + 
\sum_{j=1}^{k} c_j h_{ij}(x)).</code>
</p>



<h3>See Also</h3>

<p><code>dfuncEstim</code>,
<code>halfnorm.like</code>,
<code>hazrate.like</code>,
<code>negexp.like</code>,
<code>Gamma.like</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- units::set_units(seq(0, 100, length=100), "m")

# Plots showing effects of changes in Threshold
plot(x, logistic.like(c(20, 20), x), type="l", col="red")
lines(x, logistic.like(c(40, 20), x), type="l", col="blue")

# Plots showing effects of changes in Knee
plot(x, logistic.like(c(50, 100), x), type="l", col="red")
lines(x, logistic.like(c(50, 1), x), type="l", col="blue")
lines(x, logistic.like(c(50, .1), x), type="l", col="orange")

         
</code></pre>


</div>