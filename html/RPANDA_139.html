<div class="container">

<table style="width: 100%;"><tr>
<td>sim.BipartiteEvol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of the BipartiteEvol model</h2>

<h3>Description</h3>

<p>Simulateof the BipartiteEvol model from Maliet et al. (2020)
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.BipartiteEvol(nx, ny = nx, NG, dSpace = Inf, D = 1, muP,
muH, alphaP = 0, alphaH = 0, iniP = 0, iniH = 0, nP = 1, nH = 1, 
rP = 1, rH = 1, effect = 1, verbose = 100, thin = 1, P = NULL, H = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>

<p>Size of the grid (the grid has size nx * ny)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>

<p>Size of the grid (default to nx, the grid has size nx * ny)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NG</code></td>
<td>

<p>Number of time step the model is run
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dSpace</code></td>
<td>

<p>Size of the dispersal kernel (default to Inf, meaning there are no restrictions on dispersion)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>

<p>Dimention of the trait space (default to 3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muP</code></td>
<td>

<p>Mutation probability at reproduction for the individuals of clade P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muH</code></td>
<td>

<p>Mutation probability at reproduction for the individuals of clade H</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaP</code></td>
<td>

<p>alpha parameter for clade P (1/alpha is the niche width)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaH</code></td>
<td>

<p>alpha parameter for clade H (1/alpha is the niche width)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniP</code></td>
<td>

<p>Initial trait value for the individuals in clade P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniH</code></td>
<td>

<p>Initial trait value for the individuals in clade P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nP</code></td>
<td>

<p>Number of individuals of clade P killed at each time step
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nH</code></td>
<td>

<p>Number of individuals of clade H killed at each time step
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rP</code></td>
<td>

<p>r parameter for clade P (r is the ratio between the fitness maximum and minimum)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rH</code></td>
<td>

<p>r parameter for clade H (r is the ratio between the fitness maximum and minimum)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>

<p>Standard deviation of the trait mutation kernel
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>The simulation </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>

<p>The number of iterations between two recording of the state of the model (default to 1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>

<p>Optionnal, used to continue one precedent run: traits of the individuals of clade P at the end of the precedent run
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>

<p>Optionnal, used to continue one precedent run: traits of the individuals of clade H at the end of the precedent run
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Pgenealogy</code></td>
<td>
<p>The genalogy of clade P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hgenealogy</code></td>
<td>
<p>The genalogy of clade H</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xP</code></td>
<td>
<p>The trait values at each time step for clade P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xH</code></td>
<td>
<p>The trait values at each time step for cladeH</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>The trait values at present for clade P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>The trait values at present for clade P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pmut</code></td>
<td>
<p>The number of new mutations at each time step for clade P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hmut</code></td>
<td>
<p>The number of new mutations at each time step for clade H</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniP</code></td>
<td>
<p>The initial trait values for the individuals of clade P used in the simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniH</code></td>
<td>
<p>The initial trait values for the individuals of clade H used in the simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin.factor</code></td>
<td>
<p>The thin value used in the simulation</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>O. Maliet
</p>


<h3>References</h3>

<p>Maliet, O., Loeuille, N. and Morlon, H. (2020), An individual-based model for the eco-evolutionary emergence of bipartite interaction networks. Ecol Lett. doi:10.1111/ele.13592</p>


<h3>Examples</h3>

<pre><code class="language-R"># run the model
set.seed(1)


if(test){
mod = sim.BipartiteEvol(nx = 8,ny = 4,NG = 500,
                        D = 3, muP = 0.1 , muH = 0.1,
                        alphaP = 0.12,alphaH = 0.12,
                        rP = 10, rH = 10,
                        verbose = 100, thin = 5)

#build the genealogies
gen = make_gen.BipartiteEvol(mod)
plot(gen$H)

#compute the phylogenies
phy1 = define_species.BipartiteEvol(gen,threshold=1)

#plot the result
plot_div.BipartiteEvol(gen,phy1, 1)

#build the network
net = build_network.BipartiteEvol(gen, phy1)

trait.id = 1
plot_net.BipartiteEvol(gen,phy1,trait.id, net,mod, nx = 10, spatial = FALSE)


## add time steps to a former run
seed=as.integer(10)
set.seed(seed)

mod = sim.BipartiteEvol(nx = 8,ny = 4,NG = 500,
                        D = 3, muP = 0.1 , muH = 0.1,
                        alphaP = 0.12,alphaH = 0.12,
                        rP = 10, rH = 10,
                        verbose = 100, thin = 5,
                        P=mod$P,H=mod$H)  # former ru output

# update the genealogy
gen = make_gen.BipartiteEvol(mod,
                             treeP=gen$P, treeH=gen$H)

# update the phylogenies...
phy1 = define_species.BipartiteEvol(gen,threshold=1)

#... and the network
net = build_network.BipartiteEvol(gen, phy1)

trait.id = 1
plot_net.BipartiteEvol(gen,phy1,trait.id, net,mod, nx = 10, spatial = FALSE)
 }
 </code></pre>


</div>