<div class="container">

<table style="width: 100%;"><tr>
<td>var.components</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance components estimation</h2>

<h3>Description</h3>

<p>Computes estimated effects, standard errors and process variance for a set
of estimates
</p>


<h3>Usage</h3>

<pre><code class="language-R">var.components(
  theta,
  design,
  vcv,
  alpha = 0.05,
  upper = 10 * max(vcv),
  LAPACK = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>vector of parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>design matrix for combining parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcv</code></td>
<td>
<p>estimated variance-covariance matrix for parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>sets 1-alpha confidence limit on sigma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>upper limit for process variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAPACK</code></td>
<td>
<p>argument passed to call to <code>qr</code> for qr decomposition and
inversion</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes estimated effects, standard errors and process variance for a set
of estimates using the method of moments estimator described by Burnham and
White (2002). The <code>design</code> matrix specifies the manner in which the
estimates (<code>theta</code>) are combined.  The number of rows of the design
matrix must match the length of <code>theta</code>. 
</p>
<p>If you select specific values
of theta, you must select the equivalent sub-matrix of the variance-covariance
matrix.  For instance, if the parameter indices are <code>$estimates[c(1:5,8)]</code>
then the appropriate definition of the vcv matrix would be vcv=vcv[c(1:5,8), c(1:5,8)], if
vcv is nxn for n estimates. Note that get.real will only return the vcv matrix of the unique 
reals so the dimensions of estimates and vcv will not always match as in the example below
where estimates has 21 rows but with the time model there are only 6 unique Phis so vcv is 6x6.
</p>
<p>To get a mean estimate use a column matrix of 1's (e.g.,
<code>design=matrix(1,ncol=1,nrow=length(theta))</code>. The function returns a
list with the estimates of the coefficients for the design matrix
(<code>beta</code>) with one value per column in the design matrix and the
variance-covariance matrix (<code>vcv.beta</code>) for the <code>beta</code> estimates.
The process variance is returned as <code>sigma</code>.
</p>


<h3>Value</h3>

<p>A list with the following elements </p>
<table>
<tr style="vertical-align: top;">
<td><code>sigmasq</code></td>
<td>
<p>process variance
estimate and confidence interval; estimate may be &lt;0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>sqrt of process variance; set to o if sigmasq&lt;0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>dataframe with estimates and standard errors of betas
for design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betarand</code></td>
<td>
<p>dataframe of shrinkage estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcv.beta</code></td>
<td>
<p>variance-covariance matrix for beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GTrace</code></td>
<td>
<p>trace of matrix G</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jeff Laake; Ben Augustine
</p>


<h3>References</h3>

<p>BURNHAM, K. P. and G. C. WHITE. 2002. Evaluation of some random
effects methodology applicable to bird ringing data.  Journal of Applied
Statistics 29: 245-264.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# This example is excluded from testing to reduce package check time
data(dipper)
md=mark(dipper,model.parameters=list(Phi=list(formula=~time)),delete=TRUE)
md$results$AICc
zz=get.real(md,"Phi",vcv=TRUE)
z=zz$estimates$estimate[1:6]
vcv=zz$vcv.real
varc=var.components(z,design=matrix(rep(1,length(z)),ncol=1),vcv) 
df=md$design.data$Phi
shrinkest=data.frame(time=1:6,value=varc$betarand$estimate)
df=merge(df,shrinkest,by="time")
md=mark(dipper,model.parameters=list(Phi=list(formula=~time,
  fixed=list(index=df$par.index,value=df$value))),adjust=FALSE,delete=TRUE)
npar=md$results$npar+varc$GTrace
md$results$lnl+2*(npar + (npar*(npar+1))/(md$results$n-npar-1))

</code></pre>


</div>