<div class="container">

<table style="width: 100%;"><tr>
<td>phyl.pca_pl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Regularized Phylogenetic Principal Component Analysis (PCA).
</h2>

<h3>Description</h3>

<p>Performs a principal component analysis (PCA) on a regularized evolutionary variance-covariance matrix obtained using the <code>fit_t_pl</code> function.</p>


<h3>Usage</h3>

<pre><code class="language-R">
phyl.pca_pl(object, plot=TRUE, ...)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A penalized likelihood model fit obtained by the <code>fit_t_pl</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Plot of the PC's axes. Default is TRUE (see details).'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Options to be passed through. (e.g., axes=c(1,2), col, pch, cex, mode="cov" or "corr", etc.)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>phyl.pca_pl</code> allows computing a phylogenetic principal component analysis (following Revell 2009) using a regularized evolutionary variance-covariance matrix from penalized likelihood models fit to high-dimensional datasets (where the number of variables p is potentially larger than n; see details for the models options in <code>fit_t_pl</code>). Models estimates are more accurate than maximum likelihood methods, particularly in the high-dimensional case.
Ploting options, the number of axes to display (<code>axes=c(1,2)</code> is the default), and whether the covariance (<code>mode="cov"</code>) or correlation (<code>mode="corr"</code>) should be used can be specified through the ellipsis "..." argument.
</p>


<h3>Value</h3>

<p>a list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>the eigenvalues of the evolutionary variance-covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>the PC scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>the component loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes_scores</code></td>
<td>
<p>the scores for the ancestral states at the nodes (projected on the space of the tips)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the mean/ancestral value used to center the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vectors</code></td>
<td>
<p>the eigenvectors of the evolutionary variance-covariance matrix</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Contrary to conventional PCA, the principal axes of the phylogenetic PCA are not orthogonal, they represent the main axes of (independent) evolutionary changes.</p>


<h3>Author(s)</h3>

<p>J. Clavel</p>


<h3>References</h3>

<p>Revell, L.J., 2009. Size-correction and principal components for intraspecific comparative studies. Evolution, 63:3258-3268.
</p>
<p>Clavel, J., Aristide, L., Morlon, H., 2019. A Penalized Likelihood framework for high-dimensional phylogenetic comparative methods and an application to new-world monkeys brain evolution. Syst. Biol. 68: 93-116.
</p>


<h3>See Also</h3>

<p><code>fit_t_pl</code>,
<code>ancestral</code>,
<code>GIC.fit_pl.rpanda</code>, 
<code>gic_criterion</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

if(test){
if(require(mvMORPH)){
set.seed(1)
n &lt;- 32 # number of species
p &lt;- 31 # number of traits

tree &lt;- pbtree(n=n) # phylogenetic tree
R &lt;- Posdef(p)      # a random symmetric matrix (covariance)

# simulate a dataset
Y &lt;- mvSIM(tree, model="BM1", nsim=1, param=list(sigma=R))

# fit a multivariate Pagel lambda model with Penalized likelihood
fit &lt;- fit_t_pl(Y, tree, model="lambda", method="RidgeAlt")

# Perform a phylogenetic PCA using the model fit (Pagel lambda model)
pca_results &lt;- phyl.pca_pl(fit, plot=TRUE) 

# retrieve the scores
head(pca_results$scores)
}
}

</code></pre>


</div>