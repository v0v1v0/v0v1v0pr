<div class="container">

<table style="width: 100%;"><tr>
<td>pcaCoDa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust principal component analysis for compositional data</h2>

<h3>Description</h3>

<p>This function applies robust principal component analysis for compositional
data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcaCoDa(
  x,
  method = "robust",
  mult_comp = NULL,
  external = NULL,
  solve = "eigen"
)

## S3 method for class 'pcaCoDa'
print(x, ...)

## S3 method for class 'pcaCoDa'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>compositional data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>must be either “robust” (default) or “classical”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult_comp</code></td>
<td>
<p>a list of numeric vectors holding the indices of linked
compositions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>external</code></td>
<td>
<p>external non-compositional variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solve</code></td>
<td>
<p>eigen (as princomp does, i.e. eigenvalues of the covariance matrix) or svd (as prcomp does with single value decomposition instead of eigen). Only for method classical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters for print method passed through</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class pcaCoDa</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The compositional data set is expressed in isometric logratio coordinates.
Afterwards, robust principal component analysis is performed.  Resulting
loadings and scores are back-transformed to the clr space where the
compositional biplot can be shown.
</p>
<p><code>mult_comp</code> is used when there are more than one group of compositional
parts in the data. To give an illustrative example, lets assume that one
variable group measures angles of the inner ear-bones of animals which sum
up to 100 and another one having percentages of a whole on the thickness of
the inner ear-bones included. Then two groups of variables exists which are
both compositional parts. The isometric logratio coordinates are then internally applied
to each group independently whenever the <code>mult_comp</code> is set correctly.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scores </code></td>
<td>
<p>scores in clr space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings </code></td>
<td>
<p>loadings in clr
space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvalues </code></td>
<td>
<p>eigenvalues of the clr covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>princompOutputClr </code></td>
<td>
<p>output of <code>princomp</code>
needed in <code>plot.pcaCoDa</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Karel Hron, Peter Filzmoser, Matthias Templ and a contribution for dimnames in external variables by Amelia Landre.
</p>


<h3>References</h3>

<p>Filzmoser, P., Hron, K., Reimann, C. (2009) Principal component
analysis for compositional data with outliers. <em>Environmetrics</em>,
<b>20</b>, 621-632.
</p>
<p>Kynclova, P., Filzmoser, P., Hron, K. (2016) Compositional biplots including external non-compositional variables. 
<em>Statistics: A Journal of Theoretical and Applied Statistics</em>,
<b>50</b>, 1132-1148.
</p>


<h3>See Also</h3>

<p><code>print.pcaCoDa</code>, <code>summary.pcaCoDa</code>, <code>biplot.pcaCoDa</code>, <code>plot.pcaCoDa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(arcticLake)

## robust estimation (default):
res.rob &lt;- pcaCoDa(arcticLake)
res.rob
summary(res.rob)
plot(res.rob)

## classical estimation:
res.cla &lt;- pcaCoDa(arcticLake, method="classical", solve = "eigen")
biplot(res.cla)

## just for illustration how to set the mult_comp argument:
data(expenditures)
p1 &lt;- pcaCoDa(expenditures, mult_comp=list(c(1,2,3),c(4,5)))
p1

## example with external variables:
data(election)
# transform external variables
election$unemployment &lt;- log((election$unemployment/100)/(1-election$unemployment/100))
election$income &lt;- scale(election$income)

res &lt;- pcaCoDa(election[,1:6], method="classical", external=election[,7:8])
res
biplot(res, scale=0)
</code></pre>


</div>