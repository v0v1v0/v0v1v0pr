<div class="container">

<table style="width: 100%;"><tr>
<td>est.R0.SB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the time dependent R using a Bayesian method</h2>

<h3>Description</h3>

<p>Estimate R by a sequential Bayesian method, using known data up to a point
in time as a Bayesian prior for the next iteration (see details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">est.R0.SB(
  epid,
  GT,
  t = NULL,
  begin = NULL,
  end = NULL,
  date.first.obs = NULL,
  time.step = 1,
  force.prior = FALSE,
  checked = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>epid</code></td>
<td>
<p>Object containing epidemic curve data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT</code></td>
<td>
<p>Generation time distribution from <code>generation.time()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>At what time estimation begins (unused by this method, just there for plotting purposes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>At what time estimation ends (unused by this method, just there for plotting purposes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.prior</code></td>
<td>
<p>Set to any custom value to force the initial prior as a uniform distribution on [0 ; value].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For internal use. Called by <code>estimate.R()</code>.
</p>
<p>Initial prior is an unbiased uniform distribution for R, between 0 and the maximum
of incid(t+1) - incid(t). For each subsequent iteration, a new distribution is
computed for R, using the previous output as new prior.
</p>
<p>The 95% confidence intervan is achieved by a cumulative sum of the posterior
distirbution of R and corresponds to the 2.5-th and 97.5-th percentiles.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>vector of R values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>95% confidence interval for estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba.Rt</code></td>
<td>
<p>A list with successive distribution for R throughout the outbreak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT</code></td>
<td>
<p>Generation time distribution used in the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epid</code></td>
<td>
<p>Original epidemic data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>Begin date for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin.nb</code></td>
<td>
<p>Index of begin date for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>End date for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end.nb</code></td>
<td>
<p>Index of end date for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>Predictive curve based on most-likely R value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>Name of the data used in the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Complete call used to generate results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This is the implementation of the method provided by Bettencourt &amp; Ribeiro (2008).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>Bettencourt, L.M.A., and R.M. Ribeiro. "Real Time Bayesian Estimation of the Epidemic Potential of Emerging Infectious Diseases." PLoS One 3, no. 5 (2008): e2185.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Loading package
library(R0)

## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
## outbreak during 1918 influenza pandemic in Germany)

data(Germany.1918)
mGT &lt;- generation.time("gamma", c(3,1.5))
SB &lt;- est.R0.SB(Germany.1918, mGT)

## Results will include "most likely R(t)" (ie. the R(t) value for which the computed probability 
## is the highest), along with 95% CI, in a data.frame object
SB
# Reproduction number estimate using  Real Time Bayesian  method.
# 0 0 2.02 0.71 1.17 1.7 1.36 1.53 1.28 1.43 ...

SB$Rt.quant
# Date R.t. CI.lower. CI.upper.
# 1  1918-09-29 0.00      0.01      1.44
# 2  1918-09-30 0.00      0.01      1.42
# 3  1918-10-01 2.02      0.97      2.88
# 4  1918-10-02 0.71      0.07      1.51
# 5  1918-10-03 1.17      0.40      1.84
# 6  1918-10-04 1.70      1.09      2.24
# 7  1918-10-05 1.36      0.84      1.83
# 8  1918-10-06 1.53      1.08      1.94
# 9  1918-10-07 1.28      0.88      1.66
# 10 1918-10-08 1.43      1.08      1.77
# ...

## "Plot" will provide the most-likely R value at each time unit, along with 95CI
plot(SB)
## "Plotfit" will show the complete distribution of R for 9 time unit throughout the outbreak
plotfit(SB)
</code></pre>


</div>