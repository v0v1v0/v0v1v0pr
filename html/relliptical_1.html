<div class="container">

<table style="width: 100%;"><tr>
<td>mvtelliptical</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean and Variance for Truncated Multivariate Elliptical Distributions</h2>

<h3>Description</h3>

<p>This function approximates the mean vector and variance-covariance matrix for some specific truncated elliptical distributions.
The argument <code>dist</code> sets the distribution to be used and accepts the values <code>Normal</code>,
<code>t</code>, <code>Laplace</code>, <code>PE</code>, <code>PVII</code>, <code>Slash</code>, and <code>CN</code>, for the truncated Normal, Student-t, Power Exponential,
Pearson VII, Slash, and Contaminated Normal distribution, respectively. Moments are computed through Monte Carlo method for
the truncated variables and using properties of the conditional expectation for the non-truncated variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvtelliptical(lower, upper = rep(Inf, length(lower)), mu = rep(0,
  length(lower)), Sigma = diag(length(lower)), dist = "Normal",
  nu = NULL, n = 10000, burn.in = 0, thinning = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>vector of lower truncation points of length <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>vector of upper truncation points of length <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>numeric vector of length <code class="reqn">p</code> representing the location parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the
scale parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>represents the truncated distribution to be used. The values are <code>'Normal'</code>,
<code>'t'</code>, <code>'Laplace'</code>, <code>'PE'</code>, <code>'PVII'</code>, <code>'Slash'</code>, and <code>'CN'</code> for the truncated Normal, Student-t,
Laplace, Power Exponential, Pearson VII, Slash, and Contaminated Normal distributions, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>additional parameter or vector of parameters depending on the
density generating function. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of Monte Carlo samples to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>number of samples to be discarded as a burn-in phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>factor for reducing the autocorrelation of random points.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function also considers the univariate case. The argument <code>nu</code> is a parameter
or vector of parameters depending on the density generating function (DGF). For the truncated
Student-t, Power Exponential, and Slash distribution, <code>nu</code> is a positive number.
For the truncated Pearson VII, <code>nu</code> is a vector with the first element greater than <code class="reqn">p/2</code>
and the second element a positive number. For the truncated Contaminated Normal distribution, <code>nu</code>
is a vector of length 2 assuming values between 0 and 1.
</p>


<h3>Value</h3>

<p>It returns a list with three elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>EY</code></td>
<td>
<p>the mean vector of length <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EYY</code></td>
<td>
<p>the second moment matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarY</code></td>
<td>
<p>the variance-covariance matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The Normal distribution is a particular case of the Power Exponential distribution when <code>nu = 1</code>.
The Student-t distribution with <code class="reqn">\nu</code> degrees of freedom results from the Pearson VII
distribution when <code>nu = </code> ((<code class="reqn">\nu</code>+p)/2, <code class="reqn">\nu</code>).
</p>
<p>In the Student-t distribution, if <code>nu &gt;= 300</code>, the Normal case is considered.
For Student-t distribution, the algorithm also supports degrees of freedom <code>nu &lt;= 2</code>.
For Pearson VII distribution, the algorithm supports values of <code>m &lt;= (p+2)/2</code> (first element of <code>nu</code>).
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Christian E. Galarza and Larissa A. Matos
</p>


<h3>References</h3>


<p>Fang KT, Kotz S, Ng KW (2018).
<em>Symmetric multivariate and related distributions</em>.
Chapman and Hall/CRC.
</p>
<p>Galarza CE, Matos LA, Castro LM, Lachos VH (2022).
“Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution.”
<em>Journal of Multivariate Analysis</em>, <b>189</b>, 104944.
<a href="https://doi.org/10.1016/j.jmva.2021.104944">doi:10.1016/j.jmva.2021.104944</a>.
</p>
<p>Valeriano KA, Galarza CE, Matos LA (2023).
“Moments and random number generation for the truncated elliptical family of distributions.”
<em>Statistics and Computing</em>, <b>33</b>(1), 32.

</p>


<h3>See Also</h3>

<p><code>rtelliptical</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Truncated Student-t distribution
set.seed(5678)
mu = c(0.1, 0.2, 0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1), nrow=length(mu),
               ncol=length(mu), byrow=TRUE)

# Example 1: one doubly truncated student-t (nu = 0.80) and Laplace
a = c(-0.8, -Inf, -Inf)
b = c(0.5, 0.6, Inf)
MC11 = mvtelliptical(a, b, mu, Sigma, "t", 0.80) # Student-t
MC12 = mvtelliptical(a, b, mu, Sigma, "Laplace") # Laplace

# Example 2: two doubly truncated student-t (nu = 0.80)
MC12 = mvtelliptical(a, b, mu, Sigma, "t", 0.80) # By default n=1e4

# Truncated Pearson VII distribution
set.seed(9876)
MC21 = mvtelliptical(a, b, mu, Sigma, "PVII", c(1.90,0.80), n=1e6) # More precision
c(MC12$EY); c(MC21$EY)
MC12$VarY;  MC21$VarY

# Truncated Normal distribution
set.seed(1234)
MC31 = mvtelliptical(a, b, mu, Sigma, "Normal", n=1e4)
MC32 = mvtelliptical(a, b, mu, Sigma, "Normal", n=1e6) # More precision
</code></pre>


</div>