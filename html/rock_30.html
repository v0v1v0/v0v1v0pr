<div class="container">

<table style="width: 100%;"><tr>
<td>convert_df_to_source</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert 'rectangular' or spreadsheet-format data to one or more sources</h2>

<h3>Description</h3>

<p>These functions first import data from a 'data format', such as spreadsheets
in <code>.xlsx</code> format, comma-separated values files (<code>.csv</code>), or SPSS data
files (<code>.sav</code>). You can also just use R data frames (imported however you
want). These functions then use the columns you specified to convert these
data to one (<code>oneFile=TRUE</code>) or more (<code>oneFile=FALSE</code>) <code>rock</code>
source file(s), optionally including class instance
identifiers (such as case identifiers to identify participants, or location
identifiers, or moment identifiers, etc) and using those to link the
utterances to attributes from columns you specified. You can also precode
the utterances with codes you specify (if you ever would want to for some
reason).
</p>


<h3>Usage</h3>

<pre><code class="language-R">convert_df_to_source(
  data,
  output = NULL,
  omit_empty_rows = TRUE,
  cols_to_utterances = NULL,
  cols_to_ciids = NULL,
  cols_to_codes = NULL,
  cols_to_attributes = NULL,
  utterance_classId = NULL,
  oneFile = TRUE,
  cols_to_sourceFilename = cols_to_ciids,
  cols_in_sourceFilename_sep = "=",
  sourceFilename_prefix = "source_",
  sourceFilename_suffix = "",
  ciid_labels = NULL,
  ciid_separator = "=",
  attributesFile = NULL,
  preventOverwriting = rock::opts$get(preventOverwriting),
  encoding = rock::opts$get(encoding),
  silent = rock::opts$get(silent)
)

convert_csv_to_source(
  file,
  importArgs = NULL,
  omit_empty_rows = TRUE,
  output = NULL,
  cols_to_utterances = NULL,
  cols_to_ciids = NULL,
  cols_to_codes = NULL,
  cols_to_attributes = NULL,
  oneFile = TRUE,
  cols_to_sourceFilename = cols_to_ciids,
  cols_in_sourceFilename_sep = "=",
  sourceFilename_prefix = "source_",
  sourceFilename_suffix = "",
  ciid_labels = NULL,
  ciid_separator = "=",
  attributesFile = NULL,
  preventOverwriting = rock::opts$get(preventOverwriting),
  encoding = rock::opts$get(encoding),
  silent = rock::opts$get(silent)
)

convert_csv2_to_source(
  file,
  importArgs = NULL,
  omit_empty_rows = TRUE,
  output = NULL,
  cols_to_utterances = NULL,
  cols_to_ciids = NULL,
  cols_to_codes = NULL,
  cols_to_attributes = NULL,
  oneFile = TRUE,
  cols_to_sourceFilename = cols_to_ciids,
  cols_in_sourceFilename_sep = "=",
  sourceFilename_prefix = "source_",
  sourceFilename_suffix = "",
  ciid_labels = NULL,
  ciid_separator = "=",
  attributesFile = NULL,
  preventOverwriting = rock::opts$get(preventOverwriting),
  encoding = rock::opts$get(encoding),
  silent = rock::opts$get(silent)
)

convert_xlsx_to_source(
  file,
  importArgs = list(),
  omit_empty_rows = TRUE,
  output = NULL,
  cols_to_utterances = NULL,
  cols_to_ciids = NULL,
  cols_to_codes = NULL,
  cols_to_attributes = NULL,
  oneFile = TRUE,
  cols_to_sourceFilename = cols_to_ciids,
  cols_in_sourceFilename_sep = "=",
  sourceFilename_prefix = "source_",
  sourceFilename_suffix = "",
  ciid_labels = NULL,
  ciid_separator = "=",
  attributesFile = NULL,
  preventOverwriting = rock::opts$get(preventOverwriting),
  encoding = rock::opts$get(encoding),
  silent = rock::opts$get(silent)
)

convert_sav_to_source(
  file,
  importArgs = NULL,
  omit_empty_rows = TRUE,
  output = NULL,
  cols_to_utterances = NULL,
  cols_to_ciids = NULL,
  cols_to_codes = NULL,
  cols_to_attributes = NULL,
  oneFile = TRUE,
  cols_to_sourceFilename = cols_to_ciids,
  cols_in_sourceFilename_sep = "=",
  sourceFilename_prefix = "source_",
  sourceFilename_suffix = "",
  ciid_labels = NULL,
  ciid_separator = "=",
  attributesFile = NULL,
  preventOverwriting = rock::opts$get(preventOverwriting),
  encoding = rock::opts$get(encoding),
  silent = rock::opts$get(silent)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data frame containing the data to convert.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>If <code>oneFile=TRUE</code> (the default), the name (and path)
of the file in which to save the processed source (if it is <code>NULL</code>, the
resulting character vector will be returned visibly instead of invisibly).
Note that the ROCK convention is to use <code>.rock</code> as extension.
If <code>oneFile=FALSE</code>, the path to which to write the
sources (if it is <code>NULL</code>, as a result a list of character vectors will be
returned visibly instead of invisibly).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit_empty_rows</code></td>
<td>
<p>Whether to omit rows where the values in the columns
specified to convert to utterances are all empty (or contain only
whitespace).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols_to_utterances</code></td>
<td>
<p>The names of the columns to convert to utterances,
as a character vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols_to_ciids</code></td>
<td>
<p>The names of the columns to convert to class instance
identifiers (e.g. case identifiers), as a named character vector, with
the values being the column names in the data frame, and the names being the
class instance identifiers (e.g. <code>"sourceId"</code>, <code>"fieldId"</code>, <code>"caseId"</code>, etc).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols_to_codes</code></td>
<td>
<p>The names of the columns to convert to codes (i.e.
codes appended to every utterance), as a character vector. When writing codes,
it is not possible to also write multiple utterance columns
(i.e. <code>utterance_classId</code> must be <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols_to_attributes</code></td>
<td>
<p>The names of the columns to convert to attributes,
as a named character vector, where each name is the name of the class
instance identifier to attach the attribute to. If only one column is passed
in <code>cols_to_ciids</code>, names can be omitted and a regular unnamed character
vector can be passed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>utterance_classId</code></td>
<td>
<p>When specifying multiple columns with utterances,
and <code>utterance_classId</code> is not <code>NULL</code>, the column names are considered to be
class instance identifiers, and specified above each utterance using the
class identifier specified here (e.g. "<code>utterance_classId="originalColName"</code>"
yields something like "<code style="white-space: pre;">⁠[[originalColName=colName_1]]⁠</code>" above all utterances
from the column named <code>colName_1</code>). When writing multiple utterance columns,
it is not possible to also write codes (i.e. <code>cols_to_codes</code> must be <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oneFile</code></td>
<td>
<p>Whether to store everything in one source, or create one
source for each row of the data (if this is set to <code>FALSE</code>, make sure that
<code>cols_to_sourceFilename</code> specifies one or more columns that together
uniquely identify each row; also, in that case, <code>output</code> must be an existing
directory on your PC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols_to_sourceFilename</code></td>
<td>
<p>The columns to use as unique part of the
filename of each source. These will be concatenated using
<code>cols_in_sourceFilename_sep</code> as a separator. Note that the final string
<em>must</em> be unique for each row in the dataset, otherwise the filenames for
multiple rows will be the same and will be overwritten! By default, the
columns specified with class instance identifiers are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols_in_sourceFilename_sep</code></td>
<td>
<p>The separator to use when concatenating
the <code>cols_to_sourceFilename</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sourceFilename_prefix, sourceFilename_suffix</code></td>
<td>
<p>Strings that are
prepended and appended to the <code>col_to_sourceFilename</code> to create the full
filenames. Note that <code>.rock</code> will always be added to the end as extension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ciid_labels</code></td>
<td>
<p>The labels for the class instance identifiers. Class
instance identifiers have brief codes used in coding (e.g. 'cid' is the
default for Case Identifiers, often used to identify participants) as well
as more 'readable' labels that are used in the attributes (e.g. 'caseId' is
the default class instance identifier for Case Identifiers). These can be
specified here as a named vector, with each element being the label and
the element's name the identifier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ciid_separator</code></td>
<td>
<p>The separator for the class instance identifier - by
default, either an equals sign (<code>=</code>) or a colon (<code>:</code>) are supported, but
an equals sign is less ambiguous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attributesFile</code></td>
<td>
<p>Optionally, a file to write the attributes to if you
don't want them to be written to the source file(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preventOverwriting</code></td>
<td>
<p>Whether to prevent overwriting of output files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>encoding</code></td>
<td>
<p>The encoding of the source(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Whether to suppress the warning about not editing the cleaned source.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>The path to a file containing the data to convert.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>importArgs</code></td>
<td>
<p>Optionally, a list with named elements representing
arguments to pass when importing the file.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A source as a character vector.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Get path to example files
examplePath &lt;-
  system.file("extdata", package="rock");

### Get a path to file with example data frame
exampleFile &lt;-
  file.path(examplePath, "spreadsheet-import-test.csv");

### Read data into a data frame
dat &lt;-
  read.csv(exampleFile);

### Convert data frame to a source
source_from_df &lt;-
  convert_df_to_source(
    dat,
    cols_to_utterances = c("open_question_1",
                           "open_question_2"),
    cols_to_ciids = c(cid = "id"),
    cols_to_attributes = c("age", "gender"),
    cols_to_codes = c("code_1", "code_2"),
    ciid_labels = c(cid = "caseId")
 );

### Show the result
cat(
  source_from_df,
  sep = "\n"
);
</code></pre>


</div>