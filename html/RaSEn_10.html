<div class="container">

<table style="width: 100%;"><tr>
<td>Rase</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct the random subspace ensemble classifier.</h2>

<h3>Description</h3>

<p><code>RaSE</code> is a general ensemble classification framework to solve the sparse classification problem. In RaSE algorithm, for each of the B1 weak learners, B2 random subspaces are generated and the optimal one is chosen to train the model on the basis of some criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Rase(
  xtrain,
  ytrain,
  xval = NULL,
  yval = NULL,
  B1 = 200,
  B2 = 500,
  D = NULL,
  dist = NULL,
  base = NULL,
  super = list(type = c("separate"), base.update = TRUE),
  criterion = NULL,
  ranking = TRUE,
  k = c(3, 5, 7, 9, 11),
  cores = 1,
  seed = NULL,
  iteration = 0,
  cutoff = TRUE,
  cv = 5,
  scale = FALSE,
  C0 = 0.1,
  kl.k = NULL,
  lower.limits = NULL,
  upper.limits = NULL,
  weights = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xtrain</code></td>
<td>
<p>n * p observation matrix. n observations, p features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytrain</code></td>
<td>
<p>n 0/1 observatons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xval</code></td>
<td>
<p>observation matrix for validation. Default = <code>NULL</code>. Useful only when <code>criterion</code> = 'validation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yval</code></td>
<td>
<p>0/1 observation for validation. Default = <code>NULL</code>. Useful only when <code>criterion</code> = 'validation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B1</code></td>
<td>
<p>the number of weak learners. Default = 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B2</code></td>
<td>
<p>the number of subspace candidates generated for each weak learner. Default = 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>the maximal subspace size when generating random subspaces. Default = <code>NULL</code>, which is <code class="reqn">min(\sqrt n0, \sqrt n1, p)</code> when <code>base</code> = 'qda' and is <code class="reqn">min(\sqrt n, p)</code> otherwise. For classical RaSE with a single classifier type, <code>D</code> is a positive integer. For super RaSE with multiple classifier types, <code>D</code> is a vector indicating different D values used for each base classifier type (the corresponding classifier types should be noted in the names of the vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>the distribution for features when generating random subspaces. Default = <code>NULL</code>, which represents the uniform distribution. First generate an integer <code class="reqn">d</code> from <code class="reqn">1,...,D</code> uniformly, then uniformly generate a subset with cardinality <code class="reqn">d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>the type of base classifier. Default = 'lda'. Can be either a single string chosen from the following options or a string/probability vector. When it indicates a single type of base classifiers, the classical RaSE model (Tian, Y. and Feng, Y., 2021(b)) will be fitted. When it is a string vector which includes multiple base classifier types, a super RaSE model (Zhu, J. and Feng, Y., 2021) will be fitted, by samling base classifiers with equal probabilty. It can also be a probability vector with row names corresponding to the specific classifier type, in which case a super RaSE model will be trained by sampling base classifiers in the given sampling probability.
</p>

<ul>
<li>
<p> lda: linear discriminant analysis. <code>lda</code> in <code>MASS</code> package.
</p>
</li>
<li>
<p> qda: quadratic discriminant analysis. <code>qda</code> in <code>MASS</code> package.
</p>
</li>
<li>
<p> knn: k-nearest neighbor. <code>knn</code>, <code>knn.cv</code> in <code>class</code> package and <code>knn3</code> in <code>caret</code> package.
</p>
</li>
<li>
<p> logistic: logistic regression. <code>glm</code> in <code>stats</code> package and <code>glmnet</code> in <code>glmnet</code> package.
</p>
</li>
<li>
<p> tree: decision tree. <code>rpart</code> in <code>rpart</code> package.
</p>
</li>
<li>
<p> svm: support vector machine. <code>svm</code> in <code>e1071</code> package.
</p>
</li>
<li>
<p> randomforest: random forest. <code>randomForest</code> in <code>randomForest</code> package.
</p>
</li>
<li>
<p> gamma: Bayesian classifier for multivariate gamma distribution with independent marginals.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>super</code></td>
<td>
<p>a list of control parameters for super RaSE (Zhu, J. and Feng, Y., 2021). Not used when base equals to a single string. Should be a list object with the following components:
</p>

<ul>
<li>
<p> type: the type of super RaSE. Currently the only option is 'separate', meaning that subspace distributions are different for each type of base classifiers.
</p>
</li>
<li>
<p> base.update: indicates whether the sampling probability of base classifiers should be updated during iterations or not. Logistic, default = TRUE.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>the criterion to choose the best subspace for each weak learner. For the classical RaSE (when <code>base</code> includes a single classifier type), default = 'ric' when <code>base</code> = 'lda', 'qda', 'gamma'; default = 'ebic' and set <code>gam</code> = 0 when <code>base</code> = 'logistic'; default = 'loo' when <code>base</code> = 'knn'; default = 'training' when <code>base</code> = 'tree', 'svm', 'randomforest'. For the super RaSE (when <code>base</code> indicates multiple classifiers or the sampling probability of multiple classifiers), default = 'cv' with the number of folds <code>cv</code> = 5, and it can only be 'cv', 'training' or 'auc'.
</p>

<ul>
<li>
<p> ric: minimizing ratio information criterion with parametric estimation (Tian, Y. and Feng, Y., 2021(b)). Available when <code>base</code> = 'lda', 'qda', 'gamma' or 'logistic'.
</p>
</li>
<li>
<p> nric: minimizing ratio information criterion with non-parametric estimation (Tian, Y. and Feng, Y., 2021(b)). Available when <code>base</code> = 'lda', 'qda', 'gamma' or 'logistic'.
</p>
</li>
<li>
<p> training: minimizing training error. Not available when <code>base</code> = 'knn'.
</p>
</li>
<li>
<p> loo: minimizing leave-one-out error. Only available when  <code>base</code> = 'knn'.
</p>
</li>
<li>
<p> validation: minimizing validation error based on the validation data. Available for all base classifiers.
</p>
</li>
<li>
<p> auc: minimizing negative area under the ROC curve (AUC). Currently it is estimated on training data via function <code>auc</code> from package <code>ModelMetrics</code>. It is available for all classier choices.
</p>
</li>
<li>
<p> cv: minimizing k-fold cross-validation error. k equals to the value of <code>cv</code>. Default = 5. Not available when <code>base</code> = 'gamma'.
</p>
</li>
<li>
<p> aic: minimizing Akaike information criterion (Akaike, H., 1973). Available when <code>base</code> = 'lda' or 'logistic'.
</p>
<p>AIC = -2 * log-likelihood + |S| * 2.
</p>
</li>
<li>
<p> bic: minimizing Bayesian information criterion (Schwarz, G., 1978). Available when <code>base</code> = 'lda' or 'logistic'.
</p>
<p>BIC = -2 * log-likelihood + |S| * log(n).
</p>
</li>
<li>
<p> ebic: minimizing extended Bayesian information criterion (Chen, J. and Chen, Z., 2008; 2012). Need to assign value for <code>gam</code>. When <code>gam</code> = 0, it denotes the classical BIC. Available when <code>base</code> = 'lda' or 'logistic'.
</p>
<p>EBIC = -2 * log-likelihood + |S| * log(n) + 2 * |S| * gam * log(p).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranking</code></td>
<td>
<p>whether the function outputs the selected percentage of each feature in B1 subspaces. Logistic, default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of nearest neightbors considered when <code>base</code> = 'knn'. Only useful when <code>base</code> = 'knn'. Default = (3, 5, 7, 9, 11).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>the number of cores used for parallel computing. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random seed assigned at the start of the algorithm, which can be a real number or <code>NULL</code>. Default = <code>NULL</code>, in which case no random seed will be set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>the number of iterations. Default = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>whether to use the empirically optimal threshold. Logistic, default = TRUE. If it is FALSE, the threshold will be set as 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>the number of cross-validations used. Default = 5. Only useful when <code>criterion</code> = 'cv'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>whether to normalize the data. Logistic, default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C0</code></td>
<td>
<p>a positive constant used when <code>iteration</code> &gt; 1. Default = 0.1. See Tian, Y. and Feng, Y., 2021(b) for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kl.k</code></td>
<td>
<p>the number of nearest neighbors used to estimate RIC in a non-parametric way. Default = <code>NULL</code>, which means that <code class="reqn">k0 = floor(\sqrt n0)</code> and <code class="reqn">k1 = floor(\sqrt n1)</code>. See Tian, Y. and Feng, Y., 2021(b) for details. Only available when <code>criterion</code> = 'nric'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.limits</code></td>
<td>
<p>the vector of lower limits for each coefficient in logistic regression. Should be a vector of length equal to the number of variables (the column number of <code>xtrain</code>). Each of these must be non-positive. Default = <code>NULL</code>, meaning that lower limits are <code>-Inf</code> for all coefficients. Only available when <code>base</code> = 'logistic'. When it's activated, function <code>glmnet</code> will be used to fit logistic regression models, in which case the minimum subspace size is required to be larger than 1. The default subspace size distribution will be changed to uniform distribution on (2, ..., D).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.limits</code></td>
<td>
<p>the vector of upper limits for each coefficient in logistic regression. Should be a vector of length equal to the number of variables (the column number of <code>xtrain</code>). Each of these must be non-negative. Default = <code>NULL</code>, meaning that upper limits are <code>Inf</code> for all coefficients. Only available when <code>base</code> = 'logistic'. When it's activated, function <code>glmnet</code> will be used to fit logistic regression models, in which case the minimum subspace size is required to be larger than 1. The default subspace size distribution will be changed to uniform distribution on (2, ..., D).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>observation weights. Should be a vector of length equal to training sample size (the length of <code>ytrain</code>). It will be normailized inside the algorithm. Each component of weights must be non-negative. Default is <code>NULL</code>, representing equal weight for each observation. Only available when <code>base</code> = 'logistic'. When it's activated, function <code>glmnet</code> will be used to fit logistic regression models, in which case the minimum subspace size is required to be larger than 1. The default subspace size distribution will be changed to uniform distribution on (2, ..., D).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with S3 class <code>'RaSE'</code> if <code>base</code> indicates a single base classifier.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>the marginal probability for each class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>the type of base classifier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>the criterion to choose the best subspace for each weak learner.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B1</code></td>
<td>
<p>the number of weak learners.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B2</code></td>
<td>
<p>the number of subspace candidates generated for each weak learner.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>the maximal subspace size when generating random subspaces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>the number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.list</code></td>
<td>
<p>sequence of B1 fitted base classifiers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the empirically optimal threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subspace</code></td>
<td>
<p>sequence of subspaces correponding to B1 weak learners.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranking</code></td>
<td>
<p>the selected percentage of each feature in B1 subspaces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a list of scaling parameters, including the scaling center and the scale parameter for each feature. Equals to <code>NULL</code> when the data is not scaled in <code>RaSE</code> model fitting.</p>
</td>
</tr>
</table>
<p>An object with S3 class <code>'super_RaSE'</code> if <code>base</code> includes multiple base classifiers or the sampling probability of multiple classifiers.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>the marginal probability for each class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>the list of B1 base classifier types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>the criterion to choose the best subspace for each weak learner.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B1</code></td>
<td>
<p>the number of weak learners.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B2</code></td>
<td>
<p>the number of subspace candidates generated for each weak learner.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>the maximal subspace size when generating random subspaces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>the number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.list</code></td>
<td>
<p>sequence of B1 fitted base classifiers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the empirically optimal threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subspace</code></td>
<td>
<p>sequence of subspaces correponding to B1 weak learners.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranking.feature</code></td>
<td>
<p>the selected percentage of each feature corresponding to each type of classifier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranking.base</code></td>
<td>
<p>the selected percentage of each classifier type in the selected B1 learners.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a list of scaling parameters, including the scaling center and the scale parameter for each feature. Equals to <code>NULL</code> when the data is not scaled in <code>RaSE</code> model fitting.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ye Tian (maintainer, <a href="mailto:ye.t@columbia.edu">ye.t@columbia.edu</a>) and Yang Feng. The authors thank Yu Cao (Exeter Finance) and his team for many helpful suggestions and discussions.
</p>


<h3>References</h3>

<p>Tian, Y. and Feng, Y., 2021(a). RaSE: A variable screening framework via random subspace ensembles. Journal of the American Statistical Association, (just-accepted), pp.1-30.
</p>
<p>Tian, Y. and Feng, Y., 2021(b). RaSE: Random subspace ensemble classification. Journal of Machine Learning Research, 22(45), pp.1-93.
</p>
<p>Zhu, J. and Feng, Y., 2021. Super RaSE: Super Random Subspace Ensemble Classification. https://www.preprints.org/manuscript/202110.0042
</p>
<p>Chen, J. and Chen, Z., 2008. Extended Bayesian information criteria for model selection with large model spaces. Biometrika, 95(3), pp.759-771.
</p>
<p>Chen, J. and Chen, Z., 2012. Extended BIC for small-n-large-P sparse GLM. Statistica Sinica, pp.555-574.
</p>
<p>Akaike, H., 1973. Information theory and an extension of the maximum likelihood principle. In 2nd International Symposium on Information Theory, 1973 (pp. 267-281). Akademiai Kaido.
</p>
<p>Schwarz, G., 1978. Estimating the dimension of a model. The annals of statistics, 6(2), pp.461-464.
</p>


<h3>See Also</h3>

<p><code>predict.RaSE</code>, <code>RaModel</code>, <code>print.RaSE</code>, <code>print.super_RaSE</code>, <code>RaPlot</code>, <code>RaScreen</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(0, kind = "L'Ecuyer-CMRG")
train.data &lt;- RaModel("classification", 1, n = 100, p = 50)
test.data &lt;- RaModel("classification", 1, n = 100, p = 50)
xtrain &lt;- train.data$x
ytrain &lt;- train.data$y
xtest &lt;- test.data$x
ytest &lt;- test.data$y

# test RaSE classifier with LDA base classifier
fit &lt;- Rase(xtrain, ytrain, B1 = 100, B2 = 50, iteration = 0, base = 'lda',
cores = 2, criterion = 'ric')
mean(predict(fit, xtest) != ytest)

## Not run: 
# test RaSE classifier with LDA base classifier and 1 iteration round
fit &lt;- Rase(xtrain, ytrain, B1 = 100, B2 = 50, iteration = 1, base = 'lda',
cores = 2, criterion = 'ric')
mean(predict(fit, xtest) != ytest)

# test RaSE classifier with QDA base classifier and 1 iteration round
fit &lt;- Rase(xtrain, ytrain, B1 = 100, B2 = 50, iteration = 1, base = 'qda',
cores = 2, criterion = 'ric')
mean(predict(fit, xtest) != ytest)

# test RaSE classifier with kNN base classifier
fit &lt;- Rase(xtrain, ytrain, B1 = 100, B2 = 50, iteration = 0, base = 'knn',
cores = 2, criterion = 'loo')
mean(predict(fit, xtest) != ytest)

# test RaSE classifier with logistic regression base classifier
fit &lt;- Rase(xtrain, ytrain, B1 = 100, B2 = 50, iteration = 0, base = 'logistic',
cores = 2, criterion = 'bic')
mean(predict(fit, xtest) != ytest)

# test RaSE classifier with SVM base classifier
fit &lt;- Rase(xtrain, ytrain, B1 = 100, B2 = 50, iteration = 0, base = 'svm',
cores = 2, criterion = 'training')
mean(predict(fit, xtest) != ytest)

# test RaSE classifier with random forest base classifier
fit &lt;- Rase(xtrain, ytrain, B1 = 20, B2 = 10, iteration = 0, base = 'randomforest',
cores = 2, criterion = 'cv', cv = 3)
mean(predict(fit, xtest) != ytest)

# fit a super RaSE classifier by sampling base learner from kNN, LDA and logistic
# regression in equal probability
fit &lt;- Rase(xtrain = xtrain, ytrain = ytrain, B1 = 100, B2 = 100,
base = c("knn", "lda", "logistic"), super = list(type = "separate", base.update = T),
criterion = "cv", cv = 5, iteration = 1, cores = 2)
mean(predict(fit, xtest) != ytest)

# fit a super RaSE classifier by sampling base learner from random forest, LDA and
# SVM with probability 0.2, 0.5 and 0.3
fit &lt;- Rase(xtrain = xtrain, ytrain = ytrain, B1 = 100, B2 = 100,
base = c(randomforest = 0.2, lda = 0.5, svm = 0.3),
super = list(type = "separate", base.update = F),
criterion = "cv", cv = 5, iteration = 0, cores = 2)
mean(predict(fit, xtest) != ytest)

## End(Not run)
</code></pre>


</div>