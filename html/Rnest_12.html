<div class="container">

<table style="width: 100%;"><tr>
<td>nest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nest Eigenvalue Sufficiency Test (NEST)</h2>

<h3>Description</h3>

<p><code>nest</code> is used to identify the number of factors to retain in exploratory factor analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nest(
  data,
  n = NULL,
  nrep = 1000,
  alpha = 0.05,
  max.fact = ncol(data),
  method = "ml",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame, a numeric matrix, covariance matrix or correlation matrix from which to determine the number of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of cases (subjects, participants, or units) if a covariance matrix is supplied in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>The number of replications to simulate. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A vector of type I error rates or <code>(1-alpha)*100%</code> confidence intervals. Default is .05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.fact</code></td>
<td>
<p>An optional maximum number of factor to extract. Default is <code>max.fact = ncol(data)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A method used to compute loadings and uniquenesses. Four methods are implemented in <code>Rnest</code> : maximum likelihood <code>method = "ml"</code> (default), regularized common factor analysis <code>method = "rcfa"</code>, minimum rank factor analysis <code>method = "mrfa"</code>, and principal axis factoring <code>method = "paf"</code>. See details for custom methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments for <code>method</code> that can be supplied. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Next Eigenvalues Sufficiency Test (NEST) is an extension of parallel analysis by adding a sequential hypothesis testing procedure for every <code class="reqn">k = 1, ..., p</code> factor until the hypothesis is not rejected. 
</p>
<p>At <code class="reqn">k = 1</code>, NEST and parallel analysis are identical. Both use an Identity matrix as the correlation matrix. Once the first hypothesis is rejected, NEST uses a correlation matrix based on the loadings and uniquenesses of the <code class="reqn">k^{th}</code> factorial structure. NEST then resamples the eigenvalues of this new correlation matrix. NEST stops when the $k_1^2$ eigenvalues is within the confidence interval.  
</p>
<p>There is two <code>method</code> already implemented in <code>nest</code> to extract loadings and uniquenesses: maximum likelihood (<code>"ml"</code>; default), principal axis factoring (<code>"paf"</code>), and minimum rank factor analysis (<code>"mrfa"</code>). The functions use as arguments: <code>covmat</code>, <code>n</code>, <code>factors</code>, and <code>...</code> (supplementary arguments passed by <code>nest</code>). They return <code>loadings</code> and <code>uniquenesses</code>. Any other user-defined functions can be used as long as it is programmed likewise.
</p>


<h3>Value</h3>

<p><code>nest</code> returns an object of class <code>nest</code>. The functions <code>summary</code> and <code>plot</code> are used to obtain and show a summary of the results.
</p>
<p>An object of class <code>nest</code> is a list containing the following components:
</p>

<ul>
<li> <p><code>nfactors</code> - The number of factors to retains (one by <code>alpha</code>).
</p>
</li>
<li> <p><code>cor</code> - The supplied correlation matrix.
</p>
</li>
<li> <p><code>n</code> - The number of cases (subjects, participants, or units).
</p>
</li>
<li> <p><code>values</code> - The eigenvalues of the supplied correlation matrix.
</p>
</li>
<li> <p><code>alpha</code> - The type I error rate.
</p>
</li>
<li> <p><code>method</code> - The method used to compute loadings and uniquenesses.
</p>
</li>
<li> <p><code>nrep</code> - The number of replications used.
</p>
</li>
<li> <p><code>prob</code> - Probabilities of each factor.
</p>
</li>
<li> <p><code>Eig</code> - A list of simulated eigenvalues.
</p>
</li>
</ul>
<h3>Generic function</h3>

<p><code>plot.nest</code> Scree plot of the eigenvalues and the simulated confidence intervals for <code>alpha</code>.
</p>
<p><code>loadings</code> Extract loadings. It does not overwrite <code>stat::loadings</code>.
</p>


<h3>Author(s)</h3>

<p>P.-O. Caron
</p>


<h3>References</h3>

<p>Achim, A. (2017). Testing the number of required dimensions in exploratory factor analysis. <em>The Quantitative Methods for Psychology</em>, <em>13</em>(1), 64-74. <a href="https://doi.org/10.20982/tqmp.13.1.p064">doi:10.20982/tqmp.13.1.p064</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">nest(ex_2factors, n = 100)
nest(mtcars)
</code></pre>


</div>