<div class="container">

<table style="width: 100%;"><tr>
<td>rkt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Mann Kendall test and Seasonal and Regional Kendall tests (SKT/RKT)
</h2>

<h3>Description</h3>

<p>Computes the Mann-Kendall test (MK) and the Seasonal and the Regional Kendall Tests for trend (SKT and RKT) and  Theil-Sen's slope estimator.<br>
When a covariable is defined, this function also computes partial RKT and SKT.<br>
To allow for non-regular sampling dates, input data should be vectors, not time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rkt(date, y, block, cv, correct = F, rep = "e")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>date</code></td>
<td>

<p>a mandatory vector of numerical data representing dates, as years or years+decimal. If correction for intra-block correlation is required, dates will be truncated to the year, and no more than one value per block per year will be considered. If two equal dates (or truncated dates) are found, the behaviour of the program is determined by rep
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a mandatory vector of measured data. In this vector, missing data are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>

<p>an optional vector of positive integer numbers representing blocks, i.e. sites, seasons or months, or a code combining both sites and seasons/months. If no blocks are defined, the result will be the Mann-Kendall test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>

<p>an optional vector containing a covariable, such as river flow or deposition amount. In this vector, missing data are allowed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>

<p>a boolean value. If correct is FALSE, no correction for correlation between blocks is performed. If correct is TRUE, dates are truncated and the correction for correlation between blocks is performed. Note that the truncation is performed in any case, while the correction is performed only if there are more than one block, and more than nine years of data. Default value is FALSE.	
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>

<p>a character value. If rep is set to "a", data sharing the same date (or truncated date if correct is TRUE) are averaged. If rep is set to "m", their median is used. For any other value of rep, an error is produced if two or more data share the same date (or truncated date if correct is TRUE). The latter is the default behaviour of the program.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The MK test for trend analysis was first proposed by Mann (1945).<br>
Hirsch et al. (1982) derived SKT for trend analysis of monthly data in a single site using seasons as the blocking variable, and Helsel and Franse (2006) extended it to a regional test using sites as the blocking variable (RKT).<br>
The correction for correlation among blocks was introduced by Hirsch &amp; Slack (1984), and the partial test was proposed by Libiseller &amp; Grimvall (2002).<br>
At least 4 data are required for each block.<br>
Correction for correlation between blocks is not performed if less than 10 years of data are available.<br>
If correct is FALSE, data are not required to be sampled monthly or yearly.<br></p>


<h3>Value</h3>

<p>A list with class rkt is returned with the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sl </code></td>
<td>
<p>two sided p-value 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S </code></td>
<td>
<p>Kendall's score
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B </code></td>
<td>
<p>Theil-Sen's slope for MK, Seasonal (or Regional) Kendall Slope estimator for SKT and RKT
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varS </code></td>
<td>
<p>variance of S
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sl.corrected </code></td>
<td>
<p>two sided p-value, after correction for intra-block correlation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varS.corrected </code></td>
<td>
<p>variance of S, after correction for intra-block correlation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.S </code></td>
<td>
<p>partial Kendall's score, if a covariable is present
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.sl </code></td>
<td>
<p>two sided p-value of the partial test, if a covariable is present
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.varS </code></td>
<td>
<p>partial variance of S, if a covariable is present
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.sl.corrected </code></td>
<td>
<p>two sided p-value of the partial test, after correction for intra-block correlation, if a covariable is present
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.varS.corrected </code></td>
<td>
<p>partial variance of S, after correction for intra-block correlation, if a covariable is present
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau </code></td>
<td>
<p>Kendall tau 
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>All items are returned in any case. When a test is not performed, relative items are set to NA.<br>
To consider data sharing the same dates as ties in the time domain, please use Kendall function in the Kendall package.<br>
For time series with multiple detection limits, please refer to the NADA package.
</p>


<h3>Author(s)</h3>

<p>Aldo Marchetto &lt;aldo.marchetto@cnr.it&gt;
</p>


<h3>References</h3>

<p>Helsel D.R., Frans L.M. 2006 The regional Kendall test for trend: Environmental Science and Technology <b>40</b>, 4066–4073<br><br>
Helsel D.R., Mueller D.K., Slack J.R. 2006 <em>Computer program for the Kendall family of trend tests</em> U.S. Geological Survey Scientific Investigations Report 2005-5275, 4 pp.<br><br>
Hirsch R.M., Slack J.R., Smith R.A. Techniques of trend ananlyis for monthly water quality data. Water Resources Research <b>18</b>, 107-121<br><br>
Hirsch R.M., Slack J.R. 1984 A nonparametric test for seasonal data with serial dependance. Water Resources Research <b>20</b>, 727-732<br><br>
Libiseller C., Grimvall A. 2002 Perfomance of partial Mann-Kendall tests for trend detection in the presence of covariates. Environmetrics <b>13</b>, 71-84<br><br>
Mann H.B. 1945. Nonparametric tests against trend. Econometrica <b>13</b>, 245-249
Marchetto A., Rogora M., Arisci S. 2013 Trend analysis of atmospheric deposition data: a comparison of statistical approaches. Atmospheric Environment <b>64</b>, 95–102<br><br></p>


<h3>See Also</h3>

<p>print.rkt
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# monthly data
#
data(pie1)
ex&lt;-rkt(pie1$Year,pie1$SO4,pie1$Month,pie1$mm,TRUE)
print(ex)
#
# weekly data, no intrablock correction
#

data(pie1w)
ex&lt;-rkt(pie1w$Date,pie1w$SO4)
print(ex)
#
# monthly data, hydrological years (oct-sep) as in USGS program
#
data(pie1)
ex&lt;-rkt(pie1$Year+floor(pie1$Month/10),pie1$SO4,pie1$Month,,TRUE)
print(ex)
</code></pre>


</div>