<div class="container">

<table style="width: 100%;"><tr>
<td>likelihood_t_MC_geog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Likelihood of a dataset under the matching competition model with biogeography.
</h2>

<h3>Description</h3>

<p>Computes the likelihood of a dataset under the matching competition model with specified <code>sigma2</code> and <code>S</code> values and with a <code>geography.object</code> formed using <code>CreateGeoObject</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">likelihood_t_MC_geog(phylo, data, par,geo.object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
  
<p>an object of type 'phylo' (see ape documentation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a named vector of continuous data with names corresponding to <code>phylo$tip.label</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>a vector listing a value for <code>log(sig2)</code> (see Note) and <code>S</code> (parameters of the matching competition model), in that order
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geo.object</code></td>
<td>

<p>a geography object indicating sympatry through time, created using <code>CreateGeoObject</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When specifying <code>par</code>, <code>log(sig2)</code> must be listed before <code>S</code>.
</p>


<h3>Value</h3>

<p>the negative log-likelihood value of the dataset (accordingly, the negative of the output should be recorded as the likelihood), given the phylogeny, <code>sig2</code> and <code>S</code> values, and <code>geography.object</code>.
</p>


<h3>Note</h3>

<p>S must be negative (if it is positive, the likelihood function will multiply input by -1).
</p>
<p>To stabilize optimization, this function exponentiates the input <code>sig2</code> value, thus the user must input the log(sig2) value to compute the correct log likelihood (see example).
</p>


<h3>Author(s)</h3>

<p>Jonathan Drury <a href="mailto:jonathan.p.drury@gmail.com">jonathan.p.drury@gmail.com</a>
</p>
<p>Julien Clavel
</p>


<h3>References</h3>

<p>Drury, J., Clavel, J., Manceau, M., and Morlon, H. 2016. Estimating the effect of competition on trait evolution using maximum likelihood inference. <em>Systematic Biology</em> doi 10.1093/sysbio/syw020
</p>
<p>Nuismer, S. &amp; Harmon, L. 2015. Predicting rates of interspecific interaction from phylogenetic trees. <em>Ecology Letters</em> 18:17-27.
</p>


<h3>See Also</h3>

<p><code>fit_t_comp</code>
<code>CreateGeoObject</code>
<code>likelihood_t_MC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Anolis.data)
phylo &lt;- Anolis.data$phylo
pPC1 &lt;- Anolis.data$data
geography.object &lt;-  Anolis.data$geography.object

# Compute the likelihood with geography using ML parameters for fit without geography
par &lt;- c(0.0003139751, -0.06387258)
lh &lt;- -likelihood_t_MC_geog(phylo,pPC1,par,geography.object)
</code></pre>


</div>