<div class="container">

<table style="width: 100%;"><tr>
<td>rasterListFun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Execution of the elements of a <code>RasterList</code>
</h2>

<h3>Description</h3>

<p>This fuction transmors a generic  <code>RasterList-class</code> object into another <code>RasterList-class</code> object where elemets are all <code>function</code>-type.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rasterListFun(object)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object to be coerced to <code>RasterList-class</code></p>
</td>
</tr></table>
<h3>Value</h3>

<p>This function works with <code>RasterList-class</code>  objects in which all elements of <code>object@list</code> slot are functions. It returns a "global" function that works at "raster" scale. The returned function will have the following usage signature: <code>fun(xval,...)</code> where one <code>xval</code> (if its lengths is different from 1) element is the applied to each element and ... are further common arguments.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(sp)
library(rasterList)
library(soilwater)
set.seed(1234)
data(meuse.grid)
data(meuse)
coordinates(meuse.grid) &lt;- ~x+y
coordinates(meuse) &lt;- ~x+y
gridded(meuse.grid) &lt;- TRUE


soilmap &lt;- stack(meuse.grid)[['soil']]
elevmap &lt;- rasterize(x=meuse,y=soilmap,field="elev",fun=mean)
soilparcsv &lt;- system.file("external/soil_data.csv",package="soilwater")
soilpar &lt;- read.table(soilparcsv,stringsAsFactors=FALSE,header=TRUE,sep=",")
## From help(meuse,help_type="html")
##soil type according to the 1:50 000 soil map of the Netherlands. 
## 1 = Rd10A (Calcareous weakly-developed meadow soils, light sandy clay); 
## 2 = Rd90C/VII (Non-calcareous weakly-developed meadow soils, heavy sandy clay to light clay); 
## 3 = Bkd26/VII (Red Brick soil, fine-sandy, silty light clay)
soiltype_id &lt;- c(1,2,3)
soiltype_name &lt;- c("sandy clay","sandy clay","silty clay loam")

meuse.soilrasterlist &lt;- rasterList(soilmap,FUN=function(i,soiltype_name,soilpar){
			
		o &lt;- NULL
		if (!is.na(i)) {
			ii &lt;- which(soilpar$type==soiltype_name[i])	
		    o &lt;- soilpar[ii,]				
			type &lt;- o[["type"]]
			o &lt;- o[names(o)!="type"]
			o &lt;- o[names(o)!="Ks_m_per_hour"]
			names(o)[names(o)=="Ks_m_per_sec"] &lt;- "ks"
			names(o)[names(o)=="swc"] &lt;- "theta_sat"
			names(o)[names(o)=="rwc"] &lt;- "theta_res"
			attr(o,"type") &lt;- type
			## add noise
			noise &lt;- rnorm(length(o))
			o &lt;- o*(1+0.005*noise)
				
			o["m"] &lt;- 1-1/o["n"]
				
				
		} else {
				
			o &lt;- soilpar[which(soilpar$type==soiltype_name[1]),]
			type &lt;- o[["type"]]
			o &lt;- o[names(o)!="type"]
			o &lt;- o[names(o)!="Ks_m_per_hour"]
			names(o)[names(o)=="Ks_m_per_sec"] &lt;- "ks"
			names(o)[names(o)=="swc"] &lt;- "theta_sat"
			names(o)[names(o)=="rwc"] &lt;- "theta_res"
			o[] &lt;- NA
		}
			
		return(o)
},soiltype_name=soiltype_name,soilpar=soilpar)


meuse.swclist &lt;- rasterList(meuse.soilrasterlist,FUN=function(x) {
			
			o &lt;- NA
##			swc       rwc   alpha       n         m           ks
##			9 0.4295507 0.1093227 3.39387 1.39617 0.2837546 2.018317e-07
		
			
			o &lt;- function(psi,...,func="swc"){
				
				args &lt;- c(list(psi=psi,...),as.list(x))
				oo &lt;- do.call(args=args,what=get(func))
				return(oo)
				
			}
			
			
			
			
			
			
			
			return(o)
			
		})


### RasterList with soil water retenction curves (One for each cell!) 

swcfunr &lt;- rasterListFun(meuse.swclist)

## RasterLayer of soil water content assuming a uniformly distrrubted pressure head 
psi &lt;- -0.9
soil_water_content &lt;- raster(swcfunr(psi))
plot(soil_water_content)

## RasterLayer of soil water content from  a generic map of soil water pressure head
psi &lt;- 0.2-(elevmap-(5))
psi[] &lt;- -0.9+0.1*rnorm(ncell(psi[])) ## Alternatively to the values of the previous line!
soil_water_content &lt;- raster(swcfunr(psi))
plot(soil_water_content)

## END 


</code></pre>


</div>