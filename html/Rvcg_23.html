<div class="container">

<table style="width: 100%;"><tr>
<td>vcgClost</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Project coordinates onto a target triangular surface mesh.</h2>

<h3>Description</h3>

<p>For a set of 3D-coordinates/triangular mesh, the closest matches on a
target surface are determined and normals at as well as distances to
that point are calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcgClost(
  x,
  mesh,
  sign = TRUE,
  barycentric = FALSE,
  smoothNormals = FALSE,
  borderchk = FALSE,
  tol = 0,
  facenormals = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>k x 3 matrix containing 3D-coordinates or object of class "mesh3d".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mesh</code></td>
<td>
<p>triangular surface mesh stored as object of class "mesh3d".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign</code></td>
<td>
<p>logical: if TRUE, signed distances are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barycentric</code></td>
<td>
<p>logical: if TRUE, barycentric coordinates of the hit
points are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothNormals</code></td>
<td>
<p>logical: if TRUE, laplacian smoothed normals are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>borderchk</code></td>
<td>
<p>logical: request checking if the hit face is at the border of the mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>maximum distance to search. If distance is beyond that, the original point will be kept and the distance set to NaN. If tol = 0, tol is set to 2*diagonal of the bounding box of <code>mesh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facenormals</code></td>
<td>
<p>logical: if TRUE only the facenormal of the face the closest point has hit is returned, the weighted average of the surrounding vertex normals otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters, currently unused.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>returns an object of class "mesh3d" with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>vb </code></td>
<td>
<p>4 x n matrix containing n vertices as homolougous coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normals </code></td>
<td>
<p>4 x n matrix containing vertex normals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quality </code></td>
<td>
<p>numeric vector containing distances to target.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it </code></td>
<td>
<p>3 x m integer matrix containing vertex indices forming triangular
faces.Only available, when x is a mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border </code></td>
<td>
<p>integer vector of length n: if borderchk = TRUE, for each clostest point the value will be 1 if the hit face is at the border of the target mesh and 0 otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barycoords </code></td>
<td>
<p>3 x m Matrix containing barycentric coordinates of
closest points; only available if barycentric=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faceptr </code></td>
<td>
<p>vector of face indeces on which the closest points are located</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If large part of the reference mesh are far away from the target
surface, calculation can become very slow. In that case, the function
<code>vcgClostKD</code> will be significantly faster.
</p>


<h3>Author(s)</h3>

<p>Stefan Schlager
</p>


<h3>References</h3>

<p>Baerentzen, Jakob Andreas. &amp; Aanaes, H., 2002. Generating Signed
Distance Fields From Triangle Meshes. Informatics and Mathematical
Modelling.
</p>


<h3>See Also</h3>

<p><code>vcgPlyRead</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(humface)
clost &lt;- vcgClost(humface.lm, humface)




</code></pre>


</div>