<div class="container">

<table style="width: 100%;"><tr>
<td>adapt_proposal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adapt the proposal distribution of MCMC using the covariance
of samples</h2>

<h3>Description</h3>

<p>This function takes the provided <code>libbi</code> object and
runs MCMC, adapting the proposal distribution until the desired
acceptance rate is achieved. If a scale is given, it will be used
to adapt the proposal at each iteration
</p>


<h3>Usage</h3>

<pre><code class="language-R">adapt_proposal(
  x,
  min = 0,
  max = 1,
  scale = 2,
  max_iter = 10,
  adapt = c("size", "shape", "both"),
  size = FALSE,
  correlations = TRUE,
  truncate = TRUE,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>link{libbi}</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min</code></td>
<td>
<p>minimum acceptance rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>maximum acceptance rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>scale multiplier/divider for the proposal. If &gt;1 this
will be inverted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>maximum of iterations (default: 10)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt</code></td>
<td>
<p>what to adapt; if "size" (default), the width of independent
proposals will be adapted; if "shape", proposals will be dependent
(following a multivariate normal) taking into account empirical
correlations; if "both", the size will be adapted
before the shape</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>(deprecated, use <code>{adapt}</code> instead) if TRUE (default:
FALSE), the size of the (diagonal multivariate normal) proposal
distribution will be adapted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlations</code></td>
<td>
<p>(deprecated, use <code>{adapt}</code> instead) if TRUE
(default: FALSE), the shape of the (diagonal multivariate normal) proposal
distribution will be adapted according to the empirical covariance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>
<p>if TRUE, the proposal distributions will be truncated
according to the support of the prior distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>if set to TRUE, will not provide running output of particle
numbers tested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>parameters for <code>sample</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>libbi</code> with the desired proposal distribution
</p>


<h3>Examples</h3>

<pre><code class="language-R">example_obs &lt;- rbi::bi_read(system.file(package="rbi", "example_dataset.nc"))
example_model &lt;- rbi::bi_model(system.file(package="rbi", "PZ.bi"))
example_bi &lt;- rbi::libbi(model = example_model, obs = example_obs)
obs_states &lt;- rbi::var_names(example_model, type="obs")
max_time &lt;- max(vapply(example_obs[obs_states], function(x) {
  max(x[["time"]])
}, 0))
# adapt to acceptance rate between 0.1 and 0.5
## Not run: 
  adapted &lt;- adapt_proposal(example_bi,
    nsamples = 100, end_time = max_time,
    min = 0.1, max = 0.5, nparticles = 256, correlations = TRUE
  )

## End(Not run)
</code></pre>


</div>