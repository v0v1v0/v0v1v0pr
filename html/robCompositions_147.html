<div class="container">

<table style="width: 100%;"><tr>
<td>smoothSplinesVal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate density from histogram - for different <code>alpha</code>
</h2>

<h3>Description</h3>

<p>As <code>smoothSplines</code>, <code>smoothSplinesVal</code> computes the density function that 'best' fits
discretized distributional data, using B-spline basis functions, for different <code>alpha</code>. <br>
Comparing and choosing an appropriate <code>alpha</code> is the ultimate goal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smoothSplinesVal(
  k,
  l,
  alpha,
  data,
  xcp,
  knots,
  weights = matrix(1, dim(data)[1], dim(data)[2]),
  prior = "default",
  cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>smoothing splines degree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>order of derivative in the penalization term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>vector of weights for penalization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class "matrix" containing data to be smoothed, row by row</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcp</code></td>
<td>
<p>vector of control points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>either vector of knots for the splines or a integer for the number of equispaced knots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>matrix of weights. If not gives, all data points will be weighted the same.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>prior used for zero-replacements. This must be one of "perks", "jeffreys", "bayes_laplace", "sq" or "default"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>number of cores for parallel execution</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>smoothSplines</code> for the description of the algorithm.
</p>


<h3>Value</h3>

<p>A list of three objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the values of <code>alpha</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>the values of the functional evaluated in the minimizing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV-error</code></td>
<td>
<p>the values of the leave-one-out CV-error</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alessia Di Blasi, Federico Pavone, Gianluca Zeni, Matthias Templ
</p>


<h3>References</h3>

<p>J. Machalova, K. Hron &amp; G.S. Monti (2016):
Preprocessing of centred logratio transformed density functions
using smoothing splines. Journal of Applied Statistics, 43:8, 1419-1435.
</p>


<h3>Examples</h3>

<pre><code class="language-R">SepalLengthCm &lt;- iris$Sepal.Length
Species &lt;- iris$Species

iris1 &lt;- SepalLengthCm[iris$Species==levels(iris$Species)[1]]
h1 &lt;- hist(iris1, nclass = 12, plot = FALSE)

## Not run: 
midx1 &lt;- h1$mids
midy1 &lt;- matrix(h1$density, nrow=1, ncol = length(h1$density), byrow=TRUE)
knots &lt;- 7
sol1 &lt;- smoothSplinesVal(k=3,l=2,alpha=10^seq(-4,4,by=1),midy1,midx1,knots,cores=1)

## End(Not run)
</code></pre>


</div>