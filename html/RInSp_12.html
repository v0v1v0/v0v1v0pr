<div class="container">

<table style="width: 100%;"><tr>
<td>PSicalc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the proportional similarity index</h2>

<h3>Description</h3>

<p>A measure of individual specialization proposed by Bolnick et al. (2003), based on the average pairwise overlap of the niche distribution of individuals and the population.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PSicalc(dataset, pop.diet = "sum", exclude = FALSE, replicates=999, precision = 1e-9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Object of class RInSp with data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.diet</code></td>
<td>
<p>Option specifying the way to calculate the population diet. Valid values are “sum” or “average”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>A logical value to exclude or not the individual in variance estimates. Defalut is FALSE, i.e. keep all individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>Number of replicates for Monte Carlo resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>a filter to remove from the PS matrix all values which are lower than "precision". In this way some interactions are removed due to their small weight in the PS matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Both Schoener (1968) and Feinsinger et al. (1981) advocated using Czekanowski's proportional similarity index (PS) for interspecific niche studies. Adapted to individual-level analyses, the diet overlap between an individual and the population is:
</p>
<p style="text-align: center;"><code class="reqn"> PS_i = 1 - 0.5 \sum_j{|p_{ij} - q_j|} </code>
</p>

<p>where <code class="reqn">p_{ij}</code> is the frequency of category j in the individual i's diet, and <code class="reqn">q_j</code>  is the frequency of category j in the population as a whole.
The prevalence of individual specialization (IS) in the population is then measured by the average of individuals' PS values:
</p>
<p style="text-align: center;"><code class="reqn">IS = \frac{\sum_i(PS_i)}{N}</code>
</p>

<p>Monte Carlo resampling for hypothesis testing is implemented for the case when all individuals are kept.
</p>
<p>The user has the option of calculating each individual's <code class="reqn">PS_i</code> and <code class="reqn">Var(PS_i)</code> using <code class="reqn">q_j</code> values calculated by either including or excluding individual i.</p>


<h3>Value</h3>

<p>The function returns a list composed by:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>PSi</code></td>
<td>
<p>A column vector with the individual proportional similarity index for each individual i.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IS</code></td>
<td>
<p>The value of the prevalence of individual specialization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSi.montecarlo</code></td>
<td>
<p>Monte Carlo resampling simulation values for <code class="reqn">PS_i</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.montecarlo</code></td>
<td>
<p>Monte Carlo resampling simulation values for <code class="reqn">PS_i</code>'s variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarPSi</code></td>
<td>
<p>A column vector of the estimated variance for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population.diet</code></td>
<td>
<p>A vector describing the population diet. A matrix is returned when “exclude” is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IS.pvalue</code></td>
<td>
<p>Probability value for the observed IS against the Monte Carlo resampling simulation. Consider to use more than 1000 simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>montecarlo</code></td>
<td>
<p>Monte Carlo resampling simulation values for <code class="reqn">PS_i</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.individuals</code></td>
<td>
<p>The number of individuals of the data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parmeter</code></td>
<td>
<p>The value points to the column of the “montecarlo” matrix for plotting results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Precission</code></td>
<td>
<p>The value of the selected threshold for precision.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>References</h3>

<p>Bolnick, D.I., L.H. Yang, J.A. Fordyce, J.M. Davis, and Svanback, R. 2002. Measuring individual-level resource specialization. <em>Ecology</em> <b>83</b>: 2936-2941.
</p>
<p>Feinsinger, P., Spears, E. E., and Poole, R. W. 1981. A simple measure of niche breadth. <em>Ecology</em>  <b>62</b>: 27-32.
</p>
<p>Schoener, T.W. 1968. The <em>Anolis</em> lizards of Bimini: resource partitioning in a complex fauna. <em>Ecology</em> <b>49</b>: 704-726.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># PSicalc example using stickleback data from Bolnick and Paull 2009
data(Stickleback)
# Select a single spatial sampling site (site A)
GutContents_SiteA &lt;- import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "A"))
# Warning, the number of replicates is set low to speed up he example!
# Note, for real analyses we recommend to set replicates =&gt; 999
PSi &lt;- PSicalc(GutContents_SiteA, exclude = FALSE, replicates = 99)
sumMC.RInSp(PSi)
rm(list=ls(all=TRUE))
</code></pre>


</div>