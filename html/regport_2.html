<div class="container">

<table style="width: 100%;"><tr>
<td>REGModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 class representing a regression model</h2>

<h3>Description</h3>

<p>Contains fields storing data and methods to build, process and visualize
a regression model.
Currently, this class is designed for CoxPH and GLM regression models.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>data</code></dt>
<dd>
<p>a <code>data.table</code> storing modeling data.</p>
</dd>
<dt><code>recipe</code></dt>
<dd>
<p>an R <code>formula</code> storing model formula.</p>
</dd>
<dt><code>terms</code></dt>
<dd>
<p>all terms (covariables, i.e. columns) used for building model.</p>
</dd>
<dt><code>args</code></dt>
<dd>
<p>other arguments used for building model.</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>a constructed model.</p>
</dd>
<dt><code>type</code></dt>
<dd>
<p>model type (class).</p>
</dd>
<dt><code>result</code></dt>
<dd>
<p>model result, a object of <code>parameters_model</code>. Can be converted into
data.frame with <code>as.data.frame()</code> or <code>data.table::as.data.table()</code>.</p>
</dd>
<dt><code>forest_data</code></dt>
<dd>
<p>more detailed data used for plotting forest.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>REGModel$new()</code></a>
</p>
</li>
<li> <p><a href="#method-get_forest_data"><code>REGModel$get_forest_data()</code></a>
</p>
</li>
<li> <p><a href="#method-plot_forest"><code>REGModel$plot_forest()</code></a>
</p>
</li>
<li> <p><a href="#method-plot"><code>REGModel$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-print"><code>REGModel$print()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>REGModel$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Build a <code>REGModel</code> object.
</p>


<h5>Usage</h5>

<div class="r"><pre>REGModel$new(
  data,
  recipe,
  ...,
  f = c("coxph", "binomial", "gaussian", "Gamma", "inverse.gaussian", "poisson",
    "quasi", "quasibinomial", "quasipoisson"),
  exp = NULL,
  ci = 0.95
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>data</code></dt>
<dd>
<p>a <code>data.table</code> storing modeling data.</p>
</dd>
<dt><code>recipe</code></dt>
<dd>
<p>an R <code>formula</code> or a list with two elements 'x' and 'y',
where 'x' is for covariables and 'y' is for label. See example for detail
operation.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>other parameters passing to corresponding regression model function.</p>
</dd>
<dt><code>f</code></dt>
<dd>
<p>a length-1 string specifying modeling function or family of <code>glm()</code>, default is 'coxph'.
Other options are members of GLM family, see <code>stats::family()</code>.
'binomial' is logistic, and 'gaussian' is linear.</p>
</dd>
<dt><code>exp</code></dt>
<dd>
<p>logical, indicating whether or not to exponentiate the the coefficients.</p>
</dd>
<dt><code>ci</code></dt>
<dd>
<p>confidence Interval (CI) level. Default to 0.95 (95%).
e.g. <code>survival::coxph()</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>a <code>REGModel</code> R6 object.
</p>


<hr>
<a id="method-get_forest_data"></a>



<h4>Method <code>get_forest_data()</code>
</h4>

<p>get tidy data for plotting forest.
</p>


<h5>Usage</h5>

<div class="r"><pre>REGModel$get_forest_data(separate_factor = FALSE, global_p = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>separate_factor</code></dt>
<dd>
<p>separate factor/class as a blank row.</p>
</dd>
<dt><code>global_p</code></dt>
<dd>
<p>if <code>TRUE</code>, return global p value.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plot_forest"></a>



<h4>Method <code>plot_forest()</code>
</h4>

<p>plot forest.
</p>


<h5>Usage</h5>

<div class="r"><pre>REGModel$plot_forest(ref_line = NULL, xlim = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>ref_line</code></dt>
<dd>
<p>reference line, default is <code>1</code> for HR.</p>
</dd>
<dt><code>xlim</code></dt>
<dd>
<p>limits of x axis.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>other plot options passing to <code>forestploter::forest()</code>.
Also check <a href="https://github.com/adayim/forestploter">https://github.com/adayim/forestploter</a> to see more complex adjustment of the result plot.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plot"></a>



<h4>Method <code>plot()</code>
</h4>

<p>print the <code>REGModel$result</code> with default plot methods from <strong>see</strong> package.
</p>


<h5>Usage</h5>

<div class="r"><pre>REGModel$plot(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>other parameters passing to <code>plot()</code> in <code>see:::plot.see_parameters_model</code> function.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>print the <code>REGModel</code> object
</p>


<h5>Usage</h5>

<div class="r"><pre>REGModel$print(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>unused.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>REGModel$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">library(survival)
test1 &lt;- data.frame(
  time = c(4, 3, 1, 1, 2, 2, 3),
  status = c(1, 1, 1, 0, 1, 1, 0),
  x = c(0, 2, 1, 1, 1, 0, 0),
  sex = c(0, 0, 0, 0, 1, 1, 1)
)
test1$sex &lt;- factor(test1$sex)

# --------------
# Build a model
# --------------

# way 1:
mm &lt;- REGModel$new(
  test1,
  Surv(time, status) ~ x + strata(sex)
)
mm
as.data.frame(mm$result)
if (require("see")) mm$plot()
mm$print() # Same as print(mm)

# way 2:
mm2 &lt;- REGModel$new(
  test1,
  recipe = list(
    x = c("x", "strata(sex)"),
    y = c("time", "status")
  )
)
mm2

# Add other parameters, e.g., weights
# For more, see ?coxph
mm3 &lt;- REGModel$new(
  test1,
  recipe = list(
    x = c("x", "strata(sex)"),
    y = c("time", "status")
  ),
  weights = c(1, 1, 1, 2, 2, 2, 3)
)
mm3$args

# ----------------------
# Another type of model
# ----------------------
library(stats)
counts &lt;- c(18, 17, 15, 20, 10, 20, 25, 13, 12)
outcome &lt;- gl(3, 1, 9)
treatment &lt;- gl(3, 3)
data &lt;- data.frame(treatment, outcome, counts)

mm4 &lt;- REGModel$new(
  data,
  counts ~ outcome + treatment,
  f = "poisson"
)
mm4
mm4$plot_forest()
mm4$get_forest_data()
mm4$plot_forest()
</code></pre>


</div>