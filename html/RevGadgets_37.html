<div class="container">

<table style="width: 100%;"><tr>
<td>simulateMRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulates a single Markov random field trajectory.</h2>

<h3>Description</h3>

<p>This function simulates a draw from a HSMRF or GMRF distribution given a
user-specified global scale parameter. The MRF can be taken to be on the
log-scale (such as for a birth rate) or the real-scale. The first value
must be specified
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulateMRF(
  n_episodes,
  model,
  global_scale_hyperprior,
  initial_value = NULL,
  exponentiate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_episodes</code></td>
<td>
<p>(numeric; no default) The number of episodes in the random
field (the parameter vector will be this long).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>(character; no default) What model should the global scale
parameter be set for? Options are "GMRF" and "HSMRF".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global_scale_hyperprior</code></td>
<td>
<p>(numeric; no default) The hyperprior on the
global scale parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_value</code></td>
<td>
<p>(numeric; NULL) The first value in the MRF. If no value
is specified, the field is assumed to start at 0 (if exponentiate=FALSE) or
1 (if exponentiate=TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exponentiate</code></td>
<td>
<p>(logical; TRUE) If TRUE, the MRF model is taken to be on
the log-scale and the values are returned on the real-scale (note this means
that the specified initial value will be the log of the true initial value).
If FALSE, the model is taken to be on the real scale.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector drawn from the specified MRF model on the specified
(log- or real-) scale.
</p>


<h3>References</h3>

<p>Magee et al. (2020) Locally adaptive Bayesian birth-death model
successfully detects slow and rapid rate shifts.
<em>PLoS Computational Biology</em>, <b>16 (10)</b>: e1007999.
</p>
<p>Faulkner, James R., and Vladimir N. Minin. Locally adaptive smoothing with
Markov random fields and shrinkage priors.
<em>Bayesian analysis</em>, <b>13 (1)</b>, 225.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulate a 100-episode HSMRF model for a speciation-rate through time
trajectory &lt;- simulateMRF(n_episodes = 100,
                          model = "HSMRF",
                          global_scale_hyperprior = 0.0021)
plot(1:100,
     rev(trajectory),
     type = "l",
     xlab = "time",
     ylab = "speciation rate")

</code></pre>


</div>