<div class="container">

<table style="width: 100%;"><tr>
<td>mergespec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectral merging of a coarse field and of a fine field at a given wavenumber</h2>

<h3>Description</h3>

<p>The input fields are transformed to Fourier space,
their Fourier spectra are merged at wavenumber <code>kmax</code> after adapting the
variance of the fine field and an inverse Fourier transform is performed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mergespec(ra, r, kmax = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ra</code></td>
<td>
<p>matrix containing a coarse field of size <code>c(nas, nas)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>matrix containing a field at higher resolution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>
<p>wavenumber to use for merging (default <code>nas/2</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The merged field, in physical space.
</p>


<h3>Author(s)</h3>

<p>Jost von Hardenberg, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Make a coarse field with power-law Fourier spectrum 
fa &lt;- initmetagauss(1.7, 8)
ra &lt;- metagauss(fa)
# Make a fine power-law Fourier spectrum
f &lt;- initmetagauss(1.7, 32)
r &lt;- metagauss(f)
# Merge the two fields in spectral space
rm &lt;- mergespec(ra, r, kmax = 4)
# Check spectral slope of the resulting field
fx &lt;- fft2d(rm)
fitslope(fx)
# 1.678554
</code></pre>


</div>