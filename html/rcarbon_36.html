<div class="container">

<table style="width: 100%;"><tr>
<td>plot.stackCalSPD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a stack of SPDs</h2>

<h3>Description</h3>

<p>Visualises multiple SPDs grouped as a <code>stackCalSPD</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'stackCalSPD'
plot(
  x,
  type = "stacked",
  calendar = "BP",
  spdnormalised = FALSE,
  rescale = FALSE,
  runm = NA,
  xlim = NA,
  ylim = NA,
  xaxt = "s",
  yaxt = "s",
  gapFactor = 0.2,
  col.fill = NA,
  col.line = NA,
  lwd.obs = 1,
  lty.obs = 1,
  cex.lab = 1,
  cex.axis = cex.lab,
  legend = TRUE,
  legend.arg = NULL,
  ylab = NA,
  ymargin = 1.1,
  rnd = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>stackCalSPD</code> class object. Result of <code>stackspd</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>How to display the SPDs.Current options are <code>'stacked'</code>,<code>'lines'</code>, '<code>'proportion'</code>. and <code>'multipanel'</code>. Default is <code>'stacked'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calendar</code></td>
<td>
<p>Either <code>'BP'</code> or <code>'BCAD'</code>. Indicate whether the calibrated date should be displayed in BP or BC/AD. Default is  <code>'BP'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spdnormalised</code></td>
<td>
<p>A logical variable indicating whether the total probability mass of the SPDs are normalised to sum to unity. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>A logical variable indicating whether the summed probabilities values should be rescaled to range 0 to 1. Default is FALSE.Notice that this is different from setting <code>spdnormalised</code> to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runm</code></td>
<td>
<p>A number indicating the window size of the moving average to smooth the SPD. If set to <code>NA</code> no moving average is applied. Default is NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>the x limits of the plot. In BP or in BC/AD depending on the choice of the parameter <code>calender</code>. Notice that if BC/AD is selected BC ages should have a minus sign (e.g. <code>c(-5000,200)</code> for 5000 BC to 200 AD).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxt</code></td>
<td>
<p>Whether the x-axis tick marks should be displayed (<code>xaxt='s'</code>, default) or not (<code>xaxt='n'</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxt</code></td>
<td>
<p>Whether the y-axis tick marks should be displayed (<code>xaxt='s'</code>, default) or not (<code>xaxt='n'</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gapFactor</code></td>
<td>
<p>Defines spacing between SPDs as proportion of the y-axis range for multipanel plots. Default is 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.fill</code></td>
<td>
<p>Vector of fill color for the observed SPDs. The default color scheme is based on the Dark2 pallette of RColorBrewer package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.line</code></td>
<td>
<p>Line colour for the observed SPDs.The default color scheme is based on the Dark2 palette of RColorBrewer package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.obs</code></td>
<td>
<p>Line width for the observed SPDs. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.obs</code></td>
<td>
<p>Line type for the observed SPDs. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>The magnification to be used for x and y  labels relative to the current setting of cex. Default is adjusted to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation relative to the current setting of cex. Default is adjusted to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Whether legend needs to be displayed. Item names will be retrieved from the values supplied in the argument <code>group</code> in <code>stackspd</code>. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.arg</code></td>
<td>
<p>list of additional arguments to pass to <code>legend</code>; names of the list are used as argument names. Only used if <code>legend</code> is set to TRUE. If supplied legend position must be given (e.g. <code>legend.arg=list(x='bottomright')</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a title for the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymargin</code></td>
<td>
<p>multiplier for the maximum value on ylim range. Default is 1.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd</code></td>
<td>
<p>integer indicating the number of decimal places to be displayed in the y-axis for when <code>type</code> is set "multitype".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments affecting the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The display order of the SPDs is given by the factor levels of the user-supplied <code>group</code> argument in the <code>stackspd()</code> function.
</p>


<h3>References</h3>

<p>Erich Neuwirth (2014). RColorBrewer: ColorBrewer Palettes. R package version 1.1-2. <a href="https://CRAN.R-project.org/package=RColorBrewer">https://CRAN.R-project.org/package=RColorBrewer</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(emedyd)
x = calibrate(x=emedyd$CRA, errors=emedyd$Error,normalised=FALSE)
bins = binPrep(sites=emedyd$SiteName, ages=emedyd$CRA,h=100)
res = stackspd(x=x,timeRange=c(16000,8000),bins=bins,group=emedyd$Region)
plot(res,type='stacked')
plot(res,type='lines')
plot(res,type='proportion')
plot(res,type='multipanel')

## End(Not run)
</code></pre>


</div>