<div class="container">

<table style="width: 100%;"><tr>
<td>odis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Orthogonal distances from a PCA or PLS score space</h2>

<h3>Description</h3>

<p><code>odis</code> calculates the orthogonal distances (OD = "X-residuals") for a PCA or PLS model. OD is the Euclidean distance of a row observation to its projection to the score plan (see e.g. Hubert et al. 2005, Van Branden &amp; Hubert 2005, p. 66; Varmuza &amp; Filzmoser, 2009, p. 79).
</p>
<p>A distance cutoff is computed using a moment estimation of the parameters of a Chi-squared distribution for OD^2 (see Nomikos &amp; MacGregor 1995, and Pomerantzev 2008). In the function output, column <code>dstand</code>  is a standardized distance defined as <code class="reqn">OD / cutoff</code>. A value <code>dstand &gt; 1</code> can be considered as extreme.
</p>
<p>The cutoff for detecting extreme OD values is computed using a moment estimation of a Chi-squared distrbution for the squared distance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
odis(
    object, Xtrain, X = NULL, 
    nlv = NULL,
    rob = TRUE, alpha = .01
    )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A fitted model, output of a call to a fitting function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtrain</code></td>
<td>
<p>Training X-data that was used to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>New X-data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlv</code></td>
<td>
<p>Number of components (PCs or LVs) to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rob</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the moment estimation of the distance cutoff is robustified. This can be recommended after robust PCA or PLS on small data sets containing extreme values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Risk-<code class="reqn">I</code> level for defining the cutoff detecting extreme values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res.train</code></td>
<td>
<p>matrix with distance and a standardized distance calculated for Xtrain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>matrix with distance and a standardized distance calculated for X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>distance cutoff computed using a moment estimation of the parameters of a Chi-squared distribution for OD^2.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>M. Hubert, P. J. Rousseeuw, K. Vanden Branden (2005). ROBPCA: a new approach to robust principal components analysis. Technometrics, 47, 64-79.
</p>
<p>Nomikos, P., MacGregor, J.F., 1995. Multivariate SPC Charts for Monitoring Batch Processes. null 37, 41-59. https://doi.org/10.1080/00401706.1995.10485888
</p>
<p>Pomerantsev, A.L., 2008. Acceptance areas for multivariate classification derived by projection methods. Journal of Chemometrics 22, 601-609. https://doi.org/10.1002/cem.1147
</p>
<p>K. Vanden Branden, M. Hubert (2005). Robuts classification in high dimension based on the SIMCA method. Chem. Lab. Int. Syst, 79, 10-21. 
</p>
<p>K. Varmuza, P. Filzmoser (2009). Introduction to multivariate statistical analysis in chemometrics. CRC Press, Boca Raton.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 6 ; p &lt;- 4
Xtrain &lt;- matrix(rnorm(n * p), ncol = p)
ytrain &lt;- rnorm(n)
Xtest &lt;- Xtrain[1:3, , drop = FALSE] 

nlv &lt;- 3
fm &lt;- pcasvd(Xtrain, nlv = nlv)
odis(fm, Xtrain)
odis(fm, Xtrain, nlv = 2)
odis(fm, Xtrain, X = Xtest, nlv = 2)

</code></pre>


</div>