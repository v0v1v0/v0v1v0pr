<div class="container">

<table style="width: 100%;"><tr>
<td>rvn_rvi_process_diagrammer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Raven hydrologic process network using DiagrammeR</h2>

<h3>Description</h3>

<p>This routine takes a connections data from generated using rvn_rvi_connections()
and returns the connections information as a DiagrammeR object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rvn_rvi_process_diagrammer(
  rvi_conn,
  sv_omit = c("SNOW_DEPTH", "COLD_CONTENT", "PONDED_WATER/SNOW_LIQ", "NEW_SNOW",
    "SNOW_DEFICIT"),
  repel_force = 0.001,
  repel_iter = 2000,
  lbl_size = 0.5,
  lbl_height = 0.3,
  lbl_width = 1,
  pdfout = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rvi_conn</code></td>
<td>
<p>a list of connections and AliasTable, provided by <code>rvn_rvi_connections</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv_omit</code></td>
<td>
<p>character vector of state variables to omit from the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repel_force</code></td>
<td>
<p>numeric value indicating the 'force' with which the repel function will move labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repel_iter</code></td>
<td>
<p>the maximum number of iterations for the repel algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbl_size</code></td>
<td>
<p>estimated height of labels, used in repel algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbl_height</code></td>
<td>
<p>actual height of the labels (in inches)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbl_width</code></td>
<td>
<p>relative width of the labels (multiplier)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdfout</code></td>
<td>
<p>name of pdf file to save the network plot to, if null no PDF is generated</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses the output from the <code>rvn_rvi_connections</code> function to generate the plot
with the <code>DiagrammeR</code> library.
</p>
<p>Note that the output can be plotted using the <code>render_graph</code> function
in the DiagrammeR library. The outputted DiagrammeR object may also have aesthetics modified
with various commands from the
same library, if desired, as shown in the examples. The <code>rsvg</code> and <code>DiagrammeRsvg</code> packages
may be required to export to PDF with desired results,
but are not explicit dependencies of RavenR.
</p>
<p><code>sv_omit</code> is used to reduce the clutter in the process plot of state variables that
one may wish to omit from the plot.
</p>
<p>The function uses the functionality from <code>ggrepel</code> to repel labels from one another.
The degree of separation in the labels can be controlled by the <code>repel_force</code> and
<code>lbl_size</code> parameters (increasing either will increase the separation between labels).
The <code>repel_force</code> may range from approximately 1 to 1e-6. The <code>lbl_size</code> is a
relative estimate of the label height (default 0.5), which is used in estimating the label
size in the repel functionality. Providing a larger number will increase the perceived size
of the label in the repel functionality and tend towards more separation between labels, and
vice-versa. Both of these parameters may need to change depending on the plot size and number
of labels. The <code>lbl_height</code> and <code>lbl_width</code> parameters can be changed to affect
the height and relative width of the actual labels.
</p>
<p>The basic model structure outline is followed, but unrecognized state variables are plotted
on the left hand side of the plot (determined with internal RavenR function <code>rvn_rvi_process_layout</code>).
</p>


<h3>Value</h3>

<p><code>d1</code> returns DiagrammeR object. Also generates a .pdf file in working directory if
pdfplot argument is not <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><code>rvn_rvi_connections</code> to generate connections table from an rvi object
</p>
<p><code>rvn_rvi_process_ggplot</code> to generate the structure plot using ggplot.
</p>
<p>See also the <a href="https://raven.uwaterloo.ca/">Raven page</a>. Additional details on the
<code>DiagrammeR</code> package may be found on the <a href="https://github.com/rich-iannone/DiagrammeR">Github page</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">d1 &lt;- rvn_rvi_read(system.file("extdata","Nith.rvi", package="RavenR")) %&gt;%
  rvn_rvi_connections() %&gt;%
    rvn_rvi_process_diagrammer()

# plot diagram using the DiagrammeR package
library(DiagrammeR)

d1 %&gt;%
  render_graph()

# modify default plot attributes, plot
d1 %&gt;%
  select_nodes() %&gt;%
  set_node_attrs_ws(node_attr = fillcolor, value = "hotpink") %&gt;%
  select_edges() %&gt;%
  set_edge_attrs_ws(edge_attr = style, value = "dashed") %&gt;%
  set_edge_attrs_ws(edge_attr = penwidth, value = 2) %&gt;%
  render_graph()

</code></pre>


</div>