<div class="container">

<table style="width: 100%;"><tr>
<td>build.dist.struct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Build Distance Structure for Matching with Refined Balance
</h2>

<h3>Description</h3>

<p>This function computes rank-based Mahalanobis distances between treated and control units and returns an object suitable for use in the distance.structure argument of rcbalance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">build.dist.struct(z, X, exact = NULL, calip.option = "propensity",
calip.cov = NULL, caliper = 0.2, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>a vector of treatment and control indicators, 1 for treatment and 0 for control.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>a data frame or a numeric or logical matrix containing covariate information for treated and control units.  Its row count must be equal to the length of <code>z</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>

<p>an optional vector of the same length as <code>z</code>.  If this argument is specified, treated units will only be allowed to match to control units that have equal values in the corresponding indices of the exact vector.  For example, to match patients within hospitals only, one could set exact equal to a vector of hospital IDs for each patient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calip.option</code></td>
<td>
<p> one of <code>('propensity','user','none')</code>.
If 'propensity' is specified (the default option), the function estimates a propensity score via logistic regression of <code>z</code> on <code>X</code> and imposes a propensity score caliper.  If 'user' is specified, the user must provide a vector of values on which a caliper will be enforced using the <code>calip.cov</code> argument.  If 'none' is specified no caliper is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calip.cov</code></td>
<td>

<p>see <code>calip.option</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caliper</code></td>
<td>

<p>gives the size of the caliper when the user specifies the <code>calip.option</code> argument as 'propensity' or 'calip.cov'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>if <code>TRUE</code>, prints output describing specific adjustments made in creating the distance objects.  	
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>X</code> is a data frame and contains any character variables they are converted to factors with a warning.  If there are missing values in factor columns of <code>X</code>, they are treated as a new factor level.   If there are missing values in numeric or logical columns of <code>X</code>, an indicator of missingness for that column is added to <code>X</code> and the missing values are imputed with the column mean.  This follows the recommendations of Rosenbaum (<em>Design of Observational Studies</em> section 9.4, 2010).
</p>


<h3>Value</h3>

<p>A distance.structure object, the form of which is described in the documentation for the <code>distance.structure</code> argument of <code>rcbalance</code>.  Treated and control indices are numbered <code>1:nt</code> and <code>1:nc</code> respectively based on the order in which they appear in the <code>z</code> vector.
</p>


<h3>Author(s)</h3>

<p>Samuel D. Pimentel
</p>


<h3>See Also</h3>

<p><code>rcbalance</code>
</p>


</div>