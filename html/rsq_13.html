<div class="container">

<table style="width: 100%;"><tr>
<td>rsq.v</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance-Function-Based R-Squared</h2>

<h3>Description</h3>

<p>Calculate the variance-function-based R-squared for generalized linear (mixed) models.</p>


<h3>Usage</h3>

<pre><code class="language-R">rsq.v(fitObj,adj=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitObj</code></td>
<td>
<p> an object of class "lm", "glm", "lme", or "glmerMod", usually, a result of a call to lm, glm, glm.nb, glmer, or glmer.nb.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The R^2 relies on the variance function, and is well-defined for quasi models. It reduces to the classical R^2 when the variance function is constant or linear. For (generalized) linear mixed models, there are three types of R^2 calculated on the basis of observed response values, estimates of fixed effects, and variance components, i.e., model-based R_M^2 (proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors), fixed-effects R_F^2 (proportion of variation explained by the fixed-effects factors), and random-effects R_R^2 (proportion of variation explained by the random-effects factors).
</p>


<h3>Value</h3>

<p>The R^2 or adjusted R^2. For (generalized) linear mixed models,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R_M^2</code></td>
<td>
<p>proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_F^2</code></td>
<td>
<p>proportion of variation explained by the fixed-effects factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_R^2</code></td>
<td>
<p>proportion of variation explained by the random-effects factors.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>
<p>Zhang, D. (2020). Coefficients of determination for mixed-effects models. arXiv:2007.08675.
</p>


<h3>See Also</h3>

<p><code>vresidual, rsq, rsq.glmm, rsq.partial, pcor</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq.v(bnfit)
rsq.v(bnfit,adj=TRUE)

quasibn &lt;- glm(y~color+spine+width+weight,family=quasibinomial)
rsq.v(quasibn)
rsq.v(quasibn,adj=TRUE)

# Generalized linear mixed models
require(lme4)
data(cbpp)
glmm1 &lt;- glmer(cbind(incidence,size-incidence)~period+(1|herd),data=cbpp,family=binomial)
rsq.v(glmm1)
</code></pre>


</div>