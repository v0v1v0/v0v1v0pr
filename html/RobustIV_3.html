<div class="container">

<table style="width: 100%;"><tr>
<td>SearchingSampling</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Searching-Sampling</h2>

<h3>Description</h3>

<p>Construct Searching and Sampling confidence intervals for the causal effect, which provides the robust inference of the treatment effect in the presence of invalid instrumental variables in both low-dimensional and high-dimensional settings. It is robust to the mistakes in separating valid and invalid instruments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SearchingSampling(
  Y,
  D,
  Z,
  X = NULL,
  intercept = TRUE,
  method = c("OLS", "DeLasso", "Fast.DeLasso"),
  robust = TRUE,
  Sampling = TRUE,
  alpha = 0.05,
  CI.init = NULL,
  a = 0.6,
  rho = NULL,
  M = 1000,
  prop = 0.1,
  filtering = TRUE,
  tuning.1st = NULL,
  tuning.2nd = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The outcome observation, a vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The treatment observation, a vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>The instrument observation of dimension <code class="reqn">n \times p_z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The covariates observation of dimension <code class="reqn">n \times p_x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Whether the intercept is included. (default = <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used to estimate the reduced form parameters. <code>"OLS"</code> stands for ordinary least squares, <code>"DeLasso"</code> stands for the debiased Lasso estimator, and <code>"Fast.DeLasso"</code> stands for the debiased Lasso estimator with fast algorithm. (default = <code>"OLS"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>If <code>TRUE</code>, the method is robust to heteroskedastic errors. If <code>FALSE</code>, the method assumes homoskedastic errors.  (default = <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sampling</code></td>
<td>
<p>If <code>TRUE</code>, use the proposed sampling method; else use the proposed searching method. (default=<code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level (default=<code>0.05</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.init</code></td>
<td>
<p>An initial range for beta. If <code>NULL</code>, it will be generated automatically. (default=<code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>The grid size for constructing beta grids. (default=<code>0.6</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>The shrinkage parameter for the sampling method. (default=<code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The resampling size for the sampling method. (default = <code>1000</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>The proportion of non-empty intervals used for the sampling method. (default=<code>0.1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filtering</code></td>
<td>
<p>Filtering the resampled data or not. (default=<code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.1st</code></td>
<td>
<p>The tuning parameter used in the 1st stage to select relevant instruments. If <code>NULL</code>, it will be generated data-dependently, see Details. (default=<code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.2nd</code></td>
<td>
<p>The tuning parameter used in the 2nd stage to select valid instruments. If <code>NULL</code>, it will be generated data-dependently, see Details. (default=<code>NULL</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>robust = TRUE</code>, the <code>method</code> will be input as <code>’OLS’</code>. For <code>rho</code>, <code>M</code>, <code>prop</code>, and <code>filtering</code>, they are required only for <code>Sampling = TRUE</code>.
As for tuning parameter in the 1st stage and 2nd stage, if do not specify, for method "OLS" we adopt <code class="reqn">\sqrt{\log n}</code> for both tuning parameters, and for other methods
we adopt <code class="reqn">\max{(\sqrt{2.01 \log p_z}, \sqrt{\log n})}</code> for both tuning parameters.
</p>


<h3>Value</h3>

<p><code>SearchingSampling</code> returns an object of class "SS", which is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>1-alpha confidence interval for beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SHat</code></td>
<td>
<p>The set of selected relevant IVs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VHat</code></td>
<td>
<p>The initial set of selected relevant and valid IVs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>The indicator that the plurality rule is satisfied.</p>
</td>
</tr>
</table>
<h3>References</h3>


<p>Guo, Z. (2021), Causal Inference with Invalid Instruments: Post-selection Problems and A Solution Using Searching and Sampling, Preprint <em>arXiv:2104.06911</em>. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">
data("lineardata")
Y &lt;- lineardata[,"Y"]
D &lt;- lineardata[,"D"]
Z &lt;- as.matrix(lineardata[,c("Z.1","Z.2","Z.3","Z.4","Z.5","Z.6","Z.7","Z.8")])
X &lt;- as.matrix(lineardata[,c("age","sex")])
Searching.model &lt;- SearchingSampling(Y,D,Z,X, Sampling = FALSE)
summary(Searching.model)
Sampling.model &lt;- SearchingSampling(Y,D,Z,X)
summary(Sampling.model)


</code></pre>


</div>