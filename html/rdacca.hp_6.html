<div class="container">

<table style="width: 100%;"><tr>
<td>rdacca.hp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hierarchical and Variation Partitioning for Canonical Analysis Without Limiting the Number of Predictors (Matrices)</h2>

<h3>Description</h3>

<p>Hierarchical and Variation Partitioning for Canonical Analysis Without Limiting the Number of Predictors (Matrices)
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdacca.hp(
  dv,
  iv,
  method = c("RDA", "dbRDA", "CCA"),
  type = c("adjR2", "R2"),
  scale = FALSE,
  add = FALSE,
  sqrt.dist = FALSE,
  n.perm = 1000,
  var.part = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dv</code></td>
<td>
<p>Response variable, either a numeric vector, matrix or data frame. If method="dbRDA", dv should be of class "dist".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iv</code></td>
<td>
<p>Predictorsrepresented in either a data frame or a list of data frames. If it is a data frame, the relative importance of each column of the data frame will be evaluated; if it is a list, the relative importance of each element (matrix) will be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Type of canonical analysis to be performed, should be a character string, either "RDA", "dbRDA" or "CCA", the default is "RDA". If the response variable (dv) is a numerical vector and method="RDA", the hierarchical and variation partitioning for the classical multiple regression is implemented.If response variable (dv) is of class "dist", "dbRDA" will be chosen automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of total explained variation, either "R2" or "adjR2", in which "R2" is unadjusted R-square and "adjR2" is adjusted R-square, the default is "adjR2". The adjusted R-square is calculated using Ezekiel's formula (Ezekiel 1930) for RDA and dbRDA, while permutation procedure is used for CCA (Peres-Neto et al. 2006).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical; If the columns of dv should be standardized to unit variance when method="RDA" is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Logical; Specifies whether a constant should be added to the non-diagonal values to euclidify dissimilarities (see dbrda function in vegan for details). Choice "lingoes" (or TRUE) uses the recommended method of Legendre &amp; Anderson (1999: "method 1") and "cailliez" uses their "method 2". The argument has an effect only when method="dbRDA".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqrt.dist</code></td>
<td>
<p>Logical, Specifies whether the square root of dissimilarities should be taken. This often euclidifies dissimilarities. The argument has an effect only when method="dbRDA"(see dbrda function in vegan for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>Integer; Number of permutations for computing the adjusted R-square for CCA. The argument has an effect only when method="CCA".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.part</code></td>
<td>
<p>Logical; If TRUE, the result of variation partitioning (2^N-1 fractions for N predictors or matrices) is shown, the default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function conducts variation partitioning and hierarchical partitioning to calculate the unique, average shared (referred as to "common") and individual contributions of each predictor (or matrix) towards explained variation (R-square) on canonical analysis (RDA,CCA and dbRDA).
Variation partitioning should be conducted before hierarchical partitioning. The former emphasizes unique and common variation among predictors, the latter emphasizes the overall importance of each predictor (or group of predictors). This function simultaneously implements variation and hierarchical partitioning for single- and multiple-response models without limiting in the number of predictors / matrices of predictors.
</p>


<h3>Value</h3>

<p>a list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Method_Type</code></td>
<td>
<p>The type of canonical analysis and whether the raw or adjusted R2 waswere used in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Total_explained_variation</code></td>
<td>
<p>The explained variation for the full model (raw or adjusted R2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.part</code></td>
<td>
<p>If var.part=TRUE, a matrix containing the value and percentage of all commonality (2^N-1 for N predictors or matrices).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hier.part</code></td>
<td>
<p>A matrix containing unique, average shared, individual effects and percentage of individual effects towards total explained variation for each predictor or matrix.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@njfu.edu.cn">lai@njfu.edu.cn</a>
</p>


<h3>References</h3>


<ul>
<li>
<p> Lai J.,Zou Y., Zhang J.,Peres-Neto P.(2022) Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package.Methods in Ecology and Evolution,13,782-788&lt;DOI:10.1111/2041-210X.13800&gt;
</p>
</li>
<li>
<p> Chevan, A. &amp; Sutherland, M. (1991). Hierarchical partitioning. American Statistician, 45, 90-96. doi:10.1080/00031305.1991.10475776
</p>
</li>
<li>
<p> Nimon, K., Oswald, F.L. &amp; Roberts, J.K. (2013). Yhat: Interpreting regression effects. R package version 2.0.0.
</p>
</li>
<li>
<p> Legendre, P. &amp; Anderson, M. J. (1999). Distance-based redundancy analysis: testing multispecies responses in multifactorial ecological experiments. Ecological Monographs, 69, 1â€“24.&lt;DOI:10.1890/0012-9615(1999)069[0001:dbratm]2.0.co;2&gt;
</p>
</li>
<li>
<p> Walsh, C.J. &amp; Mac Nally, R. (2013) hier.part: Hierarchical Partitioning. R package version 1.0-4.
</p>
</li>
<li>
<p> Peres-Neto, P.R., Legendre, P., Dray, S. &amp; Borcard, D. (2006) Variation partitioning of species data matrices: Estimation and comparison of fractions. Ecology, 87, 2614-2625.&lt;DOI: doi.org/10.1890/0012-9658(2006)87[2614:VPOSDM]2.0.CO;2&gt;
</p>
</li>
<li>
<p> Ezekiel, M. (1930) Methods of Correlational Analysis. Wiley, New York
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(vegan)
data(mite)
data(mite.env)
data(mite.xy)
data(mite.pcnm)
#Hellinger-transform the species dataset for RDA
mite.hel &lt;- decostand(mite, "hellinger")
rdacca.hp(mite.hel,mite.env,method="RDA",type="adjR2")
rdacca.hp(vegdist(mite),mite.env,method="dbRDA",type="adjR2")
rdacca.hp(mite,mite.env,method="CCA",type="adjR2")
iv &lt;- list(env=mite.env,xy=mite.xy,pcnm=mite.pcnm)
rdacca.hp(mite.hel,iv,method="RDA",var.part = TRUE)
rdacca.hp(vegdist(mite),iv,method="dbRDA",var.part = TRUE)
rdacca.hp(mite,iv,method="CCA",var.part = TRUE)
</code></pre>


</div>