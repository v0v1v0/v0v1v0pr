<div class="container">

<table style="width: 100%;"><tr>
<td>revSupply</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate soil nutrients supply
</h2>

<h3>Description</h3>

<p>Estimate the apparent base (unfertilized) soil supply of N, P and K based on nutrient omission trial data and a "reverse" QUEFTS approach. The apparent supply is found with optimization. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">revSupply(obs, crop, soil, Ya, leaf_ratio, stem_ratio, SeasonLength = 120, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>data.frame with observed data from a nutrient omission trial. It must have these four columns: "N", "P", "K" and "Y"; that give the N, P, and K fertilizer application and the crop yield in kg/ha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ya</code></td>
<td>
<p>numeric. Attainable yield</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soil</code></td>
<td>
<p>list with named soil parameters. See <code>quefts_soil</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crop</code></td>
<td>
<p>list with named crop parameters. See <code>quefts_crop</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leaf_ratio</code></td>
<td>
<p>positive numeric (typically between 0 and 1) indicating the leaf weight relative to the storage organ weight. For example: 0.46 for maize, 0.17 for potato, and 0.18 for rice</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stem_ratio</code></td>
<td>
<p>positive numeric (typically between 0 and 1) indicating the stem weight relative to the storage organ weight, For example: 0.56 for maize, 0.14 for potato, and 0.67 for rice</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SeasonLength</code></td>
<td>
<p>positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments supplied to <code>optim</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>numeric vector with the N, P, and K supply in kg/ha
</p>


<h3>References</h3>

<p>?
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(777)
trial_data &lt;- data.frame(treat = c("CON", "NPK", "NPK", "PK", "NK", "NP"),
                  N = c(0, 120, 120, 0, 120, 120),
                  P = c(0, 30, 30, 30, 0, 30),
                  K = c(0, 60, 60, 60, 60, 0),
                  Y = c(2000, 6000, 6000, 2500, 4500, 5500) + rnorm(6, 0, 500))
Ya &lt;- max(trial_data$Y) + 1000
crop &lt;- quefts_crop("Potato")
soil &lt;- quefts_soil()

revSupply(trial_data, crop, soil, Ya, leaf_ratio=.17, stem_ratio=.14)
</code></pre>


</div>