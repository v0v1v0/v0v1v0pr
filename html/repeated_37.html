<div class="container">

<table style="width: 100%;"><tr>
<td>nbkal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative Binomial Models with Kalman Update</h2>

<h3>Description</h3>

<p><code>nbkal</code> fits a negative binomial regression with Kalman update over
time. The variance is proportional to the mean function, whereas, for
<code>kalcount</code> with exponential intensity, it is a
quadratic function of the mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nbkal(
  response,
  times,
  mu,
  preg,
  pdepend,
  kalman = TRUE,
  print.level = 0,
  ndigit = 10,
  gradtol = 1e-05,
  steptol = 1e-05,
  fscale = 1,
  iterlim = 100,
  typsize = abs(p),
  stepmax = 10 * sqrt(p %*% p)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A list of two column matrices with counts and corresponding
times for each individual, one matrix or dataframe of counts, or an object
of class, response (created by <code>restovec</code>) or repeated
(created by <code>rmna</code> or <code>lvna</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>When response is a matrix, a vector of possibly unequally
spaced times when they are the same for all individuals or a matrix of
times. Not necessary if equally spaced. Ignored if response has class,
response or repeated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The mean function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preg</code></td>
<td>
<p>The initial parameter estimates for the mean function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdepend</code></td>
<td>
<p>The estimates for the dependence parameters, either one or
three.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kalman</code></td>
<td>
<p>If TRUE, fits the kalman update model, otherwise, a standard
negative binomial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndigit</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fscale</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typsize</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepmax</code></td>
<td>
<p>Arguments for nlm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Marginal and individual profiles can be plotted using
<code>mprofile</code> and <code>iprofile</code> and
residuals with <code>plot.residuals</code>.
</p>


<h3>Value</h3>

<p>A list of classes <code>nbkal</code> and <code>recursive</code> is returned.
</p>


<h3>Author(s)</h3>

<p>P. Lambert and J.K. Lindsey
</p>


<h3>References</h3>

<p>Lambert, P. (1996) Applied Statistics 45, 31-38.
</p>
<p>Lambert, P. (1996) Biometrics 52, 50-55.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
y &lt;- matrix(rnbinom(20,5,0.5), ncol=5)
times &lt;- matrix(rep(seq(10,50,by=10),4), ncol=5, byrow=TRUE)
y0 &lt;- matrix(rep(rnbinom(5,5,0.5),4), ncol=5, byrow=TRUE)
mu &lt;- function(p) p[1]*log(y0)+(times&lt;30)*p[2]*
	(times-30)+(times&gt;30)*p[3]*(times-30)
nbkal(y, preg=c(1.3,0.008,-0.05), times=times, pdep=1.2, mu=mu)

</code></pre>


</div>