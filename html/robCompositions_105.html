<div class="container">

<table style="width: 100%;"><tr>
<td>outCoDa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Outlier detection for compositional data</h2>

<h3>Description</h3>

<p>Outlier detection for compositional data using standard and robust
statistical methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">outCoDa(x, quantile = 0.975, method = "robust", alpha = 0.5, coda = TRUE)

## S3 method for class 'outCoDa'
print(x, ...)

## S3 method for class 'outCoDa'
plot(x, y, ..., which = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>compositional data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>quantile, corresponding to a significance level, is used as
a cut-off value for outlier identification: observations with larger
(squared) robust Mahalanobis distance are considered as potential outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either “robust” (default) or “standard”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the size of the subsets for the robust covariance estimation
according the MCD-estimator for which the determinant is minimized, see <code>covMcd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coda</code></td>
<td>
<p>if TRUE, data transformed to coordinate representation before outlier detection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters for print and plot method passed through</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>unused second plot argument for the plot method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>1 ... MD against index
2 ... distance-distance plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The outlier detection procedure is based on (robust) Mahalanobis distances
in isometric logratio coordinates.  Observations with
squared Mahalanobis distance greater equal a certain quantile of the
chi-squared distribution are marked as outliers.
</p>
<p>If method “robust” is chosen, the outlier detection is based on the
homogeneous majority of the compositional data set. If method
“standard” is used, standard measures of location and scatter are
applied during the outlier detection procedure. Method “robust”
can be used if the number of variables is greater than the number
of observations. Here the OGK estimator is chosen. 
</p>
<p>plot method: the Mahalanobis distance are plotted against the index.
The dashed line indicates the (1 - alpha) quantile of the chi-squared
distribution. Observations with Mahalanobis distance greater than this
quantile could be considered as compositional outliers.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mahalDist </code></td>
<td>
<p>resulting Mahalanobis distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit
</code></td>
<td>
<p>quantile of the Chi-squared distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlierIndex </code></td>
<td>
<p>logical
vector indicating outliers and non-outliers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>method used</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is highly recommended to use the robust version of the procedure.
</p>


<h3>Author(s)</h3>

<p>Matthias Templ, Karel Hron
</p>


<h3>References</h3>

<p>Egozcue J.J., Pawlowsky-Glahn, V., Mateu-Figueras, G.,
Barcelo-Vidal, C. (2003) Isometric logratio transformations for compositional
data analysis. <em>Mathematical Geology</em>, 35 (3) 279-300. 
</p>
<p>Filzmoser, P., and Hron, K. (2008) Outlier detection for compositional data
using robust methods. <em>Math. Geosciences</em>, 40, 233-248.
</p>
<p>Rousseeuw, P.J., Van Driessen, K. (1999) A fast algorithm for the minimum
covariance determinant estimator.  <em>Technometrics</em>, 41, 212-223.
</p>


<h3>See Also</h3>

<p><code>pivotCoord</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(expenditures)
oD &lt;- outCoDa(expenditures)
oD
## providing a function:
oD &lt;- outCoDa(expenditures, coda = log)
## for high-dimensional data:
oD &lt;- outCoDa(expenditures, method = "robustHD")
</code></pre>


</div>