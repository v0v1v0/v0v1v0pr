<div class="container">

<table style="width: 100%;"><tr>
<td>cv.sofar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sparse orthognal factor regression tuned by cross validation</h2>

<h3>Description</h3>

<p>Sparse orthognal factor regression tuned by cross validation
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.sofar(
  Y,
  X,
  nrank = 1,
  su = NULL,
  sv = NULL,
  nfold = 5,
  norder = NULL,
  modstr = list(),
  control = list(),
  screening = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>response matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>covariate matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrank</code></td>
<td>
<p>an integer specifying the desired rank/number of factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>su</code></td>
<td>
<p>a scaling vector for U such that <code class="reqn">U^{T}U = diag(s_{u})</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv</code></td>
<td>
<p>a scaling vector for V such that <code class="reqn">V^{T}V = diag(s_{v})</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>
<p>number of fold; used for cv.sofar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norder</code></td>
<td>
<p>observation orders to constrct data folds; used for cv.sofar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modstr</code></td>
<td>
<p>a list of internal model parameters controlling the model
fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of internal computation parameters controlling
optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screening</code></td>
<td>
<p>If TRUE, marginal screening via lasso is performed before
sofar fitting.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model parameters can be specified through argument <code>modstr</code>.
The available elements include
</p>

<ul>
<li>
<p>mu: parameter in the augmented Lagrangian function.
</p>
</li>
<li>
<p>mugamma: increament of mu along iterations to speed up
computation.
</p>
</li>
<li>
<p>WA: weight matrix for A.
</p>
</li>
<li>
<p>WB: weight matrix for B.
</p>
</li>
<li>
<p>Wd: weight matrix for d.
</p>
</li>
<li>
<p>wgamma: power parameter in constructing adaptive weights.
</p>
</li>
</ul>
<p>The model fitting can be controled through argument <code>control</code>.
The avilable elements include
</p>

<ul>
<li>
<p>nlam: number of lambda triplets to be used.
</p>
</li>
<li>
<p>lam.min.factor: set the smallest lambda triplets as a fraction of
the estimation lambda.max triplets.
</p>
</li>
<li>
<p>lam.max.factor: set the largest lambda triplets as a multiple of
the estimation lambda.max triplets.
</p>
</li>
<li>
<p>lam.AB.factor: set the relative penalty level between A/B and D.
</p>
</li>
<li>
<p>penA,penB,penD: if TRUE, penalty is applied.
</p>
</li>
<li>
<p>lamA: sequence of tuning parameters for A.
</p>
</li>
<li>
<p>lamB: sequence of tuning parameters for B.
</p>
</li>
<li>
<p>lamD: sequence of tuning parameters for d.
</p>
</li>
<li>
<p>methodA: penalty for penalizing A.
</p>
</li>
<li>
<p>methodB: penalty for penalizing B.
</p>
</li>
<li>
<p>epsilon: convergence tolerance.
</p>
</li>
<li>
<p>maxit: maximum number of iterations.
</p>
</li>
<li>
<p>innerEpsilon: convergence tolerance for inner subroutines.
</p>
</li>
<li>
<p>innerMaxit: maximum number of iterations for inner subroutines.
</p>
</li>
<li>
<p>sv.tol: tolerance for singular values.
</p>
</li>
</ul>
</div>