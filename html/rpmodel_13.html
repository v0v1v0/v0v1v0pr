<div class="container">

<table style="width: 100%;"><tr>
<td>rpmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Invokes a P-model function call</h2>

<h3>Description</h3>

<p>R implementation of the P-model and its 
corollary predictions (Prentice et al., 2014; Han et al., 2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rpmodel(
  tc,
  vpd,
  co2,
  fapar,
  ppfd,
  patm = NA,
  elv = NA,
  kphio = ifelse(c4, 1, ifelse(do_ftemp_kphio, ifelse(do_soilmstress, 0.087182,
    0.081785), 0.049977)),
  beta = ifelse(c4, 146/9, 146),
  soilm = stopifnot(!do_soilmstress),
  meanalpha = 1,
  apar_soilm = 0,
  bpar_soilm = 0.733,
  c4 = FALSE,
  method_jmaxlim = "wang17",
  do_ftemp_kphio = TRUE,
  do_soilmstress = FALSE,
  returnvar = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tc</code></td>
<td>
<p>Temperature, relevant for photosynthesis (deg C)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vpd</code></td>
<td>
<p>Vapour pressure deficit (Pa)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co2</code></td>
<td>
<p>Atmospheric CO2 concentration (ppm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fapar</code></td>
<td>
<p>(Optional) Fraction of absorbed photosynthetically active
radiation (unitless, defaults to <code>NA</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppfd</code></td>
<td>
<p>Incident photosynthetic photon flux density 
(mol m-2 d-1, defaults to <code>NA</code>). Note that the units of 
<code>ppfd</code> (per area and per time) determine the units of outputs 
<code>lue</code>, <code>gpp</code>, <code>vcmax</code>, and <code>rd</code>. For example, 
if <code>ppfd</code> is provided in units of mol m-2 month-1, then
respective output variables are returned as per unit months.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patm</code></td>
<td>
<p>Atmospheric pressure (Pa). When provided, overrides
<code>elv</code>, otherwise <code>patm</code> is calculated using standard
atmosphere (101325 Pa), corrected for elevation (argument <code>elv</code>),
using the function calc_patm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elv</code></td>
<td>
<p>Elevation above sea-level (m.a.s.l.). Is used only for 
calculating atmospheric pressure (using standard atmosphere (101325 Pa),
corrected for elevation (argument <code>elv</code>), using the function
calc_patm), if argument <code>patm</code> is not provided. If argument
<code>patm</code> is provided, <code>elv</code> is overridden.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kphio</code></td>
<td>
<p>Apparent quantum yield efficiency (unitless). Defaults to
0.081785 for <code>method_jmaxlim="wang17", do_ftemp_kphio=TRUE, 
do_soilmstress=FALSE</code>, 0.087182 for <code>method_jmaxlim="wang17",
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>, and 0.049977 for 
<code>method_jmaxlim="wang17", do_ftemp_kphio=FALSE, do_soilmstress=FALSE</code>,
corresponding to the empirically fitted value as presented in Stocker et al.
(2019) Geosci. Model Dev. for model setup 'BRC', 'FULL', and 'ORG' 
respectively, corresponding to <code class="reqn">(a_L b_L)/4</code> in 
Eq.20 in Stocker et al. (2020) for C3 photosynthesis. For C4 photosynthesis
(<code>c4 = TRUE</code>), <code>kphio</code> defaults to 1.0, corresponding to the 
parametrisation by  Cai &amp; Prentice (2020).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Unit cost ratio. Defaults to 146.0 (see Stocker et al., 2019) for
C3 plants and 146/9 for C4 plants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) Relative 
soil moisture as a fraction of field capacity (unitless). Defaults to 1.0 
(no soil moisture stress). This information is used to calculate
an empirical soil moisture stress factor (calc_soilmstress) whereby
the sensitivity is determined by average aridity, defined by the local 
annual mean ratio of actual over potential evapotranspiration, supplied by
argument <code>meanalpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanalpha</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) Local 
annual mean ratio of actual over potential evapotranspiration, measure for 
average aridity. Defaults to 1.0. Only scalar numbers are accepted. If 
a vector is provided, only the first element will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apar_soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) 
Parameter determining the sensitivity of the empirical soil moisture stress 
function. Defaults to 0.0, the empirically fitted value as presented in 
Stocker et al. (2019) Geosci. Model Dev. for model setup 'FULL' 
(corresponding to a setup with <code>method_jmaxlim="wang17", 
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bpar_soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) 
Parameter determining the sensitivity of the empirical soil moisture stress
function. Defaults to 0.7330, the empirically fitted value as presented in 
Stocker et al. (2019) Geosci. Model Dev. for model setup 'FULL' 
(corresponding to a setup with <code>method_jmaxlim="wang17", 
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c4</code></td>
<td>
<p>(Optional) A logical value specifying whether the C3 or C4
photosynthetic pathway is followed.Defaults to <code>FALSE</code>. If <code>TRUE</code>,
the leaf-internal CO2 concentration is still estimated using beta but
<code class="reqn">m</code> (returned variable <code>mj</code>) tends to 1, and <code class="reqn">m'</code> tends to
0.669 (with <code>c = 0.41</code>) to represent CO2 concentrations within the leaf.
With <code>do_ftemp_kphio = TRUE</code>, a C4-specific temperature dependence of
the quantum yield efficiency is used (see ftemp_kphio).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_jmaxlim</code></td>
<td>
<p>(Optional) A character string specifying which method 
is to be used for factoring in Jmax limitation. Defaults to <code>"wang17"</code>,
based on Wang Han et al. 2017 Nature Plants and (Smith 1937). Available is 
also <code>"smith19"</code>, following the method by Smith et al., 2019 Ecology 
Letters, and <code>"none"</code> for ignoring effects of Jmax limitation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do_ftemp_kphio</code></td>
<td>
<p>(Optional) A logical specifying whether 
temperature-dependence of quantum yield efficiency is used. See ftemp_kphio
for details. Defaults to <code>TRUE</code>. Only scalar numbers are accepted. If 
a vector is provided, only the first element will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do_soilmstress</code></td>
<td>
<p>(Optional) A logical specifying whether an empirical 
soil moisture stress factor is to be applied to down-scale light use 
efficiency (and only light use efficiency). Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnvar</code></td>
<td>
<p>(Optional) A character string of vector of character strings
specifying which variables are to be returned (see return below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, defines whether verbose messages are printed. 
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list of numeric values (including temperature and pressure 
dependent parameters of the photosynthesis model, P-model predictions, 
including all its corollary). This includes :
</p>

<ul>
<li> <p><code>ca</code>: Ambient CO2 expressed as partial pressure (Pa)
</p>
</li>
<li> <p><code>gammastar</code>: Photorespiratory compensation point <code class="reqn">\Gamma*</code>, 
(Pa), see calc_gammastar.
</p>
</li>
<li> <p><code>kmm</code>: Michaelis-Menten coefficient <code class="reqn">K</code> for photosynthesis 
(Pa), see calc_kmm.
</p>
</li>
<li> <p><code>ns_star</code>: Change in the viscosity of water, relative to its 
value at 25 deg C (unitless).
</p>
<p style="text-align: center;"><code class="reqn">\eta* = \eta(T) / \eta(25 deg C)</code>
</p>

<p>This is used to scale the unit cost of transpiration. 
Calculated following Huber et al. (2009).
</p>
</li>
<li> <p><code>chi</code>: Optimal ratio of leaf internal to ambient CO2 (unitless). 
Derived following Prentice et al.(2014) as:
</p>
<p style="text-align: center;"><code class="reqn">
  \chi = \Gamma* / ca + (1- \Gamma* / ca) \xi / (\xi + \sqrt D )
  </code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
   \xi = \sqrt (\beta (K+ \Gamma*) / (1.6 \eta*))
  </code>
</p>

<p><code class="reqn">\beta</code> is given by argument <code>beta</code>, <code class="reqn">K</code> is 
<code>kmm</code> (see calc_kmm), <code class="reqn">\Gamma*</code> is 
<code>gammastar</code> (see calc_gammastar). <code class="reqn">\eta*</code> is <code>ns_star</code>.
<code class="reqn">D</code> is the vapour pressure deficit (argument <code>vpd</code>), <code class="reqn">ca</code> is 
the ambient CO2 partial pressure in Pa (<code>ca</code>).
</p>
</li>
<li> <p><code>ci</code>: Leaf-internal CO2 partial pressure (Pa), calculated as <code class="reqn">(\chi ca)</code>.
</p>
</li>
<li> <p><code>lue</code>: Light use efficiency (g C / mol photons), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                             LUE = \phi(T) \phi0 m' Mc
                        </code>
</p>

<p>where <code class="reqn">\phi(T)</code> is the temperature-dependent quantum yield efficiency modifier
(ftemp_kphio) if <code>do_ftemp_kphio==TRUE</code>, and 1 otherwise. <code class="reqn">\phi 0</code>
is given by argument <code>kphio</code>.
<code class="reqn">m'=m</code> if <code>method_jmaxlim=="none"</code>, otherwise
</p>
<p style="text-align: center;"><code class="reqn">
                               m' = m \sqrt( 1 - (c/m)^(2/3) )
                        </code>
</p>

<p>with <code class="reqn">c=0.41</code> (Wang et al., 2017) if <code>method_jmaxlim=="wang17"</code>. <code class="reqn">Mc</code> is
the molecular mass of C (12.0107 g mol-1). <code class="reqn">m</code> is given returned variable <code>mj</code>.
If <code>do_soilmstress==TRUE</code>, <code class="reqn">LUE</code> is multiplied with a soil moisture stress factor,
calculated with calc_soilmstress.
</p>
</li>
<li> <p><code>mj</code>: Factor in the light-limited assimilation rate function, given by
</p>
<p style="text-align: center;"><code class="reqn">
                            m = (ci - \Gamma*) / (ci + 2 \Gamma*)
                       </code>
</p>

<p>where <code class="reqn">\Gamma*</code> is given by <code>calc_gammastar</code>.
</p>
</li>
<li> <p><code>mc</code>: Factor in the Rubisco-limited assimilation rate function, given by
</p>
<p style="text-align: center;"><code class="reqn">
                            mc = (ci - \Gamma*) / (ci + K)
                       </code>
</p>

<p>where <code class="reqn">K</code> is given by <code>calc_kmm</code>.
</p>
</li>
<li> <p><code>gpp</code>: Gross primary production (g C m-2), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                           GPP = Iabs LUE
                       </code>
</p>

<p>where <code class="reqn">Iabs</code> is given by <code>fapar*ppfd</code> (arguments), and is
<code>NA</code> if <code>fapar==NA</code> or <code>ppfd==NA</code>. Note that <code>gpp</code> scales with
absorbed light. Thus, its units depend on the units in which <code>ppfd</code> is given.
</p>
</li>
<li> <p><code>iwue</code>: Intrinsic water use efficiency (iWUE, Pa), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                             iWUE = ca (1-\chi)/(1.6)
                       </code>
</p>

</li>
<li> <p><code>gs</code>: Stomatal conductance (gs, in mol C m-2 Pa-1), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                            gs = A / (ca (1-\chi))
                       </code>
</p>

<p>where <code class="reqn">A</code> is <code>gpp</code><code class="reqn">/Mc</code>.
</p>
</li>
<li> <p><code>vcmax</code>: Maximum carboxylation capacity <code class="reqn">Vcmax</code> (mol C m-2) at growth temperature (argument
<code>tc</code>), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                           Vcmax = \phi(T) \phi0 Iabs n
                      </code>
</p>

<p>where <code class="reqn">n</code> is given by <code class="reqn">n=m'/mc</code>.
</p>
</li>
<li> <p><code>vcmax25</code>: Maximum carboxylation capacity <code class="reqn">Vcmax</code> (mol C m-2) normalised to 25 deg C
following a modified Arrhenius equation, calculated as <code class="reqn">Vcmax25 = Vcmax / fv</code>,
where <code class="reqn">fv</code> is the instantaneous temperature response by Vcmax and is implemented
by function ftemp_inst_vcmax.
</p>
</li>
<li> <p><code>jmax</code>: The maximum rate of RuBP regeneration () at growth temperature (argument
<code>tc</code>), calculated using
</p>
<p style="text-align: center;"><code class="reqn">
                           A_J = A_C
                      </code>
</p>

</li>
<li> <p><code>rd</code>: Dark respiration <code class="reqn">Rd</code> (mol C m-2), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                         Rd = b0 Vcmax (fr / fv)
                     </code>
</p>

<p>where <code class="reqn">b0</code> is a constant and set to 0.015 (Atkin et al., 2015), <code class="reqn">fv</code> is the
instantaneous temperature response by Vcmax and is implemented by function
ftemp_inst_vcmax, and <code class="reqn">fr</code> is the instantaneous temperature response
of dark respiration following Heskel et al. (2016) and is implemented by function
ftemp_inst_rd.
</p>
</li>
</ul>
<p>Additional variables are contained in the returned list if argument <code>method_jmaxlim=="smith19"</code>
</p>

<ul>
<li> <p><code>omega</code>: Term corresponding to <code class="reqn">\omega</code>, defined by Eq. 16 in
Smith et al. (2019), and Eq. E19 in Stocker et al. (2019).
</p>
</li>
<li> <p><code>omega_star</code>: Term corresponding to <code class="reqn">\omega^\ast</code>, defined by
Eq. 18 in Smith et al. (2019), and Eq. E21 in Stocker et al. (2019).
</p>
</li>
</ul>
<p>patm
</p>


<h3>References</h3>

<p>Bernacchi, C. J., Pimentel, C., and Long, S. P.:  In vivo temperature response func-tions  of  parameters
required  to  model  RuBP-limited  photosynthesis,  Plant  Cell Environ., 26, 1419–1430, 2003
</p>
<p>and their drivers: analysis and modelling at flux-site and global scales,
Environ. Res. Lett. 15 124050 https://doi.org/10.1088/1748-9326/abc64e, 2020
Heskel,  M.,  O’Sullivan,  O.,  Reich,  P.,  Tjoelker,  M.,  Weerasinghe,  L.,  Penillard,  A.,Egerton, J.,
Creek, D., Bloomfield, K., Xiang, J., Sinca, F., Stangl, Z., Martinez-De La Torre, A., Griffin, K.,
Huntingford, C., Hurry, V., Meir, P., Turnbull, M.,and Atkin, O.:  Convergence in the temperature response
of leaf respiration across biomes and plant functional types, Proceedings of the National Academy of Sciences,
113,  3832–3837,  doi:10.1073/pnas.1520282113,2016.
</p>
<p>Huber,  M.  L.,  Perkins,  R.  A.,  Laesecke,  A.,  Friend,  D.  G.,  Sengers,  J.  V.,  Assael,M. J.,
Metaxa, I. N., Vogel, E., Mares, R., and Miyagawa, K.:  New international formulation for the viscosity
of H2O, Journal of Physical and Chemical ReferenceData, 38, 101–125, 2009
</p>
<p>Prentice,  I. C.,  Dong,  N.,  Gleason,  S. M.,  Maire,  V.,  and Wright,  I. J.:  Balancing the costs
of carbon gain and water transport:  testing a new theoretical frameworkfor  plant  functional  ecology,
Ecology  Letters,  17,  82–91,  10.1111/ele.12211,http://dx.doi.org/10.1111/ele.12211, 2014.
</p>
<p>Wang, H., Prentice, I. C., Keenan, T. F., Davis, T. W., Wright, I. J., Cornwell, W. K.,Evans, B. J.,
and Peng, C.:  Towards a universal model for carbon dioxide uptake by plants, Nat Plants, 3, 734–741, 2017.
Atkin, O. K., et al.:  Global variability in leaf respiration in relation to climate, plant func-tional
types and leaf traits, New Phytologist, 206, 614–636, doi:10.1111/nph.13253,
https://nph.onlinelibrary.wiley.com/doi/abs/10.1111/nph.13253.
</p>
<p>Smith, N. G., Keenan, T. F., Colin Prentice, I. , Wang, H. , Wright, I. J., Niinemets, U. , Crous, K. Y.,
Domingues, T. F., Guerrieri, R. , Yoko Ishida, F. , Kattge, J. , Kruger, E. L., Maire, V. , Rogers, A. ,
Serbin, S. P., Tarvainen, L. , Togashi, H. F., Townsend, P. A., Wang, M. , Weerasinghe, L. K. and Zhou, S.
(2019), Global photosynthetic capacity is optimized to the environment. Ecol Lett, 22: 506-517.
doi:10.1111/ele.13210
</p>
<p>Stocker, B. et al. Geoscientific Model Development Discussions (in prep.)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
 rpmodel(
  tc = 20,
  vpd = 1000,
  co2 = 400,
  ppfd = 30,
  elv = 0)

## End(Not run)

</code></pre>


</div>