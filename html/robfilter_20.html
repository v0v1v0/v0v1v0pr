<div class="container">

<table style="width: 100%;"><tr>
<td>robreg.filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Regression Filters for Univariate Time Series</h2>

<h3>Description</h3>

<p> Procedures for robust (online) extraction of low 
frequency components (the <em>signal</em>) from a univariate time 
series by applying robust regression techniques to moving time 
windows. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">robreg.filter(y, width, method = "all", h = floor(width/2)+1,   
                 minNonNAs = 5, online = FALSE, extrapolate = TRUE)










</code></pre>


<h3>Arguments</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector or (univariate) time series object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a positive integer defining the window width used for fitting.<br>
If <code>online=FALSE</code> (see below) this needs to be an odd integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a (vector of) character string(s) containing the method(s) to be used for robust 
approximation of the signal within one time window. 
It is possible to specify any combination of the values:
</p>
<dl>
<dt><code>"DR"</code></dt>
<dd>
<p>Deepest Regression</p>
</dd>
<dt><code>"LMS"</code></dt>
<dd>
<p>Least Median of Squares regression</p>
</dd> 
<dt><code>"LQD"</code></dt>
<dd>
<p>Least Quartile Difference regression</p>
</dd>
<dt><code>"LTS"</code></dt>
<dd>
<p>Least Trimmed Squares regression</p>
</dd>
<dt><code>"MED"</code></dt>
<dd>
<p>Median</p>
</dd>
<dt><code>"RM"</code></dt>
<dd>
<p>Repeated Median regression</p>
</dd>
<dt><code>"all"</code></dt>
<dd>
<p>all of the above (default)</p>
</dd> 
</dl>
<p>Using <code>dr.filter</code>, <code>lms.filter</code>, <code>lqd.filter</code>, <code>lts.filter</code>, <code>med.filter</code> or <code>rm.filter</code>
forces <code>"DR"</code>, <code>"LMS"</code>, <code>"LQD"</code>, <code>"LTS"</code>, <code>"MED"</code> or <code>"RM"</code> respectively. <br>
Currently, only <code>method="MED"</code> and <code>method="RM"</code> (<code>med.filter</code> / <code>rm.filter</code>) 
can handle missing values in the input time series.
For the other regression filters missing values have to be replaced before the analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a positive integer defining the trimming quantile for 
LTS regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNonNAs</code></td>
<td>
<p>a positive integer defining the minimum number of
non-missing observations within one window which is required 
for a ‘sensible’ estimation. 
Currently, this option only has an effect for the two methods <code>"MED"</code> and /or <code>"RM"</code> (see <code>method</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>online</code></td>
<td>
<p>a logical indicating whether the current level estimate is 
evaluated at the most recent time within each time window 
(<code>TRUE</code>) or centred within each window (<code>FALSE</code>). 
Setting <code>online=FALSE</code> requires the <code>width</code> to be odd. 
Default is <code>online=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrapolate</code></td>
<td>
<p>a logical indicating whether the level 
estimations should be extrapolated to the edges of the time series. <br>
If <code>online=FALSE</code> the extrapolation consists of the 
fitted values within the first half of the first window and the 
last half of the last window; if <code>online=TRUE</code> the 
extrapolation consists of the fitted values within the first 
time window. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>robreg.filter</code> is suitable for extracting low 
frequency components (the <em>signal</em>) from a time series which 
may be contaminated with outliers and can contain level shifts. 
For this, robust regression methods are applied to a moving 
window, and the signal level is estimated by the fitted value 
either at the end of each time window for online signal 
extraction without time delay (<code>online=TRUE</code>) or in the 
centre of each time window (<code>online=FALSE</code>).</p>


<h3>Value</h3>

<p><code>robreg.filter</code> returns an object of class <code>robreg.filter</code>. 
An object of class <code>robreg.filter</code> is a list containing the 
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a data frame containing the signal level extracted by the filter(s) specified in <code>method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>a data frame containing the corresponding slope within each time window.</p>
</td>
</tr>
</table>
<p>In addition, the original input time series is returned as list 
member <code>y</code>, and the settings used for the analysis are 
returned as the list members <code>width</code>, <code>method</code>, 
<code>h</code>, <code>minNonNAs</code>, <code>online</code> and <code>extrapolate</code>. 
</p>
<p>Application of the function <code>plot</code> to an object of class
<code>robreg.filter</code> returns a plot showing the original time series 
with the filtered output. 
</p>


<h3>Note</h3>

<p>Missing values are treated by omitting them and thus by reducing 
the corresponding window width. The estimated signal level is 
only returned as <code>NA</code> if the window the estimation is based 
on contains less than <code>minNonNAs</code> non-missing values.
</p>


<h3>Author(s)</h3>

<p>C++ code: Thorsten Bernholt and Robin Nunkesser<br>
Port to R: Roland Fried and Karen Schettlinger</p>


<h3>References</h3>

 
<p>Davies, P.L., Fried, R., Gather, U. (2004) 
Robust Signal Extraction for On-Line Monitoring Data, 
<em>Journal of Statistical Planning and Inference</em> <b>122</b>, 
65-78.<br>
(earlier version: <a href="http://hdl.handle.net/2003/5043">http://hdl.handle.net/2003/5043</a>)
</p>
<p>Gather, U., Schettlinger, K., Fried, R. (2006)
Online Signal Extraction by Robust Linear Regression,
<em>Computational Statistics</em> <b>21</b>(1), 
33-51. <br>
(earlier version: <a href="http://hdl.handle.net/2003/5305">http://hdl.handle.net/2003/5305</a>)
</p>
<p>Schettlinger, K., Fried, R., Gather, U. (2006) 
Robust Filters for Intensive Care Monitoring: Beyond the Running Median,
<em>Biomedizinische Technik</em> <b>51</b>(2), 
49-56.
</p>


<h3>See Also</h3>

<p><code>wrm.filter</code>, <code>robust.filter</code>, <code>dw.filter</code>, <code>hybrid.filter</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate random time series:
y &lt;- cumsum(runif(500)) - .5*(1:500)
# Add jumps:
y[200:500] &lt;- y[200:500] + 5
y[400:500] &lt;- y[400:500] - 7
# Add noise:
n &lt;- sample(1:500, 30)
y[n] &lt;- y[n] + rnorm(30)

# Filtering with all methods:
y.rr &lt;- robreg.filter(y, width=31, method=c("RM", "LMS", "LTS", "DR", "LQD"))
# Plot:
plot(y.rr)

# Delayed filtering with RM and LMS filter:
y2.rr &lt;- robreg.filter(y,width=31,method=c("RM","LMS"))
plot(y2.rr)

# Online filtering with RM filter:
y3.rr &lt;- rm.filter(y,width=41,online=TRUE)
plot(y3.rr)
</code></pre>


</div>