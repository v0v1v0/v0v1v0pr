<div class="container">

<table style="width: 100%;"><tr>
<td>step.lmrobdetMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust stepwise using RFPE</h2>

<h3>Description</h3>

<p>This function performs stepwise model selection on a robustly fitted
linear model using the RFPE
criterion and the robust regression estimators computed with
<code>lmrobdetMM</code>. Only backwards stepwise is currently implemented.
</p>


<h3>Usage</h3>

<pre><code class="language-R">step.lmrobdetMM(
  object,
  scope,
  direction = c("both", "backward", "forward"),
  trace = TRUE,
  keep = NULL,
  steps = 1000,
  whole.path = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a robust fit as returned by <code>lmrobdetMM</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope</code></td>
<td>
<p>either a formula or a list with elements <code>lower</code> and <code>upper</code> each of 
which is a formula. The terms in the right-hand-side of <code>lower</code> are always included 
in the model and the additional terms in the right-hand-side of <code>upper</code> are the
candidates for inclusion/exclusion from the model. If a single formula is given, it is 
taken to be <code>upper</code>, and <code>lower</code> is set to the empty model. The <code>.</code> operator 
is interpreted in the context of the formula in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>the direction of stepwise search. Currenly only <code>backward</code> stepwise 
searches are implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>logical. If <code>TRUE</code> information about each step is printed on the screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>a filter function whose input is a fitted model object and the associated AIC statistic, and whose output is arbitrary. Typically keep will select a subset of the components of the object and return them. The default is not to keep anything.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>maximum number of steps to be performed. Defaults to 1000, which should mean as many as needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whole.path</code></td>
<td>
<p>if <code>FALSE</code> (default) variables are dropped until the RFPE fails to improve. If <code>TRUE</code> the best variable to be dropped is removed, even if this does not improve the RFPE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Presently only backward stepwise selection is supported. During each step the 
Robust Final Prediction Error (as computed by the function <code>lmrobdetMM.RFPE</code>) is 
calculated for the current model and for each sub-model achievable by deleting a 
single term. If the argument <code>whole.path</code> is <code>FALSE</code>, the function steps 
to the sub-model with the lowest 
Robust Final Prediction Error or, if the current model has the lowest Robust Final 
Prediction Error, terminates. If the argument <code>whole.path</code> is <code>TRUE</code>, the 
function steps through all smaller submodels removing, at each step, the variable 
that most reduces the Robust Final Prediction Error. The scale estimate from <code>object</code> 
is used to compute the Robust Final Prediction Error throughout the procedure.
</p>


<h3>Value</h3>

<p>If <code>whole.path == FALSE</code> the function returns the robust fit as obtained by <code>lmrobdetMM</code> using the final model. 
If <code>whole.path == TRUE</code> a list is returned containing the RFPE of each model on the sequence
of submodels. The names of the components of this list are the formulas that correspods to each model.
</p>


<h3>Author(s)</h3>

<p>Victor Yohai, <a href="mailto:victoryohai@gmail.com">victoryohai@gmail.com</a>, Matias Salibian-Barrera, <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a>
</p>


<h3>References</h3>

<p><a href="http://www.wiley.com/go/maronna/robust">http://www.wiley.com/go/maronna/robust</a>
</p>


<h3>See Also</h3>

<p><code>DCML</code>, <code>MMPY</code>, <code>SMPY</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">cont &lt;- lmrobdet.control(bb = 0.5, efficiency = 0.85, family = "bisquare")
set.seed(300)
X &lt;- matrix(rnorm(50*6), 50, 6)
beta &lt;- c(1,1,1,0,0,0)
y &lt;- as.vector(X %*% beta) + 1 + rnorm(50)
y[1:6] &lt;- seq(30, 55, 5)
for (i in 1:6) X[i,] &lt;- c(X[i,1:3],i/2,i/2,i/2)
Z &lt;- cbind(y,X)
Z &lt;- as.data.frame(Z)
obj &lt;- lmrobdetMM(y ~ ., data=Z, control=cont)
out &lt;- step.lmrobdetMM(obj)

</code></pre>


</div>