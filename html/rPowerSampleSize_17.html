<div class="container">

<table style="width: 100%;"><tr>
<td>montecarlo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Monte carlo computation of power.
</h2>

<h3>Description</h3>

<p>This function approximates the power for a given sample size using a Monte
Carlo simulation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">montecarlo(method, M = 100000, nE, r, m, nCovernE = 1, muC,
muE, d = rep(0.0, m), SigmaE, SigmaC, alpha =
0.05, q = 1, nbcores = parallel::detectCores() - 1, alternative =
"greater",
orig.Hochberg = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>"Bonferroni", "Holm" or "Hochberg".  When <code>method =
  "Hochberg"</code>, we use critical values involving the D1 term in formula
(11) of Romano et al. in order to control strongly the <code class="reqn">q</code>-FWER.
If you want to use the original Hochberg's
procedure, set <code>orig.Hochberg</code> to <code>TRUE</code>. Even for
<code class="reqn">q=1</code>, this is a bad idea except when the p-values can be assumed independent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of Monte Carlo repetitions. Dmitrienko et al. (2013)
suggested to take <code>M = 10 ^ 5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nE</code></td>
<td>
<p>integer. Sample size for the experimental (test) group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>integer, r = 1, ..., m. Desired number of endpoints to be declared significant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>integer. Number of endpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCovernE</code></td>
<td>
<p>ratio of <code>nC</code> over <code>nE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muC</code></td>
<td>
<p>vector of length <code>m</code> of the true means of the control
group for all endpoints under the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muE</code></td>
<td>
<p>vector of length <code>m</code> of the true means of the experimental (test) group for all endpoints under the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>vector of length <code>m</code> indicating the true value of the differences in means
under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaE</code></td>
<td>
<p>matrix indicating the covariances between the <code>m</code> 
primary endpoints in the experimental (test) group. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaC</code></td>
<td>
<p>matrix indicating the covariances between the <code>m</code> 
primary endpoints in the control group. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a value which corresponds to the chosen q-gFWER type-I control bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>integer. Value of 'q' (q = 1, ..., m) in the q-gFWER of Romano et
al., which is the probability to make at least <code>q</code> false
rejections. The default value <code>q=1</code> corresponds to the classical FWER control.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbcores</code></td>
<td>
<p>number of cores to use for the computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>NOT USED YET. Character string specifying the alternative hypothesis, must be one of "two.sided", "greater" or "less".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orig.Hochberg</code></td>
<td>
<p>logical. To use the standard Hochberg's procedure.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>rpowBonf or rpowHoch or rpowHolm</code></td>
<td>
<p>List with one element giving the computed power.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>P. Lafaye de Micheaux, B. Liquet and J. Riou
</p>


<h3>References</h3>

<p>Delorme P., Lafaye de Micheaux P., Liquet B., Riou, J. (2015). Type-II Generalized Family-Wise Error Rate
Formulas with Application to Sample Size Determination. Submitted to <em>Statistics
in Medicine.</em> 
</p>
<p>Romano J. and Shaikh A. (2006) Stepup Procedures For Control of
Generalizations of the Familywise Error Rate. <em>The Annals of Statistics</em>,
34(4), 1850â€“1873.
</p>


<h3>See Also</h3>

<p><code>indiv.analysis</code>,
</p>


</div>