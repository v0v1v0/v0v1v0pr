<div class="container">

<table style="width: 100%;"><tr>
<td>post_sample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Posterior sampling. </h2>

<h3>Description</h3>


<p>This function performs the posterior sampling for calibration parameters and other parameters in the model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">post_sample(input, output, R0_list, kernel_type, p_theta, output_weights, par_cur, 
            lambda_z,prior_par,theta_range,S,thinning, X, have_trend,alpha,
            sd_proposal,discrepancy_type, simul_type,emulator,
            emulator_type, loc_index_emulator,math_model,
            S_2_f,num_obs_all)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>


<p>a matrix of observed inputs/design points of the experimental data. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>


<p>a vector of experimental data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0_list</code></td>
<td>


<p>a List of matrices where the j-th matrix is an absolute difference matrix of the j-th input vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_type</code></td>
<td>


<p>type of kernel. <code>matern_3_2</code> and <code>matern_5_2</code> are <code>Matern kernel</code> with roughness parameter 3/2 and 5/2 respectively. <code>pow_exp</code> is power exponential kernel with roughness parameter alpha. If <code>pow_exp</code> is to be used, one needs to specify its roughness parameter alpha.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_theta</code></td>
<td>

<p>number of calibration parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_weights</code></td>
<td>

<p>a vector of the weights of the output.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_cur</code></td>
<td>


<p>current value of the posterior samples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_z</code></td>
<td>


<p>a scalar parameter controling how close the math model to the reality in squared distance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_par</code></td>
<td>

<p>a vector of prior parameters in the prior.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_range</code></td>
<td>

<p>a matrix for the range of the calibration parameters. The first column is the lower bound and the second column is the upper bound of the calibration parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>number of MCMC to run.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>the ratio between the number of posterior samples and the number of
recorded samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>a matrix for the basis of the mean discrepancy. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>have_trend</code></td>
<td>

<p>a bool value. It means the mean discrepancy is zero or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>


<p>a vector of roughness parameters in the kernel functions. It is only useful if the power exponential correlation function is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_proposal</code></td>
<td>

<p>a vector for the standard deviation of the proposal distribution. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrepancy_type</code></td>
<td>


<p>A string for type of discrepancy funcation. It can be chosen from 'no-discrepancy', 'GaSP' or 'S-GaSP'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simul_type</code></td>
<td>

<p>tpye of math model. If the simul_type is 0, it means we use the RobustGaSP R package to emulate the math model. If the simul_type is 1, it means the function of the math model is given by the user. When simul_type is 2 or 3, the mathematical model is the geophyiscal model for Kilauea Volcano.  If the simul_type is 2, it means it is for the ascending mode InSAR data; if the simul_type is 3, it means it is for the descending mode InSAR data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emulator</code></td>
<td>

<p>an S4 class of rgasp model from the RobustGaSP R Package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emulator_type</code></td>
<td>

<p>a character to specify the type of emulator.  'rgasp' is for computer models with scalar-valued output and 'ppgasp'  for computer models with vectorized output.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc_index_emulator</code></td>
<td>

<p>a vector of the location index from the ppgasp emulator to output. Only useful for vectorized output computer model emulated by the ppgasp emulator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>math_model</code></td>
<td>

<p>a function for the math model to be calibrated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_2_f</code></td>
<td>

<p>Variance of the data. This term is useful when there are repeated experiments. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_obs_all</code></td>
<td>

<p>Total number of observations. If there is no repeated experiment, this is equal to the number of observable inputs.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list. The first element is a matrix of the posterior samples after burn-in. The second element is a vector of posterior values after burn-in. The third element is the number of times of the proposed samples are accepted. The first value of the vector is the number of times that the proposed calibration parameters are accepted and the second value is the number of times of the proposed log inverse range parameter and the log nugget parameters are accepted, if there is a specification of the discrepancy function. The fourth element is the number of times the proposed samples of the calibration parameters are outside the  range of the calibration parameters.
</p>


<h3>Author(s)</h3>


<p>Mengyang Gu [aut, cre]
</p>
<p>Maintainer: Mengyang Gu &lt;mengyang@pstat.ucsb.edu&gt;
</p>


<h3>References</h3>

<p>A. O'Hagan and M. C. Kennedy (2001), <em>Bayesian calibration of computer models</em>, <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology</em>, <b>63</b>, 425-464.
</p>
<p>Mengyang Gu. (2016). Robust Uncertainty Quantification and Scalable Computation for Computer Models with Massive Output. Ph.D. thesis. Duke University.
</p>
<p>M. Gu and L. Wang (2017) <em>Scaled Gaussian Stochastic Process for Computer Model Calibration and Prediction</em>. arXiv preprint arXiv:1707.08215.
</p>
<p>M. Gu (2018) <em>Jointly Robust Prior for Gaussian Stochastic Process in Emulation, Calibration and Variable Selection
</em>. arXiv preprint arXiv:1804.09329.
</p>


</div>