<div class="container">

<table style="width: 100%;"><tr>
<td>bfpca_optimization</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal main optimization for bfpca</h2>

<h3>Description</h3>

<p>Main optimization function for <code>bfpca</code>. If <code>npc_varExplained</code>
is specified, the function simply returns a list with elements <code>npc</code>
(chosen number of FPCs), <code>evalues</code> (estimated variances of the first 'npc'
FPCs) and <code>evalues_sum</code> (sum of the estimated variances of the first 20
FPCs, as approximation of the overall variance).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bfpca_optimization(
  npc,
  npc_varExplained = NULL,
  Kt,
  maxiter,
  print.iter,
  seed,
  periodic,
  error_thresh,
  verbose,
  Y,
  rows,
  I,
  knots,
  Theta_phi,
  xi,
  alpha_coefs
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>The number of functional principal components (FPCs)
has to be specified either directly as <code>npc</code> or based on their explained
share of variance. In the latter case, <code>npc_varExplained</code> has to be set
to a share between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc_varExplained</code></td>
<td>
<p>The number of functional principal components (FPCs)
has to be specified either directly as <code>npc</code> or based on their explained
share of variance. In the latter case, <code>npc_varExplained</code> has to be set
to a share between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kt</code></td>
<td>
<p>Number of B-spline basis functions used to estimate mean functions
and functional principal components. Default is 8. If <code>npc_varExplained</code>
is used, <code>Kt</code> is set to 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations to perform for EM algorithm. Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.iter</code></td>
<td>
<p>Prints current error and iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Set seed for reproducibility. Defaults to 1988.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodic</code></td>
<td>
<p>If TRUE, uses periodic b-spline basis functions. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_thresh</code></td>
<td>
<p>Error threshold to end iterations. Defaults to 0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Can be set to integers between 0 and 4 to control the level of
detail of the printed diagnostic messages. Higher numbers lead to more detailed
messages. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y, rows, I, knots, Theta_phi, xi, alpha_coefs</code></td>
<td>
<p>Internal objects created in
<code>bfpca</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with elements <code>t_vec</code>, <code>Theta_phi_mean</code>, <code>alpha_coefs</code>,
<code>efunctions</code>, <code>evalues</code>, <code>evalues_sum</code>, <code>scores</code>,
<code>subject_coef</code>, <code>fittedVals</code>, <code>error</code>. See documentation of
<code>fpca_gauss</code> for details.
</p>


</div>