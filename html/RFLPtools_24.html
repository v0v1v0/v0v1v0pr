<div class="container">

<table style="width: 100%;"><tr>
<td>simMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Similarity matrix for BLAST data.
</h2>

<h3>Description</h3>

<p>Function to compute similarity matrix for all-vs-all BLAST results of rDNA sequences 
generated with standalone BLAST from NCBI or local BLAST implemented in BioEdit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simMatrix(x, sequence.range = FALSE, Min, Max)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data.frame with BLAST data; see <code>BLASTdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequence.range</code></td>
<td>
<p> logical: use sequence range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Min</code></td>
<td>
<p> minimum sequence length. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Max</code></td>
<td>
<p> maximum sequence length. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The given BLAST data is used to compute a similarity matrix using the following algorithm:
First, the length of each sequence (LS) comprised in the input data file is extracted. 
If there is more than one comparison for one sequence including different parts of the 
respective sequence, that one with maximum base length is chosen. 
Subsequently, the number of matching bases (mB) is calculated by multiplying 
two variables comprised in the BLAST output: the identity between sequences (%) and 
the number of nucleotides divided by 100. The, resulting value is rounded to integer. 
Furthermore, the similarity is calculated by dividing mB by LS. 
Finally, the similarity matrix including all sequences is built. 
If the similarity of a combination is not shown in the BLAST report file (because 
the similarity was lower than 70%), this comparison is included in the similarity 
matrix with the result zero.
</p>


<h3>Value</h3>

<p>Similarity matrix.
</p>


<h3>Author(s)</h3>

 
<p>Fabienne Flessa <a href="mailto:Fabienne.Flessa@uni-bayreuth.de">Fabienne.Flessa@uni-bayreuth.de</a>,<br>
Alexandra Kehl <a href="mailto:Alexandra.Kehl@uni-tuebingen.de">Alexandra.Kehl@uni-tuebingen.de</a>,<br>
Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a> 
</p>


<h3>References</h3>

<p>Standalone Blast download: <a href="https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/">https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/</a>
</p>
<p>Blast News: <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&amp;PAGE_TYPE=BlastNews">https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&amp;PAGE_TYPE=BlastNews</a>
</p>
<p>BioEdit: <a href="https://bioedit.software.informer.com/">https://bioedit.software.informer.com/</a>
</p>
<p>Persoh, D., Melcher, M., Flessa, F., Rambold, G.: 
First fungal community analyses of endophytic ascomycetes associated with Viscum album ssp. austriacum 
and itshost Pinus sylvestris. Fungal Biology 2010 Jul;114(7):585-96.
</p>
<p>Flessa, F., Kehl, A., Kohl, M.
Analysing diversity and community structures using PCR-RFLP: a new software application.
Molecular Ecology Resources 2013 Jul; 13(4):726-33. 
</p>


<h3>See Also</h3>

 <p><code>BLASTdata</code>, <code>sim2dist</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(BLASTdata)

## without sequence range
## code takes some time
## Not run: 
res &lt;- simMatrix(BLASTdata)

## End(Not run)

## with sequence range
range(BLASTdata$alignment.length)
res1 &lt;- simMatrix(BLASTdata, sequence.range = TRUE, Min = 100, Max = 450)
res2 &lt;- simMatrix(BLASTdata, sequence.range = TRUE, Min = 500)
</code></pre>


</div>