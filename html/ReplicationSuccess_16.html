<div class="container">

<table style="width: 100%;"><tr>
<td>powerSignificanceInterim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interim power of a replication study</h2>

<h3>Description</h3>

<p>Computes the power of a replication study taking into account data from an interim analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerSignificanceInterim(
  zo,
  zi,
  c = 1,
  f = 1/2,
  level = 0.025,
  designPrior = c("conditional", "informed predictive", "predictive"),
  analysisPrior = c("flat", "original"),
  alternative = c("one.sided", "two.sided"),
  shrinkage = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zo</code></td>
<td>
<p>Numeric vector of z-values from original studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zi</code></td>
<td>
<p>Numeric vector of z-values from interim analyses of replication studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Numeric vector of variance ratios of the original and replication effect estimates.
This is usually the ratio of the sample size of the replication study to the sample
size of the original study. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Fraction of the replication study already completed. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Significance level. Default is 0.025.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>designPrior</code></td>
<td>
<p>Either "conditional" (default), "informed predictive", or "predictive".
"informed predictive" refers to an informative normal prior coming from the original study.
"predictive" refers to a flat prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analysisPrior</code></td>
<td>
<p>Either "flat" (default) or "original".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Either "one.sided" (default) or "two.sided".
Specifies if the significance level is one-sided or two-sided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>Numeric vector with values in [0,1). Defaults to 0.
Specifies the shrinkage of the original effect estimate towards zero, e.g.,
the effect is shrunken by a factor of 25% for <code>shrinkage=0.25</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an extension of <code>powerSignificance()</code> and adapts the ‘interim power’
from section 6.6.3 of Spiegelhalter et al. (2004) to the setting of replication studies.
</p>
<p><code>powerSignificanceInterim</code> is the vectorized version of
<code>.powerSignificanceInterim_</code>.
<code>Vectorize</code> is used to vectorize the function.
</p>


<h3>Value</h3>

<p>The probability of statistical significance in the specified direction
at the end of the replication study given the data collected so far
in the replication study.
</p>


<h3>Author(s)</h3>

<p>Charlotte Micheloud
</p>


<h3>References</h3>

<p>Spiegelhalter, D. J., Abrams, K. R., and Myles, J. P. (2004).
Bayesian Approaches to Clinical Trials and Health-Care
Evaluation, volume 13. John Wiley &amp; Sons
</p>
<p>Micheloud, C., Held, L. (2022). Power Calculations for Replication Studies.
<em>Statistical Science</em>, <b>37</b>, 369-379.
<a href="https://doi.org/10.1214/21-STS828">doi:10.1214/21-STS828</a>
</p>


<h3>See Also</h3>

<p><code>sampleSizeSignificance</code>, <code>powerSignificance</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">powerSignificanceInterim(zo = 2, zi = 2, c = 1, f = 1/2,
                         designPrior = "conditional",
                         analysisPrior = "flat")

powerSignificanceInterim(zo = 2, zi = 2, c = 1, f = 1/2,
                         designPrior = "informed predictive",
                         analysisPrior = "flat")

powerSignificanceInterim(zo = 2, zi = 2, c = 1, f = 1/2,
                         designPrior = "predictive",
                         analysisPrior = "flat")

powerSignificanceInterim(zo = 2, zi = -2, c = 1, f = 1/2,
                         designPrior = "conditional",
                         analysisPrior = "flat")

powerSignificanceInterim(zo = 2, zi = 2, c = 1, f = 1/2,
                         designPrior = "conditional",
                         analysisPrior = "flat",
                         shrinkage = 0.25)
</code></pre>


</div>