<div class="container">

<table style="width: 100%;"><tr>
<td>internals_for_RobAStBase_ddPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal / Helper functions of package RobAStBase for ddPlot</h2>

<h3>Description</h3>

<p>This function is an internally used helper function for <code>ddPlot</code> in package <span class="pkg">RobAStBase</span>.</p>


<h3>Usage</h3>

<pre><code class="language-R">.ddPlot.MatNtNtCoCo(data, ..., dist.x = NormType(), dist.y  = NormType(),
cutoff.x = cutoff(norm = dist.x, cutoff.quantile  = cutoff.quantile.x),
cutoff.y = cutoff(norm = dist.y, cutoff.quantile  = cutoff.quantile.y),
cutoff.quantile.x = 0.95,  cutoff.quantile.y = cutoff.quantile.x,
transform.x,transform.y = transform.x, id.n, cex.pts = 1, lab.pts,
jitter.pts = 0, alpha.trsp = NA, adj =0,cex.idn = 1,col.idn = par("col"),
lty.cutoff,lwd.cutoff,col.cutoff = "red",text.abline = TRUE,
text.abline.x = NULL, text.abline.y = NULL,cex.abline = par("cex"), 
col.abline = col.cutoff,font.abline = par("font"), adj.abline = c(0,0),
text.abline.x.x = NULL, text.abline.x.y = NULL, text.abline.y.x = NULL, 
text.abline.y.y = NULL, text.abline.x.fmt.cx = "%7.2f",
text.abline.x.fmt.qx = "%4.2f%%", text.abline.y.fmt.cy = "%7.2f",
text.abline.y.fmt.qy = "%4.2f%%", jitter.fac = 10,
jitter.tol = .Machine$double.eps, doplot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data in <code>matrix</code> form (columns are observations; rows are variable
dimensions) at which to produce the <code>ddPlot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to <code>plot.default</code>, <code>text</code>, and <code>abline</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.x</code></td>
<td>
<p>object of class <code>NormType</code>; the distance for the <code>x</code> axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.y</code></td>
<td>
<p>object of class <code>NormType</code>; the distance for the <code>y</code> axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.x</code></td>
<td>
<p>object of class <code>cutoff</code>; the cutoff information for the <code>x</code> axis
(the vertical line discriminating 'good' and 'bad' points).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.y</code></td>
<td>
<p>object of class <code>cutoff</code>; the cutoff information for the <code>y</code> axis
(the horizontal line discriminating 'good' and 'bad' points).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.quantile.x</code></td>
<td>
<p>numeric; the cutoff quantile for the <code>x</code> axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.quantile.y</code></td>
<td>
<p>numeric; the cutoff quantile for the <code>y</code> axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform.x</code></td>
<td>
<p>function; a transformation to be performed before determining  the
distances of the <code>x</code> axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform.y</code></td>
<td>
<p>function; a transformation to be performed before determining  the
distances of the <code>y</code> axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.n</code></td>
<td>
<p>a set of indices (or a corresponding logical vector); to select a subset
of the data in argument <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pts</code></td>
<td>
<p>the corresponding <code>cex</code> argument for plotted points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.pts</code></td>
<td>
<p>a vector of labels for the (unsubsetted) <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.pts</code></td>
<td>
<p>the corresponding <code>jitter</code> argument for plotted points;
may be a vector of length 2 – for separate factors for x- and y-coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.trsp</code></td>
<td>
<p>alpha transparency to be added ex post to colors
<code>col.pch</code> and <code>col.lbl</code>; if one-dim and NA all colors are
left unchanged. Otherwise, with usual recycling rules <code>alpha.trsp</code>
gets shorted/prolongated to length the data-symbols to be plotted.
Coordinates of this vector <code>alpha.trsp</code> with NA are left unchanged,
while for the remaining ones, the alpha channel in rgb space is set
to the respective coordinate value of <code>alpha.trsp</code>. The non-NA
entries must be integers in [0,255] (0 invisible, 255 opaque).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>the corresponding argument for <code>text</code> for
labelling the outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.idn</code></td>
<td>
<p>the corresponding <code>cex</code> argument for
<code>text</code> for labelling the outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.idn</code></td>
<td>
<p>the corresponding <code>col</code> argument for
<code>text</code> for labelling the outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.cutoff</code></td>
<td>
<p>the corresponding <code>lty</code> argument for
<code>abline</code> for drawing the cutoff lines;
either one lty-value (one value or vector) or a list of length 2
of lty-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.cutoff</code></td>
<td>
<p>(vector cast to length 2): the corresponding <code>lwd</code> argument for
<code>abline</code> for drawing the cutoff lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.cutoff</code></td>
<td>
<p>(vector cast to length 2): the corresponding <code>col</code> argument for
<code>abline</code> for drawing the cutoff lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline</code></td>
<td>
<p>vector of logicals (cast to length 2): shall text be added
to cutoff lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.x</code></td>
<td>
<p>text to be added to cutoff lines in x direction; if <code>NULL</code>
(default) we use “[pp] %-cutoff = [ff]” where [pp] is the percentag up to 2 digits
and [ff] is the cutoff value up to 2 digits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.y</code></td>
<td>
<p>text to be added to cutoff lines in y direction; if <code>NULL</code>
(default) we use “[pp] %-cutoff = [ff]” where [pp] is the percentag up to 2 digits
and [ff] is the cutoff value up to 2 digits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.abline</code></td>
<td>
<p>vector of numerics (cast to length 2): cex-value for added cutoff text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.abline</code></td>
<td>
<p>vector of length 2: color for added cutoff text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.abline</code></td>
<td>
<p>vector of length 2: font for added cutoff text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.abline</code></td>
<td>
<p>cast to 2 x 2 matrix (by recycling rules): adjustment values for added cutoff text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.x.y</code></td>
<td>
<p>y-coordinate of text to be added to cutoff lines in x direction;
if <code>NULL</code> (default) set to mid of <code>mean(par("usr")[c(3,4)])</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.y.x</code></td>
<td>
<p>x-coordinate of text to be added to cutoff lines in y direction;
if <code>NULL</code> (default) set to mid of <code>mean(par("usr")[c(1,2)])</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.x.x</code></td>
<td>
<p>x-coordinate of text to be added to cutoff lines in x direction;
if <code>NULL</code> (default) set to 1.05 times the cutoff value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.y.y</code></td>
<td>
<p>y-coordinate of text to be added to cutoff lines in y direction;
if <code>NULL</code> (default) set to 1.05 times the cutoff value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.x.fmt.cx</code></td>
<td>
<p>format string (see <code>gettextf</code>) to format the cutoff value in label in x direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.x.fmt.qx</code></td>
<td>
<p>format string to format cutoff probability in label in x direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.y.fmt.cy</code></td>
<td>
<p>format string to format the cutoff value in label in y direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.abline.y.fmt.qy</code></td>
<td>
<p>format string to format cutoff probability in label in y direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.fac</code></td>
<td>
<p>factor for jittering, see <code>jitter</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.tol</code></td>
<td>
<p>threshold for jittering: if distance between points is smaller
than <code>jitter.tol</code>, points are considered replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doplot</code></td>
<td>
<p>logical; shall a plot be produced? if <code>FALSE</code> only the return values are produced.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>performs the plotting for <code>ddPlot</code> and <code>outlyingPlotIC</code>;
all arguments except for <code>data</code> are optional. In case they are missing
default values are used as usual; for those arguments without default arguments,
we do
</p>

<dl>
<dt>transform.x</dt>
<dd>
<p>defaults to identity, internally</p>
</dd>
</dl>
<p>.
</p>
<dl>
<dt>id.n</dt>
<dd>
<p>defaults to <code>1:ncol(data)</code>, internally</p>
</dd>
</dl>
<p>.
</p>
<dl>
<dt>lab.pts</dt>
<dd>
<p>defaults to <code>(1:ncol(data))[id.n]</code>, internally</p>
</dd>
</dl>
<p>.
</p>
<dl>
<dt>lwd.cutoff</dt>
<dd>
<p>defaults to argument <code>lwd</code>, if given, else to <code>par{lwd}</code>, internally</p>
</dd>
</dl>
<p>.
</p>
<dl>
<dt>lty.cutoff</dt>
<dd>
<p>defaults to argument <code>lty</code>, if given, else to <code>par{lty}</code>, internally</p>
</dd>
</dl>
<p>.

</p>


<h3>Value</h3>

<p>a list (returned as <code>invisible()</code>) with items
</p>
<table>
<tr style="vertical-align: top;">
<td><code>id.x</code></td>
<td>
<p>the indices of (possibly transformed) data (within subset <code>id.n</code>) beyond the <code>x</code>-cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.y</code></td>
<td>
<p>the indices of (possibly transformed) data (within subset <code>id.n</code>) beyond the <code>y</code>-cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.xy</code></td>
<td>
<p>the indices of (possibly transformed) data (within subset <code>id.n</code>) beyond the <code>x</code>-cutoff and the <code>y</code>-cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qtx</code></td>
<td>
<p>the quantiles of the distances of the (possibly transformed) data in <code>x</code> direction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qty</code></td>
<td>
<p>the quantiles of the distances of the (possibly transformed) data in <code>y</code> direction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.x.v</code></td>
<td>
<p>the cutoff value in <code>x</code> direction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.y.v</code></td>
<td>
<p>the cutoff value in <code>y</code> direction</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Ruckdeschel <a href="mailto:peter.ruckdeschel@uni-oldenburg.de">peter.ruckdeschel@uni-oldenburg.de</a>
</p>


<h3>See Also</h3>

<p><code>plot.default</code>, <code>par</code>,
<code>ddPlot</code>, <code>outlyingPlotIC</code></p>


<h3>Examples</h3>

<pre><code class="language-R">MX &lt;- matrix(rnorm(1500),nrow=6)
QM &lt;- matrix(rnorm(36),nrow=6); QM &lt;- QM %*% t(QM)
RobAStBase:::.ddPlot.MatNtNtCoCo(data=MX, 
        dist.y=QFNorm(QuadF=PosSemDefSymmMatrix(QM)),
        xlab="Norm.x",ylab="Norm.y", cex.idn = 1.3, offset=0,
        lwd=2, lwd.cutoff=4, lty=2, col.cutoff =2, col.idn="green",
        col = "blue", adj=0.4, pos=4,id.n = sample(1:200,size=100),
        lab.pts=letters,log="x", main="GA", sub="NO",cex.sub=0.2)
</code></pre>


</div>