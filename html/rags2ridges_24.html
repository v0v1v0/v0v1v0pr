<div class="container">

<table style="width: 100%;"><tr>
<td>fullMontyS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wrapper function</h2>

<h3>Description</h3>

<p>Function that forms a wrapper around certain <code>rags2ridges</code>
functionalities. More specifically, it (automatically) invokes
functionalities to get from high-dimensional data to a penalized precision
estimate, to the corresponding conditional independence graph and topology
summaries.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fullMontyS(
  Y,
  lambdaMin,
  lambdaMax,
  target = default.target(covML(Y)),
  dir = getwd(),
  fileTypeFig = "pdf",
  FDRcut = 0.9,
  nOutput = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Data <code>matrix</code>. Variables assumed to be represented by columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaMin</code></td>
<td>
<p>A <code>numeric</code> giving the minimum value for the penalty
parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaMax</code></td>
<td>
<p>A <code>numeric</code> giving the maximum value for the penalty
parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>A target <code>matrix</code> (in precision terms) for Type I ridge
estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>A <code>character</code> specifying the directory in which the (visual)
output is to be stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileTypeFig</code></td>
<td>
<p>A <code>character</code> determining the file type of visual
output. Must be one of: "pdf", "eps".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDRcut</code></td>
<td>
<p>A <code>numeric</code> indicating the cut-off for partial
correlation element selection based on local FDR thresholding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nOutput</code></td>
<td>
<p>A <code>logical</code> indicating if numeric output should be
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A <code>logical</code> indicating if progress updates should be
printed on screen.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The wrapper always uses the alternative ridge precision estimator (see
<code>ridgeP</code>) with <code>target</code> as the target matrix. The optimal
value for the penalty parameter is determined by employing Brent's method to
the calculation of a cross-validated negative log-likelihood score (see
<code>optPenalty.LOOCVauto</code>). The support of the regularized
precision matrix is determined by way of local FDR thresholding (see
<code>sparsify</code>). The corresponding conditional independence graph is
visualized using <code>Ugraph</code> with <code>type = "fancy"</code>. This
visualization as well as the calculation of network statistics (see
<code>GGMnetworkStats</code>) is based on the standardization of the
regularized and sparsified precision matrix to a partial correlation matrix.
</p>


<h3>Value</h3>

<p>The function stores in the specified directory <code>dir</code> a
condition number plot (either .pdf or .eps file), a visualization of the
network (either .pdf or .eps file), and a file containing network statistics
(.txt file). When <code>nOutput = TRUE</code> the function also returns an object
of class <code>list</code>: </p>
<table>
<tr style="vertical-align: top;">
<td><code>optLambda</code></td>
<td>
<p>A <code>numeric</code> giving the optimal
value of the penalty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optPrec</code></td>
<td>
<p>A <code>matrix</code> representing
the regularized precision matrix under the optimal value of the penalty
parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparseParCor</code></td>
<td>
<p>A <code>matrix</code> representing the sparsified
partial correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>networkStats</code></td>
<td>
<p>A <code>matrix</code> giving the
calculated network statistics.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>We consider this to be a preliminary version of an envisioned wrapper
than will take better form with subsequent versions of <code>rags2ridges</code>.
</p>


<h3>Author(s)</h3>

<p>Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;, Wessel N. van Wieringen
</p>


<h3>See Also</h3>

<p><code>ridgeP</code>, <code>conditionNumberPlot</code>,
<code>optPenalty.LOOCVauto</code>, <code>sparsify</code>,
<code>Ugraph</code>, <code>GGMnetworkStats</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
## Obtain some (high-dimensional) data
p = 25
n = 10
set.seed(333)
X = matrix(rnorm(n*p), nrow = n, ncol = p)
colnames(X)[1:25] = letters[1:25]

## Employ the wrapper function
theWorks &lt;- fullMontyS(X, lambdaMin = .5, lambdaMax = 30)
## End(Not run)
</code></pre>


</div>