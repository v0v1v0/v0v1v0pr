<div class="container">

<table style="width: 100%;"><tr>
<td>r4</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust reduced-rank regression</h2>

<h3>Description</h3>

<p>Perform robust reduced-rank regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">r4(
  Y,
  X,
  maxrank = min(dim(Y), dim(X)),
  method = c("rowl0", "rowl1", "entrywise"),
  Gamma = NULL,
  ic.type = c("AIC", "BIC", "PIC"),
  modstr = list(),
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a matrix of response (n by q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix of covariate (n by p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxrank</code></td>
<td>
<p>maximum rank for fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>outlier detection method, either entrywise or rowwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>weighting matrix in the loss function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic.type</code></td>
<td>
<p>information criterion, AIC, BIC or PIC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modstr</code></td>
<td>
<p>a list of model parameters controlling the model
fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of parameters for controlling the fitting process</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model parameters can be controlled through argument <code>modstr</code>.
The available elements include
</p>

<ul>
<li>
<p>nlam: parameter in the augmented Lagrangian function.
</p>
</li>
<li>
<p>adaptive: if <code>TRUE</code>, use leverage values for adaptive
penalization.  The default value is <code>FALSE</code>.
</p>
</li>
<li>
<p>weights: user supplied weights for adaptive penalization.
</p>
</li>
<li>
<p>minlam: maximum proportion of outliers.
</p>
</li>
<li>
<p>maxlam: maximum proportion of good observations.
</p>
</li>
<li>
<p>delid: discarded observation indices for initial estimation.
</p>
</li>
</ul>
<p>The model fitting can be controlled through argument <code>control</code>.
The available elements include
</p>

<ul>
<li>
<p>epsilon: convergence tolerance.
</p>
</li>
<li>
<p>maxit: maximum number of iterations.
</p>
</li>
<li>
<p>qr.tol: tolerance for qr decomposition.
</p>
</li>
<li>
<p>tol: tolerance.
</p>
</li>
</ul>
<h3>Value</h3>

<p>a list consisting of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coef.path</code></td>
<td>
<p>solutuon path of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.path</code></td>
<td>
<p>solutuon path of sparse mean shifts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.norm.path</code></td>
<td>
<p>solutuon path of the norms of sparse mean shifts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic.path</code></td>
<td>
<p>paths of information criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic.smooth.path</code></td>
<td>
<p>smoothed paths of information criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.path</code></td>
<td>
<p>paths of the tuning parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.solution</code></td>
<td>
<p>ids of the selected solutions on the path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic.best</code></td>
<td>
<p>lowest values of the information criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank.best</code></td>
<td>
<p>rank values of selected solutions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>estimated regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>estimated sparse mean shifts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>rank estimate</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>She, Y. and Chen, K. (2017) Robust reduced-rank regression.
<em>Biometrika</em>, 104 (3), 633â€“647.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(rrpack)
n &lt;- 100; p &lt;- 500; q &lt;- 50
xrank &lt;- 10; nrank &lt;- 3; rmax &lt;- min(n, p, q, xrank)
nlam &lt;- 100; gamma &lt;- 2
rho_E &lt;- 0.3
rho_X &lt;- 0.5
nlev &lt;- 0
vlev &lt;- 0
vout &lt;- NULL
vlevsd &lt;- NULL
nout &lt;- 0.1 * n
s2n &lt;- 1
voutsd &lt;- 2
simdata &lt;- rrr.sim5(n, p, q, nrank, rx = xrank, s2n = s2n,
                    rho_X = rho_X, rho_E = rho_E, nout = nout, vout = vout,
                    voutsd = voutsd,nlev = nlev,vlev=vlev,vlevsd=vlevsd)
Y &lt;- simdata$Y
X &lt;- simdata$X
fit &lt;- r4(Y, X, maxrank = rmax,
               method = "rowl0", ic.type= "PIC")
summary(fit)
coef(fit)
which(apply(fit$s,1,function(a)sum(a^2))!=0)

## End(Not run)
</code></pre>


</div>