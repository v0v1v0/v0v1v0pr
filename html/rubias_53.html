<div class="container">

<table style="width: 100%;"><tr>
<td>tcf2long</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Two-Column Genetic Data to Long Format</h2>

<h3>Description</h3>

<p>Takes a data frame consisting of metadata followed by paired columns of genetic data,
with each column in the pair representing a gene copy at a locus.
Returns a list of two data frames: one with genetic data condensed into one column,
and the other with two-column structure intact, but with cleaned allele names.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tcf2long(D, gen_start_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A data frame containing two-column genetic data, optionally preceded by metadata.
The header of the first genetic data column in each pair lists the locus name, the second is ignored.
<strong>Locus names must not have spaces in them!</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen_start_col</code></td>
<td>
<p>The index (number) of the column in which genetic data starts.
Columns must be only genetic data after genetic data starts.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>tcf2long</code> returns a list of two data frames: in the first, "long", the rightmost
column is the genetic data. Two new columns, "locus" and "gene copy", duplicate the original
column name provided in the first of each pair, and designate copies "a" and "b", respectively.
Metadata is duplicated as necessary for each locus. The second, "clean_short", replicates the
input dataset, but with column names replaced by "(locus name) a" and "(locus name) b" in each pair.
In other words the locus name has an "a" or a "b" added to it <em>after a space</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Convert the alewife dataset for further processing
# the data frame passed into this function must have had
# character collections and repunits converted to factors
reference &lt;- alewife
reference$repunit &lt;- factor(reference$repunit, levels = unique(reference$repunit))
reference$collection &lt;- factor(reference$collection, levels = unique(reference$collection))
ale_long &lt;- tcf2long(reference, 17)
</code></pre>


</div>