<div class="container">

<table style="width: 100%;"><tr>
<td>rbmf.O2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a <code>2*2</code> Orthogonal Random Matrix</h2>

<h3>Description</h3>

<p>Simulate a <code>2*2</code> random orthogonal matrix from the Bingham-von
Mises-Fisher distribution using a rejection sampler.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rbmf.O2(A, B, C, env = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a symmetric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a diagonal matrix with decreasing entries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>a 2x2 matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>which rejection envelope to use, Bingham (<code>bingham</code>) or von
Mises-Fisher (<code>mf</code>)?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A random 2x2 orthogonal matrix simulated from the Bingham-von
Mises-Fisher distribution.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>References</h3>

<p>Hoff(2009)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## The function is currently defined as
function (A, B, C, env = FALSE) 
{
    sC &lt;- svd(C)
    d1 &lt;- sum(sC$d)
    eA &lt;- eigen(A)
    ab &lt;- sum(eA$val * diag(B))
    if (d1 &lt;= ab | env == "bingham") {
        lrmx &lt;- sum(sC$d)
        lr &lt;- -Inf
        while (lr &lt; log(runif(1))) {
            X &lt;- rbing.O2(A, B, a = (eA$val[1] - eA$val[2]) * 
                (B[1, 1] - B[2, 2]), E = eA$vec)
            lr &lt;- sum(diag(t(X) %*% C)) - lrmx
        }
    }
    if (d1 &gt; ab | env == "mf") {
        lrmx &lt;- sum(eA$val * sort(diag(B), decreasing = TRUE))
        lr &lt;- -Inf
        while (lr &lt; log(runif(1))) {
            X &lt;- rmf.matrix(C)
            lr &lt;- sum(diag(B %*% t(X) %*% A %*% X)) - lrmx
        }
    }
    X
  }

</code></pre>


</div>