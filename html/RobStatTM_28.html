<div class="container">

<table style="width: 100%;"><tr>
<td>lmrobdetMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Linear Regression Estimators</h2>

<h3>Description</h3>

<p>This function computes an MM-regression estimators for linear models
using deterministic starting points.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmrobdetMM(
  formula,
  data,
  subset,
  weights,
  na.action,
  model = TRUE,
  x = !control$compute.rd,
  y = FALSE,
  singular.ok = TRUE,
  contrasts = NULL,
  offset = NULL,
  control = lmrobdet.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment containing
the variables in the model. If not found in <code>data</code>, model variables
are taken from <code>environment(formula)</code>, which usually is the
root environment of the current R session.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function to indicates what should happen when the data contain NAs.
The default is set by the na.action setting of <code>options</code>, and is
<code>na.fail</code> if that is unset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>logical value indicating whether to return the model frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>logical value indicating whether to return the model matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>logical value indicating whether to return the vector of responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>logical value. If <code>FALSE</code> a singular fit produces an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of model.matrix.default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be included
in the linear predictor during fitting. An offset term can be included in the formula
instead or as well, and if both are specified their sum is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list specifying control parameters as returned by the function
lmrobdet.control.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes MM-regression estimators
computed using Pen~a-Yohai candidates (instead of subsampling ones).
This function makes use of the functions <code>lmrob.fit</code>,
<code>lmrob..M..fit</code>, <code>.vcov.avar1</code>, <code>lmrob.S</code> and
<code>lmrob.lar</code>, from robustbase,
along with utility functions used by these functions,
modified so as to include use of the analytic form of the
optimal psi and rho functions (for the optimal psi function , see
Section 5.8.1 of Maronna, Martin, Yohai and Salibian Barrera, 2019).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>The estimated vector of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>The robust residual M-scale estimate using the final residuals from the converged iterated weighted least square (IRWLS) algorithm final estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>The vector of residuals associated with the robust fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>
<p>Value of the objective function at the final MM-estimator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>Logical value indicating whether IRWLS iterations for the MM-estimator have converged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of IRWLS iterations for the MM-estimator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rweights</code></td>
<td>
<p>Robustness weights for the MM-estimator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>Fitted values associated with the robust fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>Numeric rank of the fitted linear model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>The estimated covariance matrix of the regression estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>The residual degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree.freedom</code></td>
<td>
<p>The residual degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.S</code></td>
<td>
<p>Minimum robust scale associated with the preliminary highly robust but inefficient S-estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.squared</code></td>
<td>
<p>The robust multiple correlation coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.r.squared</code></td>
<td>
<p>The adjusted robust multiple correlation coefficient taking into account the degrees of freedom of each term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>(only where relevant) the contrasts used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlevels</code></td>
<td>
<p>(only where relevant) a record of the levels of the factors used in fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>if requested, the model frame used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>if requested, the model matrix used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>if requested, the response vector used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>The terms object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters.py</code></td>
<td>
<p>The number of refinement iterations for each Pena-Yohai candidate for the S-estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters.const</code></td>
<td>
<p>The number of refinement iterations used to compute the estimator without covariates (to calculate the robust R^2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assign</code></td>
<td>
<p>Used to separate continuous from categorical columns in the design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>(where relevant) information returned by model.frame on the special handling of NAs</p>
</td>
</tr>
</table>
<h3>Choice of Rho Loss Function</h3>

<p>This is done by the user choice of family = "opt" or family = "mopt"
in the function lmrobdet.control. As of RobStatTM Versopm 1.0.7, the
opt and mopt rhos functions are calculated using polynomials, rather
than using the standard normal error function (erf) as in versions of
RobStatTM prior to 1.0.7. The numerical results one now gets with the
opt or mopt choices will differ by small amounts from those in earlier
RobStatTM versions. Users who wish to replicate results from releases
prior to 1.0.7 may do so using the family arguments family = "optV0" 
or family = "moptV0". Note that the derivative of the rho loss function,
known as the "psi" function, is not the derivative of the rho polynomial,
instead it is still the optimal psi function referred to above.
</p>


<h3>Related Vignettes</h3>

<p>For further details, see the Vignettes "Polynomial Opt and mOpt Rho Functions",
and "Optimal Bias Robust Regression Psi and Rho".
</p>


<h3>Author(s)</h3>

<p>Matias Salibian-Barrera, <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a>, based on <code>lmrob</code> from package <code>robustbase</code>
</p>


<h3>References</h3>

<p><a href="http://www.wiley.com/go/maronna/robust">http://www.wiley.com/go/maronna/robust</a>
</p>


<h3>See Also</h3>

<p>DCML, MMPY, SMPY
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(coleman, package='robustbase')
m2 &lt;- lmrobdetMM(Y ~ ., data=coleman)
m2
summary(m2)

</code></pre>


</div>