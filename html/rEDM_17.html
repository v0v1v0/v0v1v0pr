<div class="container">

<table style="width: 100%;"><tr>
<td>Simplex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simplex forecasting</h2>

<h3>Description</h3>

<p><code>Simplex</code> performs time series forecasting based on
weighted nearest neighbors projection in the time series phase space as
described in <cite>Sugihara and May</cite>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Simplex(pathIn = "./", dataFile = "", dataFrame = NULL, pathOut = "./", 
  predictFile = "", lib = "", pred = "", E = 0, Tp = 1, knn = 0, tau = -1, 
  exclusionRadius = 0, columns = "", target = "", embedded = FALSE,
  verbose = FALSE, validLib = vector(), generateSteps = 0,
  parameterList = FALSE, showPlot = FALSE, noTime = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathOut</code></td>
<td>
<p>path for <code>predictFile</code> containing output predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictFile</code></td>
<td>
<p>output file name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lib</code></td>
<td>
<p>string or vector with start and stop indices of input data
rows used to create the library from observations. Mulitple row index
pairs can be specified with each pair defining the first and last
rows of time series observation segments used to create the library.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>string with start and stop indices of input data rows used for
predictions. A single contiguous range is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>embedding dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to E+1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>column name used for prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validLib</code></td>
<td>
<p>logical vector the same length as the number of data
rows.  Any data row represented in this vector as FALSE, will not be
included in the library.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generateSteps</code></td>
<td>
<p>number of predictive feedback generative steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterList</code></td>
<td>
<p>logical to add list of invoked parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If embedded is <code>FALSE</code>, the data <code>column(s)</code> are embedded to
dimension <code>E</code> with time lag <code>tau</code>. This embedding forms an
E-dimensional phase space for the <code>Simplex</code> projection.
If embedded is <code>TRUE</code>, the data are assumed to contain an
E-dimensional embedding with E equal to the number of <code>columns</code>.
Predictions are made using leave-one-out cross-validation, i.e.
observation vectors are excluded from the prediction simplex. 
</p>
<p>To assess an optimal embedding dimension <code>EmbedDimension</code>
can be applied. Accuracy statistics can be estimated by
<code>ComputeError</code>.
</p>


<h3>Value</h3>

<p>A data.frame with columns <code>Observations, Predictions</code>.
The first column contains the time values.
</p>
<p>If <code>parameterList = TRUE</code>, a named list with "predictions" holding the
data.frame, "parameters" with a named list of invoked parameters.
</p>


<h3>References</h3>

<p>Sugihara G. and May R. 1990. Nonlinear forecasting as a way
of distinguishing chaos from measurement error in time series.
Nature, 344:734-741.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( block_3sp )
smplx = Simplex( dataFrame = block_3sp, lib = "1 100", pred = "101 190",
E = 3, columns = "x_t", target = "x_t" )
ComputeError( smplx $ Predictions, smplx $ Observations )
</code></pre>


</div>