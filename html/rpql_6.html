<div class="container">

<table style="width: 100%;"><tr>
<td>nb2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A negative binomial family</h2>

<h3>Description</h3>

<p>Since the negative binomial is not a family in base <code>R</code>, an <code>nb2()</code> family has been created which establishes the negative binomial as a family for use in the main <code>rpql</code> function. Only the log link is available at the moment, with the variance parameterized as <code class="reqn">V = \mu + \phi\mu^2</code> where <code class="reqn">\phi</code> is the overdispersion parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> 
nb2()
  </code></pre>


<h3>Details</h3>

<p>Used in the form <code>rpql(y, ..., family = nb2(), ...)</code>.
</p>


<h3>Value</h3>

<p>An object of class "family"
</p>


<h3>Author(s)</h3>

<p>Francis K.C. Hui &lt;francis.hui@gmail.com&gt;, with contributions from Samuel Mueller &lt;samuel.mueller@sydney.edu.au&gt; and A.H. Welsh &lt;Alan.Welsh@anu.edu.au&gt;
</p>
<p>Maintainer: Francis Hui &lt;fhui28@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>negative.binomial</code> in the <code>MASS</code> package for another example of a negative.binomial family. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## The function is currently defined as follows
nb2 &lt;- function () {
    link &lt;- "log"
    linkfun &lt;- function(mu) log(mu)
    linkinv &lt;- function(eta) pmax(exp(eta), .Machine$double.eps)
    mu.eta &lt;- function(eta) pmax(exp(eta), .Machine$double.eps)
    variance &lt;- function(mu, phi) mu + phi * mu^2
    valideta &lt;- function(eta) TRUE
    validmu &lt;- function(mu) all(mu &gt; 0)
    structure(list(family = "negative.binomial", link = "log", 
        linkfun = linkfun, linkinv = linkinv, mu.eta = mu.eta, 
        variance = variance, valideta = valideta, validmu = validmu, 
        name = link), class = "family")
  }

## End(Not run)  
</code></pre>


</div>