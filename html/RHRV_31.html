<div class="container">

<table style="width: 100%;"><tr>
<td>CalculateMaxLyapunov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum lyapunov exponent</h2>

<h3>Description</h3>

<p>Functions for estimating the maximal Lyapunov exponent of  the RR time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalculateMaxLyapunov(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  minEmbeddingDim = NULL,
  maxEmbeddingDim = NULL,
  timeLag = NULL,
  radius = 2,
  theilerWindow = 100,
  minNeighs = 5,
  minRefPoints = 500,
  numberTimeSteps = 20,
  doPlot = TRUE
)

EstimateMaxLyapunov(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  regressionRange = NULL,
  useEmbeddings = NULL,
  doPlot = TRUE
)

PlotMaxLyapunov(
  HRVData,
  indexNonLinearAnalysis = length(HRVData$NonLinearAnalysis),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>HRVData</code></td>
<td>
<p>Data structure that stores the beats register and information related to it</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexNonLinearAnalysis</code></td>
<td>
<p>Reference to the data structure that will contain the nonlinear analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minEmbeddingDim</code></td>
<td>
<p>Integer denoting the minimum dimension in which we shall embed the time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxEmbeddingDim</code></td>
<td>
<p>Integer denoting the maximum dimension in which we shall embed the time series. Thus,
we shall estimate the correlation dimension between <em>minEmbeddingDim</em> and <em>maxEmbeddingDim</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeLag</code></td>
<td>
<p>Integer denoting the number of time steps that will be use to construct the 
Takens' vectors. Default: timeLag = 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Maximum distance in which will look for nearby trajectories. Default: radius = 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theilerWindow</code></td>
<td>
<p>Integer denoting the Theiler window:  Two Takens' vectors must be separated by more than
<em>theilerWindow</em> time steps in order to be considered neighbours. By using a Theiler window, temporally correlated 
vectors are excluded from the estimations.  Default: theilerWindow = 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNeighs</code></td>
<td>
<p>Minimum number of neighbours that a Takens' vector must have to be considered
a reference point. Default: minNeighs = 5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minRefPoints</code></td>
<td>
<p>Number of reference points that the routine will try to use. The routine stops when it finds 
<em>minRefPoints</em> reference points, saving computation time. Default: minRefPoints = 500</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numberTimeSteps</code></td>
<td>
<p>Integer denoting the number of time steps in which the algorithm will
compute the divergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>Logical value. If TRUE (default value), a plot of <code class="reqn">S(t)</code> Vs  <code class="reqn">t</code> is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regressionRange</code></td>
<td>
<p>Vector with 2 components denoting the range where the function will perform linear regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useEmbeddings</code></td>
<td>
<p>A numeric vector specifying which embedding dimensions should the algorithm use to compute
the maximal Lyapunov exponent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional plot parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is a well-known fact that close trajectories diverge exponentially fast in a chaotic system. The 
averaged exponent that determines the divergence rate is called the Lyapunov exponent (usually denoted with <code class="reqn">\lambda</code>). 
If <code class="reqn">\delta(0)</code> is the distance between two Takens' vectors in the embedding.dim-dimensional space, we expect that the distance
after a time <code class="reqn">t</code> between the two trajectories arising from this two vectors fulfills:
</p>
<p style="text-align: center;"><code class="reqn">\delta (n) \sim \delta (0)\cdot exp(\lambda \cdot t)</code>
</p>

<p>The lyapunov exponent is estimated using the slope obtained by performing a linear regression of 
<code class="reqn">S(t)=\lambda \cdot t \sim log(\delta (t)/\delta (0))</code> 
on  <code class="reqn">t</code>. <code class="reqn">S(t)</code> will be estimated by averaging the divergence of several reference points.
</p>
<p>The user should plot <code class="reqn">S(t) Vs t</code> when looking for the maximal lyapunov exponent and, if for some temporal range
<code class="reqn">S(t)</code> shows a linear behaviour, its slope is an estimate of the maximal Lyapunov exponent per unit of time. The estimate
routine allows the user to get always an estimate of the maximal Lyapunov exponent, but the user must check that there is a linear region in the  
<code class="reqn">S(t) Vs t</code>. If such a region does not exist, the estimation should be discarded.  The user should also
run the method for different embedding dimensions for checking if <code class="reqn">D_1</code> saturates.
</p>


<h3>Value</h3>

<p>The <em>CalculateMaxLyapunov</em> returns a HRVData structure containing the divergence computations of the 
RR time series under the <em>NonLinearAnalysis</em> list.
</p>
<p>The <em>EstimateMaxLyapunov</em> function estimates the maximum Lyapunov exponent of the 
RR time series  by performing a linear regression
over the time steps' range specified in <em>regressionRange</em>.If <em>doPlot</em> is TRUE,
a graphic of the regression over the data is shown. The 
results are returned into the <em>HRVData</em> structure, under the <em>NonLinearAnalysis</em> list.
</p>
<p><em>PlotMaxLyapunov</em> shows a graphic of the divergence Vs time
</p>


<h3>Note</h3>

<p>This function is based on the <code>maxLyapunov</code> function from the 
nonlinearTseries package.
</p>
<p>In order to run <em>EstimateMaxLyapunov</em>, it
is necessary to have performed the divergence computations before with <em>ComputeMaxLyapunov</em>.
</p>


<h3>References</h3>

<p>Eckmann, Jean-Pierre and Kamphorst, S Oliffson and Ruelle, David and Ciliberto, S and others. Liapunov exponents from time series.
Physical Review A, 34-6, 4971–4979, (1986).
</p>
<p>Rosenstein, Michael T and Collins, James J and De Luca, Carlo J.A practical method for calculating largest Lyapunov exponents from small data sets.
Physica D: Nonlinear Phenomena, 65-1, 117–134, (1993).
</p>


<h3>See Also</h3>

<p><code>maxLyapunov</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# ...
hrv.data = CreateNonLinearAnalysis(hrv.data)
hrv.data = CalculateMaxLyapunov(hrv.data,indexNonLinearAnalysis=1,
                                 minEmbeddingDim=5,
                                 maxEmbeddingDim = 5,
                                 timeLag=1,radius=10,
                                 theilerWindow=100, doPlot=FALSE)
PlotMaxLyapunov(hrv.data,indexNonLinearAnalysis=1)
hrv.data = EstimateMaxLyapunov(hrv.data,indexNonLinearAnalysis=1, 
                               regressionRange=c(1,10))

## End(Not run)
</code></pre>


</div>