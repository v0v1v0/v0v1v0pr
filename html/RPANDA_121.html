<div class="container">

<table style="width: 100%;"><tr>
<td>plot_fit_env</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot speciation, extinction &amp; net diversification rate functions of a fitted environmental model
</h2>

<h3>Description</h3>

<p>Plot estimated speciation, extinction &amp; net diversification rates as a function of the environmental data and time
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_fit_env(fit.env, env_data, tot_time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit.env</code></td>
<td>

<p>an object of class 'fit.env', output of the 'fit_env' function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env_data</code></td>
<td>

<p>environmental data, given as a data frame with two columns. The first column is time, the second column is the environmental data (temperature for instance).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tot_time</code></td>
<td>

<p>the age of the phylogeny (crown age, or stem age if known). If working with crown ages, tot_time is given by max(node.age(phylo)$ages).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Plots representing how the estimated speciation, extinction &amp; net diversification rate functions vary as a function of the environmental data &amp; time
</p>


<h3>Author(s)</h3>

<p>H Morlon and FL Condamine</p>


<h3>See Also</h3>

<p><code>fit_env</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require(pspline)){
data(Balaenopteridae)
tot_time&lt;-max(node.age(Balaenopteridae)$ages)
data(InfTemp)
dof&lt;-smooth.spline(InfTemp[,1], InfTemp[,2])$df

# Fit the pure birth model (no extinction) with exponential variation of the speciation rate
# with temperature. 
f.lamb &lt;-function(t,x,y){y[1] * exp(y[2] * x)}
f.mu&lt;-function(t,x,y){0}
lamb_par&lt;-c(0.10, 0.01)
mu_par&lt;-c()
#result &lt;- fit_env(Balaenopteridae,InfTemp,tot_time,f.lamb,f.mu,
#      lamb_par,mu_par,f=1, fix.mu=TRUE, df=dof, dt=1e-3)

# plot fitted rates
#plot_fit_env(result, InfTemp, tot_time)
    }
  
</code></pre>


</div>