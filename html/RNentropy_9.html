<div class="container">

<table style="width: 100%;"><tr>
<td>RN_calc_LPV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

RN_calc_LPV
</h2>

<h3>Description</h3>


<p>This function calculates local p-values from expression data, output as -log10(p-value).
</p>


<h3>Usage</h3>

<pre><code class="language-R">RN_calc_LPV(X, design, bind = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>


<p>data.frame with expression values. It may contain additional non numeric columns (eg. a column with gene names)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>


<p>The design matrix. Refer to the help for RN_calc for further info.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bind</code></td>
<td>


<p>See Value (Default = TRUE)
</p>
</td>
</tr>
</table>
<h3>Value</h3>






<p>If bind is TRUE the function returns a data.frame with the original expression values from data.frame X and attached columns with the -log10(p-values) computed for each sample, otherwise only the matrix of -log10(p-values) is returned.
</p>


<h3>Author(s)</h3>


<p>Giulio Pavesi - Dep. of Biosciences, University of Milan
</p>
<p>Federico Zambelli - Dep. of Biosciences, University of Milan
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("RN_Brain_Example_tpm", "RN_Brain_Example_design")
LPV &lt;- RN_calc_LPV(RN_Brain_Example_tpm, RN_Brain_Example_design)
## The function is currently defined as

function(X, design = NULL, bind = TRUE)
{
  if(is.null(design))
  {
    design &lt;- .RN_default_design(sum(sapply(X, is.numeric)))
  }
  
	rnums &lt;- sapply(X, is.numeric)

	.RN_design_check(X, design, rnums)
	RL &lt;- .RN_get_replicate_list(design)
	
	l1 &lt;- rep("LOC_LPV", length(X[rnums]))
	l2 &lt;- colnames(X[rnums])
	PV &lt;- apply(X[rnums],  1, '.RN_calc_LPV_row', RL = RL)
	PV &lt;- t(PV)
	colnames(PV) &lt;- paste(l1, l2, sep="_")

	if(bind)
	{
		return (cbind(X, PV))
	}
	else
		return (PV)
}
</code></pre>


</div>