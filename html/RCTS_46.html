<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_beta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates beta.</h2>

<h3>Description</h3>

<p>Update step of algorithm to obtain new estimation for beta. Note that we call it beta_est because beta() exists in base R.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_beta(
  Y,
  X,
  beta_est,
  g,
  lambda_group,
  factor_group,
  lambda,
  comfactor,
  method_estimate_beta = "individual",
  S,
  k,
  kg,
  vars_est,
  robust,
  num_factors_may_vary = TRUE,
  optimize_kappa = FALSE,
  nosetting = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Y: NxT dataframe with the panel data of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>X: NxTxp array containing the observable variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_est</code></td>
<td>
<p>estimated values of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Vector with estimated group membership for all individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_group</code></td>
<td>
<p>loadings of the estimated group specific factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_group</code></td>
<td>
<p>estimated group specific factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>loadings of the estimated common factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comfactor</code></td>
<td>
<p>estimated common factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_estimate_beta</code></td>
<td>
<p>defines how beta is estimated. Default case is an estimated beta for each individual. Default value is "individual." Possible values are "homogeneous", "group" or "individual".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>number of estimated groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of common factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kg</code></td>
<td>
<p>number of group specific factors to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars_est</code></td>
<td>
<p>number of variables that will be included in the algorithm and have their coefficient estimated. This is usually equal to the number of observable variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>TRUE or FALSE: defines using the classical or robust algorithm to estimate beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_factors_may_vary</code></td>
<td>
<p>whether or not the number of groupfactors is constant over all groups or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimize_kappa</code></td>
<td>
<p>indicates if kappa has to be optimized or not (only relevant for the classical algorithm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosetting</code></td>
<td>
<p>option to remove the recommended setting in lmrob(). It is much faster. Defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list: 1st element contains matrix (N columns: 1 for each time series of the panel data) with estimated beta_est's. If vars_est is set to 0, the list contains NA.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
X &lt;- X_dgp3
Y &lt;- Y_dgp3
# Set estimations for group factors and its loadings, and group membership to the true value
lambda_group &lt;- lambda_group_true_dgp3
factor_group &lt;- factor_group_true_dgp3
g &lt;- g_true_dgp3
# There are no common factors to be estimated  -&gt; but needs placeholder
lambda &lt;- matrix(0, nrow = 1, ncol = 300)
comfactor &lt;- matrix(0, nrow = 1, ncol = 30)
#
# Choose how coefficients of the observable variables are estimated
method_estimate_beta &lt;- "individual"
method_estimate_factors &lt;- "macro"
beta_est &lt;- estimate_beta(
  Y, X, NA, g, lambda_group, factor_group,
  lambda, comfactor,
  S = 3, k = 0, kg = c(3, 3, 3),
  vars_est = 3,
  robust = TRUE
)[[1]]

</code></pre>


</div>