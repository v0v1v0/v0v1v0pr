<div class="container">

<table style="width: 100%;"><tr>
<td>loss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate regularized precision under various loss functions</h2>

<h3>Description</h3>

<p>Function that evaluates an estimated and possibly regularized precision
matrix under various loss functions. The loss functions are formulated in
precision terms. This function may be used to estimate the risk (vis-a-vis,
say, the true precision matrix) of the various ridge estimators employed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loss(E, T, precision = TRUE, type = c("frobenius", "quadratic"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Estimated (possibly regularized) precision <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>True (population) covariance or precision <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>A <code>logical</code> indicating if T is a precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A <code>character</code> indicating which loss function is to be used.
Must be one of: "frobenius", "quadratic".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">\mathbf{\Omega}</code> denote a generic <code class="reqn">(p \times p)</code> population precision matrix and let
<code class="reqn">\hat{\mathbf{\Omega}}(\lambda)</code> denote a generic ridge estimator of the precision matrix under
generic regularization parameter <code class="reqn">\lambda</code> (see also <code>ridgeP</code>). The function then
considers the following loss functions:
</p>

<ol>
<li>
<p> Squared Frobenius loss, given by:
</p>
<p style="text-align: center;"><code class="reqn">
        L_{F}[\hat{\mathbf{\Omega}}(\lambda), \mathbf{\Omega}] = \|\hat{\mathbf{\Omega}}(\lambda) -
          \mathbf{\Omega}\|_{F}^{2};
      </code>
</p>

</li>
<li>
<p> Quadratic loss, given by:
</p>
<p style="text-align: center;"><code class="reqn">
        L_{Q}[\hat{\mathbf{\Omega}}(\lambda), \mathbf{\Omega}] = \|\hat{\mathbf{\Omega}}(\lambda)
        \mathbf{\Omega}^{-1} - \mathbf{I}_{p}\|_{F}^{2}.
      </code>
</p>

</li>
</ol>
<p>The argument <code>T</code> is considered to be the true precision matrix when <code>precision = TRUE</code>.
If <code>precision</code> <code>= FALSE</code> the argument <code>T</code> is considered to represent the true covariance matrix.
This statement is needed so that the loss is properly evaluated over the precision, i.e., depending
on the value of the <code>logical</code> argument <code>precision</code> inversions are employed where needed.
</p>
<p>The function can be employed to assess the risk of a certain ridge precision estimator (see also <code>ridgeP</code>).
The risk <code class="reqn">\mathcal{R}_{f}</code> of the estimator <code class="reqn">\hat{\mathbf{\Omega}}(\lambda)</code> given a loss function <code class="reqn">L_{f}</code>,
with <code class="reqn">f \in \{F, Q\}</code> can be defined as the expected loss:
</p>
<p style="text-align: center;"><code class="reqn">
    \mathcal{R}_{f}[\hat{\mathbf{\Omega}}(\lambda)] =
      \mathrm{E}\{L_{f}[\hat{\mathbf{\Omega}}(\lambda),
                         \mathbf{\Omega}]\},
  </code>
</p>

<p>which can be approximated by the mean or median of losses over repeated simulation runs.
</p>


<h3>Value</h3>

<p>Function returns a <code>numeric</code> representing the loss under the
chosen loss function.
</p>


<h3>Author(s)</h3>

<p>Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;, Wessel N. van Wieringen
</p>


<h3>References</h3>

<p>van Wieringen, W.N. &amp; Peeters, C.F.W. (2016).  Ridge Estimation
of Inverse Covariance Matrices from High-Dimensional Data, Computational
Statistics &amp; Data Analysis, vol. 103: 284-303.  Also available as
arXiv:1403.0904v3 [stat.ME].
</p>


<h3>See Also</h3>

<p><code>covML</code>, <code>ridgeP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Define population covariance
set.seed(333)
p = 25
n = 1000
X = matrix(rnorm(n*p), nrow = n, ncol = p)
colnames(X)[1:25] = letters[1:25]
Truecov &lt;- covML(X)

## Obtain sample
samples &lt;- X[sample(nrow(X), 10), ]
Cxx &lt;- covML(samples)

## Obtain regularized precision
P &lt;- ridgeP(Cxx, 10, type = "Alt")

## Evaluate estimated precision against population
## precision under Frobenius loss
loss(P, Truecov, precision = FALSE, type = "frobenius")

</code></pre>


</div>