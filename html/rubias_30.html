<div class="container">

<table style="width: 100%;"><tr>
<td>gsi_mcmc_fb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC from the fully Bayesian GSI model for pi and the individual posterior probabilities</h2>

<h3>Description</h3>

<p>Given a list of key parameters from a genetic dataset, this function samples values of pi
and the posteriors for all the individuals. Each MCMC iteration includes a recalculation
of the scaled genotype likelihood matrix, with baseline allele frequencies updated
based on the previous iteration's allocations. It returns the output in a list.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsi_mcmc_fb(
  par_list,
  Pi_init,
  lambda,
  reps,
  burn_in,
  sample_int_Pi,
  sample_int_PofZ
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par_list</code></td>
<td>
<p>genetic data converted to the param_list format by <code>tcf2param_list</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi_init</code></td>
<td>
<p>Starting value for the pi (collection mixture proportion) vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the prior to be added to the collection allocations, in order to
generate pseudo-count Dirichlet parameters for the simulation of a new pi vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>total number of reps (sweeps) to do.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>how many reps to discard in the beginning when doing the mean calculation. They will still be
returned in the traces if desired</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_int_Pi</code></td>
<td>
<p>the number of reps between samples being taken for Pi traces.  If 0 no trace samples are taken</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_int_PofZ</code></td>
<td>
<p>the number of reps between samples being taken for the traces of posterior of each individual's origin. If 0
no trace samples are taken.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>gsi_mcmc_fb</code> returns a list of three. <code>$mean</code> lists the posterior
means for collection proportions <code>pi</code>, for the individual posterior
probabilities of assignment <code>PofZ</code>, and for the allele frequencies <code>theta</code>.
<code>$sd</code> returns the posterior standard deviations for the same values.
</p>
<p>If the corresponding <code>sample_int</code> variables are not 0, <code>$trace</code> contains
samples taken from the Markov chain at intervals of <code>sample_int_</code>(variable) steps.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># this demonstrates it with scaled likelihoods computed from
# assignment of the reference samples

# we have to get the ploidies to pass to tcf2param_list
locnames &lt;- names(alewife)[-(1:16)][c(TRUE, FALSE)]
ploidies &lt;- rep(2, length(locnames))
names(ploidies) &lt;- locnames

params &lt;- tcf2param_list(alewife, 17, ploidies = ploidies)
lambda &lt;- rep(1/params$C, params$C)
# use very short run and burn in so it doesn't take too long
# when checking on CRAN
mcmc &lt;- gsi_mcmc_fb(params, lambda, lambda, 20, 5, 4, 4)
</code></pre>


</div>