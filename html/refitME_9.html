<div class="container">

<table style="width: 100%;"><tr>
<td>MCEMfit_gen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for fitting any likelihood-based model using the MCEM algorithm</h2>

<h3>Description</h3>

<p>Function for wrapping the MCEM algorithm on any likelihood-based model where predictors are subject to measurement error/error-in-variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCEMfit_gen(
  mod,
  family,
  sigma.sq.u,
  B = 50,
  epsilon = 1e-05,
  silent = FALSE,
  theta.est = 1,
  shape.est = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>: a model object (this is the naive fitted model). Make sure the first <code class="reqn">p</code> input predictor variables entered in the naive model are the specified error-contaminated variables. These <code class="reqn">p</code> predictors also need the measurement error variance to be specified in <code>sigma.sq.u</code>, see below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>: a specified family/distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sq.u</code></td>
<td>
<p>: measurement error (ME) variance. A scalar if there is only one error-contaminated predictor variable, otherwise this must be stored as a vector (of ME variances) or a matrix if the ME covariance matrix is known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>: the number of Monte Carlo replication values (default is set to 50).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>: a set convergence threshold (default is set to 0.00001).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>: if <code>TRUE</code>, the convergence message (which tells the user if the model has converged and reports the number of iterations required) is suppressed (default is set to <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.est</code></td>
<td>
<p>: an initial value for the dispersion parameter (this is required for fitting negative binomial models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape.est</code></td>
<td>
<p>: an initial value for the shape parameter (this is required for fitting gamma models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>: further arguments passed through to the function that was used to fit <code>mod</code>, that will be used in refitting. These need only be specified if making changes to the arguments as compared to the original call that produced <code>mod</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>MCEMfit_gen</code> returns the original naive fitted model object but coefficient estimates and residuals have been replaced with the final MCEM model fit. Standard errors are included and returned, if <code>mod</code> is a class of object accepted by the <span class="pkg">sandwich</span> package (such as <code>glm</code>, <code>gam</code>, <code>survreg</code> and many more).
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>References</h3>

<p>Carroll, R. J., Ruppert, D., Stefanski, L. A., and Crainiceanu, C. M. (2006). <em>Measurement Error in Nonlinear Models: A Modern Perspective.</em> 2nd Ed. London: Chapman &amp; Hall/CRC.
</p>
<p>Stoklosa, J., Hwang, W-H., and Warton, D.I. <span class="pkg">refitME</span>: Measurement Error Modelling using Monte Carlo Expectation Maximization in R.
</p>


<h3>See Also</h3>

<p><code>MCEMfit_glm</code> and <code>MCEMfit_gam</code>
</p>


</div>