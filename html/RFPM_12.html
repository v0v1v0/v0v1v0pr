<div class="container">

<table style="width: 100%;"><tr>
<td>optimFPM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimization of Floating Percentile Model Parameters</h2>

<h3>Description</h3>

<p>Calculate parameter inputs that optimize benchmark performance
</p>


<h3>Usage</h3>

<pre><code class="language-R">optimFPM(
  data,
  paramList,
  FN_crit = seq(0.1, 0.9, by = 0.05),
  alpha.test = seq(0.05, 0.5, by = 0.05),
  which = c(1, 2, 3, 4),
  simplify = TRUE,
  plot = TRUE,
  colors = heat.colors(10),
  colsteps = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame containing, at a minimum, chemical concentrations as columns and a logical <code>Hit</code> column classifying toxicity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramList</code></td>
<td>
<p>character vector of column names of chemical concentration variables in <code>data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FN_crit</code></td>
<td>
<p>numeric vector over which to optimize false negative thresholds (default = <code>seq(0.1, 0.9, by = 0.05))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.test</code></td>
<td>
<p>numeric vector of type-I error rate values over which to optimize (default = <code>seq(0.05, 0.5, by = 0.05))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>numeric or character indicating which type of plot to generate (see Details; default = <code>c(1, 2)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>logical; whether to generate simplified output (default = <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; whether to generate a plot to visualize the opimization results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>values recognizible as colors to be passed to <code>colorRampPalette</code> (via <code>colorGradient</code>) to generate a palette for plotting (default = <code>heat.colors(10)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colsteps</code></td>
<td>
<p>integer; number of discrete steps to interpolate colors in <code>colorGradient</code> (default = <code>100</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional argument passed to <code>FPM</code>, <code>chemSig</code>, <code>chemSigSelect</code>, and <code>colorGradient</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>optimFPM</code> was designed to help optimize the predictive capacity of the benchmarks generated by <code>FPM</code>. The default input parameters to
<code>FPM</code> (i.e., <code>FN_crit = 0.2</code> and <code>alpha.test = 0.05</code>) are arbitrary, and optimization can help to objectively establish more accurate benchmarks.
Graphical output from <code>optimFPM</code> can also help users to understand the relationship(s) between benchmark accuracy/error, <code>FN_crit</code>, and <code>alpha.test</code>.
</p>
<p>Default inputs for <code>FN_crit</code> and <code>alpha.test</code> were selected to represent a reasonable range of values to test. Testing over both ranges
will result in a two-way optimization, which can be computationally intensive. Alternatively, <code>optimFPM</code> can be run for one parameter at a time
by specifying a single value for <code>FN_crit</code> or <code>alpha.test</code>. Note that inputting single values for both <code>FN_crit</code> and <code>alpha.test</code> will generate unhelpful results.
</p>
<p>Several metrics are used for optimization:
</p>

<ol>
<li>
<p> Ratio of sensitivity/specificity ("sensSpecRatio"), calculated as the minimum of the two metrics divided by the maximum of the two. Therefore, this value will always be between 0 and 1, representing the balance between correct <code>Hit==TRUE</code> and <code>Hit==FALSE</code> predictions.
</p>
</li>
<li>
<p> Overall reliability ("OR") (i.e., probability of correctly predicting <code>Hit</code> values)
</p>
</li>
<li>
<p> Fowlkes-Mallows Index ("FM") - an average of metrics focusing on predicting <code>Hit==TRUE</code>
</p>
</li>
<li>
<p> Matthew's Correlation Coefficient ("MCC") - a measure of the correspondence between the data and predictions analogous to a Pearson's correlation coefficient (but for binary data)
</p>
</li>
</ol>
<p>Graphical output will differ depending on whether or not a single value is input for <code>FN_crit</code> or <code>alpha.test</code>. Providing a single value for one
of the two arguments will generate a line graph, whereas providing longer vectors (i.e., length &gt; 1) of inputs for both arguments will generate dot matrix plots using <code>colors</code> to generate
a color palette and <code>colsteps</code> to define the granularity of the color gradient with the palette. The order of <code>colors</code> will be plotted
from more optimal to less optimal; for example, the default of <code>heat.colors(10)</code> will show optimal colors as red and less optimal colors as yellower.
By default, multiple plots will be generated, however the <code>which</code> argument can control which plots are generated. Inputs
to <code>which</code> are, by default, <code>c(1, 2, 3, 4)</code> for the metrics noted above, and flexible character inputs also can be used to a degree.
Black squares indicate the optimal argument inputs; these values are also printed to the console and can be assigned to an object.
</p>


<h3>Value</h3>

<p>data.frame of optimized <code>FN_crit</code> and/or <code>alpha.test</code> values
</p>


<h3>See Also</h3>

<p>FPM, colorGradient, colorRampPalette
</p>


<h3>Examples</h3>

<pre><code class="language-R">paramList = c("Cd", "Cu", "Fe", "Mn", "Ni", "Pb", "Zn")
FN_seq &lt;- seq(0.1, 0.3, 0.05)
alpha_seq &lt;- seq(0.05, 0.2, 0.05)
optimFPM(h.tristate, paramList, FN_seq, 0.05)
optimFPM(h.tristate, paramList, 0.2, alpha_seq)
optimFPM(h.tristate, paramList, FN_seq, alpha_seq, which=2)
</code></pre>


</div>