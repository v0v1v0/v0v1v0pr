<div class="container">

<table style="width: 100%;"><tr>
<td>plotDensityDimRed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create density plot basing on specified coordinates</h2>

<h3>Description</h3>

<p>This function shows the cell density presented in a 2D
dimensionality reduction coordinates. Density is shown with coloring and
contour lines. A scatter plot of the dimensionality reduction is added as
well. The density plot can be splitted by categorical variables (e.g.
<code>"dataset"</code>), while the scatter plot will always be shown for all cells
in subplots as a reference of the global structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotDensityDimRed(
  object,
  useDimRed = NULL,
  splitBy = NULL,
  combinePlot = TRUE,
  minDensity = 8,
  contour = TRUE,
  contourLineWidth = 0.3,
  contourBins = 5,
  dot = TRUE,
  dotColor = "grey",
  dotSize = 0.6,
  dotAlpha = 0.3,
  dotRaster = NULL,
  title = NULL,
  legendFillTitle = "Density",
  colorPalette = "magma",
  colorDirection = -1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A liger object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useDimRed</code></td>
<td>
<p>Name of the variable storing dimensionality reduction result
in the <code>cellMeta</code> slot. Default uses default dimension reduction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitBy</code></td>
<td>
<p>Character vector of categorical variable names in
<code>cellMeta</code> slot. Split all cells by groupings on this/these variable(s)
to produce a density plot containing only the cells in each group. Default
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combinePlot</code></td>
<td>
<p>Logical, whether to utilize
<code>plot_grid</code> to combine multiple plots into one. Default
<code>TRUE</code> returns combined ggplot. <code>FALSE</code> returns a list of ggplot
or a single ggplot when only one plot is requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minDensity</code></td>
<td>
<p>A positive number to filter out low density region colored
on plot. Default <code>8</code>. Setting zero will show density on the whole panel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour</code></td>
<td>
<p>Logical, whether to draw the contour line. Default
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contourLineWidth</code></td>
<td>
<p>Numeric, the width of the contour line. Default
<code>0.3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contourBins</code></td>
<td>
<p>Number of contour bins. Higher value generates more
contour lines. Default <code>5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dot</code></td>
<td>
<p>Logical, whether to add scatter plot of all cells, even when
density plot is splitted with <code>splitBy</code>. Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dotColor, dotSize, dotAlpha</code></td>
<td>
<p>Numeric, controls the appearance of all
dots. Default <code>"grey"</code>, <code>0.6</code> and <code>0.3</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dotRaster</code></td>
<td>
<p>Logical, whether to rasterize the scatter plot. Default
<code>NULL</code> automatically rasterizes the dots when number of total cells to
be plotted exceeds 100,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Text of main title of the plots. Default <code>NULL</code>. Length
of character vector input should match with number of plots generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendFillTitle</code></td>
<td>
<p>Text of legend title. Default <code>"Density"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorPalette</code></td>
<td>
<p>Name of the option for
<code>scale_fill_viridis_c</code>. Default <code>"magma"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorDirection</code></td>
<td>
<p>Color gradient direction for
<code>scale_fill_viridis_c</code>. Default <code>-1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>More theme setting arguments passed to
<code>.ggplotLigerTheme</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object when only one plot is generated, A ggplot object
combined with <code>plot_grid</code> when multiple plots and
<code>combinePlot = TRUE</code>. A list of ggplot when multiple plots and
<code>combinePlot = FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example dataset has small number of cells, thus cutoff adjusted.
plotDensityDimRed(pbmcPlot, minDensity = 1)
</code></pre>


</div>