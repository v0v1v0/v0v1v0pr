<div class="container">

<table style="width: 100%;"><tr>
<td>grid.predict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helper function for applying predict methods to stacks of grids.</h2>

<h3>Description</h3>

<p>This function can be used to apply the predict method of hopefully any fitted predictive model pixel by pixel to a stack of grids representing the explanatory variables. It is intended to be called primarily by <code>multi.local.function()</code> or <code>multi.focal.function()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">grid.predict(
  fit,
  predfun,
  trafo,
  control.predict,
  predict.column,
  trace = 0,
  location,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a model object for which prediction is desired</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predfun</code></td>
<td>
<p>optional prediction function; if missing, the <code>fit</code>'s <code>predict()</code> method is called. In some cases it may be convenient to define a wrapper function for the predict method that may be passed as <code>predfun</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trafo</code></td>
<td>
<p>an optional <code style="white-space: pre;">⁠function(x)⁠</code> that takes a <code>data.frame</code> <code>x</code> and returns a <code>data.frame</code> with the same number of rows; this is intended to perform transformations on the input variables, e.g. derive a log-transformed variable from the raw input read from the grids, or more complex variables such as the NDVI etc.; the <code>data.frame</code> resulting from a call to <code>trafo</code> (if provided) is passed to <code>predfun</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.predict</code></td>
<td>
<p>an optional list of arguments to be passed on to <code>predfun</code>; this may be e.g. <code>type="response"</code> to obtain probability prediction maps from a logistic regression model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict.column</code></td>
<td>
<p>optional character string: Some predict methods (e.g. <code>predict.lda</code>) return a data.frame with several columns, e.g. one column per class in a classification problem. <code>predict.column</code> is used to pick the one that is of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>integer &gt;=0: positive values give more (=2) or less (=1) information on predictor variables and predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>optional location data received from <code>multi.focal.function</code>; is added to the <code>newdata</code> object that is passed on to <code>predfun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>these arguments are provided by the calling function, usually <code>multi.local.function()</code> or <code>multi.focal.function()</code>.  They contain the explanatory (predictor) variables required by the <code>fit</code> model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>grid.predict</code> is a simple wrapper function. First it binds the arguments in <code style="white-space: pre;">⁠\dots⁠</code> together in a <code>data.frame</code> with the raw predictor variables that have been read from their grids by the caller, <code>multi.local.function()</code> (or <code>multi.focal.function()</code>). Then it calls the optional <code>trafo</code> function to transform or combine predictor variables (e.g. perform log transformations, ratioing, arithmetic operations such as calculating the NDVI). Finally the <code>predfun</code> (or, typically, the default <code>predict()</code> method of <code>fit</code>) is called, handing over the <code>fit</code>, the predictor <code>data.frame</code>, and the optional <code>control.predict</code> arguments.
</p>


<h3>Value</h3>

<p><code>grid.predict</code> returns the result of the call to <code>predfun</code> or the default <code>predict()</code> method.
</p>


<h3>Note</h3>

<p>Though <code>grid.predict</code> can in principle deal with <code>predict</code> methods returning factor variables, its usual caller <code>multi.local.function()</code> / <code>multi.focal.function()</code> cannot; classification models should be dealt with by setting a <code>type="prob"</code> (for <code>rpart</code>) or <code>type="response"</code> (for logistic regression and logistic additive model) argument, for example (see second Example below).
</p>


<h3>Author(s)</h3>

<p>Alexander Brenning
</p>


<h3>References</h3>

<p>Brenning, A. (2008): Statistical geocomputing combining R and SAGA: The example of landslide susceptibility analysis with generalized additive models. In: J. Boehner, T. Blaschke, L. Montanarella (eds.), SAGA - Seconds Out (= Hamburger Beitraege zur Physischen Geographie und Landschaftsoekologie, 19), 23-32.
</p>


<h3>See Also</h3>

<p><code>focal.function()</code>, <code>multi.local.function()</code>, <code>multi.focal.function()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Assume that d is a data.frame with point observations
# of a numerical response variable y and predictor variables
# a, b, and c.
# Fit a generalized additive model to y,a,b,c.
# We want to model b and c as nonlinear terms:
require(gam)
fit &lt;- gam(y ~ a + s(b) + s(c), data = d)
multi.local.function(in.grids = c("a", "b", "c"),
    out.varnames = "pred",
    fun = grid.predict, fit = fit )
    # Note that the 'grid.predict' uses by default the
    # predict method of 'fit'.
# Model predictions are written to a file named pred.asc

## End(Not run)

## Not run: 
# A fake example of a logistic additive model:
require(gam)
fit &lt;- gam(cl ~ a + s(b) + s(c), data = d, family = binomial)
multi.local.function(in.grids = c("a", "b", "c"),
    out.varnames = "pred",
    fun = grid.predict, fit = fit,
    control.predict = list(type = "response") )
    # 'control.predict' is passed on to 'grid.predict', which
    # dumps its contents into the arguments for 'fit''s
    # 'predict' method.
# Model predictions are written to a file named pred.asc

## End(Not run)
</code></pre>


</div>