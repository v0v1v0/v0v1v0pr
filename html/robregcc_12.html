<div class="container">

<table style="width: 100%;"><tr>
<td>robregcc_sp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust model estimation approach for regression with compositional covariates.</h2>

<h3>Description</h3>

<p>Fit regression model with compositional covariates for a  range of tuning parameter lambda. Model parameters is assumed to be sparse.
</p>


<h3>Usage</h3>

<pre><code class="language-R">robregcc_sp(
  X,
  y,
  C,
  beta.init = NULL,
  gamma.init = NULL,
  cindex = 1,
  control = list(),
  penalty.index = 3,
  alpha = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictor matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>phenotype/response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>conformable sub-compositional matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.init</code></td>
<td>
<p>initial value of model parameter beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.init</code></td>
<td>
<p>inital value of shift parameter gamma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cindex</code></td>
<td>
<p>index of control (not penalized) variable in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of internal parameters controlling the model fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.index</code></td>
<td>
<p>a vector of length 2 specifying type of penalty for model parameter and shift parameter respectively. 1, 2, 3 corresponding to adaptive, soft and hard penalty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>elastic net penalty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>TRUE/FALSE for showing progress of the cross validation</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Method</code></td>
<td>
<p>Type of penalty used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betapath</code></td>
<td>
<p>model parameter estimate along solution path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammapath</code></td>
<td>
<p>shift parameter estimate along solution path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lampath</code></td>
<td>
<p>sequence of fitted lambda)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k0</code></td>
<td>
<p>scaling factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cver</code></td>
<td>
<p>error from k fold cross validation </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selInd</code></td>
<td>
<p>selected index from minimum and 1se rule cross validation error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>beta estimate corresponding to selected index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma0</code></td>
<td>
<p>mean shift estimate corresponding to selected index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual0</code></td>
<td>
<p>residual estimate corresponding to selected index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inlier0</code></td>
<td>
<p>inlier index corresponding to selected index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaE</code></td>
<td>
<p>Post selection estimate corresponding to selected index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residualE</code></td>
<td>
<p>post selection residual corresponding to selected index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inlierE</code></td>
<td>
<p>post selection inlier index corresponding to selected index</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Mishra, A., Mueller, C.,(2019) <em>Robust regression with compositional covariates. In prepration.</em> arXiv:1909.04990.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(magrittr)
library(robregcc)

data(simulate_robregcc)
X &lt;- simulate_robregcc$X;
y &lt;- simulate_robregcc$y
C &lt;- simulate_robregcc$C
n &lt;- nrow(X); p &lt;- ncol(X); k &lt;-  nrow(C)

Xt &lt;- cbind(1,X)                         # accounting for intercept in predictor
C &lt;- cbind(0,C)                           # accounting for intercept in constraint
bw &lt;- c(0,rep(1,p))                       # weight matrix to not penalize intercept 

example_seed &lt;- 2*p+1               
set.seed(example_seed) 

# Breakdown point for tukey Bisquare loss function 
b1 = 0.5                    # 50% breakdown point
cc1 =  1.567                # corresponding model parameter
b1 = 0.25; cc1 =  2.937   

# Initialization [PSC analysis for compositional data]
control &lt;- robregcc_option(maxiter=1000,tol = 1e-4,lminfac = 1e-7)
fit.init &lt;- cpsc_sp(Xt, y,alp = 0.4, cfac = 2, b1 = b1, 
cc1 = cc1,C,bw,1,control)  

## Robust model fitting

# control parameters
control &lt;- robregcc_option()
beta.wt &lt;- fit.init$betaR    # Set weight for model parameter beta
beta.wt[1] &lt;- 0
control$gamma = 1            # gamma for constructing  weighted penalty
control$spb = 40/p           # fraction of maximum non-zero model parameter beta
control$outMiter = 1000      # Outer loop iteration
control$inMiter = 3000       # Inner loop iteration
control$nlam = 50            # Number of tuning parameter lambda to be explored
control$lmaxfac = 1          # Parameter for constructing sequence of lambda
control$lminfac = 1e-8       # Parameter for constructing sequence of lambda 
control$tol = 1e-20;         # tolrence parameter for converging [inner  loop]
control$out.tol = 1e-16      # tolerence parameter for convergence [outer loop]
control$kfold = 10           # number of fold of crossvalidation
control$sigmafac = 2#1.345
# Robust regression using adaptive lasso penalty
fit.ada &lt;- robregcc_sp(Xt,y,C,
                       beta.init = beta.wt,  cindex = 1, 
                       gamma.init = fit.init$residuals,
                       control = control, 
                       penalty.index = 1, alpha = 0.95)

# Robust regression using lasso penalty [Huber equivalent]   
fit.soft &lt;- robregcc_sp(Xt,y,C, cindex = 1, 
                        control = control, penalty.index = 2, 
                        alpha = 0.95)


# Robust regression using hard thresholding penalty
control$lmaxfac = 1e2               # Parameter for constructing sequence of lambda
control$lminfac = 1e-3              # Parameter for constructing sequence of lambda
control$sigmafac = 2#1.345
fit.hard &lt;- robregcc_sp(Xt,y,C, beta.init = fit.init$betaf, 
                        gamma.init = fit.init$residuals,
                        cindex = 1, 
                        control = control, penalty.index = 3, 
                        alpha = 0.95)
                        
</code></pre>


</div>