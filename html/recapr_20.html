<div class="container">

<table style="width: 100%;"><tr>
<td>powconsistencytest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power of Consistency Tests, Partial Stratification</h2>

<h3>Description</h3>

<p>Conducts power calculations of the chi-squared tests for the
consistency of the Petersen-type abundance estimator, in a partial
stratification setting, such as by time or geographic area.  In the case of
partial stratification, individuals may move from one stratum to another
between the first and second sampling events, and strata do not need to be
the same between events.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powconsistencytest(n1, n2, pmat, alpha = 0.05, sim = TRUE, nsim = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>Vector of anticipated n1 counts (sample size in the first event),
each element corresponding to one stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>Vector of anticipated n2 counts (sample size in the second event),
each element corresponding to one stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmat</code></td>
<td>
<p>Matrix of assumed movement probabilities between strata, with
rows corresponding to first-event strata and columns corresponding to
second-event strata, and an additional column corresponding to the
probability of NOT being recaptured in the second event.  Values will be
standardized by row, that is, by first-event strata.  See note on usage
below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level for testing.  Defaults to <code>0.05</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>Whether to conduct power calculation by simulation as well as
Cohen's method.  Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations if <code>sim</code> is <code>TRUE</code>.  Defaults to
<code>10000</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>"recapr_consistencypow"</code> with the following
components: </p>
 <ul>
<li>
<p><code>pwr1_c</code> Power of the first test,
according to Cohen's method </p>
</li>
<li>
<p><code>pwr1_sim</code> Power of the first
test, from simulation </p>
</li>
<li>
<p><code>ntest1</code> The sample size used for the
first test </p>
</li>
<li>
<p><code>p0test1</code> The null-hypothesis probabilities for
the first test </p>
</li>
<li>
<p><code>p1test1</code> The alt-hypothesis probabilities for
the first test </p>
</li>
<li>
<p><code>pwr2_c</code> Power of the second test, according
to Cohen's method </p>
</li>
<li>
<p><code>pwr2_sim</code> Power of the second test, from
simulation </p>
</li>
<li>
<p><code>ntest2</code> The sample size used for the second test
</p>
</li>
<li>
<p><code>p0test2</code> The null-hypothesis probabilities for the second
test </p>
</li>
<li>
<p><code>p1test2</code> The alt-hypothesis probabilities for the
second test </p>
</li>
<li>
<p><code>pwr3_c</code> Power of the third test, according to
Cohen's method </p>
</li>
<li>
<p><code>pwr3_sim</code> Power of the third test, from
simulation </p>
</li>
<li>
<p><code>ntest3</code> The sample size used for the third test
</p>
</li>
<li>
<p><code>p0test3</code> The null-hypothesis probabilities for the third
test </p>
</li>
<li>
<p><code>p1test3</code> The alt-hypothesis probabilities for the third
test </p>
</li>
<li>
<p><code>alpha</code> The significance level used </p>
</li>
</ul>
<h3>Note</h3>

<p>The movement probability matrix specified in <code>pmat</code> is considered
conditional on each row, that is, first-event strata, with columns
corresponding to second-event strata and the final column specifying the
probability of not being recaptured in the second event.  Values do not
need to sum to one for each row, but will be standardized by the function
to sum to one.
</p>
<p>A <code>pmat</code> with a first row equal to <code>(0.05, 0.1, 0.15, 0.7)</code> would
imply a 5 percent chance that individuals captured in the first-event
strata 1 will be recaptured in second-event strata 1, and a 70 percent
chance that individuals captured in the first-event strata 1 will not be
recaptured in event 2.
</p>
<p>Because of the row-wise scaling, specifying a row equal to <code>(0.05,
  0.1, 0.15, 0.7)</code> would be equivalent to that row having values <code>(1, 2, 3, 14)</code>.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>References</h3>

<p>Cohen, J. (1988). Statistical power analysis for the behavioral
sciences (2nd ed.). Hillsdale,NJ: Lawrence Erlbaum.
</p>
<p>Code adapted from the 'pwr' package: Stephane Champely (2015). pwr: Basic
Functions for Power Analysis. R package version 1.1-3.
https://CRAN.R-project.org/package=pwr
</p>


<h3>See Also</h3>

<p>consistencytest, NDarroch
</p>


<h3>Examples</h3>

<pre><code class="language-R">mat &lt;- matrix(c(4,3,2,1,10,3,4,3,2,10,2,3,4,3,10,1,2,3,4,10),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(50,50,50,50), pmat=mat)

mat &lt;- matrix(c(4,3,2,1,10,4,3,2,1,10,4,3,2,1,10,4,3,2,1,10),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(50,50,50,50), pmat=mat)

mat &lt;- matrix(c(1,1,1,1,10,2,2,2,2,10,3,3,3,3,10,4,4,4,4,10),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(50,50,50,50), pmat=mat)

mat &lt;- matrix(c(1,1,1,1,10,1,1,1,1,10,1,1,1,1,10,1,1,1,1,10),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(20,30,40,50), pmat=mat)

mat &lt;- matrix(c(1,1,1,1,5,1,1,1,1,8,1,1,1,1,10,1,1,1,1,15),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(50,50,50,50), pmat=mat)
</code></pre>


</div>