<div class="container">

<table style="width: 100%;"><tr>
<td>choropleth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Display choropleth map</h2>

<h3>Description</h3>

<p>Display choropleth map of detected clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">choropleth(
  polygons,
  fls,
  col = palette(),
  region_color = "#F0F0F0",
  rank = 1:length(fls$cluster),
  pval = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>polygons</code></td>
<td>
<p>A SpatialPolygonsDataFrame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fls</code></td>
<td>
<p>An rflexscan object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A vector of colors for each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region_color</code></td>
<td>
<p>Color of regions that are not included in any clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>An integer vector which specifies ranks of clusters to be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>A threshold of P-value. Clusters with P-values of &lt;<code>pval</code> will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed to plot function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Clusters are colored using the current palette. Please use palette
function to specify colors of each cluster. Note that clusters with ranks
larger than the number of colors in the palette are not highlighted.
</p>


<h3>See Also</h3>

<p>rflexscan
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# load sample data (North Carolina SIDS data)
library(sf)
library(spdep)
data("nc.sids")
sids.shp &lt;- read_sf(system.file("shapes/sids.shp", package="spData")[1])

# calculate the expected numbers of cases
expected &lt;- nc.sids$BIR74 * sum(nc.sids$SID74) / sum(nc.sids$BIR74)

# run FleXScan
fls &lt;- rflexscan(x = nc.sids$x, y = nc.sids$y,
                 observed = nc.sids$SID74,
                 expected = expected,
                 name = rownames(nc.sids),
                 clustersize = 10,
                 nb = ncCR85.nb)

# display all clusters
choropleth(sids.shp, fls)

# display clusters with rank 1, 2 and 3
choropleth(sids.shp, fls, rank = c(1, 2, 3))

# display clusters of P-value &lt;= 0.05
choropleth(sids.shp, fls, pval = 0.05)


</code></pre>


</div>