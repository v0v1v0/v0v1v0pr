<div class="container">

<table style="width: 100%;"><tr>
<td>nice_table</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Easily make nice APA tables</h2>

<h3>Description</h3>

<p>Make nice APA tables easily through a wrapper
around the <code>flextable</code> package with sensical defaults and
automatic formatting features.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nice_table(
  data,
  highlight = FALSE,
  stars = TRUE,
  italics,
  col.format.p,
  col.format.r,
  col.format.ci,
  format.custom,
  col.format.custom,
  width = NULL,
  spacing = 2,
  broom = NULL,
  report = NULL,
  short = FALSE,
  title,
  note,
  separate.header
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data frame, to be converted to a flextable.
The data frame cannot have duplicate column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight</code></td>
<td>
<p>Highlight rows with statistically significant
results? Requires a column named "p" containing p-values.
Can either accept logical (TRUE/FALSE) OR a numeric value for
a custom critical p-value threshold (e.g., 0.10 or 0.001).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stars</code></td>
<td>
<p>Logical. Whether to add asterisks for significant p values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>italics</code></td>
<td>
<p>Which columns headers should be italic? Useful
for column names that should be italic but that are not picked
up automatically by the function. Select with numerical range, e.g., 1:3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.format.p</code></td>
<td>
<p>Applies p-value formatting to columns
that cannot be named "p" (for example for a data frame full
of p-values, also because it is not possible to have more
than one column named "p"). Select with numerical range, e.g., 1:3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.format.r</code></td>
<td>
<p>Applies r-value formatting to columns
that cannot be named "r" (for example for a data frame full
of r-values, also because it is not possible to have more
than one column named "r"). Select with numerical range, e.g., 1:3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.format.ci</code></td>
<td>
<p>Applies 95% confidence interval formatting
to selected columns (e.g., when reporting more than one interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format.custom</code></td>
<td>
<p>Applies custom formatting to columns
selected via the <code>col.format.custom</code> argument. This is useful
if one wants custom formatting other than for p- or r-values.
It can also be used to transform (e.g., multiply) certain values
or print a specific symbol along the values for instance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.format.custom</code></td>
<td>
<p>Which columns to apply the custom
function to. Select with numerical range, e.g., 1:3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Width of the table, in percentage of the
total width, when exported e.g., to Word. For full width,
use <code>width = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacing</code></td>
<td>
<p>Spacing of the rows (1 = single space, 2 = double space)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>broom</code></td>
<td>
<p>If providing a tidy table produced with the
<code>broom</code> package, which model type to use if one wants
automatic formatting (options are "t.test", "lm", "cor.test",
and "wilcox.test").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report</code></td>
<td>
<p>If providing an object produced with the
<code>report</code> package, which model type to use if one wants
automatic formatting (options are "t.test", "lm", and "cor.test").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>short</code></td>
<td>
<p>Logical. Whether to return an abbreviated
version of the tables made by the <code>report</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Optional, to add a table header, if desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>note</code></td>
<td>
<p>Optional, to add one or more table footnote (APA note),
if desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separate.header</code></td>
<td>
<p>Logical, whether to separate headers based
on name delimiters (i.e., periods ".").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The resulting <code>flextable</code> objects can be opened in
Word with <code>print(table, preview ="docx")</code>, or saved to
Word with the <code>flextable::save_as_docx()</code> function.
</p>


<h3>Value</h3>

<p>An APA-formatted table of class "flextable"
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="https://rempsyc.remi-theriault.com/articles/table">https://rempsyc.remi-theriault.com/articles/table</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Make the basic table
my_table &lt;- nice_table(
  mtcars[1:3, ],
  title = c("Table 1", "Motor Trend Car Road Tests"),
  note = c(
    "The data was extracted from the 1974 Motor Trend US magazine.",
    "* p &lt; .05, ** p &lt; .01, *** p &lt; .001"
  )
)
my_table


# Save table to word
mypath &lt;- tempfile(fileext = ".docx")
flextable::save_as_docx(my_table, path = mypath)


# Publication-ready tables
mtcars.std &lt;- lapply(mtcars, scale)
model &lt;- lm(mpg ~ cyl + wt * hp, mtcars.std)
stats.table &lt;- as.data.frame(summary(model)$coefficients)
CI &lt;- confint(model)
stats.table &lt;- cbind(
  row.names(stats.table),
  stats.table, CI
)
names(stats.table) &lt;- c(
  "Term", "B", "SE", "t", "p",
  "CI_lower", "CI_upper"
)
nice_table(stats.table, highlight = TRUE)

# Test different column names
test &lt;- head(mtcars)
names(test) &lt;- c(
  "dR", "N", "M", "SD", "b", "np2",
  "ges", "p", "r", "R2", "sr2"
)
test[, 10:11] &lt;- test[, 10:11] / 10
nice_table(test)

# Custom cell formatting (such as p or r)
nice_table(test[8:11], col.format.p = 2:4, highlight = .001)

nice_table(test[8:11], col.format.r = 1:4)

# Apply custom functions to cells
fun &lt;- function(x) {
  x + 11.1
}
nice_table(test[8:11], col.format.custom = 2:4, format.custom = "fun")

fun &lt;- function(x) {
  paste("x", x)
}
nice_table(test[8:11], col.format.custom = 2:4, format.custom = "fun")

# Separate headers based on periods
header.data &lt;- structure(
  list(
    Variable = c(
      "Sepal.Length",
      "Sepal.Width", "Petal.Length"
    ), setosa.M = c(
      5.01, 3.43,
      1.46
    ), setosa.SD = c(0.35, 0.38, 0.17), versicolor.M =
      c(5.94, 2.77, 4.26), versicolor.SD = c(0.52, 0.31, 0.47)
  ),
  row.names = c(NA, -3L), class = "data.frame"
)
nice_table(header.data,
  separate.header = TRUE,
  italics = 2:4
)

</code></pre>


</div>