<div class="container">

<table style="width: 100%;"><tr>
<td>rflexscan</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect spatial disease clusters using the flexible/circular scan statistic</h2>

<h3>Description</h3>

<p>This function analyzes spatial count data using the flexible spatial scan 
statistic developed by Tango and Takahashi (2005) or Kulldorff's circular 
spatial scan statistic (1997), and detect spatial disease clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rflexscan(
  x,
  y,
  lat,
  lon,
  name,
  observed,
  expected,
  population,
  nb,
  clustersize = 15,
  radius = 6370,
  stattype = "ORIGINAL",
  scanmethod = "FLEXIBLE",
  ralpha = 0.2,
  simcount = 999,
  rantype = "MULTINOMIAL",
  comments = "",
  verbose = FALSE,
  secondary = NULL,
  clustertype = "HOT"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of X-coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of Y-coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>(DEPRECATED) A vector of latitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>(DEPRECATED) A vector of longitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>A vector of names of each area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>A vector with the observed number of disease cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>A vector with the expected number of disease cases under the null hypothesis. 
This is used on "Poisson" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>A vector with the background population at risk in each area. 
This is used on "Binomial" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>A neighbors list or an adjacency matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustersize</code></td>
<td>
<p>The number of maximum spatial cluster size to scan, i.e., the maximum number 
of regions included in the detected cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Radius of Earth to calculate a distance between two sets of latitude and
longitude. It is approximately 6370 km in Japan. This parameter is used when 
<code>lat</code> and <code>lon</code> are specified. This is DEPRECATED. The 
distance calculated using this parameter is not accurate. This feature is 
implemented to maintain compatibility with FleXScan. It is recommended to 
transform latitude and longitude onto the Cartesian coordinate system 
beforehand and use the <code>x</code> and <code>y</code> parameters that are projected
coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stattype</code></td>
<td>
<p>Statistic type to be used (case-insensitive).
</p>

<dl>
<dt>"ORIGINAL"</dt>
<dd>
<p>the likelihood ratio statistic by Kulldorff and
Nagarwalla (1995)</p>
</dd>
<dt>"RESTRICTED"</dt>
<dd>
<p>the restricted likelihood ratio statistic by Tango 
(2008), with a preset parameter <code>ralpha</code> for restriction</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scanmethod</code></td>
<td>
<p>Scanning method to be used (case-insensitive).
</p>

<dl>
<dt>"FLEXIBLE"</dt>
<dd>
<p>flexible scan statistic by Tango and Takahashi (2005)</p>
</dd>
<dt>"CIRCULAR"</dt>
<dd>
<p>circular scan statistic by Kulldorff (1997)</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ralpha</code></td>
<td>
<p>Threshold parameter of the middle p-value for the restricted likelihood ratio
statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simcount</code></td>
<td>
<p>The number of Monte Carlo replications to calculate a p-value for statistical
test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rantype</code></td>
<td>
<p>The type of random number for Monte Carlo simulation (case-insensitive).
</p>

<dl>
<dt>"MULTINOMIAL"</dt>
<dd>
<p>Total number of cases in whole area is fixed. It can 
be chosen in either Poisson or Binomial model.</p>
</dd>
<dt>"POISSON"</dt>
<dd>
<p>Total number of cases is not fixed. It can be chosen in 
Poisson model.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comments</code></td>
<td>
<p>Comments for the analysis which will be written in summary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print progress messages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>secondary</code></td>
<td>
<p>The number of secondary clusters to be enumerated. If <code>NULL</code> is 
specified (default), the search for secondary clusters is stopped when the 
Monte Carlo p-value reaches 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustertype</code></td>
<td>
<p>Type of cluster to be scanned.
</p>

<dl>
<dt>"HOT"</dt>
<dd>
<p>Hot-spot clusters with elevated risk.</p>
</dd>
<dt>"COLD"</dt>
<dd>
<p>Cold-spot clusters with reduced risk.</p>
</dd>
<dt>"BOTH"</dt>
<dd>
<p>Hot- and cold-spot clusters simultaneously.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Centroid coordinates for each region should be specified EITHER by Cartesian 
coordinates using arguments <code>x</code> and <code>y</code> or by latitudes and 
longitudes using arguments <code>lat</code> and <code>lon</code>.
Note that <code>lat</code> and <code>lon</code> are DEPRECATED due to accuracy issues.
This feature is implemented to maintain compatibility with FleXScan software.
We recommend to transform latitude and longitude onto the Cartesian 
coordinate system beforehand (using <code>spTransform</code> function in sp package,
for example) and use the <code>x</code> and <code>y</code> parameters that are projected
coordinates.
</p>


<h3>Value</h3>

<p>An <code>rflexscan</code> object which contains analysis results and specified
parameters.
</p>


<h3>References</h3>

<p>Otani T. and Takahashi K. (2021). Flexible scan statistics for 
detecting spatial disease clusters: The rflexscan R package, Journal of 
Statistical Software 99:13.
</p>
<p>Tango T. and Takahashi K. (2005). A flexibly shaped spatial scan 
statistic for detecting clusters, International Journal of Health 
Geographics 4:11.
</p>
<p>Kulldorff M. and Nagarwalla N. (1995). Spatial disease clusters: 
Detection and Inference. Statistics in Medicine 14:799-810.
</p>
<p>Kulldorff M. (1997). A spatial scan statistic. Communications in 
Statistics: Theory and Methods, 26:1481-1496.
</p>
<p>Tango T. (2008). A spatial scan statistic with a restricted 
likelihood ratio. Japanese Journal of Biometrics 29(2):75-95.
</p>


<h3>See Also</h3>

<p>summary.rflexscan, plot.rflexscan, choropleth
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load sample data (North Carolina SIDS data)
library(spdep)
data("nc.sids")

# calculate the expected numbers of cases
expected &lt;- nc.sids$BIR74 * sum(nc.sids$SID74) / sum(nc.sids$BIR74)

# run FleXScan
fls &lt;- rflexscan(x = nc.sids$x, y = nc.sids$y,
                 observed = nc.sids$SID74,
                 expected = expected,
                 name = rownames(nc.sids),
                 clustersize = 10,
                 nb = ncCR85.nb)

# print rflexscan object
print(fls)

# print properties of the most likely cluster
print(fls$cluster[[1]])

# print summary to the terminal
summary(fls)

# plot graph
plot(fls, col = palette())
labs &lt;- 1:length(fls$cluster)
legend("bottomleft", legend = labs, col = palette(), lty = 1)

</code></pre>


</div>