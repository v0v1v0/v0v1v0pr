<div class="container">

<table style="width: 100%;"><tr>
<td>mllRH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Minus loglikelihood of a RHawkes model
</h2>

<h3>Description</h3>

<p>Calculates the minus loglikelihood of a RHawkes model with given
immigration hazard function <code class="reqn">\mu</code>, offspring density function 
<code class="reqn">h</code> and branching ratio <code class="reqn">\eta</code> for event times <code>tms</code> 
on interval <code class="reqn">[0,cens]</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mllRH(tms, cens, par, 
      h.fn = function(x, p) dexp(x, rate = 1 / p), 
      mu.fn = function(x, p) {
        exp(dweibull(x, shape = p[1], scale = p[2], log = TRUE) - 
        pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE))
      }, 
      H.fn = function(x, p) pexp(x, rate = 1 / p), 
      Mu.fn = function(x, p) {
        -pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE)
      })
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tms</code></td>
<td>

<p>A numeric vector, with values sorted in ascending order. Event times
to fit the RHawkes point process model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>A numeric vector containing the parameters of the model, in order of the 
immigration parameters <code class="reqn">\mu(.)</code>, offspring parameters <code class="reqn">h(.)</code> and 
lastly the branching ratio <code class="reqn">\eta(.)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.fn</code></td>
<td>

<p>A (vectorized) function. The immigration hazard function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the offspring density function from 0 to <code>t</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the immigrant hazard function from 0 to <code>t</code>. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value of the negative log-likelihood. 
</p>


<h3>Author(s)</h3>

<p>Feng Chen &lt;feng.chen@unsw.edu.au&gt;
Tom Stindl &lt;t.stindl@unsw.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## earthquake times over 96 years
data(quake);
tms &lt;- sort(quake$time);
# add some random noise to the simultaneous occurring event times
tms[213:214] &lt;- tms[213:214] + 
                    sort(c(runif(1, -1, 1)/(24*60), runif(1, -1, 1)/(24*60)))


## calculate the minus loglikelihood of an RHawkes with some parameters 
## the default hazard function and density functions are Weibull and 
## exponential respectively
mllRH(tms, cens = 96*365.25 , par = c(0.5, 20, 1000, 0.5))
## calculate the MLE for the parameter assuming known parametric forms
## of the immigrant hazard function and offspring density functions.  
system.time(est &lt;- optim(c(0.5, 20, 1000, 0.5), 
                        mllRH, tms = tms, cens = 96*365.25,
                        control = list(maxit = 5000, trace = TRUE),
                        hessian = TRUE)
            )
## point estimate by MLE
est$par
## standard error estimates:
diag(solve(est$hessian))^0.5

## End(Not run)
</code></pre>


</div>