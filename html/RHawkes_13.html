<div class="container">

<table style="width: 100%;"><tr>
<td>sim.pred1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate a fitted RHawkes process model for prediction purposes
</h2>

<h3>Description</h3>

<p>Simulate a fitted RHawkes process model from the censoring time <code>cens</code> 
to a future time point <code>cens.tilde</code>, conditional on the observed
event times until the censoring time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.pred1(tms, par, re.dist = rweibull, 
    par.redist = list(shape = par[1], scale = par[2]), 
    of.dis="exp", par.ofdis = list(rate=par[3]), 
    branching.ratio = par[4], cens=tail(tms,1)+mean(diff(tms))/2, 
    cens.tilde = cens * 1.5, 
    mu.fn = function(x, p) {
        exp(dweibull(x, shape = p[1], scale = p[2], log = TRUE) - 
        pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, log.p = TRUE))
    })
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tms</code></td>
<td>

<p>A numeric vector, with values sorted in ascending order. Event times
to fit the RHawkes point process model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>A numeric vector, giving the parameters of the model with the 
immigration parameters <code class="reqn">\mu(.)</code>, offspring parameters <code class="reqn">h(.)</code> and lastly
the branching ratio <code class="reqn">\eta(.)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re.dist</code></td>
<td>

<p>A (vectorized) function. The function to simulate from the immigrant
waiting times distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.redist</code></td>
<td>

<p>A (named) list, giving the parameters of the immigrant waiting time distribution.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>of.dis</code></td>
<td>

<p>A character string, for the name of the offspring birth time distribution. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.ofdis</code></td>
<td>

<p>A (named) list, giving the parameters of the offspring birth time distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branching.ratio</code></td>
<td>

<p>A scalar in [0,1), the branching ratio parameter.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.tilde</code></td>
<td>

<p>A scalar. The future time to run the simulation to. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.fn</code></td>
<td>

<p>A (vectorized) function. The immigration hazard function. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector that contains the simulated event times from censoring time 
<code>cens</code> up until <code>cens.tilde</code>
</p>


<h3>Author(s)</h3>

<p>Feng Chen &lt;feng.chen@unsw.edu.au&gt;
Tom Stindl &lt;t.stindl@unsw.edu.au&gt;
</p>


<h3>See Also</h3>

<p><code>sim.pred</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">N &lt;- 5; i &lt;- 0;
data(quake); tms &lt;- sort(quake$time);
# add some random noise the simultaneous occurring event times
tms[213:214] &lt;- tms[213:214] + 
                    sort(c(runif(1, -1, 1)/(24*60), runif(1, -1, 1)/(24*60)))
# simulate future event time based on MLE fitted RHawkes model
times &lt;- replicate(N,
                   {cat(i&lt;&lt;-i+1,'\n');
                   sim.pred1(tms = tms, par = c(0.314, 22.2, 1266, 0.512),
                             cens=35063)
                   })
plot(NA,NA,xlim=c(0,35063*1.5),ylim=c(0,max(lengths(times))+nrow(quake)),
     xlab="time",ylab="Sample path")
lines(c(0,quake$time),0:nrow(quake),type="s")
for(i in 1:N)
    lines(c(tail(quake$time,1),times[[i]]),nrow(quake)+0:length(times[[i]]),
          type="s",lty=2)
</code></pre>


</div>