<div class="container">

<table style="width: 100%;"><tr>
<td>rdistaz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distance and Azimuth from two points </h2>

<h3>Description</h3>

<p>Calculate distance, Azimuth and Back-Azimuth from two points on Globe.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdistaz(olat, olon, tlat, tlon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>olat</code></td>
<td>
<p>origin latitude, degrees </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>olon</code></td>
<td>
<p>origin longitude, degrees </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlat</code></td>
<td>
<p>target latitude, degrees </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlon</code></td>
<td>
<p>target longitude, degrees  </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The azimuth is returned in degrees from North.
</p>
<p>Program is set up for one origin (olat, olon) pair and many
target (tlat, tlon) pairs given as vectors.
</p>
<p>If multiple olat and olon are given, the program returns a list
of outputs for each.
</p>
<p>If olat or any tlat is greater than 90 or less than -90,  NA is returned
and error flag is 0.
</p>
<p>If any tlat and tlon is equal to olat and olon, the points are
coincident.
In that case the distances are set to zero, but the az and baz are NA,
and the error flag is set to 0.
</p>


<h3>Value</h3>

<p>List:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>del</code></td>
<td>
<p>Delta, angle in degrees</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>az</code></td>
<td>
<p>Azimuth, angle in degrees</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baz</code></td>
<td>
<p>Back Azimuth, angle in degrees from target to origin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>Distance in km</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>0 or 1, error flag.  0=error, 1=no error, see details</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;</p>


<h3>See Also</h3>

<p>along.great, getgreatarc</p>


<h3>Examples</h3>

<pre><code class="language-R">

####  one point
d &lt;- rdistaz(12, 23, -32,    -65)
d

####  many random target points
org &lt;- c(80.222, -100.940)
targ &lt;- cbind(runif(10, 10, 50), runif(10, 20, 100))


rdistaz(org[1], org[2], targ[,1], targ[,2])

############  if origin and target are identical
#####  the distance is zero, but the az and baz are not defined
rdistaz(80.222, -100.940, 80.222, -100.940)


########################   set one of the targets equal to the origin
targ[7,1] &lt;- org[1]
targ[7,2] &lt;- org[2]

rdistaz(org[1], org[2], targ[,1], targ[,2])

####  put in erroneous latitude data

targ[3,1] &lt;-  -91.3


rdistaz(org[1], org[2], targ[,1], targ[,2])
###########
### New York and Chapel Hill
NY =list(lat=40.6698,  lon=286.0562)
CH = list(lat=35.92761, lon=280.9594)
##    h = GEOmap::distaz(CH$lat, CH$lon, NY$lat, NY$lon)
h = rdistaz(CH$lat, CH$lon, NY$lat, NY$lon)

####### get great circle ray path
RAY =  GEOmap::getgreatarc(CH$lat, CH$lon, NY$lat, NY$lon, 100)
#### get great circle through north pole
Nor1 =  GEOmap::getgreatarc(CH$lat, CH$lon, 90,  CH$lon,   100)
PROJ = GEOmap::setPROJ(2, CH$lat, CH$lon)
RAY.XY = GEOmap::GLOB.XY(RAY$lat, RAY$lon, PROJ)
Nor1.XY = GEOmap::GLOB.XY(Nor1$lat, Nor1$lon, PROJ)
 VEE1 = c(Nor1.XY$x[2]-Nor1.XY$x[1], Nor1.XY$y[2]-Nor1.XY$y[1])
     VEE2 = c(RAY.XY$x[2]-RAY.XY$x[1], RAY.XY$y[2]-RAY.XY$y[1] )
     VEE1 = VEE1/sqrt(sum(VEE1^2) )
VEE2 =  VEE2/sqrt(sum(VEE2^2) )
######  get angle from north:
 ANG =    acos( sum(VEE1*VEE2)     ) *180/pi
####   compare with h

print(paste(h$az, ANG, h$az-ANG) )



</code></pre>


</div>