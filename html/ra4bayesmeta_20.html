<div class="container">

<table style="width: 100%;"><tr>
<td>post_RA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Posterior reference analysis based on a data frame using 2 benchmarks

</h2>

<h3>Description</h3>


<p>Computes a table of posterior estimates and informativeness values
for the marginal posterior distributions
of different parameters in the NNHM
induced by the actual heterogeneity priors specified in <code>tau.prior</code>.
Also provides the same estimates for the
posterior benchmarks proposed in Ott et al. (2021).





</p>


<h3>Usage</h3>

<pre><code class="language-R">post_RA(df, tau.prior = list(function(x) dhalfnormal(x, scale = 1)),
        show.re = FALSE,
        estimate = "median", ci.method = "central",
        H.dist.method = "integral",
        scale.hn0 = 1/500, mu.mean = 0, mu.sd = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>data frame with one column "y" containing the (transformed) effect estimates for the individual studies and
one column "sigma" containing the standard errors of these estimates.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>show.re</code></td>
<td>

<p>logical. If <code>TRUE</code>, the estimates for the random effect parameters <code class="reqn">\theta_i</code> are also shown. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>

<p>type of posterior point estimate. Either <code>"median"</code> for the posterior median or <code>"mean"</code> for the posterior mean. Defaults to <code>"median"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>

<p>method for computation of 95% credible intervals (CrIs). Either <code>"central"</code> for equal-tailed CrIs or <code>"shortest"</code> for shortest CrIs. Defaults to <code>"central"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.dist.method</code></td>
<td>

<p>method for computation of Hellinger distances between marginal posterior densities. Either <code>"integral"</code> for integral-based computation or <code>"moment"</code> for approximate moment-based calculation using a normal approximation. Defaults to <code>"integral"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.hn0</code></td>
<td>

<p>scale parameter of the half-normal benchmark prior (usually a small number to
obtain an anti-conservative benchmark which has most of its probability mass close to 0).
Defaults to 0.002.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu. Defaults to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu. Defaults to 4.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The two posterior benchmarks used are
introduced in Ott et al. (2021, Section 3.4),
where they are denoted by
<code class="reqn">po_{J}(\Psi)</code> and <code class="reqn">po_{HN0}(\Psi)</code>.
Here, <code class="reqn">\Psi \in \{ \mu, \tau, \theta_1, ..., \theta_k, \theta_{new}  \}</code>
denotes the parameter of interest in the NNHM,
where <code class="reqn">\theta_{i}</code> is the random effect in the <code class="reqn">i</code>th study and
<code class="reqn">\theta_{new}</code> the predicted effect for a new study.
For the overall mean parameter <code class="reqn">\mu</code>,
we additionally consider the fixed-effects model benchmark
<code class="reqn">po_{FE}(\mu)</code>.
</p>
<p>Note that Jeffreys reference posterior <code class="reqn">po_{J}</code> is proper if
there are at least two studies in the meta-analysis data set.
It is based on the improper Jeffreys reference prior,
which is minimally informative given the data.
The computation of the informativeness values is described in
Ott et al. (2021, Section 3.6).
</p>
<p>The absolute value of the signed informativeness quantifies how close the
actual posterior and the reference posterior <code class="reqn">po_{J}</code> are.
If the signed informativeness is negative, then the actual prior is anti-conservative  with respect to Jeffreys reference prior J (that is puts more weight on smaller values for <code class="reqn">\tau</code> than J).
If the signed informativeness is positive, then the actual prior is conservative  with respect to Jeffreys reference prior J (that is puts more weight on larger values for <code class="reqn">\tau</code> than J).
</p>
<p>If integral-based computation (<code>H.dist.method = "integral"</code>) of Hellinger distances is selected (the default), numerical integration is applied to obtain the Hellinger distance between the two marginal posterior densities (by using the function <code>H</code>).
If moment-based computation (<code>H.dist.method = "moment"</code>) is selected, the marginal densities are first approximated by normal densities with the same means and standard deviations and then the Hellinger distance between these normal densities can be obtained by an analytical formula (implemented in the function <code>H_normal</code>).
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.

</p>


<h3>Value</h3>

<p>A matrix with 6 columns and a number of columns depending on the number
of actual heterogeneity priors specified and the parameters of interests in the NNHM
(if <code>show.re = FALSE</code>, then there are 3 parameters of interest (<code class="reqn">\mu, \tau, \theta_{new}</code>) and the matrix has <code class="reqn">3*(n+2)+1</code> rows, where
where <code class="reqn">n</code>=length(<code>tau.prior</code>) is the number of actual heterogeneity priors specified;
if <code>show.re = TRUE</code>, then the matrix has <code class="reqn">(k+3)*(n+2)+1</code> rows, where
<code class="reqn">k</code> is the number of studies in the meta-analysis data set
(so that there are <code class="reqn">k+3</code> parameters of interest).)
</p>
<p>The row names specify the parameter in the NNHM for which the marginal posterior is considered,
followed by the heterogeneity prior used to compute that posterior.
HN0, J and FE denote the three benchmark priors introduced in Ott et al. (2021).
<code>pri_act_i</code> denotes the i-th prior in the <code>tau.prior</code> list.
</p>
<p>The 6 columns provide the following estimates:
</p>

<dl>
<dt>
<code>estimate</code>:</dt>
<dd>
<p> posterior point estimate (median or mean)</p>
</dd>
<dt>
<code>CrI_low</code>:</dt>
<dd>
<p> lower limit of the 95% credible interval</p>
</dd>
<dt>
<code>CrI_up</code>:</dt>
<dd>
<p> upper limit of the 95% credible interval</p>
</dd>
<dt>
<code>length_CrI</code>:</dt>
<dd>
<p> length of the 95% credible interval</p>
</dd>
<dt>
<code>H(po_HN0, po_act)</code>:</dt>
<dd>
<p> Hellinger distance between the posterior benchmark <code class="reqn">po_{HN0}(\Psi)</code> and the marginal posterior induced by the heterogeneity prior listed on the left, for the parameter <code class="reqn">\Psi</code> listed on the left</p>
</dd>
<dt>
<code>signed_inf</code>:</dt>
<dd>
<p> Signed informativeness, i.e. <code class="reqn">sign(H(po_{HN0}, po_{act}) - H(po_{HN0}, po_{J})) H(po_{act}, po_{J})</code>, for the marginal posterior induced by the heterogeneity prior listed on the left, for the parameter <code class="reqn">\Psi</code> listed on the left</p>
</dd>
</dl>
<h3>Warning </h3>

<p>If the integral-based method is used to compute Hellinger distances (<code>H.dist.method = "integral"</code>),
numerical problems may occur in some cases, which may lead to implausible outputs.
Therefore, we generally recommend to double-check the results of the integral-based method using the moment-based method (<code>H.dist.method = "moment"</code>) - especially if the former results are implausibe. If large differences between the two methods are observed, we recommend to rely on the moment-based method unless a normal approximation of the involved densities is inappropriate.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505â€“4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code>post_RA_fits</code>,
<code>post_RA_3bm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># for aurigular acupuncture (AA) data set with two
# actual half-normal heterogeneity priors
data(aa)
# it takes a few seconds to run this function
post_RA(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=0.5),
                              function(t)dhalfnormal(t, scale=1)))
                              
</code></pre>


</div>