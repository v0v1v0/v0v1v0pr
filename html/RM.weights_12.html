<div class="container">

<table style="width: 100%;"><tr>
<td>RM.w</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the weighted Rasch model using CML</h2>

<h3>Description</h3>

<p>This function computes item and raw score parameter estimates of a Rasch model for binary item responses by using weighted CML estimation. Input data should be a 0/1 matrix (1 = Yes). Residual correlation, fit statistics and corresponding standard errors, Rasch reliability and individual fit statistics are also reported.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RM.w(.data, .w = NULL, .d=NULL, country=NULL, se.control = TRUE, 
quantile.seq = NULL, write.file = FALSE, max.it=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>Input 0/1 data matrix or data frame; 
affirmative responses must be coded as 1s. Rows represent respondents, columns represent items. Missing values must be coded as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.w</code></td>
<td>
<p>Vector of sampling weights. 
The length must be the same as the number of rows of <code>.data</code>. 
If left unspecified, 
all the individuals will be equally weighted (<code>.w = rep(1, nrow(.data)))</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.d</code></td>
<td>
<p>Optional vector for the assumption on the extreme raw score parameters. 
Default is <code>0.5</code> and <code>(k-0.5)</code>,  <code>k</code> being the maximum number of items 
(columns of <code>.data</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>country</code></td>
<td>
<p>Optional (character) name of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.control</code></td>
<td>
<p>Are the measurement errors for respondent extreme parameters to be calculated based on raw scores <code>0.5</code> and <code>(k-0.5)</code>? If <code>FALSE</code>, measurement errors for those parameters are based on the pseudo-raw-scores specified in the <code>.d</code> vector. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile.seq</code></td>
<td>
<p>Quantiles corresponding to the observed and the expected 
individual fit statistic distributions. Default is <code>seq(0,1,0.01)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write.file</code></td>
<td>
<p>If <code>TRUE</code>, a CSV file with the main results will be saved 
in the working directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.it</code></td>
<td>
<p>Maximum number of iterations item parameters' estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The weighted CML method is used to estimate the item parameters. Respondent parameters  are estimated post-hoc as maximum likelihood given the item parameters. Cases with missing responses to some items can be included in the input data, but will not be used to estimate the Rasch model. Missing responses should be coded as <code>NA</code> in the input data file.
</p>
<p>As the parameters for the extreme raw scores (<code>0</code> and <code>k</code>), are undefined under the CML, some assumptions are needed unless the proportions of respondents with those raw scores are so small that they can be considered to be measured without error. 
Vector <code>.d</code>  gives the option to include up to four alternative assumptions on the pseudo-raw-scores on which calculation of parameters for extreme raw scores will be based. More in detail, <code>.d</code> can be a two, three or four element vector:
</p>

<ul>
<li>
<p> If <code>length(.d) = 4</code>, then the first two elements must refer to the assumptions for raw score 0, and the second two elements for raw score <code>k</code>. For instance <code>.d = c(0.1, 0.7, 7.1, 7.6)</code>, if the maximum raw score is 8.
</p>
</li>
<li>
<p> If <code>length(.d) = 3</code>, then the first two elements can either refer to the assumptions upon raw score <code>0</code> or raw score <code>k</code>, and the last one is defined accordingly. For instance <code>.d = c(0.1, 7.1, 7.6)</code> or <code>.d = c(0.1, 0.7, 7.6)</code>, if the maximum raw score is 8.
</p>
</li>
<li>
<p> If <code>length(.d) = 2</code>, then the first element must refer to the assumption for raw score <code>0</code>, and the second element for raw score <code>k</code>. For instance <code>.d = c(0.1, 7.6)</code>, if the maximum raw score is 8.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list with the following elements: 
</p>

<table>
<tr>
<td style="text-align: left;">
	<code>country</code> </td>
<td style="text-align: left;"> Name of the country or the application. </td>
</tr>
<tr>
<td style="text-align: left;">
	<code>b</code> </td>
<td style="text-align: left;"> Item severity parameters. </td>
</tr>
<tr>
<td style="text-align: left;"> 
	<code>a</code> </td>
<td style="text-align: left;"> Raw score severity parameters. </td>
</tr>
<tr>
<td style="text-align: left;"> 
<code>se.b</code> </td>
<td style="text-align: left;"> Item severities' standard error. </td>
</tr>
<tr>
<td style="text-align: left;"> 
<code>se.a</code> </td>
<td style="text-align: left;"> Raw score parameters' standard error. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>infit</code> </td>
<td style="text-align: left;"> Items' infit statistics. </td>
</tr>
<tr>
<td style="text-align: left;"> 
<code>outfit</code> </td>
<td style="text-align: left;"> Items' outfit statistics. </td>
</tr>
<tr>
<td style="text-align: left;"> 
<code>reliab</code> </td>
<td style="text-align: left;"> Rasch reliability. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>reliab.fl</code> </td>
<td style="text-align: left;"> Rasch reliability (equally weighted across raw scores). </td>
</tr>
<tr>
<td style="text-align: left;">
<code>infit.person</code> </td>
<td style="text-align: left;"> Respondents' infits. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>outfit.person</code> </td>
<td style="text-align: left;"> Respondents' outfits. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>q.infit.theor</code> </td>
<td style="text-align: left;"> Quintiles of theoretical person infits. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>q.infit</code> </td>
<td style="text-align: left;"> Quintiles of person infits. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>q.outfit.theor</code> </td>
<td style="text-align: left;"> Quintiles of theoretical person outfits. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>q.outfit</code> </td>
<td style="text-align: left;"> Quintiles of person outfits. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>res.corr</code> </td>
<td style="text-align: left;"> Residual correlation matrix. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>se.infit</code> </td>
<td style="text-align: left;"> Standard errors of infits. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>mat.res</code> </td>
<td style="text-align: left;"> Matrix of individual residuals for each item. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>d</code> </td>
<td style="text-align: left;"> Pseudo raw scores for the calculation of extreme raw score parameters. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>XX</code> </td>
<td style="text-align: left;"> Data matrix. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>wt</code> </td>
<td style="text-align: left;"> Vector of post-stratification sampling weights. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>n.compl</code> </td>
<td style="text-align: left;"> Number of complete, non-extreme cases. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>wt.rs</code> </td>
<td style="text-align: left;"> Weighted (absolute) distribution of respondents across raw scores. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>wt.rs</code> </td>
<td style="text-align: left;"> Weighted (relative) distribution of respondents across raw scores. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>converged</code> </td>
<td style="text-align: left;"> Character indicating if the item estimation algorithm has reached convergence
or the maximum number of iterations has been reached without convergence. </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a>, Mark Nord <a href="mailto:mark.nord@fao.org">mark.nord@fao.org</a></p>


<h3>Examples</h3>

<pre><code class="language-R">data(data.FAO_country1)
# Questionnaire data and weights
XX.country1 = data.FAO_country1[,1:8]
wt.country1 = data.FAO_country1$wt
# Fit weighted Rasch
rr.country1 = RM.w(XX.country1, wt.country1)
# Fit unweighted Rasch
rr.country1.nw = RM.w(XX.country1)

# Item severity
rr.country1$b

# Item standard error
rr.country1$se.b

# Respondent severity for each raw score
rr.country1$a

# Respondent measurement error for each raw score
rr.country1$se.a

# Item infit  
rr.country1$infit

# Item outfit 
rr.country1$outfit

# Rasch reliability based on observed distribution of cases across raw scores
rr.country1$reliab

# Rasch reliability  based on equal proportion of cases in each 
# non-extreme raw score (more comparable across datasets)
rr.country1$reliab.fl

# Checking conditional independence: residual correlation matrix 
rr.country1$res.cor

</code></pre>


</div>