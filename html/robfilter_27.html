<div class="container">

<table style="width: 100%;"><tr>
<td>wrm.smooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Repeated Median Smoothing</h2>

<h3>Description</h3>

<p>A robust smoothing tool using a kernel weighted version of Siegel's (1982) repeated median.
It can be seen as an alternative to local linear L1 regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wrm.smooth(x, y, h, xgrid, weight = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of responses, needs to have the same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Bandwidth, measured in the same units as the explanatory (independent) variable x: 
(x[0]-<code>h</code>,x[0]+<code>h</code>) is the range of x-values to be included in the local smoothing at x[0]. Needs to be a positive number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgrid</code></td>
<td>
<p>Grid on which fitted values are to be evaluated. The default is here to take the input
values <code>x</code> for a sample size of at most 100, and <code>seq(min(x),max(x), l=100)</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Indicates the weight function used.
</p>

<dl>
<dt><code>weight=1</code></dt>
<dd>
<p>triangular weights</p>
</dd>
<dt><code>weight=2</code></dt>
<dd>
<p>Epanechnikov weights (default)</p>
</dd>
<dt><code>weight=3</code></dt>
<dd>
<p>Gaussian weights</p>
</dd>
<dt><code>weight=4</code></dt>
<dd>
<p>Biweight</p>
</dd>
<dt><code>weight=5</code></dt>
<dd>
<p>Uniform weights</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Weighted repeated median (WRM) smoothing was suggested in a signal extraction framework by Fried, Einbeck &amp; Gather (2007). 
It combines the advantages of weighted and repeated medians, i.e. the WRM smoother is robust to outliers and adapts to linear trends (through the slope parameter of the repeated median, which is calculated by applying two consecutive weighted medians onto the pairwise slopes).  
The theory and simulations provided by Fried, Einbeck &amp; Gather focus on online signal extraction from time series. Warning: The case of a kernel weighted repeated median smoother for arbitraty non-equidistant design (as implemented here) is not fully investigated yet.
</p>
<p>The procedure copes with missing values by omitting them.
</p>


<h3>Value</h3>

 
<p><code>wrm.smooth</code> returns an object of class 
<code>wrm.smooth</code>. An 
object of class <code>wrm.smooth</code> is a list containing the 
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the original input time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the corresponding signal level extraceted by the weighted Repeated Median filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>the corresponding WRM slope within each time window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgrid</code></td>
<td>
<p>vector with grid values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>name of the weight function used for the fit.</p>
</td>
</tr>
</table>
<p>The function <code>plot</code> returns a plot 
showing the original data with the smoothed output.</p>


<h3>Author(s)</h3>

<p>Jochen Einbeck and Roland Fried</p>


<h3>References</h3>

<p>Fried, R., Einbeck, J., Gather, U. (2007), Weighted Repeated Median Smoothing and Filtering, 
<em>Journal of the American Statistical Association</em> <b>102</b>, 1300-1308. <br>
Preliminary version available as technical report from <a href="https://eldorado.tu-dortmund.de/handle/2003/21637">https://eldorado.tu-dortmund.de/handle/2003/21637</a> 
</p>
<p>Siegel, A.F. (1982). Robust regression using repeated medians. <em>Biometrika</em> <b>68</b>, 242-244.
</p>


<h3>See Also</h3>

<p><code>wrm.filter</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(faithful) # Old Faithful Geyser data
faith.WRM &lt;- wrm.smooth(faithful$w, faithful$e,h=4)
plot(faith.WRM)
</code></pre>


</div>