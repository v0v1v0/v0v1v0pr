<div class="container">

<table style="width: 100%;"><tr>
<td>mscarm.filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MSCARM (Multivariate Slope Comparing Adaptive Repeated Median)</h2>

<h3>Description</h3>

<p>A multivariate version of the <code>scarm.filter</code> which also gives information about parallel running components of the multivariate time series</p>


<h3>Usage</h3>

<pre><code class="language-R">mscarm.filter(time.series,
              right.width=30, min.left.width=right.width,
              min.width=floor(right.width/3), max.width=200,
              sign.level=0.001, bound.noise.sd=0.01,
              rtr=TRUE, autocorrelations="automatic",
              c.bound=3, r.bound=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>
<p>a numeric matrix or multivariate time series object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right.width</code></td>
<td>
<p>a positive integer <code class="reqn">\ge 5</code> defining the fixed width of the right-hand window used for the SCARM test; the choice of <code>right.width</code> is crucial to distinguish between a patch of outliers and a signal change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.left.width</code></td>
<td>
<p>a positive integer <code class="reqn">\ge</code> <code>right.width</code> defining the minimum width of the left-hand window used for testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.width</code></td>
<td>
<p>a positive integer <code class="reqn">\ge 5</code> specifying the minimum window width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.width</code></td>
<td>
<p>a positive integer <code class="reqn">\ge</code> <code>min.width</code> and <code class="reqn">\ge</code> <code>right.width</code> + <code>min.left.width</code> specifying the maximum window width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign.level</code></td>
<td>
<p>significance level of the SCARM test procedure; must be a value in <code class="reqn">(0,0.5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound.noise.sd</code></td>
<td>
<p>a lower bound for the estimate of the noise standard deviation; this bound ensures that the noise scale estimate cannot be zero due to ties in the data; must be a value <code class="reqn">&gt; 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtr</code></td>
<td>
<p>if <code>rtr=TRUE</code>, the signal estimation is restricted to the range of the rightmost <code>min.width</code> observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autocorrelations</code></td>
<td>
<p>the <code>mscarm.filter</code> is developed for non-autocorrelated data, but can be adapted to work for AR(1) processes with parameter <code class="reqn">\phi = -0.9,-0.6,...,0.9</code>; <code>autocorrelations</code> must be either "no" (<code class="reqn">\phi=0</code>), "high.positive" (<code class="reqn">\phi=0.9</code>), "moderate.positive" (<code class="reqn">\phi=0.6</code>), "small.positive" (<code class="reqn">\phi=0.3</code>), "small.negative" (<code class="reqn">\phi=-0.3</code>), "moderate.negative (<code class="reqn">\phi=-0.6</code>)", "high.negative (<code class="reqn">\phi=-0.9</code>)" or "automatic"; if <code>autocorrelations="automatic"</code>, the true parameter <code class="reqn">\phi</code> is estimated at each time point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.bound</code></td>
<td>
<p>the bound for the SSM (Similar Slope Monitoring) statistic which is the absolute difference of RM (Repeated Median) trend estimates (of two univariate time series) relative to the estimated standard deviation of this difference; if the SSM statistic is not larger than <code>c.bound</code>, a relationship between the two time series is assumed; <code>c.bound</code> must be a value &gt;0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.bound</code></td>
<td>
<p>the bound for the ratio of adapted window widths (of two univariate time series); a relationship between the two time series is only possible, if this ratio (smaller window width divided by larger window width) is smaller than <code>r.bound</code>; <code>r.bound</code> must be a value in <code class="reqn">[0,1]</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>mscarm.filter</code> is a procedure for real-time signal extraction from noisy and outlier-contaminated instationary multivariate time series. It is based on <em>Repeated Median</em> regression (Siegel, 1982) in moving time windows. At each time point <code class="reqn">t</code> the test procedure of the SCARM filter (Borowski and Fried, 2011) is used to determine an appropriate window width <code class="reqn">n(t)</code> in [<code>min.width</code>, <code>max.width</code>]. Then the signal vector at time <code class="reqn">t</code> is estimated within the time window <code class="reqn">(t-n(t)+1,\ldots,t)</code> by a slight modification of the multivariate <em>Trimmed Repeated Median-Least Squares</em> regression (Lanius, Gather, 2010). At each time point <code class="reqn">t</code>, the <code>mscarm.filter</code> uses the <em>Similar Slope Monitoring</em> (SSM) method to build blocks of currently interrelated univariate time series. This information is given to the user and is used to improve the signal estimations. A detailed description of the <code>mscarm.filter</code> can be found in Borowski (2012).
</p>


<h3>Value</h3>

<p><code>mscarm.filter</code> returns an object of class <code>mscarm.filter</code>.  
An object of class <code>mscarm.filter</code> is a list containing the 
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>signal.est</code></td>
<td>
<p>a matrix containing the signal estimations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope.est</code></td>
<td>
<p>a matrix containing the slope (or trend) estimations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapted.width</code></td>
<td>
<p>a matrix containing the adapted window widths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise.sd.est</code></td>
<td>
<p>a matrix containing the estimated noise standard deviations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scarm.signal.est</code></td>
<td>
<p>a matrix containing the signal estimates of the univariate SCARM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scarm.width</code></td>
<td>
<p>a matrix containing the adapted window widths of the univariate SCARM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scarm.statistic</code></td>
<td>
<p>a matrix containing the SCARM test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scarm.critval</code></td>
<td>
<p>a matrix containing the critical values of the SCARM test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssm.statistic</code></td>
<td>
<p>a matrix containing the SSM statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks</code></td>
<td>
<p>a matrix of the blocks built by the SSM procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acf.lag.one</code></td>
<td>
<p>a matrix containing the estimated autocorrelations at lag one for each time point; estimation is done on the recent <code>max.width</code> observations at each time point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>
<p>the original input data</p>
</td>
</tr>
</table>
<p>In addition, the input arguments used for the analysis are returned as list members.
</p>
<p>Application of the function <code>plot</code> to an object of class
<code>mscarm.filter</code> returns a plot showing the original time series 
with the filtered output. If <code>info==TRUE</code> (default), a plot showing the results of the SSM procedure is given.
</p>


<h3>Author(s)</h3>

<p>Matthias Borowski</p>


<h3>References</h3>

 
<p>Borowski, M. (2012)
Echtzeit-Extraktion relevanter Information aus multivariaten Zeitreihen basierend auf robuster Regression, <em>PhD thesis, TU Dortmund University (in German)</em>.<br></p>
<p>Borowski, M. and Fried, R. (2011)
Robust repeated median regression in moving windows with data-adaptive width selection, <em>Discussion Paper 28/2011, SFB 823, TU Dortmund University</em>.<br></p>
<p>Lanius, V., Gather, U. (2010)
Robust Online Signal Extraction from Multivariate Time Series, 
<em>Computational Statistics and Data Analysis</em> <b>54</b>(4), 966-975.<br></p>
<p>Siegel, A.F. (1982)
Robust Regression Using Repeated Medians,
<em>Biometrika</em> <b>69</b>(1), 242-244.<br></p>


<h3>See Also</h3>

<p><code>robreg.filter</code>, <code>adore.filter</code>, <code>madore.filter</code>, <code>scarm.filter</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Multivariate time series
data(multi.ts)

# apply MSCARM Filter 
mscarm.extr &lt;- mscarm.filter(multi.ts)
plot(mscarm.extr)

## End(Not run)
</code></pre>


</div>