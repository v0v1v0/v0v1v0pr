<div class="container">

<table style="width: 100%;"><tr>
<td>brown.method</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Brown's Method on the Number of Records</h2>

<h3>Description</h3>

<p>Performs Brown's method on the p-values of <code>N.test</code>
as proposed by Cebrián, Castillo-Mateo and Asín (2022). The null 
hypothesis of the classical record model (i.e., of IID continuous RVs) is 
tested against the alternative hypothesis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">brown.method(
  X,
  weights = function(t) 1,
  record = c(FU = 1, FL = 1, BU = 1, BL = 1),
  alternative = c(FU = "greater", FL = "less", BU = "less", BL = "greater"),
  correct = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A function indicating the weight given to the different 
records according to their position in the series,
e.g., if <code>function(t) t-1</code> then <code class="reqn">\omega_t = t-1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>record</code></td>
<td>
<p>Vector of length four. Each element is a logical indicating if
the p-value of the test for forward upper, forward lower, backward upper 
and backward lower are going to be used, respectively. Logical values or 
0,1 values are accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Vector of length four. Each element is one of 
<code>"greater"</code> or <code>"less"</code> indicating the alternative hypothesis 
in every test (for forward upper, forward lower, backward upper and 
backward lower records, respectively). Under the alternative hypothesis 
of linear trend the FU and BL records will be greater and the FL and BU
records will be less than under the null, but other combinations (e.g., 
for trend in variation) could be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>Logical. Indicates, whether a continuity correction 
should be applied in <code>N.test</code>; defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test is implemented as given by Cebrián, 
Castillo-Mateo and Asín (2022), where the p-values 
<code class="reqn">p^{(FU)}</code>, <code class="reqn">p^{(FL)}</code>, <code class="reqn">p^{(BU)}</code>, and <code class="reqn">p^{(BL)}</code>
of the test <code>N.test</code> for the four types of record are used for
the statistic:
</p>
<p style="text-align: center;"><code class="reqn">-2 \left(\log(p^{(FU)}) + \log(p^{(FL)}) + \log(p^{(BU)}) + \log(p^{(BL)})\right).</code>
</p>

<p>Any other combination of p-values for the test is also allowed (see 
argument <code>record</code>).
</p>
<p>According to Brown's method (Brown, 1975) for the union of dependent 
p-values, the statistic follows a <code class="reqn">c \chi^2_{df}</code> distribution, 
with a scale parameter <code class="reqn">c</code> and <code class="reqn">df</code> degrees of freedom that 
depend on the covariance of the p-values. This covariances are 
approximated according to Kost and McDermott (2002):
</p>
<p style="text-align: center;"><code class="reqn">\textrm{COV}\left(-2 \log(p^{(i)}), -2 \log(p^{(j)})\right) \approx 3.263 \rho_{ij} + 0.710 \rho_{ij}^2 + 0.027 \rho_{ij}^3,</code>
</p>

<p>where <code class="reqn">\rho_{ij}</code> is the correlation between their respective 
statistics.
</p>
<p>Power studies indicate that this and <code>foster.test</code> using all
four types of record and linear weights are the two most powerful records
tests for trend detection against a linear drift model. In particular, 
this test is more powerful than Mann-Kendall test against alternatives 
with a linear drift in location in series of generalised Pareto variables
and some cases of the generalised extreme value variables (see Cebrián, 
Castillo-Mateo and Asín, 2022).
</p>


<h3>Value</h3>

<p>A <code>"htest"</code> object with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Value of the chi-square statistic (not scaled).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>Degrees of freedom <code class="reqn">df</code> and scale parameter <code class="reqn">c</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the type of test performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name of the data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Brown M (1975). “A Method for Combining Non-Independent, One-Sided Tests of Significance.” 
<em>Biometrics</em>, <strong>31</strong>(4), 987-992.
<a href="https://doi.org/10.2307/2529826">doi:10.2307/2529826</a>.
</p>
<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2), 313-330.
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>
<p>Kost JT, McDermott MP (2002). “Combining Dependent P-Values.”
<em>Statistics &amp; Probability Letters</em>, <strong>60</strong>(2), 183-190.
<a href="https://doi.org/10.1016/S0167-7152%2802%2900310-3">doi:10.1016/S0167-7152(02)00310-3</a>.
</p>


<h3>See Also</h3>

<p><code>fisher.method</code>, <code>foster.test</code>, 
<code>N.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">brown.method(ZaragozaSeries)
brown.method(ZaragozaSeries, weights = function(t) t-1)
brown.method(ZaragozaSeries, weights = function(t) t-1, correct = FALSE)

# Join p-values of upper records
brown.method(ZaragozaSeries, weights = function(t) t-1, record = c(1,0,1,0))
# Join p-values of lower records
brown.method(ZaragozaSeries, weights = function(t) t-1, record = c(0,1,0,1))

</code></pre>


</div>