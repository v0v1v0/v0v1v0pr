<div class="container">

<table style="width: 100%;"><tr>
<td>datasheet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieve a SyncroSim Datasheet</h2>

<h3>Description</h3>

<p>This function retrieves a SyncroSim Datasheet, either by calling the SyncroSim
console, or by directly querying the <code>SsimLibrary</code> database.
</p>


<h3>Usage</h3>

<pre><code class="language-R">datasheet(
  ssimObject,
  name = NULL,
  project = NULL,
  scenario = NULL,
  summary = NULL,
  optional = FALSE,
  empty = FALSE,
  filterColumn = NULL,
  filterValue = NULL,
  lookupsAsFactors = TRUE,
  sqlStatement = list(select = "SELECT *", groupBy = ""),
  includeKey = FALSE,
  forceElements = FALSE,
  fastQuery = FALSE,
  returnScenarioInfo = FALSE,
  returnInvisible = FALSE,
  rawValues = FALSE,
  verbose = TRUE
)

## S4 method for signature 'list'
datasheet(
  ssimObject,
  name = NULL,
  project = NULL,
  scenario = NULL,
  summary = NULL,
  optional = FALSE,
  empty = FALSE,
  filterColumn = NULL,
  filterValue = NULL,
  lookupsAsFactors = TRUE,
  sqlStatement = list(select = "SELECT *", groupBy = ""),
  includeKey = FALSE,
  forceElements = FALSE,
  fastQuery = FALSE,
  returnScenarioInfo = FALSE,
  returnInvisible = FALSE,
  rawValues = FALSE,
  verbose = TRUE
)

## S4 method for signature 'character'
datasheet(
  ssimObject,
  name,
  project,
  scenario,
  summary,
  optional,
  empty,
  filterColumn,
  filterValue,
  lookupsAsFactors,
  sqlStatement,
  includeKey,
  fastQuery,
  returnScenarioInfo,
  returnInvisible,
  rawValues,
  verbose
)

## S4 method for signature 'SsimObject'
datasheet(
  ssimObject,
  name = NULL,
  project = NULL,
  scenario = NULL,
  summary = NULL,
  optional = FALSE,
  empty = FALSE,
  filterColumn = NULL,
  filterValue = NULL,
  lookupsAsFactors = TRUE,
  sqlStatement = list(select = "SELECT *", groupBy = ""),
  includeKey = FALSE,
  forceElements = FALSE,
  fastQuery = FALSE,
  returnScenarioInfo = FALSE,
  returnInvisible = FALSE,
  rawValues = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ssimObject</code></td>
<td>
<p><code>SsimLibrary</code>, <code>Project</code>,
or <code>Scenario</code> object or list of objects.
Note that all objects in a list must be of the same type, and belong to
the same SsimLibrary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character or character vector. Sheet name(s). If <code>NULL</code> (default),
all datasheets in the ssimObject will be returned. Note that setting
<code>summary=FALSE</code> and <code>name=NULL</code> pulls all Datasheets, which is time
consuming and not generally recommended</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>project</code></td>
<td>
<p>numeric or numeric vector. One or more
<code>Project</code> ids</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scenario</code></td>
<td>
<p>numeric or numeric vector. One or more
<code>Scenario</code> ids</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>logical or character. If <code>TRUE</code> (default) returns a data.frame of sheet names
and other info including built-in core SyncroSim Datasheets. If <code>FALSE</code> returns
data.frame or list of data.frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optional</code></td>
<td>
<p>logical. If <code>summary=TRUE</code> and <code>optional=TRUE</code> returns
only <code>scope</code>, <code>name</code> and <code>displayName</code>. If <code>summary=FALSE</code> and <code>optional=TRUE</code> returns
all of the Datasheet's columns, including the optional columns. If
<code>summary=TRUE</code>, <code>optional=FALSE</code> (default), returns only those columns that are mandatory
and contain data (if <code>empty=FALSE</code>). Ignored if <code>summary=FALSE</code>, <code>empty=FALSE</code>
and <code>lookupsAsFactors=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empty</code></td>
<td>
<p>logical. If <code>TRUE</code> returns empty data.frames for each
Datasheet. Ignored if <code>summary=TRUE</code> Default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filterColumn</code></td>
<td>
<p>character string. The column to filter a Datasheet by.
(e.g. "TransitionGroupId"). Note that to use the filterColumn argument,
you must also specify the filterValue argument. Default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filterValue</code></td>
<td>
<p>character string or integer. The value to filter the
filterColumn by. To use the filterValue argument, you must also specify
the filterColumn argument. Default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lookupsAsFactors</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) dependencies
returned as factors with allowed values (levels). Set <code>FALSE</code> to speed
calculations. Ignored if <code>summary=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqlStatement</code></td>
<td>
<p>list returned by <code>sqlStatement</code>. <code>SELECT</code> and
<code>GROUP BY</code> SQL statements passed to SQLite database. Ignored if
<code>summary=TRUE</code> (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>includeKey</code></td>
<td>
<p>logical. If <code>TRUE</code> include primary key in table. Default is
<code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forceElements</code></td>
<td>
<p>logical. If <code>FALSE</code> (default) and name has a single element
returns a data.frame; otherwise returns a list of data.frames. Ignored if
<code>summary=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fastQuery</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the request is optimized for
performance.  Ignored if combined with summary, empty, or
<code>sqlStatement</code> flags. Default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnScenarioInfo</code></td>
<td>
<p>logical. If <code>TRUE</code>, returns the Scenario Id,
Scenario Name, Parent Id, and Parent Name columns with the
Scenario-scoped Datasheet. Does nothing if the Datasheet exists at the
Library or Project level. Default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnInvisible</code></td>
<td>
<p>logical. If <code>TRUE</code>, returns columns that are
invisible in the User Interface (i.e., are only used and populated
internally by SyncroSim or the SyncroSim Package). Default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rawValues</code></td>
<td>
<p>logical. If <code>TRUE</code>, returns the raw ID values rather
than automatically translating the values to strings. Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If set to <code>FALSE</code>, will not print notes about
datasheet validation. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>summary=TRUE</code> or <code>summary=NULL</code> and <code>name=NULL</code> a data.frame describing the
Datasheets is returned. If <code>optional=TRUE</code>, columns include: <code>scope</code>, <code>packages</code>,
<code>name</code>, <code>displayName</code>, <code>isSingle</code>, <code>data</code>. data only displayed for
a SyncroSim <code>Scenario</code>. <code>dataInherited</code> and <code>dataSource</code> columns
added if a Scenario has dependencies. If <code>optional=FALSE</code>, columns include:
<code>scope</code>, <code>name</code>, <code>displayName</code>. All other arguments are ignored.
</p>
<p>Otherwise, for each element in name a Datasheet is returned as follows:
</p>

<ul>
<li>
<p> If <code>lookupsAsFactors=TRUE</code> (default): Each column is given the correct
data type, and dependencies returned as factors with allowed values (levels).
A warning is issued if the lookup has not yet been set.
</p>
</li>
<li>
<p> If <code>empty=TRUE</code>: Each column is given the correct data type. Fast (1 less
console command).
</p>
</li>
<li>
<p> If <code>empty=FALSE</code> and <code>lookupsAsFactors=FALSE</code>: Column types are not checked,
and the optional argument is ignored. Fast (1 less console command).
</p>
</li>
<li>
<p> If SsimObject is a list of <code>Scenario</code> or <code>Project</code>
objects (output from <code>run</code>, <code>Scenario</code> or
<code>Project</code>): Adds ScenarioId/ProjectId column if appropriate.
</p>
</li>
<li>
<p> If Scenario/Project is a vector: Adds ScenarioId/ProjectId column
as necessary.
</p>
</li>
<li>
<p> If requested Datasheet has Scenario scope and contains info from more
than one Scenario: ScenarioId/ScenarioName/ScenarioParent columns
identify the Scenario by <code>name</code>, <code>id</code>, and <code>parent</code> (if a result Scenario).
</p>
</li>
<li>
<p> If requested Datasheet has Project scope and contains info from more
than one Project: ProjectId/ProjectName columns identify the Project
by <code>name</code> and <code>id</code>
</p>
</li>
</ul>
<h3>Value</h3>

<p>If <code>summary=TRUE</code> returns a data.frame of Datasheet names
and other information, otherwise returns a data.frame or list of these.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Install helloworldSpatial package from package server
installPackage("helloworldSpatial")

# Set the file path and name of the new SsimLibrary
myLibraryName &lt;- file.path(tempdir(),"testlib_datasheet")

# Set the SyncroSim Session
mySession &lt;- session()

# Create a new SsimLibrary with the example template from helloworldSpatial
myLibrary &lt;- ssimLibrary(name = myLibraryName,
                         session = mySession, 
                         packages = "helloworldSpatial")
                         
# Set the Project and Scenario
myProject &lt;- project(myLibrary, project = "Definitions")
myScenario &lt;- scenario(myProject, scenario = "My Scenario")

# Get all Datasheet info for the Scenario
myDatasheets &lt;- datasheet(myScenario)


# Return a list of data.frames (1 for each Datasheet)
myDatasheetList &lt;- datasheet(myScenario, summary = FALSE)

# Get a specific Datasheet
myDatasheet &lt;- datasheet(myScenario, name = "helloworldSpatial_RunControl")

# Include primary key when retrieving a Datasheet
myDatasheet &lt;- datasheet(myScenario, name = "helloworldSpatial_RunControl", 
                         includeKey = TRUE)

# Return all columns, including optional ones
myDatasheet &lt;- datasheet(myScenario, name = "helloworldSpatial_RunControl", 
                         summary = TRUE, optional = TRUE)

# Return Datasheet as an element
myDatasheet &lt;- datasheet(myScenario, name = "helloworldSpatial_RunControl", 
                         forceElements = TRUE)
myDatasheet$helloworldSpatial_RunControl

# Get a Datasheet without pre-specified values
myDatasheetEmpty &lt;- datasheet(myScenario, 
                              name = "helloworldSpatial_RunControl", 
                              empty = TRUE)

# If Datasheet is empty, do not return dependencies as factors
myDatasheetEmpty &lt;- datasheet(myScenario, 
                              name = "helloworldSpatial_RunControl", 
                              empty = TRUE,
                              lookupsAsFactors = FALSE)
                              
# Optimize query
myDatasheet &lt;- datasheet(myScenario, name = "helloworldSpatial_RunControl", 
                         fastQuery = TRUE)

# Get specific SsimLibrary core Datasheet
myDatasheet &lt;- datasheet(myLibrary, name = "core_Backup")

# Use an SQL statement to query a Datasheet
mySQL &lt;- sqlStatement(
  groupBy = c("ScenarioId"),
  aggregate = c("MinimumTimestep"),
  where = list(MinimumTimestep = c(1))
)
myAggregatedDatasheet &lt;- datasheet(myScenario, 
                                   name = "helloworldSpatial_RunControl",
                                   sqlStatement = mySQL)

## End(Not run)

</code></pre>


</div>