<div class="container">

<table style="width: 100%;"><tr>
<td>stack_rwnn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stacking random weight neural networks</h2>

<h3>Description</h3>

<p>Use stacking to create ensemble random weight neural networks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stack_rwnn(
  formula,
  data = NULL,
  n_hidden = c(),
  lambda = NULL,
  B = 100,
  optimise = FALSE,
  folds = 10,
  method = NULL,
  type = NULL,
  control = list()
)

## S3 method for class 'formula'
stack_rwnn(
  formula,
  data = NULL,
  n_hidden = c(),
  lambda = NULL,
  B = 100,
  optimise = FALSE,
  folds = 10,
  method = NULL,
  type = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula specifying features and targets used to estimate the parameters of the output layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data-set (either a data.frame or a tibble) used to estimate the parameters of the output layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_hidden</code></td>
<td>
<p>A vector of integers designating the number of neurons in each of the hidden layers (the length of the list is taken as the number of hidden layers).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The penalisation constant(s) passed to either rwnn or ae_rwnn (see <code>method</code> argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of models in the stack.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimise</code></td>
<td>
<p>TRUE/FALSE: Should the stacking weights be optimised (or should the stack just predict the average)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folds</code></td>
<td>
<p>The number of folds used when optimising the stacking weights (see <code>optimise</code> argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The penalisation type passed to ae_rwnn. Set to <code>NULL</code> (default), <code>"l1"</code>, or <code>"l2"</code>. If <code>NULL</code>, rwnn is used as the base learner.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string indicating whether this is a regression or classification problem.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of additional arguments passed to the control_rwnn function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An ERWNN-object.
</p>


<h3>References</h3>

<p>Wolpert D. (1992) "Stacked generalization." <em>Neural Networks</em>, 5, 241-259.
</p>
<p>Breiman L. (1996) "Stacked regressions." <em>Machine Learning</em>, 24, 49-64.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n_hidden &lt;- c(20, 15, 10, 5)
lambda &lt;- 0.01
B &lt;- 100

## Using the average of the stack to predict new targets

m &lt;- stack_rwnn(y ~ ., data = example_data, n_hidden = n_hidden,
                lambda = lambda, B = B)


## Using the optimised weighting of the stack to predict new targets

m &lt;- stack_rwnn(y ~ ., data = example_data, n_hidden = n_hidden,
                lambda = lambda, B = B, optimise = TRUE)


</code></pre>


</div>