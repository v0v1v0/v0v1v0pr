<div class="container">

<table style="width: 100%;"><tr>
<td>recluster.test.dist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Test variation lost by a bidimensional configuration when the coordinates of the elements are reduced to the configuration of the barycentres of a given series of groups.
</h2>

<h3>Description</h3>

<p>This function evaluates the amount of variation maintained by a bidimensional configuration after the elements are reduced to the barycentres according to a grouping variable. If elements of different groups are randomly scattered in the configuration, almost all barycentres are expected to attain a rather central position with respect to the original elements, which would result in a small mean distance between barycentres. Conversely, if the elements of different groups are strictly clustered in the representation, the distances among barycentres are expected to be similar to the distances among original elements.
</p>


<h3>Usage</h3>

<pre><code class="language-R">recluster.test.dist(mat1,mat2,member,perm=1000,elev=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat1</code></td>
<td>

<p>The bidimensional configuration before computing barycentres for groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat2</code></td>
<td>

<p>The bidimensional configuration after computing barycentres for groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>member</code></td>
<td>

<p>A vector indicating group membership for each element.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>

<p>The number of permutations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elev</code></td>
<td>

<p>The power of distances (by default 2:squared distances).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function produces a ratio between the mean squared pairwise distance for all elements and the mean squared pairwise distance for barycentres. This ratio is calculated for the overall configuration and for the two axes separately. The function also provides a test for the significance of the variation preserved by barycentres by creating a custom number of matrices (1000 by default) by randomly sampling the original vector defining groups. Then it computes the frequency of mean squared distance ratios in random configurations higher than the observed ratio. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>

<p>The ratio between mean distances among original elements and barycentres over the overall configuration.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratioX</code></td>
<td>

<p>The ratio between mean distances among original elements and barycentres on the X axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratioY</code></td>
<td>

<p>The ratio between mean distances among original elements and barycentres on the Y axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>The permutation test for variation maintained over the overall configuration.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testX</code></td>
<td>

<p>The permutation test for variation maintained along the X axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testY</code></td>
<td>

<p>The permutation test for variation maintained along the Y axis.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Dapporto L., Voda R., Dinca V., Vila R.
"Comparing population patterns for genetic and morphological markers with uneven sample sizes. An example for the butterfly Maniola jurtina"
Methods Ecol Evol (2014), 5, 834-843.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dataisl)
#Define groups of islands
memb&lt;-c(2,3,5,7,5,3,1,1,2,5,1,3,1,1,5,2,2,1,2,4,1,3,1,5,2,1,7,6,1,1,1) 
#Compute bidimensional representation for elements
pcoa&lt;-cmdscale(recluster.dist(dataisl))
bar&lt;-aggregate(pcoa~memb,FUN="mean")[,2:3]
# test if the variation has been significantly lost
recluster.test.dist(pcoa,bar,memb,perm=100)
</code></pre>


</div>