<div class="container">

<table style="width: 100%;"><tr>
<td>rrinf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic residual randomization confidence intervals</h2>

<h3>Description</h3>

<p>This function is a wrapper over rrtest and gives confidence intervals for all parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rrinf(
  y,
  X,
  g_invar,
  cover = 0.95,
  num_R = 999,
  control = list(num_se = 6, num_breaks = 60)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of outcomes (length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Covariate matrix (n x p). First column should be ones to include intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_invar</code></td>
<td>
<p>Function that transforms residuals. Accepts n-vector and returns n-vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cover</code></td>
<td>
<p>Number from [0, 1] that denotes the confidence interval coverage (e.g., 0.95 denotes 95%)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_R</code></td>
<td>
<p>Number of test statistic values to calculate in the randomization test (similar to no. of bootstrap samples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A <code>List</code> that constrols the scope of the test inversion.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function has similar funtionality as standard confint.
It generates confidence intervals by testing plausible values for each parameter.
The plausible values are generated as follows.
For some parameter beta_i we test successively
</p>
<p>H0: beta_i = hat_beta_i - <code>num_se</code> * se_i
</p>
<p>...up to...
</p>
<p>H0: beta_i = hat_beta_i + <code>num_se</code> * se_i
</p>
<p>broken in <code>num_breaks</code> intervals. Here, hat_beta_i is the OLS estimate of beta_i and se_i is the standard error.
We then report the minimum and maximum values in this search space which we cannot reject
at level <code>alpha</code>. This forms the desired confidence interval.
</p>


<h3>Value</h3>

<p>Matrix that includes the confidence interval endpoints, and the interval midpoint estimate.
</p>


<h3>Note</h3>

<p>If the confidence interval appears to be a point or is empty, then this means
that the nulls we consider are implausible.
We can try to improve the search through <code>control.tinv</code>.
For example, we can both increase <code>num_se</code> to increase the width of search,
and increase <code>num_breaks</code> to make the search space finer.
</p>


<h3>See Also</h3>

<p>Life after bootstrap: residual randomization inference in regression models (Toulis, 2019)
</p>
<p><a href="https://www.ptoulis.com/residual-randomization">https://www.ptoulis.com/residual-randomization</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
X = cbind(rep(1, 100), runif(100))
beta = c(-1, 1)
y = X %*% beta + rnorm(100)
g_invar = function(e) sample(e)  # Assume exchangeable errors.
M = rrinf(y, X, g_invar, control=list(num_se=4, num_breaks=20))
M  # Intervals cover true values
</code></pre>


</div>