<div class="container">

<table style="width: 100%;"><tr>
<td>tree.merger</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast addition of tips and clades on an existing tree</h2>

<h3>Description</h3>

<p>The function attaches new tips and/or clades derived from a
source phylogeny to a pre-existing backbone tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tree.merger(backbone,data,source.tree=NULL,age.offset=NULL,tip.ages =
  NULL, node.ages = NULL,min.branch=NULL,plot=TRUE,filename=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>backbone</code></td>
<td>
<p>the backbone tree to attach tips/clades on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataset including as columns:</p>
<ol>
<li>
<p> bind = the
tips/clades to be attached; </p>
</li>
<li>
<p> reference = the reference tip or clade
where 'bind' must be attached; </p>
</li>
<li>
<p> poly = logical specifying if 'bind'
and 'reference' should form a polytomous clade.</p>
</li>
</ol>
<p> See details for further
explanations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source.tree</code></td>
<td>
<p>the tree where 'bind' clades are to be extracted from. If
no clade has to be attached, it can be left unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age.offset</code></td>
<td>
<p>if the most recent age (i.e. the maximum distance from the
tree root) differs between the source and the backbone trees, the
“age.offset” is the difference between them in this exact order (source
minus backbone). It is positive when the backbone tree attains younger age
than the source tree, and vice-versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.ages</code></td>
<td>
<p>as in <code>scaleTree</code>, a named vector including the
ages (i.e. the time distance from the youngest tip within the tree) of the
tips. If unspecified, the function assumes all the tips on the backbone
tree are correctly placed and places all the new tips at the maximum
distance from the tree root (i.e. the present if the tips are extant).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.ages</code></td>
<td>
<p>as in <code>scaleTree</code>, a named vector including the ages
(i.e. the time distance from the youngest tip within the tree) of the
nodes. The nodes must be defined by collating the names of the two
phylogenetically furthest tips it subtends to, separated by the "-" symbol (see
examples). If no calibration date for nodes is supplied, the function may
shift the node position back in time as to place new tips/clades and to fit
tip ages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.branch</code></td>
<td>
<p>has been deprecated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>TRUE</code>, the function produces an interactive plotting
device to check the placing of each <code>bind</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>if <code>plot=TRUE</code> and provided a <code>filename</code> (with or
without the path), the function stores a pdf file showing the plot of the
entire phylogeny.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function attaches tips and/or clades from the <code>source</code> tree
to the <code>backbone</code> tree according to the <code>data</code> object. Within the
latter, a clade, either to be bound or to be the reference, must be
indicated by collating the names of the two phylogenetically furthest tips
belonging to it, separated by the "-" symbol. Alternatively, if
<code>backbone$node.label</code>/<code>source.tree$node.label</code> is not
<code>NULL</code>, a bind/reference clade can be indicated as "Clade
NAMEOFTHECLADE" when appropriate. Similarly, an entire genus on both the
<code>backbone</code> and the <code>source.tree</code> can be indicated as "Genus
NAMEOFTHEGENUS" (see examples below). Duplicated 'bind' produce error.
Tips/clades set to be attached to the same 'reference' with
'poly=FALSE' are considered to represent a polytomy. Tips set as 'bind'
which are already on the backbone tree are removed from the latter and
placed according to the 'reference'. See examples and
<a href="../doc/Tree-Manipulation.html#tree.merger.html">vignette</a> for
clarifications.
</p>


<h3>Value</h3>

<p>Merged phylogenetic tree.
</p>


<h3>Author(s)</h3>

<p>Silvia Castiglione, Carmela Serio, Pasquale Raia
</p>


<h3>References</h3>

<p>Castiglione, S., Serio, C., Mondanaro, A., Melchionna, M., &amp;
Raia, P. (2022). Fast production of large, time-calibrated, informal
supertrees with tree.merger. <em>Palaeontology</em>, 65:
e12588.https://doi.org/10.1111/pala.12588
</p>


<h3>See Also</h3>

<p><a href="../doc/Tree-Manipulation.html#tree.merger.html"><code>tree.merger</code>
vignette</a>; <a href="../doc/Tree-Manipulation.html#scaleTree"><code>scaleTree</code>
vignette</a>;
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
 require(ape)
 DataCetaceans$treecet-&gt;tree
 tree$node.label[131-Ntip(tree)]&lt;-"Crown_Mysticeti"

 data.frame(bind=c("Clade Crown_Mysticeti",
                   "Aetiocetus_weltoni",
                   "Saghacetus_osiris",
                   "Zygorhiza_kochii",
                   "Ambulocetus_natans",
                   "Genus Kentriodon",
                   "Tursiops_truncatus-Delphinus_delphis",
                   "Kogia_sima",
                   "Eurhinodelphis_cristatus",
                   "Grampus_griseus",
                   "Eurhinodelphis_bossi"),
            reference=c("Fucaia_buelli-Aetiocetus_weltoni",
                        "Aetiocetus_cotylalveus",
                        "Fucaia_buelli-Tursiops_truncatus",
                        "Saghacetus_osiris-Fucaia_buelli",
                        "Dalanistes_ahmedi-Fucaia_buelli",
                        "Clade Delphinida",
                        "Stenella_attenuata-Stenella_longirostris",
                        "Kogia_breviceps",
                        "Eurhinodelphis_longirostris",
                        "Globicephala_melas-Pseudorca_crassidens",
                        "Eurhinodelphis_longirostris"),
            poly=c(FALSE,
                   FALSE,
                   FALSE,
                   FALSE,
                   FALSE,
                   FALSE,
                   FALSE,
                   FALSE,
                   FALSE,
                   FALSE,
                   FALSE))-&gt;dato

 c(Aetiocetus_weltoni=28.0,
   Saghacetus_osiris=33.9,
   Zygorhiza_kochii=34.0,
   Ambulocetus_natans=40.4,
   Kentriodon_pernix=15.9,
   Kentriodon_schneideri=11.61,
   Kentriodon_obscurus=13.65,
   Eurhinodelphis_bossi=13.65,
   Eurhinodelphis_cristatus=5.33)-&gt;tip.ages
 c("Ambulocetus_natans-Fucaia_buelli"=52.6,
   "Balaena_mysticetus-Caperea_marginata"=21.5)-&gt;node.ages

 # remove some tips from the original tree and create a source tree
 drop.tip(tree,c(names(tip.ages),
                 tips(tree,131)[-which(tips(tree,131)%in%
                               c("Caperea_marginata","Eubalaena_australis"))],
                 tips(tree,195)[-which(tips(tree,195)=="Tursiops_aduncus")]))-&gt;backtree
 drop.tip(tree,which(!tree$tip.label%in%c(names(tip.ages),
                                          tips(tree,131),
                                          tips(tree,195))))-&gt;sourcetree

 plot(backtree,cex=.6)
 plot(sourcetree,cex=.6)

 tree.merger(backbone=backtree,data=dato,source.tree=sourcetree,
             tip.ages=tip.ages,node.ages = node.ages, plot=TRUE)-&gt;treeM
   
## End(Not run)
</code></pre>


</div>