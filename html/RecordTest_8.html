<div class="container">

<table style="width: 100%;"><tr>
<td>foster.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Foster-Stuart and Diersen-Trenkler Tests</h2>

<h3>Description</h3>

<p>Performs Foster-Stuart, Diersen-Trenkler and 
Cebrián-Castillo-Asín records tests for trend in location, variation or 
the tails. The hypothesis of the classical record model (i.e., 
of IID continuous RVs) is tested against the alternative hypothesis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">foster.test(
  X,
  weights = function(t) 1,
  statistic = c("D", "d", "S", "s", "U", "L", "W"),
  distribution = c("normal", "t"),
  alternative = c("greater", "less"),
  correct = FALSE,
  permutation.test = FALSE,
  simulate.p.value = FALSE,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A function indicating the weight given to the different 
records according to their position in the series,
e.g., if <code>function(t) t - 1</code> then <code class="reqn">\omega_t = t - 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>A character string indicating the type of statistic to be 
calculated, i.e., one of <code>"D"</code>, <code>"d"</code>, <code>"S"</code>, <code>"s"</code>,
<code>"U"</code>, <code>"L"</code> or <code>"W"</code> (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>A character string indicating the asymptotic 
distribution of the statistic, <code>"normal"</code> or Student's
<code>"t"</code> distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string indicating the type of alternative 
hypothesis, <code>"greater"</code> number of records or <code>"less"</code> number of
records.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>Logical. Indicates, whether a continuity correction 
should be done; defaults to <code>FALSE</code>. No correction is done if
<code>simulate.p.value = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutation.test</code></td>
<td>
<p>Logical. Indicates whether to compute p-values by
permutation simulation (Castillo-Mateo et al. 2023). It does not require 
that the columns of <code>X</code> be independent. If <code>TRUE</code> and 
<code>simulate.p.value = TRUE</code>, permutations take precedence and 
permutations are performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate.p.value</code></td>
<td>
<p>Logical. Indicates whether to compute p-values by
Monte Carlo simulation. If <code>permutation.test = TRUE</code>, permutations
take precedence and permutations are performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>If <code>permutation.test = TRUE</code> or <code>simulate.p.value = TRUE</code>, 
an integer specifying the number of replicates used in the permutation or
Monte Carlo estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In this function, the tests are implemented as given by Foster and Stuart
(1954), Diersen and Trenkler (1996, 2001) and some modifications in the
standardisation of the previous statistics given by Cebrián, 
Castillo-Mateo and Asín (2022). The null hypothesis is that the data come
from a population with independent and identically distributed
realisations. The one-sided alternative hypothesis is that the chosen
statistic is greater (or less) than under the null hypothesis. The
different statistics are calculated according to:
</p>
<p>If <code>statistic == "d"</code>, 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{m=1}^{M} \sum_{t=1}^{T} \omega_t \left( I_{tm}^{(FU)} - I_{tm}^{(FL)}\right).</code>
</p>

<p>If <code>statistic == "D"</code>, 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{m=1}^{M} \sum_{t=1}^{T} \omega_t \left( I_{tm}^{(FU)} - I_{tm}^{(FL)} - I_{tm}^{(BU)} + I_{tm}^{(BL)}\right).</code>
</p>

<p>If <code>statistic == "s"</code>, 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{m=1}^{M} \sum_{t=1}^{T} \omega_t \left( I_{tm}^{(FU)} + I_{tm}^{(FL)}\right).</code>
</p>

<p>If <code>statistic == "S"</code>, 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{m=1}^{M} \sum_{t=1}^{T} \omega_t \left( I_{tm}^{(FU)} + I_{tm}^{(FL)} - I_{tm}^{(BU)} - I_{tm}^{(BL)}\right).</code>
</p>

<p>If <code>statistic == "U"</code>, 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{m=1}^{M} \sum_{t=1}^{T} \omega_t \left( I_{tm}^{(FU)} - I_{tm}^{(BU)}\right).</code>
</p>

<p>If <code>statistic == "L"</code>, 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{m=1}^{M} \sum_{t=1}^{T} \omega_t \left( I_{tm}^{(BL)} - I_{tm}^{(FL)}\right).</code>
</p>

<p>If <code>statistic == "W"</code>, 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{m=1}^{M} \sum_{t=1}^{T} \omega_t \left( I_{tm}^{(FU)} + I_{tm}^{(BL)}\right).</code>
</p>

<p>Where <code class="reqn">\omega_t</code> are weights given to the different records
according to their position in the series, <code class="reqn">I_{tm}</code> are the record
indicators (see <code>I.record</code>), and <code class="reqn">(FU)</code>, <code class="reqn">(FL)</code>, 
<code class="reqn">(BU)</code>, and <code class="reqn">(BL)</code> represent forward upper, forward lower,
backward upper and backward lower records, respectively. The statistics 
<code class="reqn">d</code>, <code class="reqn">D</code> and <code class="reqn">W</code> may be used for trend in location;
<code class="reqn">s</code> and <code class="reqn">S</code> may be used for trend in variation; and <code class="reqn">U</code> and
<code class="reqn">L</code> may be used for trend in the upper and lower tails of the 
distribution respectively.
</p>
<p>The statistics, say <code class="reqn">X</code>, are approximately normally distributed, with
</p>
<p style="text-align: center;"><code class="reqn">Z = \frac{X - \mu}{\sigma},</code>
</p>

<p>while the mean <code class="reqn">\mu</code> of the particular statistic considered is simple
to calculate, its variance <code class="reqn">\sigma^2</code> become a cumbersome expression
and some are given by Diersen and Trenkler (2001) and all of them can be
easily computed out of the expression of the covariances given by Cebrián, 
Castillo-Mateo and Asín (2022). 
</p>
<p>If <code>correct = TRUE</code>, then a continuity correction will be employed:
</p>
<p style="text-align: center;"><code class="reqn">Z = \frac{X \pm 0.5 - \mu}{\sigma},</code>
</p>

<p>with “<code class="reqn">-</code>” if the alternative is greater and “<code class="reqn">+</code>” if the 
alternative is less. Not recommended for the statistics with <code class="reqn">\mu=0</code>.
</p>
<p>When <code class="reqn">M&gt;1</code>, the expression of the variance under the null hypothesis
can be substituted by the sample variance in the <code class="reqn">M</code> series, 
<code class="reqn">\hat{\sigma}^2</code>. In this case, the statistics are asymptotically
<code class="reqn">t</code> distributed, which is a more robust alternative against serial 
correlation.
</p>
<p>If <code>permutation.test = TRUE</code>, the p-value is estimated by permutation
simulations. This is the only method of calculating p-values that does not
require that the columns of <code>X</code> be independent.
</p>
<p>If <code>simulate.p.value = TRUE</code>, the p-value is estimated by Monte Carlo
simulations. If the normal asymptotic <code>statistic</code> <code>"D"</code>, 
<code>"S"</code> or <code>"W"</code> is used when the length of the 
series <code class="reqn">T</code> is greater than 1000 or 1500, permutations or this approach
are preferable due to the computational cost of calculating the variance
of the statistic under the null hypothesis. The exception is <code>"D"</code> 
without weights, which has an alternative algorithm implemented to 
calculate the variance quickly.
</p>


<h3>Value</h3>

<p>A <code>"htest"</code> object with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>(If <code>distribution = "t"</code>) Degrees of freedom of
the <code class="reqn">t</code> statistic (equal to <code class="reqn">M-1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>The alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>(If <code>distribution = "normal"</code>) A vector with the
value of the statistic, <code class="reqn">\mu</code> and <code class="reqn">\sigma^2</code>. <code class="reqn">\sigma^2</code>
is <code>NA</code> if <code>statistic</code> is one of <code>"D"</code>, <code>"S"</code> or 
<code>"W"</code> (with the exception of <code>"D"</code> without weights); the
p-value is computed with permutations or Monte Carlo simulations; and 
<code class="reqn">T &gt; 500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the type of test performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name of the data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Castillo-Mateo J, Cebrián AC, Asín J (2023).
“Statistical Analysis of Extreme and Record-Breaking Daily Maximum Temperatures in Peninsular Spain during 1960–2021.”
<em>Atmospheric Research</em>, <strong>293</strong>, 106934.
<a href="https://doi.org/10.1016/j.atmosres.2023.106934">doi:10.1016/j.atmosres.2023.106934</a>.
</p>
<p>Cebrián AC, Castillo-Mateo J, Asín J (2022).
“Record Tests to Detect Non Stationarity in the Tails with an Application to Climate Change.”
<em>Stochastic Environmental Research and Risk Assessment</em>, <strong>36</strong>(2), 313-330. 
<a href="https://doi.org/10.1007/s00477-021-02122-w">doi:10.1007/s00477-021-02122-w</a>.
</p>
<p>Diersen J, Trenkler G (1996). “Records Tests for Trend in Location.”
<em>Statistics</em>, <strong>28</strong>(1), 1-12.
<a href="https://doi.org/10.1080/02331889708802543">doi:10.1080/02331889708802543</a>.
</p>
<p>Diersen J, Trenkler G (2001). 
“Weighted Records Tests for Splitted Series of Observations.”
In J Kunert, G Trenkler (eds.), 
<em>Mathematical Statistics with Applications in Biometry: Festschrift in Honour of Prof. Dr. Siegfried Schach</em>, 
pp. 163–178. Lohmar: Josef Eul Verlag.
</p>
<p>Foster FG, Stuart A (1954). 
“Distribution-Free Tests in Time-Series Based on the Breaking of Records.”
<em>Journal of the Royal Statistical Society B</em>, 
<strong>16</strong>(1), 1-22.
<a href="https://doi.org/10.1111/j.2517-6161.1954.tb00143.x">doi:10.1111/j.2517-6161.1954.tb00143.x</a>.
</p>


<h3>See Also</h3>

<p><code>foster.plot</code>, <code>N.plot</code>, 
<code>N.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># D-statistic
foster.test(ZaragozaSeries)
# D-statistic with linear weights
foster.test(ZaragozaSeries, weights = function(t) t - 1)
# S-statistic with linear weights
foster.test(ZaragozaSeries, statistic = "S", weights = function(t) t - 1)
# D-statistic with weights and t approach
foster.test(ZaragozaSeries, distribution = "t", weights = function(t) t - 1)
# U-statistic with weights (upper tail)
foster.test(ZaragozaSeries, statistic = "U", weights = function(t) t - 1)
# L-statistic with weights (lower tail)
foster.test(ZaragozaSeries, statistic = "L", weights = function(t) t - 1)

</code></pre>


</div>