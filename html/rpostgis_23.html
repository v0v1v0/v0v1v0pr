<div class="container">

<table style="width: 100%;"><tr>
<td>pgGetGeom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Load a PostGIS geometry from a PostgreSQL table/view/query into R.</h2>

<h3>Description</h3>

<p>Retrieve geometries from a PostGIS table/view/query, and convert
it to an R <code>sf</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pgGetGeom(
  conn,
  name,
  geom = "geom",
  gid = NULL,
  other.cols = TRUE,
  clauses = NULL,
  boundary = NULL,
  query = NULL,
  returnclass = "sf"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conn</code></td>
<td>
<p>A connection object to a PostgreSQL database</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>A character string specifying a PostgreSQL schema and
table/view name holding the geometry (e.g., <code>name =
c("schema","table")</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geom</code></td>
<td>
<p>The name of the geometry/(geography) column. (Default = <code>"geom"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gid</code></td>
<td>
<p>Name of the column in <code>name</code> holding the IDs. Should be
unique for each record to return. <code>gid=NULL</code> (default) automatically
creates a new unique ID for each row in the <code>sf</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other.cols</code></td>
<td>
<p>Names of specific columns in the table to
retrieve, in a character vector (e.g. <code>other.cols.=c("col1","col2")</code>.)
The default (<code>other.cols = TRUE</code>) is to attach
all columns. Setting <code>other.cols=FALSE</code> will return a Spatial-only
object without attributes (no data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clauses</code></td>
<td>
<p>character, additional SQL to append to modify select
query from table. Must begin with an SQL clause (e.g., "WHERE ...",
"ORDER BY ...", "LIMIT ..."); see below for examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p><code>sf</code>, <code>SpatVector</code> or <code>sp</code> object; or numeric.
If a spatial object is provided, its bounding box will be used to select
geometries to import. Alternatively, a numeric vector (<code>c([top],
[bottom], [right], [left])</code>) indicating the projection-specific limits with
which to subset the spatial data. If not value is provided, the default
<code>boundary = NULL</code> will not apply any boundary subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>query</code></td>
<td>
<p>character, a full SQL query including a geometry column.
For use with query mode only (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnclass</code></td>
<td>
<p>'sf' by default; 'terra' for <code>SpatVector</code>;
or 'sp' for <code>sp</code> objects.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The features of the table to retrieve must have the same geometry type.
The query mode version of <code>pgGetGeom</code> allows the user to enter a
complete SQL query (<code>query</code>) that returns a Geometry column, and save
the query as a new view (<code>name</code>) if desired. If (<code>name</code>) is not
specified, a temporary view with name ".rpostgis_TEMPview" is used only
within the function execution. In this mode, the other arguments can be used
normally to modify the Spatial* object returned from the query.
</p>


<h3>Value</h3>

<p>sf, SpatVector or sp object
</p>


<h3>Author(s)</h3>

<p>David Bucklin <a href="mailto:david.bucklin@gmail.com">david.bucklin@gmail.com</a>
</p>
<p>Mathieu Basille <a href="mailto:mathieu@basille.org">mathieu@basille.org</a>
</p>
<p>Adrián Cidre González <a href="mailto:adrian.cidre@gmail.com">adrian.cidre@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Retrieve a sf with all data from table
## 'schema.tablename', with geometry in the column 'geom'
pgGetGeom(conn, c("schema", "tablename"))
## Return a sf with columns c1 &amp; c2 as data
pgGetGeom(conn, c("schema", "tablename"), other.cols = c("c1","c2"))
## Return a spatial-only (no data frame),
## retaining id from table as rownames
pgGetGeom(conn, c("schema", "tablename"), gid = "table_id",
  other.cols = FALSE)
## Return a spatial-only (no data frame),
## retaining id from table as rownames and with a subset of the data
pgGetGeom(conn, c("schema", "roads"), geom = "roadgeom", gid = "road_ID",
    other.cols = FALSE, clauses  = "WHERE road_type = 'highway'")
## Query mode
pgGetGeom(conn, query = "SELECT r.gid as id, ST_Buffer(r.geom, 100) as geom
                           FROM
                             schema.roads r,
                             schema.adm_boundaries b
                           WHERE
                             ST_Intersects(r.geom, b.geom);")

## End(Not run)
</code></pre>


</div>