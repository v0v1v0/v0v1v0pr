<div class="container">

<table style="width: 100%;"><tr>
<td>prepivot.ks.permtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation Test for the two-sample goodness-of-fit problem under covariate-adaptive randomization</h2>

<h3>Description</h3>

<p>A permutation test of the two-sample goodness-of-fit hypothesis when the randomization scheme is covariate-adaptive. The permutation test considered here is based on prepivoting the Kolmogorov-Smirnov test statistic following Beran (1987,1988), and adapted by Olivares (2020). Current version includes the following randomization schemes: simple randomization, Efron's biased-coin design, Wei's biased-coin design, and stratified block randomization. This implementation uses a Bayesian bootstrap approximation for prepivoting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prepivot.ks.permtest(Y1, Y0, alpha, B, n.perm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y1</code></td>
<td>
<p>Numeric. A vector containing the response variable of the treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y0</code></td>
<td>
<p>Numeric. A vector containing the response variable of the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric. Nominal level for the test. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Numeric. Number of weighted bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. The default is n.perm=999.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "prepivot.ks.permtest" containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n_populations</code></td>
<td>
<p>Number of grups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Sample Size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.obs</code></td>
<td>
<p>Observed test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>Critical Value. This value is used in the general construction of a randomization test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rejectrule</code></td>
<td>
<p>Rule. Binary decision for randomization test, where 1 means "to reject"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.perm</code></td>
<td>
<p>Vector. Test statistic recalculated for all permutations used in the stochastic approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Bayesian bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_sizes</code></td>
<td>
<p>Groups size.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>


<h3>References</h3>

<p>Beran, R. (1987). Prepivoting to reduce level error of confidence sets. Biometrika, 74(3): 457–468.
Beran, R. (1988). Prepivoting test statistics: a bootstrap view of asymptotic refinements. Journal of the American Statistical Association, 83(403):687–697.
Olivares, M. (2020). Asymptotically Robust Permutation Test under Covariate-Adaptive Randomization. Working Paper.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
Y0 &lt;- rnorm(100, 1, 1)
Y1 &lt;- rbeta(100,2,2)
Tx = sample(100) &lt;= 0.5*(100)
# Observed Outcome 
Y = ifelse( Tx, Y1, Y0 )
dta &lt;- data.frame(Y = Y, A = as.numeric(Tx))
pKS.GoF&lt;-prepivot.ks.permtest(dta$Y[dta$A==1],dta$Y[dta$A==0],alpha=0.05,B=1000,n.perm = 999)
summary(pKS.GoF)

## End(Not run)
</code></pre>


</div>