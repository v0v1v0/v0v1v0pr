<div class="container">

<table style="width: 100%;"><tr>
<td>RCreliability.in</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RCreliability.in</h2>

<h3>Description</h3>

<p>This function corrects the bias in estimated regression coefficients due to classical additive measurement error (i.e., within-person variation) in logistic regressions under the partially or fully replicated design. The output includes naive and corrected estimators for the regression coefficients; for the variance estimates of the corrected estimators, the extra variation due to estimating the parameters in the measurement error model is ignored or taken into account.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RCreliability.in(r, z, W=NULL, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>number of replicates in the reliability study, vector of length n, where n is the number of subjects in the reliability study. Note: For each subject, the covariates  with error in the reliability study should have the same number of replicates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>covariates measured with error in the reliability study, a list with p elements, each element in a form of a n*max(r) matrix; subjects with less observations than max(r) should also have max(r) columns with the unobserved elements filled with NA.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>covariates without measurement errors, a n*q matrix, where q stands for the number of covariates without measurement errors. Default is NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>response variable in the main study, vector of length n. Values should be 0 or 1 in this logistic regression setting.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with 3 table of regression statistics.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Naive estimates</code></td>
<td>

<p>Estimates of regression coefficients ignoring the measurement errors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Corrected estimates</code></td>
<td>

<p>Regression calibration estimates without taking into account the extra variation due to estimating the parameters in the measurement error model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Corrected estimates, taking into account the extra variation due to estimating the parameters in the measurement error model</code></td>
<td>

<p>Regression calibration estimates taking into account the extra variation due to estimating the parameters in the measurement error model.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yu Lu, Molin Wang
</p>


<h3>References</h3>

<p>Carroll RJ, Ruppert D, Stefanski L, Crainiceanu CM. Measurement Error in Nonlinear Models: A Modern Perspective. 2nd ed. New York: Chapman &amp; Hall/CRC; 2006
</p>


<h3>See Also</h3>

<p>RCreliability.ex function
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library(RCreliability)
library(mgcv)

# Regression on only one covariates measured with error
x&lt;-rnorm(3000,0,1)
#ICC=0.7 generate z
r&lt;-c(rep(1,1500),rep(3,700),rep(4,800))
z&lt;-list(rbind(cbind(x[1:1500]+rnorm(1500,0,sqrt(0.4)),NA,NA,NA),
              cbind(x[1501:2200]+rnorm(700,0,sqrt(0.4)),
              x[1501:2200]+rnorm(700,0,sqrt(0.4)),
              x[1501:2200]+rnorm(700,0,sqrt(0.4)),NA),
              cbind(x[2201:3000]+rnorm(800,0,sqrt(0.4)),
              x[2201:3000]+rnorm(800,0,sqrt(0.4)),
              x[2201:3000]+rnorm(800,0,sqrt(0.4)),
              x[2201:3000]+rnorm(800,0,sqrt(0.4)))))
#prevalence=0.105
p&lt;-exp(-2.2+log(1.5)*x)/(1+exp(-2.2+log(1.5)*x))
Y&lt;-sapply(p,function(x) rbinom(1,1,x))
fit1 &lt;- RCreliability.in(r,z,W=NULL,Y)
fit1

# Regression on one covariates measured with error and one confounder
x&lt;-rnorm(3000,0,1)
#ICC=0.7 generate z
r&lt;-c(rep(1,1500),rep(3,700),rep(4,800))
z&lt;-list(rbind(cbind(x[1:1500]+rnorm(1500,0,sqrt(0.4)),NA,NA,NA),
              cbind(x[1501:2200]+rnorm(700,0,sqrt(0.4)),
              x[1501:2200]+rnorm(700,0,sqrt(0.4)),
              x[1501:2200]+rnorm(700,0,sqrt(0.4)),NA),
              cbind(x[2201:3000]+rnorm(800,0,sqrt(0.4)),
              x[2201:3000]+rnorm(800,0,sqrt(0.4)),
              x[2201:3000]+rnorm(800,0,sqrt(0.4)),
              x[2201:3000]+rnorm(800,0,sqrt(0.4)))))
W&lt;-sapply(x, function(t){if(t&gt;median(x)) {return(rbinom(1,1,0.5))}
  if(t&lt;=median(x)){return(rbinom(1,1,0.3))}})
#prevalence about 0.104
p&lt;-exp(-2.4+log(1.5)*x+log(1.5)*W)/(1+exp(-2.4+log(1.5)*x+log(1.5)*W))
Y&lt;-sapply(p,function(x) rbinom(1,1,x))
fit2&lt;-RCreliability.in(r,z,W=W,Y)
fit2

# Regression on two covariates measured with error and no confounder
x&lt;-rmvn(3000,c(0,0),matrix(c(1,0.3,0.3,1),nrow=2))
#ICC=0.7 generate z
r&lt;-c(rep(1,1500),rep(2,500),rep(3,400),rep(4,600))
z&lt;-list(rbind(cbind(x[1:1500,1]+rnorm(1500,0,sqrt(0.4)),NA,NA,NA),
              cbind(x[1501:1500,1]+rnorm(500,0,sqrt(0.4)),
              x[1501:1500,1]+rnorm(500,0,sqrt(0.4)),NA,NA),
              cbind(x[2001:2400,1]+rnorm(400,0,sqrt(0.4)),
              x[2001:2400,1]+rnorm(400,0,sqrt(0.4)),
              x[2001:2400,1]+rnorm(400,0,sqrt(0.4)),NA),
              cbind(x[2401:3000,1]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,1]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,1]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,1]+rnorm(600,0,sqrt(0.4)))),
        rbind(cbind(x[1:1500,2]+rnorm(1500,0,sqrt(0.4)),NA,NA,NA),
              cbind(x[1501:1500,2]+rnorm(500,0,sqrt(0.4)),
              x[1501:1500,2]+rnorm(500,0,sqrt(0.4)),NA,NA),
              cbind(x[2001:2400,2]+rnorm(400,0,sqrt(0.4)),
              x[2001:2400,2]+rnorm(400,0,sqrt(0.4)),
              x[2001:2400,2]+rnorm(400,0,sqrt(0.4)),NA),
              cbind(x[2401:3000,2]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,2]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,2]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,2]+rnorm(600,0,sqrt(0.4)))))
#prevalence about 0.105
p&lt;-exp(-2.3+log(1.5)*rowSums(x))/(1+exp(-2.3+log(1.5)*rowSums(x)))
Y&lt;-sapply(p,function(x) rbinom(1,1,x))
fit3&lt;-RCreliability.in(r,z, W=NULL,Y)
fit3


# Regression on two covariates measured with error and two confounders
x&lt;-rmvn(3000,c(0,0,0),matrix(c(1,0.3,0.2,0.3,1,0.5,0.2,0.5,1),nrow=3))
w2&lt;-sapply(x[,1], function(t){if(t&gt;median(x[,1])) {return(rbinom(1,1,0.5))}
  if(t&lt;=median(x[,1])){return(rbinom(1,1,0.3))}})
#ICC=0.7 generate z
r&lt;-c(rep(1,1500),rep(2,500),rep(3,400),rep(4,600))
W&lt;-cbind(x[,3],w2)
z&lt;-list(rbind(cbind(x[1:1500,1]+rnorm(1500,0,sqrt(0.4)),NA,NA,NA),
              cbind(x[1501:1500,1]+rnorm(500,0,sqrt(0.4)),
              x[1501:1500,1]+rnorm(500,0,sqrt(0.4)),NA,NA),
              cbind(x[2001:2400,1]+rnorm(400,0,sqrt(0.4)),
              x[2001:2400,1]+rnorm(400,0,sqrt(0.4)),
              x[2001:2400,1]+rnorm(400,0,sqrt(0.4)),NA),
              cbind(x[2401:3000,1]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,1]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,1]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,1]+rnorm(600,0,sqrt(0.4)))),
        rbind(cbind(x[1:1500,2]+rnorm(1500,0,sqrt(0.4)),NA,NA,NA),
              cbind(x[1501:1500,2]+rnorm(500,0,sqrt(0.4)),
              x[1501:1500,2]+rnorm(500,0,sqrt(0.4)),NA,NA),
              cbind(x[2001:2400,2]+rnorm(400,0,sqrt(0.4)),
              x[2001:2400,2]+rnorm(400,0,sqrt(0.4)),
              x[2001:2400,2]+rnorm(400,0,sqrt(0.4)),NA),
              cbind(x[2401:3000,2]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,2]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,2]+rnorm(600,0,sqrt(0.4)),
              x[2401:3000,2]+rnorm(600,0,sqrt(0.4)))))
#prevalence about 0.104
p&lt;-exp(-2.65+log(1.5)*rowSums(x[,1:3])+log(1.5)*w2)/
(1+exp(-2.65+log(1.5)*rowSums(x[,1:3])+log(1.5)*w2))
Y&lt;-sapply(p,function(x) rbinom(1,1,x))
fit4&lt;-RCreliability.in(r,z,W=W,Y)
fit4


</code></pre>


</div>