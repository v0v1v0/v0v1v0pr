<div class="container">

<table style="width: 100%;"><tr>
<td>endo.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Endogeneity test in high dimensions</h2>

<h3>Description</h3>

<p>Conduct the endogeneity test with high dimensional and possibly invalid instrumental variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">endo.test(
  Y,
  D,
  Z,
  X,
  intercept = TRUE,
  invalid = FALSE,
  method = c("Fast.DeLasso", "DeLasso", "OLS"),
  voting = c("MP", "MaxClique"),
  alpha = 0.05,
  tuning.1st = NULL,
  tuning.2nd = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The outcome observation, a vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The treatment observation, a vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>The instrument observation of dimension <code class="reqn">n \times p_z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The covariates observation of dimension <code class="reqn">n \times p_x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Whether the intercept is included. (default = <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invalid</code></td>
<td>
<p>If <code>TRUE</code>, the method is robust to the presence of possibly invalid IVs; If <code>FALSE</code>, the method assumes all IVs to be valid. (default = <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used to estimate the reduced form parameters. <code>"OLS"</code> stands for ordinary least squares, <code>"DeLasso"</code> stands for the debiased Lasso estimator, and <code>"Fast.DeLasso"</code> stands for the debiased Lasso estimator with fast algorithm. (default = <code>"Fast.DeLasso"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>voting</code></td>
<td>
<p>The voting option used to estimate valid IVs. <code>'MP'</code> stnads for majority and plurality voting, <code>'MaxClique'</code> stands for maximum clique in the IV voting matrix. (default = <code>'MP'</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level for the confidence interval. (default = <code>0.05</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.1st</code></td>
<td>
<p>The tuning parameter used in the 1st stage to select relevant instruments. If <code>NULL</code>, it will be generated data-dependently, see Details. (default=<code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.2nd</code></td>
<td>
<p>The tuning parameter used in the 2nd stage to select valid instruments. If <code>NULL</code>, it will be generated data-dependently, see Details. (default=<code>NULL</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>voting = MaxClique</code> and there are multiple maximum cliques, the null hypothesis is rejected if one of maximum clique rejects the null.
As for tuning parameter in the 1st stage and 2nd stage, if do not specify, for method "OLS" we adopt <code class="reqn">\sqrt{\log n}</code> for both tuning parameters, and for other methods
we adopt <code class="reqn">\max{(\sqrt{2.01 \log p_z}, \sqrt{\log n})}</code> for both tuning parameters.
</p>


<h3>Value</h3>

<p><code>endo.test</code> returns an object of class "endotest", which is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>The test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma12</code></td>
<td>
<p>The estimated covaraince of the regression errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SHat</code></td>
<td>
<p>The set of selected relevant IVs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VHat</code></td>
<td>
<p>The set of selected vaild IVs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The p-value of the endogeneity test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>The indicator that <code class="reqn">H_0:\Sigma_{12}=0</code> is rejected.</p>
</td>
</tr>
</table>
<h3>References</h3>


<p>Guo, Z., Kang, H., Tony Cai, T. and Small, D.S. (2018), Testing endogeneity with high dimensional covariates, <em>Journal of Econometrics</em>, Elsevier, vol. 207(1), pages 175-187. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">
n = 500; L = 11; s = 3; k = 10; px = 10;
beta = 1; gamma = c(rep(1,k),rep(0,L-k))
phi&lt;-(1/px)*seq(1,px)+0.5; psi&lt;-(1/px)*seq(1,px)+1
epsilonSigma = matrix(c(1,0.8,0.8,1),2,2)
Z = matrix(rnorm(n*L),n,L)
X = matrix(rnorm(n*px),n,px)
epsilon = MASS::mvrnorm(n,rep(0,2),epsilonSigma)
D =  0.5 + Z %*% gamma + X %*% psi + epsilon[,1]
Y = -0.5 + Z %*% c(rep(1,s),rep(0,L-s)) + D * beta + X %*% phi + epsilon[,2]
endo.test.model &lt;- endo.test(Y,D,Z,X,invalid = TRUE)
summary(endo.test.model)


</code></pre>


</div>