<div class="container">

<table style="width: 100%;"><tr>
<td>plotShift</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical representation of search.shift results</h2>

<h3>Description</h3>

<p><code>plotShift</code> generates customized functions to produce plots
out of <code>search.shift</code> results.
<code>addShift</code> adds circles to highlight shifting clades onto the currently
plotted tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotShift(RR,SS,state=NULL)

addShift(SS,symbols.args=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>
<p>the object produced by <code>RRphylo</code> used to perform
<code>search.shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SS</code></td>
<td>
<p>an object produced by <code>search.shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state</code></td>
<td>
<p>if <code>search.shift</code> was performed under <code>status.type =
"sparse"</code>, this is the same <code>state</code> vector provided to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbols.args</code></td>
<td>
<p>as described for <code>$plotClades</code> below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using <code>...$plotClades()</code> or plotting the tree and applying
<code>addShift()</code> returns the same plot. The latter function might be useful
in combination with <code>plotRR</code> to add the shifts information to the
branch-wise plot of evolutionary rate values.
</p>


<h3>Value</h3>

<p>The function returns a function to generate a customizable plot of
<code>search.shift</code> results.
</p>
<p>If <code>search.shift</code> was performed under <code>status.type =
 "clade"</code>, <code>plotShift</code> returns a <strong><code>$plotClades</code></strong> function
which highlights the shifting clades onto the phylogenetic tree. The usage
is: <code>...$plotClades(tree.args=NULL,symbols.args=NULL)</code>, where
<code>tree.args</code> is a list of further arguments passed to the function
<code>plot.phylo</code>, and <code>symbols.args</code> is a list of further arguments
passed to the function <code>symbols</code> (n.b. the shape of the symbol is not
customizable). The function automatically plots red circles for negative
shifts and blue circles for positive shifts, in each cases with the radium
proportional to the absolute value of rate difference. The user can choose
different color options for positive/negative shifts by setting
<code>symbols.args=list(fg=c(pos="color for positive shift",neg="color for
 negative shift"))</code>, or provide a vector of as many colors as the number of
shifting clades. The same applies to the argument "bg".
</p>
<p>If <code>search.shift</code> was performed under <code>status.type =
 "sparse"</code>, <code>plotShift</code> returns a <strong><code>$plotStates</code></strong> function
which plots the states onto the phylogenetic trees. The usage is:
<code>...$plotStates(tree.args=NULL,points.args=NULL,legend.args=list())</code>,
where <code>tree.args</code> is a list of further arguments passed to the function
<code>plot.phylo</code>, <code>points.args</code> is a list of further arguments passed
to the function <code>points</code>, and <code>legend.args</code> is a list of
additional arguments passed to the function <code>legend</code> (if <code>= NULL</code>
the legend is not plotted). If as many colors/pch values as the number of
different states are provided in <code>points.args</code>, each of them is
assigned to each states taken in the same order they are returned by
<code>search.shift</code>.
</p>


<h3>Author(s)</h3>

<p>Silvia Castiglione
</p>


<h3>References</h3>

<p>Castiglione, S., Tesone, G., Piccolo, M., Melchionna, M.,
Mondanaro, A., Serio, C., Di Febbraro, M., &amp; Raia, P.(2018). A new method
for testing evolutionary rate variation and shifts in phenotypic evolution.
<em>Methods in Ecology and Evolution</em>, 9:
974-983.doi:10.1111/2041-210X.12954
</p>


<h3>See Also</h3>

<p><a href="../doc/search.shift.html"><code>search.shift</code> vignette</a>
</p>
<p><a href="../doc/Plotting-tools.html"><code>plotShift</code> vignette</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("DataOrnithodirans")
DataOrnithodirans$treedino-&gt;treedino
DataOrnithodirans$massdino-&gt;massdino
DataOrnithodirans$statedino-&gt;statedino
cc&lt;- 2/parallel::detectCores()

RRphylo(tree=treedino,y=massdino,clus=cc)-&gt;dinoRates

search.shift(RR=dinoRates,status.type="clade")-&gt;SSauto
plotShift(RR=dinoRates,SS=SSauto)-&gt;plotSS
plotSS$plotClades()

plot(dinoRates$tree)
addShift(SS=SSauto)

search.shift(RR=dinoRates,status.type="clade",node=c(696,746))-&gt;SSnode
plotShift(RR=dinoRates,SS=SSnode)-&gt;plotSS
plotSS$plotClades(tree.args=list(no.margin=TRUE),
                  symbols.args=list(fg=NA,bg=c(pos="cyan",neg="magenta")))


search.shift(RR=dinoRates,status.type= "sparse",state=statedino)-&gt;SSstate
plotShift(RR=dinoRates,SS=SSstate,state=statedino)-&gt;plotSS
plotSS$plotStates(tree.args=list(no.margin=TRUE),
                  points.args=list(bg=c("gold","forestgreen","royalblue","white"),
                                   col=c("black","black","black","orangered"),
                                   pch=c(21,22,24,11)),legend.args=list())
    
## End(Not run)
</code></pre>


</div>