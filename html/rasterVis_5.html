<div class="container">

<table style="width: 100%;"><tr>
<td>bwplot-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Box and whisker plots of Raster objects.</h2>

<h3>Description</h3>

<p>Methods for <code>bwplot</code> and <code>RasterStackBrick</code> objects using
a combination of <code>panel.violin</code> and
<code>panel.bwplot</code> to compose the graphic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'RasterStackBrick,missing'
bwplot(x, data=NULL, layers, FUN,
            maxpixels = 1e+05,
            xlab='', ylab='', main='',
            violin = TRUE, draw.points = FALSE, do.out = FALSE,
            par.settings = bwTheme(),
            violin.ratio = 1, box.ratio = 0.5,
            scales=list(x=list(rot=45, cex=0.8)),
            ...)
## S4 method for signature 'formula,Raster'
bwplot(x, data, dirXY, 
            maxpixels = 1e+05,
            xscale.components=xscale.raster,
            yscale.components=yscale.raster,
            horizontal=FALSE,
            violin = TRUE, draw.points = FALSE, do.out = FALSE,
            violin.ratio = 1, box.ratio = 0.5,
            par.settings = bwTheme(),
            ...)
## S4 method for signature 'SpatRaster,missing'
bwplot(x, data=NULL, layers, FUN,
            maxpixels = 1e+05,
            xlab='', ylab='', main='',
            violin = TRUE, draw.points = FALSE, do.out = FALSE,
            par.settings = bwTheme(),
            violin.ratio = 1, box.ratio = 0.5,
            scales=list(x=list(rot=45, cex=0.8)),
            ...)
## S4 method for signature 'formula,SpatRaster'
bwplot(x, data, dirXY, 
            maxpixels = 1e+05,
            xscale.components=xscale.raster,
            yscale.components=yscale.raster,
            horizontal=FALSE,
            violin = TRUE, draw.points = FALSE, do.out = FALSE,
            violin.ratio = 1, box.ratio = 0.5,
            par.settings = bwTheme(),
            ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>RasterStackBrick</code> object, a <code>SpatRaster</code> object, or a <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>NULL</code>, a <code>Raster</code> object, or a <code>SpatRaster</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layers</code></td>
<td>
<p>A numeric or character which should indicate the layers
to be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code>xyLayer</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>A function to applied to the <code>z</code> slot of a
<code>RasterStackBrick</code> object, or the time index of a
<code>SpatRaster</code> object. The result of this function
is used as the grouping variable of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpixels</code></td>
<td>
<p>A numeric, for <code>sampleRandom</code> or <code>spatSample</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xscale.components, yscale.components</code></td>
<td>
<p>Graphical
parameters of <code>lattice</code>. See <code>xyplot</code> for
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p>Defaults to <code>FALSE</code>, meaning that the right hand
of the formula is a factor or shingle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, main</code></td>
<td>
<p>Labels for axis and title</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>violin</code></td>
<td>
<p>Logical, if <code>TRUE</code> the panel is built with
<code>panel.violin</code> and <code>panel.bwplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw.points</code></td>
<td>
<p>Logical, if <code>TRUE</code> raw points are displayed in
the background with <code>panel.stripplot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.out</code></td>
<td>
<p>Logical, if <code>TRUE</code> outliers are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.ratio</code></td>
<td>
<p>ratio of box thickness to inter box space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>violin.ratio</code></td>
<td>
<p>ratio of the thickness of each violin and inter violin space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.settings, scales</code></td>
<td>
<p>See <code>xyplot</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for <code>bwplot</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p><code>bwplot</code>,
<code>panel.violin</code>,
<code>subset</code>,
<code>bwTheme</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(raster)
library(terra)

f &lt;- system.file("external/test.grd", package="raster")
r &lt;- raster(f)
s &lt;- stack(r, r-500, r+500)
bwplot(s)

bwplot(s, violin = FALSE, box.ratio = 1)

## Modify colours
myTheme &lt;- bwTheme(
    box.rectangle = list(col = 'green', fill = 'lightgreen'),
    plot.polygon = list(col = 'blue'),
    plot.symbol = list(col = 'gray', cex = 0.8, alpha = 0.1)
)
## Display raw points
bwplot(s, draw.points = TRUE,
       par.settings = myTheme)

## Not run: 

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

bwplot(SISmm)

##FUN applies to z if not NULL
library(zoo)

bwplot(SISmm, FUN=as.yearqtr)

## End(Not run)
## Not run: 
##http://neo.sci.gsfc.nasa.gov/Search.html?group=64
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "875430rgb-167772161.0.FLOAT.TIFF"),
   "875430rgb-167772161.0.FLOAT.TIFF", method='wget')

pop &lt;- raster("875430rgb-167772161.0.FLOAT.TIFF")
pop[pop==99999] &lt;- NA
levelplot(pop, zscaleLog=10, par.settings=BTCTheme,
          panel=panel.levelplot.raster, interpolate=TRUE)

##http://neo.sci.gsfc.nasa.gov/Search.html?group=20
download.file(paste0(dataURL, "241243rgb-167772161.0.TIFF"),
   "241243rgb-167772161.0.TIFF", method='wget')
landClass &lt;- raster("241243rgb-167772161.0.TIFF")
landClass[landClass==254] &lt;- NA


s &lt;- stack(pop, landClass)
names(s) &lt;- c('pop', 'landClass')

bwplot(asinh(pop) ~ landClass|cut(y, 3), data = s,
       layout = c(3, 1))

bwplot(asinh(pop) ~ cut(y, 5)|landClass, data = s,
       scales = list(x=list(rot=45)), layout = c(4, 5),
       strip = strip.custom(strip.levels = TRUE))

## Modify colours
bwplot(asinh(pop) ~ cut(y, 5)|landClass, data = s,
       scales = list(x=list(rot=45)), layout = c(4, 5),
       strip = strip.custom(strip.levels = TRUE),
       par.settings = bwTheme(plot.polygon = list(col = 'lightgray'),
                              box.rectangle = list(fill = 'lightgreen')))

## End(Not run)
</code></pre>


</div>