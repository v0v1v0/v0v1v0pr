<div class="container">

<table style="width: 100%;"><tr>
<td>rg.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust graph-based two sample test</h2>

<h3>Description</h3>

<p>Performs robust graph-based two sample test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rg.test(data.X, data.Y, dis = NULL, E = NULL, n1, n2, k = 5, weigh.fun, perm.num = 0, 
test.type = list("ori", "gen", "wei", "max"), progress_bar = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.X</code></td>
<td>
<p>a numeric matrix for observations in sample 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.Y</code></td>
<td>
<p>a numeric matrix for observations in sample 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>a distance matrix of the pooled dataset of sample 1 and sample 2. The indices of observations in sample 1 are from 1 to n1 and indices of observations in sample 2 are from 1+n1 to n1+n2 in the pooled dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>an edge matrix representing a similarity graph. Each row represents an edge and records the indices of two ends of an edge in two columns. The indices of observations in sample 1 are from 1 to n1 and indices of observations in sample 2 are from 1+n1 to n1+n2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>number of observations in sample 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>number of observations in sample 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>parameter in K-MST, with default 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weigh.fun</code></td>
<td>
<p>weighted function which returns weights of each edge and is a function of node degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.num</code></td>
<td>
<p>number of permutations used to calculate the p-value (default=1000). Use 0 for getting only the approximate p-value based on asymptotic theory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.type</code></td>
<td>
<p>type of graph-based test. This must be a list containing elements chosen from "ori", "gen", "wei", and "max", with default 'list("ori", "gen", "wei", "max")'. "ori" refers to robust orignial edge-count test, "gen" refers to robust generalized edge-count test, "wei" refers to robust weighted edge-count test and "max" refers to robust max-type edge-count tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress_bar</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether a progress bar of the permutation should be printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input should be one of the following:
</p>

<ol>
<li>
<p> datasets of the two samples;
</p>
</li>
<li>
<p> the distance matrix of the pooled dataset;
</p>
</li>
<li>
<p> the edge matrix generated from a similarity graph.
</p>
</li>
</ol>
<p>Typical usages are:
</p>
<pre>rg.test(data.X, data.Y, n1, n2, weigh.fun, ...)</pre>
<pre>rg.test(dis, n1, n2, weigh.fun, ...)</pre>
<pre>rg.test(E, n1, n2, weigh.fun, ...)</pre>
<p>If the data matrices or the distance matrix are used, the similarity graph is generated using K-MST.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>asy.ori.statistic</code></td>
<td>
<p>the asymptotic test statistic using robust original graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.ori.pval</code></td>
<td>
<p>the asymptotic p-value using robust original graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.gen.statistic</code></td>
<td>
<p>the asymptotic test statistic using robust generalized graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.gen.pval</code></td>
<td>
<p>the asymptotic p-value using robust generalized graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.wei.statistic</code></td>
<td>
<p>the asymptotic test statistic using robust weighted graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.wei.pval</code></td>
<td>
<p>the asymptotic p-value using robust weighted graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.max.statistic</code></td>
<td>
<p>the asymptotic test statistic using robust max-type graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.max.pval</code></td>
<td>
<p>the asymptotic p-value using robust max-type graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.ori.pval</code></td>
<td>
<p>the p-value based on permutation using robust original graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.gen.pval</code></td>
<td>
<p>the p-value based on permutation using robust generalized graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.wei.pval</code></td>
<td>
<p>the p-value based on permutation using robust weighted graph-based test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.max.pval</code></td>
<td>
<p>the p-value based on permutation using robust max-type graph-based test.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Simulated from Student's t-distribution. 
## Observations for the two samples are from different distributions.
data(example0)
data = as.matrix(example0$data)     # pooled dataset
label = example0$label              # label of observations
s1 = data[label == 'sample 1', ]    # sample 1
s2 = data[label == 'sample 2', ]    # sample 2
num1 = nrow(s1)                     # number of observations in sample 1
num2 = nrow(s2)                     # number of observations in sample 2

## Graph-based two sample test using data as input
rg.test(data.X = s1, data.Y = s2, n1 = num1, n2 = num2, k = 5, weigh.fun = weiMax, perm.num = 0)

## Graph-based two sample test using distance matrix as input
dist = example0$distance
rg.test(dis = dist, n1 = num1, n2 = num2, k = 5, weigh.fun = weiMax, perm.num = 0)

## Graph-based two sample test using edge matrix of the similarity graph as input
E = example0$edge
rg.test(E = E, n1 = num1, n2 = num2, weigh.fun = weiMax, perm.num = 0)

</code></pre>


</div>