<div class="container">

<table style="width: 100%;"><tr>
<td>perturb_trans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perturbation analysis of transition types within a matrix population model</h2>

<h3>Description</h3>

<p>Calculates the summed sensitivities or elasticities for various
transition types within a matrix population model (MPM), including stasis,
retrogression, progression, fecundity, and clonality.
</p>
<p>Sensitivities or elasticities are calculated by perturbing elements of the
MPM and measuring the response of the per-capita population growth rate at
equilibrium (<code class="reqn">\lambda</code>), or, with a user-supplied function, any other
demographic statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perturb_trans(
  matU,
  matF,
  matC = NULL,
  posU = matU &gt; 0,
  posF = matF &gt; 0,
  posC = matC &gt; 0,
  exclude_row = NULL,
  exclude_col = NULL,
  pert = 1e-06,
  type = "sensitivity",
  demog_stat = "lambda",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matU</code></td>
<td>
<p>The survival component submatrix of a MPM (i.e., a square
projection matrix reflecting survival-related transitions; e.g.,
progression, stasis, and retrogression).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matF</code></td>
<td>
<p>The sexual component submatrix of a MPM (i.e., a square
projection matrix reflecting transitions due to sexual reproduction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matC</code></td>
<td>
<p>The clonal component submatrix of a MPM (i.e., a square
projection matrix reflecting transitions due to clonal reproduction).
Defaults to <code>NULL</code>, indicating no clonal reproduction possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posU</code></td>
<td>
<p>A logical matrix of the same dimension as <code>matU</code>, with
elements indicating whether a given <code>matU</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matU &gt; 0</code> (see
Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posF</code></td>
<td>
<p>A logical matrix of the same dimension as <code>matF</code>, with
elements indicating whether a given <code>matF</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matF &gt; 0</code> (see
Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posC</code></td>
<td>
<p>A logical matrix of the same dimension as <code>matC</code>, with
elements indicating whether a given <code>matC</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matC &gt; 0</code> (see
Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_row</code></td>
<td>
<p>A vector of row indices or stages names indicating stages
for which transitions <em>to</em> the stage should be excluded from
perturbation analysis. Alternatively, a logical vector of length
<code>nrow(matU)</code> indicating which stages to include <code>TRUE</code> or exclude
<code>FALSE</code> from the calculation. See section <em>Excluding stages</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_col</code></td>
<td>
<p>A vector of column indices or stages names indicating
stages for which transitions <em>to</em> the stage should be excluded from
perturbation analysis. Alternatively, a logical vector of length
<code>ncol(matU)</code> indicating which stages to include <code>TRUE</code> or exclude
<code>FALSE</code> from the calculation. See section <em>Excluding stages</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pert</code></td>
<td>
<p>The magnitude of the perturbation (defaults to <code>1e-6</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>An argument defining whether to return 'sensitivity' or
'elasticity' values. Defaults to 'sensitivity'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demog_stat</code></td>
<td>
<p>An argument defining which demographic statistic should be
used, as in "the sensitivity/elasticity of <code>demog_stat</code> to matrix
element perturbations." Defaults to the per-capita population growth rate
at equilibrium (<code class="reqn">lambda</code>). Also accepts a user-supplied function that
performs a calculation on a MPM and returns a single numeric value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the function <code>demog_stat</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A transition rate of <code>0</code> within a matrix population model can
either indicate that the transition is not possible in the given life cycle
(e.g., tadpoles never revert to eggs), or that the transition is possible but
was estimated to be <code>0</code> in the relevant population and time period.
Because transition rates of zero <em>do</em> generally yield non-zero
sensitivities, it is important to distinguish between structural (i.e.
impossible) zeros and sampled zeros when summing multiple sensitivities for a
given process (e.g., progression/growth).
</p>
<p>By default, the <code>perturb_</code> functions assume that a transition rate of
<code>0</code> indicates an impossible transition, in which case the sensitivity
for that transition will not be included in any calculation. Specifically,
the arguments <code>posX</code> are specified by the logical expression <code>(matX
&gt; 0)</code>. If the matrix population model includes transitions that are possible
but estimated to be <code>0</code>, users should specify the <code>posX</code>
argument(s) manually.
</p>
<p>If there are no possible transitions for a given process (e.g., clonality, in
many species), the value of sensitivity or elasticity returned for that
process will be <code>NA</code>.
</p>


<h3>Value</h3>

<p>A list with 5 elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>stasis</code></td>
<td>
<p>The sensitivity or elasticity
of <code>demog_stat</code> to stasis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retrogression</code></td>
<td>
<p>The sensitivity or
elasticity of <code>demog_stat</code> to retrogression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progression</code></td>
<td>
<p>The
sensitivity or elasticity of <code>demog_stat</code> to progression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fecundity</code></td>
<td>
<p>The sensitivity or elasticity of <code>demog_stat</code> to
sexual fecundity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clonality</code></td>
<td>
<p>The sensitivity or elasticity of
<code>demog_stat</code> to clonality.</p>
</td>
</tr>
</table>
<h3>Excluding stages</h3>

<p>It may be desirable to exclude one or more stages
from the calculation. For instance, we might not believe that 'progression'
to a dormant stage class truly reflects progression. In this case we could
exclude transitions <em>to</em> the dormant stage class using the argument
<code>exclude_row</code>. We may or may not want to ignore progression
transitions <em>from</em> the dormant stage class, which can be done in a
similar way using the argument <code>exclude_col</code>. The <code>exclude_</code>
arguments simply set the relevant row or column of the <code>posX</code>
arguments to <code>FALSE</code>, to prevent those transitions from being used in
subsequent calculations.
</p>


<h3>Author(s)</h3>

<p>Rob Salguero-GÃ³mez &lt;rob.salguero@zoo.ox.ac.uk&gt;
</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other perturbation analysis: 
<code>perturb_matrix()</code>,
<code>perturb_stochastic()</code>,
<code>perturb_vr()</code>,
<code>pop_vectors()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">matU &lt;- rbind(
  c(0.1, 0, 0, 0),
  c(0.5, 0.2, 0.1, 0),
  c(0, 0.3, 0.3, 0.1),
  c(0, 0, 0.5, 0.6)
)

matF &lt;- rbind(
  c(0, 0, 1.1, 1.6),
  c(0, 0, 0.8, 0.4),
  c(0, 0, 0, 0),
  c(0, 0, 0, 0)
)


perturb_trans(matU, matF)

# Use a larger perturbation than the default of 1e-6.
perturb_trans(matU, matF, pert = 0.01)

# Calculate the sensitivity/elasticity of the damping ratio to perturbations.
# First, define function for damping ratio:
damping &lt;- function(matA) {
  eig &lt;- eigen(matA)$values
  dm &lt;- rle(Mod(eig))$values
  return(dm[1] / dm[2])
}

# Second, run the perturbation analysis using demog_stat = "damping".
perturb_trans(matU, matF, demog_stat = "damping")

</code></pre>


</div>