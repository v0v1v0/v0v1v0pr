<div class="container">

<table style="width: 100%;"><tr>
<td>BTestSpearman</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap Hypothesis Test on Spearman Correlation Coefficients for Multivariate Functional Data</h2>

<h3>Description</h3>

<p>This function performs a bootstrap test that checks whether the Spearman correlation structures
(e.g. matrices) of two populations of compatible multivariate functional data are equal or not.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BTestSpearman(
  mfD1,
  mfD2,
  bootstrap_iterations = 1000,
  ordering = "MEI",
  normtype = "f",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mfD1</code></td>
<td>
<p>is the first functional dataset, specified in form of <code>mfData</code> object; it must
be compatible with <code>mfD2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfD2</code></td>
<td>
<p>is the second functional dataset, specified in form of <code>mfData</code> object; it must
be compatible with <code>mfD1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap_iterations</code></td>
<td>
<p>is the number of bootstrap iterations to be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordering</code></td>
<td>
<p>is the kind of ordering to be used in the computation of Spearman's correlation
coefficient (default is <code>MEI</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normtype</code></td>
<td>
<p>is the norm to be used when comparing the Spearman correlation matrices of the two
functional datasets (default is Frobenius, allowed values are the same as for parameter <code>type</code> in
the base function <code>norm</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a boolean flag specifying whether to print the progress of bootstrap iterations or not (default is FALSE).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a first multivariate functional population, <code class="reqn">X_1^(i), \ldots, X_n^(i)</code> with <code class="reqn">i=1, \ldots, L</code>,
defined on the grid <code class="reqn">I = t_1, \ldots, t_P</code>, and a second multivariate functional population,
<code class="reqn">Y_1^(i), \ldots, Y_m^(i)</code> with <code class="reqn">i=1, \ldots, L</code>, defined on the same grid <code class="reqn">I</code>, the
function performs a bootstrap test to check the hypothesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: R_X = R_Y</code>
</p>

<p style="text-align: center;"><code class="reqn">H_1: R_X \neq R_Y,</code>
</p>

<p>where R_X and R_Y denote the L x L matrices of Spearman correlation coefficients of the two populations.
</p>

<ul>
<li>
<p>The two functional samples must have the same number of components and must be defined over the same
discrete interval <code class="reqn">t_1, \ldots, t_P</code>.
</p>
</li>
<li>
<p>The test is performed through a bootstrap argument, so
a number of bootstrap iterations must be specified as well. A high value for this parameter may result
in slow performances of the test (you may consider setting <code>verbose</code> to <code>TRUE</code> to get
hints on the process).</p>
</li>
</ul>
<h3>Value</h3>

<p>The function returns the estimates of the test's p-value and statistics.
</p>


<h3>See Also</h3>

<p><code>BCIntervalSpearman</code>, <code>BCIntervalSpearmanMultivariate</code>, <code>mfData</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)

N  &lt;- 200
P &lt;- 100
L &lt;- 2

grid &lt;- seq(0, 1, length.out = P)

# Creating an exponential covariance function to simulate Gaussian data
Cov &lt;- exp_cov_function(grid, alpha = 0.3, beta = 0.4)

# Simulating two populations of bivariate functional data
#
# The first population has very high correlation between first and second component
centerline_1 &lt;- matrix(
  data = rep(sin(2 * pi * grid)),
  nrow = L,
  ncol = P,
  byrow = TRUE
)
values1 &lt;- generate_gauss_mfdata(
  N = N,
  L = L,
  correlations = 0.9,
  centerline = centerline_1,
  listCov = list(Cov, Cov)
)
mfD1 &lt;- mfData(grid, values1)

# Pointwise estimate
cor_spearman(mfD1)

# The second population has zero correlation between first and second component
centerline_2 &lt;- matrix(
  data = rep(cos(2 * pi * grid)),
  nrow = L,
  ncol = P,
  byrow = TRUE
)
values2 &lt;- generate_gauss_mfdata(
  N = N,
  L = L,
  correlations = 0,
  centerline = centerline_2,
  listCov = list(Cov, Cov)
)
mfD2 &lt;- mfData(grid, values2)

# Pointwise estimate
cor_spearman(mfD2)

# Applying the test

BTestSpearman(mfD1, mfD2)

</code></pre>


</div>