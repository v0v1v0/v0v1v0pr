<div class="container">

<table style="width: 100%;"><tr>
<td>rvn_rvh_read</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read Raven .rvh (watershed discretization) file</h2>

<h3>Description</h3>

<p>This routine reads in a valid Raven watershed discretization (.rvh) file and returns the
information about HRUs and Subbasins as data tables. It also returns a subbasin igraph
network object which describes stream network connectivity and adds additional HRU-derived
subbasin characteristics such as total upstream area and dominant land/vegetation classes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rvn_rvh_read(ff)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>ff</code></td>
<td>
<p>the filepath of the .rvh file (with .rvh extension included).</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The supplied file should not be comma-delimited with a trailing comma. The function also
does not like tabs in the rvh file, the file should be untabified first.
This function uses the igraph library to build the networks and compute the total upstream area.
The .rvh file can have arbitrary contents outside of the :HRUs-:EndHRUs and :SubBasins-:EndSubBasins
command blocks.
</p>
<p>Partial rvh files may be provided to this function (i.e. with only :SubBasin or :HRUs blocks but not the other),
however, some calculations and the calculation of the <code>SBnetwork</code> output will not be completed. Omitted
structures (e.g. <code>SBtable</code>) will be returned as <code>NULL</code> if the section is not found in the rvh file directly.
Note that this function does not look for additional files specified with <code>:RedirectToFile</code> commands.
</p>
<p>The ff argument can be a relative path name or absolute one.
</p>
<p>The TotalUpstreamArea is the total drainage area upstream of the given subbasin outlet. With this calculation,
headerwater subbasins will have a total upstream area equal to their own subbasin area.
</p>


<h3>Value</h3>

<p>Returns a list including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>SBtable</code></td>
<td>
<p>a data table of Subbasin characteristics indexed by Subbasin ID (SBID). Includes
the following data columns from the .rvh file : SBID, Name, Downstream_ID, Profile, ReachLength,
Gauged. The rvn_rvh_read() functions supplements this with additional columns: Area, Elevation, AvgLatit,
AvgLongit, AvgSlope, AvgAspect, DomLU, DomLUArea, DomLUFrac, DomVeg, DomVegArea, DomVegFrac.
Elevation, AvgLatit, AvgLongit, AvgSlope, and AvgAspect are the area-weighted averages from all
constituent HRUs. DomLU is the dominant land use name, DomLUArea is the area (in km2) of the
dominant land use and DomLUArea is the percentage of the basin covered with DomLU; same applies to DomVeg.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HRUtable</code></td>
<td>
<p>a data table of HRU characteristics, with land use and vegetation classes as factors.
Contains identical information as found in the :HRUs-:EndHRUs block of the .rvh file: ID, Area,
Elevation, Latitude, Longitude, SBID, LandUse,Vegetation, SoilProfile, Aquifer, Terrain, Slope,
and Aspect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SBnetwork</code></td>
<td>
<p>an igraph network graph network describing subbasin stream network connectivity,
with nodes indexed by SBID.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>James R. Craig, University of Waterloo
</p>


<h3>See Also</h3>

<p><code>rvn_rvh_write</code> to write contents of the generated (and usually modified HRU and SubBasin tables)
<code>rvn_rvh_subbasin_network_plot</code> to plot the subbasin network
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # load example rvh file
  nith &lt;- system.file("extdata","Nith.rvh",package = "RavenR")
  rvh &lt;- rvn_rvh_read(nith)

  # number of HRUs
  nrow(rvh$HRUtable)

  # total watershed area
  sum(rvh$HRUtable$Area)

  # sub-table of headwater basins (upstream area = subbasin area)
  rvh$SBtable$SBID[rvh$SBtable$Area == rvh$SBtable$TotalUpstreamArea]

  # sub-table of Urban HRUs
  subset(rvh$HRUtable, LandUse == "URBAN")

  # get total area upstream of subbasin containing outlet
  upstr &lt;- cumsum(rvh$SBtable$Area)
  upstr[rvh$SBtable$Downstream_ID == -1]

  # show upstream areas for each subbasin
  rvh$SBtable[,c("SBID","TotalUpstreamArea")]

  # plot network diagram using igraph library
  igraph::plot.igraph(rvh$SBnetwork)

</code></pre>


</div>