<div class="container">

<table style="width: 100%;"><tr>
<td>rcalibration_MS-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Robust Calibration for multiple sources class </h2>

<h3>Description</h3>

<p>S4 class for multiple sources Robust rcalibration with or without the specification of the discrepancy model.</p>


<h3>Objects from the Class</h3>

<p>Objects of this class are created and initialized with the function <code>rcalibration_MS</code> that computes the prediction after calibrating the mathematical models from multiple sources.</p>


<h3>Slots</h3>


<dl>
<dt>
<code>num_sources</code>:</dt>
<dd>
<p>Object of class <code>integer</code>. The number of sources.</p>
</dd>
<dt>
<code>p_x</code>:</dt>
<dd>
<p>Object of class <code>vector</code>. Each element is the dimension of the observed inputs in each source.</p>
</dd>
<dt>
<code>p_theta</code>:</dt>
<dd>
<p>Object of class <code>integer</code>. The number of calibration parameters.</p>
</dd>
<dt>
<code>num_obs</code>:</dt>
<dd>
<p>Object of class <code>vector</code>.Each element is the number of experimental observations of each source.</p>
</dd>
<dt>
<code>index_theta</code>:</dt>
<dd>
<p>Object of class <code>list</code>. The each element is a <code>vector</code> of the index of calibration parameters (theta) contained in each source. </p>
</dd>
<dt>
<code>input</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a <code>matrix</code> of the design of experiments in each source with dimension <code>n_i x p_{x,i}</code>, for i=1,...,num_sources.</p>
</dd>
<dt>
<code>output</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a <code>vector</code> of the experimental observations in each source with dimension n_i x 1, for i=1,...,num_sources.</p>
</dd>
<dt>
<code>X</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a <code>matrix</code> of the mean/trend discrepancy basis function in each source with dimension n_i x q_i,  for i=1,...,num_sources.</p>
</dd>
<dt>
<code>have_trend</code>:</dt>
<dd>
<p>Object of class <code>vector</code>. Each element is a  <code>bool</code> to specify whether the mean/trend discrepancy is zero in each source. "TRUE" means it has zero mean discrepancy and "FALSE"" means the mean discrepancy is not zero.</p>
</dd>
<dt>
<code>q</code>:</dt>
<dd>
<p>Object of class <code>vector</code>.  Each element is <code>integer</code> of the number of basis functions of the mean/trend discrepancy in each source. </p>
</dd>
<dt>
<code>R0</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a list of matrices where the j-th matrix is an absolute difference matrix of the j-th input vector in each source.</p>
</dd>
<dt>
<code>kernel_type</code>:</dt>
<dd>
<p>Object of class <code>vector</code>. Each element is a <code>character</code> to specify the type of kernel to use in each source.</p>
</dd>
<dt>
<code>alpha</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a <code>vector</code> of parameters for the roughness parameters in the kernel in each source.</p>
</dd>
<dt>
<code>theta_range</code>:</dt>
<dd>
<p>A <code>matrix</code> for the range of the calibration parameters.</p>
</dd>
<dt>
<code>lambda_z</code>:</dt>
<dd>
<p>Object of class <code>vector</code>.  Each element is a <code>numeric</code> value about how close the math model to the reality in squared distance when the S-GaSP model is used for modeling the discrepancy in each source.</p>
</dd>
<dt>
<code>S</code>:</dt>
<dd>
<p>Object of class <code>integer</code> about how many posterior samples to run.</p>
</dd>
<dt>
<code>S_0</code>:</dt>
<dd>
<p>Object of class <code>integer</code> about the number of burn-in samples.</p>
</dd>
<dt>
<code>prior_par</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a <code>vector</code> about prior parameters.</p>
</dd>
<dt>
<code>output_weights</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a <code>vector</code> about the weights of the experimental data.</p>
</dd>
<dt>
<code>sd_proposal_theta</code>:</dt>
<dd>
<p>Object of class <code>vector</code> about the standard deviation of the proposal distribution for the calibration parameters.</p>
</dd>
<dt>
<code>sd_proposal_cov_par</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a <code>vector</code> about the standard deviation of the proposal distribution for the calibration parameters in each source.</p>
</dd>
<dt>
<code>discrepancy_type</code>:</dt>
<dd>
<p>Object of class <code>vector</code>.  Each element is a <code>character</code> about the type of the discrepancy in each source. If it is 'no-discrepancy', it means no discrepancy function. If it is 'GaSP', it means the GaSP model for the discrepancy function. If it is 'S-GaSP', it means the S-GaSP model for the discrepancy function.</p>
</dd>
<dt>
<code>simul_type</code>:</dt>
<dd>
<p>Object of class <code>vector</code>. Each element is an <code>integer</code> about the math model/simulator. If the simul_type is 0, it means we use RobustGaSP R package to build an emulator for emulation. If the simul_type is 1, it means the function of the math model is given by the user. When simul_type is 2 or 3, the mathematical model is the geophyiscal model for Kilauea Volcano.  If the simul_type is 2, it means it is for the ascending mode InSAR data; if the simul_type is 3, it means it is for the descending mode InSAR data.</p>
</dd>
<dt>
<code>emulator_rgasp</code>:</dt>
<dd>
<p>Object of class <code>list</code>.  Each element is an S4 class of <code>rgasp</code> from the RobustGaSP package in each source.</p>
</dd>
<dt>
<code>emulator_ppgasp</code>:</dt>
<dd>
<p>Object of class <code>list</code>.  Each element is an S4 class of <code>ppgasp</code> from the RobustGaSP package in each source.</p>
</dd>
<dt>
<code>post_theta</code>:</dt>
<dd>
<p>Object of class <code>matrix</code> for the posterior samples of the calibration parameters after burn-in.</p>
</dd>
<dt>
<code>post_individual_par</code>:</dt>
<dd>
<p>Object of class <code>list</code>. Each element is a <code>matrix</code> for the posterior samples after burn-in in each source.</p>
</dd>
<dt>
<code>post_value</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for the posterior values after burn-in.</p>
</dd>
<dt>
<code>accept_S_theta</code>:</dt>
<dd>
<p>Object of class <code>numerical</code> for the number of proposed samples of the calibration parameters are accepted in MCMC.</p>
</dd>
<dt>
<code>accept_S_beta</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for the number of proposed samples of the range and nugget parameters in each source are accepted in MCMC.</p>
</dd>
<dt>
<code>count_boundary</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for the number of proposed samples of the calibation parameters are outside the range and they are rejected directly.</p>
</dd>
<dt>
<code>have_measurement_bias_recorded</code>:</dt>
<dd>
<p>Object of class <code>bool</code> for whether measurement bias will be recorded or not.</p>
</dd>
<dt>
<code>measurement_bias</code>:</dt>
<dd>
<p>Object of class <code>bool</code> for whether measurement bias exists or not.</p>
</dd>
<dt>
<code>post_delta</code>:</dt>
<dd>
<p>Object of class <code>matrix</code> of samples of model discrepancy.</p>
</dd>
<dt>
<code>post_measurement_bias</code>:</dt>
<dd>
<p>Object of class <code>list</code> of samples of measurement_bias if measurement bias is chosen to be recorded.</p>
</dd>
<dt>
<code>thinning</code>:</dt>
<dd>
<p>Object of class <code>integer</code> for the ratio between the number of posterior samples and the number of  samples to be recorded.</p>
</dd>
<dt>
<code>emulator_type</code>:</dt>
<dd>
<p>Object of class <code>vector</code> for the type of emulator for each source of data. 'rgasp' means scalar-valued emulator and 'ppgasp' means vectorized emulator.</p>
</dd>
<dt>
<code>loc_index_emulator</code>:</dt>
<dd>
<p>Object of class <code>list</code> for location index to output in ghe ppgasp emulator  for computer models with vectorized output.</p>
</dd>
</dl>
<h3>Methods</h3>



<dl>
<dt>predict_MS</dt>
<dd>
<p>See <code>predict_MS</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Mengyang Gu [aut, cre]
</p>
<p>Maintainer: Mengyang Gu &lt;mengyang@pstat.ucsb.edu&gt;
</p>


<h3>References</h3>

<p>A. O'Hagan and M. C. Kennedy (2001), <em>Bayesian calibration of computer models</em>, <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology</em>, <b>63</b>, 425-464.
</p>
<p>M. Gu (2016), <em>Robust Uncertainty Quantification and Scalable Computation for Computer Models with Massive Output</em>, Ph.D. thesis., Duke University.
</p>
<p>M. Gu and L. Wang (2017) <em>Scaled Gaussian Stochastic Process for Computer Model Calibration and Prediction</em>. arXiv preprint arXiv:1707.08215.
</p>
<p>M. Gu (2018) <em>Jointly Robust Prior for Gaussian Stochastic Process in Emulation, Calibration and Variable Selection
</em>. arXiv preprint arXiv:1804.09329.
</p>


<h3>See Also</h3>

 <p><code>rcalibration_MS</code> for more details about how to create a <code>rcalibration_MS</code> object.

</p>


</div>