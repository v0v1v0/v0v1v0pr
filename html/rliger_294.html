<div class="container">

<table style="width: 100%;"><tr>
<td>selectGenes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select a subset of informative genes</h2>

<h3>Description</h3>

<p>This function identifies highly variable genes from each dataset
and combines these gene sets (either by union or intersection) for use in
downstream analysis. Assuming that gene expression approximately follows a
Poisson distribution, this function identifies genes with gene expression
variance above a given variance threshold (relative to mean gene expression).
Alternatively, we allow selecting a desired number of genes for each dataset
by ranking the relative variance, and then take the combination.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectGenes(object, thresh = 0.1, nGenes = NULL, alpha = 0.99, ...)

## S3 method for class 'liger'
selectGenes(
  object,
  thresh = 0.1,
  nGenes = NULL,
  alpha = 0.99,
  useDatasets = NULL,
  useUnsharedDatasets = NULL,
  unsharedThresh = 0.1,
  combine = c("union", "intersection"),
  chunk = 1000,
  verbose = getOption("ligerVerbose", TRUE),
  var.thresh = thresh,
  alpha.thresh = alpha,
  num.genes = nGenes,
  datasets.use = useDatasets,
  unshared.datasets = useUnsharedDatasets,
  unshared.thresh = unsharedThresh,
  tol = NULL,
  do.plot = NULL,
  cex.use = NULL,
  unshared = NULL,
  ...
)

## S3 method for class 'Seurat'
selectGenes(
  object,
  thresh = 0.1,
  nGenes = NULL,
  alpha = 0.99,
  useDatasets = NULL,
  layer = "ligerNormData",
  assay = NULL,
  datasetVar = "orig.ident",
  combine = c("union", "intersection"),
  verbose = getOption("ligerVerbose", TRUE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A liger, ligerDataset or
<code>Seurat</code> object, with normalized data available (no scale factor
multipled nor log transformed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>Variance threshold used to identify variable genes. Higher
threshold results in fewer selected genes. Liger and Seurat S3 methods accept
a single value or a vector with specific threshold for each dataset in
<code>useDatasets</code>.* Default <code>0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nGenes</code></td>
<td>
<p>Number of genes to find for each dataset. By setting this,
we optimize the threshold used for each dataset so that we get <code>nGenes</code>
selected features for each dataset. Accepts single value or a vector for
dataset specific setting matching <code>useDataset</code>.* Default <code>NULL</code>
does not optimize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Alpha threshold. Controls upper bound for expected mean gene
expression. Lower threshold means higher upper bound. Default <code>0.99</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useDatasets</code></td>
<td>
<p>A character vector of the names, a numeric or logical
vector of the index of the datasets to use for shared variable feature
selection. Default <code>NULL</code> uses all datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useUnsharedDatasets</code></td>
<td>
<p>A character vector of the names, a numeric or
logical vector of the index of the datasets to use for finding unshared
variable features. Default <code>NULL</code> does not attempt to find unshared
features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unsharedThresh</code></td>
<td>
<p>The same thing as <code>thresh</code> that is applied to test
unshared features. A single value for all datasets in
<code>useUnsharedDatasets</code> or a vector for dataset-specific setting.* Default
<code>0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine</code></td>
<td>
<p>How to combine variable genes selected from all datasets.
Choose from <code>"union"</code> or <code>"intersection"</code>. Default <code>"union"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chunk</code></td>
<td>
<p>Integer. Number of maximum number of cells in each chunk, when
gene selection is applied to any HDF5 based dataset. Default <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Whether to show information of the progress. Default
<code>getOption("ligerVerbose")</code> or <code>TRUE</code> if users have not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.thresh, alpha.thresh, num.genes, datasets.use, unshared.datasets, unshared.thresh</code></td>
<td>
<p><b>Deprecated</b>.
These arguments are renamed and will be removed in the future. Please see
function usage for replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol, do.plot, cex.use, unshared</code></td>
<td>
<p><b>Deprecated</b>. Gene variability
metric is now visualized with separated function
<code>plotVarFeatures</code>. Users can now set none-NULL
<code>useUnsharedDatasets</code> to select unshared genes, instead of having to
switch <code>unshared</code> on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layer</code></td>
<td>
<p>Where the input normalized counts should be from. Default
<code>"ligerNormData"</code>. For older Seurat, always retrieve from <code>data</code>
slot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Name of assay to use. Default <code>NULL</code> uses current active
assay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datasetVar</code></td>
<td>
<p>Metadata variable name that stores the dataset source
annotation. Default <code>"orig.ident"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Updated object
</p>

<ul>
<li>
<p>liger method - Each involved dataset stored in
ligerDataset is updated with its <code>featureMeta</code>
slot and <code>varUnsharedFeatures</code> slot (if requested with
<code>useUnsharedDatasets</code>), while <code>varFeatures(object)</code> will be
updated with the final combined gene set.
</p>
</li>
<li>
<p>Seurat method - Final selection will be updated at
<code>Seurat::VariableFeatures(object)</code>. Per-dataset information is
stored in the <code>meta.features</code> slot of the chosen Assay.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">pbmc &lt;- normalize(pbmc)
# Select basing on thresholding the relative variance
pbmc &lt;- selectGenes(pbmc, thresh = .1)
# Select specified number for each dataset
pbmc &lt;- selectGenes(pbmc, nGenes = c(60, 60))
</code></pre>


</div>