<div class="container">

<table style="width: 100%;"><tr>
<td>genv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the groupwise envelope model</h2>

<h3>Description</h3>

<p>Fit the groupwise envelope model in multivariate linear regression with dimension u. The groupwise envelope model is designed to accommodate both distinct regression coefficients and distinct error structures for different groups. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">genv(X, Y, Z, u, asy = TRUE, fit = TRUE, init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>A group indicator vector of length <code class="reqn">n</code>, where <code class="reqn">n</code> 
denotes the number of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>Dimension of the groupwise envelope. An integer between 0 and r.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy</code></td>
<td>
<p>Flag for computing the asymptotic variance of the envelope estimator.  The default is <code>TRUE</code>. When p and r are large, computing the asymptotic variance can take much time and memory.  If only the envelope estimators are needed, the flag can be set to <code>asy = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>Flag for computing the fitted response.  The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>The user-specified value of Gamma for the groupwise envelope subspace. An r by u matrix. The default is the one generated by function genvMU.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits the groupwise envelope model to the responses and predictors, </p>
<p style="text-align: center;"><code class="reqn">
 Y_{(l)j} = \mu_{(l)} + \Gamma\eta_{(l)j} X_{(l)j}+\varepsilon_{(l)j}, \Sigma_{(l)}=\Gamma\Omega_{(l)}\Gamma'+\Gamma_{0}\Omega_{0}\Gamma'_{0}
 </code>
</p>

<p>for l = 1, ..., L, using the maximum likelihood estimation.  When the dimension of the groupwise envelope is between 1 and r-1, the starting value and blockwise coordinate descent algorithm in Cook et al. (2016) is implemented.  When the dimension is r, then the envelope model degenerates to the standard multivariate linear regression.  When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different. When L is 1, the groupwise envelope model degenerates to the envelope model in Cook et al. (2010).
</p>


<h3>Value</h3>

<p>The output is a list that contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>A list of <code class="reqn">r</code> by <code class="reqn">p</code> matrices for the estimator of
regression coefficients.  <code>beta</code>[[i]] indicates the 
estimator of regression coefficient for the ith group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>

<p>A list of the estimator of error covariance matrix. <code>Sigma</code>[[i]] contains the estimated covariance matrix for the ith group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>

<p>An orthonormal basis of the groupwise envelope subspace.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma0</code></td>
<td>

<p>An orthonormal basis of the complement of the groupwise envelope subspace.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>

<p>The coordinates of beta with respect to Gamma.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>

<p>The coordinates of Sigma with respect to Gamma.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega0</code></td>
<td>

<p>The coordinates of Sigma with respect to Gamma0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>The estimator of group mean.  A <code class="reqn">r</code> by <code class="reqn">L</code> matrix  
whose ith column contains the mean for the group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>

<p>The maximized log likelihood function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMatrix</code></td>
<td>

<p>A list of the asymptotic covariance of vec(beta). The covariance 
matrix returned are asymptotic.  For the actual standard errors, 
multiply by 1 / n. <code>covMatrix</code>[[i]] contains the asymptotic 
covariance matrix for the ith group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asySE</code></td>
<td>

<p>A list of the asymptotic standard error for elements in beta under 
the groupwise envelope model.  The standard errors returned are 
asymptotic, for actual standard errors, multiply by 1 / sqrt(n). 
<code>asySE</code>[[i]] contains the asymptotic standard error for 
elements in beta[[i]].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>

<p>A list of the asymptotic standard error ratio of the standard 
multivariate linear regression estimator over the groupwise envelope 
estimator, for each element in beta. <code>ratio</code>[[i]] contains the 
asymptotic standard error ratio for the ith group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupInd</code></td>
<td>

<p>A matrix containing the unique values of group indicators. The 
matrix has p rows.	
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>The number of observations in the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ng</code></td>
<td>

<p>The number of observations in each group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yfit</code></td>
<td>

<p>Fitted responses.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Park, Y., Su, Z. and Zhu, H. (2017)  Groupwise envelope models for Imaging Genetic Analysis. Biometrics, to appear.
</p>
<p>Cook, R. D., Li, B. and Chiaromente, F. (2010). Envelope Models for Parsimonious and Efficient Multivariate Linear Regression (with discussion). Statist. Sinica 20, 927- 1010.
</p>
<p>Cook, R. D., Forzani, L. and Su, Z. (2016) A Note on Fast Envelope Estimation. Journal of Multivariate Analysis. 150, 42-54.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(fiberpaper)
X &lt;- fiberpaper[ , c(5, 7)]
Y &lt;- fiberpaper[ , 1:3]
Z &lt;- as.numeric(fiberpaper[ , 6] &gt; mean(fiberpaper[ , 6]))
## Not run: u &lt;- u.genv(X, Y, Z)
## Not run: u
## Not run: m &lt;- genv(X, Y, Z, 2)

</code></pre>


</div>