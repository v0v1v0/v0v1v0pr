<div class="container">

<table style="width: 100%;"><tr>
<td>makefullmatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conductance matrix for a lattice of unit resistors</h2>

<h3>Description</h3>

<p>Conductance matrix for a lattice of unit resistors
</p>


<h3>Usage</h3>

<pre><code class="language-R">makefullmatrix(R, C)
makefullmatrix_strict(R, C,toroidal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Number of rows of nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Number of columns of nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toroidal</code></td>
<td>
<p>Boolean, with <code>TRUE</code> meaning to return a
toroidally connected lattice, and <code>FALSE</code> meaning to return a
lattice with edges</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The array produced by <code>makefullmatrix_strict(R,C,TRUE)</code> is
toroidally connected.
</p>
<p>Function <code>makefullmatrix()</code> is not entirely straightforward.  The
array produced is sort of toroidally connected.  I regard this
function as the canonical one because it is more elegant (see example
image).  Consider, for concreteness, the case with four rows and seven
columns of nodes giving 28 nodes altogether.  Number these columnwise
so the top row is 1,5,9,13,17,21,25.  Then number <code class="reqn">n</code> corresponds
to the row <code class="reqn">n</code> and column <code class="reqn">n</code> of the returned matrix.
</p>
<p>Now, ‘interior’ nodes are as expected: node 6, for example, is
connected to 2,5,10,7.  And the wrapping is as expected in the
horizontal: 1-25, 2-26, 3-27, and 4-28, are all connected.
</p>
<p>However, the vertical wrapping is not as might be expected. One might
expect node 9, say, to be connected to 5,10 13,12; but in fact node 9
is connected to nodes 5,8,10,13.  So there is a Hamiltonian path
comprising entirely of vertical connections (function
<code>makefullmatrix_strict(R,C,TRUE)</code> returns the “expected”
adjacency graph).
</p>
<p>For the arrays returned by functions documented here, one can
determine pairwise resistances using function
<code>array.resistance()</code>.
</p>


<h3>Value</h3>

<p>Returns matrix of size <code class="reqn">RC\times RC</code>.  Note that this
matrix is singular.
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>See Also</h3>

<p><code>array.resistance</code></p>


<h3>Examples</h3>

<pre><code class="language-R">makefullmatrix(3,3)
image(makefullmatrix(4,7))              # A beautiful natural structure
image(makefullmatrix_strict(4,7,TRUE))  # A dog's breakfast
</code></pre>


</div>