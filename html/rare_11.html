<div class="container">

<table style="width: 100%;"><tr>
<td>tree.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate matrix A encoding ancestor-descendant relationships
in an hclust tree</h2>

<h3>Description</h3>

<p>The function generates the binary matrix <code>A</code> defined in Yan
and Bien (2018). The matrix encodes ancestor-descendant relationships between leaves
and tree nodes in an <code>hclust</code> tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tree.matrix(hc)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>hc</code></td>
<td>
<p>An <code>hclust</code> object.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>Returns a <code>nvars</code>-by-<code>nnodes</code> binary matrix <code>A</code>
where <code>nvars</code> is the number of leaves (we associate covariate with leaf),
and <code>nnodes</code> is the number of tree nodes (including both leaves and interior nodes).
For an <code>hclust</code> tree, <code>nnodes</code> = <code>2*nvars-1</code>. <code>A[i,j]</code> is 1 if the <code>i</code>th leaf
is a descendant of the <code>j</code>th node in the tree, and 0 otherwise. <em>By default, we
let the first <code>nvars</code> columns correspond to leaves and the remaining
<code>nvars-1</code> columns correspond to interior nodes.</em>
<code>A</code> is in sparse matrix format (inherit from class
<code>sparseMatrix</code> as in package <code>Matrix</code>).
</p>


<h3>References</h3>

<p>Yan, X. and Bien, J. (2018) <em>Rare Feature Selection in High Dimensions</em>, <a href="https://arxiv.org/abs/1803.06675">https://arxiv.org/abs/1803.06675</a>.
</p>


<h3>See Also</h3>

<p><code>find.leaves</code> for finding descendant leaves of a node.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# For a perfect binary tree of depth 2 below
#
#      3
#      /\
#    1    2
#   /\    /\
# -1 -2 -3 -4
#
# A can expressed as the following:
A_true &lt;- cbind(diag(4),
                as.matrix(c(1, 1, 0, 0)),
                as.matrix(c(0, 0, 1, 1)),
                as.matrix(c(1, 1, 1, 1)))
# Now use tree.matrix to generate A
tree0 &lt;- list()
tree0$merge &lt;- matrix(c(-1, -2, -3, -4, 1, 2),
                      ncol = 2, byrow = TRUE)
tree0$labels &lt;- c("leaf1", "leaf2", "leaf3", "leaf4")
A &lt;- tree.matrix(tree0)
all(A_true == as.matrix(A))

# Another example
hc &lt;- hclust(dist(USArrests), "ave")
A &lt;- tree.matrix(hc)

## End(Not run)

</code></pre>


</div>