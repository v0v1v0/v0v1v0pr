<div class="container">

<table style="width: 100%;"><tr>
<td>flow</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate flow variables</h2>

<h3>Description</h3>

<p><code>discharge()</code> computes the <code style="white-space: pre;">⁠x, y⁠</code> and <code>z</code> components of the discharge vector for an <code>aem</code> object
at the given x, y and z coordinates.
</p>
<p><code>darcy()</code> computes the <code style="white-space: pre;">⁠x, y⁠</code> and <code>z</code> components of the Darcy flux vector (also called <em>specific discharge vector</em>)
for an <code>aem</code> object at the given x, y and z coordinates.
</p>
<p><code>velocity()</code> computes the <code style="white-space: pre;">⁠x, y⁠</code> and <code>z</code> components of the average linear groundwater flow velocity vector
for an <code>aem</code> object at the given x, y and z coordinates.
</p>
<p><code>domega()</code> computes the complex discharge for an <code>aem</code> or <code>element</code> object
at the given x and y coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">discharge(...)

darcy(...)

velocity(...)

domega(...)

## S3 method for class 'aem'
discharge(
  aem,
  x,
  y,
  z,
  as.grid = FALSE,
  magnitude = FALSE,
  verbose = TRUE,
  ...
)

## S3 method for class 'aem'
darcy(aem, x, y, z, as.grid = FALSE, magnitude = FALSE, ...)

## S3 method for class 'aem'
velocity(aem, x, y, z, as.grid = FALSE, magnitude = FALSE, R = 1, ...)

## S3 method for class 'aem'
domega(aem, x, y, as.grid = FALSE, ...)

## S3 method for class 'element'
domega(element, x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored or arguments passed from <code>velocity()</code> or <code>darcy()</code> to <code>discharge()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aem</code></td>
<td>
<p><code>aem</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric x coordinates to evaluate the flow at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric y coordinates to evaluate the flow at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>numeric z coordinates to evaluate at</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.grid</code></td>
<td>
<p>logical, should a matrix be returned? Defaults to <code>FALSE</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magnitude</code></td>
<td>
<p>logical, should the magnitude of the flow vector be returned as well? Default to <code>FALSE</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, if <code>TRUE</code> (default), warnings with regards to setting <code>Qz</code> to <code>NA</code> are printed. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>numeric, retardation coefficient used in <code>velocity()</code>. Defaults to 1 (no retardation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>element</code></td>
<td>
<p>analytic element of class <code>element</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There is no <code>discharge()</code>, <code>darcy()</code> or <code>velocity()</code> method for an object of class <code>element</code> because an <code>aem</code> object is required
to obtain the aquifer base and top.
</p>
<p>If the <code>z</code> coordinate is above the saturated aquifer level (i.e. the water-table for unconfined conditions or
the aquifer top for confined conditions), or below the aquifer base, <code>Qz</code> values are set to <code>NA</code> with a warning (if <code>verbose = TRUE</code>).
The <code>Qx</code> and <code>Qy</code> values are not set to <code>NA</code>, for convenience in specifying the <code>z</code> coordinate when only lateral flow
is of interest.
</p>


<h3>Value</h3>

<p>For <code>discharge()</code>, a matrix with the number of rows equal to the number of points to evaluate
the discharge vector at, and with columns <code>Qx</code>, <code>Qy</code> and <code>Qz</code> corresponding to <code style="white-space: pre;">⁠x, y⁠</code> and <code>z</code> components
of the discharge vector at coordinates <code>x</code>, <code>y</code> and <code>z</code>. If <code>as.grid = TRUE</code>, an array of dimensions
<code>c(length(y), length(x), length(z), 3)</code> described by marginal vectors <code>x</code>, <code>y</code> and <code>z</code> (columns, rows and third dimension)
containing the <code style="white-space: pre;">⁠x, y⁠</code> and <code>z</code> components of the discharge vector (<code>Qx</code>, <code>Qy</code> and <code>Qz</code>) as the fourth dimension.
</p>
<p>The <code>x</code> component of <code>discharge()</code> is the real value of <code>domega()</code>, the <code>y</code> component
the negative imaginary component and the <code>z</code> component is calculated based on area-sink strengths
and/or the curvature of the phreatic surface.
</p>
<p>If <code>magnitude = TRUE</code>, the last dimension of the returned array is expanded to include
the magnitude of the discharge/Darcy/velocity vector, calculated as <code>sqrt(Qx^2 + Qy^2 + Qz^2)</code>
(or <code>sqrt(qx^2 + qy^2 + qz^2)</code> or <code>sqrt(vx^2 + vy^2 + vz^2)</code>, respectively).
</p>
<p>For <code>darcy()</code>, the same as for <code>discharge()</code> but with the <code>x</code>, <code>y</code> and <code>z</code> components of the
Darcy flux vector (<code>qx</code>, <code>qy</code> and <code>qz</code>). The values are computed by dividing the values of <code>discharge()</code> by
the saturated thickness at <code>x</code>, <code>y</code> and <code>z</code>.
</p>
<p>For <code>velocity()</code>, the same as for <code>discharge()</code> but with the <code>x</code>, <code>y</code> and <code>z</code> components of the
average linear groundwater flow velocity vector (<code>vx</code>, <code>vy</code> and <code>vz</code>). The values are computed by dividing
the <code>darcy()</code> values by the effective porosity (<code>aem$n</code>) and the retardation coefficient <code>R</code>.
</p>
<p>For <code>domega()</code>, a vector of <code>length(x)</code> (equal to <code>length(y)</code>) with the complex discharge values at <code>x</code> and <code>y</code>,
If <code>as.grid = TRUE</code>, a matrix of dimensions <code>c(length(y), length(x))</code> described by
marginal vectors <code>x</code> and <code>y</code> containing the complex discharge values at the grid points.
<code>domega()</code> is the derivative of <code>omega()</code> in the x and y directions.
</p>


<h3>See Also</h3>

<p><code>state-variables()</code>, <code>satthick()</code>, <code>dirflow()</code>, <code>flow_through_line()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">w &lt;- well(xw = 55, yw = 0, Q = 200)
uf &lt;- uniformflow(gradient = 0.002, angle = -45, TR = 100)
as &lt;- areasink(xc = 0, yc = 0, N = 0.001, R = 500)
rf &lt;- constant(xc = -1000, yc = 1000, hc = 10)
ml &lt;- aem(k = 10, top = 10, base = -15, n = 0.2, w, uf, as, rf)

xg &lt;- seq(-100, 100, length = 5)
yg &lt;- seq(-75, 75, length = 3)

# Discharge vector
discharge(ml, c(150, 0), c(80, -80), z = -10)
discharge(ml, c(150, 0), c(80, -80), z = c(2, 5), magnitude = TRUE)
discharge(ml, xg, yg, z = 2, as.grid = TRUE)
discharge(ml, c(150, 0), c(80, -80), z = ml$top + c(-5, 0.5)) # NA for z &gt; water-table

# Darcy flux
darcy(ml, c(150, 0), c(80, -80), c(0, 5), magnitude = TRUE)

# Velocity
velocity(ml, c(150, 0), c(80, -80), c(0, 5), magnitude = TRUE, R = 5)

# Complex discharge
domega(ml, c(150, 0), c(80, -80))

# Complex discharge for elements
domega(w, c(150, 0), c(80, -80))

</code></pre>


</div>