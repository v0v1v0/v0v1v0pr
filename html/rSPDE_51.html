<div class="container">

<table style="width: 100%;"><tr>
<td>rSPDE.loglike</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Object-based log-likelihood function for latent Gaussian
fractional SPDE model</h2>

<h3>Description</h3>

<p>This function evaluates the log-likelihood function for a
fractional SPDE model
<code class="reqn">L^\beta u(s) = W</code> that is observed under
Gaussian measurement noise:
<code class="reqn">Y_i = u(s_i) + \epsilon_i</code>,
where <code class="reqn">\epsilon_i</code>
are iid mean-zero Gaussian variables and <code class="reqn">x(s) =
\mu(s) + u(s)</code>, where
<code class="reqn">\mu(s)</code> is the expectation vector of the latent field.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rSPDE.loglike(obj, Y, A, sigma.e, mu = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>The rational SPDE approximation, computed using
<code>fractional.operators()</code>,
<code>matern.operators()</code>, or <code>spde.matern.operators()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The observations, either a vector or a matrix where
the columns correspond to independent replicates of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>An observation matrix that links the measurement location
to the finite element basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.e</code></td>
<td>
<p>The standard deviation of the measurement noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Expectation vector of the latent field (default = 0).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The log-likelihood value.
</p>


<h3>Note</h3>

<p>This example below shows how the function can be used to evaluate
the likelihood of a latent Matern model.
</p>


<h3>See Also</h3>

<p><code>spde.matern.loglike()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sample a Gaussian Matern process on R using a rational approximation
kappa &lt;- 10
sigma &lt;- 1
nu &lt;- 0.8
sigma.e &lt;- 0.3
range &lt;- 0.2

# create mass and stiffness matrices for a FEM discretization
x &lt;- seq(from = 0, to = 1, length.out = 101)
fem &lt;- rSPDE.fem1d(x)

# compute rational approximation
op &lt;- matern.operators(
  range = range, sigma = sigma, nu = nu,
  loc_mesh = x, d = 1,
  type = "operator", parameterization = "matern"
)

# Sample the model
u &lt;- simulate(op)

# Create some data
obs.loc &lt;- runif(n = 10, min = 0, max = 1)
A &lt;- rSPDE.A1d(x, obs.loc)
Y &lt;- as.vector(A %*% u + sigma.e * rnorm(10))

# compute log-likelihood of the data
lik1 &lt;- rSPDE.loglike(op, Y, A, sigma.e)
cat(lik1)
</code></pre>


</div>