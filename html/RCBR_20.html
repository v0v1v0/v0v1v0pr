<div class="container">

<table style="width: 100%;"><tr>
<td>rcbr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of Random Coefficient Binary Response Models</h2>

<h3>Description</h3>

<p>Two methods are implemented for estimating binary response models  
with random coefficients:  A nonparametric maximum likelihood method
proposed by Cosslett (1986) and extended by Ichimura and Thompson (1998),
and a (hemispherical) deconvolution method proposed by Gautier and
and Kitamura (2013).  The former is closely related to the NPMLE
for mixture models of Kiefer and Wolfowitz (1956).  The latter is an
R translation of the matlab implementation of Gautier and Kitamura.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rcbr(formula, data, subset, offset, mode = "GK", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an expression of the generic form <code>y ~ z + v</code> where
<code>y</code> is the observed binary response, <code>z</code> is an observed covariate
with a random coefficient, and <code>v</code> is an observed covariate with
coefficient normalize to be one.  If <code>z</code> is not present then the
model has only a random "intercept" coefficient  and thus corresponds
to the basic model of Cosslett (1983);  this model is also referred to
as the current status model in the biostatistics literature, see Groeneboom
and Hendrikx (2016).  When <code>z</code> is present there are random coefficients
associated with both the intercept and <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>is a <code>data.frame</code> containing the data referenced in the
formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>specifies a subsample of the data used for fitting the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>specifies a fixed shift in <code>v</code> representing the
potential effect of other covariates having fixed coefficients that may be
useful for profile likelihood computations.  (Should be vector of the same
length as <code>v</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>controls whether the Gautier and Kitamura, "GK", or Kiefer and
Wolfowitz, "KW" methods are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>miscellaneous other arguments to control fitting.
See <code>GK.control</code> and <code>KW.control</code> for further details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>predict</code> method produces estimates of the probability of a "success"
(y = 1) for a particular vector, <code>(z,v)</code>,  when aggregated over the estimated
distribution of random coefficients.
</p>
<p>The <code>logLik</code> produces an evaluation of the log likelihood value
associated with a fitted model.
</p>


<h3>Value</h3>

<p>of object of class <code>GK</code>, <code>KW1</code>, with components described in 
further detail in the respective fitting functions.
</p>


<h3>Author(s)</h3>

<p>Jiaying Gu and Roger Koenker
</p>


<h3>References</h3>

<p>Kiefer, J. and J. Wolfowitz (1956) Consistency of the Maximum
Likelihood Estimator in the Presence of Infinitely Many Incidental
Parameters, <em>Ann. Math. Statist</em>, 27, 887-906.
</p>
<p>Cosslett, S. (1983) Distribution Free Maximum Likelihood Estimator of the 
Binary Choice Model, <em>Econometrica</em>, 51, 765-782.
</p>
<p>Gautier, E. and Y. Kitamura (2013)  Nonparametric estimation in random coefficients
binary choice models, <em>Ecoonmetrica</em>, 81, 581-607.
</p>
<p>Gu, J. and R. Koenker (2020)  Nonparametric Maximum Likelihood Methods for 
Binary Response Models with Random Coefficients, <em>J. Am. Stat Assoc</em> 
</p>
<p>Groeneboom, P. and K. Hendrickx (2016) Current Status Linear Regression,
preprint available from <a href="https://arxiv.org/abs/1601.00202">https://arxiv.org/abs/1601.00202</a>.
</p>
<p>Ichimura, H. and T. S. Thompson, (1998) Maximum likelihood estimation of a binary 
choice model with random coefficients of unknown distribution," 
<em>Journal of Econometrics</em>,  86, 269-295.
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
if(packageVersion("Rmosek") &gt; "8.0.0"){
    # Simple Test Problem for rcbr
    n &lt;- 60
    B0 = rbind(c(0.7,-0.7,1),c(-0.7,0.7,1))
    z &lt;- rnorm(n)
    v &lt;- rnorm(n)
    s &lt;- sample(0:1, n, replace = TRUE)
    XB0 &lt;- cbind(1,z,v) %*% t(B0)
    u &lt;- s * XB0[,1] + (1-s) * XB0[,2]
    y &lt;- (u &gt; 0) - 0
    D &lt;- data.frame(z = z, v = v, y = y)
    f &lt;- rcbr(y ~ z + v, mode = "KW", data = D)
    plot(f)
    # Simple Test Problem for rcbr
    set.seed(15)
    n &lt;- 100
    B0 = rbind(c(0.7,-0.7,1),c(-0.7,0.7,1))
    z &lt;- rnorm(n)
    v &lt;- rnorm(n)
    s &lt;- sample(0:1, n, replace = TRUE)
    XB0 &lt;- cbind(1,z,v) %*% t(B0)
    u &lt;- s * XB0[,1] + (1-s) * XB0[,2]
    y &lt;- (u &gt; 0) - 0
    D &lt;- data.frame(z = z, v = v, y = y)
    f &lt;- rcbr(y ~ z + v, mode = "GK", data = D)
    contour(f$u, f$v, matrix(f$w, length(f$u)))
    points(x = 0.7, y = -0.7, col = 2)
    points(x = -0.7, y = 0.7, col = 2)
    f &lt;- rcbr(y ~ z + v, mode = "GK", data = D, T = 7)
    contour(f$u, f$v, matrix(f$w, length(f$u)))
    points(x = 0.7, y = -0.7, col = 2)
    points(x = -0.7, y = 0.7, col = 2)
    }
}
</code></pre>


</div>