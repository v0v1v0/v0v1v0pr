<div class="container">

<table style="width: 100%;"><tr>
<td>PTQTE.Khmaladze.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile-Based Permutation Test with an Estimated Nuisance Parameter</h2>

<h3>Description</h3>

<p>A permutation test for testing whether the quantile treatment effects are constant across quantiles. The permutation test considered here is based on the Khmaladze transformation of the quantile process (Koenler and Xiao (2002)), and adapted by Chung and Olivares (2021).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PTQTE.Khmaladze.fit(
  Y,
  Z,
  taus = seq(0.1, 0.9, by = 0.05),
  alpha = 0.05,
  n.perm = 999
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric. Vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Numeric. Treatment indicator. Z=1 if the unit is in the treatment group, and Z=0 if the unit is in the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>quantiles at which the process is to be evaluated, if any of the taus lie outside (0,1) then the full process is computed for all distinct solutions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. The default is n.perm=999.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "PTQTE.Khmaladze" containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n_populations</code></td>
<td>
<p>Number of grups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Sample Size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KS.obs</code></td>
<td>
<p>Observed two-sample Kolmogorov-Smirnov test statistic based on the quantile process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>The estimated nuisance parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rej.rule</code></td>
<td>
<p>Binary decision for the permutation test, where 1 means rejection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KS.perm</code></td>
<td>
<p>Vector. Test statistic recalculated for all permutations used in the stochastic approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_perm</code></td>
<td>
<p>Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_sizes</code></td>
<td>
<p>Groups size.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>


<h3>References</h3>

<p>Khmaladze, E. (1981). Martingale Approach in the Theory of Goodness-of-fit Tests. Theory of Probability and its Application, 26: 240â€“257.
Koenker, R. and Xiao, Z. (2002) Inference on the Quantile Regression Process. Econometrica, 70(4): 1583-1612.
Chung, E. and Olivares, M. (2021). Comment on "Can Variation in Subgroups' Average Treatment Effects Explain Treatment Effect Heterogeneity? Evidence from a Social Experiment."
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
dta &lt;- data.frame(Y=rnorm(100),Z=sample(c(0,1), 100, replace = TRUE))
pt.QTE&lt;-PTQTE.Khmaladze.fit(dta$Y,dta$Z,taus=seq(.1,.9,by=0.05),alpha=0.05,n.perm = 499)
summary(pt.QTE)

## End(Not run)
</code></pre>


</div>