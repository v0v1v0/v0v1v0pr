<div class="container">

<table style="width: 100%;"><tr>
<td>fourPoint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generating the Fourth Point of the Study Plot</h2>

<h3>Description</h3>

<p>Generate the fourth reference point of the plot according to three defined geo-referential points. This function is important for the correct use of all the functions of the rPAex package. In the image the plot is a parallelogram, the first assigned point must be located in the upper left and continue the second point in the upper right side and the third point in the lower right, always in a clockwise direction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fourPoint(P)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>the three points list</p>
</td>
</tr></table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>matrix, four points</p>
</td>
</tr></table>
<h3>See Also</h3>

<p><code>imageField</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(rPAex)
prg1 &lt;- system.file("examples/Ex-01.R", package="rPAex")
source(prg1)
r&lt;-data1()
# x11()
op&lt;-par(mar=c(2,2,4,2),cex=0.8)
terra::image(r,main="Generating the fourth point of the study plot",col=col2rgb(10),
xlim=c(20,101), ylim=c(0,101),axes=FALSE)
# p&lt;-locator(3)
p&lt;-list(x=c(40, 88, 80) , y=c(83, 82, 19))
q&lt;-fourPoint(p)
polygon(q,lty=2,lwd=2)
text(q,cex=2)
points(q[4,1],q[4,2],cex=6,col=2,lwd=2)
d&lt;-dist(q)
text(64,86,round(d[1],1),cex=1.5)
text(90,52,round(d[3],1),cex=1.5)
text(29,53,round(d[4],1),cex=1.5)
text(58,15,round(d[6],1),cex=1.5)
par(op)
# x11()
op &lt;-par(mar=c(2,2,4,2),cex=0.8)
# An irregular area, use 4 points with p&lt;-locator(4) and apply q&lt;-fourPoint(p) to form the matrix
terra::image(r,bty="l",main="An irregular area")
#p&lt;-locator(4)
p&lt;-list(x=c(40, 88, 80, 29) , y=c(83, 82, 19, 20))
q&lt;-fourPoint(p)
d&lt;-dist(q)
polygon(q)
text(64,86,round(d[1],1),cex=1.5)
text(90,52,round(d[3],1),cex=1.5)
text(29,53,round(d[4],1),cex=1.5)
text(56,15,round(d[6],1),cex=1.5)
nx&lt;-2;ny&lt;-3 
dy=d[3]/ny;dx=d[1]/nx
# EU area= dx*dy
out&lt;-imageField(r,q,ny,nx,dy,dx)
par(op) 
# number of pixels per EU
table(out$Qbase$EU)
</code></pre>


</div>