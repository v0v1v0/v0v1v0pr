<div class="container">

<table style="width: 100%;"><tr>
<td>step.lmRob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build a Model in a Stepwise Fashion</h2>

<h3>Description</h3>

<p>Performs stepwise model selection on a robustly fitted linear model.  Presently only the backward stepwise procedure is implemented.
</p>


<h3>Usage</h3>

<pre><code class="language-R">step.lmRob(object, scope, scale,
           direction = c("both", "backward", "forward"),
           trace = TRUE, keep = NULL, steps = 1000, fast = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <code>lmRob</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope</code></td>
<td>
<p>either a formula or a list with elements <code>lower</code> and <code>upper</code> each of which is a formula.  The terms in the right-hand-side of <code>lower</code> are always included in the model and the additional terms in the right-hand-side of <code>upper</code> are the candidates for inclusion/exclusion from the model.  If a single formula is given, it is taken to be <code>upper</code> and <code>lower</code> is set to the empty model.  The <code>.</code> operator is interpreted in the context of the formula in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a single numeric value containing a residual scale estimate.  If missing, the scale estimate in <code>object</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>a character value specifying the mode of stepwise search.  The possibilities are "both", "backward", and "forward", with a default of "backward".  Presently only "backward" stepwise searches are implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>a logical value.  If <code>TRUE</code>, information is printed during stepwise search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>a filter function whose input is a fitted model object and the associated AIC statistic, and whose output is arbitrary.  Typically keep will select a subset of the components of the object and return them.  The default is not to keep anything.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>an integer value specifying the the maximum number of steps to be considered.  The default is 1000 (essentially as many as required).  It is typically used to stop the process early.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>a logical value.  If <code>TRUE</code> the robust initial estimate (used when fitting each of the reduced models) is replaced by a weighted least squares estimate using the robust weights computed for the current fit.  Note: the fast algorithm does not work in this version of the Robust Library.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments required by the generic step function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Presently only backward stepwise selection is supported.  During each step the Robust Final Prediction Error (as computed by the function <code>lmRob.RFPE</code>) is calculated for the current model and for each sub-model achievable by deleting a single term.  The function then either steps to the sub-model with the lowest Robust Final Prediction Error or, if the current model has the lowest Robust Final Prediction Error, terminates.  The scale estimate from <code>object</code> is used to compute the Robust Final Prediction Error throughout the procedure unless the <code>scale</code> argument is provided in which case the user specified value is used.
</p>


<h3>Value</h3>

<p>the model with the lowest Robust Final Prediction Error encountered during the stepwise procedure is returned.  Additionally, an <code>anova</code> element corresponding to the steps taken in the search is appended to the returned object.  If a <code>keep</code> function was provided then the kept values can be found in the <code>keep</code> element of the returned object.
</p>


<h3>See Also</h3>

<p><code>lmRob</code>,
<code>lmRob.RFPE</code>,
<code>drop1.lmRob</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(stack.dat)
stack.rob &lt;- lmRob(Loss ~ ., data = stack.dat)

## The default behavior is to try dropping all terms ##
step.lmRob(stack.rob)

## Keep Water.Temp in the model ##
my.scope &lt;- list(lower = . ~ Water.Temp, upper = . ~ .)
step.lmRob(stack.rob, scope = my.scope)
</code></pre>


</div>