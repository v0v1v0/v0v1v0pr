<div class="container">

<table style="width: 100%;"><tr>
<td>update_z</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update class allocation vector</h2>

<h3>Description</h3>

<p>This function updates the class allocation vector (independently for all observations)
by drawing from its conditional distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">update_z(s, beta, b, Omega)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>The vector of class weights of length <code>C</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.
For identifiability, the vector must be non-ascending.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The matrix of the decision-maker specific coefficient vectors of dimension
<code>P_r</code> x <code>N</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>The matrix of class means as columns of dimension <code>P_r</code> x <code>C</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>The matrix of class covariance matrices as columns of dimension
<code>P_r*P_r</code> x <code>C</code>.
Set to <code>NA</code> if <code>P_r = 0</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">z = (z_1,\dots,z_N)</code> denote the class allocation vector of the observations (mixed coefficients) <code class="reqn">\beta = (\beta_1,\dots,\beta_N)</code>.
Independently for each <code class="reqn">n</code>, the conditional probability <code class="reqn">\Pr(z_n = c \mid s,\beta_n,b,\Omega)</code> of having <code class="reqn">\beta_n</code>
allocated to class <code class="reqn">c</code> for <code class="reqn">c=1,\dots,C</code> depends on the class allocation vector <code class="reqn">s</code>, the class means <code class="reqn">b=(b_c)_c</code> and the class covariance
matrices <code class="reqn">Omega=(Omega_c)_c</code> and is proportional to </p>
<p style="text-align: center;"><code class="reqn">s_c \phi(\beta_n \mid b_c,Omega_c).</code>
</p>



<h3>Value</h3>

<p>An updated class allocation vector.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### class weights for C = 2 classes
s &lt;- rdirichlet(c(1,1))
### coefficient vector for N = 1 decider and P_r = 2 random coefficients
beta &lt;- matrix(c(1,1), ncol = 1)
### class means and covariances
b &lt;- cbind(c(0,0),c(1,1))
Omega &lt;- cbind(c(1,0,0,1),c(1,0,0,1))
### updated class allocation vector
update_z(s = s, beta = beta, b = b, Omega = Omega)
</code></pre>


</div>