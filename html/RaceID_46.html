<div class="container">

<table style="width: 100%;"><tr>
<td>graphCluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for infering clustering of the pruned k nearest neighbour graph</h2>

<h3>Description</h3>

<p>This function derives a graph object from the pruned k nearest neighbours and infers clusters by modularity
optimizatio nusing the Louvain or the Leiden algorithm on this graph.
A Fruchterman-Rheingold graph layout is also derived from the pruned nearest neighbours.
</p>


<h3>Usage</h3>

<pre><code class="language-R">graphCluster(
  res,
  pvalue = 0.01,
  use.weights = TRUE,
  use.leiden = FALSE,
  leiden.resolution = 1,
  min.size = 2,
  rseed = 12345
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>List object with k nearest neighbour information returned by <code>pruneKnn</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>Positive real number between 0 and 1. All nearest neighbours with link probability <code>&lt; pvalue</code> are discarded. Default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.weights</code></td>
<td>
<p>logical. If TRUE, then nearest-neighbor link probabilities are used to build a graph as input for Louvain clustering. If FALSE, then all links have equal weight. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.leiden</code></td>
<td>
<p>logical. If TRUE, then the Leiden algorithm is used. If FALSE, the Louvain algorithm is used. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leiden.resolution</code></td>
<td>
<p>Positive real number. Resolution parameter for the Leiden algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.size</code></td>
<td>
<p>Positive integer number. Minimum cluster size. All clusters with less than <code>min.size</code> elements are aggregated into one cluster, to which the largest cluster number is assigned. See output value <code>residual.cluster</code>. Default value is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rseed</code></td>
<td>
<p>Integer number. Random seed to enforce reproducible clustering results. Default is 12345.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List object of three components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>partition</code></td>
<td>
<p> Vector with clustering partition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fr</code></td>
<td>
<p> Data.frame with Fruchterman-Rheingold graph layout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual.cluster</code></td>
<td>
<p> In case clusters with less than <code>min.size</code> elements occur in the cluster partition, these are grouped into a common cluster, to which the largest cluster number is assigned. If this grouping was done, the cluster number is given by this value. Otherwise, the value of this object is NULL.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">res &lt;- pruneKnn(intestinalDataSmall,knn=10,alpha=1,no_cores=1,FSelect=FALSE)
cl &lt;- graphCluster(res,pvalue=0.01)
</code></pre>


</div>