<div class="container">

<table style="width: 100%;"><tr>
<td>RobVar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RobVar</h2>

<h3>Description</h3>

<p>Robust estimate of the variance
</p>


<h3>Usage</h3>

<pre><code class="language-R">RobVar(X, c=2, alpha=0.75, model='Gaussian', methodMCM='Weiszfeld',
                methodMC='Robbins' , mc_sample_size=1000, init=rep(0, ncol(X)),
                init_cov=diag(ncol(X)),
                epsilon=10^(-8), w=2, df=3, niterMC=50,
                cgrad=2, niterWeisz=50, epsWeisz=10^-8, alphaMedian=0.75, cmedian=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric matrix of whose rows correspond to observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>A positive scalar giving the constant in the stepsequence of the Robbins-Monro or Gradient method if <code>methodMC='RobbinsMC'</code> or <code>methodMC='GradMC'</code>. Default is <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A scalar between 1/2 and 1 giving the power in the stepsequence for the Robbins-Monro algorithm is <code>methodMC='RobbinsMC'</code>. Default is <code>0.75</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A string character specifying the model: can be <code>'Gaussian'</code> (default), <code>'Student'</code> or <code>'Laplace'</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methodMCM</code></td>
<td>
<p>A string character specifying the method to estimate the Median Covariation Matrix. Can be <code>'Gmedian'</code> or <code>'Weiszfeld'</code> (defualt).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methodMC</code></td>
<td>
<p>A string character specifying the method to estimate robustly the variance. Can be <code>'Robbins'</code> (default), <code>'Fix'</code> or <code>'Grad'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc_sample_size</code></td>
<td>
<p>A positive integer giving the number of data simulated for the Monte-Carlo method. Default is <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A numeric vector giving the initialization for estimating the median.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_cov</code></td>
<td>
<p>A numeric matrix giving an initialization for estimating the Median Covariation Matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>A positive scalar giving a stoping condition for algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A positive integer specifying the power for the weighted averaged Robbins-Monro algorithm if <code>methodMC='RobbinsMC'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>An integer larger (or equal) than <code>3</code> specifying the degrees of freedom for the Student law if <code>model='Student'</code>. See also <code>Gen_MM</code>. Default is <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niterMC</code></td>
<td>
<p>An integer giving the number of iterations for iterative algorithms if the selected method is <code>'Grad'</code> or <code>'Fix'</code>. Default is <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cgrad</code></td>
<td>
<p>A numeric vector with positive values giving the stepsequence of the gradient algorithm for estimating the variance if <code>methodMC='Grad'</code>. Its length has to be equal to <code>niter</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niterWeisz</code></td>
<td>
<p>A positive integer giving the maximum number of iterations for the Weiszfeld algorithms if <code>methodMCM='Weiszfeld'</code>. Default is <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsWeisz</code></td>
<td>
<p>A stopping factor for the Weiszfeld algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaMedian</code></td>
<td>
<p>A scalar betwwen 1/2 and 1  giving the power of the stepsequence of the gradient algorithm for estimating the Median Covariation Matrix if <code>methodMCM='Gmedian'</code>. Default is <code>0.75</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmedian</code></td>
<td>
<p>A positive scalar giving the constant in the stepsequence of the gradient algorithm for estimating the Median Covariation Matrix if <code>methodMCM='Gmedian'</code>. Default is <code>2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>list</code> with the following outputs:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p>The median of <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>The robust variance of <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p>The Median Covariation Matrix of <code>X</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cardot, H., Cenac, P. and Zitt, P-A. (2013). Efficient and fast estimation of the geometric median in Hilbert spaces with an averaged stochastic gradient algorithm. <em>Bernoulli</em>, 19, 18-43.
</p>
<p>Cardot, H. and Godichon-Baggioni, A. (2017). Fast Estimation of the Median Covariation Matrix with Application to Online Robust Principal Components Analysis.  <em>Test</em>, 26(3), 461-480
</p>
<p>Vardi, Y. and Zhang, C.-H. (2000). The multivariate L1-median and associated data depth. <em>Proc. Natl. Acad. Sci. USA</em>, 97(4):1423-1426.
</p>


<h3>See Also</h3>

<p>See also <code>RobMM</code> and <code>Gen_MM</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 2000
d &lt;- 5
Sigma &lt;-diag(1:d)
mean &lt;- rep(0,d)
X &lt;- mvtnorm::rmvnorm(n,mean,Sigma)
RVar=RobVar(X)
</code></pre>


</div>