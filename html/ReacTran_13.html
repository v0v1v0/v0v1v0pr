<div class="container">

<table style="width: 100%;"><tr>
<td>setup.prop.1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Attaches a Property to a One-Dimensional Grid
</h2>

<h3>Description</h3>

<p>This routine calculates the value of a given property at the middle of
the grid cells (<code>mid</code>) and at the interfaces of the grid cells
(<code>int</code>).
</p>
<p>Two possibilities are available: either specifying a mathematical function
(<code>func</code>) that describes the spatial dependency of the property,
or obtaining the property from interpolation of a data series
(via the input of the data matrix <code>xy</code>).
</p>
<p>For example, in a sediment model, <code>setup.prop.1D</code> can be used to
specify the porosity, the mixing intensity or some other parameter over
the one-dimensional grid. Similarly, in a vertical water column model, <code>setup.prop.1D</code> can be
used to specify the sinking velocity of particles or other model parameters
changing with water depth.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setup.prop.1D(func = NULL, value = NULL, xy = NULL,
              interpolate = "spline", grid, ...)

## S3 method for class 'prop.1D'
plot(x, grid, xyswap = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>func </code></td>
<td>
<p>function that describes the spatial dependency. For example, one can use the functions provided in <code>p.exp</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value </code></td>
<td>
<p>constant value given to the property (no spatial dependency)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy </code></td>
<td>
<p>a two-column data matrix where the first column (<code>x</code>) provides
the position, and the second column (<code>y</code>) provides the values that
needs interpolation over the grid
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate </code></td>
<td>
<p>specifies how the interpolation should be done, one
of "spline" or "linear"; only used when <code>xy</code> is present
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid </code></td>
<td>
<p>list specifying the 1D grid characteristics, see
<code>setup.grid.1D</code> for details on the structure of this list
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>the object of class <code>prop.1D</code> that needs plotting
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyswap </code></td>
<td>
<p>if <code>TRUE</code>, then x- and y-values are swapped and
the y-axis is oriented from top to bottom. Useful for drawing
vertical depth profiles
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>
<p>additional arguments that are passed on to <code>func</code> or
to the S3 method
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are two options to carry out the data interpolation:
</p>

<ul>
<li>
<p> "spline" gives a smooth profile, but sometimes generates
strange profiles - always check the result!
</p>
</li>
<li>
<p> "linear" gives a segmented profile
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list of type <code>prop.1D</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mid </code></td>
<td>
<p>property value in the middle of the grid cells; vector of
length N (where N is the number of grid cells)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int </code></td>
<td>
<p>property value at the interface of the grid cells;
vector of length N+1
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;,
Filip Meysman &lt;filip.meysman@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code>tran.1D</code>, for a discretisation of the general transport equation in 1-D
</p>
<p><code>setup.grid.1D</code>, the creation of grids in 1-D
</p>
<p><code>setup.prop.2D</code> for defining properties on 2-D grids.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Construction of the 1D grid 

grid &lt;- setup.grid.1D(x.up = 0, L = 10, N = 10)

# Porosity profile via function specification

P.prof &lt;- setup.prop.1D(func = p.exp, grid = grid, y.0 = 0.9,
                        y.inf = 0.5, x.att = 3)

# Porosity profile via data series interpolation

P.data &lt;- matrix(ncol = 2, data = c(0,3,6,10,0.9,0.65,0.55,0.5))
P.spline &lt;- setup.prop.1D(xy = P.data, grid = grid)
P.linear &lt;- setup.prop.1D(xy = P.data, grid = grid, interpolate = "linear")

# Plot different profiles 

plot(P.prof, grid = grid, type = "l",
     main = "setup.prop, function evaluation")
points(P.data, cex = 1.5, pch = 16) 
lines(grid$x.int, P.spline$int, lty = "dashed")
lines(grid$x.int, P.linear$int, lty = "dotdash")
</code></pre>


</div>