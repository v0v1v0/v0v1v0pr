<div class="container">

<table style="width: 100%;"><tr>
<td>saveDatasheet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Save Datasheet(s)</h2>

<h3>Description</h3>

<p>Saves Datasheets to a <code>SsimLibrary</code>, <code>Project</code>, or
<code>Scenario</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">saveDatasheet(
  ssimObject,
  data,
  name = NULL,
  fileData = NULL,
  append = NULL,
  forceElements = FALSE,
  force = FALSE,
  breakpoint = FALSE,
  import = TRUE,
  path = NULL
)

## S4 method for signature 'character'
saveDatasheet(
  ssimObject,
  data,
  name = NULL,
  fileData = NULL,
  append = NULL,
  forceElements = FALSE,
  force = FALSE,
  breakpoint = FALSE,
  import = TRUE,
  path = NULL
)

## S4 method for signature 'SsimObject'
saveDatasheet(
  ssimObject,
  data,
  name = NULL,
  fileData = NULL,
  append = NULL,
  forceElements = FALSE,
  force = FALSE,
  breakpoint = FALSE,
  import = TRUE,
  path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ssimObject</code></td>
<td>
<p><code>SsimLibrary</code>, <code>Project</code>, or
<code>Scenario</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame, named vector, or list of these. One or more
Datasheets to load</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character or vector of these. The name(s) of the Datasheet(s) to
be saved. If a vector of names is provided, then a list must be provided
for the <code>data</code> argument. Names provided here will override those provided
with <code>data</code> argument's list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileData</code></td>
<td>
<p>named list or SpatRaster object. Names are file names (without paths),
corresponding to entries in <code>data</code> The elements are objects containing the
data associated with each name. Currently supports terra SpatRaster objects as elements,
(support for Raster objects is deprecated)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical. If <code>TRUE</code>, the incoming data will be appended to the
Datasheet if possible.  Default is <code>TRUE</code> for Project/SsimLibrary-scope Datasheets,
and <code>FALSE</code> for Scenario-scope Datasheets. See 'details' for more information
about this argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forceElements</code></td>
<td>
<p>logical. If <code>FALSE</code> (default) a single return message will
be returned as a character string. Otherwise it will be returned in a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>logical. If Datasheet scope is Project/SsimLibrary, and <code>append=FALSE</code>,
Datasheet will be deleted before loading the new data. This can also delete
other definitions and results, so if <code>force=FALSE</code> (default) user will be
prompted for approval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breakpoint</code></td>
<td>
<p>logical. Set to <code>TRUE</code> when modifying Datasheets in a
breakpoint function. Default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>import</code></td>
<td>
<p>logical. Set to <code>TRUE</code> to import the data after saving.
Default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>character.  output path (optional)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>SsimObject/Project/Scenario should identify a single SsimObject.
</p>
<p>If <code>fileData != NULL</code>, each element of <code>names(fileData)</code> should correspond uniquely
to at most one entry in data. If a name is not found in data the element will
be ignored with a warning. If <code>names(fileData)</code> are full filepaths, rsyncrosim
will write each object to the corresponding path for subsequent loading by SyncroSim.
Note this is generally more time-consuming because the files must be written twice.
If <code>names(fileData)</code> are not filepaths (faster, recommended), rsyncrosim will
write each element directly to the appropriate SyncroSim input/output folders.
rsyncrosim will write each element of fileData directly to the appropriate
SyncroSim input/output folders. If <code>fileData != NULL</code>, data should be a data.frame,
vector, or list of length 1, not a list of length &gt;1.
</p>
<p>About the 'append' argument:
</p>

<ul>
<li>
<p> A Datasheet is a VALIDATION SOURCE if its data can be used to validate
column values in a different Datasheet.
</p>
</li>
<li>
<p> The <code>append</code> argument will be ignored if the Datasheet is a validation
source and has a Project scope.  In this case the data will be MERGED.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Invisibly returns a vector or list of logical values for each
input: <code>TRUE</code> upon success (i.e.successful save) and <code>FALSE</code> upon failure.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Specify file path and name of new SsimLibrary
myLibraryName &lt;- file.path(tempdir(), "testlib")

# Set the SyncroSim Session, SsimLibrary, Project, and Scenario
mySession &lt;- session()
myLibrary &lt;- ssimLibrary(name = myLibraryName,
                         session = mySession,
                         packages = "helloworldSpatial")
myProject &lt;- project(myLibrary, project = "Definitions")
myScenario &lt;- scenario(myProject, scenario = "My Scenario")

# Get all Datasheet info
myDatasheets &lt;- datasheet(myScenario)

# Get a specific Datasheet
myDatasheet &lt;- datasheet(myScenario, name = "helloworldSpatial_RunControl")

# Modify Datasheet
myDatasheet$MaximumTimestep &lt;- 10

# Save Datasheet
saveDatasheet(ssimObject = myScenario, 
              data = myDatasheet, 
              name = "helloworldSpatial_RunControl")
          
# Import data after saving
saveDatasheet(ssimObject = myScenario, 
              data = myDatasheet, 
              name = "helloworldSpatial_RunControl",
              import = TRUE)
        
# Save the new Datasheet to a specified output path
saveDatasheet(ssimObject = myScenario, 
              data = myDatasheet, 
              name = "helloworldSpatial_RunControl",
              path = tempdir())
              
# Save a raster stack using fileData
# Create a raster stack - add as many raster files as you want here
map1 &lt;- datasheetSpatRaster(myScenario, 
                            datasheet = "helloworldSpatial_InputDatasheet",
                            column = "InterceptRasterFile")
inRasters &lt;- terra::rast(map1)

# Change the name of the rasters in the input Datasheets to match the stack
inSheet &lt;- datasheet(myScenario, name = "helloworldSpatial_InputDatasheet")
inSheet[1,"InterceptRasterFile"] &lt;- names(inRasters)[1]

# Save the raster stack to the input Datasheet
saveDatasheet(myScenario, data = inSheet, 
              name = "helloworldSpatial_InputDatasheet", 
              fileData = inRasters)

## End(Not run)

</code></pre>


</div>