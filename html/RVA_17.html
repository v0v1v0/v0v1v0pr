<div class="container">

<table style="width: 100%;"><tr>
<td>plot_heatmap.expr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Heatmap From Raw CPM</h2>

<h3>Description</h3>

<p>Create a heatmap with either CFB or CPM averaged across
individual samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_heatmap.expr(
  data = ~count,
  annot = ~meta,
  sample.id = "sample_id",
  annot.flags = c("day", "Treatment", "tissue"),
  ct.table.id.type = "ENSEMBL",
  gene.id.type = "SYMBOL",
  gene.names = NULL,
  gene.count = 10,
  title = "RVA Heatmap",
  fill = "CFB",
  baseline.flag = "day",
  baseline.val = "0",
  plot.save.to = NULL,
  input.type = "count"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A wide-format dataframe with geneid rownames, sample column
names, and fill data matching <code>input.type</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annot</code></td>
<td>
<p>A long-format dataframe with any pertinent treatment data about
the samples. The only required column is one titled the <code>sample.id</code>
value with values matching the column names of sample IDs in <code>data</code>.
Additional columns can contain information such as treament
compounds, dates of sample collection, or dosage quantities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.id</code></td>
<td>
<p>The column name to specify sample ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annot.flags</code></td>
<td>
<p>A vector of column names corresponding to column names
in <code>annot</code> which will be used to define the x-axis for the heatmap.
Default = <code>c("day", "dose")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ct.table.id.type</code></td>
<td>
<p>The gene id format in <code>data</code> should be one of:
ACCNUM, ALIAS, ENSEMBL, ENSEMBLPROT, ENSEMBLTRANS,
ENTREZID, ENZYME, EVIDENCE, EVIDENCEALL, GENENAME, GO, GOALL, IPI,
MAP, OMIM, ONTOLOGY, ONTOLOGYALL, PATH, PFAM, PMID, PROSITE, REFSEQ,
SYMBOL, UCSCKG, UNIGENE, UNIPROT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.id.type</code></td>
<td>
<p>The gene id format of <code>gene.names</code>, should be one of:
ACCNUM, ALIAS, ENSEMBL, ENSEMBLPROT, ENSEMBLTRANS,
ENTREZID, ENZYME, EVIDENCE, EVIDENCEALL, GENENAME, GO, GOALL, IPI,
MAP, OMIM, ONTOLOGY, ONTOLOGYALL, PATH, PFAM, PMID, PROSITE, REFSEQ,
SYMBOL, UCSCKG, UNIGENE, UNIPROT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.names</code></td>
<td>
<p>A character vector or list of ensembl IDs for which to
display gene information. If <code>NULL</code>, all genes will be included.
Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.count</code></td>
<td>
<p>The number of genes to include, where genes are selected
based on ranking by values in <code>fill</code>. Default = 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>A title for the heatmap. Default = "RVA Heatmap".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>One of <code>c("CPM", "CFB")</code> to fill the heatmap cells with.
Default = "CFB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline.flag</code></td>
<td>
<p>A character vector of column names. If <code>fill = "CFB"</code>,
these columns in <code>annot</code> contain the values to compare
across. Ignored if <code>fill = "CPM"</code>. Default = "timepoint".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline.val</code></td>
<td>
<p>A character vector of values. This vector must be the
same length as <code>baseline.flag</code>, and the value at each index must
represent a value from the column given by the corresponding index
in <code>baseline.flag</code>. The samples corresponding to these values will
be used as a baseline when calculating CFB. Ignored if
<code>fill = "CPM"</code>. Default = "Week 0".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.save.to</code></td>
<td>
<p>The address to save the heatmap plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input.type</code></td>
<td>
<p>One of <code>count</code> or <code>cpm</code> indicating what the input data type
is. If <code>count</code>, the CPM of the input data will be calculated using
<code>edgeR::cpm()</code>. Default = <code>count</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function takes raw CPM data and returns both a list containing a data frame
with values based on the fill parameter and a heatmap plot.
</p>


<h3>Value</h3>

<p>The function returns a list with 2 items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>df.sub</code></td>
<td>
<p>"A data frame of change from baselines values (fill = CFB in this example) for each gene id that is divided by a combination of treatment group and time point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp</code></td>
<td>
<p>A Heatmap object from ComplexHeatmap which can be plotted</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Xingpeng Li,Tatiana Gelaf Romer &amp; Aliyah Olaniyan, RVA - RNAseq Visualization Automation tool.
</p>


<h3>Examples</h3>

<pre><code class="language-R">plot &lt;- plot_heatmap.expr(data = count_table[,1:20],annot = sample_annotation[1:20,])
</code></pre>


</div>