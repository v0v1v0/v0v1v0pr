<div class="container">

<table style="width: 100%;"><tr>
<td>p.regression.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probabilities of Record Regression Test</h2>

<h3>Description</h3>

<p>This function performs a linear hypothesis test based on a
regression for the record probabilities <code class="reqn">p_t</code> to study the hypothesis
of the classical record model (i.e., of IID continuous RVs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.regression.test(
  X,
  record = c("upper", "lower"),
  formula = y ~ x,
  simulate.p.value = FALSE,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector, matrix (or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>record</code></td>
<td>
<p>A character string indicating the type of records to be 
calculated, "upper" or "lower".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>"<code>formula</code>" to use in <code>lm</code> function, 
e.g., <code>y ~ x</code>, <code>y ~ poly(x, 2, raw = TRUE)</code>, <code>y ~ log(x)</code>.
By default <code>formula = y ~ x</code>. See Note for a caveat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate.p.value</code></td>
<td>
<p>Logical. Indicates whether to compute p-values by
Monte Carlo simulation. It is recommended if the number of columns of
<code>X</code> (i.e., the number of series) is equal or lower than 10, since 
for low values the size of the test is not fulfilled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>If <code>simulate.p.value = TRUE</code>, an integer specifying the 
number of replicates used in the Monte Carlo estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null hypothesis is that the data come from a population with 
independent and identically distributed realisations. This implies that
in all the vectors (columns in matrix <code>X</code>), the sample probability 
of record at time <code class="reqn">t</code> (<code>p.record</code>) is <code class="reqn">1/t</code>, so that
</p>
<p style="text-align: center;"><code class="reqn">t \, \textrm{E}(\hat p_t) = 1.</code>
</p>
 
<p>Then, 
</p>
<p style="text-align: center;"><code class="reqn">H_0:\,p_t = 1/t, \, t=2, ..., T \iff H_0:\,\beta_0 = 1, \, \beta_1 = 0,</code>
</p>
 
<p>where <code class="reqn">\beta_0</code> and <code class="reqn">\beta_1</code> are the coefficients of the 
regression model 
</p>
<p style="text-align: center;"><code class="reqn">t \, \textrm{E}(\hat p_t) = \beta_0 + \beta_1 t.</code>
</p>
 
<p>The  model has to be estimated by weighted least squares since the 
response is heteroskedastic.
</p>
<p>Other models can be considered with the <code>formula</code> argument. 
However, for the test to be correct, the model must leave the intercept 
free or fix it to 1 (see Examples for possible models).
</p>
<p>The <code class="reqn">F</code> statistic is computed for carrying out a
comparison between the restricted model under the null hypothesis and
the more general model (e.g., the alterantive hypothesis where 
<code class="reqn">t \, \textrm{E}(\hat p_t)</code> is a linear function of time <code class="reqn">t</code>). 
This alternative hypothesis may be reasonable in many real examples, 
but not always.
</p>
<p>If the sample size (i.e., the number of series or columns of <code>X</code>)
is lower than 8 or 12 the <code>simulate.p.value</code> option is recommended.
</p>


<h3>Value</h3>

<p>A <code>"htest"</code> object with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>Value of the coefficients under the null hypothesis
when more than one coefficient is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Character string indicating the type of alternative
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the type of test performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>Value of the fitted coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Value of the <code class="reqn">F</code> statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>Degrees of freedom of the <code class="reqn">F</code> statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>IMPORTANT: In <code>formula</code> the intercept has to be free or fixed
to 1 so that the test is correct.
</p>


<h3>Author(s)</h3>

<p>Jorge Castillo-Mateo
</p>


<h3>References</h3>

<p>Castillo-Mateo J, Cebrián AC, Asín J (2023).
“<strong>RecordTest</strong>: An <code>R</code> Package to Analyze Non-Stationarity in the Extremes Based on Record-Breaking Events.”
<em>Journal of Statistical Software</em>, <strong>106</strong>(5), 1-28. 
<a href="https://doi.org/10.18637/jss.v106.i05">doi:10.18637/jss.v106.i05</a>.
</p>


<h3>See Also</h3>

<p><code>p.chisq.test</code>, <code>p.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simple test for upper records (p-value = 0.01202)
p.regression.test(ZaragozaSeries)
# Simple test for lower records (p-value = 0.006175)
p.regression.test(ZaragozaSeries, record = "lower")

# Fit a 2nd term polynomial for upper records (p-value = 0.0003933)
p.regression.test(ZaragozaSeries, formula = y ~ I(x^2))
# Fit a 2nd term polynomial for lower records (p-value = 0.005108)
p.regression.test(ZaragozaSeries, record = "lower", formula = y ~ I(x^2))

# Fix the intercept to 1 for upper records (p-value = 0.01416)
p.regression.test(ZaragozaSeries, formula = y ~ I(x-1) - 1 + offset(rep(1, length(x))))
# Fix the intercept to 1 for lower records (p-value = 0.00138)
p.regression.test(ZaragozaSeries, record = "lower", 
  formula = y ~ I(x-1) - 1 + offset(rep(1, length(x))))

# Simulate p-value when the number of series is small
TxZ &lt;- apply(series_split(TX_Zaragoza$TX), 1, max, na.rm = TRUE)
p.regression.test(TxZ, simulate.p.value = TRUE)
</code></pre>


</div>