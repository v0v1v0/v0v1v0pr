<div class="container">

<table style="width: 100%;"><tr>
<td>robpca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
ROBust PCA algorithm
</h2>

<h3>Description</h3>

<p>ROBPCA algorithm of Hubert et al. (2005) including reweighting (Engelen et al., 2005) and possible extension to skewed data (Hubert et al., 2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">robpca (x, k = 0, kmax = 10, alpha = 0.75, h = NULL, mcd = FALSE, 
        ndir = "all", skew = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">p</code> matrix or data matrix with observations in the rows and variables in the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of principal components that will be used. When <code>k=0</code> (default), the number of components is selected using the criterion in Hubert et al. (2005).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>
<p>Maximal number of principal components that will be computed, default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Robustness parameter, default is 0.75.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>The number of outliers the algorithm should resist is given by <code class="reqn">n-h</code>. Any value for <code>h</code> between <code class="reqn">n/2</code> and <code class="reqn">n</code> may be specified. Default is <code>NULL</code> which uses <code>h=ceiling(alpha*n)+1</code>. Do not specify <code>alpha</code> and <code>h</code> at the same time. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcd</code></td>
<td>
<p>Logical indicating if the MCD adaptation of ROBPCA may be applied when the number of variables is sufficiently small (see Details). If <code>mcd=FALSE</code> (default), the full ROBPCA algorithm is always applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndir</code></td>
<td>
<p>Number of directions used when computing the outlyingness (or the adjusted outlyingness when <code>skew=TRUE</code>), see <code>outlyingness</code> and <code>adjOutl</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew</code></td>
<td>
<p>Logical indicating if the version for skewed data (Hubert et al., 2009) is applied, default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to pass to methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is based extensively on <code>PcaHubert</code> from <span class="pkg">rrcov</span> and there are two main differences: 
</p>
<p>The outlyingness measure that is used for non-skewed data (<code>skew=FALSE</code>) is the Stahel-Donoho measure as described in Hubert et al. (2005) which is also used in <code>PcaHubert</code>. The implementation in <span class="pkg">mrfDepth</span> (which is used here) is however much faster than the one in <code>PcaHubert</code> and hence more, or even all, directions can be considered when computing the outlyingness measure.
</p>
<p>Moreover, the extension for skewed data of Hubert et al. (2009) (<code>skew=TRUE</code>) is also implemented here, but this is not included in <code>PcaHubert</code>. 
</p>
<p>For an extensive description of the ROBPCA algorithm we refer to Hubert et al. (2005) and to <code>PcaHubert</code>.
</p>
<p>When <code>mcd=TRUE</code> and <code class="reqn">n&lt;5 \times p</code>, we do not apply the full ROBPCA algorithm. The loadings and eigenvalues
are then computed as the eigenvectors and eigenvalues of the MCD estimator applied to the data set after the SVD step.
</p>


<h3>Value</h3>

<p>A list with components:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>Loadings matrix containing the robust loadings (eigenvectors), a numeric matrix of size <code class="reqn">p</code> by <code class="reqn">k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvalues</code></td>
<td>
<p>Numeric vector of length <code class="reqn">k</code> containing the robust eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Scores matrix (computed as <code class="reqn">(X-center) \cdot loadings)</code>, a numeric matrix of size <code class="reqn">n</code> by <code class="reqn">k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Numeric vector of length <code class="reqn">k</code> containing the centre of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of (chosen) principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0</code></td>
<td>
<p>Logical vector of size <code class="reqn">n</code> indicating if an observation is in the initial h-subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H1</code></td>
<td>
<p>Logical vector of size <code class="reqn">n</code> indicating if an observation is kept in the reweighting step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The robustness parameter <code class="reqn">\alpha</code> used throughout the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>The <code class="reqn">h</code>-parameter used throughout the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Numeric vector of size <code class="reqn">n</code> containing the robust score distances within the robust PCA subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>od</code></td>
<td>
<p>Numeric vector of size <code class="reqn">n</code> containing the orthogonal distances to the robust PCA subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.sd</code></td>
<td>
<p>Cut-off value for the robust score distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.od</code></td>
<td>
<p>Cut-off value for the orthogonal distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag.sd</code></td>
<td>
<p>Numeric vector of size <code class="reqn">n</code> containing the SD-flags of the observations. The observations whose score distance is larger than <code>cutoff.sd</code> receive an SD-flag equal to zero. The other observations receive an SD-flag equal to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag.od</code></td>
<td>
<p>Numeric vector of size <code class="reqn">n</code> containing the OD-flags of the observations. The observations whose orthogonal distance is larger than <code>cutoff.od</code> receive an OD-flag equal to zero. The other observations receive an OD-flag equal to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag.all</code></td>
<td>
<p>Numeric vector of size <code class="reqn">n</code> containing the flags of the observations. The observations whose score distance is larger than  <code>cutoff.sd</code> or whose orthogonal distance is 
larger than  <code>cutoff.od</code> can be considered as outliers and receive a flag equal to zero. 
The regular observations receive flag 1.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tom Reynkens, based on R code from Valentin Todorov for <code>PcaHubert</code> in <span class="pkg">rrcov</span> (released under GPL-3) and Matlab code from Katrien Van Driessen (for the univariate MCD).
</p>


<h3>References</h3>

<p>Hubert, M., Rousseeuw, P. J., and Vanden Branden, K. (2005), “ROBPCA: A New Approach to Robust Principal Component Analysis,” <em>Technometrics</em>, 47, 64–79.
</p>
<p>Engelen, S., Hubert, M. and Vanden Branden, K. (2005), “A Comparison of Three Procedures for Robust PCA in
High Dimensions", <em>Austrian Journal of Statistics</em>, 34, 117–126.
</p>
<p>Hubert, M., Rousseeuw, P. J., and Verdonck, T. (2009), “Robust PCA for Skewed Data and Its Outlier Map," <em>Computational Statistics &amp; Data Analysis</em>, 53, 2264–2274.
</p>


<h3>See Also</h3>

<p><code>PcaHubert</code>, <code>outlyingness</code>, <code>adjOutl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">X &lt;- dataGen(m=1, n=100, p=10, eps=0.2, bLength=4)$data[[1]]

resR &lt;- robpca(X, k=2)
diagPlot(resR)
</code></pre>


</div>