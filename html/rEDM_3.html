<div class="container">

<table style="width: 100%;"><tr>
<td>CCM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convergent cross mapping using simplex projection</h2>

<h3>Description</h3>

<p>The state-space of a multivariate dynamical system (not a purely
stochastic one) encodes coherent phase-space variable trajectories. If
enough information is available, one can infer the presence or absence
of cross-variable interactions associated with causal links between
variables. <code>CCM</code> measures the extent to which states of
variable Y can reliably estimate states of variable X. This can happen
if X is causally influencing Y. 
</p>
<p>If cross-variable state predictability converges as more state-space
information is provided, this indicates a causal link. <code>CCM</code>
performs this cross-variable mapping using Simplex, with convergence
assessed across a range of observational library sizes as described in
<cite>Sugihara et al. 2012</cite>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CCM(pathIn = "./", dataFile = "", dataFrame = NULL,
  E = 0, Tp = 0, knn = 0, tau = -1,
  exclusionRadius = 0, columns = "", target = "", libSizes = "",
  sample = 0, random = TRUE, seed = 0, 
  embedded = FALSE, includeData = FALSE, parameterList = FALSE,
  verbose = FALSE, showPlot = FALSE, noTime = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>embedding dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to E+1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>column name used for prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>libSizes</code></td>
<td>
<p>string of 3 whitespace separated integer values
specifying the intial library size, the final library size,
and the library size increment. Can also be a list of strictly
increasing library sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>integer specifying the number of random samples to draw at
each library size evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>logical to specify random (<code>TRUE</code>) or sequential
library sampling. Note <code>random = FALSE</code> is not convergent
cross mapping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>integer specifying the random sampler seed.  If
<code>seed=0</code> then a random seed is generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>includeData</code></td>
<td>
<p>logical to include statistics and predictions for
every prediction in the ensemble.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterList</code></td>
<td>
<p>logical to add list of invoked parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>CCM</code> computes the X:Y and Y:X cross-mappings in parallel
using threads. 
</p>


<h3>Value</h3>

<p>A data.frame with 3 columns. The first column is <code>LibSize</code>
specifying the subsampled library size.  Columns 2 and 3 report
Pearson correlation coefficients for the prediction of X from Y, and
Y from X.
</p>
<p>if <code>includeData = TRUE</code> a named list with the following data.frames
data.frame <code>Combo_rho</code> columns:
</p>

<table>
<tr>
<td style="text-align: left;">
      LibMeans</td>
<td style="text-align: left;"> CCM mean correlations for each library size</td>
</tr>
<tr>
<td style="text-align: left;">
      CCM1_PredictStat</td>
<td style="text-align: left;"> Forward cross map prediction statistics</td>
</tr>
<tr>
<td style="text-align: left;">
      CCM1_Predictions</td>
<td style="text-align: left;"> Forward cross map prediction values</td>
</tr>
<tr>
<td style="text-align: left;">
      CCM2_PredictStat</td>
<td style="text-align: left;"> Reverse cross map prediction statistics</td>
</tr>
<tr>
<td style="text-align: left;">
      CCM2_Predictions</td>
<td style="text-align: left;"> Reverse cross map prediction values</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>If <code>includeData = TRUE</code> and <code>parameterList = TRUE</code> a
named list "parameters" is added.
</p>


<h3>References</h3>

<p>Sugihara G., May R., Ye H., Hsieh C., Deyle E., Fogarty M., Munch S., 2012. Detecting Causality in Complex Ecosystems. Science 338:496-500.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sardine_anchovy_sst)
df = CCM( dataFrame = sardine_anchovy_sst, E = 3, Tp = 0, columns = "anchovy",
target = "np_sst", libSizes = "10 70 10", sample = 100 )

</code></pre>


</div>