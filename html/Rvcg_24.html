<div class="container">

<table style="width: 100%;"><tr>
<td>vcgClostKD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Project coordinates onto a target triangular surface mesh using KD-tree search</h2>

<h3>Description</h3>

<p>For a set of 3D-coordinates/triangular mesh, the closest matches on a
target surface are determined (by using KD-tree search) and normals at as well as distances to
that point are calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcgClostKD(
  x,
  mesh,
  sign = TRUE,
  barycentric = FALSE,
  smoothNormals = FALSE,
  borderchk = FALSE,
  k = 50,
  nofPoints = 16,
  maxDepth = 64,
  angdev = NULL,
  weightnorm = FALSE,
  facenormals = FALSE,
  threads = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>k x 3 matrix containing 3D-coordinates or object of class "mesh3d".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mesh</code></td>
<td>
<p>triangular surface mesh stored as object of class "mesh3d".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign</code></td>
<td>
<p>logical: if TRUE, signed distances are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barycentric</code></td>
<td>
<p>logical: if TRUE, barycentric coordinates of the hit
points are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothNormals</code></td>
<td>
<p>logical: if TRUE, laplacian smoothed normals are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>borderchk</code></td>
<td>
<p>logical: request checking if the hit face is at the border of the mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer: check the kdtree for the<code>k</code> closest faces (using faces' barycenters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nofPoints</code></td>
<td>
<p>integer: number of points per cell in the kd-tree (don't change unless you know what you are doing!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxDepth</code></td>
<td>
<p>integer: depth of the kd-tree (don't change unless you know what you are doing!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angdev</code></td>
<td>
<p>maximum deviation between reference and target normals. If the none of the k closest triangles match this criterion, the closest point on the closest triangle is returned but the corresponding distance in $quality is set to 1e5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightnorm</code></td>
<td>
<p>logical if angdev is set, this requests the normal of the closest points to be estimated by weighting the surrounding vertex normals. Otherwise, simply the hit face's normal is used (faster but slightly less accurate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facenormals</code></td>
<td>
<p>logical: if TRUE only the facenormal of the face the closest point has hit is returned, the weighted average of the surrounding vertex normals otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>integer: threads to use in closest point search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters, currently unused.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>returns an object of class "mesh3d" with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>vb </code></td>
<td>
<p>4 x n matrix containing n vertices as homolougous coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normals </code></td>
<td>
<p>4 x n matrix containing vertex normals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quality </code></td>
<td>
<p>numeric vector containing distances to target.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it </code></td>
<td>
<p>3 x m integer matrix containing vertex indices forming triangular
faces.Only available, when x is a mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border </code></td>
<td>
<p>integer vector of length n: if borderchk = TRUE, for each clostest point the value will be 1 if the hit face is at the border of the target mesh and 0 otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barycoords </code></td>
<td>
<p>3 x m Matrix containing barycentric coordinates of
closest points; only available if barycentric=TRUE.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Other than <code>vcgClost</code> this does not search a grid, but first uses a KD-tree search to find the <code>k</code> closest barycenters for each point and then searches these faces for the closest match.
</p>


<h3>Author(s)</h3>

<p>Stefan Schlager
</p>


<h3>References</h3>

<p>Baerentzen, Jakob Andreas. &amp; Aanaes, H., 2002. Generating Signed
Distance Fields From Triangle Meshes. Informatics and Mathematical
Modelling.
</p>


<h3>See Also</h3>

<p><code>vcgPlyRead</code>
</p>


</div>