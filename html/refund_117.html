<div class="container">

<table style="width: 100%;"><tr>
<td>vis.fgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualization of FGAM objects</h2>

<h3>Description</h3>

<p>Produces perspective or contour plot views of an estimated surface corresponding to <code>{af}</code>
terms fit using <code>{fgam}</code> or plots “slices” of the estimated surface or estimated
second derivative surface with one of its arguments fixed and corresponding twice-standard error
“Bayesian” confidence bands constructed using the method in Marra and Wood (2012).  See the details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vis.fgam(
  object,
  af.term,
  xval = NULL,
  tval = NULL,
  deriv2 = FALSE,
  theta = 50,
  plot.type = "persp",
  ticktype = "detailed",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <code>fgam</code> object, produced by <code>{fgam}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>af.term</code></td>
<td>
<p>character; the name of the functional predictor to be plotted.  Only important
if multiple <code>af</code> terms are fit.  Defaults to the first <code>af</code> term in <code>object$call</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xval</code></td>
<td>
<p>a number in the range of functional predictor to be plotted.  The surface will be plotted
with the first argument of the estimated surface fixed at this value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tval</code></td>
<td>
<p>a number in the domain of the functional predictor to be plotted.  The surface will be
plotted with the second argument of the estimated surface fixed at this value. Ignored if <code>xval</code>
is specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv2</code></td>
<td>
<p>logical; if <code>TRUE</code>, plot the estimated second derivative surface along with
Bayesian confidence bands.  Only implemented for the "slices" plot from either <code>xval</code> or
<code>tval</code> being specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric; viewing angle; see <code>{persp}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p>one of <code>"contour"</code> (to use <code>{levelplot}</code>) or <code>"persp"</code>
(to use <code>{persp}</code>).  Ignored if either <code>xval</code> or <code>tval</code> is specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticktype</code></td>
<td>
<p>how to draw the tick marks if <code>plot.type="persp"</code>.  Defaults to <code>"detailed"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other options to be passed to <code>{persp}</code>, <code>{levelplot}</code>, or
<code>{plot}</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The confidence bands used when plotting slices of the estimated surface or second derivative
surface are the ones proposed in Marra and Wood (2012).  These are a generalization of the "Bayesian"
intervals of Wahba (1983) with an adjustment for the uncertainty about the model intercept. The
estimated covariance matrix of the model parameters is obtained from assuming a particular Bayesian
model on the parameters.
</p>


<h3>Value</h3>

<p>Simply produces a plot
</p>


<h3>Author(s)</h3>

<p>Mathew W. McLean <a href="mailto:mathew.w.mclean@gmail.com">mathew.w.mclean@gmail.com</a>
</p>


<h3>References</h3>

<p>McLean, M. W., Hooker, G., Staicu, A.-M., Scheipl, F., and Ruppert, D. (2014). Functional
generalized additive models. <em>Journal of Computational and Graphical Statistics</em>, <b>23(1)</b>,
pp. 249-269.
</p>
<p>Marra, G., and Wood, S. N. (2012) Coverage properties of confidence intervals for generalized
additive model components. <em>Scandinavian Journal of Statistics</em>, <b>39(1)</b>, pp. 53–74.
</p>
<p>Wabha, G. (1983) "Confidence intervals" for the cross-validated smoothing spline. <em>Journal of the
Royal Statistical Society, Series B</em>, <b>45(1)</b>, pp. 133–150.
</p>


<h3>See Also</h3>

<p><code>{vis.gam}</code>, <code>{plot.gam}</code>, <code>{fgam}</code>, <code>{persp}</code>,
<code>{levelplot}</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">################# DTI Example #####################
data(DTI)

## only consider first visit and cases (since no PASAT scores for controls)
y &lt;- DTI$pasat[DTI$visit==1 &amp; DTI$case==1]
X &lt;- DTI$cca[DTI$visit==1 &amp; DTI$case==1,]

## remove samples containing missing data
ind &lt;- rowSums(is.na(X))&gt;0

y &lt;- y[!ind]
X &lt;- X[!ind,]

## fit the fgam using FA measurements along corpus
## callosum as functional predictor with PASAT as response
## using 8 cubic B-splines for each marginal bases with
## third order marginal difference penalties
## specifying gamma&gt;1 enforces more smoothing when using GCV
## to choose smoothing parameters
#fit &lt;- fgam(y~af(X,splinepars=list(k=c(8,8),m=list(c(2,3),c(2,3)))),gamma=1.2)

## contour plot of the fitted surface
#vis.fgam(fit,plot.type='contour')

## similar to Figure 5 from McLean et al.
## Bands seem too conservative in some cases
#xval &lt;- runif(1, min(fit$fgam$ft[[1]]$Xrange), max(fit$fgam$ft[[1]]$Xrange))
#tval &lt;- runif(1, min(fit$fgam$ft[[1]]$xind), max(fit$fgam$ft[[1]]$xind))
#par(mfrow=c(4, 1))
#vis.fgam(fit, af.term='X', deriv2=FALSE, xval=xval)
#vis.fgam(fit, af.term='X', deriv2=FALSE, tval=tval)
#vis.fgam(fit, af.term='X', deriv2=TRUE, xval=xval)
#vis.fgam(fit, af.term='X', deriv2=TRUE, tval=tval)
</code></pre>


</div>