<div class="container">

<table style="width: 100%;"><tr>
<td>gpd_init</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Initial estimates for Generalized Pareto parameters</h2>

<h3>Description</h3>

<p>Calculates initial estimates and estimated standard errors (SEs) for the
generalized Pareto parameters <code class="reqn">\sigma</code> and <code class="reqn">\xi</code> based on an
assumed random sample from this distribution.  Also, calculates
initial estimates and estimated standard errors for
<code class="reqn">\phi</code><sub>1</sub> = <code class="reqn">\sigma</code>
and
<code class="reqn">\phi</code><sub>2</sub> = <code class="reqn">\xi + \sigma x</code>
<sub>(m)</sub>, where
<code class="reqn">x</code><sub>(m)</sub> is the sample
maximum threshold exceedance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpd_init(gpd_data, m, xm, sum_gp = NULL, xi_eq_zero = FALSE, init_ests = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gpd_data</code></td>
<td>
<p>A numeric vector containing positive sample values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A numeric scalar.  The sample size, i.e., the length of
<code>gpd_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xm</code></td>
<td>
<p>A numeric scalar. The sample maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_gp</code></td>
<td>
<p>A numeric scalar. The sum of the sample values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi_eq_zero</code></td>
<td>
<p>A logical scalar.  If TRUE assume that the shape
parameter <code class="reqn">\xi = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_ests</code></td>
<td>
<p>A numeric vector.  Initial estimate of
<code class="reqn">\theta = (\sigma, \xi)</code>.  If supplied <code>gpd_init()</code>
returns the corresponding initial estimate of
<code class="reqn">\phi</code> = (<code class="reqn">\phi</code><sub>1</sub>,
<code class="reqn">\phi</code><sub>2</sub>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main aim is to calculate an admissible estimate of
<code class="reqn">\theta</code>, i.e., one at which the log-likelihood is finite (necessary
for the posterior log-density to be finite) at the estimate, and
associated estimated SEs. These are converted into estimates and SEs for
<code class="reqn">\phi</code>.  The latter can be used to set values of <code>min_phi</code> and
<code>max_phi</code> for input to <code>find_lambda</code>.
</p>
<p>In the default setting (<code>xi_eq_zero = FALSE</code> and
<code>init_ests = NULL</code>) the methods tried are Maximum Likelihood
Estimation (MLE) (Grimshaw, 1993), Probability-Weighted Moments (PWM)
(Hosking and Wallis, 1987) and Linear Combinations of Ratios of Spacings
(LRS) (Reiss and Thomas, 2007, page 134) in that order.
</p>
<p>For <code class="reqn">\xi &lt; -1</code> the likelihood is unbounded, MLE may fail when
<code class="reqn">\xi</code> is not greater than <code class="reqn">-0.5</code> and the observed Fisher
information for <code class="reqn">(\sigma, \xi)</code> has finite variance only if
<code class="reqn">\xi &gt; -0.25</code>.  We use the ML estimate provided that
the estimate of <code class="reqn">\xi</code> returned from <code>gpd_mle</code> is greater than
<code class="reqn">-1</code>. We only use the SE if the MLE of <code class="reqn">\xi</code> is greater than
<code class="reqn">-0.25</code>.
</p>
<p>If either the MLE or the SE are not OK then we try PWM.  We use the PWM
estimate only if is admissible, and the MLE was not OK.  We use the PWM SE,
but this will be <code>c(NA, NA)</code> if the PWM estimate of <code class="reqn">\xi</code> is
<code class="reqn">&gt; 1/2</code>.  If the estimate is still not OK then we try LRS.  As a last
resort, which will tend to occur only when <code class="reqn">\xi</code> is strongly negative,
we set <code class="reqn">\xi = -1</code> and estimate sigma conditional on this.
</p>


<h3>Value</h3>

<p>If <code>init_ests</code> is not supplied by the user, a list is returned
with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A numeric vector. Initial estimates of <code class="reqn">\sigma</code>
and <code class="reqn">\xi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>A numeric vector. Estimated standard errors of
<code class="reqn">\sigma</code> and <code class="reqn">\xi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_phi</code></td>
<td>
<p>A numeric vector. Initial estimates of
<code class="reqn">\phi</code><sub>1</sub> = <code class="reqn">\sigma</code>
and
<code class="reqn">\phi</code><sub>2</sub> = <code class="reqn">\xi + \sigma x</code>
<sub>(m)</sub>
where <code class="reqn">x</code><sub>(m)</sub>
is the maximum of <code>gpd_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_phi</code></td>
<td>
<p>A numeric vector. Estimated standard errors of
<code class="reqn">\phi</code><sub>1</sub>
and
<code class="reqn">\phi</code><sub>1</sub>.</p>
</td>
</tr>
</table>
<p>If <code>init_ests</code> is supplied then only the numeric vector
<code>init_phi</code> is returned.
</p>


<h3>References</h3>

<p>Grimshaw, S. D. (1993) Computing Maximum Likelihood Estimates
for the Generalized Pareto Distribution.  Technometrics, 35(2), 185-191.
and Computing (1991) 1, 129-133. <a href="https://doi.org/10.1007/BF01889987">doi:10.1007/BF01889987</a>.
</p>
<p>Hosking, J. R. M. and Wallis, J. R. (1987) Parameter and Quantile
Estimation for the Generalized Pareto Distribution. Technometrics, 29(3),
339-349. <a href="https://doi.org/10.2307/1269343">doi:10.2307/1269343</a>.
</p>
<p>Reiss, R.-D., Thomas, M. (2007) Statistical Analysis of Extreme Values
with Applications to Insurance, Finance, Hydrology and Other Fields.Birkhauser.
<a href="https://doi.org/10.1007/978-3-7643-7399-3">doi:10.1007/978-3-7643-7399-3</a>.
</p>


<h3>See Also</h3>

<p><code>gpd_sum_stats</code> to calculate summary statistics for
use in <code>gpd_loglik</code>.
</p>
<p><code>rgpd</code> for simulation from a generalized Pareto
</p>
<p><code>find_lambda</code> to produce (somewhat) automatically
a list for the argument <code>lambda</code> of <code>ru</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Sample data from a GP(sigma, xi) distribution
gpd_data &lt;- rgpd(m = 100, xi = 0, sigma = 1)
# Calculate summary statistics for use in the log-likelihood
ss &lt;- gpd_sum_stats(gpd_data)
# Calculate initial estimates
do.call(gpd_init, ss)

</code></pre>


</div>