<div class="container">

<table style="width: 100%;"><tr>
<td>ipw.survival</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Adjusted Survival Curves by Using IPW.
</h2>

<h3>Description</h3>

<p>This function allows to estimate confounder-adjusted survival curves by weighting the individual contributions by the inverse of the probability to be in the group (IPW).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ipw.survival(times, failures, variable, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>A numeric vector with the follow up times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failures</code></td>
<td>
<p>A numeric vector with the event indicators (0=right censored, 1=event).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>A numeric vector with the binary variable under interest (only two groups).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>The weights for correcting the contribution of each individual. By default, the weights are all equaled to 1 and the survival curves correspond to the usual Kaplan-Meier estimator.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For instance, the <code>weights</code> may be equal to 1/<code>p</code>, where <code>p</code> is the estimated probability of the individual to be in its group. The probabilities <code>p</code> are often estimated by a logistic regression in which the dependent binary variable is the group. The possible confounding factors are the covariates of this model. 
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>table.surv</code></td>
<td>
<p>This data frame presents the survival probabilities (<code>survival</code>) in each group (<code>variable</code>) according to the <code>times</code>. The number of individuals at risk (<code>n.risk</code>) and the number of observed events are also provided (<code>n.event</code>).</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Yohann Foucher &lt;Yohann.Foucher@univ-poitiers.fr&gt;
</p>
<p>Florent Le Borgne &lt;fleborgne@idbc.fr&gt;
</p>


<h3>References</h3>

<p>Le Borgne et al. Comparisons of the performances of different statistical tests for time-to-event analysis with confounding factors: practical illustrations in kidney transplantation. Statistics in medicine. 30;35(7):1103-16, 2016. &lt;doi:10.1002/ sim.6777&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(dataDIVAT2)

# adjusted Kaplan-Meier estimator by IPW
 Pr0 &lt;- glm(ecd ~ 1, family = binomial(link="logit"), data=dataDIVAT2)$fitted.values[1]
 Pr1 &lt;- glm(ecd ~ age + hla + retransplant, data=dataDIVAT2,
 family=binomial(link = "logit"))$fitted.values
 W &lt;- (dataDIVAT2$ecd==1) * (1/Pr1) + (dataDIVAT2$ecd==0) * (1)/(1-Pr1)
 res.akm &lt;-ipw.survival(times=dataDIVAT2$times, failures=dataDIVAT2$failures,
  variable=dataDIVAT2$ecd, weights=W)
  
plot(res.akm, ylab="Confounder-adjusted survival",
 xlab="Time post-transplantation (years)", col=c(1,2), grid.lty=1)
</code></pre>


</div>