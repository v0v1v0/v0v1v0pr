<div class="container">

<table style="width: 100%;"><tr>
<td>cnbinom.pars</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of negative binomial parameters</h2>

<h3>Description</h3>

<p>A univariate censored frequency table is fit to a negative binomial distribution using a likelihood function customized to handle left, right, and interval censored data.  The output is a list containing the average and dispersion parameter that maximizes the custom function.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">cnbinom.pars(censoredtable)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>censoredtable</code></td>
<td>
<p>A frequency table.  A data.frame and matrix are acceptable classes.  See Details section for formatting.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The censored table for the cnbinom.pars function has restrictions. The univariate frequency table, which can be a data.frame or matrix class, must have two columns and n number of rows.  The categories must be in the first column with frequencies or probabilities in the second column.  Row names should never be placed in this table (the default row names should always be 1:n).  Column names can be any character string.  The only symbols accepted for censored data are listed below.  Note, less than or equal to (&lt;= and LE) is not equivalent to less than (&lt; and L) and greater than or equal to (&gt;=, +, and GE) is not equivalent to greater than (&gt; and G).  Also, calculations use closed intervals.     
</p>

<ul>
<li>
<p> left censoring: &lt;, L, &lt;=, LE
</p>
</li>
<li>
<p> interval censoring: - or I (symbol has to be placed in the middle of the two category values)
</p>
</li>
<li>
<p> right censoring: &gt;, &gt;=, +, G, GE
</p>
</li>
<li>
<p> uncensored: no symbol (only provide category value)
</p>
</li>
</ul>
<p>Below are three correctly formatted tables.  
</p>

<table>
<tr>
<td style="text-align: center;">
    Category</td>
<td style="text-align: center;"> Frequency</td>
</tr>
<tr>
<td style="text-align: center;">
    &lt;=6</td>
<td style="text-align: center;"> 11800 </td>
</tr>
<tr>
<td style="text-align: center;">
    7-12</td>
<td style="text-align: center;"> 57100 </td>
</tr>
<tr>
<td style="text-align: center;">
    13-19</td>
<td style="text-align: center;"> 14800 </td>
</tr>
<tr>
<td style="text-align: center;">
    20+</td>
<td style="text-align: center;"> 3900 </td>
</tr>
<tr>
<td style="text-align: center;">
  </td>
</tr>
</table>
<table>
<tr>
<td style="text-align: center;">
    Category</td>
<td style="text-align: center;"> Frequency</td>
</tr>
<tr>
<td style="text-align: center;">
    LE6</td>
<td style="text-align: center;"> 11800 </td>
</tr>
<tr>
<td style="text-align: center;">
    7I12</td>
<td style="text-align: center;"> 57100 </td>
</tr>
<tr>
<td style="text-align: center;">
    13I19</td>
<td style="text-align: center;"> 14800 </td>
</tr>
<tr>
<td style="text-align: center;">
    GE20</td>
<td style="text-align: center;"> 3900 </td>
</tr>
<tr>
<td style="text-align: center;">
  </td>
</tr>
</table>
<table>
<tr>
<td style="text-align: center;">
    Category</td>
<td style="text-align: center;"> Frequency</td>
</tr>
<tr>
<td style="text-align: center;">
    &lt;7</td>
<td style="text-align: center;"> 11800 </td>
</tr>
<tr>
<td style="text-align: center;">
    7I12</td>
<td style="text-align: center;"> 57100 </td>
</tr>
<tr>
<td style="text-align: center;">
    13-19</td>
<td style="text-align: center;"> 14800 </td>
</tr>
<tr>
<td style="text-align: center;">
    &gt;=20</td>
<td style="text-align: center;"> 3900 </td>
</tr>
<tr>
<td style="text-align: center;">
  </td>
</tr>
</table>
<h3>Value</h3>

<p>The cnbinom.pars function outputs a list consisting of the estimated average (mu) and dispersion (r) parameter. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# create frequency table that follows a Poisson distribution
set.seed(123)
testdata1&lt;-data.frame(table(rpois(100000,lambda = 10)))

# negative binomial converges in distribution to the Poisson 
## when dispersion-&gt;infinity
cnbinom.pars(testdata1)

# censor table of testdata1 (lambda = 10)
testdata2&lt;-cbind(as.character(c("&lt;=5", "6-10", "11-15", "16-20", "&gt;20")), 
  c(6718,51329,37041,4732, 180))
cnbinom.pars(testdata2)

# create frequency table that follows a negative binomial distribution
# different ways to parameterize the negative binomial distribution
mu = 10
r = 2
p = r/(r+mu)
set.seed(123)
testdata3&lt;-data.frame(table(rnbinom(100000, size = r, mu = mu)))
cnbinom.pars(testdata3)
set.seed(123)
testdata4&lt;-data.frame(table(rnbinom(100000, size = r, p = p)))
cnbinom.pars(testdata4)

# censor table with mu = 10 and r = 2 
testdata5&lt;-cbind(as.character(c("&lt;5", "5-15", "16I26", "27-37", "38I48", "&gt;48")), 
  c(26130,53979,15899,3267, 593, 132))
cnbinom.pars(testdata5)
</code></pre>


</div>