<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mcd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Distance Plots</h2>

<h3>Description</h3>

<p>Shows the Mahalanobis distances based on robust and classical estimates
of the location and the covariance matrix in different plots.
The following plots are available:
</p>

<ul>
<li>
<p> index plot of the robust and mahalanobis distances
</p>
</li>
<li>
<p> distance-distance plot
</p>
</li>
<li>
<p> Chisquare QQ-plot of the robust and mahalanobis distances
</p>
</li>
<li>
<p> plot of the tolerance ellipses (robust and classic)
</p>
</li>
<li>
<p> Scree plot - Eigenvalues comparison plot
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mcd'
plot(x,
     which = c("all", "dd", "distance", "qqchi2",
               "tolEllipsePlot", "screeplot"),
     classic = FALSE, ask = (which[1] == "all" &amp;&amp; dev.interactive()),
     cutoff, id.n, labels.id = rownames(x$X), cex.id = 0.75,
     label.pos = c(4,2), tol = 1e-7, ...)

covPlot(x,
     which = c("all", "dd", "distance", "qqchi2",
               "tolEllipsePlot", "screeplot"),
     classic = FALSE, ask = (which[1] == "all" &amp;&amp; dev.interactive()),
     m.cov = covMcd(x),
     cutoff = NULL, id.n, labels.id = rownames(x), cex.id = 0.75,
     label.pos = c(4,2), tol = 1e-07, ...)




</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For the <code>plot()</code> method, a <code>mcd</code> object, typically
result of <code>covMcd</code>.<br>
For <code>covPlot()</code>, the numeric data matrix such as the <code>X</code>
component as returned from <code>covMcd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>string indicating which plot to show.  See the
<em>Details</em> section for a description of the options.  Defaults to <code>"all"</code>.</p>
</td>
</tr>
</table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>classic</code></td>
<td>
<p>whether to plot the classical distances too.
Defaults to <code>FALSE</code>.</p>
</td>
</tr></table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical indicating if the user should be <em>ask</em>ed
before each plot, see <code>par(ask=.)</code>.  Defaults to
<code>which == "all" &amp;&amp; dev.interactive()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the cutoff value for the distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.n</code></td>
<td>
<p>number of observations to be identified by a label.  If
not supplied, the number of observations with distance larger than
<code>cutoff</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels.id</code></td>
<td>
<p>vector of labels, from which the labels for extreme
points will be chosen.  <code>NULL</code> uses observation numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.id</code></td>
<td>
<p>magnification of point labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.pos</code></td>
<td>
<p>positioning of labels, for the left half and right
half of the graph respectively (used as <code>text(.., pos=*)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance to be used for computing the inverse, see
<code>solve</code>.  Defaults to <code>tol = 1e-7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.cov</code></td>
<td>
<p>an object similar to those of class <code>"mcd"</code>; however
only its components <code>center</code> and <code>cov</code> will be used.  If
missing, the MCD will be computed (via <code>covMcd()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters to be passed through to plotting functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions produce several plots based on the robust and classical
location and covariance matrix.  Which of them to select is specified
by the attribute  <code>which</code>.  The <code>plot</code> method for
<code>"mcd"</code> objects is calling <code>covPlot()</code> directly, whereas
<code>covPlot()</code> should also be useful for plotting other (robust)
covariance estimates.  The possible options are:
</p>

<dl>
<dt><code>distance</code></dt>
<dd>
<p>index plot of the robust distances</p>
</dd>
<dt><code>dd</code></dt>
<dd>
<p>distance-distance plot</p>
</dd>
<dt><code>qqchi2</code></dt>
<dd>
<p>a qq-plot of the robust distances versus the
quantiles of the chi-squared distribution</p>
</dd>
<dt><code>tolEllipsePlot</code></dt>
<dd>
<p>a tolerance ellipse plot, via
<code>tolEllipsePlot()</code></p>
</dd>
<dt><code>screeplot</code></dt>
<dd>
<p>an eigenvalues comparison plot - screeplot</p>
</dd>
</dl>
<p>The Distance-Distance Plot, introduced by
Rousseeuw and van Zomeren (1990), displays the robust distances
versus the classical Mahalanobis distances.  The dashed line is the set of
points where the robust distance is equal to the classical distance.
The horizontal and vertical lines are drawn at values equal to the cutoff
which defaults to square root of the 97.5% quantile of a chi-squared
distribution with p degrees of freedom.  Points beyond these lines can
be considered outliers.
</p>


<h3>References</h3>

<p>P. J. Rousseeuw and van Zomeren, B. C. (1990).
Unmasking Multivariate Outliers and Leverage Points.
<em>Journal of the American Statistical Association</em> <b>85</b>, 633–639.
</p>
<p>P. J. Rousseeuw and K. van Driessen (1999)
A fast algorithm for the minimum covariance determinant estimator.
<em>Technometrics</em> <b>41</b>, 212–223.
</p>


<h3>See Also</h3>

<p><code>tolEllipsePlot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Animals, package ="MASS")
brain &lt;- Animals[c(1:24, 26:25, 27:28),]
mcd &lt;- covMcd(log(brain))

plot(mcd, which = "distance", classic = TRUE)# 2 plots
plot(mcd, which = "dd")
plot(mcd, which = "tolEllipsePlot", classic = TRUE)
op &lt;- par(mfrow = c(2,3))
plot(mcd) ## -&gt; which = "all" (5 plots)
par(op)

## same plots for another robust Cov estimate:
data(hbk)
hbk.x &lt;- data.matrix(hbk[, 1:3])
cOGK &lt;- covOGK(hbk.x, n.iter = 2, sigmamu = scaleTau2,
               weight.fn = hard.rejection)
covPlot(hbk.x, m.cov = cOGK, classic = TRUE)



</code></pre>


</div>