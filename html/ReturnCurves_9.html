<div class="container">

<table style="width: 100%;"><tr>
<td>margtransf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Marginal Transformation</h2>

<h3>Description</h3>

<p>Marginal transformation of a  bivariate random vector to standard exponential margins following Coles and Tawn (1991). Variables within each margin are assumed identically distributed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">margtransf(data, qmarg = rep(0.95, 2), constrainedshape = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix containing the data on the original margins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qmarg</code></td>
<td>
<p>A vector containing the marginal quantile used to fit the Generalised Pareto Distribution (GPD) for each variable. Default is <code>rep(0.95, 2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrainedshape</code></td>
<td>
<p>Logical. If <code>TRUE</code> (Default), the estimated shape parameter of the Generalised Pareto Distribution (GPD) is constrained to lie strictly above <code>-1</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Given a threshold value \(u\), each stationary random vector 
is transformed by using the empirical cumulative distribution function 
(cdf) below \(u\), and a Generalise Pareto Distribution (GPD) fit above \(u\).    
</p>
<p>The option to constrain \(\xi &gt; -1\) is included as \(\xi \leq -1\) implies that the fitted
upper endpoint of the distribution's support is the maximum data point. This situation is rarely encountered in practice.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>margtransf.class</code>. This object returns the arguments of the function, a slot <code>parameters</code> containing a matrix with the shape and scale parameters of the Generalised Pareto Distribution (GPD) for each variable, a slot <code>thresh</code> containing a vector with the threshold \(u\) above which the GPD is fitted, and a slot <code>dataexp</code> containing a matrix with the data on standard exponential margins. 
</p>
<p>The <code>plot</code> function takes an object of S4 class <code>margtransf.class</code>, and a <code>which</code> argument specifying the type of plot desired (see <strong>Examples</strong>):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"hist"</code></td>
<td>
<p>Plots the marginal distributions of the two variables on original and standard exponential margins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"ts"</code></td>
<td>
<p>Plots the time series of the two variables on original and standard exponential margins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"joint"</code></td>
<td>
<p>Plots the joint distribution of the two variables on original and standard exponential margins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"all"</code></td>
<td>
<p>Plots all the above mentioned plots (default).</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Coles SG, Tawn JA (1991).
“Modelling Extreme Multivariate Events.”
<em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <b>53</b>(2), 377–392.
ISSN 00359246, doi: <a href="https://doi.org/10.1111/j.2517-6161.1991.tb01830.x">10.1111/j.2517-6161.1991.tb01830.x</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

margdata &lt;- margtransf(airdata)

# Plots the marginal distributions of X and Y on original vs standard exponential margins
plot(margdata, which = "hist") 

# Plots the time series of X and Y on original vs standard exponential margins
plot(margdata, which = "ts") 

# Plots the joint distribution of X and Y on original vs standard exponential margins
plot(margdata, which = "joint") 

# Plots all the available plots
plot(margdata, which = "all") 

# To see the the S4 object's slots
str(margdata)

# To access the matrix with the data on standard exponential margins
margdata@dataexp

</code></pre>


</div>