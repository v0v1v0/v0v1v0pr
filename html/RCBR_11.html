<div class="container">

<table style="width: 100%;"><tr>
<td>NICER</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>New Incremental Cell Enumeration (in) R</h2>

<h3>Description</h3>

<p>Find interior points and cell counts of the polygons (cells) formed by a
line arrangement.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NICER(A, b, initial = c(0, 0), verb = TRUE, epsbound = 1, epstol = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>is a n by 2 matrix of slope coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>is an n vector of intercept coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>origin for the interior point vectors <code>w</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>controls verbosity of Mosek solution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsbound</code></td>
<td>
<p>is a scalar tolerance controlling how close the witness point
can be to an edge of the polytope</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epstol</code></td>
<td>
<p>is a scalar tolerance for the LP convergence</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Modified version of the algorithm of Rada and Cerny (2018).
The main modifications include preprocessing as hyperplanes are added
to determine which new cells are created, thereby reducing the number of
calls to the witness function to solve LPs, and treatment of degenerate
configurations as well as those in "general position."  When the hyperplanes
are in general position the number of polytopes (cells) is determined by the
elegant formula of Zazlavsky (1975) </p>
<p style="text-align: center;"><code class="reqn">m = {n \choose d} + n + 1</code>
</p>
<p>.  In
degenerate cases, i.e. when hyperplanes are not in general position, the
number of cells is more complicated as considered by Alexanderson and Wetzel (1981).
The function <code>polycount</code> is provided to check agreement with their results
in an effort to aid in the selection of tolerances for the <code>witness</code> function.
Current version is intended for use with <code class="reqn">d = 2</code>, but the algorithm is adaptable to
<code class="reqn">d &gt; 2</code>, and there is an experimental version called <code>NICERd</code> in the package.
</p>


<h3>Value</h3>

<p>A list with components:
</p>

<ul>
<li>
<p>  SignVector a n by m matrix of signs determining position of cell relative 
to each hyperplane.
</p>
</li>
<li>
<p>  w a d by m matrix of interior points for the m cells
</p>
</li>
</ul>
<h3>References</h3>

<p>Alexanderson, G.L and J.E. Wetzel, (1981) Arrangements of planes in space, 
Discrete Math, 34, 219â€“240.
Gu, J. and R. Koenker (2020)  Nonparametric Maximum Likelihood Methods for
Binary Response Models with Random Coefficients, <em>J. Am. Stat Assoc</em>
Rada, M. and M. Cerny (2018) A new algorithm for the enumeration of cells 
of hyperplane arrangements and a comparison with Avis and Fukada's reverse 
search, SIAM J. of Discrete Math, 32, 455-473.
Zaslavsky, T. (1975) Facing up to arrangements:  Face-Count Formulas for 
Partitions of Space by Hyperplanes, Memoirs of the AMS, Number 154.
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
if(packageVersion("Rmosek") &gt; "8.0.0"){
    A = cbind(c(1,-1,1,-2,2,1,3), c(1,1,1,1,1,-1,-2))
    B = matrix(c(3,1,7,-2,7,-1,1), ncol = 1)
    plot(NULL,xlim = c(-10,10),ylim = c(-10,10))
    for (i in 1:nrow(A))
	  abline(a = B[i,1]/A[i,2], b = -A[i,1]/A[i,2],col = i)
    f = NICER(A, B)
    for (j in 1:ncol(f$SignVector))
    	  points(f$w[1,j], f$w[2,j], cex = 0.5)
    }
}
</code></pre>


</div>