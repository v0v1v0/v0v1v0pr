<div class="container">

<table style="width: 100%;"><tr>
<td>est.R0.ML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate R0 by Maximum Likelihood</h2>

<h3>Description</h3>

<p>Estimate R0 by maximum likelihood, assuming Poisson distribution of offsprings
generated from infected individuals at each time step.
</p>


<h3>Usage</h3>

<pre><code class="language-R">est.R0.ML(
  epid,
  GT,
  import = NULL,
  t = NULL,
  begin = NULL,
  end = NULL,
  date.first.obs = NULL,
  time.step = 1,
  range = c(0.01, 50),
  unknown.GT = FALSE,
  impute.incid = FALSE,
  checked = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>epid</code></td>
<td>
<p>Object containing epidemic curve data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT</code></td>
<td>
<p>Generation time distribution from <code>generation.time()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>import</code></td>
<td>
<p>Vector of imported cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>At what time estimation begins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>Time at which to end computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>Range of values over which the MLE must be explored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unknown.GT</code></td>
<td>
<p>Boolean value. When GT distribution is unknown, it is estimated jointly (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute.incid</code></td>
<td>
<p>Boolean value. If <code>TRUE</code>, will impute unobserved cases at the beginning of the epidemic to correct for censored data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For internal use. Called by <code>estimate.R()</code>.
</p>
<p>White &amp; Pagano (2009) detail two maximum likelihood methods for estimatig the
reproduction ratio. The principle of the methods described by White &amp; all is to
compute the expected number of cases in the future, and optimise to get R using
a Poisson distribution.
</p>
<p>The first (and used by default in this package) assumes that the serial interval
distirbution is known, and subsequently the likelihood is only maximised depending
on the value of R.
</p>
<p>The second method can be used if the serial interval distribution is unknown: in
that case, the generation time is set to follow a Gamma distribution with two
parameters (size, shape), and the optimization routine finds the values of R, size
and shape that maximize the likelihood. However, the epidemic curve must be long
enough to account for a whole generation. The authors showed that this is achieved
when the cumulated amount of incident cases reaches approximately 150.
When using this method, the flag <code>unknown.GT</code> must be set to <code>TRUE</code>. GT must still
be provided with a <code>R0.GT</code>-class object, though its mean and sd will be recycled
as starting value for the optimization routine.
</p>
<p>The 95% confidence interval is achieved by profiling the likelihood.
</p>
<p>In addition to the estimation method, we implemented a framework to impute
unobserved incidence data, when the epidemic curve is found to not be available
from the start of the outbreak. The details of this method are availble in the
Supplementary Material S1 from <a href="https://doi.org/10.1186/1472-6947-12-147">doi:10.1186/1472-6947-12-147</a>Obadia et al., 2012.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The estimate of the reproduction ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>The 95% confidence interval for the R estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epid</code></td>
<td>
<p>Original or augmented epidemic data, depending whether <code>impute.incid()</code> is set to <code>FALSE</code> or <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epid.orig</code></td>
<td>
<p>Original epidemic data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT</code></td>
<td>
<p>Generation time distribution uised in the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>Starting date for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin.nb</code></td>
<td>
<p>The number of the first day used in the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>The end date for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end.nb</code></td>
<td>
<p>The number of the las day used for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>Prediction on the period used for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rsquared</code></td>
<td>
<p>Correlation coefficient between predicted curve (by <code>fit.epid()</code>) and observed epidemic curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Call used for the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used for fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This is the implementation of the method provided by White &amp; Pagano (2009).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>White, L.F., J. Wallinga, L. Finelli, C. Reed, S. Riley, M. Lipsitch, and M. Pagano. "Estimation of the Reproductive Number and the Serial Interval in Early Phase of the 2009 Influenza A/H1N1 Pandemic in the USA." Influenza and Other Respiratory Viruses 3, no. 6 (2009): 267-276.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Loading package
library(R0)

## Data is taken from paper by Nishiura for key transmission parameters of an institutional
## outbreak during the 1918 influenza pandemic in Germany)

data(Germany.1918)
mGT &lt;- generation.time("gamma", c(2.45, 1.38))
est.R0.ML(Germany.1918, mGT, begin=1, end=27, range=c(0.01,50))
# Reproduction number estimate using  Maximum Likelihood  method.
# R :  1.307222[ 1.236913 , 1.380156 ]

res &lt;- est.R0.ML(Germany.1918, mGT, begin=1, end=27, range=c(0.01,50))
plot(res)

## no change in R with varying range 
## (dates here are the same index as before. Just to illustrate different use)
est.R0.ML(Germany.1918, mGT, begin="1918-09-29", end="1918-10-25", range=c(0.01,100))
# Reproduction number estimate using  Maximum Likelihood  method.
# R :  1.307249[ 1.236913 , 1.380185 ]


</code></pre>


</div>