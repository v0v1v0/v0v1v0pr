<div class="container">

<table style="width: 100%;"><tr>
<td>sim.epid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Epidemic outbreak simulation</h2>

<h3>Description</h3>

<p>Generates several epidemic curves with specified distribution and reproduction
number.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.epid(
  epid.nb,
  GT,
  R0,
  epid.length,
  family,
  negbin.size = NULL,
  peak.value = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>epid.nb</code></td>
<td>
<p>Number of epidemics to be simulated (defaults to 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GT</code></td>
<td>
<p>Generation time distribution from <code>generation.time()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0</code></td>
<td>
<p>Basic reproduction number, in its core definition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epid.length</code></td>
<td>
<p>Maximum length of the epidemic (cases infected after this length will be truncated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Distribution of offspring. Can be either <code>"poisson"</code> (default) or <code>"negbin"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negbin.size</code></td>
<td>
<p>If family is set to "negbin", sets the size parameter of the negative binomial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peak.value</code></td>
<td>
<p>Threashold value for incidence before epidemics begins decreasing</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is only used for simulation purposes.
The output is a matrix of n columns (number of outbreaks) by m rows (maximum
length of an outbreak).
</p>
<p>When using rnbinom with <code>mean</code> and <code>size</code> moments, the variance is given by
<code>mean + mean^2/size</code> (see <code>stats::rnbinom()</code>). One should determine the size
accordingly to the R0 value to increase the dispersion. From the previous
formula for the variance, <code class="reqn">Var(X) = k*R_{0}</code> implies that
<code class="reqn">size = R0/(k-1)</code>.
</p>


<h3>Value</h3>

<p>A matrix with epidemics stored as columns (incidence count).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Loading package
library(R0)

## In this example we simulate n=100 epidemic curves, with peak value at 150 incident cases, 
## and maximum epidemic length of 30 time units.
## Only the outbreak phase is computed. When the peak value is reached, the process is stopped 
## and another epidemic is generated.
sim.epid(epid.nb=100, GT=generation.time("gamma",c(3,1.5)), R0=1.5, 
         epid.length=30, family="poisson", peak.value=150)

# Here, a 30*100 matrix is returned. Each column is a single epidemic.
</code></pre>


</div>