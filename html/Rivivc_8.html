<div class="container">

<table style="width: 100%;"><tr>
<td>RivivcA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Level A linear correlation for a single formulation
</h2>

<h3>Description</h3>

<p>This is the major function to be called where numerical convolution ad/or deconvolution might be used for a linear in vitro in vivo correlation level A. It performes either numerical convolution via /codeNumConv() or deconvolution via /codeNumDeconv() and correlates their results with the known.data object via linear regression <code>lm()</code>. If you just want raw results of convolution/deconvolution then call explicitely <code>NumConv</code> or <code>link{NumDeconv}</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">RivivcA(known.data, impulse.data, second.profile.data,dose_iv=NULL,dose_po=NULL, 
	mode = "deconv", explicit.interp = 20, implicit.interp = 10, 
	optimization.maxit = 200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>known.data</code></td>
<td>

<p>the data matrix to be correlated with; depending on the state of the <code>mode</code> variable it represents either in vitro dissolution profile (<code>mode = "deconv"</code>) or PK profile after oral administration of the drug (<code>mode="conv"</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impulse.data</code></td>
<td>

<p>matrix of the PK profile after the drug i.v. administration 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>second.profile.data</code></td>
<td>

<p>matrix of the second PK profile; depending on the <code>mode</code> variable it represents either PK profile after oral administration of the drug (<code>mode = "deconv"</code>) or a drug cumulative absorption profile (<code>mode="conv"</code>), sometimes substituted directly by the in vitro dissolution profile
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose_iv</code></td>
<td>

<p>drug dose after i.v. administration; not obligatory but if provided must be in the same units like the dose p.o.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose_po</code></td>
<td>

<p>drug dose after p.o. administration; not obligatory but if provided must be in the same units like the dose i.v.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>

<p>represents the method used here; two states are allowed: <code>mode="conv"</code> for numerical convolution method or <code>mode="deconv"</code> for numerical deconvolution (default)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>explicit.interp</code></td>
<td>

<p>convolution and deconvolution explicit interpolation parameter, namely number of the curve interpolation points
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>implicit.interp</code></td>
<td>

<p>implicit interpolation  - a factor multiplying <code>explicit.interp</code> for better accuracy; applies to the deconvolution procedure only
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization.maxit</code></td>
<td>

<p>maximum number of iterations used by <code>optim()</code> method; applies to the deconvolution procedure only
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function represents either convolution or deconvolution data together with linear regression of the above functions outputs and known data supplied as a parameter. Please bear in mind that NumDeconv() procedure is iterative and therefore depending on the parameters might require substantial amount of time to converge. Please refer to the <code>NumDeconv</code> description.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>$regression </code></td>
<td>
<p>returns a whole object of the linear regression - a result from the <code>lm()</code> procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$numeric </code></td>
<td>
<p>returns results from <code>NumConv()</code> or <code>NumDeconv()</code> functions</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Aleksander Mendyk and Sebastian Polak
</p>


<h3>See Also</h3>

<p><code>NumConv</code>, <code>NumDeconv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
require(Rivivc)
require(graphics)

#i.v. data
data("impulse")
#p.o. PK profile
data("resp")
#in vitro dissolution for correlation purposes
data("input")

#preparing data matrices
input_mtx&lt;-as.matrix(input)
impulse_mtx&lt;-as.matrix(impulse)
resp_mtx&lt;-as.matrix(resp)

#setting accuracy
accur_explic&lt;-20
accur_implic&lt;-5

#run deconvolution
result&lt;-RivivcA(input_mtx,impulse_mtx,resp_mtx,
    explicit.interp=accur_explic,implicit.interp=accur_implic)

summary(result$regression)

print("Raw results of deconvolution")
print(result$numeric$par)

predicted&lt;-predict(result$regression)
deconvolved_data&lt;-unname(predicted)
orig_data&lt;-input_mtx[,2]

dev.new()
plot(orig_data,result$numeric$par[,2])
lines(orig_data,deconvolved_data, type="l", col="blue")
dev.new()
plot(input_mtx)
lines(result$numeric$par, type="l", col="blue")

</code></pre>


</div>