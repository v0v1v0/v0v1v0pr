<div class="container">

<table style="width: 100%;"><tr>
<td>disturber</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Disturbing light curve data
</h2>

<h3>Description</h3>

<p>Disturbes a light curve replacing measurement accuracies by outliers and/or observed values by atypical values.
See <code>RobPer-package</code> for more information about light curves.
</p>


<h3>Usage</h3>

<pre><code class="language-R">disturber(tt, y, s, ps, s.outlier.fraction = 0, interval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>

<p>numeric vector: Observation times <code class="reqn">t_1,\ldots,t_n</code> (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>numeric vector: Observed values <code class="reqn">y_1,\ldots,y_n</code> (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>numeric vector: Measurement accuracies <code class="reqn">s_1,\ldots,s_n</code> (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps</code></td>
<td>

<p>positive value: Sampling period <code class="reqn">p_s</code> indirectly defines the length of the time interval, in which observed values <code class="reqn">y_i</code> are replaced by atypical values (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.outlier.fraction</code></td>
<td>

<p>numeric value in [0,1]: Defines the proportion of measurement accuracies that is replaced by outliers (see Details). A value of 0 means that no measurement accuracy is replaced by an outlier.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>

<p>logical: If <code>TRUE</code>, the observed values belonging to a random time interval of length 3<code class="reqn">p_s</code> are replaced by atypical values (see Details). If <code>TRUE</code> and the light curve is shorter than <code class="reqn">3p_s</code>, the function will stop with an error message. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function disturbes the light curve <code class="reqn">(t_i,y_i,s_i)_{i=1,\ldots,n}</code> given. It randomly chooses a proportion of <code>s.outlier.fraction</code> measurement accuracies <code class="reqn">s_i</code> and replaces them by <code class="reqn">0.5\min(s_1,\ldots,s_n)</code>. In case of <code>interval=TRUE</code> a time interval <code class="reqn">[t_{start},t_{start}+3p_s]</code> within the intervall 
<code class="reqn">[t_1,t_n]</code> is randomly chosen and all observed values belonging to this time interval are replaced by a peak function:
</p>
<p style="text-align: center;"><code class="reqn">y_i^{changed} = 6 \ \tilde y_{0.9}\  \frac{d_{\mathcal N(t_{start}+1.5p_s, p_s^2)}(t_i) }{ d_{\mathcal N(0,p_s^2)}(0)} \quad \forall \ i \ : \ t_i\in[t_{start}, t_{start}+3p_s],</code>
</p>
 
<p>where <code class="reqn">d_{\mathcal N(a,b^2)}(x)</code> denotes the density of a normal distribution with mean <code class="reqn">a</code> and variance <code class="reqn">b^2</code> at <code class="reqn">x</code>.
</p>
<p>In case of <code>s.outlier.fraction=0</code> and <code>interval=FALSE</code>, <code>y</code> and <code>s</code> are returned unchanged.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector: New <code class="reqn">y_i</code>-values, partly different from the old ones if <code>interval=TRUE</code> (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>numeric vector: New <code class="reqn">s_i</code>-values, partly different from the old ones if <code>s.outlier.fraction&gt;0</code> (see Details).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>A former version of this function is used in Thieler et al. (2013). See also Thieler, Fried and Rathjens (2016).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler
</p>


<h3>References</h3>

<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code>tsgen</code> (see there for example).
</p>


</div>